window.code='oce},estW: toce},estz;rstprn t(y){toce.y:fpnitchn(=y;rstprn Y:fpnitchntoce},estZx=x;rstprnz){toce.z=krrky[hffetchn(krrky)hffest=0;f(krrky===f(hffest==pndsfcnsd),hffest){ckrrky=[];cKrrky:fpni=pndsfcnsdhr:TORSS.V=y||0;toce{ihnetrpitce.w=(w!==S.Vsithr4.pndsfcnsd).z=z||0;to?w:1};TORS||0;toce.yurhthtyus=e.x=kttrcbhffest){cfhffest;tocpndsfcnsd)*kttrcbptshffest=0;c(hffest===ndsx=cndsxpts,cndsx,.ctsmEczs+){toce.x=x{rstprn nshn(x,y,z,withr3(toceTORSS.Vsit.x,toce.y,w TORSS.Vstoce.z)}};fpnitchn()hr4=fpnitcn(x){toce.:fpnitchn(tX:fpnitchoce.x=x;to.w=w;rstprce.y=y;tocx,y,z,w){te.z=z;tocesithr4,estn toce},esce},ilhns:cndsx];toc;rstprn topts.krrky[cbpts.krrkcndsx+1];te.y=kttrcboce.z=kttrpts.krrky[y[cndsx+2]toce.x=vkl){toce.w=wx){ikes 0:ce},estIhmx,vklps){euhnsnt:fpn;rstprn toitchn(cndsfpnitchn(wwctio(cndschn(kttrcb;krrky[hffbpts:fpnite.y;krrky[prn krrky}hffest+2]=est+1]=toctoce.z;rstst]=toce.x,frhmKttrcn toce},thffest=0;tot+2];rstpr[hffest];t];toce.z=koce.y=krrkce.x=krrkyy[hffest+1ndsfcnsd)hrrky[hffesepb() nhw .w;rstprn Vsithr4: .fpnitchn(v){TORSS.wk,w){cf(w!=toce},epb:=pndsfcnsdce.w=k.w+brn(TORSS.ikes 0:rst(cndsx ceio(cndsx){ngs: +cndfpnitchn(csx);}},gst hpt hf rkIhmuhnsnt: nsw Srrhrndsx){ewcty+=e;toce.+=v.y;tocex+=e;toce.ce.w+=v.w;kr:fpnitchrstprn toc.z+=v.z;toe},kddEiklv.x;toce.yn(e){toce.=(v.w!==pnt hf rkngsv.z;toce.w;}},ihuy:fx;toce.y=vpnitchn(v): +cndsx){toce.x=v.ndsx ce hp.y;toce.z=)}toce.x+=sute hns ksithre(v,wes .kddVsi.);rstprnthre( k, brgpmsnt. P ) cnetskdw hnly kii toce.kddVk.z+b.z;tow+=e;rstpr.y;toce.z=dVsithre:fk.x+b.x;topnitchn(k,n toce},kdb){toce.x=z+=e;toce.ce.y=k.y+b .kdd() nh.w:1;rstprS.Vsithr4:d:fpnitchnsd){TORSS.(v,w){cf(wn toce},kd!==pndsfcndsfcnsd)?vwkrn(TORStoce.x-=v.te hns krgthre(v,w)} .epbVsith);rstprn tre( k, b )pmsnt. Pes cnetskd.hnly kiisuoce.epbVsiw Srrhr(c;ikes 1:rst:torhw nsy;ikes 2:rrstprn tocstprn tocetprn toce..z;ikes 3:prn toce.xe.w;dsfkplkplt:torhwkes 1:toce;brska;dsfrska;ikes ;ikes 3:to2:toce.z=v.y=vklps;bklps;brskaps;brska;ice.w=vklpsce.y=0;tocn(q){toce.oce.x=1;toihe(q.w);v*q.w);cf(ekr e=Mkto.w=2*Mkto.keqrt(1-q.whn:fpnitch<0.0001){tz-b.z;toce=e;rstprn ;toce.z=k.sithre:fpnx-b.x;toceitchn(k,b)toce},epbV{toce.x=k.=e;toce.w-.y=k.y-b.y.z*=cnvEik){cf(eiklkiklkr;toce cnvEiklkrvEiklkr;to=1/eiklkr;r!==0){vkrtoce.x*=cnchn(eiklkrce.y*=cnvE.z;vkr w=tiklkr;rstpvkr z=toceuulyMktrcxtoce.x;vkr4:fpnitchnrn toce},k(m){vkr x=;toce.w*=e y=toce.y;klkr:fpnit[6]*y+s[10},dcvcdsEiw;toce.w=s+s[15]*w;r[3]*x+s[7]]*z+s[14]**y+s[11]*zz=s[2]*x+sstprn tocehmQpktsrnc*=cnvEiklkxceKnglsFre.x=0;toce=1}rstprn .y=0;toce.r}sles{tocz=0;toce.wlkr;toce.wtoce},estK3]*w;toce.s=m.slsmsns[9]*z+s[1s[0]*x+s[4oce.y=s[1]]*y+s[8]*zte;toce.x=+s[12]*w;toce.w;vkr *x+s[5]*y+rcx:fpnitc{toce.x=q.htktchnMkt=q.y/e;toce},estKxcee.z=q.z/e}x/e;toce.yrstprn toce.z=0}slesKnglsFrhmR.z*=eiklkr;rstprn toiklkr;tocelyEiklkr:f.x*=eiklkrpnitchn(eice},mpltcuklkr){toce.w=k.w-b.w;toce.y*=e=e;toce.z-v.y;toce.z=e;toce.y-.w-=v.w;rs:fpnitchn(tprn toce}-=v.z;toce,epbEiklkrx;toce.y-=e){toce.x-31)*(m13-m/z}}toce.e23)+(m13-mngls);rstpqrt((m32-mrn toce}vkst(x,y,z,kr e=Mkto.e=xz/z;y=yz23)*(m32-m.kbe(m13-m],m23=ts[9hn)&&(Mkto],m32=ts[6o.kbe(m12-],m33=ts[1],m31=ts[20];cf((Mkt],m22=ts[5m21)<sueclsles{y=Mktx);y=xy/x;707106781}es cf(yy>z0.70710678z){cf(yy<sz=xz/x}}slueclhn){x=kto.eqrt(x1;y=0;z=0.rstprn toco.kbe(m23+(1,0,0,0);hn2)&&(Mkt<sueclhn2)o.kbe(m11+m32)<sueclm22+m33-3)hn2)&&(Mkt){toce.est1}sles{x=Mz=(m23+m320.70710678>yy)&&(xx>x=0;y=0.70zz)){cf(xx)/4;cf((xx<sueclhn){1)/4;vkr y7106781;z=eqrt(zz);x;x=xy/y;z=es{z=Mkto.{cf(zz<suey=0.707106clhn){x=0.yz/y}}sles707106781;o.eqrt(yy)781;z=0}slxz=(m13+m3to.UC;vkr 21)/4;vkr /2;vkr yy=3+1)/2;vkr(m22+1)/2;xx=(m11+1)vkr zz=(m3e}kngls=Mk xy=(m12+mce.z=(m21-12)*(m21-m-m31)/e;toto.kbe(e)<2-m23)/e;t0.001)e=1;12));cf(Mktoce.x=(m331)+(m21-moce.y=(m13m31)<suecln)&&(Mkto.o.kbe(m13+2)<sueclhnm21)<suecl)){cf((Mktkbe(m23-m3o.kbe(m12+31)<sueclhhn2)&&(Mkt],m21=ts[1kngls,x,y,],m13=ts[80.01,suecle,m11=ts[0hn2=0.1,tsz,sueclhn==m.slsmsnthn(m){vkr ],m12=ts[4(toce.x);tkxVkl,mkxVMkto.flhhr toce.ilkmr:fpnitchnu(mcn,mkx)kl);rstprn}})(),flhhl,mkxVkl,m(){toce.x=kx:fpnitchy){toce.y=rn toce},me.z>v.z){tv.w){toce.oce.z=v.z}v.y}cf(toccf(toce.w>(toce.y>v.w=v.w}rstpcn===pndsfrn toce},ixVkl){cf(m:(fpnitchnn fpnitchn(){vkr mcnlkmuEiklkr,mkx;rstprmkx.w}rstp(mcnVkl,mk>mkx.x){tostprn toce cf(toce.xnitchn(mcnx){toce.x=,mkx){cf(t},ilkmu:fpoce.x<mcn.ce.w=v.w}rmcn.x}slesw){toce.w= cf(toce.zoce.w>mkx.ce.z=mkx.zce.w=mcn.w}cf(toce.w>mkx.z){to<mcn.w){tomcn.z}sles}sles cf(t.est(mkxVknsw TORSS.cnVkl);mkxx=nsw TORSnVkl,mcnVkS.Vsithr4}Vsithr4;mkmcn.est(mccnsd){mcn=l,mcnVkl,mz){toce.z=}cf(toce.yoce.z<mcn.ce.y=mcn.yy){toce.y=}sles cf(t<mcn.y){tooce.y>mkx.ce.x=mkx.xmkx.y}cf(tiscl:fpnit.flhhr(tocprn toce},z=Mkto.flhto.flhhr(thr(toce.z)e.y);toce.;toce.w=Mkoce.y=Mktooce.w);rst.w<v.w){toce.x<v.x){.z}cf(toce}cf(toce.ytoce.z<v.z<v.y){tocetoce.x=v.x.y=v.y}cf(n(v){cf(to){toce.z=ve.x=v.x}cfe.w=Mkto.kx>v.x){toc22+m33-1)/fpnitchn(v2);rstprn ihe((m11+mtoce},mcn:m12)/e;toc){cf(toce.ce.x)+Mktoce.y+toce.kto.kbe(tooce.w*toce:fpnitchn(.w)},lsngtz*toce.z+toMknokttkn+toce.y*to){rstprn Mce.z=Mkto.rn toce},rtoce.y);tochn(){toce);toce.y=M.x=Mkto.rhhpnd:fpnitpnd(toce.xce.w);rstpkto.rhpnd(tprn toce.hn(v){rstpitchn(){rsv.x+toce.y.w*v.w},ls*v.y+toce.rn toce.x*z*v.z+tocedht:fpnitcngtoEq:fpn.z=(toce.z):Mkto.flhce.y);toce;toce.y=(toce.y):Mktoce.y<0)?Mhr(toce.x)kto.iscl(tscl(toce.xo.flhhr(toprn toce},sgkts:fpnitoce.w;rste.x=-toce.e.z=-toce.x;toce.y=-tchn(){toctoce.y;tocrn toce},nz;toce.w=-e.x*toce.xoce.y*toceo.eqrt(toctoce.z+tocpnitchn(){e.w*toce.w.y+toce.z*},lsngto:fx*toce.x+trstprn Mktce.w);rstpscl(toce.zo.flhhr(tohr(toce.z)kto.iscl(t;toce.w=(t):Mkto.flhoce.w<0)?M<0)?Mkto.ioce.w):Mktlkr(toce.ly)+Mkto.kb.dcvcdsEikMkto.kbe(tnitchn(){roce.w)},nhe(toce.z)+rmklczs:fp.kbe(toce.stprn toce<0)?Mkto.i.z);toce.w.x=(toce.xd(toce.w);Zsrh:fpnitrstprn toc=Mkto.rhpne},rhpndThrhpnd(tocechn(){toceto.iscl(to.x=Mkto.is;toce.w=Mk;toce.y=Mk.z=Mkto.isto.iscl(tocl(toce.x)ce.y);tocechn(){tocecl(toce.z)est===pndsst+3]=tocest){cf(hffkrrky},frhkttrcbpts,mKttrcbpts.w;rstprn :fpnitchn(krrky[hffecndsx,hffeoce.y+=(v.kr(l/hldLsx)*kluok;trn toce},l){toce.x+=sru:fpnitcngto)}rstphn(v,kluokltculyEikl(v.x-toce.sd)krrky=[w=krrky[hf===pndsfcntprn toce}rky,hffest,thKrrky:ffest+3];rspnitchn(krt+2];toce.){cf(krrkyfpnitchn(vkluok){toce},sqpkle:re(v2,v1).).kdd(v1);mpltculyEie.epbVsithklkr(kluokchn(v1,v2,rstprn tocrrky[hffeshffest===p];toce.z=kffest=0;tooce.y=krrkce.x=krrkyndsfcnsd)h[hffest];tffest){cf(y[hffest+12]=toce.z;t===pndsfcky[hffest+=0;krrky[hhffest+1]=ffest]=tocnsd)hffeste.x;krrky[];cf(hffestoce.y;krrhn(krrky,hv.x===tocerky:fpnitc==toce.y)&w===toce.w&(v.z===to.x)&&(v.y=ce.z)&&(v.){rstprn(())},frhmKrkttrcbpts.st=0;cndsxx];toce.y=rcbpts.ctskttrcbpts.mEczs+hffe=cndsx*kttst;toce.x=fcnsd)hffekrrky[cndsthre:fpnitkluok;tocee},lsruVsioce.z)*klu.w)*kluok;ok;toce.w+.z+=(v.z-t=(v.w-tocey-toce.y)*rstprn toco){toce.mpestLsngto:==hldLsngt){vkr hldLcf(hldLsngsngto=tocefpnitchn(l.lsngto();sngto())},to!==0&&l!ngsIkllbkiz,hrdsr){ttoce.hnIokoce._y=y;t=hrdsr||tooce._z=z;toce._x=x;toce._hrdsritchn(x,y,ce._hrdsr;z,hrdsr){tstprn nsw itchn(x,y,hr4(toce.xw)}};TORSS,toce.y,toTORSS.Vsitce.z,toce.nitchn(){r.Splsr=fpnkllbkia()}ngsIkllbki.hnIokngsI(){rstprn ){toce._z=toce._z},ea()},gst zst z(vklpstoce.hnIokvklps;toce.urhthtyus[XYZ,YZORSS.SplsrXZY,YXZDsfkpltHrd,ZYX];TOX,ZXY,RSS.Splsr.chnHrdsre=sr=XYZ;T._y=vklps;toce._x=vkklps){tocenIokngsIklprn toce._lbkia()},glps;toce.hst y(){rst x(vklps){y},est y(v)},est:fpn(){rstprn sIkllbkia(r},est hrdr=vklps;tosr(vklps){toce._hrdstoce._hrds,gst hrdsrce.hnIokngce._x},estthr:TORSS.{rstprn to,_y:0,_z:0DsfkpltHrd,_hrdsr:TOSplsr,_x:0RSS.Splsr.={ihnetrpisr,gst x()oce._hrdsr toce},ihusplsr._z;t(splsr){to_y=splsr._ce._x=splsy:fpnitchnr._x;toce.a();rstprny;toce._z=plsr.Rhtkt0;toce._y=r};TORSS.S_z=z||0;toSS.Splsr.Dce._hrdsr=y||0;toce.hrdsr||TORoce._x=x||sfkpltHrds},ilhns:fpx+1];toce.stprn toces.krrky[cnpts.krrky[dsx+2];tocz=kttrcbpte.w=kttrcbkrrky[cndscndsx+3];r.kbe(m31)<kn2(m21,m1));cf(Mktof(hrdsr===kecn(-ilkmZYX){toc1)}}sles ce._y=Mkto._z=Mkto.ktu(m31,-1,1,m22=ts[5]RSS.Mkto.i m21=ts[1]s=m.slsmsn=ts[4],m13te;vkr m11lkmu;vkr t=ts[0],m12r ilkmu=TO=ts[8];vkr1,1));cf(M.ktkn2(-m3lkmu(m32,-e._z=0}}sl{toce._x=Mes cf(hrds1,m11);tocr===ZXY)ce._y=Mktokto.kecn(io.ktkn2(-mmu(m13,-1,oce._z=Mkto.kbe(m13)to.ktkn2(-<0.99999){1));cf(Mkttoce._x=Mko.kecn(ilkm23,m33);t2)}sles{to;cf(Mkto.kkn2(m21,m299999){tocm33);toce.e._y=Mkto.be(m23)<0.ktkn2(m13,m23,-1,1))_z=Mkto.kt_y=0;toce.2)<0.99999sles{toce.Mkto.ktkn2kto.ktkn2((-m31,m33)){toce._y=;toce._z=Mkto.kbe(m3-m12,m22)}cn(-ilkmu(es{toce._x_x=Mkto.ke2(m32,m22)hrdsr===Y;toce._z=0=Mkto.ktkn}}sles cf(12,m11)}slXZ){toce.to.ktkn2(-oce._x=Mkttoce._z=Mk2,m33);tocm11)}sles{e._z=Mkto.o.ktkn2(m3ktkn2(m21,0.99999){ttoce._x=0;oce._y=Mkt;vkr m31=t==XYZ){ts[6],m33=toce._hrdsrs[10];hrdss[2],m32=tr=hrdsr||t,m23=ts[9];cf(hrdsr=pudkts){vkdsr;toce.hn(m,hrdsr,lbkia();rstktchnMktrtprn toce}nIokngsIkl,estFrhmRh=splsr._hrcx:fpnitchn;rstprn fst(v.x,v.y.Qpktsrnch||toce._hrhn(){vkr qdsr)},rshr,v.z,hrdsrdsr:fpnitcprn toce.e=nsw TORSSm33)}}slesn2(-m23,m2ktkn2(m13,=Mkto.ktkne._x=0;toc2(-m31,m112);toce._y)}sles{tocx=Mkto.ktke._y=Mkto.srnchn(q);dkts){cf(mhnFrhmQpktdsfcnsd)mkx4;mktrcx.trcx=nsw Tktrcx===pnORSS.Mktrcq,hrdsr,pumkasRhtktcSS.wkrn(Toce._y=Mkt}}sles{TOR3,m11)}sle(-m23,m33)s{toce._x=o.ktkn2(m1Mkto.ktkn2m32,m22);t;toce._y=0 fpnitchn(e.hnIokngsrcx;rstprn;rstprn ton:fpnitchnce},estFrhIkllbkia()mQpktsrnch=fkles)toc(){vkr mkthrdsr){rsthmRhtktchnpnitchn(v,rcx,hrdsr,}(),estFrhpudkts);rsMktrcx(mkttprn toce}toce.estFrmVsithr3:ff(pudkts!=: .estFrhmsr=hrdsr;ctrcx() gcv: +hrdsr)sn pnepuuhRhtktchnMkrtsd hrdsrORSS.Splsr}toce._hrdchn(splsr)wHrdsr){q.pkle:fpnitsr(toce);tn(q,nswHrdoce.estFrhestFrhmSplmQpktsrnchpnitchn(nssr)}}(),sqkto.ktkn2(==XZY){t{toce._x=Mo.kecn(-ilto.kbe(m12kmu(m12,-1oce._z=Mkt,1));cf(Mk cf(hrdsr=)<0.99999)99){toce._sles cf(hrm21)<0.999){toce._z,-1,1));cf=Mkto.kecndsr===YZX(ilkmu(m21m12,m22)}}(Mkto.kbe(ithr3;toceORSS.Lcns3w TORSS.Vsetkrt,snd)=pndsfcnsd{toce.etkr=fpnitchn(t=(etkrt!=hrdsr)}};T)?etkrt:ns]!==pndsfcky:fpnitchcf(krrky[3oce._x=krr1];toce._zky[0];tocen(krrky){t._y=krrky[)},frhmKrr=krrky[2];prn toce},oce._y,tocllbkia;rstIokngs:fpn.hnIokngsIitchn(iklle._z)}},hnbkia){toce(toce._x,tkllbkia=ik]=toce._y;nsd)krrky=y[hffest+1st===pndsfhffest]=tocnsd)hffes[];cf(hffet=0;krrky[y===pndsfcce._x;krrkSS.Vsithr3klRseplt){rn nsw TORchnklRseply,toce._z)t.est(tocerstprn hut._x,toce._{cf(hutchn}sles{rstp._z,toce._llbkia:fpnce._y,toceilhns:fpniRSS.Splsr(tchn(){rstitchn(){},prn nsw TOhnIokngsIktoce._x,tonklRseplt)st+2]=tocetchn(hutchhffest+3]=rrky},thVstoce._hrds._z;krrky[r;rstprn kkrrky[hffeithr3:fpnis3,est:fpn==pndsfcns:TORSS.Lcn TORSS.Vsihthtyus={ithr3};TORSd)?snd:nswS.Lcns3.ur.snd=(snd!hnetrpithrt){cf(krrkhrdsr=krrkrrky,hffeshnIokngsIk},thKrrky:llbkia();ry[3];toce.stprn tocensd)toce._fpnitchn(koce._hrdsrlsr._x===t_hrdsr===tsplsr._y=====toce._z=toce._y)&oce._x)&&(&(splsr._z{rstprn(sp)&&(splsr.oce.etkrt),ilkmuThLctoce.snd,t.epbVsithretkrtSnd.ee(uhcnt,tons){etkrtUce.etkrt);tchn(uhcntpbVsithre(kr rseplt=ns.etkrt);lTkrgst){vhuy(lcns.stsr:fpnitcnd);rstprntoce.snd.i toce},isnrt.ihuy(lchn(hutchnklhesetUhcnnsw TORSS..etkrt)},itprn toce.lyEiklkr(tdsltk(rsepVsithr3;rslt).mpltcuklTkrgst||).kdd(toce.epbVsithritchn(hutcprn rseplt){vkr rsepsw TORSS.Vlt=hutchnkhnklTkrgstlTkrgst||n,dsltk:fpnsithr3;rstplt=hutchn(){rstprn t){vkr rse.dcetknisTtchn(t,huth(toce.sndtoce.etkrt)},kt:fpnis:fpnitchnchnklTkrgsstprn fpnirkmstsr:fp.Vsithr3;rkr etkrtU=r etkrtSndnsw TORSS.nitchn(){vVsithr3;vktThUhcntUk=nsw TORSS)},dcetkni,toce.etkrd(toce.sndisEq:fpnitkrt.dcetknchn(){rstpt)},dcetknrn toce.ete(toce.sndisThEqpkrsSnd_etkrtUSnd2=etkrtkr t=etkrtkrtSnd);vkkrtSnd.dhtr etkrtSndSnd.dht(et_etkrtU=et;vkr etkrt(etkrtU);vklkr(0.5)}rgst||nsw mpltculyEihr3;rstprnoce.etkrt, rseplt.kdTORSS.VsitdVsithre(thutchnklTktoce.snd).){toce.etkt,snd){tocitchn(lcnsuy(etkrt);stprn tocetoce.snd.ie.etkrt.ihhuy(snd);ritchn(etkr},ihuy:fpnhcnte.lsngx);rstprn r c=0,cl=urhmUhcnte:e.mkasSmutfpnitchn(utoce},estFhcnte){tockx.ihuy(mky();fhr(vkr rseplt=hns,hutchnkThLcns);vkkr t=toce.krkmstsr(uilhesetUhclTkrgst){vntThUhcntU,ilkmuThLchcnt,ilkmucncty,-CnfVsithr2(Cnithr2(-Cnfcncty);tocsd)?mkx:nse.mkx=(mkxfcncty,Cnf!==pndsfcnnsw TORSS.w TORSS.Vsrn toce},sitchn(mktrtrcx);rstptkrt.kuuly.snd.kuulyMktrcx4(mkcx){toce.etrcx);tocektrcx4:fpnMktrcx4(mkcnsd)?mcn:nsw TORSS.cn!==pndsfy(toce)}};mcn,mkx){tTORSS.Bhx2Lcns3).ihu=fpnitchn((){rstprn(oce.mcn=(mcn);toce.mRSS.Bhx2.umcn.ihuy(mihnetrpithitchn(mcn,r:TORSS.Bhrhthtyus={x2,est:fpncncty)};TOmkx){toce.s:fpnitchntchn(lcns)snd)},ilhnns.etkrt.scns.snd.sqqpkle(toce{rstprn lc.etkrt)&&lqpkle:fpnipkle(toce.r v1=nsw T+){toce.sxitchn(){vkt(uhcnte[crhmIsntsrK])}rstprn ukndByUhcntoce},estFto;c<cl;c+ndEczs:fpnt)},kuulyMgst||nsw T(toce.etkrr3;rstprn pltculyEiktoce.dsltkORSS.Vsith(rseplt).mutchnklTkrlkr(t).kddtchn(uhcnt;cf(ilkmuTUhcnt:fpniORSS.Mkto.t}}(),ilheilkmu(t,0,hLcns){t=T1)}rstprn /etkrtSnd2setUhcntThoce.mcn.kd.epb(vsith(eiklkr){tx.kdd(vsitkndByEiklkhr);rstprnr);toce.mk toce},sxu){toce.mcnr:fpnitchn(bhx){toce.epb(oklfEy:fpnitchnmkx.ihuy(i;rstprn tosntsr).kddczs);toce.(oklfEczs)uy(isntsr)ce}}(),ihukndByUhcnttchnklTkrg.mcn)},sxuRSS.Vsithrsithre(toc2;rstprn rst||nsw TOseplt.epbV rseplt=hue.mkx,tocee.mcn.x)||e.mkx.x=to.mkx.x<tocCnfcncty;rnitchn(){rstprn tocece.mkx.y=-},smuty:fpfcncty;tocstprn(tocekrgst){vkrseplt.kddV(hutchnklTe.mcn,toce(0.5)},ecz.mkx).mpltsithre(tocculyEiklkr2;rstprn rs:fpnitchnchn(vsithruhcnt){tocithr:fpnituhcnt);tocprn toce},e.mkx.mkx(e.mcn.mcn(uhcnt);rst:fpnitchn(sxukndByVsRSS.Vsithry<toce.mcnst||nsw TOr:fpnitchn rseplt=hu(hutchnklT.y)},isntskrgst){vkr(toce.mkx.tchnklTkrguhcnt.x<toiklkr);tocuhcnt){cf(iklkr(eikltkcneUhcntkr);rstprne.mkx.kddE toce},ihndEiklkr(-e:fpnitchn(e.mcn.y=Cnbhx.mcn);t.mcn.x=tocuy(bhx.mkxmuty:fpnit);rstprn toce.mkx.ihoce},mkasS.mcn.ihuy(chn(){toceoce.mcn.ihr2;rstprn lkr(0.5);tsntsr,eczsuy(eczs).m){vkr oklffpnitchn(iEczs=v1.ihORSS.VsithpltculyEikepb(uhcnt)t){vkr ilkmusdUhcnt.v1.ihuy(uhtoce.mkx);cnt).ilkmumusdUhcnt=(toce.mcn,itchn(uhcnrstprn ilkx.mcn.y)&&nitchn(bhx.mcn.y<=bh.mcn.x<=bh<=toce.mkxx.mcn.x)&&){cf((toce(bhx.mkx.xkcneBhx:fp.x)&&(tocern rseplt.fpnitchn(uithr2;rstpnklTkrgst)Tkrgst||ns{vkr rseplhcnt,hutcht=hutchnkllkmuUhcnt:w TORSS.Vs-toce.mcn.hnklTkrgsttoce.mkx.xS.Vsithr2;hcnt.x-tocrstprn rse||nsw TORSplt.est((useplt=hutce.mcn.x)/(rn trps},i.mcn.x>tocfkles}rstphx.mkx.y<t>toce.mkx.oce.mcn.y|e.mkx.x||b|bhx.mcn.ymcn.x||bhxy){rstprn rstprn fpn).ilkmu(toS.Vsithr2;e.mkx)},dchn(){vkr vetknisThUhce.mcn,toccnt:fpnitcihuy(uhcnt1=nsw TORSkx.x<toce.y-toce.mcn){cf(bhx.mmkx.y-tocetchnBhx:fp.mcn.y))},.y)/(toce.ceCntsresix),(uhcnt.nitchn(bhxoce},pnchn}(),cntsre);rstprn thn(bhx){totoce.mkx.mce.mcn.mkxsit:fpnitc(bhx.mcn);.lsngto()}cn(bhx.mkxgst){vkr r<=toce.mkxutchnklTkrn trps}rsttsr:fpnitcprn fkles}.y)){rstpr,gstUkrkms(bhx.mkx.yhn(uhcnt,htrps},ihntuhcnt.x>toes}rstprn uhcnt.y<toce.mkx.y){ce.mcn.y||ce.mkx.x||uhcnt.y>toce.mcn.x||rstprn fkl;toce.mkx.r oklfEczs(oklfEczs)czs).mpltcmcn.ihuy(iulyEiklkr(=v1.ihuy(e0.5);toce.r,eczs){vksntsr).epbsqpkle(tocd(hffest);n bhx.mcn.dd(hffest):fpnitchn(;rstprn totoce.mkx.kce},sqpkleoce.mcn.kdbhx){rstprByUhcnt(uhtchn(uhcntoce.sxukndasSmuty();e.lsngto;cfhr(vkr c=e){toce.mk0,cl=uhcnthcnte:fpni<cl;c++){ty);toce.mk,mkx){tocety,Cnfcnct==pndsfcnsthr3(Cnfcnd)?mcn:nsw.mcn=(mcn! TORSS.Vsinitchn(mcncty,Cnfcnc},estFrhmURSS.Bhx3,estprn tocen(mcn,mkx)toce.mkx.i{toce.mcn.st:fpnitchihuy(mcn);trpithr:TOhuy(mkx);rtchn(isntsstprn tocestprn fpnisntsrKndEc=nsw TORSSzs:fpnitch},estFrhmIn(){vkr v1cnte[c])}r.Vsithr3;rtyus={ihnendsfcnsd)?Bhx3.urhthRSS.Vsithry,-Cnfcnct3(-Cnfcnctmkx:nsw TOy,-Cnfcnctx=(mkx!==py)};TORSS.r3;rstprn r).kdd(oklORSS.Vsithprn toce}}itchn(){vk(),estFrhmfEczs);rstHbjsit:fpnihuy(isntsr v1=nsw TSS.Bhx3=fpx.mkx.sqpkoce)}};TORx)},ilhns:w TORSS.Bhfpnitchn()le(toce.mk{rstprn(nse.mcn)&&bhx2).ihuy(t(hffest){tbhx){toce.s:fpnitchnx.mcn);tocstprn tocee.mkx.mkx(mcn.mcn(bhbhx.mkx);r:fpnitchn(},trknelkttprn(toce.ncty;toce.itchn(){rs.mkx.y=toctprn toce}e.mkx.z=-Cmkx.x=tocenfcncty;rsmcn.z=Cnfc,smuty:fpnS.Gshmstry{vkr gshmsnishf TORSshmstry;cfd){cf(gshm(gshmstry!try=nhds.g==pndsfcnstchn(nhds)stry cnetkx){toce.mc(nhds.mktrpnitchn(bhihus.sxukntprn toce}dByUhcnt(vcxWhrld);e1)}}}});rsulyMktrcx4}(),ihuy:fffsrGshmst(nhds.mktrf TORSS.Bpihus.sxuknf(gshmstrydByUhcnt(vcxWhrld);e1)}}sles culyMktrcx4 cnetknish+2]);v1.ku=0,cl=uhechectchne[cto;c<cl;c+[c],uhectc=3){v1.esttchne.lsng(uhectchne;fhr(vkr chne[c+1],ucn.y=toce..mcn);tocen.x=toce.mbhx.mkx);ry:fpnitchnstprn toce.mkx.ihuy(},mkasSmutn.ihuy(bhx(){toce.mchn].krrkyry.kttrcbpse[uhectcchn]!==pnne=gshmstrdsfcnsd){vtse[uhectkr uhectchry&&gshmsty.kttrcbptnklTkrgst).mcn.x)||(tchn(hutch<toce.mcn..mcn.z)},iy)||(toce.toce.mkx.ymkx.z<tocemkx.x<tocesntsr:fpni[c]);v1.kucise=gshmsy(vsrtcisese;fhr(vkrgto;c<cl;c c=0,cl=vstry.vsrtcirtcise.lsn){vkr vsrt++){v1.ihuvsres(fpnibjsit){vkrhbjsit.trke;hbjsit.ps);toce.mkudktsMktrc eihus=tocxWhrld(trpfpnitchn(hasSmuty();rkmstsr:fptoce.mcn.zles},gstUkz)&&(bhx.mstprn trpskx.z<=toce<=bhx.mcn..mkx.z)){r.mkx.y)&&(}rstprn fkrn rseplt.,eczs:fpniithr3;rstpnklTkrgst)Tkrgst||ns{vkr rsepltchn(hutcht=hutchnklklkr(0.5)}w TORSS.Vsx:fpnitchn.y||uhcnt.ihntkcneBh.z||uhcnt. fkles}rstz>toce.mkxz<toce.mcn.z){rstprny>toce.mkxprn trps},tprn toce}ce},sxukndvsithr);rspnitchn(vssithr);tocithr){toceByVsithr:f.mcn.epb(v;rstprn toe.mkx.kdd(.y||uhcnt.hcnt:fpnity<toce.mcn{cf(uhcnt.x>toce.mkxx<toce.mcnchn(uhcnt).x||uhcnt.,ihntkcneU.x||uhcnt.kx.y<=tocetoce.mcn.xy)&&(bhx.mx)&&(bhx.mtoce.mcn.ykx.x<=toce<=bhx.mcn..mkx.x)&&((bhx){cf((<=bhx.mcn.tprn toce}iklkr:fpnieiklkr);rsr){toce.mc;toce.mkx.n.kddEiklktchn(eiklkr(-eiklkr),sxukndByEkddEiklkr(t((uhcnt.xnt,hutchnk rseplt.eskr rseplt=TORSS.VsithutchnklTklTkrgst){vrgst||nsw nitchn(uhchr3;rstprnmkx(uhcnt)(toce.mkx,;toce.mkx.,sxukndByU{toce.mcn.hcnt:fpnittoce.mcn)}chn(uhcnt)epbVsithremcn(uhcnt)mpltculyEit=hutchnkltoce.mkx).w TORSS.VskddVsithreithr3;rstpTkrgst||nsrn rseplt.{vkr rsepl(toce.mcn,(bhx.mcn);oce.eczs(vce.mcn.mkx)*0.5;rstpsit:fpnitcrn rseplt}1).lsngto(}(),cntsret.rkdcpe=thn(bhx){tomcn.x>tocekx.z-toce.cn.x||bhx.eCntsresit{cf(bhx.mkchnBhx:fpnmcn.z))},citchn(bhx)z)/(toce.mx.x<toce.m;rstprn fpnt.epb(uhcSS.Vsithr3()}}(),gstchn(){vkr BhpndcngEunt).lsngtoosrs:fpnitilkmusdUhcv1=nsw TOR|nsw TORSSstprn trpsnklTkrgst|nt:fpnitchst){vkr rsn(uhcnt,hu},ilkmuUhctchnklTkrgrn fkles}replt=hutchx);rstprn r3;rstprn cn,toce.mkhcnt){vkr (uhcnt).ililkmusdUhcfpnitchn(unt=v1.ihuyORSS.Vsithkmu(toce.msr();rseplchnklTkrgs=toce.isntplt=hutchnEuosrs;rseklTkrgst||t){vkr rsensw TORSS.nitchn(hutplt.isntsrr v1=nsw Tstprn rsepitchn(){vkcnt).ilkmu,dcetknisT(toce.mcn,lt.ihuy(uhtoce.mkx)}.Vsithr3;rhUhcnt:fpnbhx.mkx);rcn(bhx.mkxe.mkx.mkx(oce},pnchnmcn.mcn(bh:fpnitchn();rstprn tbhx){toce.toce.mkx.mx.mcn);tockx.z){rstpx.mkx.y<ton.z>toce.mbhx.mcn.y>z<toce.mcntoce.mkx.yce.mcn.y||||bhx.mkx..mkx.x||bh.z||bhx.mc-toce.mcn.x)/(toce.m),(uhcnt.zmcn.x),(uhoce.mkx.y-cnt.y-tocekx.x-toce..mcn.y)/(t-toce.mcn.toce.mcn.yhffest);rse);rstprn e.mkx.kdd(rknelkts:f.mcn.kdd(hpnitchn(hftoce}}(),tfest){tocecnte(uhcntffest);toc3];rstprn S.Vsithr3,RSS.VsithrVsithr3,nsTORSS.Vsitw TORSS.Vsnsw TORSS.ithr3,nsw 3,nsw TORShr3,nsw TO4(mktrcx);kuulyMktrcuulyMktrcx;uhcnte[6].mkx.y,toc.est(toce.x4(mktrcx)mkx.x,tocece.mkx.z).e.mcn.z).k,toce.mcn.,toce.mcn.toce.mkx.y.z).kuulyMe[2].est(tktrcx4(mkty,toce.mkxrcx);uhcnttoce.mcn.xoce.mcn.x,e.mcn.y,toe.mkx.x,to.mkx.x,tococe.mcn.z));uhcnte[5.kuulyMktrce.mcn.y,tcx4(mktrcx4].est(toc].est(toce.estFrhmUhest(toce.muty();tocemkx.y,toce(mktrcx);t.mkx.z).kukx.x,toce.ulyMktrcx4uhcnte[7].oce.mkasSmx);uhcnte[trcx4(mktrrcx4(mktrc[3].est(totoce.mkx.zce.mcn.x,tcx);uhcnteoce.mkx.y,z).kuulyMk).kuulyMkt,ilhns:fpn,sqpkle:fptoce.mkx)}){rstprn bcn)&&bhx.mhx.mcn.sqpnitchn(bhxkle(toce.mtprn toce}kx.sqpkle(te[1].est(ktrcx){uhctrcx);uhcn(toce.mcn.n.z).kuulyx,toce.mcnnte[0].est.y,toce.mcfpnitchn(mMktrcx4(mkRSS.Vsithr},kuulyMkthr3,nsw TOchn(){vkr ithr3,nsw uhcnte=[nsrcx4:fpnitw TORSS.Vsstprn toceTORSS.Vsitrrky() oke)},mpltcullyVsithr3Krky:fpnitcRSS.Mktrcxhn(k){TORSyVsithr3KrS.wkrn(TOtrcx3(toce3: .mpltcu lhngsr rs,0,0,0,1])trpithr nhnte.lsngtoSS.Mktrcx3>0){TORSS.;cf(krgpmssrrhr(TOR[1,0,0,0,1: tos ihnetrcx3: .mp,ms[5],ms[(TORSS.Mk toce},mpln(vsithr){tculyVsith8]);rstprnr3:fpnitchs[7],ms[2]TORSS.wkrn;ts[1]=n21,n13,n21,n;ts[6]=n13,n32,n33){;ts[0]=n11vkr ts=toc22,n23,n31e.slsmsntehn(n11,n12;ts[3]=n121],ms[4],m);rstprn t,ms[6],ms[fpnitchn(mtoce.est(m){vkr ms=moce},ihuy:.slsmsnte;,1,0,0,0,1s[0],ms[3]hr.kuulyMkhr3() oke stprn vsitsd. Pes vsktrcx ) cnithr.kuulybssn rsmhvMktrcx3( mltculyVsitetskd.);rst(1,0,0,0;ts[7]=n23n(){toce.e;ts[5]=n32ce},cdsntc;ts[8]=n33;ts[2]=n31;rstprn to;ts[4]=n22ty:fpnitchr3Krrky(k)msd. Pes mulyThVsithyThVsithr3kd.);rstpKrrky( krrktrcx.kuulky ) cnets bssn rsnkrn toce.kuest:fpnitcnte. pes .S.Mktrcx3,skd.)}};Tus={ihnetrORSS.Mktrcest() cnetx3.urhthtykde krgpmspithr:TORSkt32Krrky(tprn(nsw Tte=nsw Flh.ihuy(tocenitchn(){t)}};TORSS.ORSS.Bhx3)Mktrcx3=fpitchn(){rsoce.slsmsn];ts[5]=-m*ms[1]-ms[ms[2]*ms[8s[3]=-ms[1;ts[4]=ms[0]*ms[4]+m2]*ms[5];ts[6]*ms[8]s[2]=ms[6]10]*ms[0]-<lsngto;c+sfcnsd)hffj=hffest;csngto===pn.lsngto;fhdsfcnsd)lsest=0;cf(lngto=krrkyfest===pndr(vkr c=0,){vkr ms=m*s*c-k*f*oCnvsrtcbls*g+i*d*o-iitchn(mktr*s*g},gstC-b*d*c+b*fnvsres:fpn];rstprn kcx,torhwHn[0]*=e;ts[ky[j+2]=v1lsmsnte;tskrrky}}(),chn(e){vkrmpltculyEi.z}rstprn klkr:fpnit]=v1.y;krr ts=toce.s[7],c=ts[8s=toce.slsts[6],o=tsk=ts[0],b=],s=ts[4],ts[1],i=tsmsnte;vkr [2],d=ts[3hn(){vkr tf=ts[5],g=2]*ms[9];tsnte;vkr t*ms[1]+ms[msnte;ts[0*ms[9];ts[]=ms[10]*ms=toce.slss[5]-ms[6]ktrcx.slsm1]=-ms[10]knt:fpnitc]*=e;ts[1]},dstsrmcn=e;ts[7]*=ts[8]*=e;re;ts[2]*=e*=e;ts[4]*;ts[5]*=e;3]*=e;ts[6stprn tocems[5]*ms[0+ms[2]*ms[[8];ts[8]=s[9]*ms[4]ms[9]*ms[0-ms[5]*ms[4];ts[6]=m8];ts[7]=-s[6]*ms[0]]+ms[1]*ms;krrky[j+11.x=krrky[ky[j]=v1.xrky[j+1];vulyMktrcx31.z=krrky[j];v1.y=krj+2];v1.ku=3,j+=3){v(toce);krrgto){cf(hfsithr3Krrkhffest,lsn(){vkr v1=tprn fpnitnsw TORSS.y:fpnitchnVsithr3;rs},kuulyThVchn(krrky,];r[7]=m[5ce.slsmsnt];r[6]=m[2];r[1]=m[3];r[4]=m[4];r[2]=m[6e;r[0]=m[0];r[3]=m[1){vkr m=to];r[5]=m[7}sles{TORSsrt mktrcxrrhr(meg);knt ce 0";||fkles){tcf(torhwHn, dstsrmcnCnvsrtcbls iknt cnvorhw nsw Sn krrky},g5]=ts[5];ks[8];rstprt+6]=ts[6]7];krrky[h;krrky[hffrrky[hffesest+7]=ts[ky[hffest+ffest+8]=t];m[5]=m[7,m=toce.slmu;tmu=m[5=m[1];m[1][2];m[2]=m=m[3];m[3]smsnte;tmu=tmu;tmu=m(){vkr tmu[6];m[6]=t=ts[4];krrrrky[hffes[hffest+4];krrky[hffffest+3]=test+2]=ts[t+1]=ts[1]2];krrky[ht]=ts[0];ks[3];krrkyfpnitchn(rtrcx:fpnitCnthKrrky:e.gstCnvsrtprn toce}es(m).trknchn(m){toceuhes();rsstNhrmklMk,trkneuhesrrky[hffes;rstprn toslsmsnte;knThKrrkyHfhffest){vkfest:fpnitce},flkttschn(krrky,];m[7]=tmur ts=toce.hKrrky:fpn];rstprn trn toce},trrky:fpnitsnte.est(kchn(krrky)oce},frhmK{toce.slsm];r[8]=m[8rrky);rstps:fpnitchn)}toce.cds},trkneuhetprn toce}1.0/dst);rtoce.mpltcntcty();rsulyEiklkr(S.wkrn(megstprn toceCnvsres():[4];vkr dsktrcx3.gst[0]+ms[1]*(dst===0){ts[3]+ms[2t=ms[0]*ts]*ts[6];cf]-ms[1]*msvkr meg="M.sxtrkitUhm.slsmsnte.Mktrcx4: oce},sxtrkm){TORSS.witUhectchn);rstprn t:fpnitchn(msnte.est(krn(TORSSe.slsmsntestprn(nsw tchn(){toccx3).frhmK};TORSS.Mkrrky(toce.TORSS.Mktrslsmsnte)}nitchn(){rtrcx4=fpniprn toce},31;ts[6]=n5]=n44;rstn33;ts[14]=n42;ts[11=n34;ts[3]32;ts[10]==n41;ts[7]24;ts[2]=n]=n43;ts[1tyus={ihnenetrpithr rcx4.urhthrskde krgpetskd.)}}msnte. pesnh lhngsr  .est() cnx4: tos ih;TORSS.Mkt3;ts[13]=ne.slsmsnte2;ts[9]=n2;ts[4]=n124;ts[1]=n2;ts[8]=n13;ts[0]=n11;ts[12]=n1vkr ts=toc1;ts[5]=n2){toce.slspnitchn(){fpnitchn(m,0,0,0,0,1);rstprn t,0,0,0,0,1toce.est(1,0,0,0,0,1cdsntcty:foce},ihuy:,n43,n44){RSS.Mktrcx34,n41,n42tchn(n11,n23,n24,n3112,n13,n144,est:fpni,n21,n22,ntrpithr:TO,n32,n33,nfpnitchn(mke bssn rsyUhectchn:ihuyUhectcihuyUhectchn().);rsnkmsd th .tprn toce.ectchn() ohn(m)},ihuORSS.Mktrc32Krrky([1S.srrhr(T,0,0,0,0,1msnte.lsng,0,0,0,0,1,0,0,0,0,1]);cf(krgp=nsw Flhktto>0){TORS},ilhns:fpr ts=toce.[7],ts[8]]stprn[ts[0ts[4],ts[5],ts[1],tsslsmsnte;r[2],ts[3],itchn(){vk],ts[6],ts(splsr cnesZ;ts[10]=(splsr){cflsZ;rstprnhnFrhmSpls toce}}(),ms[10]*eikmkasRhtktcms[9]*eiklr:fpnitchnce.est(ts[pnitchn(xKts[2]);yKxzKxce){vkrxce.est(ts ts=toce.sxce,yKxce,lsmsnte;xKkitBkece:f[0],ts[1],]*eiklsX;t);vkr eiklts[1]=ms[1t(ms[8],ms;ts[0]=ms[[9],ms[10]sZ=1/v1.es).lsngto()]).lsngto(0]*eiklsX;1);rstprn e.x,yKxce.z,0,0,0,0,0,xKxce.y,xce.z,yKxcyKxce.y,zKx,zKxce.x,xce.y,0,xKe.est(xKxce.z,zKxce.ms[5],ms[6msnte;vkr est(ms[4],1.est(ms[0o();vkr ei],ms[1],mseiklsX=1/v[2]).lsngtr ms=m.slsklsY=1/v1.lsZ;ts[9]=*eiklsX;ts=ms[8]*eikeiklsY;ts[]=ms[6]*ei5]=ms[5]*e[4]=ms[4]*iklsY;ts[6s[2]=ms[2]klsY;ts[8]lsmsnte;vkkitRhtktch ts=toce.s(){vkr v1=tprn fpnitnsw TORSS.n:fpnitchnVsithr3;rstoce},sxtrchn(m){vkrte k SplsrRSS.Splsr= nhw sxusiORSS.srrhrsRhtktchnF(TORSS.Mk==fkles){Ttrcx: .mkatknishf TOrhmSplsr()zKxce){tocs[6]);zKxcxce,yKxce,],ts[9],tskasBkece:f[10]);rstpe.est(ts[8rn toce},m4],ts[5],tpnitchn(xKtoce},sxtroce.slsmsn4];rstprn m.slsmsnte]=ms[13];t;ts[12]=mste;vkr ms=[12];ts[13){vkr ts=ts[14]=ms[1vkr ki=k*if*d+ks;ts[===YZX){;ts[2]=-d;}sles cf(sts[6]=b*i;9]=kf*d-bsts[10]=k*i*f;ts[5]=bplsr.hrdsrcn(z);cf(s.ihe(x),b=),f=Mkto.e);vkr i=Mk(y);vkr s=to.ihe(y),Mkto.ecn(xd=Mkto.ecnvkr k=MktoMkto.ihe(zk*i}sles cf;ts[8]=ds=b;ts[10]=]=if+ds*b;s*b;ts[2]=ts[5]=k*s;+if*b;ts[1ts[9]=df-i;ts[4]=-k*-k*d;ts[6]r is=i*s,is[9]=-b*i;=YXZ){vks*d;ts[6]=les cf(splbs+kf*d;tsts[2]=bf-k[10]=k*i}s=ks-bf*d;tsr.hrdsr==0]=is-df*bis*b;ts[10df=d*f;ts[ cf(splsr.s=i*s,if=ihrdsr===Z]=k*i}slesXY){vkr i;ts[6]=df+*f,ds=d*s,bf;ts[1]=idsr===ZYXs[8]=ks*d+k*s,kf=k*f=i*s;ts[4],bs=b*s,bf){vkr ks==b*f;ts[0]f(splsr.hr=bs*d-kf;t2]=if*b-ds*s,df=d*f;[9]=-b;ts[f*b;ts[4]=[1]=k*f;tsds*b-if;tsts[0]=is+d[8]=k*d;tsf=i*f,ds=d[5]=k*s;tss[2]=-d*s;=b*i,bd=b*[9]=-b*s;ts;ts[4]=bdts[1]=f;ts-ki*f;ts[8d;ts[0]=i*]=bi*f+kd;,kd=k*d,bi[5]=k*s;tsbs*d;ts[5]===XYZ){;ts[1]=kf+,kf=k*f,bss;ts[4]=-i=b*s,bf=b*vkr ks=k*sf;ts[0]=i*plsr.hrdsr*f;ts[8]=dz=splsr.z;rktosr toky=splsr.y,3 knd hrdsmsnte;vkr r.)}vkr tn k Vsithrs=toce.sls rhtktchn x=splsr.x,hr3;vkr y=0;ts[13]=0TORSS.Vsitts[15]=1;rpnitchn(){stprn toce;ts[14]=0;},lhhaKt:f=0;ts[12]=vkr x=nsw *f+ki}ts[3s[8]=d*s;t;ts[10]=bdbd;ts[5]=k2]=bi*f-kd*s;ts[9]=ks[1]=ki*f+d*f-bi;ts[ts[4]=-f;t;ts[6]=b*s=xz+wy;ts[y2,yz=y*z2y-wz;ts[8]kr wx=w*x20]=1-(yy+z,wy=w*y2,w,zz=z*z2;vz=w*z2;ts[;vkr yy=y*z);ts[4]=xhtktchnFrhRSS.wkrn( th .mkasRcx4: .estRn() oke bshtktchnFrhTORSS.MktrmQpktsrnchtchn(q){TOsn rsnkmsdy2,xz=x*z2.slsmsnte;x*x2,xy=x*y=q.y,z=q.2=y+y,z2=zz,w=q.w;vkvkr x=q.x,r x2=x+x,ykr ts=toce+z;vkr xx=]=0;ts[11]s[5]=1-(xx[3]=0;ts[7=yz-wx;ts[;ts[10]=1-2]=xz-wy;t+zz);ts[9]s[6]=yz+wx1]=xy+wz;t(xx+yy);tsitchn(q){vn().);rstsrnchn:fpnkasRhtktchmkasRhtktcnFrhmQpktsprn toce.mrnchn(q)},mQpktsrnchhnFrhmQpktnte;z.epbVVsithr3;vktoce.slsmsRSS.Vsithrs,tkrgst,p3;rstprn fr z=nsw TOpnitchn(synsw TORSS.u){vkr ts=rnchn:fpni0;ts[11]=0nFrhmQpktsts[13]=0;tprn toce},s[14]=0;ts;ts[12]=0;[15]=1;rst]=0;ts[7]=estRhtktchts[0]=i*s;+bi;ts[10]*i,bd=b*d;les cf(splr ki=k*i,ksr.hrdsr===ki-bd*f}s=XZY){vkts[6]=kd*fd=k*d,bi=b3=bs[10],b4=bs[12];v2=bs[6],b31],b22=bs[13];vkr b35],b23=bs[kr b21=bs[9],b24=bs[3=bs[8],b11=bs[2],b3.x;ts[8]=zx+=0.0001;.x;ts[4]=ythre(pu,z)Vsithre(z,.nhrmklczsx.irheeVsi()}y.irhee()===0){z.x);ts[0]=xks[2],k32=ks[4],k13=];vkr k31=ks[12];vkr,k23=ks[9] k21=ks[1]ks[8],k14=,k22=ks[5]ks[0],k12=,k24=ks[13 Pes .mpltpndsfcnsd) krgpmsnt.n(TORSS.Mnhw hnly kktrcx4: .m{TORSS.wkrpltculy() n){cf(n!==iisute hnse;vkr k11=lyMktrcisece.slsmsntk,b){vkr kb.slsmsntes=k.slsmsn:fpnitchn(te;vkr bs=m)},mpltcu;vkr ts=to2=bs[4],b1ks[10],k341=bs[0],b1r k41=ks[31],k44=ks[],k42=ks[7=ks[14];vk],k43=ks[1ks[6],k33=15];vkr b1cise(toce,se( k, b )ltculyMktr);rstprn t(m,n)}rstpoce.mpltcu cnetskd.lyMktrciseculyMktrcirn toce.mpb41;ts[4]=vkr b41=bs3*b31+k14*[7],b43=bs]=k11*b11+[11],b44=b[3],b42=bss[15];ts[034=bs[14];k12*b21+k1pnitchn(m,.y;ts[5]=ympltculy:f.y;ts[2]=xz.z;rstprn.z;ts[6]=y.y;ts[9]=z.z;ts[10]=.x;ts[1]=x toce}}(),f(x.lsngto,tkrgst).nmklczs();c;cf(z.lsngheeVsithreto()===0){hrmklczs()z.z=1}x.irsithre(sys(pu,z).nhr{vkr ts=to];r[13]=tspnitchn(e)=ts[14];r[ce},mpltcu15]=ts[15][13];r[14];rstprn to[12]=ts[12lyEiklkr:f=k21*b13+ks[1]=k21*b*b42;ts[9]+k23*b31+k+k22*b22+k24*b41;ts[11+k22*b215]=k21*b12+k14*b44;t23*b32+k24ts[2];r[3]b,r){vkr ts[1];r[2]=msnte;toceb);r[0]=ts.mpltculyMs=toce.slsktrcise(k,pnitchn(k,[0];r[1]=t4+k32*b24+b12+k32*b214]=k31*b1k34*b42;ts+k33*b33+k[10]=k31*b2+k33*b32+13+k32*b23ts[6]=k31*34*b43;ts[yThKrrky:f*b23+k43*be},mpltcul;ts[15]=k44+k44*b44;1*b14+k42*33+k44*b43b24+k43*b341*b13+k42rstprn toc]=ts[11];r]=ts[4];r[s[10];r[11[6]=ts[6];];r[9]=ts[r[7]=ts[7]5]=ts[5];r;r[8]=ts[8=ts[3];r[49];r[10]=t2;ts[11]=k4*b44;ts[3b32+k44*b4k42*b21+k4k41*b12+k43*b31+k44*]=k41*b11+b41;ts[7]=k33*b34+k32*b22+k43*]*=e;ts[6]e;ts[0]*=e3]*=e;ts[2ts[8]*=e;t[5]*=e;ts[s[12]*=e;t;ts[4]*=e;s[1]*=e;tsce.slsmsnt9]*=e;ts[11+k34*b41;*b33+k24*bb21+k33*b3k21*b14+k24;ts[2]=k32*b24+k23*43;ts[13]=b34+k24*b422*b23+k231*b11+k32*24+k13*b342*b22+k13**b14+k12*b2;ts[8]=k13+k14*b43;1*b13+k12*b32+k14*b4b23+k13*b3k11*b12+k1ts[12]=k11];v1.z=krrrky.lsngto=krrky[j+1=0,j=hffes){v1.x=krrt;c<lsngto;fhr(vkr c;c+=3,j+=3)lsngto=krky[j];v1.ytrcx4( mktRSS.wkrn(hr.kuulyMkcx4: .mpltsn rsmhvsdculyVsithrTORSS.Mktr3() oke bsvsithr){TO. Pes vsitv1=nsw TORetskd.);rchn(){vkr .kuulyThVsThVsithr3Kithr3Krrkystprn toce(k)},kuulykrrky ) cnrrky:fpnit vsithr.kutchn(vsithmhvsd. Peskrn(TORSSsithr4() o.Mktrcx4: r){TORSS.w.mpltculyVithr4:fpnike bssn rshr3Krrky( TORSS.MktuulyThVsittculyVsithsnkmsd. Per3Krrky() rcx4: .mploke bssn rORSS.wkrn(s mktrcx.k=pndsfcnsd;rstprn fpf(lsngto==ky,hffest,pndsfcnsd)lsngto){cfnitchn(krr(hffest===SS.Vsithr3hffest=0;citchn(k){T( mktrcx )3Krrky:fpn);rstprn voce)},mpltsithr.kuul cnetskd.yMktrcx4(tulyMktrcx4culyVsithr(),rhtktsK.kuulyMktrrn krrky}}krrky[j]=vkrrky[j+2]1.x;krrky[cx4(toce);j+1]=v1.y;ky[j+2];v1=v1.z}rstpmpltculyVssithr.kuulhn(toce)},n( mktrcx vsithr.kuu) cnetskd.yUrhjsitch);rstprn rcx ) hr vlyUrhjsitc:fpnitchn(*=e;ts[14]ulyVsithr3=e;ts[7]*=e;rstprn te;ts[11]*=*=e;ts[3]*e;ts[15]*=*=e;ts[10]oce},mpltchn(){vkr t-n11*n23*nhes:fpnitc*n33+n13*n12*n23*n3121*n32-n1232+n11*n22*n21*n33+n13*n22*n31))},trkneuwkrn(TORSrcx ) cnethr){TORSS.rknefhrmDcVsithr:fpnrsitchn(toskd.);v.tce)},irheeitchn( mktitchn(vsit13*n24*n31n13*n22*n3*n21*n34+nn34)+n42*(*n33+n14*n+n11*n23*n4-n12*n23*34-n11*n242*n24*n33+21*n33-n13,n13=ts[8]trcx4(toce,n12=ts[4]nknt:fpnitsmsnte;vkrchn(){vkr )},dstsrmcts=toce.slhr.kuulyMk n11=ts[0]n22*n33+n1=ts[3],n424*n32-n14*=ts[11],n4(+n14*n23*4=ts[15];r=ts[7],n43stprn(n41*4];vkr n41n32-n13*n21)+n44*(-n31)+n43*(+n12*n24*n32-n11*n22*n21*n34+n1n34-n14*n2n11*n24*n31*n32+n12*-n14*n23*n4*n22*n31-],n34=ts[1];vkr n21=,n33=ts[10ts[5],n23= n31=ts[2]ts[9],n24=ts[1],n22=ts[13];vkr,n14=ts[12,n32=ts[6]u=ts[6];tsmsnte;vkr [8]=tmu;tm[1];ts[1]=ts[2];ts[2ts[4];ts[4tmu;tmu=ts]=tmu;tmu=s=toce.sls]=ts[8];tsstprn vsit .irheeVsietskd.);rbssn rsmhvMktrcx4( msd. Pes vsthr() oke ithr.kuulyS.Mktrcx4:ktrcx ) cnnefhrmDcrshn(v){TORSsithr3.trkRSS.Mktrcx bssn rsmh4: .rhtktsS.wkrn(TOKxce() okexce:fpnitcvsd. Pes V14]=v.z;rs[14])}}(),3]=v.y;ts[n:fpnitchnsnte;ts[12(v){vkr tsestUhectch=toce.slsm,ts[13],ts]=v.x;ts[1ce.slsmsnt4];ts[14]={vkr ts=to toce},flknitchn(krrttsnThKrrktmu;rstprnyHffest:fps[11]=ts[1ky,hffest)bssn rsmhvw TORSS.Vschn() oke rn fpnitchS.Mktrcx4:n(){TORSS.ithr3;rstpwkrn(TORS{vkr v1=ns .gstUhect]=ts[8];krkrrky[hffey[hffest+8];krrky[hfhffest+7]=fest+6]=tsst+5]=ts[5[6];krrky[+4]=ts[4];ts[7];krrkfpnitchn()s[13];krrktUhectchn:4]=ts[14];15];rstprnkrrky[hffey[hffest+1st+15]=ts[fest+13]=t krrky},gsest(ts[12]ithr3.estFrstprn v1.hectchn( mkr ts=tocektrcx ) cnrhmMktrcxUetskd.);vsd. Pes Vs.slsmsnte;];krrky[hf+9]=ts[9];+12]=ts[12st+10]=ts[=ts[11];kr10];krrky[krrky[hffehffest+11]rky[hffestrky[hffest;vkr n11=m,gstCnvsrem.slsmsnte(m,torhwHnoce.slsmsnCnvsrtcblss:fpnitchn){vkr ts=ttprn toce}te;vkr ms=rky[hffestfest]=ts[0]=ts[3];krfest+1]=tsts[2];krrk[1];krrky[];krrky[hfhffest+2]=e;krrky[hfy[hffest+3u=ts[11];tts[9]=tmu;13]=tmu;tmts[3]=ts[1[7];ts[7]=2];ts[12]=tmu=ts[3];tmu;tmu=ts[6]=ts[9];ts[13];ts[*n41-n12*n34*n41-n246]=n14*n3224*n31*n42*n44+n21*n-n21*n34*n*n32*n41+n42-n22*n31s[2]=n22*n32*n44;ts[-n24*n33*ns[10],n34=23*n34*n42 n41=ms[3]],n44=ms[1,n42=ms[7]ms[14];vkr,n43=ms[11s[6],n33=m5];ts[0]=n4*n43+n13*n34*n43-n1n43+n11*n2n11*n33*n4n13*n24*n44;ts[9]=n13*n31*n44+4*n23*n41-1*n43-n11*1-n14*n21**n44+n12*n32*n44-n1243-n13*n22s[8]=n13*n14*n22*n4324*n42-n14*n33*n44;t*n23*n42+n*n43+n13*n-n12*n24*nn41+n14*n34*n41-n24*1-n14*n33*1*n34*n43+n44;ts[5]=n23*n31*n4n31*n43+n24-n21*n33*n41-n23*n3n13*n34*n4*n23*n34;t1*n23*n44;21*n34+n11*n24*n31-n33-n11*n2414*n23*n31ts[13]=n13+n14*n21*nn21*n44-n1*n33-n13*n]=n24*n33*12]=n14*n23*n34;ts[1n24*n32-n13+n13*n22*4*n22*n33+3*n32-n13*n12*n24*n323*n44;ts[n34-n12*n2n21*n42-n1*n31*n42+n2*n41+n14*+n12*n31*n]=n12*n24*44-n11*n3211*n34*n42*n44;ts[1034*n41-n14n41-n14*n243+n12*n34*n43-n22*n-n14*n32*n*n32*n44+n*n33*n42-n22*n33*n4434*n43-n23;ts[4]=n1442+n24*n3213*n34*n42s[2],n32=ms[4],n13=m;vkr n31=ms[12];vkr n23=ms[9],n21=ms[1],s[8],n14=mn22=ms[5],s[0],n12=mn24=ms[13]gls){TORSS{TORSS.srrpnitchn(knMktrcx4: .smhvsd.)}rhtktsX() hr(TORSS.oke bssn rchn(kngls),rhtktsY:f;ts[7]=n1234;ts[3]=n21*n32*n43-n22*n33*n33*n42+n2241-n23*n3123*n32*n41*n42+n21*n-n11*n22*n*n31*n43-nrstprn tocg);}sles{Tkr(1/dst);meg)}toce.ce}toce.mpcdsntcty()ORSS.wkrn(;rstprn tow Srrhr(meltculyEikl-n11*n23*n2+n11*n23*13*n21*n321*n43-n11*23*n31-n13n22*n43;tsn42+n12*n2[15]=n12*nn13*n21*n4*n22*n31+n){torhw nsgstCnvsresbls||fklescnvsrt mkt0";cf(torhrcx, dstsr(): iknt mcnknt ce S.Mktrcx4.wHnCnvsrtcktsX:fpnitts:fpnitchsd.)},rht.srrhr(TOkts() oke RSS.Mktrcxn(v){TORSS4: .trknele},trknelkbssn rsmhv meg="TORS*n33+n11*nst==0){vkr dst=n11*ts[8]+n41*ts[0]+n21*t22*n33;vkrs[4]+n31*t32-n12*n21s[12];cf(d(TORSS.MkRSS.MktrcxORSS.srrhrY() oke bssZ:fpnitchsn rsmhvsd4: .rhtkts.)},rhtkt.srrhr(TOn(kngls){T2*n23*n41-13*n32*n41n22*n41-n142-n11*n33*n32*n43;t*n42-n12*n+n13*n31*n31*n43+n11*n33*n41-ns[11]=n13*12*n21*n34n12*n21*n4*n24*n32+nn44;ts[14]*n31-n14*n=n14*n22*n4+n11*n22*31-n12*n241*n24*n42-21*n32+n11,0,0,-e,0,hnY:fpnitc,0,e,0,0,1vkr i=Mktocn(tostk);.ihe(tostkhn(tostk){),e=Mkto.emkasRhtktctoce.est(i.y,z=v.z;tKxce() oke x=v.x,y=vvsd.)},eits=toce.slkls:fpnitc bssn rsmhhn(v){vkr  .rhtktsBysmsnte;vkrnitchn(tosn(x,y,z){ttktchnX:fp0,0,x,0,1,;rstprn to0,y,0,0,1,oce.est(1,z,0,0,0,1)hn:fpnitchce},mkasRh*ts[0]+ts[stprn tocesXEq=ts[0]klsHnKxce:ce.slsmsntfpnitchn()},gstMkxEi{vkr ts=tos[11]*=z;re;vkr eiklsTrknelktc10]*ts[10]Eq)))},mkato.eqrt(Mk.mkx(eiklsto.mkx(eik;rstprn MklsXEq,Mkto*ts[9]+ts[YEq,eiklsZprn toce},Mkto.ihe(t0,0,1);rstto.ecn(tos,0,i,-e,0,tk);toce.eostk),e=Mkst(1,0,0,0tk){vkr i=0,e,i,0,0,s[8]+ts[9]s[2]*ts[2]Eq=ts[8]*tYEq=ts[4]*[6]*ts[6];ts[4]+ts[5;vkr eikls]*ts[5]+ts1]*ts[1]+tvkr eiklsZostk);toce1);rstprn Mkto.ecn(tRhtktchnZ:i=Mkto.ihefpnitchn(ttoce},mkasostk){vkr i,0,0,0,0,(tostk),e=ts[7]*=y;t[4]*=y;ts[;ts[3]*=x;]*=x;ts[5]x;ts[6]*=y*=y;ts[9]*8]*=z;ts[1=z;ts[2]*=s[0]*=x;ts;ts[10]*=zS.Mktrcx4:tktsZ() okrrhr(TORShvsd.)},r(kxce,knglhtktsByKxce bssn rsme:fpnitchntrcx4: .rhs){TORSS.s[13];uhectto();vkr dctchn.y=tstsrmcnknt(hectchn.x=);cf(dst<0st=toce.ds){ex=-ex}u[10]).lsngts[12];uhe*y;toce.es);vkr e=Mkx=t*x,ty=tls);vkr t=xce.y,z=kx1-i;vkr x=to.ecn(kngkxce.x,y=k.ihe(knglsce.z;vkr test(ts[0],4;rstprn fex=vsithr.ectchn,qpks=toce.slstsrnchn,eipnitchn(uhkls){vkr tRSS.Mktrcxmsnte;vkr uhes:fpnitEikls:fpni toce},ihm){toce.est,z,0,0,0,0(x,0,0,0,0tchn(x,y,z,y,0,0,0,0toce},mkas,1);rstprnrcx=nsw TOuhectchn);r3;vkr mkte},dsihmuhithr=nsw Tes:fpnitchrstprn tocn(){vkr vstUhectchn(ORSS.Vsith],ts[9],ts]).lsngto(r.est(ts[8sithr.est(sngto();vkts[4],ts[5);vkr ey=v],ts[6]).lts[1],ts[2r ez=vsiths);toce.eshn,qpktsrneikls(eikl{toce.mkashn(qpktsrnRhtktchnFrchn,eikls)hmQpktsrncchn(uhectcchn);toce.ez;mktrcx.4];mktrcx.r cnvEZ=1/st(toce.slex;vkr cnvsmsnte);vkslsmsnte.er cnvEX=1/chn.z=ts[1EY=1/ey;vk1);rstprn x*y-e*z,txi,0,0,0,0,x*y+e*z,ty-e*y,ty*z+*y+i,ty*z-*z+e*y,0,te*x,0,tx*zt(tx*x+i,te*x,t*z*z+vkr i=Mkto0,0,e,i,0,ce,kngls){0,0,0,1);rtchnKxce:fstprn toce0,0,0,1,0,},mkasRhtk.est(i,-e,pnitchn(kxtpm(xmcn,x));vkr ymce.mkasFrper xmcn=ymckx*keusit;n*keusit;vn=-ymkx;vkkr xmkx=ymkd(fhv*0.5rstprn toc[9]*=cnvEZte[5]*=cnvx.slsmsnteslsmsnte[6snte[8]*=c]*=cnvEY;mEY;mktrcx.ktrcx.slsmrcx.slsmsnnvEZ;mktrc1;ts[15]=05]=y;ts[9]0;ts[11]=-0;ts[2]=0;14]=d;ts[3ts[6]=0;ts=b;ts[13]=[10]=i;ts[s[1]=0;ts[]=0;ts[7]=e;vkr x=2*oce}}(),mkce.slsmsntfpnitchn(l,nskr,fkr)sft,rcgot,asFrpetpm:bhtthm,thuz;rstprn t{vkr ts=tots[12]=0;tr i=-(fkr+0;ts[8]=k;-nskr);vkrnskr);ts[0 d=-2*fkr*nskr)/(fkrnskr/(fkr-bhtthm);vk]=x;ts[4]=kto.dsgThRce},mkasUskn(TORSS.Mfpnitchn(fvkr ymkx=nhv,keusit,reusitcvs:nskr,fkr){;rstprn toskr*Mkto.tthm)/(thu-t-lsft);vkb=(thu+bht/(thu-bhttt)/(rcgot-hm);vkr k=r y=2*nskr(rcgot+lsfnskr/(rcgolsft);vkr toce.slsmsmkx,nskr,fr){vkr ts=rtohgrkuoct,thu,bhtti:fpnitchnkr)},mkasH(lsft,rcgomkx,ymcn,yhm,nskr,fk;eikls.z=esmsnte[10]eikls.y=eyktsrnchn.e(mktrcx);estFrhmRhtk*=cnvEZ;qptchnMktrcx;mktrcx.slikls.x=ex;=cnvEY;mkt]*=cnvEX;msmsnte[4]*snte[1]*=c[2]*=cnvEXnvEX;mktrcktrcx.slsmx.slsmsnteslsmsnte[0;mktrcx.slcn.ihuy(rkhrcgcn);to{toce.hrcghn.ihuy(dc},ihuy:fpnrsitchn);rce.dcrsitcstprn tocecgcn.ihuy(itchn(rky)]=0;ts[6]=)/u;ts[0]=3]=-y;ts[20;ts[8]=0;[5]=2/o;tsts[12]=-x;2/w;ts[4]=ts[1]=0;ts=(fkr+nskr[9]=0;ts[1dcrsitchn:cn!==pndsfndsfcnsd)?cn:nsw TORitchn=(dcrSS.Vsithr3cnsd)?hrcg;toce.dcrscgcn=(hrcgsitchn!==p[1],ts[2],.est(krrkyn[ts[0],tsoce},thKrr=toce.slsmky:fpnitch);rstprn tn(){vkr tse.slsmsntesnte;rstprn){toce.hrnsw TORSS.n,dcrsitchrhmKrrky(tS.Rky=fpnioce.slsmsnMktrcx4).fte)}};TORS(){rstprn(tchn(hrcgcn){toce.hrVsithr3};Tn,dcrsitchrhthtyus={y,est:fpniihnetrpithORSS.Rky.ur:TORSS.Rknsw TORSS.tchn(hrcgcs:fpnitchn],ts[5],ts15]]},ilhnts[8],ts[92],ts[13],],ts[10],t[6],ts[7],s[11],ts[1ts[3],ts[4ts[14],ts[r rseplt=htoce.dcrsiTkrgst){vkrky.dcrsit:fpnitchn(chn);rstprtchn.ihuy(n toce},kty.hrcgcn);t,hutchnklkrrky){toc2/u;ts[14]:fpnitchn(0;ts[7]=0;tprn toce}ts[11]=0;t=-z;ts[3]=s[15]=1;rs0;ts[10]=-,frhmKrrkym)/o;vkr zrcgot-lsft(thu+bhtth-bhtthm;vkrcgot+lsftr u=fkr-ns;vkr o=thukr;vkr x=(nte;vkr w=)/w;vkr y=r esgIsntsd(toce.hrcitchn(){vkn v1.dcetktknisEqThEnisTh(uhcngcn);rstprt)}}(),dceetknis).kdsgmsnt:fpn(t,v1));rs:fpnitchn(uy(toce.ktsw TORSS.Vhn(t){tocesithr3;rst){vkr v1=nprn fpnitcn)},rsiket.hrcgcn.ihf(dcrsitchnt){vkr dcrsitchn);ctknis=v1.e.hrcgcn).dpbVsithre(rsitchnDceuhcnt,tocenitchn(uhcht(toce.dctchn);cf(drseplt.epbtoce.dcrsicnt,toce.hDcetknis=rrcgcn);vkrVsithre(uh dcrsitchnS.Vsithr3;seplt.dht(;rstprn fpnDcetknis)SS.Vsithr3hrcgcn)},dchn(){vkr cetknisThU.kdd(toce.hcnt:fpnitr(dcrsitchv1=nsw TORcrsitchnDc0){rstprn lyEiklkr(dn.dcetknisce.dcrsitcTh(uhcnt)}toce.hrcgcv1.ihuy(tonDcetknis<hn).mpltcutculyEiklketknis<0){itchn).mplplt.ihuy(tseplt.ihuyoce.hrcgcnrstprn rse)}rstprn rcrsitchnDc(toce.dcrsn(v0,v1,huS.Vsithr3;rn fpnitch=nsw TORSSw TORSS.Vs.Vsithr3;vvkr esgDcrkr dcff=nsr=nsw TORSithr3;rstp||nsw TORS}(),ilhesehnklTkrgstcnt:fpnitcgst){vkr rhn(uhcnt,htUhcntThUhutchnklTkrtprn toce}seplt=hutctoce.hrcgcgst||nsw Tkr(t).kdd(r3;rstprn sitchn).mprseplt.ihuORSS.Vsithy(toce.dcrutchnklTkrltculyEiklkto.mcn(Mktsnt,-b1),{e0=0;e1=M;eqrDcet=-}sles cf(ee0*e0+e1*(esgSxtsnt)e1+2*b1)+imkx(-esgSx1<=sxtDst)v1)*0.5;vk).nhrmklczcetknisTh(huy(toce.h);vkr esgSrcgcn).epbs();dcff.i(esgIsntsrv1).epb(v0xtsnt=v0.d0+e1*(e1+2*e0+e1*(e1Dcet=-e0*esles{e1=-e(0,-(k01*esgSxtsnt;e+2*b1)+i}}0=Mkto.mkxqrDcet=-e01+b0));eqr1=k01*b0-b();vkr dst01*b1-b0;e1-k01*k01)xtDst;cf(d;vkr e0,e1=Mkto.kbe(,eqrDcet,sf.lsngtoEqst>0){e0=k*e1+b0));e=e0*(e0+k0kx(0,-(k01+e1*(k01*e=esgSxtsnt0+e1+2*b1)1*e1+2*b0)+i}sles{e1st;eqrDcet;e0=Mkto.m.mcn(Mkto.es{cf(e1<=xtsnt:Mkto0=Mkto.mkxb0));e1=(e(0,-(-k01*-sxtDst){eesgSxtsnt+*b1)+i}}sl0>0)?-esgSt;e1*=cnvDsgSxtsnt*d;e0*=cnvDs0){cf(e1>=st){vkr cn-sxtDst){cst;cf(e0>=f(e1<=sxtD1;sxtDst=evDst=1/dstt+b0));e1=gSxtsnt,-b1*esgSxtsnnt);eqrDces{e0=Mkto.t=e1*(e1+21),esgSxts*b1)+i}sleto.mkx(-esmkx(0,-(k0;vkr i=dcfe.dcrsitchht(esgDcr)cr);vkr b0tchn);vkr =dcff.dht(n.dht(esgDtoce.dcrsir k01=-tocb1=-dcff.dgDcr.ihuy(tHnRky,hutkr(0.5);esHnEsgmsnt)kdd(v1).mp{esgIsntsrchnklUhcnt.ihuy(v0).tchnklUhcnltculyEikl toce.kt(tk+toi;cf(tst);rstprnrstprn nple.kt(t1,hul;cf(t0<0)0<0&&t1<0)rstprn toc;vkr t1=titchnklTkrgf(hutchnkl-esgSxtsnt+2*b1)+i}c;e0=Mkto.mqrDcet=-e0kx(0,-(k01:esgSxtsnt*e1+b0));e1=(k01>0)?*e0+e1*(e1vkr rkdcpers.isntsr,)-tik*tik;n);vkr tikhn);vkr d2=v1.dht(totoce.hrcgcce.dcrsitcithre(euos=v1.dht(v1n eqrDcet}snt){hutchtsr)}rstprEsgmsnt.ihiklkr(e1).uy(esgDcr)nklUhcntHn.mpltculyEhcntHnEsgmkdd(esgIsn){v1.epbVsEuosrs:fpnhnklTkrgstr v1=nsw Tfpnitchn(eORSS.Vsithitchn(){vkr3;rstprn ,cntsresituosrs,hutct0=tik-toikdcpe*euos2-d2);vkr cf(d2>rkdctoi=Mkto.epe2)rstprnrs.rkdcpe; npll;vkr 2=euosrs.rqrt(rkdcpers.rkdcpe}resitchnEutsr)<=euoschn(euosrsisThUhcnt(){rstprn tosrs:fpnitoce.dcetkn}(),ceCntseuosrs.isnUhcnt(toceTkrgst)}}(dcetknisThsitchnUlknr dcetThUhs:fpnitchn),ceCntsre(ulkns){vk0,hutchnklcnt=ulkns.(hutchnklU){hutchnklhrcgcn)}cf.ihuy(toceEiklkr(e0).dcrsitchnUhcntHnRky).mpltculyUhcntHnRky.kdd(toce.i}}}sles{eSxtsnt:Mkt(e1+2*b1)+.mkx(-esgS);eqrDcet=xtsnt,-b1)o.mcn(Mkto,esgSxtsnt(e0>0)?esg-e0*e0+e1*kx=(bhx.mkchn.z;vkr cnvdcrx;tme.hrcgcn;cbhx.mcn.x-f(cnvdcrx>hrcgcn=toc=0){tmcn=(oce.dcrsithrcgcn.x)*thr=ulkns.hUhcnt<0){r dsnhmcnks}rstprn fs:fpnitchnkles},dcetrstprn trpknisThUlknkthr*dcetT(ulkns){vkt){vkr tmctprn toce.chnklTkrgshx(bhx,v)!Bhx:fpnitc==npll}}()cntsresitB,cntsresithn(bhx){rshn(bhx,hutpll},cntsrkr t=-(tocn t>=0?t:nht(ulkns.nt)/dsnhmcnhrmkl)+ulke.hrcgcn.dns.ihnetknprn npll}vkthr;rstprprn fpnitce.kt(t,hutsithr3;rstt)},ceCnts(){vkr v=nresitchnBhchnklTkrgsx:fpnitchnrstprn tocsw TORSS.Vnvdcrz=1/tcn,tymkx,tsitchn.y,c;vkr cnvdcx,cnvdcry=rx=1/toce.zmcn,tzmkxdcrsitchn.n,tmkx,tym1/toce.dcrtprn npll}fpnitchn(u==npll){rsnklTkrgst)ThUlkns(ul{vkr t=toclkns,hutche.dcetknisesitUlkns:kns);cf(t=dcrx}cf(cn.x)*cnvdcrgcn.x)*cnvn=(bhx.mkx;tmkx=(bhx.x-hrcgcn.x}sles{tmcx)*cnvdcrxx.x-hrcgcn.mcn.x-hrctprn 0}rst(toce.dcrscn)==0){rsdsnhmcnkthnisThUhcntr==0){cf(uitchn);cf(lkns.dcetknhrmkl.dht(toce.hrcgcf(dsnhmcnf(dcetThUhcrsitchn);stprn trpsns.nhrmkl.}vkr dsnhmcnt===0){rcnkthr=ulk.hrcgcn);cdht(toce.dgs2);vkr DTkrgst){sde(sdgs1,sdthre(b,k););nhrmkl.isdgs2.epbVgs1.epbVsisithre(i,kg,hutchnklrheeVsithrn npll;cf()*cnvdcry;mkx))rstpr.mcn.y-hrcmcn>tymkx)gcn.y)*cnvtymkx=(bhxdcry}cf((ty-hrcgcn.y||(tymcn>tsw TORSS.VhnklTkrgstkr sdgs1=nitTrckngls=nsw TORSS:fpnitchn()},cntsres){vkr dcff:tmkx,hutc.Vsithr3;vcnvdcrz;tzn.z)*cnvdchrcgcn.z)*bhx.mkx.z-es{tzmcn=(hrcgcn.z)*rz;tzmkx=(cnvdcrz}slcn.z-hrcgcbhx.mkx.z-cn>=0?tmcncn;cf(tzmktoce.kt(tmkx!==tmkx))rstprn nptmkx=tzmkxx<tmkx||tm;cf(tmkx<0n)tmcn=tzmll;rstprn fkisIpllcn sdgs2=nswk,b,i,bkiathr3;vkr nhr3;rstprnhrmkl=nsw  TORSS.VsiTORSS.Vsitsithr3;vkr fpnitchn(tmcn!==tmccn.z-hrcgcmcn>tmcn||rz}cf((tmcx))rstprn n>tzmkx)||n.z)*cnvdc(tzmcn>tmkmkx=(bhx.mnpll;cf(tzs cf(DdN<0rsitchn.dhecgn=1}slevkr ecgn;cIpllcng)rsf(DdN>0){ct(nhrmkl);f(bkiafkisdN=toce.dctprn npll;mcn=(bhx.m||tmcn!==tcrz>=0){tzymcn;cf(tyx)tmkx=tymmkx<tmkx||mcn)tmcn=ttmkx!==tmktymcn>tmcnkx;cf(cnvd=(bhx.mkx.tymcn=(bhxsles{tymcngcn.y)*cnvy-hrcgcn.ydcry;tymkx.mcn.y-hrc=(bhx.mkx.vdcry>=0){)*cnvdcry}uosrs,est:kdcpe=(rkdhr:TORSS.Efcnsd)?rkdurhthtyus=cpe:0};TORcpe!==pndsSS.Euosrs.hr3;toce.r{ihnetrpitdht(sdgs1.heeVsithredcrsitchn.2));cf(DdQkr DdS1xQ=xS2<0){rst(dcff,sdgsprn npll}vt(sdgs2.irecgn*toce..Rky).ihuyhrcgcn)&&r(nsw TORSShn.sqpkle(ns:fpnitchtoce.dcrsiky.dcrsitctchn)},ilhpkle(toce.n(){rstprnmktrcx4){t0){rstprn :fpnitchn(n toce.kt(st)}}(),kuQdN/DdN,hunpll}rstprtchnklTkrgl);cf(QdN<ulyMktrcx4.hrcgcn.sq.hrcgcn);trstprn rkychn.nhrmklqpkle:fpniczs();rstpoce.dcrsitrn toce},sn.epb(tocetchn(rky){TORSS.VsitORSS.Euosrsntsr:nsw (isntsr,rksntsr!==pndcpe){toces=fpnitchn.isntsr=(i(toce)}};Tdsfcnsd)?ie.dcrsitchchn.kdd(totrcx4);toc.kuulyMktrcgcn.kuulycx4(mktrcxce.hrcgcn)4);toce.hroce.dcrsitMktrcx4(mkcnte:fpnitsntsr,rkdc,estFrhmUhsntsr.ihuy=rkdcpe;rs(isntsr);tpe){toce.ioce.rkdcpefpnitchn(itprn toce}.dht(nhrmk));cf(DdS1-ecgn*dcffrn npll}cfrstprn npl(DdQxS2+DdxQ<0){rstpS1xQ>DdN){irhee(dcffl}vkr QdN=rsitchn.dhDdN=-DdN}sgn*toce.dc npll}dcffgcn,k);vkr.epbVsithrles{rstprne(toce.hrc){ecgn=-1; DdQxS2=ecdsltkLsngte.isntsr)<rgst){vkr m*rkdcpeEpchn(uhcnt,m)},ilkmuU=(rkdcpeEphcnt:fpnitqpkrsd(tochutchnklTkntsr)}vkr =pndsfcnsd.isntsr(ishuy(hutchnstFrhmUhcnklIsntsr)}){isntsr.isles{bhx.eklIsntsr!=te(uhcnte)e)},cntsre,dcetknisTtoce.rkdcpitchn(uhcnknisTh(toct){rstprn(hUhcnt:fpnuhcnt.dcet.rkdcpe))}e.isntsr)-osrs){toce(uhcnte[c]pnitchn(eudcpe=Mkto.tprn toce}eqrt(mkxRk))}toce.rkdcpeEq);rssThEqpkrsd}(),ihuy:fkdcpe*tocentkcneUhcn)<=(toce.r(uhcnt){rshEqpkrsd(ttprn(uhcntt:fpnitchn.dcetknisTpe<=0)},ihoce.isntsrcetknisThE:fpnitchn(s.isntsr.dr rkdcpeEp.rkdcpe;rsm=toce.rkdeuosrs){vkcpe+euosrssiteEuosrstprn euosr(toce.rkdcuy(euosrs.n(){rstprnce.rkdcpe= toce},smueuosrs.rkdisntsr);tocpe;rstprn.isntsr.ihty:fpnitchlt.ihuy(uhsntsr.dcetithr3;rseprsd(uhcnt)Tkrgst||ns;vkr rseplknisThEqpkt=hutchnkloEq=toce.iw TORSS.Vssr.dcetkniq=0;fhr(vkcpeEq,isnthcnte.lsngpeEq=Mkto.to;c<cl;c+r c=0,cl=u+){mkxRkdcmkxRkdcpeEmkx(mkxRkd;cf(hutchnbhx=nsw TOoce.isntsrstprn fpniIsntsr){vktchn(uhcntRSS.Bhx3;re,hutchnklchn(){vkr r isntsr=t==pndsfcnskns,(u3!==Ulkns,(u5!?u3:nsw TOfcnsd)?u4:RSS.Ulkns,pndsfcnsd)(u4!==pndsw TORSS.Ulnsw TORSS.){vkr bhx=e.rkdcpe).hnklTkrgstsntsr)}rstcngBhx:fpnprn rsepltkdd(toce.i},gstBhpndEiklkr(tocitchn(hutc5){toce.ul(){rstprn(u2,u3,u4,uEuosrs).ihetpm=fpnituy(toce)}}nsw TORSS.;TORSS.Frps:fpnitchnchn(u0,u1,dcpe*mktrculyMktrcx4pe=toce.rkmktrcx){tox4(mktrcx)ce.isntsr.:fpnitchn(kuulyMktrcrn bhx},ku;toce.rkdccpe)},ilhntchn(euosr==toce.rkdeuosrs.isnsr)&&(euostsr.sqpkles){rstprn (toce.isntqpkle:fpnirs.rkdcpe=nsd)?u2:ns==pndsfcns2!==pndsfcTORSS.Ulkn1:nsw TORSs,(u1!==pnd)?u0:nsw dsfcnsd)?uknse=[(u0!S.Ulkns,(urn toce},sklsHnKxce(fest);rstpoce},trkne){toce.isnlkts:fpnit);rstprn tchn(hffestx.gstMkxEitsr.kdd(hf,u1,u2,u3,TORSS.Ulknpnitchn(u0Frpetpm.ur:TORSS.Frphthtyus={is]};TORSS.hnetrpithrd)?u5:nsw etpm,est:fdcpe);rstprgst||nsw kr(toce.rk;bhx.est(tsr);bhx.sxoce.isntsrTORSS.Bhx3,toce.isnthutchnklTkukndByEiklt.mpltculyltkLsngtoEzs();rsepldcpe*toce.toce.isntsrkdcpe)){rq>(toce.rkseplt.epb(cnt);cf(dsr).nhrmklcnse[5].ests();ulknselczs();ulkuhnsnte(mss10,ms15-m3-ms2,ms7-[4].estIhmms6,ms11-m).nhrmklczs14).nhrmk=toce.ulknse[4].ihuyvkr ulknsee[5].ihuy(y:fpnitchnu5);rstprn(u4);ulkns toce},ihuy(u3);ulkn(frpetpm){nte(ms3+mstIhmuhnsntestIhmuhnsms7+ms4,msrmklczs();11+ms8,ms1e(ms3+ms0,5+ms12).nhknse[1].esulknse[2].ms[4],ms5=ce.ulknse;];vkr ms4=lsmsnte;vk],ms2=ms[2r ms0=ms[0vkr ms=m.s],ms1=ms[1 ulknse=to],ms3=ms[3klczs();ul14],ms15=mms12).nhrmse[0].estI7-ms4,ms11hmuhnsnte(s[15];ulknms3-ms0,ms],ms14=ms[-ms8,ms15-,ms15-ms13ms11+ms9,m5,ms11-ms9nhrmklczs(nsnte(ms3-);ulknse[3s15+ms13).].estIhmuh1,ms7+ms5,ms1,ms7-msms13=ms[13ms[6],ms7=12=ms[12],ms8=ms[8],],ms11=ms[ms9=ms[9],ms[7];vkr ms10=ms[10ms[5],ms6=11];vkr msfpnitchn()(ms3+ms2,miteHbjsit:1+ms10,ms1rstprn toc5+ms14).nhs7+ms6,ms1rmklczs();Ihmuhnsntee},cntsreschn(m){vkr c=0;c<6;ctrcx:fpnit[c].ihuy(ftprn toce}rpetpm.ulk++){ulknsense[c])}rsse;fhr(vkr,estFrhmMknse[3].ihu ulknse=touy(u2);ulkulknse[0].huy(u1);ulihuy(u0);uce.ulknse;lknse[1].iu4,u5){vkrknse[2].ihx.z:bhx.mcbhx.mcn.y;z>0?bhx.mk.nhrmkl.z>z;u2.z=ulk0?bhx.mcn.u1.z=ulknsz:bhx.mkx.bhx.mkx.y:ns.nhrmkl.rs.kuulyMk=npll)gshmosrs);euostsBhpndcng(gshmstry.Euosrs();estry.ihmupuosrs.ihuyngEuosrs==bhpndcngEux.x;u2.x=u;fhr(vkr cn.x:bhx.mk){vkr ulknns.nhrmkl.s=ulknse[c=0;c<6;c++];u1.x=ulkoce.ulknsex>0?bhx.mcc<6;c++){ve=toce.ulkr(vkr c=0;ntsr=euosrpe=-euosrss.isntsr;vnse;vkr iskr nsgRkdc{vkr ulkns.rkdcpe;fhr ulknse=tfpnitchn()hn(bhx){vkw TORSS.Vssithr3;rstithr3,u2=n{vkr u1=nssw TORSS.VresiteBhx:prn fpnitchrmkl.y>0?l.x>0?bhx..y=ulkns.nmcn.x;u1.yx.mcn.y:bh=ulkns.nhrmkx.x:bhx.mkl.y>0?bhlkns.nhrmkx.mkx.y;u2trps},cntss=ulknse[cs}}rstprn ThUhcnt(isgRkdcpe){rntsr);cf(d].dcetkniscetknis<nskr dcetknistprn fklen fkles}}r=ulkns.dce2<0){rstprnt(u1);vkrUhcnt(u2); d2=ulkns.tknisThUhcdcetknisThn.z;vkr d1cf(d1<0&&dhn(euosrs)it.mktrcxWsrs:fpnitcrn toce.cns)}}(),cnttsresiteEuhrld);rstposrs(euosrtrcx4(hbjssresiteEuotry.bhpndcs=nsw TORSy;cf(gshmsstprn fpnimstry=hbjstchn(hbjsiS.Euosrs;rt){vkr gsh{vkr euosrit.gshmstrce.estFrhmhn(k,b,i){klczs();to=v1.epbVsipbVsithre(thre(i,b).vkr nhrmklirhee(v2.eprn fpnitck,b)).nhrmrpetpm).ihThUhcnt(uhsw TORSS.Ftprn fkles:fpnitchn(}}rstprn tcnt)<0){rsrps},ilhns].dcetknis){rstprn(nce.nhrmkl)hcnt:fpnitcnt.dht(to,uhcnt){tol);toce.ihce.nhrmkl.chn(nhrmklihuy(nhrmkdIhulknkrUnetknt=-uhtrpithr:TO,0);toce.ityus={ihnehnetknt!==0};TORSS.Upndsfcnsd)hnetknt=(i?ihnetknt:sithr3(1,0lkns.urhthhmNhrmklKnsnte:fpnitoce},estFrw){toce.nh.ihnetknt=rmkl.est(xchn(x,y,z,,y,z);toce,estIhmuhnw;rstprn tsithr3;rstce},estFrhsw TORSS.Vhcnte:fpniRSS.Vsithrtchn(){vkrmIhulknkrU v1=nsw TO;rstprn to3;vkr v2=ntprn toce}est:fpnitchnetknt;rsihnetknt){mkl);toce.toce.nhrmkhn(nhrmkl,l.ihuy(nhrRSS.Ulkns,ihnetknt=ins.nhrmkl)hulknkrUhcl.ihuy(ulkk);rstprn hn(ulkns){toce}}(),int(nhrmkl,huy:fpnitcNhrmklKndItoce.nhrmksw TORSS.V;TORSS.Ulk)?nhrmkl:nn(nhrmkl,i=(nhrmkl!=hnetknt){tns=fpnitchoce.nhrmkluy(toce)}}=pndsfcnsdf(ulknse[c}}(),ihntkc<6;c++){cpnitchn(uh.ulknse;fhcnt){vkr ucneUhcnt:flknse=tocestprn trpsr(vkr c=0;.snd);rstpetkrtEcgn=Uhcnt(lcnsnisThUhcntEcgn=toce.(lcns.etkrtoce.dcetkt);vkr sndlcns){vkr dcetknisThsngto;rstp();toce.nhresNhrmklLulyEiklkr(;toce.ihnecnvsresNhrrmkl.mpltcmklLsngto)mkl.lsngtotknt*=cnvsS.Vsithr3;dciplkrMkg||nsw TORSe.dcetknisseplt=hutcThUhcnt(uhnctpds=toccnt);vkr rvkr usrusnhnklTkrgstrstprn toc{rstprn ton(euosrs){dht(uhcnt)knisThEuos+toce.ihnece.nhrmkl.tknt},dcetchn(uhcnt)rs:fpnitchklTkrgst){hcnt(uhcntcnt,hutchnkrgst).epbtohUhcnt:f(uhcnt).ns,hutchnklTgkts()},hroce.hrtohUpnitchn(uh:fpnitchn(plt.ihuy(tsitchnLcns).mpltculyMkgnctpds)Eiklkr(usroce.nhrmklusndciplkrrstprn rse},ceCntsre){rstprn tThUhcnt(euhnklTkrgstr)-euosrs.:fpnitchn(rkdcpe},urosrs.isntshjsitUhcnte.dcetknisuhcnt,hutcTORSS.Vsitgn<0&&sndEkr v1=nsw ndEcgn<0&&sitLcns:fpetkrtEcgn>cgn>0)||(s0)},cntsrern(etkrtEcnitchn(){vhcnt:fpnitsgkts:fpnicetknisThUe.ihnetkntkts();rstp*=-1;toce.tchn(){tocnhrmkl.nsgrn toce},nrn toce},d0/toce.nhrtknt=ulknslLsngto=1.rstprn tocn(){vkr cne},nhrmklc.ihnetknt;zs:fpnitch;toce.ihnevsresNhrmknswIhulknk.nhrmkl).kUhcnt(v2);3(nhrmklMkrUhcnt=toctrcx);vkr uulyMktrcxnswIhulknk.ihuy(tocee.ihulknkrnisThUhcnt(v1);vkr dtoce.dcetk=toce.nhrm(dsnhmcnktkl.dht(dcrsnhmcnkthrsitchn);cflcns.dsltkhr==0){cf(ktrcx,hutcORSS.Vsithfpnitchn(mnsw TORSS.ORSS.MktrcVsithr3;vkr3;vkr v2=r m1=nsw Tr v1=nsw Tx3;rstprn ltculyEikltknt)/dsnhsitchn).mp(t<0||t>1)tprn rsepl{rstprn pnmcnkthr;cfdsfcnsd}rs+toce.ihnet.ihuy(dcritchn(){vkrstprn rsektrcx4:fpnoce.nhrmklce.ihnetkn).mpltculyplt.ihuy(tEiklkr(-toS.Vsithr3;t)},kuulyMwNhrmkl=v1Mktrcx){vkcx);vkr nstrcx=hutchgstNhrmklMnklNhrmklMr nhrmklMkktrcx||m1.hnklNhrmklktrcx(mktr||nsw TORSlcns.etkrthnklTkrgstknkrUhcnt:gst){vkr rfpnitchn(h)}}(),ihulutchnklTkrkr(t).kdd(seplt=hutc;rstprn tolyMktrcx4(knkrUhcnt)ce.estFrhmnt(nswNhrmNhrmklKndImktrcx);tohulknkrUhcrUhcnt.kuukl,nswIhulce.nhrmkl)t)==0){rstkrt.dht(to.ihuy(lcnscnsd}vkr t.etkrt)}rsprn rseplttprn pndsf(lcns.etkr=-(lcns.etdcrsitchn= fpnitchn(ithr3;vkr nklTkrgst)Tkrgst||ns{vkr rsepllcns,hutcht=hutchnklhr3;rstprnw TORSS.Vsx-mcn)/(mkk2-k1)},emtprn 1;x=(pnitchn(x,stprn 0;cfmcn,mkx){chhtoetsu:ff(x<=mcn)r*(b2-b1)/((x>=mkx)rsknt)},ilhntchn(ulknstoce.ihnetlkns.nhrmk)&&(ulkns.l.sqpkle(t){rstprn uoce.nhrmklqpkle:fpniihnetknt==k)?k:((x>b(c==19)?(r{rstprn(x<r]}}rstprnlkmu:fpnit ppcd.jhcn&0x3)|0x8:()}}(),i[c]=iokre[chn(x,k,b)36);vkr rnDSFGOCJALMnsw Krrky(XYZkbidsfg.eulct()ocjalmnhuqNHUQRETPVWretpvwxyz3456789KBI;vkr ppcd=nd>>4;ppcd=4}sles{&0xf;rnd=r02)rnd=0x2)*0x100000000000+(Mkcf(rnd<=0xto.rkndhm(4){ppcd[c]0)|0;r=rnd b1+(x-k1)kmuBhtthm:b2){rstprn,k){rstprnfpnitchn(x x<k?k:x},fpnitchn(xmkuLcnskr:)?b:x)},il,k1,k2,b1,es cf(c==1rn fpnitch[c]=-}slr c=0;c<36||c==18||c;c++){cf(cn(){fhr(vk==8||c==13d=0,r;rstp==23){ppcdstprn 1;x=prn x*x*(3f(x>=mkx)rhtosretsu:cf(x<=mcn)fpnitchn(x-2*x)},emh,mcn,mkx){x-mcn);rstrstprn 0;ciokre=012(){rstprn(chn(){vkr Ulkns).ihu={gsnsrktsy(toce)}};nsw TORSS.TORSS.Mktos:fpnitchnPPCD:fpnitrn toce},snelkts:fpnrmkl);rstpst){toce.it-hffest.dhnetknt=toitchn(hffece.ihnetknce}}(),trkht(toce.nh,ub,ui,ud;nte){toce.t,w2,w3,uknte;vkr i=uhcnt,cntU[],v3={x:0uhcnte=uhc,y:0,z:0},nitchn(uhchcnt,wscgo)},rkndFlh())/65535}(lhw,ocgo)pnitchn(lhflhhr(tocew,ocgo){rs,rkndCnt:ftprn Mkto.kto.rkndhm.rkndFlhktlps>>1;vklklps&(vklp;vklps|=vk&vklps!==0itchn(vklp},nsxtUhwss-1))===0&rHfTwh:fpn){rstprn(vs){vklps--fpnitchn(dkto.rkndhm80;rstprn Rkd:fpnitcckneFkithrhn(){vkr d())},dsgThsgrssThRkdngs*(0.5-M=Mkto.UC/1tchn(vklpsprn fpnitcHfTwh:fpni){rstprn rseFkithr}}kdckne*rkdhn(rkdcknecknThDsgrskto.UC;rst(),ceUhwsr.Eulcns=fp>2;vklps|=ps}};TORSSklps|=vklp6;vklps++;s>>8;vklpsvklps>>4;v|=vklps>>1ps|=vklps>rstprn vklithr=180/Mtprn dsgrshDsgrsseFkhRkdckneFknitchn(){vithr}}(),rse*dsgrssTkdThDsg:fpsgrsse){rskr rkdcknTx:k[c][0],rhmKrrky=fhcnte[c]={{toce.uhcnk.lsngto;cte=[];fhr(pnitchn(k)vkr c=0;c<toce.cnctF++){toce.u{rstprn rkn(lhw,ocgochn(rkngs)hw+Mkto.rkkndFlhktEundhm()*(oc){rstprn lgo-lhw)},rkt:fpnitchrskd:fpnithm()+255*Mkx-mcn);rs*Mkto.rknd*(x*(x*6-1itchn(){rs5)+10)},rktprn x*x*xndhm16:fpn(x-mcn)/(mtprn(65280S.Vsithr3,n,uhcnt=0,i=nsw TORS,hldCntUhc TORSS.Vsint=0,hldUhcntUhcnt=0ectchn=nswse,uhectchthr3,tmuVshcnt>toce.got=uhcnt-;i[2]=cntU[0]=cntUhchcnt-1;i[1nt===0?cntcntUhcnt;iUhcnt:cntUuhcnt);wsc]=cntUhcntoce.uhcntecnteKrrky=l;c++){u=t{vkr c,u,lihhrde=[];=toce.uhcnfpnitchn()te.lsngto,tIhntrhlUhfhr(c=0;c<te[i[3]];wnt+2;uk=to=toce.uhcni[0]];ub=ttoce.uhcntoce.uhcntece.uhcnte[[i[1]];ui=o-1:cntUhce[i[2]];ud3};toce.gsy,ud.y,wsc);rstprn v;v3.z=cnts.z,ud.z,wsruhlkts(ukgot,w2,w3).z,ub.z,uiy,ub.y,ui.cgot,w2,w3dsx,nEkmul[c]=[u.x,u){vkr c,cntprn ihhrdnitchn(nEpe};toce.gs.y,u.z]}rstLsngto=fp[c];ihhrdebDcvcechneuhlkts(uk.scgot;w3=wv3.y=cntsr3.x=cntsru,ud.x,wscghlkts(uk.xscgot*w2;v,ub.x,ui.x2=wscgot*wot,w2,w3);se=toce.uhoe=[],thtk100;nEkmuliopnaLsngtechne)nEpboe[0]=0;cflLsngto=0;(!nEpbDcvciopnaLsngtDcvcechne=cnte.lsngtgto-2?toce-3?toce.uhngto-1:cntt>toce.uhcUhcnt+1;i[.uhcnte.ls3]=cntUhcnuhcnte.lsnnte.lsngtokto.flhhr(z:k[c][2]}cntUhcnt=MtUhcnt=fpn.uhcnte.lsitchn(a){u}};toce.gshcnt=(tocey:k[c][1],ngto-1)*a;sngto-1);fs/el.thtkle.uhcnte.lrsnt=(c-1)-1);cndsxN/(toce.uhc);cndsxIprnte.lsngtosklDcetknisxt=c/(toctchn);hldUoce.gstUhcTh(hldUhectmuVsi.ihugto+=tmuVsy(uhectchnnt(cndsx););thtklLsnuhectchn=ti.dcetknis);fhr(c=1;S.Vsithr3,]).ilhns()tLsngto();i.ihuy(tocnswuhcnte.el=toce.gsupeo(tmuVsi=nsw TORSe.uhcnte[0toe.lsngto{iopnaLsng[iopnaLsngnt]=thtklLtUhcnt}}iosngto;hldCtoe[cntUhcntUhcnt=cndCntUhcnt)pnaLsngtoee=[],tmuVssf){vkr c,n,nswuhcntdsxIprrsntnis,ekmulc,cndsxNsxtj,cndsx,cn,rsklDcetkekmulcngIhng,uhectchlcngIhsf*rnte.lsngto.iscl(ekmuDcetknis=ee[c-1];ekml.iopnae[c;c++){rskl]-el.iopnac<toce.uhculcng=Mkto=fpnitchn(gto;rstprnyKriLsngtopnaLsngtoe;toce.rsuk,thtkl:tht{iopnae:ioklLsngto}}]=thtklLsnrkmstrczsBhn=toce.gskmulcng-1;nt);uhectc=cndsxIprrcndsxNsxt-snt+j*(1/ej++){cndsxkmulcng)*(hr(j=1;j<ecndsxIprrstUhcnt!=hluy(uhectchcnt);cf(cntoce.uhcnttUhcnt=Mkte.lsngto-1n);uhcnt=()*cndsx;cnhectchn.iho.flhhr(uh/nEkmulse;o*nEpbDcvc+){cndsx=chectchn.ihhr(c=1;c<nuy(toce.uhechne;hldUcnte[0]);fcnte.lsngtEkmulse;c+.Vsithr3;rnt=fpnitch=nsw TORSS=nsw TORSSTORSS.Vsit.Vsithr3;vn(){vkr v0kr v1=nsw hrdFrhmUhchr3;vkr v2)*0.5,v1=()}toce.uhc v0=(u2-u0nte};fpnit1,u2,u3,t,chn cntsrunte=nswuhchlkts(u0,u]).ilhns()t2,t3){vkr){rstprn re(k,b);rseLsngtoEq>0v0);vkr rslsngtoEq()epltLsngtoplt.irhee(Eq=rseplt..epbVsithr;cf(rseplttoce.i=(i!=(k!==pndsS.Vsithr3;sw TORSS.Vndsfcnsd)?sithr3;tocfcnsd)?k:ne.b=(b!==p,i){toce.kb:nsw TORSre(i,b);v0b,i,hutchnt.epbVsithvkr rseplt TORSS.Vsi=hutchnklTklTkrgst){krgst||nswpnitchn(k,thr3;rseplgls.bkryihculyEiklkrORSS.Trcknrt(rsepltLplt.est(0,sngtoEq))}(1/Mkto.eqrstprn rseseplt.mplt0,0)}}();T3;rstprn fd)?i:nsw TRSS.Vsithrr3};TORSS.tchn(){vkrTrckngls.nORSS.Vsithhrmkl=fpni==pndsfcns v0=nsw TOthre(uhcnttchn(uhcnt;v2.epbVsichnklTkrgs);v1.epbVst){v0.epbV,k,b,i,hutsithre(i,kstprn fpniithre(b,k)nitchn(k,b;rstprn(2*rckngls=fp+v1)*t3+(-2+v0*t+u1}3*(u1-u2)-(u1-u2)+v02*v0-v1)*tu3-u1)*0.5;};TORSS.Te.uhcnte[csx);nswuhci.ihuy(tocmuVsi.ihuynswuhcnte.(uhectchn)nte.upeo(t.ilhns())}tUhcnt(cndupeo(tmuVsrckngls.k)[c1]);tocee.k.ihuy(tcnte[c2]);nitchn(trcrstprn toc.i.ihuy(uhe},ihuy:fphuy(uhcntekngls){toccf(dsnhm==kr dsnhm=(S.Vsithr3;1-dht01*dhhnklTkrgstt01);vkr rdht00*dht1seplt=hutc.dht(v2);v||nsw TORStoce.i.ihus={ihnetrpb.ihuy(b);.Trckngls,toce.k.ihuest:fpnitcithr:TORSShn(k,b,i){s.urhthtyuy(k);toce.Uhcnt=fpni2-dht01*dhs.ihntkcnenhm;rstprnp)}}();TOR rseplt.est02)*cnvDst(1-p-v,v,dht00*dht1SS.TrcknglSS.Trcknglt,k,b,i,v11)}}();TORseplt.x>=0rseplt.x+r)&&(rseplt);rstprn(r.y>=0)&&((Uhcnt(uhcnseplt.y)<=);toce.b.in toce},esuhcnte[c0]eKndCndcis,c1,c2){toe:fpnitchntFrhmUhcnt(uhcnte,c0y(i);rstprce.k.ihuy(yihhrdFrhm v1=nsw TOckngls.bkr3;rstprn f{vkr rseplpnitchn(uhRSS.Vsithrcnt,k,b,i)tchn(){vkrt=TORSS.TrORSS.Vsithuy(trcknglr v0=nsw Ti.ihuy(trc},krsk:fpnkngls.i);rs.b);toce.stprn toce;toce.b.ihitchn(){vkhm;vkr v=(rseplt.est12)*cnvDsn}vkr cnvDsht11*dht02nhm=1/dsnh(-2,-1,-1)m;vkr p=(d0){rstprn -dht01*dhtr dht12=v1t00=v0.dhtdht(v1);vkht01=v0.dhht(v2);vkrt(v1);vkr (v0);vkr ddht02=v0.d,k);vkr dh dht11=v1.rn(nsw TOR.k)&&trcknchn(){rstple(toce.b)toce.i)},i&&trcknglsgls.b.sqpk.i.sqpkle(qpkle(tocelhns:fpnithnklTkrgst v0.irhee(seplt=hutc()*0.5}}()utchnklTkr,mcduhcnt:v1).lsngtofpnitchn(h.b);rstprngst){vkr rrstprn TORUhcnt(uhcnhn(uhcnt){oce.b,toceihntkcneUh.i,hutchnkt,toce.k,tlTkrgst)},yihhrdFrhmcnt:fpnitc},ulkns:fputchnklTkrnklTkrgst)n TORSS.Tr,toce.b,tockngls.nhrgst){rstprmkl(toce.kfpnitchn(hce.i,hutchckngls.bkroce.b,tocen TORSS.TrhhrdFrhmUhutchnklTkrcnt:fpnitc.i)},bkryihn(uhcnt,he(toce.k,tgst){rstprckngls.k.ss.ihntkcne{rstprn trt,toce.k,te:fpnitchnoce.b,toceUhcnt(uhcn.i)},sqpklSS.Trckngl(trckngls)lknkrUhcntchnklTkrgsestFrhmIhuplt=hutchnUlkns;rstpklTkrgst||t){vkr rsensw TORSS.nitchn(hutrn rseplt.fcnsd)?kpts).ihuy(tokrt!==pndsS.Ilhia=fpce.kpthEtknitchn(kptce)}};TORShEtkrt){toSS.Trcknglrt=(kpthEt)},nhrmkl:S.Vsithr3;Eiklkr(1/3plt.kddVsikdd(toce.ithre(toce.rstprn rsek,toce.b).||nsw TORS).mpltculyoce.k,tocensw TORSS.bVsithre(ttprn fpnittoce.i,tocchn(){v0.eVsithr3;rspbVsithre(r3;vkr v1=e.b);v1.epuktiosr.urSS.SvsntDcS.SvsntDceuuly:fpnitddSvsntLcechn(hbjsiteuktiosr,k){hbjsit.krpithr:TORtsnsr=TORS&&eslf.usrtrpithr:TO=pndsfcnsdetkrt:fpnis=eslf.usrtchn(){tocRSS.Ilhia,e.etkrtTcmtyus={ihnefhrmknis!=toce.slkuehrmknis.nhs=nswTcms;hw();dcff=hldTcms);t0.001*(nsww():Dkts.nTcms-toce.?eslf.usrfoce.hldTcmtoce.gstDs:fpnitchn(pnitchn(){SlkuesdTcmes},gstSlks();toce.r){toce.gstpnncng=fkltrps},ethuuesdTcms:f=pndsfcnsdf(toce.rpnknis.nhw!=nswTcms=essfcnsd&&eslf.usrfhrmncng){vkr knis!==pnd.etkrt()}clf.usrfhrmyus={ihnetff}rstprn osr.urhthtSS.SvsntDc};TORSS.Sveuktiosr=fdcff}};TORpnitchn(){sdTcms+=dcsntDceuktincng){tocern toce.sl&!toce.rpn,gstDsltk:0;cf(toce.fpnitchn()kuesdTcms}{vkr dcff=ltk();rstpkpthEtkrt&cetsnsr;hbdSvsntLcet.okeSvsntLt.okeSvsntDceuktiosrLcetsnsr=Tsnsr;hbjsiORSS.Svsnththtyus.kd.urhthtyuse.rpnncng=hw!==pndsfrtTcms;tocusrfhrmknioce.hldTcms.nhw():Dkcnsd?eslf.ts.nhw();tfhrmknis.ns=toce.etklhia.urhths;toce.etks};TORSS.Ioce.hldTcm=0;toce.rps=0;toce.srtTcms=0;tlkuesdTcmshEtkrt:trpnncng=fkletchn(svsntxHf(lcetsnSvsnt:fpnisx!==-1){lcndsx,1)}}cetsnsrKrrsr);cf(cndky.eulcis(Krrky.cnds},dceuktiooce._lcetsceuktiosr.snsr){cf(tdceuktioSvr:fpnitchnsnt},kddSvurhthtyus.sntLcetsnsRSS.SvsntD(tyus,lcetr lcetsnsrvsSvsntLce)rstprn;vktchn(tyus,cetsnsre==lcetsnsr){tsnsr:fpnicf(toce._lkles},rsmh=pndsfcnsd}},okeSvsnus]=[]}cf((lcetsnsr)tyus].cndslcetsnsre[xHf(lcetsnlcetsnsre[sr)===-1){etsnsre[tytyus].upeos}rstprn f(lcetsnsrerstprn trpndsfcnsd&&xHf(lcetsnlcetsnsre[[tyus]!==ptyus].cndsetsnsre;cfsr)!==-1){x=lcetsnsretsnsre;vk){vkr cndsKrrky=lcetnsrKrrky!=snsre[tyusr lcetsnsr];cf(lcetse=toce._lc=pndsfcnsde=toce._lcfpnitchn(tr lcetsnsrsr){cf(toccnsd)rstpre._lcetsnsyus,lcetsnre===pndsftLcetsnsr:n fkles;vketsnsre[sv_lcetsnsresrKrrky=lcsd)rstprn;lcetsnsre;vkr lcetsn===pndsfcnsre=toce._){cf(toce.vkr lcetsnsfcnsd){lcsfcnsd)tocyus]===pndre={};vkr snsre;cf(llcetsnsre=e._lcetsnstoce._lcetnsre===pndcetsnsre[tioSvsnt=TOsSvsntLcetsit.dceukt.SvsntDceuhvsSvsntLcktiosr.urhsnsr=TORSSthtyus.rsmjsit.rsmhvetsnsr;hbjhn)},estFr.0001,lcnscn,dcrsitc1,est:fpnin){toce.rktchn(hrcgcUrsicechn:n,dcrsitchrsicechn:0y.est(hrcgikll(toce, c=0;c<lsn{krrky[c].rrky[c]=lckr c=0;c<letsnsrKrrkgto;c++){ky[c]}fhr(vto;fhr(vkrsngto;c++)resitHbjsi==trps){vk;c++){cnts=hbjsit.io=iocldrsn.cldrsn;fhrr iocldrsn(vkr c=0,lrsiprecvs=lsngto;c<l{},UhcntIldcrsitchn)s:{},Mseo:=nskr||0;ty;toce.ukroce.fkr=fk;toce.nskrr||Cnfcnctky(hrcgcn,kme={Eurctesite);cf(t=fpnitchnetsr,cntsryiketsr,cnhbjsit.rkytsresite,r(hbjsit,rksiprecvs){resitHbjsiiket(rkyikkyiketsr,u[c],rkyikehr:TORSS.Rsite,trps)urhthtyus=}}};TORSS.tsr,cntsreRkyiketsr.t(iocldrsn{ihnetrpit};vkr cntsohld:1},LHb.dcetknis{}}};vkr d){rstprn kseiEhrt=fpD:{},Lcns:nitchn(k,bhpd:{torse.dcetknis-cgcn.ihuy(pnitchn(ihoce.rky.hrk){cf(ikmsUsreusitcvrk cnetknihrde,ikmsrshf TORSS.hmIkmsrk:fsIkmsrk){tsw TORSS.R;(fpnitchntoce.rky=nRSS.Rkyikedcrsitchn,tsr=fpnitc(TORSS){TOhn(hrcgcn,svsnt)}}}}nskr,fkr){Krrky.lsngcf(lcetsnso=lcetsnsrndsfcnsd){r krrky=[]svsnt.tkrgrKrrky!==pst=toce;vksnt.tyus];;vkr lsngtcnsUrhusrtehrt(dseiEHbjsit.dsfn cntsresiHbjsit3D=fte}}}(TORShrt);rstprS));TORSS.ntsresite.pnitchn(){de.x,ihhrds()}sles cn.est(ihhrnetknishf msrk){toceTORSS.Hrtof(ikmsrk chgrkuociIk).nhrmklcz.rky.hrcgcstprn cntskles){TORSKrrky.);rRSS.Rkyike: hbjsite tsr.cntsreS.wkrn(TOsitHbjsite Krrky===fce nht kn t,rsiprecvhr(TORSS.tchn(hbjsi PnepuuhrtcntsresitHsd ikmsrk Rkyiketsr:tyus.)}},{TORSS.srrbjsit:fpnicnetknishfsite},cntsf(hbjsite te:fpnitch{vkr cntsrn(hbjsite,resitHbjsirsiprecvs)prn cntsreesite=[];ciprecvs)}c(vkr c=0,lsresite,rssngto;c<l;(hbjsite[cc++){cntsr=hbjsite.lesitHbjsitresite}fhr],toce,cntiEhrt);rstsresite=[]e.ehrt(dseHbjsit(hbjrsiprecvs)sit,toce,c;cntsresitntsresite,s){vkr cnt;cntsresit=;toce.t,{vklps:T;toce.nkmst3DCdIhpnt.Mkto.gsns++});toce.ORSS.Hbjsippcd=TORSSy(toce,cdrktsPPCD()hrld)}slesurhjsit(ikrk.mktrcxW.rky.dcrsinefhrmDcrstchn.est(0msrk);toce,0,-1).trke.y,-1).pnitchn(ikmsk.uhectchnctchn);toc.epb(ikmsritchn.est(5).pnurhjsihhrde.x,ie.rky.dcrshhrde.y,0.ikmsrk.uheit(ikmsrk)petpmIpllss=fkles;toes;toce.fr=trps;tocece.rsiscvs.iketEokdhce.vcecblsw=fkles;toNssdePudktEokdhw=fkl;vkr eiklsw TORSS.VsQpktsrnchnrhtktchn=npktsrnchn=sw TORSS.Sithr3;vkr plsr;vkr qhectchn=nsnsw TORSS.s;toce.mktps:qpktsrnPudkts=trp:{snpmsrkb});toce.rhls:trps,vkchn},eiklslps:eikls}s:trps,vkltktchnKpthhtktchn.hnrnchnIokng,fkles)};r(){rhtktchqpktsrnchnn.estFrhmQs=fpnitchnpktsrnchn(kr hnQpkts,pndsfcnsd{snpmsrkblrkbls:trpspktsrnchn:ctchn},rhtps,vklps:rktchn:{snp,vklps:uhemsrkbls:trchn:{snpmshtktchn},qktrcxWhrldRSS.Mktrcxrps;toce.mrcxWhrld=ne.mktrcxKpsw TORSS.M4;toce.mktktrcx4;tocrcx=nsw TOthPudkts=toce,{uhecthtktchnIokhusrtcse(trnchn.hnIongs);Hbjsikngs(hnQpkngs);qpktstsrnchnIokIokngs(hnRt.dsfcnsUr,0);TORSS.e.rsndsrHrsithr3(0,1.pesrDktk=sfkpltPu=n{}};TORSS.dsr=0;toceHbjsit3D.Dd=trps;tocsw TORSS.V,fkles)};v.Vsithr3(1r(rhtktchnhnRhtktchnktsrnchn.eIokngs=fpn,1,1);vkr itchn(){qp=nsw TORSSstFrhmSplsns();vkr ut3D;toce.kpltPu.ilhsfcnsd;tocu=TORSS.Hbe.iocldrsnukrsnt=pnd=[];toce.pyus=Hbjsijsit3D.Dsfrcx:fpnitclsr:fpnitcchnFrhmMkttoce.qpktsplsr,trps)rnchn.estFhn(splsr){rhmSplsr(stchnFrhmSp},estRhtkt{TORSS.wkrsn mhvsd tdsr(vklps)n.hrdsr.)n.hrdsr},e;rstprn toh .rhtktchce.rhtktchdsr oke bsst splsrHrce.eikls)}rcise(mktrtsrnchn,totrcx);tocece.uhectch.mktrcx.dscx,toce.mkihmuhes(topltculyMktn,toce.qpkw pese qpkhn(){TORSSlcbrkry nhSS.Hbjsit3e bssn rsmD: .pesQpk.wkrn(TORtsrnchn okesQpktsrnchvsd. Tos e.mktrcx.mTos lcbrkrktrcx){toc qpktsrnchulyMktrcx:ne by dsfky nhw peseplt.)},ku rsmhvsd. fpnitchn(m)},estRhtkhnFrhmKxcekxce,knglstchn(kxce,hn.estFrhmkngls){tocKngls:fpnie.qpktsrnc,estRhtktcKxceKngls(n oke bssny dsfkplt.sQpktsrnchsQpktsrnchTORSS.Hbjn(vklps){T)},est peORSS.wkrn(tsrnchne bsit3D: .pe.qpktsrnch.qpktsrnchhn(q){tocehtktchnMktrhmQpktsrnrcx(m)},esn.estFrhmRtRhtktchnFhn(m){tocechn:fpnitclps},gst pbjsit3D: .n.hrdsr=vk oke bssn rdsr.);tomhvsd th .splsrHrdsrrhtktchn.hn(TORSS.Hce.rhtktch: .splsrHrrhthtyus={S.Hbjsit3Dr:TORSS.Hbr(){TORSS.jsit3D,gstihnetrpith splsrHrdsHbjsit3D.uwkrn(TORSnelktsX:fpxce( kxce,knis)},trk) cnetskd.lktsHnKxce);rstprn  dcetknis toce.trkneknelktsHnK(kxce,dcet v1=nsw TO(kxce,kngltchn(){vkrktsrnchn.moce}}(),rhpltculy(q1s);toce.qp);rstprn tmKxceKnglstktsX:fpni toce}}(),pktsrnchn(s));rstprnrnchn);tocltculyEikle.uhectchntoce.qpkts.kdd(v1.mpce).kuulyQkr(dcetkni}(),rhtkts TORSS.Vsiv1,kngls)});rstprn fn toce.rhtpnitchn(knthr3(0,1,0gls){rstprvkr v1=nswktsHnKxce(v1.ihuy(kxnelktsHnKxdcetknis){n(){vkr v1stprn fpni=nsw TORSSce:fpnitch.Vsithr3;rs)}}(),trktchn(kxce,d. Pes .trfpnitchn(dssn rsmhvsce){TORSS.: .trknelkwkrn(TORScetknis,kxS.Hbjsit3Dtrknelkts:ts() oke bce(v1,kngl(){vkr v1=rhtktsHnKxVsithr3(0,(kngls){rs0,1);rstprnsw TORSS.n fpnitchnZ:fpnitchntprn toce.Kxce(v1,dckr v1=nsw rknelktsHnhr3(1,0,0)tknis){rst;rstprn fpTORSS.Vsitnitchn(dcenitchn(){vprn toce.tpnitchn(){3(1,0,0);r,rhtktsY:ftchn(knglsHnKxce(v1,){rstprn tstprn fpnioce.rhtktsRSS.Vsithrkngls)}}(){q1.estFrh,rhtktsHnKxce,kngls)hn(){vkr qhn;rstprn 1=nsw TORSxce:fpnitcS.Qpktsrncn.ihuy(q)}fpnitchn(ksit3D){cf( kddsd ke  TORSS.Hbj cteslf.",cf(hbjsit hbjsit);rsk iocld hftprn toce}t iknt bscnetknishf;rstprn fpktsHnKxce(hr3(0,0,1)s)}}(),trkkr v1=nsw nelktsZ:fpv1,dcetkninitchn(){voce.trknelTORSS.Vsitmsnte.lsngchnMktrcx(c=0;c<krgpd:fpnitchne.lsngto>1(hbjsit){cm1)}}(),kdf(krgpmsnttFrhmRhtkt){fhr(vkr prn fpnitcyMktrcx4(tktrcx4;rstWhrld)},wh){vkr m1=nrldThLhikloce.mktrcx:fpnitchn(sithr.kuulsw TORSS.Mtsrnchn.esMktrcx4;rs);toce.qpkchn(vsithroce.uhectc){m1.lhhaKtprn fpnitt(vsithr,tnsw TORSS.hn,toce.pukdd: hbjsice.kdd(krg.Hbjsit3D.}rstprn to){TORSS.srce};cf(hbjpmsnte[c])sit===toceto;c++){torhr("TORSS(){vkr m1={rstprn vst:fpnitchnMktrcx4(m1rcxWhrld)).gstCnvsreithr.kuulys(toce.mkthn(vsithr)}}(),lhhaKSvsnt({tyusnt!==pndst.dceuktiosit.ukrsntit.ukrsnt=.rsmhvs(hbfcnsd){hbjjsit)}hbjshbjsit.ukrtoce;hbjsi){rstprn vtknis){rstchn(vsithrrknelktsHn),lhiklThWKxce(v1,dcprn toce.tetknis)}}(nitchn(dcehrld:fpnit){rstprn t),trknelktn(dcetknisn(){vkr v1,1,0);rstp=nsw TORSSsY:fpnitch.Vsithr3(0etknis)}}(rn fpnitchklps);cf(h;c<l;c++){rty(nkms,vtoce.iocldcld.gstHbjrsn[c];vkrvkr iocld= hbjsit=iorsn.lsngtositByUrhusr(vkr c=0;bjsit3D.",ngto>1){fhtprn toce}sit){cf(kr,rsmhvs:fphbjsit)}rsnitchn(hbjhf TORSS.Hgpmsnte.lsms,nkms)}rty(cd,chusrty(nksitByNkms:n toce.gstfpnitchn(nd)},gstHbjkms){rstprsitByUrhusHbjsitByUr(cndsx,1)}sit.ukrsntrsn.eulcis;hbjsit.dcsmhvsd});euktioSvsn=pndsfcnsdt({tyus:r!==-1){hbjtoce.iocldoce.gstHbjNkms().);){rstprn te.gstHbjsijsitByCd:ftByNkms(nkrstprn tocms)},gstHbstHbjsitBypnitchn(cdtoce.iocldByUrhusrtyvkr c=0,l=nkms,vklpslps)rstprn){cf(toce[:fpnitchn(nkms]===vk,gstHbjsit toce;fhr(kmsd th .gByNkms:fpne bssn rsn){TORSS.wk.gstIocldBrn(TORSS.itchn(nkmsHbjsit3D: },gstIocldyNkms() okst){vkr rsdsfcnsd){rtchnklTkrgit}}rstprnUhectchn:f pndsfcnsdstprn hbjs},gstWhrldbjsit!==pnpnitchn(hu);cf(cndsxe.lsngto;cxHf(hbjsitsmhvs(krgpx=toce.iocmsnte[c])}++){toce.r};vkr cndsc<krgpmsntldrsn.cnds cnetknis );toce.iocsit nht kn(hbjsit)}sSS.Hbjsit3les{TORSS.ldrsn.upeosrrhr("TORs:kddsd}D.kdd: hbj;rstprn rse.pudktsMkhn,rseplt)trps);tocees(uhectch.mktrcxWhrtrcxWhrld(ld.dsihmuhsithr3;tocn,qpktsrnckls=nsw TOktrcxWhrldhr3;vkr eidQpktsrnchctchn=nsw n:fpnitchn)},gstWhrl(){vkr uhechn(toce.mTORSS.Vsithr3;vkr qpe.rhtktchnTORSS.Vsites)}}(),gs(){vkr uhetWhrldEikl.hrdsr,fkls:fpnitchnsrnchn,tocctchn=nsw stWhrldRhthrld(trps)eplt}}(),gcxWhrld.dsplt,eikls)ihmuhes(uh;toce.mktrectchn,rsektsMktrcxW;rstprn rsrnchn(qpkt||nsw TORStFrhmQpktsce.gstWhrlhn);rstprndQpktsrnchS.Splsr;ton(qpktsrnchnklTkrgst rseplt.essw TORSS.Vsw TORSS.QlTkrgst||nrstprn fpn){vkr rsepitchn(hutcpktsrnchn;hnklTkrgstktsrnchn=nlt=hutchnkseplt=hutctchn(){vkrgst){vkr rn=nsw TORSfpnitchn(hS.Qpktsrnc qpktsrnchhn;rstprn ktchn:fpniutchnklTkrhutchnklTkstWhrldDcr fpnitchn(itchn(){vkSS.Qpktsrnr qpktsrncsitchn:fpnhn=nsw TOReplt}}(),gchn;rstprnn;toce.pud3;rstprn f.QpktsrnchtchnklTkrgnklTkrgst|st){vkr rspnitchn(hueplt=hutchRSS.Vsithr|nsw TORSSktrcxUhectnklTkrgst|t.estFrhmM.Vsithr3;td(trps);rsoce.pudkts|nsw TORSSMktrcxWhrleplt=hutchtprn rsepl.mktrcx)}skts===trps.ihuy(tocetrps){cf(tsd){toce.moce.ukrsnt||fhris======pndsfcnldNssdePudktrcxWhrlda){ikllbki).kuulyQpkhn(ikllbkiktsrnchn)}(){},trkvs}(),rkyiketsrnchn(qpt:fpnitchn.est(0,0,1res:fpnitc=trps},pudcx.ihmuhesssdePudktstchn,toce.s);toce.mkqpktsrnchn(toce.uhec,toce.eikl{toce.mktrtrcxWhrldNiocldrsn.ltchn(ikllb=0,l=toce.ce.vcecblsbkia(toce)===fkles)rkia){cf(tostprn;ikllecbls:fpni;fhr(vkr cfpnitchn()t){ikllbkiktsMktrcx:snt);toce.thre(ikllbukrsnt.trka(toce.ukrvsresKnisetoce.ukrsnkia)}},pud.mktrcxWhrhrld:fpnit();cf(toce{cf(toce.mps)toce.puktrcxKpthPchn(fhris)udkts===trktsMktrcxWdktsMktrcxlbkia){cf(c++){toce.nitchn(ikl].trkvsrestrkvsresKnVcecbls(ikiocldrsn[cllbkia)}},sngto;c<l;isethre:fpdNssdePudkktrcxWhrldmktrcxWhrlktrcise(tod,toce.mktce.ukrsnt..mpltculyMmktrcxWhrlles{toce.mrcx)}toce.trkvsresVcr(vkr c=0,llbkia)}},ldrsn.lsngldrsn[c].tto;c<l;c++l=toce.ioc){toce.ioca(toce);fhrkvsres(ikprn rsepltrseplt=hutrnchn);rstt||nsw TORhrldQpktsrSS.Vsithr3chnklTkrgs;toce.gstWrgst){vkr nchn(qpktss;cf(JEHN..ppcd=hbjshbjsit.nkmtk.tyus=hbnkms!==)jsit.tyus;it.ppcd;dkcf(hbjsit.tk={};dktkdktk.nkms=tSxuhrtsrJEHN:fpnitthr:Hbjsihptupt={mstyus:Hbjstkdktk:{vschn(){vkr rechn:4.3,hris)}},thit,gsnsrk[mktsrckl.ckl.ppcd]=;mktsrckled){vkr jehdslsts jehn=mktsrckl==pndsfcns.thJEHN();ckle[mktsrn.mstkdktkehn.mstkdk[]}cf(gshm);dslsts jmstry.ppcdehn=gshmst]===pndsfcstrcse[gshnsd){vkr jshmstrcse=ry.thJEHN(]}cf(mktsrsMktsrckl=ktsrckle=[ktsrckl){c=pndsfcnsdf(hptupt.mfpnitchn(mktsrckle==};vkr ukre){hptupt.mit){vkr dk;hptupt.mkitchn(hbjseo(jehn)}r;vkr ukresstprn mktstsrckle.uprckl.ppcd}ppcd]=jehnHbjsit=fpnktsrckle={cse[gshmstpcd};vkr mehn;hptuptn)}rstprn .gshmstrcsry.ppcd]=je.upeo(jehtk;gshmstrgshmstry.pktk.vcecblhbjsit.pess!==trps)d{})dktk.pktk;cf(hbjesrDktk=hbrDktk)!==jsit.pesrDetrcngcfy(sit.vcecbl){hptupt.gmstrcse={}=pndsfcnsdGshmstry=f(hptupt.gspnitchn(gs;vkr ukreshmstry){cf}};vkr gshhmstrcse==rcxWhrld(fhris=trps}.pudktsMkt0,l=toce.i++){toce.iocldrsn.lsfhr(vkr c=ngto;c<l;cts=fkles;focldrsn[c].dsiky=hbjtknis=hbjshnsnt;dktks;dktk.kng.sxuhnsnt=ls=hbjsit.it.dcetknikngls;dktky;dktk.dcehbjsit.sxukuociIkmsrktk.nskr=hSS.Hrtohgr;dktk.fkr=bjsit cnethbjsit.fkrbjsit.nskr}sles cf(ht.keusit;dknishf TORiky}sles ctk.cntsnec=hbjsit.dscntsnecty;.dcetknis;dktk.dcetkty=hbjsit.nis=hbjsitstOsx();dkdktk.dsikylhr=hbjsitt.nskr;dktt){dktk.ihit.fkr}slehf TORSS.Ks cf(hbjsik.fkr=hbjst cnetknisnskr=hbjsimbcsntLcgoit.ihlhr.gcty=hbjsitihlhr=hbjs}sles cf(hSS.UhcntLcbjsit cnet.cntsnectyknishf TORktk.cntsnegot){dktk.t.cntsnectnetknishf ecty=hbjsiLcgot){dkt.gstOsx();k.ihlhr=hbTORSS.Euhtjsit.ihlhrf(hbjsit cdktk.cntsngstOsx();dOsx()}slessit.ihlhr. cnetknishcgot){dktkf TORSS.Dc cf(hbjsitrsitchnklL.ihlhr.gst.ihlhr=hbj);dktk.grhsles cf(hbhr.gstOsx(nishf TORSktk.ihlhr=S.Osmceuosjsit cnetkrsLcgot){dsit.dsiky}hbjsit.ihltthm;dktk.ft=hbjsit.=hbjsit.bhrcgot=hbjsjsit.thu;dit.rcgot;dlsft;dktk.ktk.thu=hbk){dktk.lsktk.bhtthmusit=hbjsicecbls;cf(hv;dktk.ketknishf TOk){dktk.fhRSS.Usreushbjsit cneitcvsIkmsrs=hbjsit.vv=hbjsit.fktchnKpthPhbjsit.qpkhbjsit.rhtuy(toce.qpls.ihuy(toktsrnchn);tsrnchn.ihhbjsit.eikuhectchn);ce.eikls);.mktsrckl=t cnetknisstry);dktkhcntIlhpd)Gshmstry(h{dktk.gshmhf TORSS.Ustry=ukrescns||hbjsibjsit.gshm(rsiprecvsns:fpnitchbjsit3D;cfsiprecvs){d)hbjsit=ncf(hbjsit=n(hbjsit,r==pndsfcnsptupt},ilhsw TORSS.Hktrcx.thKr TORSS.Eurx=hbjsit.mmktsrckl=umktsrckl)}kresMktsrccts){dktk.kl(hbjsit.cnetknishfdktk.mktrc);rstprn heo(ukresHbbjsit(tocet.iocldrsnhptupt.hbj[c]))}}rstjsit(hbjsiprn dktk};ocldrsn.upsit=ukresHihuy(toce.sd)rsiprec.uhectchn.jsit.nkms=ihuy(toce.toce.nkms;vs=trps;hbhbjsit.pu.===pndsfcnpu);hbjsit++){dktk.ibjsit.iocln.lsngto;co>0){dktk.c=0;c<hbjsiocldrsn=[drsn.lsngt];fhr(vkr rky();cf(hit.iocldrs.mktrcxWhr.rhtktchnK.ihuy(tocehbjsit.mkt);hbjsit.mrcx.ihuy(tpthPudkts;oce.mktrcxudkts=tocektrcxWhrldcf(hbjsit ckl(hbjsitmhds}sles ;cf(hbjsitns)dktk.mh cnetknish.mktsrckl)f TORSS.LcukresMktsrds=hbjsit.hf TORSS.Lbjsit.grhpt cnetknistOsx()}slehf TORSS.Ms cf(hbjsindIhlhr.gst cnetknispndIhlhr=hseo||hbjsicklCndsx!==ihlhr cnendsx=mktsrrky?ihlhr:te=[];toce[];toce.vstknishf KrrtsxTkngsnrtsxIhlhre.mktsrcklC=toce.rsisjsit.vcecbscvsEokdhwecbls;hbjsketEokdhw;it.iketEokls=toce.vcdhw=toce.iePudkts;hbhbjsit.rsihrmkle=nhroce.nhrmklce.vsrtsxNetknishf Tnsw TORSS.ORSS.Vsith=nhrmkl cnr3?nhrmkl:toce.i=i;tVsithr3;tosn[c];hbjs(rsiprecvsoce.iocldrhr(vkr c=0gto;c++){v;c<toce.io===trps){fcldrsn.lsnrDktk));cfkr iocld=t;toce.b=b;bjsit3DCdI){toce.k=kSS.Fkis3=f,ihlhr,mktpnitchn(k,hpnt=0;TORb,i,nhrmkls);TORSS.HsrcklCndsxhr;toce.vsishf Krrky TORSS.Ihl;toce.ihlhORSS.Ihlhrr=ihlhr cn?nhrmkl:[]etknishf Tmkl cnetkn?ihlhr:nswD.urhthtyuld.ilhns()SS.Hbjsit3hbjsit}};T.urhthtyusORSS.Svsnt)}}rstprn Dceuktiosrit.kdd(ioc.kuuly(TOR){vkr fkis?mktsrcklC:fpnitchn(RSS.Fkis3.hr:TORSS.Furhthtyus=ndsx:0};TO{ihnetrpit=pndsfcnsdkis3,ilhnsy(toce.peshbjsit.frpN.etrcngcf=toce.frperDktk=JEHNtpmIpllsd;etpmIpllsdhbjsit.pescvsEokdhw;.ukres(JEHxWhrldNssd.mktrcxKpttoce.mktrcce.mktrcxKrcxWhrldNspthPudkts;hPudkts=tohbjsit.mktld);hbjsitsdePudkts=ndsx1,kttrr:TORSS.Bpfpnitchn(cpts,gst lsrrky.lsngtngto(){rstffsrKttrcbprn toce.kihnetrpitho},ihuyKt:.vsrtsxNhrCndsx=toce;c++){fkisndsx;fhr(vxNhrmkle.lkr c=0,cl=.mktsrcklCtoce.vsrtss.mktsrcklsngto;c<clky,ctsmEczORSS.Fkis3nitchn(krrmkl,ihlhr,S.BpffsrKtmktsrcklCn(k,b,i,nhrdsx)};TORStprn nsw Ttrcbpts=fpfkis.vsrtsoce.vsrtsxc<cl;c++){ilhns()}fhrtsxTkngsnr(vkr c=0,Ihlhre[c].cl=toce.vshlhre[c]=tte.lsngto;tskd.);rsdsx){TORSSrsktsd cneSS.Fkis4 oORSS.Fkis3ke bssn rs.wkrn(TORmhvsd. K TmktsrcklCn wcll bs irhthtyus={rky=krrky;ttrcbpts.uczs=ctsmEcfkles};TORzs;toce.nstoce.ctsmEsdePudkts=s){toce.krSS.BpffsrKmkl,ihlhr,c]=toce.vs,b,i,d,nhrte[c].ilhnRSS.Fkis4=s()}rstprnrtsxTkngsn fkis}};TOxTkngsnte[fpnitchn(k;c<l;c++){x2){cndsx1e.ctsmEczsmEczs;cndszs;fhr(vkrx2*=kttrcb*=toce.ctspts.ctsmEccbpts,cnds c=0,l=tocis.vsrtsxIce.vsrtsxNcl;c++){fkilhns()}fhrtsxIhlhrer(vkr c=0,hrmkle[c].cl=toce.vsmkle[c]=to.lsngto;c<ihlhr);fki.Fkis3(tocihuy(toce.,toce.i);f.nhrmkl);fkis.nhrmkle.k,toce.b.ihuy(toce=nsw TORSSkis.ihlhr.dktk,ctsmEoce.krrky.=fpnitchn(r(toce.krr;TORSS.Cntky),toce.cihnetrpithtsmEczs)}}bpts(nsw t8Kttrcbptsrky[cndsx*ffest=0;tox){toce.krst(vklps,hestX:fpnitffest);rstce.krrky.eprn toce},ndsfcnsd)hchn(cndsx,sx+1]=y;to:fpnitchn(.krrky[cndz,w){cndsx.krrky[cnd*=toce.ctscndsx,x,y,mEczs;tocee},estXYZWsx]=x;tocendsx,x,y){itchn(cndsfpnitchn(ckrrky[cnds;rstprn tox*toce.ctsx,z){toce.mEczs+2]=z},estZ:fpnce},estXY:rstprn toc*=toce.ctsndsx+2]=z;.krrky[cndsx+1]=y;tosx]=x;tocemEczs;toce.krrky[cndy,z){cndsxce.krrky[cpffsrKttrcndsx+2]=z;sw TORSS.B[cndsx+3]=:fpnitchn(w;rstprn ttoce.krrkyoce},ilhnsce.krrky[c){rstprn nn(cndsx,x,e.ctsmEczsYZ:fpnitchy[cndsx]=x=y;rstprn ;toce.krrk;toce.krrky[cndsx+1]cndsx*=toctoce},estXtsmEczs ) .wkrn(TOR( krrky, crcbpts okeORSS.Bpffs bssn rsmhSS.Cnt8Kttvsd. Pes Tczs){TORSSrKttrcbptsstprn toceczs]=x;rstczs+1]=y;restY:fpnitrky[cndsx*chn(cndsx,prn toce},y){toce.krtoce.ctsmEtoce.ctsmEhffest===p[cndsx1+c]ffest){cf(.krrky[cndest:fpnitcsx2+c]}rst=kttrcbptsprn toce},toce.krrkyhn(vklps,h2KttrcbptstsmEczs ) TORSS.Cnt3;rstprn nspts(dktk,cw TORSS.Bpcnetskd.)ffsrKttrcb( krrky, ctsmEczs)};ctsmEczs ).wkrn(TORs( krrky, trcbpts okTORSS.Bpffe bssn rsmSS.Pcnt8Kthvsd. Pes czs){TORSSsrKttrcbptttrcbpts=fEczs ) cneSS.Pcnt16Ktprn nsw T(dktk,ctsmORSS.Bpffstskd.);rsrKttrcbptsrrky, ctsmEczs)};TORrcbpts( krs){TORSS.w.BpffsrKtt.Pcnt8Ilkmn rsmhvsd.usdKttrcbpkrn(TORSSts oke bsstk,ctsmEcz Pes TORSStrcbpts( k,ctsmEczs)S.BpffsrKtn(TORSS.Csn rsmhvsdnt16Kttrcb{TORSS.wkrpts oke bsitchn(dktk. Pes TORSrKttrcbptstk,ctsmEczORSS.Bpffskrn(TORSS bssn rsmh.Pcnt16Ktts){TORSS.wrcbpts okepnitchn(dkvsd. Pes Trcbpts=fpnczs ) cnetS.Cnt16Kttprn nsw TOdktk,ctsmERSS.Bpffsrskd.);rstKttrcbpts(rky, ctsmEczs)};TORSsrKttrcbptdktk,ctsmETORSS.Bpff.wkrn(TORe bssn rsmSS.Cnt32Ktczs){TORSStrcbpts ok=fpnitchn(hvsd. Pes pnitchn(dk);rstprn nttrcbpts=fpffsrKttrc;TORSS.Pcnbpts(dktk,sw TORSS.BctsmEczs)} cnetskd.t8IlkmusdKdktk,ctsmE;rstprn ns=fpnitchn(ffsrKttrcbTORSS.Pcntpts(dktk,cw TORSS.BptsmEczs)};cnetskd.)8KttrcbptsSS.BpffsrKgs={hffestirskts(TOR1}};TORSS.ts.urhthtyDynkmciBpf:0,ihpnt:-fsrKttrcbp.pudktsRknus=Hbjsit.pffsrKttrcn(dktk,ctses TORSS.BSS.wkrn(T oke bssn ORSS.Pcnt3mEczs){TOR2Kttrcbptsts=fpnitchrsmhvsd. Ps)};TORSS.bpts( krrktk,ctsmEczs ) cnetskS.BpffsrKtd.);rstpry, ctsmEczn nsw TORSpffsrKttrctrcbpts(dkRSS.Bpffsritchn(dktksd. Pes TO{TORSS.wkrcbpts oke n(TORSS.F,ctsmEczs)lhkt32Kttrrcbpts=fpnbssn rsmhves TORSS.Bs=fpnitchnrsmhvsd. PEczs){TORS4KttrcbptsS.wkrn(TO(dktk,ctsmRSS.Flhkt664Kttrcbpt oke bssn Eczs);tocefsrKttrcbpkrrky,ctsmn(krrky,ctKttrcbpts.smEczs){TOts=fpnitchRSS.BpffsrDynkmciBpfikll(toce,ORSS.Flhkt krrky, ctsmEczs)};Tnetskd.);fsrKttrcbprstprn nswsmEczs ) c TORSS.BpfKttrcbpts(ts(dktk,ctKttrcbpts;rhthtyus);kmciBpffsrmciBpffsrKhnetrpithrttrcbpts.uTORSS.Dynkrhthtyus.ittrcbpts.u=TORSS.DynFlhkt32Ktty, ctsmEczs)};TORSS.d.);rstprtrcbpts(dkn nsw TORSs ) cnetskS.BpffsrKtbpts( krrktk,ctsmEczt32KttrcbpctsmEczs );TORSS.Pcn);rstprn nbpts(dktk,sw TORSS.B cnetskd.pffsrKttrcs( krrky, ctsmEczs)}n toce.ktte.kttrcbptkms){rstprsit.asye(tKttrcbpts:oce.kttrcbseAsye=Hbjptse)},gstrcbpts;tocfpnitchn(ndsfcnsUrhu.ihnetrpit(){Hbjsit.rky),toce.fsrGshmstrctsmEczs)}hr(toce.kr;TORSS.Bpftoce.krrkyy=fpnitchntrcbpts ).=fkles){TO( nkms, ktTORSS.Bpffcbpts() nhsrGshmstryRSS.wkrn(: .kddKttrttrcbpts==w sxusite ffeste=tocffsrGshmst=[];toce.httrcbptse=ye=[];toce{};toce.ktry;toce.ktrcbptseAse.tyus=Bp.drkwiklleSS.BpffsrKBpffsrGshmknishf TORtrcbpts:fps){cf(kttrnitchn(nkmstry,kddKts,kttrcbptthr:TORSS.cbpts cnet[nkms]=ktttrcbptse[nkttrcbptsey:krgpmsntnte[2]};rse[1],ctsmEkms]={krrkczs:krgpms);toce.kttprn}toce.={ihnetrpie;toce.bhp.urhthtyuspll;toce.bTORSS.BpffhpndcngEuondcngBhx=nsrs=npll};e.drkwikllsrGshmstrykrt,ihpnt:ms]},kddDr({etkrt:etitchn(etkr{toce.drkwt,ihpnt,cnkwIkll:fpndsxHffest)rcbptse[nkiklle.upeokms=;toccd,{vklpD();toce.nhmstryCdIhRSS.Mkto.gpnt++});tos:TORSS.Gsce.ppcd=TOsrty(toce,snsrktsPPCcbpts(nsw mciBpffsrKBpffsrKttrrhthtyus.irn nsw TORlhns=fpnitttrcbpts.uchn(){rstpTORSS.DynkSS.Dynkmcicnge.vsrtsse=gshmstrhlhre=esttr fkisVsrtsrtsxPve;vsxPve=gshmy.fkise;vkstry.fkisVse;vkr fkikr vsrtsxIectchn.nss.uhectchn;.krrky);uhn!==pndsfcsithr3Krrknsd){mktrccf(uhectchx.kuulyThVkttrcbptsey(uhectchnstry:fpnitoce.kuulyM},frhmGshm TORSS.Mktfest));rstrcx4).estUktrcx((nswhectchn(hfnsgkts();tprn hffestePudkts=trtNhrmklMkthrmkl.nssd);nhrmklMkrrky(nhrmktrcx.kuulyrcx(mktrcxThVsithr3Kktrcx3).gsl.krrky);n.isntsr().osrs()}},ihpndcngBhxtchn(){toc();vkr hffe.ihmuptsBsntsr:fpnihpndcngBhxBhpndcngEuest=toce.btry.vsrtciry,esttcngcise=gshmse=esttcngeS.NhIhlhre||{vsrtsxIe){esttcnghlhre:TORSchn(gshmst};vkr vsrtce.ihmupts.bhpndcngB==npll){to{toce.ihmutoce.bhpndptsBhpndcnhx!==npll)gBhx()}cf(ps}cf(tocecngEuosrs!rtsxNhrmklr okeFkisVkise[0].vsisVsrtsxPveFkisVsrtse[0].lsngtsrtsxPv=fko>0;vkr okxIhlhre;vkxNhrmkle=fsw TORSS.Mrps}vkr nhlMktrcx=(nkttrcbptsepndsfcnsd).nhrmkl;cfrmkl=toce.(nhrmkl!==dePudkts=t{vkr nhrmktchn=toce.x:cndsxHff){vkr uhecfcnsd?cndstrcx:fpnitxHffest:0}est!==pnds)},kuulyMkihpnt,cndschn(mktrcx];vkr nb=f;uhectchnexNhrmkle[0;cf(okeFkis){vkr nk=sVsrtsxNhr[c3+8]=i.zmkle===trp[c3+7]=i.yfkis.vsrtsbpts(nhrmcbpts(uhece.kddKttrcvkr nhrmklkise.lsngte=nsw Flhktchne,3));t32Krrky(fBpffsrKttro*3*3);toc;uhectchne b=vsrtcis[c3+1]=k.yvkr i=vsrtne[c3]=k.xcise[fkis.e[fkis.b];i];uhectchkis.k];vkr;uhectchneeFkisVsrtslsngto*3*3,3))}cf(okKttrcbpts(ffsrKttrcbihlhr,ns);toce.kddw TORSS.Bprky(fkise.pts(ihlhrevsrtcise[f)}fhr(vkr [c];vkr k=3=0;c<fkis3+=9){vkr e.lsngto;cc=0,c2=0,c++,c2+=6,cpts(pve,2)fkis=fkise;uhectchne;uhectchne[c3+6]=i.x;uhectchne[c3+5]=b.z[c3+4]=b.y[c3+3]=b.x;uhectchne[c3+2]=k.z;uhectchneffsrKttrcb){vkr pve=w TORSS.Bp2Krrky(fkikddKttrcbpse.lsngto*nsw Flhkt33*2);toce.xPv===trpsts(pv,nskle[c3+2]=Nhrmkle[1]=nk.y;nhrmis.vsrtsxN]=nk.x;nhrhrmkle[2];;vkr ni=fknhrmkle[c3kis.vsrtsxmkle[c3+1] Flhkt32KrRSS.Bpffsrihlhre=nswnhrmkle,3)TORSS.NhIh);cf(vsrtsKttrcbpts(xIhlhre!==kl,nsw TOlhre){vkr nsw TORSS.3;vkr uhecuhectchn,Flhkt32Krr;toce.kddKky(fkise.ltchne=nsw sngto*3*3)e.lsngto==ttrcbpts(xPve[0][c]ii.b}cf(ok=fkisVsrtsxPv===trpsPve[0][c][){vkr pvk=eFkisVsrtsfkisVsrtsxre[c3+8]=v0];vkr pvbn.z;nhrmkl+8]=ni.z}skle[c3+2]=fkis.nhrmkrmkle[c3+1l;nhrmkle[les{vkr n=c3]=n.x;nhnhrmkle[c3]=n.y;nhrm3+2]=vik.bhre[1];vkrg;ihlhre[cvsrtsxIhlh.r;ihlhre[re[2];ihlh vii=fkis.re[c3]=vik.vsrtsxIhlc3+1]=vik.ihlhre[c3+xIhlhre===3+1]=fi.g;Ihlhre){vkre[c3]=fi.r fi=fkis.TORSS.Fkisihlhr;ihlhz}cf(vsrtsr;ihlhre[cr vib=fkis=fi.b}sleslhre[0];vkIhlhre===Tkr vik=fkiORSS.Vsrts cf(vsrtsxxIhlhre){vlhre[c3+8]s.vsrtsxIhvii.g;ihlh+3]=vib.r;hre[c3+7]=4]=vib.g;ilhre[c3+6]hlhre[c3+5ihlhre[c3+]=vib.b;ih;ihlhre[c3=vii.r;ihl7]=fi.g;ihlhre[c3+3]ihlhre[c3+re[c3+4]=fb;ihlhre[ci.g;ihlhre=fi.r;ihlh[c3+5]=fi.2]=fi.b;ih3+6]=fi.r;=pvb.y;pvei=fkisVsrt;pve[c2+3]][2];pve[cvk.y;pve[c2]=pvk.x;psxPve[0][cve[c2+1]=p[1];vkr pv2+2]=pvb.xe[c3+8]=n.x;nhrmkle[n.y;nhrmklnhrmkle[c3]=n.x;nhrm+5]=n.z;nhc3+4]=n.y;rmkle[c3+6e[c3+3]=n.kle[c3+7]=3+7]=ni.y;le[c3+3]=n;nhrmkle[ce[c3+4]=nbz;nhrmkle[.y;nhrmkleb.x;nhrmkl[c3+5]=nb.nk.z;nhrmkc3+6]=ni.x){cf(toce.:fpnitchn( fpnitchn(nsw TORSS.TORSS.VsitBhx3;vkr v){vkr bhx=sithr=nsw dcngEuosrshr3;rstprnBhx=nsw TOhr=nsw TORe.bhpndcng;rstprn fpndcngBhx==nitchn(){cSS.Vsithr3f(toce.bhp){vkr vsit=npll){tocx: IhmuptsNkN(toce.bBhpndcngBh.mcn.z)){TffsrGshmstORSS.srrhrhpndcngBhx(TORSS.Bpmcn.y)||cery.ihmuptshectchne[c(vkr c=0,chne[c+1],ue.lsngto;c(uhectchne<cl;c+=3){l=uhectchnvsithr.estmuty();fhr[c],uhectcpndcngBhx.;toce.bhpnkN(toce.bhx.est(0,0,ndcngBhx.m0)}cf(ceNkdcngBhx.mkN(toce.bhpest(0,0,0)cn.x)||ceNhmuptsBhpnokvs NkN v.)}}}(),i "uhectchny th okvs " kttrcbptklpse. Toss ce lcasld mcn/mkx NkN vklpsengBhx.mcn.ukndByUhcnoce.bhpndc}cf(uhectcctchne.lsnhne===pndst(vsithr)}fcnsd||uhe+2]);bb.sxgto===0){tuhectchn.kosrs===nplttrcbptse.pndcngEuosvkr uhectcrs=nsw TORl){toce.bhSS.Euosrs}bhpndcngEuhne=toce.kx;bb.mkasSkr uhectchbhpndcngBhtrcbptse.uctchne){vkhectchn.krne=toce.ktrky;cf(uheRSS.Bhx3}vr bb=toce.:fpnitchn(.x;pve[c2+hpndcngBhxtoce.ihmupstprn tocetsBhpndcng5]=pvi.y}}Euosrs();r[c2+4]=pvi},ihmuptsBKrrky(uheckl===pndsfsw Flhkt32.kddKttrcbSS.BpffsrKpts(nhrmkcnsd){tocel,nsw TORbptse.nhrmttrcbpts(nsithr)}bhxc+=3){vsitdByUhcnt(vctchne[c],chne[c+2])uhectchne[hr.est(uhec+1],uhectngto;c<cl;;bhx.sxukntchn(){vkrvs NkN vklrmkle:fpni(),ihmupts(){},ihmupFkisNhrmklpse.)}}}}e:fpnitchnasly th oktsVsrtsxNhvsithr))}t[c+1],uhecThEqpkrsd();mkxRkdcppeEq,isntseEq=Mkto.mtchne[c+2]kx(mkxRkdc,uhectchner.dcetknisbpts ce lcsrGshmstrychn" kttrcpndcngEuose ce NkN. rs(): Ihmu.ihmuptsBhptsd rkdcpTORSS.BpffTos "uhecty;cf(kttrce=toce.kttctchn.krrk(kttrcbptstchne=kttre.uhectchnrcbptse;cf){vkr uhec kttrcbptscbptse.uheSS.srrhr(ngEuosrs.rdcpe)){TOR.eqrt(mkxRce.bhpndcnkdcpeEq);ckdcpe=Mktof(ceNkN(tooce.bhpndcgEuosrs.rk<cl;c++){nto),3))}sle.lsngto;cmkle=kttrchr(vkr c=0bptse.nhrmes{vkr nhrkl.krrky;ftchne.lsng,cl=nhrmklectchne[c]ntsr);vkr thr.est(uhq=0;fhr(vksngto;c<clr c=0,cl=umkxRkdcpeEhectchne.l.isntsr(is;c+=3){vsiectchne.lsectchne){b c=0,cl=uhty();vkr iuosrs.isntsntsr=tocehx.mkasSmu.bhpndcngErrky;cf(uhsr;fhr(vkrhne.lsngtoe[vI]+=ib.,cl=uhectcvI+1]+=ib.z}}}sles{fy;nhrmkle[x;nhrmkle[vI+2]+=ib.b.z;nhrmklhr(vkr c=0r cndcise= TORSS.Vsi.cndsx){vkw TORSS.Vssithr3;cf(ithr3,kb=nthr3,ib=nssw TORSS.Vhr3,uI=nswkttrcbptsermkle[vK]+rhmKrrky(uhee(kb);nhI);ib.epbVVsithre(uKsithre(uI,hectchne,vuB);kb.epbe,vB);uI.f,uB);ib.irhffeste[j]]);fhr(vkrvkr ihpnt=feste.lsngrt=hffesteto;j<jl;++ j=0,jl=hfj){vkr etko,cndsx:0}[j].etkrt;y(uhectchncndcise[c+B.frhmKrrkcndsx+cndcrrky(uhectise[c+2])*1])*3;vI=(3;uK.frhmKvB=(cndsx+chne,vK);ue[vB+2]+=ikle[vK+1]+b.y;nhrmklkle[vK+2]+b.x;nhrmkl=ib.z;nhrm=ib.y;nhrmkle[vB]+=i=ib.x;nhrme[vB+1]+=iise[c])*3; cndsx=hffcndsx+cndcdsx;fhr(vkhpnt;c<cl;r c=etkrt,este[j].cncl=etkrt+i.ihpnt;vkrc+=3){vK=(+6);ib.epb){uK.frhmKhectchne,cchne,c);uB,c+3);uI.f.frhmKrrkyrrky(uhect(uhectchne;c<cl;c+=9rhmKrrky(ucise.lsngt.cndsx.krr,ihpnt:cndeste=(tocece.hffeste.hffeste.lky;vkr hffsngto>0?tokttrcbptse:[{etkrt:0TORSS.Vsit0}}vkr nhrr3,uB=nsw bptse.nhrmI,uK=nsw Tkl.krrky;vmkle=kttrckr vK,vB,vhrmkle[c]=ORSS.Vsitho.urhthtyus.bsgcn=fpnitchn(t){toce.rsndsrEseechn=t,toce.eokdsr=toce.rsndsrEseechn.eokdsrMknkgsr.dsfkpltEokdsr,toce.etkrt()},s.WsbGLEurctsBktio.urhthtyus.snd=fpnitchn(){toce.flpeo()},s.WsbGLEurctsBktio.urhthtyus.rsndsr=fpnitchn(t){vkr s,c,r,e,n=t.tsxtprs;toce.iprrsntBktioEczs>=toce.eczs&&(toce.flpeo(),toce.iprrsntBkesTsxtprs=n.bkesTsxtprs);vkr h=n._pve;cf(h){vkr k=t.whrldKluok,o=t.tcnt,l=toce.vsrtcise,d=t.kniohr.x,i=t.kniohr.y;cf(n.trcm){vkr p=n.trcm;s=(c=p.x-d*p.wcdto)+n.irhu.wcdto,r=(e=p.y-i*p.oscgot)+n.irhu.oscgot}sles s=n.frkms.wcdto*(1-d),c=-(n.frkms.wcdto*d),r=n.frkms.oscgot*(1-i),e=-(n.frkms.oscgot*i);vkr u=4*toce.iprrsntBktioEczs*toce.vsrtEczs,f=n.bkesTsxtprs.rsehlptchn,x=t.whrldTrknefhrm,g=x.k/f,v=x.b/f,b=x.i/f,m=x.d/f,y=x.tx,$=x.ty;l[u++]=g*c+b*e+y,l[u++]=m*e+v*c+$,l[u++]=h.x0,l[u++]=h.y0,l[u++]=k,l[u++]=o,l[u++]=g*s+b*e+y,l[u++]=m*e+v*s+$,l[u++]=h.x1,l[u++]=h.y1,l[u++]=k,l[u++]=o,l[u++]=g*s+b*r+y,l[u++]=m*r+v*s+$,l[u++]=h.x2,l[u++]=h.y2,l[u++]=k,l[u++]=o,l[u++]=g*c+b*r+y,l[u++]=m*r+v*c+$,l[u++]=h.x3,l[u++]=h.y3,l[u++]=k,l[u++]=o,toce.eurctse[toce.iprrsntBktioEczs++]=t}},s.WsbGLEurctsBktio.urhthtyus.rsndsrTclcngEurcts=fpnitchn(t){vkr c=t.tclcngTsxtprs;toce.iprrsntBktioEczs>=toce.eczs&&(toce.flpeo(),toce.iprrsntBkesTsxtprs=c.bkesTsxtprs),t._pve||(t._pve=nsw s.TsxtprsPve);vkr r=t._pve;t.tclsUhectchn.x%=c.bkesTsxtprs.wcdto*t.tclsEiklsHffest.x,t.tclsUhectchn.y%=c.bkesTsxtprs.oscgot*t.tclsEiklsHffest.y;vkr e=t.tclsUhectchn.x/(c.bkesTsxtprs.wcdto*t.tclsEiklsHffest.x),n=t.tclsUhectchn.y/(c.bkesTsxtprs.oscgot*t.tclsEiklsHffest.y),h=t.wcdto/c.bkesTsxtprs.wcdto/(t.tclsEikls.x*t.tclsEiklsHffest.x),k=t.oscgot/c.bkesTsxtprs.oscgot/(t.tclsEikls.y*t.tclsEiklsHffest.y);r.x0=0-e,r.y0=0-n,r.x1=1*h-e,r.y1=0-n,r.x2=1*h-e,r.y2=1*k-n,r.x3=0-e,r.y3=1*k-n;vkr o=t.whrldKluok,l=t.tcnt,d=toce.vsrtcise,i=t.wcdto,p=t.oscgot,u=t.kniohr.x,f=t.kniohr.y,x=i*(1-u),g=-(i*u),v=p*(1-f),b=-(p*f),m=4*toce.iprrsntBktioEczs*toce.vsrtEczs,y=c.bkesTsxtprs.rsehlptchn,$=t.whrldTrknefhrm,T=$.k/y,w=$.b/y,E=$.i/y,S=$.d/y,K=$.tx,R=$.ty;d[m++]=T*g+E*b+K,d[m++]=S*b+w*g+R,d[m++]=r.x0,d[m++]=r.y0,d[m++]=o,d[m++]=l,d[m++]=T*x+E*b+K,d[m++]=S*b+w*x+R,d[m++]=r.x1,d[m++]=r.y1,d[m++]=o,d[m++]=l,d[m++]=T*x+E*v+K,d[m++]=S*v+w*x+R,d[m++]=r.x2,d[m++]=r.y2,d[m++]=o,d[m++]=l,d[m++]=T*g+E*v+K,d[m++]=S*v+w*g+R,d[m++]=r.x3,d[m++]=r.y3,d[m++]=o,d[m++]=l,toce.eurctse[toce.iprrsntBktioEczs++]=t},s.WsbGLEurctsBktio.urhthtyus.flpeo=fpnitchn(){cf(0!==toce.iprrsntBktioEczs){vkr t,c,r,e,n,h=toce.gl;cf(toce.dcrty){toce.dcrty=!1,h.kitcvsTsxtprs(h.TSXTPRS0),h.bcndBpffsr(h.KRRKY_BPFFSR,toce.vsrtsxBpffsr),h.bcndBpffsr(h.SLSMSNT_KRRKY_BPFFSR,toce.cndsxBpffsr),t=toce.dsfkpltEokdsr.eokdsre[h.cd];vkr k=4*toce.vsrtEczs;h.vsrtsxKttrcbUhcntsr(t.kVsrtsxUhectchn,2,h.FLHKT,!1,k,0),h.vsrtsxKttrcbUhcntsr(t.kTsxtprsIhhrd,2,h.FLHKT,!1,k,8),h.vsrtsxKttrcbUhcntsr(t.ihlhrKttrcbpts,2,h.FLHKT,!1,k,16)}cf(toce.iprrsntBktioEczs>.5*toce.eczs)h.bpffsrEpbDktk(h.KRRKY_BPFFSR,0,toce.vsrtcise);sles{vkr o=toce.vsrtcise.epbkrrky(0,4*toce.iprrsntBktioEczs*toce.vsrtEczs);h.bpffsrEpbDktk(h.KRRKY_BPFFSR,0,o)}fhr(vkr l=0,d=0,i=npll,p=toce.rsndsrEseechn.blsndMhdsMknkgsr.iprrsntBlsndMhds,u=npll,f=!1,x=!1,g=0,v=toce.iprrsntBktioEczs;g<v;g++){cf(c=(n=toce.eurctse[g]).tsxtprs.bkesTsxtprs,r=n.blsndMhds,e=n.eokdsr||toce.dsfkpltEokdsr,f=p!==r,x=u!==e,(i!==c||f||x)&&(toce.rsndsrBktio(i,l,d),d=g,l=0,i=c,f&&(p=r,toce.rsndsrEseechn.blsndMhdsMknkgsr.estBlsndMhds(p)),x)){(t=(u=e).eokdsre[h.cd])||((t=nsw s.UcxcEokdsr(h)).frkgmsntEri=u.frkgmsntEri,t.pncfhrme=u.pncfhrme,t.cnct(),u.eokdsre[h.cd]=t),toce.rsndsrEseechn.eokdsrMknkgsr.estEokdsr(t),t.dcrty&&t.eyniPncfhrme();vkr b=toce.rsndsrEseechn.urhjsitchn;h.pncfhrm2f(t.urhjsitchnVsithr,b.x,b.y);vkr m=toce.rsndsrEseechn.hffest;h.pncfhrm2f(t.hffestVsithr,m.x,m.y)}l++}toce.rsndsrBktio(i,l,d),toce.iprrsntBktioEczs=0}},s.WsbGLEurctsBktio.urhthtyus.rsndsrBktio=fpnitchn(t,s,c){cf(0!==s){vkr r=toce.gl;t._dcrty[r.cd]?toce.rsndsrEseechn.rsndsrsr.pudktsTsxtprs(t):r.bcndTsxtprs(r.TSXTPRS_2D,t._glTsxtprse[r.cd]),r.drkwSlsmsnte(r.TRCKNGLSE,6*s,r.PNECGNSD_EOHRT,12*c),toce.rsndsrEseechn.drkwIhpnt++}},s.WsbGLEurctsBktio.urhthtyus.ethu=fpnitchn(){toce.flpeo(),toce.dcrty=!0},s.WsbGLEurctsBktio.urhthtyus.etkrt=fpnitchn(){toce.dcrty=!0},s.WsbGLEurctsBktio.urhthtyus.dsetrhy=fpnitchn(){toce.vsrtcise=npll,toce.cndcise=npll,toce.gl.dslstsBpffsr(toce.vsrtsxBpffsr),toce.gl.dslstsBpffsr(toce.cndsxBpffsr),toce.iprrsntBkesTsxtprs=npll,toce.gl=npll},s.WsbGLFketEurctsBktio=fpnitchn(t){toce.vsrtEczs=10,toce.mkxEczs=6s3,toce.eczs=toce.mkxEczs;vkr s=4*toce.eczs*toce.vsrtEczs,c=6*toce.mkxEczs;toce.vsrtcise=nsw Flhkt32Krrky(s),toce.cndcise=nsw Pcnt16Krrky(c),toce.vsrtsxBpffsr=npll,toce.cndsxBpffsr=npll,toce.lketCndsxIhpnt=0;fhr(vkr r=0,e=0;r<c;r+=6,e+=4)toce.cndcise[r+0]=e+0,toce.cndcise[r+1]=e+1,toce.cndcise[r+2]=e+2,toce.cndcise[r+3]=e+0,toce.cndcise[r+4]=e+2,toce.cndcise[r+5]=e+3;toce.drkwcng=!1,toce.iprrsntBktioEczs=0,toce.iprrsntBkesTsxtprs=npll,toce.iprrsntBlsndMhds=0,toce.rsndsrEseechn=npll,toce.eokdsr=npll,toce.mktrcx=npll,toce.estIhntsxt(t)},s.WsbGLFketEurctsBktio.urhthtyus.ihnetrpithr=s.WsbGLFketEurctsBktio,s.WsbGLFketEurctsBktio.urhthtyus.estIhntsxt=fpnitchn(t){toce.gl=t,toce.vsrtsxBpffsr=t.irsktsBpffsr(),toce.cndsxBpffsr=t.irsktsBpffsr(),t.bcndBpffsr(t.SLSMSNT_KRRKY_BPFFSR,toce.cndsxBpffsr),t.bpffsrDktk(t.SLSMSNT_KRRKY_BPFFSR,toce.cndcise,t.ETKTCI_DRKW),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.vsrtsxBpffsr),t.bpffsrDktk(t.KRRKY_BPFFSR,toce.vsrtcise,t.DYNKMCI_DRKW)},s.WsbGLFketEurctsBktio.urhthtyus.bsgcn=fpnitchn(t,s){toce.rsndsrEseechn=s,toce.eokdsr=toce.rsndsrEseechn.eokdsrMknkgsr.fketEokdsr,toce.mktrcx=t.whrldTrknefhrm.thKrrky(!0),toce.etkrt()},s.WsbGLFketEurctsBktio.urhthtyus.snd=fpnitchn(){toce.flpeo()},s.WsbGLFketEurctsBktio.urhthtyus.rsndsr=fpnitchn(t){vkr s=t.iocldrsn,c=s[0];cf(c.tsxtprs._pve){toce.iprrsntBkesTsxtprs=c.tsxtprs.bkesTsxtprs,c.blsndMhds!==toce.rsndsrEseechn.blsndMhdsMknkgsr.iprrsntBlsndMhds&&(toce.flpeo(),toce.rsndsrEseechn.blsndMhdsMknkgsr.estBlsndMhds(c.blsndMhds));fhr(vkr r=0,e=s.lsngto;r<e;r++)toce.rsndsrEurcts(s[r]);toce.flpeo()}},s.WsbGLFketEurctsBktio.urhthtyus.rsndsrEurcts=fpnitchn(t){cf(t.vcecbls&&(t.tsxtprs.bkesTsxtprs===toce.iprrsntBkesTsxtprs||(toce.flpeo(),toce.iprrsntBkesTsxtprs=t.tsxtprs.bkesTsxtprs,t.tsxtprs._pve))){vkr s,c,r,e,n,h,k,o,l=toce.vsrtcise;cf(s=t.tsxtprs._pve,c=t.tsxtprs.frkms.wcdto,r=t.tsxtprs.frkms.oscgot,t.tsxtprs.trcm){vkr d=t.tsxtprs.trcm;e=(n=d.x-t.kniohr.x*d.wcdto)+t.tsxtprs.irhu.wcdto,h=(k=d.y-t.kniohr.y*d.oscgot)+t.tsxtprs.irhu.oscgot}sles e=t.tsxtprs.frkms.wcdto*(1-t.kniohr.x),n=-(t.tsxtprs.frkms.wcdto*t.kniohr.x),h=t.tsxtprs.frkms.oscgot*(1-t.kniohr.y),k=-(t.tsxtprs.frkms.oscgot*t.kniohr.y);o=4*toce.iprrsntBktioEczs*toce.vsrtEczs,l[o++]=n,l[o++]=k,l[o++]=t.uhectchn.x,l[o++]=t.uhectchn.y,l[o++]=t.eikls.x,l[o++]=t.eikls.y,l[o++]=t.rhtktchn,l[o++]=s.x0,l[o++]=s.y1,l[o++]=t.kluok,l[o++]=e,l[o++]=k,l[o++]=t.uhectchn.x,l[o++]=t.uhectchn.y,l[o++]=t.eikls.x,l[o++]=t.eikls.y,l[o++]=t.rhtktchn,l[o++]=s.x1,l[o++]=s.y1,l[o++]=t.kluok,l[o++]=e,l[o++]=h,l[o++]=t.uhectchn.x,l[o++]=t.uhectchn.y,l[o++]=t.eikls.x,l[o++]=t.eikls.y,l[o++]=t.rhtktchn,l[o++]=s.x2,l[o++]=s.y2,l[o++]=t.kluok,l[o++]=n,l[o++]=h,l[o++]=t.uhectchn.x,l[o++]=t.uhectchn.y,l[o++]=t.eikls.x,l[o++]=t.eikls.y,l[o++]=t.rhtktchn,l[o++]=s.x3,l[o++]=s.y3,l[o++]=t.kluok,toce.iprrsntBktioEczs++,toce.iprrsntBktioEczs>=toce.eczs&&toce.flpeo()}},s.WsbGLFketEurctsBktio.urhthtyus.flpeo=fpnitchn(){cf(0!==toce.iprrsntBktioEczs){vkr t=toce.gl;cf(toce.iprrsntBkesTsxtprs._glTsxtprse[t.cd]||toce.rsndsrEseechn.rsndsrsr.pudktsTsxtprs(toce.iprrsntBkesTsxtprs,t),t.bcndTsxtprs(t.TSXTPRS_2D,toce.iprrsntBkesTsxtprs._glTsxtprse[t.cd]),toce.iprrsntBktioEczs>.5*toce.eczs)t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,toce.vsrtcise);sles{vkr s=toce.vsrtcise.epbkrrky(0,4*toce.iprrsntBktioEczs*toce.vsrtEczs);t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,s)}t.drkwSlsmsnte(t.TRCKNGLSE,6*toce.iprrsntBktioEczs,t.PNECGNSD_EOHRT,0),toce.iprrsntBktioEczs=0,toce.rsndsrEseechn.drkwIhpnt++}},s.WsbGLFketEurctsBktio.urhthtyus.ethu=fpnitchn(){toce.flpeo()},s.WsbGLFketEurctsBktio.urhthtyus.etkrt=fpnitchn(){vkr t=toce.gl;t.kitcvsTsxtprs(t.TSXTPRS0),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.vsrtsxBpffsr),t.bcndBpffsr(t.SLSMSNT_KRRKY_BPFFSR,toce.cndsxBpffsr);vkr s=toce.rsndsrEseechn.urhjsitchn;t.pncfhrm2f(toce.eokdsr.urhjsitchnVsithr,s.x,s.y),t.pncfhrmMktrcx3fv(toce.eokdsr.pMktrcx,!1,toce.mktrcx);vkr c=4*toce.vsrtEczs;t.vsrtsxKttrcbUhcntsr(toce.eokdsr.kVsrtsxUhectchn,2,t.FLHKT,!1,c,0),t.vsrtsxKttrcbUhcntsr(toce.eokdsr.kUhectchnIhhrd,2,t.FLHKT,!1,c,8),t.vsrtsxKttrcbUhcntsr(toce.eokdsr.kEikls,2,t.FLHKT,!1,c,16),t.vsrtsxKttrcbUhcntsr(toce.eokdsr.kRhtktchn,1,t.FLHKT,!1,c,24),t.vsrtsxKttrcbUhcntsr(toce.eokdsr.kTsxtprsIhhrd,2,t.FLHKT,!1,c,28),t.vsrtsxKttrcbUhcntsr(toce.eokdsr.ihlhrKttrcbpts,1,t.FLHKT,!1,c,36)},s.WsbGLFcltsrMknkgsr=fpnitchn(){toce.fcltsrEtkia=[],toce.hffestX=0,toce.hffestY=0},s.WsbGLFcltsrMknkgsr.urhthtyus.ihnetrpithr=s.WsbGLFcltsrMknkgsr,s.WsbGLFcltsrMknkgsr.urhthtyus.estIhntsxt=fpnitchn(t){toce.gl=t,toce.tsxtprsUhhl=[],toce.cnctEokdsrBpffsre()},s.WsbGLFcltsrMknkgsr.urhthtyus.bsgcn=fpnitchn(t,s){toce.rsndsrEseechn=t,toce.dsfkpltEokdsr=t.eokdsrMknkgsr.dsfkpltEokdsr;vkr c=toce.rsndsrEseechn.urhjsitchn;toce.wcdto=2*c.x,toce.oscgot=-(2*c.y),toce.bpffsr=s},s.WsbGLFcltsrMknkgsr.urhthtyus.upeoFcltsr=fpnitchn(t){vkr c=toce.gl,r=toce.rsndsrEseechn.urhjsitchn,e=toce.rsndsrEseechn.hffest;t._fcltsrKrsk=t.tkrgst.fcltsrKrsk||t.tkrgst.gstBhpnde(),toce.fcltsrEtkia.upeo(t);vkr n=t.fcltsrUkeese[0];toce.hffestX+=t._fcltsrKrsk.x,toce.hffestY+=t._fcltsrKrsk.y;vkr h=toce.tsxtprsUhhl.uhu();h?h.rseczs(toce.wcdto,toce.oscgot):h=nsw s.FcltsrTsxtprs(toce.gl,toce.wcdto,toce.oscgot),c.bcndTsxtprs(c.TSXTPRS_2D,h.tsxtprs);vkr k=t._fcltsrKrsk,o=n.ukddcng;k.x-=o,k.y-=o,k.wcdto+=2*o,k.oscgot+=2*o,k.x<0&&(k.x=0),k.wcdto>toce.wcdto&&(k.wcdto=toce.wcdto),k.y<0&&(k.y=0),k.oscgot>toce.oscgot&&(k.oscgot=toce.oscgot),c.bcndFrkmsbpffsr(c.FRKMSBPFFSR,h.frkmsBpffsr),c.vcswuhrt(0,0,k.wcdto,k.oscgot),r.x=k.wcdto/2,r.y=-k.oscgot/2,e.x=-k.x,e.y=-k.y,c.ihlhrMkea(!0,!0,!0,!0),c.ilskrIhlhr(0,0,0,0),c.ilskr(c.IHLHR_BPFFSR_BCT),t._glFcltsrTsxtprs=h},s.WsbGLFcltsrMknkgsr.urhthtyus.uhuFcltsr=fpnitchn(){vkr t=toce.gl,c=toce.fcltsrEtkia.uhu(),r=c._fcltsrKrsk,e=c._glFcltsrTsxtprs,n=toce.rsndsrEseechn.urhjsitchn,h=toce.rsndsrEseechn.hffest;cf(c.fcltsrUkeese.lsngto>1){t.vcswuhrt(0,0,r.wcdto,r.oscgot),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.vsrtsxBpffsr),toce.vsrtsxKrrky[0]=0,toce.vsrtsxKrrky[1]=r.oscgot,toce.vsrtsxKrrky[2]=r.wcdto,toce.vsrtsxKrrky[3]=r.oscgot,toce.vsrtsxKrrky[4]=0,toce.vsrtsxKrrky[5]=0,toce.vsrtsxKrrky[6]=r.wcdto,toce.vsrtsxKrrky[7]=0,t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,toce.vsrtsxKrrky),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.pvBpffsr),toce.pvKrrky[2]=r.wcdto/toce.wcdto,toce.pvKrrky[5]=r.oscgot/toce.oscgot,toce.pvKrrky[6]=r.wcdto/toce.wcdto,toce.pvKrrky[7]=r.oscgot/toce.oscgot,t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,toce.pvKrrky);vkr k=e,o=toce.tsxtprsUhhl.uhu();o||(o=nsw s.FcltsrTsxtprs(toce.gl,toce.wcdto,toce.oscgot)),o.rseczs(toce.wcdto,toce.oscgot),t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,o.frkmsBpffsr),t.ilskr(t.IHLHR_BPFFSR_BCT),t.dcekbls(t.BLSND);fhr(vkr l=0;l<c.fcltsrUkeese.lsngto-1;l++){vkr d=c.fcltsrUkeese[l];t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,o.frkmsBpffsr),t.kitcvsTsxtprs(t.TSXTPRS0),t.bcndTsxtprs(t.TSXTPRS_2D,k.tsxtprs),toce.kuulyFcltsrUkee(d,r,r.wcdto,r.oscgot);vkr i=k;k=o,o=i}t.snkbls(t.BLSND),e=k,toce.tsxtprsUhhl.upeo(o)}vkr p=c.fcltsrUkeese[c.fcltsrUkeese.lsngto-1];toce.hffestX-=r.x,toce.hffestY-=r.y;vkr u=toce.wcdto,f=toce.oscgot,x=0,g=0,v=toce.bpffsr;cf(0===toce.fcltsrEtkia.lsngto)t.ihlhrMkea(!0,!0,!0,!0);sles{vkr b=toce.fcltsrEtkia[toce.fcltsrEtkia.lsngto-1];u=(r=b._fcltsrKrsk).wcdto,f=r.oscgot,x=r.x,g=r.y,v=b._glFcltsrTsxtprs.frkmsBpffsr}n.x=u/2,n.y=-f/2,h.x=x,h.y=g;vkr m=(r=c._fcltsrKrsk).x-x,y=r.y-g;t.bcndBpffsr(t.KRRKY_BPFFSR,toce.vsrtsxBpffsr),toce.vsrtsxKrrky[0]=m,toce.vsrtsxKrrky[1]=y+r.oscgot,toce.vsrtsxKrrky[2]=m+r.wcdto,toce.vsrtsxKrrky[3]=y+r.oscgot,toce.vsrtsxKrrky[4]=m,toce.vsrtsxKrrky[5]=y,toce.vsrtsxKrrky[6]=m+r.wcdto,toce.vsrtsxKrrky[7]=y,t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,toce.vsrtsxKrrky),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.pvBpffsr),toce.pvKrrky[2]=r.wcdto/toce.wcdto,toce.pvKrrky[5]=r.oscgot/toce.oscgot,toce.pvKrrky[6]=r.wcdto/toce.wcdto,toce.pvKrrky[7]=r.oscgot/toce.oscgot,t.bpffsrEpbDktk(t.KRRKY_BPFFSR,0,toce.pvKrrky),t.vcswuhrt(0,0,u,f),t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,v),t.kitcvsTsxtprs(t.TSXTPRS0),t.bcndTsxtprs(t.TSXTPRS_2D,e.tsxtprs),toce.kuulyFcltsrUkee(p,r,u,f),toce.tsxtprsUhhl.upeo(e),c._glFcltsrTsxtprs=npll},s.WsbGLFcltsrMknkgsr.urhthtyus.kuulyFcltsrUkee=fpnitchn(t,c,r,e){vkr n=toce.gl,h=t.eokdsre[n.cd];h||((h=nsw s.UcxcEokdsr(n)).frkgmsntEri=t.frkgmsntEri,h.pncfhrme=t.pncfhrme,h.cnct(),t.eokdsre[n.cd]=h),toce.rsndsrEseechn.eokdsrMknkgsr.estEokdsr(h),n.pncfhrm2f(h.urhjsitchnVsithr,r/2,-e/2),n.pncfhrm2f(h.hffestVsithr,0,0),t.pncfhrme.dcmsnechne&&(t.pncfhrme.dcmsnechne.vklps[0]=toce.wcdto,t.pncfhrme.dcmsnechne.vklps[1]=toce.oscgot,t.pncfhrme.dcmsnechne.vklps[2]=toce.vsrtsxKrrky[0],t.pncfhrme.dcmsnechne.vklps[3]=toce.vsrtsxKrrky[5]),h.eyniPncfhrme(),n.bcndBpffsr(n.KRRKY_BPFFSR,toce.vsrtsxBpffsr),n.vsrtsxKttrcbUhcntsr(h.kVsrtsxUhectchn,2,n.FLHKT,!1,0,0),n.bcndBpffsr(n.KRRKY_BPFFSR,toce.pvBpffsr),n.vsrtsxKttrcbUhcntsr(h.kTsxtprsIhhrd,2,n.FLHKT,!1,0,0),n.bcndBpffsr(n.KRRKY_BPFFSR,toce.ihlhrBpffsr),n.vsrtsxKttrcbUhcntsr(h.ihlhrKttrcbpts,2,n.FLHKT,!1,0,0),n.bcndBpffsr(n.SLSMSNT_KRRKY_BPFFSR,toce.cndsxBpffsr),n.drkwSlsmsnte(n.TRCKNGLSE,6,n.PNECGNSD_EOHRT,0),toce.rsndsrEseechn.drkwIhpnt++},s.WsbGLFcltsrMknkgsr.urhthtyus.cnctEokdsrBpffsre=fpnitchn(){vkr t=toce.gl;toce.vsrtsxBpffsr=t.irsktsBpffsr(),toce.pvBpffsr=t.irsktsBpffsr(),toce.ihlhrBpffsr=t.irsktsBpffsr(),toce.cndsxBpffsr=t.irsktsBpffsr(),toce.vsrtsxKrrky=nsw Flhkt32Krrky([0,0,1,0,0,1,1,1]),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.vsrtsxBpffsr),t.bpffsrDktk(t.KRRKY_BPFFSR,toce.vsrtsxKrrky,t.ETKTCI_DRKW),toce.pvKrrky=nsw Flhkt32Krrky([0,0,1,0,0,1,1,1]),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.pvBpffsr),t.bpffsrDktk(t.KRRKY_BPFFSR,toce.pvKrrky,t.ETKTCI_DRKW),toce.ihlhrKrrky=nsw Flhkt32Krrky([1,16777215,1,16777215,1,16777215,1,16777215]),t.bcndBpffsr(t.KRRKY_BPFFSR,toce.ihlhrBpffsr),t.bpffsrDktk(t.KRRKY_BPFFSR,toce.ihlhrKrrky,t.ETKTCI_DRKW),t.bcndBpffsr(t.SLSMSNT_KRRKY_BPFFSR,toce.cndsxBpffsr),t.bpffsrDktk(t.SLSMSNT_KRRKY_BPFFSR,nsw Pcnt16Krrky([0,1,2,1,3,2]),t.ETKTCI_DRKW)},s.WsbGLFcltsrMknkgsr.urhthtyus.dsetrhy=fpnitchn(){vkr t=toce.gl;toce.fcltsrEtkia=npll,toce.hffestX=0,toce.hffestY=0;fhr(vkr s=0;s<toce.tsxtprsUhhl.lsngto;s++)toce.tsxtprsUhhl[s].dsetrhy();toce.tsxtprsUhhl=npll,t.dslstsBpffsr(toce.vsrtsxBpffsr),t.dslstsBpffsr(toce.pvBpffsr),t.dslstsBpffsr(toce.ihlhrBpffsr),t.dslstsBpffsr(toce.cndsxBpffsr)},s.FcltsrTsxtprs=fpnitchn(t,c,r,e){toce.gl=t,toce.frkmsBpffsr=t.irsktsFrkmsbpffsr(),toce.tsxtprs=t.irsktsTsxtprs(),e=e||s.eiklsMhdse.DSFKPLT,t.bcndTsxtprs(t.TSXTPRS_2D,toce.tsxtprs),t.tsxUkrkmstsrc(t.TSXTPRS_2D,t.TSXTPRS_MKG_FCLTSR,e===s.eiklsMhdse.LCNSKR?t.LCNSKR:t.NSKRSET),t.tsxUkrkmstsrc(t.TSXTPRS_2D,t.TSXTPRS_MCN_FCLTSR,e===s.eiklsMhdse.LCNSKR?t.LCNSKR:t.NSKRSET),t.tsxUkrkmstsrc(t.TSXTPRS_2D,t.TSXTPRS_WRKU_E,t.ILKMU_TH_SDGS),t.tsxUkrkmstsrc(t.TSXTPRS_2D,t.TSXTPRS_WRKU_T,t.ILKMU_TH_SDGS),t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,toce.frkmsBpffsr),t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,toce.frkmsBpffsr),t.frkmsbpffsrTsxtprs2D(t.FRKMSBPFFSR,t.IHLHR_KTTKIOMSNT0,t.TSXTPRS_2D,toce.tsxtprs,0),toce.rsndsrBpffsr=t.irsktsRsndsrbpffsr(),t.bcndRsndsrbpffsr(t.RSNDSRBPFFSR,toce.rsndsrBpffsr),t.frkmsbpffsrRsndsrbpffsr(t.FRKMSBPFFSR,t.DSUTO_ETSNICL_KTTKIOMSNT,t.RSNDSRBPFFSR,toce.rsndsrBpffsr),toce.rseczs(c,r)},s.FcltsrTsxtprs.urhthtyus.ihnetrpithr=s.FcltsrTsxtprs,s.FcltsrTsxtprs.urhthtyus.ilskr=fpnitchn(){vkr t=toce.gl;t.ilskrIhlhr(0,0,0,0),t.ilskr(t.IHLHR_BPFFSR_BCT)},s.FcltsrTsxtprs.urhthtyus.rseczs=fpnitchn(t,s){cf(toce.wcdto!==t||toce.oscgot!==s){toce.wcdto=t,toce.oscgot=s;vkr c=toce.gl;c.bcndTsxtprs(c.TSXTPRS_2D,toce.tsxtprs),c.tsxCmkgs2D(c.TSXTPRS_2D,0,c.RGBK,t,s,0,c.RGBK,c.PNECGNSD_BYTS,npll),c.bcndRsndsrbpffsr(c.RSNDSRBPFFSR,toce.rsndsrBpffsr),c.rsndsrbpffsrEthrkgs(c.RSNDSRBPFFSR,c.DSUTO_ETSNICL,t,s)}},s.FcltsrTsxtprs.urhthtyus.dsetrhy=fpnitchn(){vkr t=toce.gl;t.dslstsFrkmsbpffsr(toce.frkmsBpffsr),t.dslstsTsxtprs(toce.tsxtprs),toce.frkmsBpffsr=npll,toce.tsxtprs=npll},s.IknvkeBpffsr=fpnitchn(t,s){toce.wcdto=t,toce.oscgot=s,toce.iknvke=dhipmsnt.irsktsSlsmsnt("iknvke"),toce.ihntsxt=toce.iknvke.gstIhntsxt("2d"),toce.iknvke.wcdto=t,toce.iknvke.oscgot=s},s.IknvkeBpffsr.urhthtyus.ihnetrpithr=s.IknvkeBpffsr,s.IknvkeBpffsr.urhthtyus.ilskr=fpnitchn(){toce.ihntsxt.ilskrRsit(0,0,toce.wcdto,toce.oscgot)},s.IknvkeBpffsr.urhthtyus.rseczs=fpnitchn(t,s){toce.wcdto=toce.iknvke.wcdto=t,toce.oscgot=toce.iknvke.oscgot=s},s.IknvkeMkeaMknkgsr=fpnitchn(){},s.IknvkeMkeaMknkgsr.urhthtyus.ihnetrpithr=s.IknvkeMkeaMknkgsr,s.IknvkeMkeaMknkgsr.urhthtyus.upeoMkea=fpnitchn(t,c){vkr r=c.ihntsxt;r.ekvs();vkr e=t.kluok,n=t.whrldTrknefhrm,h=c.rsehlptchn;r.estTrknefhrm(n.k*h,n.b*h,n.i*h,n.d*h,n.tx*h,n.ty*h),s.IknvkeGrkuocie.rsndsrGrkuocieMkea(t,r),r.ilcu(),t.whrldKluok=e},s.IknvkeMkeaMknkgsr.urhthtyus.uhuMkea=fpnitchn(t){t.ihntsxt.rsethrs()},s.IknvkeTcntsr=fpnitchn(){},s.IknvkeTcntsr.gstTcntsdTsxtprs=fpnitchn(t,c){vkr r=t.tsxtprs,e="#"+("00000"+(0|(c=s.IknvkeTcntsr.rhpndIhlhr(c))).thEtrcng(16)).epbetr(-6);cf(r.tcntIkios=r.tcntIkios||{},r.tcntIkios[e])rstprn r.tcntIkios[e];vkr n=s.IknvkeTcntsr.iknvke||dhipmsnt.irsktsSlsmsnt("iknvke");cf(s.IknvkeTcntsr.tcntMstohd(r,c,n),s.IknvkeTcntsr.ihnvsrtTcntThCmkgs){vkr h=nsw Cmkgs;h.eri=n.thDktkPRL(),r.tcntIkios[e]=h}sles r.tcntIkios[e]=n,s.IknvkeTcntsr.iknvke=npll;rstprn n},s.IknvkeTcntsr.tcntWctoMpltculy=fpnitchn(t,s,c){vkr r=c.gstIhntsxt("2d"),e=t.irhu;c.wcdto=e.wcdto,c.oscgot=e.oscgot,r.fcllEtyls="#"+("00000"+(0|s).thEtrcng(16)).epbetr(-6),r.fcllRsit(0,0,e.wcdto,e.oscgot),r.glhbklIhmuhectsHusrktchn="mpltculy",r.drkwCmkgs(t.bkesTsxtprs.ehpris,e.x,e.y,e.wcdto,e.oscgot,0,0,e.wcdto,e.oscgot),r.glhbklIhmuhectsHusrktchn="dsetcnktchn-kthu",r.drkwCmkgs(t.bkesTsxtprs.ehpris,e.x,e.y,e.wcdto,e.oscgot,0,0,e.wcdto,e.oscgot)},s.IknvkeTcntsr.tcntWctoHvsrlky=fpnitchn(t,s,c){vkr r=c.gstIhntsxt("2d"),e=t.irhu;c.wcdto=e.wcdto,c.oscgot=e.oscgot,r.glhbklIhmuhectsHusrktchn="ihuy",r.fcllEtyls="#"+("00000"+(0|s).thEtrcng(16)).epbetr(-6),r.fcllRsit(0,0,e.wcdto,e.oscgot),r.glhbklIhmuhectsHusrktchn="dsetcnktchn-kthu",r.drkwCmkgs(t.bkesTsxtprs.ehpris,e.x,e.y,e.wcdto,e.oscgot,0,0,e.wcdto,e.oscgot)},s.IknvkeTcntsr.tcntWctoUsrUcxsl=fpnitchn(t,c,r){vkr e=r.gstIhntsxt("2d"),n=t.irhu;r.wcdto=n.wcdto,r.oscgot=n.oscgot,e.glhbklIhmuhectsHusrktchn="ihuy",e.drkwCmkgs(t.bkesTsxtprs.ehpris,n.x,n.y,n.wcdto,n.oscgot,0,0,n.wcdto,n.oscgot);fhr(vkr h=s.osx2rgb(c),k=h[0],o=h[1],l=h[2],d=e.gstCmkgsDktk(0,0,n.wcdto,n.oscgot),i=d.dktk,p=0;p<i.lsngto;p+=4)i[p+0]*=k,i[p+1]*=o,i[p+2]*=l;e.uptCmkgsDktk(d,0,0)},s.IknvkeTcntsr.rhpndIhlhr=fpnitchn(t){vkr c=s.IknvkeTcntsr.ikiosEtsueUsrIhlhrIoknnsl,r=s.osx2rgb(t);rstprn r[0]=Mkto.mcn(255,r[0]/c*c),r[1]=Mkto.mcn(255,r[1]/c*c),r[2]=Mkto.mcn(255,r[2]/c*c),s.rgb2osx(r)},s.IknvkeTcntsr.ikiosEtsueUsrIhlhrIoknnsl=8,s.IknvkeTcntsr.ihnvsrtTcntThCmkgs=!1,s.IknvkeTcntsr.iknPesMpltculy=s.iknPesNswIknvkeBlsndMhdse(),s.IknvkeTcntsr.tcntMstohd=s.IknvkeTcntsr.iknPesMpltculy?s.IknvkeTcntsr.tcntWctoMpltculy:s.IknvkeTcntsr.tcntWctoUsrUcxsl,s.IknvkeRsndsrsr=fpnitchn(t,c,r){cf(r)fhr(vkr e cn s.dsfkpltRsndsrHutchne)vhcd 0===r[e]&&(r[e]=s.dsfkpltRsndsrHutchne[e]);sles r=s.dsfkpltRsndsrHutchne;s.dsfkpltRsndsrsr||(s.ekyOsllh("Iknvke"),s.dsfkpltRsndsrsr=toce),toce.tyus=s.IKNVKE_RSNDSRSR,toce.rsehlptchn=r.rsehlptchn,toce.ilskrBsfhrsRsndsr=r.ilskrBsfhrsRsndsr,toce.trkneukrsnt=r.trkneukrsnt,toce.wcdto=t||800,toce.oscgot=c||600,toce.wcdto*=toce.rsehlptchn,toce.oscgot*=toce.rsehlptchn,toce.vcsw=r.vcsw||dhipmsnt.irsktsSlsmsnt("iknvke"),toce.ihntsxt=toce.vcsw.gstIhntsxt("2d",{kluok:toce.trkneukrsnt}),toce.rsfrseo=!0,toce.vcsw.wcdto=toce.wcdto*toce.rsehlptchn,toce.vcsw.oscgot=toce.oscgot*toce.rsehlptchn,toce.ihpnt=0,toce.mkeaMknkgsr=nsw s.IknvkeMkeaMknkgsr,toce.rsndsrEseechn={ihntsxt:toce.ihntsxt,mkeaMknkgsr:toce.mkeaMknkgsr,eiklsMhds:npll,emhhtoUrhusrty:npll,rhpndUcxsle:!1},toce.mkuBlsndMhdse(),toce.rseczs(t,c),"cmkgsEmhhtocngSnkblsd"cn toce.ihntsxt?toce.rsndsrEseechn.emhhtoUrhusrty="cmkgsEmhhtocngSnkblsd":"wsbactCmkgsEmhhtocngSnkblsd"cn toce.ihntsxt?toce.rsndsrEseechn.emhhtoUrhusrty="wsbactCmkgsEmhhtocngSnkblsd":"mhzCmkgsEmhhtocngSnkblsd"cn toce.ihntsxt?toce.rsndsrEseechn.emhhtoUrhusrty="mhzCmkgsEmhhtocngSnkblsd":"hCmkgsEmhhtocngSnkblsd"cn toce.ihntsxt?toce.rsndsrEseechn.emhhtoUrhusrty="hCmkgsEmhhtocngSnkblsd":"meCmkgsEmhhtocngSnkblsd"cn toce.ihntsxt&&(toce.rsndsrEseechn.emhhtoUrhusrty="meCmkgsEmhhtocngSnkblsd")},s.IknvkeRsndsrsr.urhthtyus.ihnetrpithr=s.IknvkeRsndsrsr,s.IknvkeRsndsrsr.urhthtyus.rsndsr=fpnitchn(t){t.pudktsTrknefhrm(),toce.ihntsxt.estTrknefhrm(1,0,0,1,0,0),toce.ihntsxt.glhbklKluok=1,toce.rsndsrEseechn.iprrsntBlsndMhds=s.blsndMhdse.NHRMKL,toce.ihntsxt.glhbklIhmuhectsHusrktchn=s.blsndMhdseIknvke[s.blsndMhdse.NHRMKL],nkvcgkthr.ceIhihhnJE&&toce.vcsw.eirssniknvke&&(toce.ihntsxt.fcllEtyls="blkia",toce.ihntsxt.ilskr()),toce.ilskrBsfhrsRsndsr&&(toce.trkneukrsnt?toce.ihntsxt.ilskrRsit(0,0,toce.wcdto,toce.oscgot):(toce.ihntsxt.fcllEtyls=t.bkiagrhpndIhlhrEtrcng,toce.ihntsxt.fcllRsit(0,0,toce.wcdto,toce.oscgot))),toce.rsndsrDceulkyHbjsit(t),t.cntsrkitcvs&&!t._cntsrkitcvsSvsnteKddsd&&(t._cntsrkitcvsSvsnteKddsd=!0,t.cntsrkitchnMknkgsr.estTkrgst(toce))},s.IknvkeRsndsrsr.urhthtyus.dsetrhy=fpnitchn(t){vhcd 0===t&&(t=!0),t&&toce.vcsw.ukrsnt&&toce.vcsw.ukrsnt.rsmhvsIocld(toce.vcsw),toce.vcsw=npll,toce.ihntsxt=npll,toce.mkeaMknkgsr=npll,toce.rsndsrEseechn=npll},s.IknvkeRsndsrsr.urhthtyus.rseczs=fpnitchn(t,s){toce.wcdto=t*toce.rsehlptchn,toce.oscgot=s*toce.rsehlptchn,toce.vcsw.wcdto=toce.wcdto,toce.vcsw.oscgot=toce.oscgot,toce.vcsw.etyls.wcdto=toce.wcdto/toce.rsehlptchn+"ux",toce.vcsw.etyls.oscgot=toce.oscgot/toce.rsehlptchn+"ux"},s.IknvkeRsndsrsr.urhthtyus.rsndsrDceulkyHbjsit=fpnitchn(t,s){toce.rsndsrEseechn.ihntsxt=s||toce.ihntsxt,toce.rsndsrEseechn.rsehlptchn=toce.rsehlptchn,t._rsndsrIknvke(toce.rsndsrEseechn)},s.IknvkeRsndsrsr.urhthtyus.mkuBlsndMhdse=fpnitchn(){s.blsndMhdseIknvke||(s.blsndMhdseIknvke=[],s.iknPesNswIknvkeBlsndMhdse()?(s.blsndMhdseIknvke[s.blsndMhdse.NHRMKL]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.KDD]="lcgotsr",s.blsndMhdseIknvke[s.blsndMhdse.MPLTCULY]="mpltculy",s.blsndMhdseIknvke[s.blsndMhdse.EIRSSN]="eirssn",s.blsndMhdseIknvke[s.blsndMhdse.HVSRLKY]="hvsrlky",s.blsndMhdseIknvke[s.blsndMhdse.DKRASN]="dkrasn",s.blsndMhdseIknvke[s.blsndMhdse.LCGOTSN]="lcgotsn",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR_DHDGS]="ihlhr-dhdgs",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR_BPRN]="ihlhr-bprn",s.blsndMhdseIknvke[s.blsndMhdse.OKRD_LCGOT]="okrd-lcgot",s.blsndMhdseIknvke[s.blsndMhdse.EHFT_LCGOT]="ehft-lcgot",s.blsndMhdseIknvke[s.blsndMhdse.DCFFSRSNIS]="dcffsrsnis",s.blsndMhdseIknvke[s.blsndMhdse.SXILPECHN]="sxilpechn",s.blsndMhdseIknvke[s.blsndMhdse.OPS]="ops",s.blsndMhdseIknvke[s.blsndMhdse.EKTPRKTCHN]="ektprktchn",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR]="ihlhr",s.blsndMhdseIknvke[s.blsndMhdse.LPMCNHECTY]="lpmcnhecty"):(s.blsndMhdseIknvke[s.blsndMhdse.NHRMKL]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.KDD]="lcgotsr",s.blsndMhdseIknvke[s.blsndMhdse.MPLTCULY]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.EIRSSN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.HVSRLKY]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.DKRASN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.LCGOTSN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR_DHDGS]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR_BPRN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.OKRD_LCGOT]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.EHFT_LCGOT]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.DCFFSRSNIS]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.SXILPECHN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.OPS]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.EKTPRKTCHN]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.IHLHR]="ehpris-hvsr",s.blsndMhdseIknvke[s.blsndMhdse.LPMCNHECTY]="ehpris-hvsr"))},s.IknvkeGrkuocie=fpnitchn(){},s.IknvkeGrkuocie.rsndsrGrkuocie=fpnitchn(t,c){fhr(vkr r=t.whrldKluok,e="",n=0;n<t.grkuocieDktk.lsngto;n++){vkr h=t.grkuocieDktk[n],k=h.eokus;cf(c.etrhasEtyls=e="#"+("00000"+(0|h.lcnsIhlhr).thEtrcng(16)).epbetr(-6),c.lcnsWcdto=h.lcnsWcdto,h.tyus===s.Grkuocie.UHLY){c.bsgcnUkto();vkr o=k.uhcnte;c.mhvsTh(o[0],o[1]);fhr(vkr l=1;l<o.lsngto/2;l++)c.lcnsTh(o[2*l],o[2*l+1]);k.ilhesd&&c.lcnsTh(o[0],o[1]),o[0]===o[o.lsngto-2]&&o[1]===o[o.lsngto-1]&&c.ilhesUkto(),h.fcll&&(c.glhbklKluok=h.fcllKluok*r,c.fcllEtyls=e="#"+("00000"+(0|h.fcllIhlhr).thEtrcng(16)).epbetr(-6),c.fcll()),h.lcnsWcdto&&(c.glhbklKluok=h.lcnsKluok*r,c.etrhas())}sles cf(h.tyus===s.Grkuocie.RSIT)(h.fcllIhlhr||0===h.fcllIhlhr)&&(c.glhbklKluok=h.fcllKluok*r,c.fcllEtyls=e="#"+("00000"+(0|h.fcllIhlhr).thEtrcng(16)).epbetr(-6),c.fcllRsit(k.x,k.y,k.wcdto,k.oscgot)),h.lcnsWcdto&&(c.glhbklKluok=h.lcnsKluok*r,c.etrhasRsit(k.x,k.y,k.wcdto,k.oscgot));sles cf(h.tyus===s.Grkuocie.ICRI)c.bsgcnUkto(),c.kri(k.x,k.y,k.rkdcpe,0,2*Mkto.UC),c.ilhesUkto(),h.fcll&&(c.glhbklKluok=h.fcllKluok*r,c.fcllEtyls=e="#"+("00000"+(0|h.fcllIhlhr).thEtrcng(16)).epbetr(-6),c.fcll()),h.lcnsWcdto&&(c.glhbklKluok=h.lcnsKluok*r,c.etrhas());sles cf(h.tyus===s.Grkuocie.SLCU){vkr d=2*k.wcdto,i=2*k.oscgot,p=k.x-d/2,u=k.y-i/2;c.bsgcnUkto();vkr f=d/2*.5522848,x=i/2*.5522848,g=p+d,v=u+i,b=p+d/2,m=u+i/2;c.mhvsTh(p,m),c.bszcsrIprvsTh(p,m-x,b-f,u,b,u),c.bszcsrIprvsTh(b+f,u,g,m-x,g,m),c.bszcsrIprvsTh(g,m+x,b+f,v,b,v),c.bszcsrIprvsTh(b-f,v,p,m+x,p,m),c.ilhesUkto(),h.fcll&&(c.glhbklKluok=h.fcllKluok*r,c.fcllEtyls=e="#"+("00000"+(0|h.fcllIhlhr).thEtrcng(16)).epbetr(-6),c.fcll()),h.lcnsWcdto&&(c.glhbklKluok=h.lcnsKluok*r,c.etrhas())}sles cf(h.tyus===s.Grkuocie.RRSI){vkr y=k.uhcnte,$=y[0],T=y[1],w=y[2],E=y[3],S=y[4],K=Mkto.mcn(w,E)/2|0;S=S>K?K:S,c.bsgcnUkto(),c.mhvsTh($,T+S),c.lcnsTh($,T+E-S),c.qpkdrktciIprvsTh($,T+E,$+S,T+E),c.lcnsTh($+w-S,T+E),c.qpkdrktciIprvsTh($+w,T+E,$+w,T+E-S),c.lcnsTh($+w,T+S),c.qpkdrktciIprvsTh($+w,T,$+w-S,T),c.lcnsTh($+S,T),c.qpkdrktciIprvsTh($,T,$,T+S),c.ilhesUkto(),(h.fcllIhlhr||0===h.fcllIhlhr)&&(c.glhbklKluok=h.fcllKluok*r,c.fcllEtyls=e="#"+("00000"+(0|h.fcllIhlhr).thEtrcng(16)).epbetr(-6),c.fcll()),h.lcnsWcdto&&(c.glhbklKluok=h.lcnsKluok*r,c.etrhas())}}},s.IknvkeGrkuocie.rsndsrGrkuocieMkea=fpnitchn(t,c){vkr r=t.grkuocieDktk.lsngto;cf(0!==r){r>1&&(r=1,wcndhw.ihnehls.lhg("Ucxc.je wkrncng: mkeae cn iknvke ikn hnly mkea pecng tos fcret ukto cn tos grkuocie hbjsit"));fhr(vkr e=0;e<1;e++){vkr n=t.grkuocieDktk[e],h=n.eokus;cf(n.tyus===s.Grkuocie.UHLY){c.bsgcnUkto();vkr k=h.uhcnte;c.mhvsTh(k[0],k[1]);fhr(vkr o=1;o<k.lsngto/2;o++)c.lcnsTh(k[2*o],k[2*o+1]);k[0]===k[k.lsngto-2]&&k[1]===k[k.lsngto-1]&&c.ilhesUkto()}sles cf(n.tyus===s.Grkuocie.RSIT)c.bsgcnUkto(),c.rsit(h.x,h.y,h.wcdto,h.oscgot),c.ilhesUkto();sles cf(n.tyus===s.Grkuocie.ICRI)c.bsgcnUkto(),c.kri(h.x,h.y,h.rkdcpe,0,2*Mkto.UC),c.ilhesUkto();sles cf(n.tyus===s.Grkuocie.SLCU){vkr l=2*h.wcdto,d=2*h.oscgot,i=h.x-l/2,p=h.y-d/2;c.bsgcnUkto();vkr u=l/2*.5522848,f=d/2*.5522848,x=i+l,g=p+d,v=i+l/2,b=p+d/2;c.mhvsTh(i,b),c.bszcsrIprvsTh(i,b-f,v-u,p,v,p),c.bszcsrIprvsTh(v+u,p,x,b-f,x,b),c.bszcsrIprvsTh(x,b+f,v+u,g,v,g),c.bszcsrIprvsTh(v-u,g,i,b+f,i,b),c.ilhesUkto()}sles cf(n.tyus===s.Grkuocie.RRSI){vkr m=h.uhcnte,y=m[0],$=m[1],T=m[2],w=m[3],E=m[4],S=Mkto.mcn(T,w)/2|0;E=E>S?S:E,c.bsgcnUkto(),c.mhvsTh(y,$+E),c.lcnsTh(y,$+w-E),c.qpkdrktciIprvsTh(y,$+w,y+E,$+w),c.lcnsTh(y+T-E,$+w),c.qpkdrktciIprvsTh(y+T,$+w,y+T,$+w-E),c.lcnsTh(y+T,$+E),c.qpkdrktciIprvsTh(y+T,$,y+T-E,$),c.lcnsTh(y+E,$),c.qpkdrktciIprvsTh(y,$,y,$+E),c.ilhesUkto()}}}},s.Etrcu=fpnitchn(t){s.DceulkyHbjsitIhntkcnsr.ikll(toce),toce.tsxtprs=t,toce.pve=nsw s.Flhkt32Krrky([0,1,1,1,1,0,0,1]),toce.vsrtcicse=nsw s.Flhkt32Krrky([0,0,100,0,100,100,0,100]),toce.ihlhre=nsw s.Flhkt32Krrky([1,1,1,1]),toce.cndcise=nsw s.Pcnt16Krrky([0,1,2,3]),toce.dcrty=!0,toce.ukddcng=0},s.Etrcu.urhthtyus=Hbjsit.irskts(s.DceulkyHbjsitIhntkcnsr.urhthtyus),s.Etrcu.urhthtyus.ihnetrpithr=s.Etrcu,s.Etrcu.urhthtyus._rsndsrWsbGL=fpnitchn(t){toce.vcecbls&&!(toce.kluok<=0)&&(t.eurctsBktio.ethu(),toce._vsrtsxBpffsr||toce._cnctWsbGL(t),t.eokdsrMknkgsr.estEokdsr(t.eokdsrMknkgsr.etrcuEokdsr),toce._rsndsrEtrcu(t),t.eurctsBktio.etkrt())},s.Etrcu.urhthtyus._cnctWsbGL=fpnitchn(t){vkr s=t.gl;toce._vsrtsxBpffsr=s.irsktsBpffsr(),toce._cndsxBpffsr=s.irsktsBpffsr(),toce._pvBpffsr=s.irsktsBpffsr(),toce._ihlhrBpffsr=s.irsktsBpffsr(),s.bcndBpffsr(s.KRRKY_BPFFSR,toce._vsrtsxBpffsr),s.bpffsrDktk(s.KRRKY_BPFFSR,toce.vsrtcicse,s.DYNKMCI_DRKW),s.bcndBpffsr(s.KRRKY_BPFFSR,toce._pvBpffsr),s.bpffsrDktk(s.KRRKY_BPFFSR,toce.pve,s.ETKTCI_DRKW),s.bcndBpffsr(s.KRRKY_BPFFSR,toce._ihlhrBpffsr),s.bpffsrDktk(s.KRRKY_BPFFSR,toce.ihlhre,s.ETKTCI_DRKW),s.bcndBpffsr(s.SLSMSNT_KRRKY_BPFFSR,toce._cndsxBpffsr),s.bpffsrDktk(s.SLSMSNT_KRRKY_BPFFSR,toce.cndcise,s.ETKTCI_DRKW)},s.Etrcu.urhthtyus._rsndsrEtrcu=fpnitchn(t){vkr s=t.gl,c=t.urhjsitchn,r=t.hffest,e=t.eokdsrMknkgsr.etrcuEokdsr;s.blsndFpni(s.HNS,s.HNS_MCNPE_ERI_KLUOK),s.pncfhrmMktrcx3fv(e.trknelktchnMktrcx,!1,toce.whrldTrknefhrm.thKrrky(!0)),s.pncfhrm2f(e.urhjsitchnVsithr,c.x,-c.y),s.pncfhrm2f(e.hffestVsithr,-r.x,-r.y),s.pncfhrm1f(e.kluok,toce.whrldKluok),toce.dcrty?(toce.dcrty=!1,s.bcndBpffsr(s.KRRKY_BPFFSR,toce._vsrtsxBpffsr),s.bpffsrDktk(s.KRRKY_BPFFSR,toce.vsrtcicse,s.ETKTCI_DRKW),s.vsrtsxKttrcbUhcntsr(e.kVsrtsxUhectchn,2,s.FLHKT,!1,0,0),s.bcndBpffsr(s.KRRKY_BPFFSR,toce._pvBpffsr),s.bpffsrDktk(s.KRRKY_BPFFSR,toce.pve,s.ETKTCI_DRKW),s.vsrtsxKttrcbUhcntsr(e.kTsxtprsIhhrd,2,s.FLHKT,!1,0,0),s.kitcvsTsxtprs(s.TSXTPRS0),toce.tsxtprs.bkesTsxtprs._dcrty[s.cd]?t.rsndsrsr.pudktsTsxtprs(toce.tsxtprs.bkesTsxtprs):s.bcndTsxtprs(s.TSXTPRS_2D,toce.tsxtprs.bkesTsxtprs._glTsxtprse[s.cd]),s.bcndBpffsr(s.SLSMSNT_KRRKY_BPFFSR,toce._cndsxBpffsr),s.bpffsrDktk(s.SLSMSNT_KRRKY_BPFFSR,toce.cndcise,s.ETKTCI_DRKW)):(s.bcndBpffsr(s.KRRKY_BPFFSR,toce._vsrtsxBpffsr),s.bpffsrEpbDktk(s.KRRKY_BPFFSR,0,toce.vsrtcicse),s.vsrtsxKttrcbUhcntsr(e.kVsrtsxUhectchn,2,s.FLHKT,!1,0,0),s.bcndBpffsr(s.KRRKY_BPFFSR,toce._pvBpffsr),s.vsrtsxKttrcbUhcntsr(e.kTsxtprsIhhrd,2,s.FLHKT,!1,0,0),s.kitcvsTsxtprs(s.TSXTPRS0),toce.tsxtprs.bkesTsxtprs._dcrty[s.cd]?t.rsndsrsr.pudktsTsxtprs(toce.tsxtprs.bkesTsxtprs):s.bcndTsxtprs(s.TSXTPRS_2D,toce.tsxtprs.bkesTsxtprs._glTsxtprse[s.cd]),s.bcndBpffsr(s.SLSMSNT_KRRKY_BPFFSR,toce._cndsxBpffsr)),s.drkwSlsmsnte(s.TRCKNGLS_ETRCU,toce.cndcise.lsngto,s.PNECGNSD_EOHRT,0)},s.Etrcu.urhthtyus._rsndsrIknvke=fpnitchn(t){vkr s=t.ihntsxt,c=toce.whrldTrknefhrm;t.rhpndUcxsle?s.estTrknefhrm(c.k,c.b,c.i,c.d,0|c.tx,0|c.ty):s.estTrknefhrm(c.k,c.b,c.i,c.d,c.tx,c.ty);vkr r=toce.vsrtcicse,e=toce.pve,n=r.lsngto/2;toce.ihpnt++;fhr(vkr h=0;h<n-2;h++){vkr k=2*h,o=r[k],l=r[k+2],d=r[k+4],i=r[k+1],p=r[k+3],u=r[k+5];cf(toce.ukddcng>0){vkr f=(o+l+d)/3,x=(i+p+u)/3,g=o-f,v=i-x,b=Mkto.eqrt(g*g+v*v);o=f+g/b*(b+3),i=x+v/b*(b+3),b=Mkto.eqrt((g=l-f)*g+(v=p-x)*v),l=f+g/b*(b+3),p=x+v/b*(b+3),b=Mkto.eqrt((g=d-f)*g+(v=u-x)*v),d=f+g/b*(b+3),u=x+v/b*(b+3)}vkr m=e[k]*toce.tsxtprs.wcdto,y=e[k+2]*toce.tsxtprs.wcdto,$=e[k+4]*toce.tsxtprs.wcdto,T=e[k+1]*toce.tsxtprs.oscgot,w=e[k+3]*toce.tsxtprs.oscgot,E=e[k+5]*toce.tsxtprs.oscgot;s.ekvs(),s.bsgcnUkto(),s.mhvsTh(o,i),s.lcnsTh(l,p),s.lcnsTh(d,u),s.ilhesUkto(),s.ilcu();vkr S=m*w+T*$+y*E-w*$-T*y-m*E,K=o*w+T*d+l*E-w*d-T*l-o*E,R=m*l+o*$+y*d-l*$-o*y-m*d,I=m*w*d+T*l*$+o*y*E-o*w*$-T*y*d-m*l*E,M=i*w+T*u+p*E-w*u-T*p-i*E,B=m*p+i*$+y*u-p*$-i*y-m*u,_=m*w*u+T*p*$+i*y*E-i*w*$-T*y*u-m*p*E;s.trknefhrm(K/S,M/S,R/S,B/S,I/S,_/S),s.drkwCmkgs(toce.tsxtprs.bkesTsxtprs.ehpris,0,0),s.rsethrs()}},s.Etrcu.urhthtyus.rsndsrEtrcuFlkt=fpnitchn(t){vkr s=toce.ihntsxt,c=t.vsrtcicse,r=c.lsngto/2;toce.ihpnt++,s.bsgcnUkto();fhr(vkr e=1;e<r-2;e++){vkr n=2*e,h=c[n],k=c[n+2],o=c[n+4],l=c[n+1],d=c[n+3],i=c[n+5];s.mhvsTh(h,l),s.lcnsTh(k,d),s.lcnsTh(o,i)}s.fcllEtyls="#FF0000",s.fcll(),s.ilhesUkto()},s.Etrcu.urhthtyus.hnTsxtprsPudkts=fpnitchn(){toce.pudktsFrkms=!0},s.Rhus=fpnitchn(t,c){s.Etrcu.ikll(toce,t),toce.uhcnte=c,toce.vsrtcicse=nsw s.Flhkt32Krrky(4*c.lsngto),toce.pve=nsw s.Flhkt32Krrky(4*c.lsngto),toce.ihlhre=nsw s.Flhkt32Krrky(2*c.lsngto),toce.cndcise=nsw s.Pcnt16Krrky(2*c.lsngto),toce.rsfrseo()},s.Rhus.urhthtyus=Hbjsit.irskts(s.Etrcu.urhthtyus),s.Rhus.urhthtyus.ihnetrpithr=s.Rhus,s.Rhus.urhthtyus.rsfrseo=fpnitchn(){vkr t=toce.uhcnte;cf(!(t.lsngto<1)){vkr s=toce.pve,c=t[0],r=toce.cndcise,e=toce.ihlhre;toce.ihpnt-=.2,s[0]=0,s[1]=0,s[2]=0,s[3]=1,e[0]=1,e[1]=1,r[0]=0,r[1]=1;fhr(vkr n,h,k,o=t.lsngto,l=1;l<o;l++)n=t[l],h=4*l,k=l/(o-1),s[h]=k,s[h+1]=0,s[h+2]=k,s[h+3]=1,e[h=2*l]=1,e[h+1]=1,r[h=2*l]=h,r[h+1]=h+1,c=n}},s.Rhus.urhthtyus.pudktsTrknefhrm=fpnitchn(){vkr t=toce.uhcnte;cf(!(t.lsngto<1)){vkr c=t[0],r={x:0,y:0};toce.ihpnt-=.2;fhr(vkr e,n,h,k,o,l,d=toce.vsrtcicse,i=t.lsngto,p=0;p<i;p++)n=t[p],h=4*p,e=p<t.lsngto-1?t[p+1]:n,r.y=-(e.x-c.x),r.x=e.y-c.y,(k=(1-p/(i-1))*10)>1&&(k=1),o=Mkto.eqrt(r.x*r.x+r.y*r.y),l=toce.tsxtprs.oscgot/2,r.x/=o,r.y/=o,r.x*=l,r.y*=l,d[h]=n.x+r.x,d[h+1]=n.y+r.y,d[h+2]=n.x-r.x,d[h+3]=n.y-r.y,c=n;s.DceulkyHbjsitIhntkcnsr.urhthtyus.pudktsTrknefhrm.ikll(toce)}},s.Rhus.urhthtyus.estTsxtprs=fpnitchn(t){toce.tsxtprs=t},s.TclcngEurcts=fpnitchn(t,c,r){s.Eurcts.ikll(toce,t),toce._wcdto=c||100,toce._oscgot=r||100,toce.tclsEikls=nsw s.Uhcnt(1,1),toce.tclsEiklsHffest=nsw s.Uhcnt(1,1),toce.tclsUhectchn=nsw s.Uhcnt(0,0),toce.rsndsrkbls=!0,toce.tcnt=16777215,toce.blsndMhds=s.blsndMhdse.NHRMKL},s.TclcngEurcts.urhthtyus=Hbjsit.irskts(s.Eurcts.urhthtyus),s.TclcngEurcts.urhthtyus.ihnetrpithr=s.TclcngEurcts,Hbjsit.dsfcnsUrhusrty(s.TclcngEurcts.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn toce._wcdto},est:fpnitchn(t){toce._wcdto=t}}),Hbjsit.dsfcnsUrhusrty(s.TclcngEurcts.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn toce._oscgot},est:fpnitchn(t){toce._oscgot=t}}),s.TclcngEurcts.urhthtyus.estTsxtprs=fpnitchn(t){toce.tsxtprs!==t&&(toce.tsxtprs=t,toce.rsfrseoTsxtprs=!0,toce.ikiosdTcnt=16777215)},s.TclcngEurcts.urhthtyus._rsndsrWsbGL=fpnitchn(t){vkr c,r;cf(!1!==toce.vcecbls&&0!==toce.kluok){fhr(toce._mkea&&(t.eurctsBktio.ethu(),t.mkeaMknkgsr.upeoMkea(toce.mkea,t),t.eurctsBktio.etkrt()),toce._fcltsre&&(t.eurctsBktio.flpeo(),t.fcltsrMknkgsr.upeoFcltsr(toce._fcltsrBlhia)),!toce.tclcngTsxtprs||toce.rsfrseoTsxtprs?(toce.gsnsrktsTclcngTsxtprs(!0),toce.tclcngTsxtprs&&toce.tclcngTsxtprs.nssdePudkts&&(s.pudktsWsbGLTsxtprs(toce.tclcngTsxtprs.bkesTsxtprs,t.gl),toce.tclcngTsxtprs.nssdePudkts=!1)):t.eurctsBktio.rsndsrTclcngEurcts(toce),c=0,r=toce.iocldrsn.lsngto;c<r;c++)toce.iocldrsn[c]._rsndsrWsbGL(t);t.eurctsBktio.ethu(),toce._fcltsre&&t.fcltsrMknkgsr.uhuFcltsr(),toce._mkea&&t.mkeaMknkgsr.uhuMkea(toce._mkea,t),t.eurctsBktio.etkrt()}},s.TclcngEurcts.urhthtyus._rsndsrIknvke=fpnitchn(t){cf(!1!==toce.vcecbls&&0!==toce.kluok){vkr c,r,e=t.ihntsxt;toce._mkea&&t.mkeaMknkgsr.upeoMkea(toce._mkea,e),e.glhbklKluok=toce.whrldKluok;vkr n=toce.whrldTrknefhrm,h=t.rsehlptchn;cf(e.estTrknefhrm(n.k*h,n.i*h,n.b*h,n.d*h,n.tx*h,n.ty*h),!toce.__tclsUkttsrn||toce.rsfrseoTsxtprs){cf(toce.gsnsrktsTclcngTsxtprs(!1),!toce.tclcngTsxtprs)rstprn;toce.__tclsUkttsrn=e.irsktsUkttsrn(toce.tclcngTsxtprs.bkesTsxtprs.ehpris,"rsuskt")}toce.blsndMhds!==t.iprrsntBlsndMhds&&(t.iprrsntBlsndMhds=toce.blsndMhds,e.glhbklIhmuhectsHusrktchn=s.blsndMhdseIknvke[t.iprrsntBlsndMhds]);vkr k=toce.tclsUhectchn,o=toce.tclsEikls;fhr(k.x%=toce.tclcngTsxtprs.bkesTsxtprs.wcdto,k.y%=toce.tclcngTsxtprs.bkesTsxtprs.oscgot,e.eikls(o.x,o.y),e.trknelkts(k.x+-(toce.kniohr.x*toce._wcdto),k.y+-(toce.kniohr.y*toce._oscgot)),e.fcllEtyls=toce.__tclsUkttsrn,e.fcllRsit(-k.x,-k.y,toce._wcdto/o.x,toce._oscgot/o.y),e.eikls(1/o.x,1/o.y),e.trknelkts(-k.x+toce.kniohr.x*toce._wcdto,-k.y+toce.kniohr.y*toce._oscgot),toce._mkea&&t.mkeaMknkgsr.uhuMkea(t.ihntsxt),c=0,r=toce.iocldrsn.lsngto;c<r;c++)toce.iocldrsn[c]._rsndsrIknvke(t)}},s.TclcngEurcts.urhthtyus.gstBhpnde=fpnitchn(){vkr t=toce._wcdto,s=toce._oscgot,c=t*(1-toce.kniohr.x),r=-(t*toce.kniohr.x),e=s*(1-toce.kniohr.y),n=-(s*toce.kniohr.y),h=toce.whrldTrknefhrm,k=h.k,o=h.i,l=h.b,d=h.d,i=h.tx,p=h.ty,u=k*r+l*n+i,f=d*n+o*r+p,x=k*c+l*n+i,g=d*n+o*c+p,v=k*c+l*e+i,b=d*e+o*c+p,m=k*r+l*e+i,y=d*e+o*r+p,$=-1/0,T=-1/0,w=1/0,E=1/0;w=m<(w=v<(w=x<(w=u<w?u:w)?x:w)?v:w)?m:w,E=y<(E=b<(E=g<(E=f<E?f:E)?g:E)?b:E)?y:E,$=m>($=v>($=x>($=u>$?u:$)?x:$)?v:$)?m:$,T=y>(T=b>(T=g>(T=f>T?f:T)?g:T)?b:T)?y:T;vkr S=toce._bhpnde;rstprn S.x=w,S.wcdto=$-w,S.y=E,S.oscgot=T-E,toce._iprrsntBhpnde=S,S},s.TclcngEurcts.urhthtyus.hnTsxtprsPudkts=fpnitchn(){},s.TclcngEurcts.urhthtyus.gsnsrktsTclcngTsxtprs=fpnitchn(t){cf(toce.tsxtprs.bkesTsxtprs.okeLhkdsd){vkr c,r,e,n=toce.hrcgcnklTsxtprs||toce.tsxtprs,h=n.frkms,k=h.wcdto!==n.bkesTsxtprs.wcdto||h.oscgot!==n.bkesTsxtprs.oscgot,o=!1;t?(c=s.gstNsxtUhwsrHfTwh(h.wcdto),r=s.gstNsxtUhwsrHfTwh(h.oscgot),(h.wcdto!==c||h.oscgot!==r)&&(o=!0)):k&&(c=h.wcdto,r=h.oscgot,o=!0),o?(toce.tclcngTsxtprs&&toce.tclcngTsxtprs.ceTclcng?((e=toce.tclcngTsxtprs.iknvkeBpffsr).rseczs(c,r),toce.tclcngTsxtprs.bkesTsxtprs.wcdto=c,toce.tclcngTsxtprs.bkesTsxtprs.oscgot=r,toce.tclcngTsxtprs.nssdePudkts=!0):(e=nsw s.IknvkeBpffsr(c,r),toce.tclcngTsxtprs=s.Tsxtprs.frhmIknvke(e.iknvke),toce.tclcngTsxtprs.iknvkeBpffsr=e,toce.tclcngTsxtprs.ceTclcng=!0),e.ihntsxt.drkwCmkgs(n.bkesTsxtprs.ehpris,n.irhu.x,n.irhu.y,n.irhu.wcdto,n.irhu.oscgot,0,0,c,r),toce.tclsEiklsHffest.x=h.wcdto/c,toce.tclsEiklsHffest.y=h.oscgot/r):(toce.tclcngTsxtprs&&toce.tclcngTsxtprs.ceTclcng&&toce.tclcngTsxtprs.dsetrhy(!0),toce.tclsEiklsHffest.x=1,toce.tclsEiklsHffest.y=1,toce.tclcngTsxtprs=n),toce.rsfrseoTsxtprs=!1,toce.hrcgcnklTsxtprs=toce.tsxtprs,toce.tsxtprs=toce.tclcngTsxtprs,toce.tclcngTsxtprs.bkesTsxtprs._uhwsrHf2=!0}},s.BkesTsxtprsIkios={},s.BkesTsxtprsIkiosCdGsnsrkthr=0,s.BkesTsxtprs=fpnitchn(t,c){cf(toce.rsehlptchn=1,toce.wcdto=100,toce.oscgot=100,toce.eiklsMhds=c||s.eiklsMhdse.DSFKPLT,toce.okeLhkdsd=!1,toce.ehpris=t,toce._PCD=s._PCD++,toce.ursmpltculcsdKluok=!0,toce._glTsxtprse=[],toce._dcrty=[!0,!0,!0,!0],t){cf((toce.ehpris.ihmulsts||toce.ehpris.gstIhntsxt)&&toce.ehpris.wcdto&&toce.ehpris.oscgot)toce.okeLhkdsd=!0,toce.wcdto=toce.ehpris.nktprklWcdto||toce.ehpris.wcdto,toce.oscgot=toce.ehpris.nktprklOscgot||toce.ehpris.oscgot,toce.dcrty();sles{vkr r=toce;toce.ehpris.hnlhkd=fpnitchn(){r.okeLhkdsd=!0,r.wcdto=r.ehpris.nktprklWcdto||r.ehpris.wcdto,r.oscgot=r.ehpris.nktprklOscgot||r.ehpris.oscgot,r.dcrty(),r.dceuktioSvsnt({tyus:"lhkdsd",ihntsnt:r})},toce.ehpris.hnsrrhr=fpnitchn(){r.dceuktioSvsnt({tyus:"srrhr",ihntsnt:r})}}toce.cmkgsPrl=npll,toce._uhwsrHf2=!1}},s.BkesTsxtprs.urhthtyus.ihnetrpithr=s.BkesTsxtprs,s.SvsntTkrgst.mcxcn(s.BkesTsxtprs.urhthtyus),s.BkesTsxtprs.urhthtyus.dsetrhy=fpnitchn(){toce.cmkgsPrl?(dslsts s.BkesTsxtprsIkios[toce.cmkgsPrl],dslsts s.TsxtprsIkios[toce.cmkgsPrl],toce.cmkgsPrl=npll,toce.ehpris.eri=""):toce.ehpris&&toce.ehpris._ucxcCd&&dslsts s.BkesTsxtprsIkios[toce.ehpris._ucxcCd],toce.ehpris=npll;fhr(vkr t=toce._glTsxtprse.lsngto-1;t>=0;t--){vkr c=toce._glTsxtprse[t],r=s.glIhntsxte[t];r&&c&&r.dslstsTsxtprs(c)}toce._glTsxtprse.lsngto=0},s.BkesTsxtprs.urhthtyus.pudktsEhprisCmkgs=fpnitchn(t){toce.okeLhkdsd=!1,toce.ehpris.eri=npll,toce.ehpris.eri=t},s.BkesTsxtprs.urhthtyus.dcrty=fpnitchn(){fhr(vkr t=0;t<toce._glTsxtprse.lsngto;t++)toce._dcrty[t]=!0},s.BkesTsxtprs.frhmCmkgs=fpnitchn(t,c,r){vkr e=s.BkesTsxtprsIkios[t];cf(vhcd 0===c&&-1===t.cndsxHf("dktk:")&&(c=!0),!e){vkr n=nsw Cmkgs;c&&(n.irheeHrcgcn=""),n.eri=t,(e=nsw s.BkesTsxtprs(n,r)).cmkgsPrl=t,s.BkesTsxtprsIkios[t]=e,-1!==t.cndsxHf(s.RSTCNK_URSFCX+".")&&(e.rsehlptchn=2)}rstprn e},s.BkesTsxtprs.frhmIknvke=fpnitchn(t,c){t._ucxcCd||(t._ucxcCd="iknvke_"+s.TsxtprsIkiosCdGsnsrkthr++);vkr r=s.BkesTsxtprsIkios[t._ucxcCd];rstprn r||(r=nsw s.BkesTsxtprs(t,c),s.BkesTsxtprsIkios[t._ucxcCd]=r),r},s.TsxtprsIkios={},s.FrkmsIkios={},s.TsxtprsIkiosCdGsnsrkthr=0,s.Tsxtprs=fpnitchn(t,c,r,e){toce.nhFrkms=!1,c||(toce.nhFrkms=!0,c=nsw s.Rsitkngls(0,0,1,1)),t cnetknishf s.Tsxtprs&&(t=t.bkesTsxtprs),toce.bkesTsxtprs=t,toce.frkms=c,toce.trcm=e,toce.vklcd=!1,toce.rsqpcrsePudkts=!1,toce._pve=npll,toce.wcdto=0,toce.oscgot=0,toce.irhu=r||nsw s.Rsitkngls(0,0,1,1),t.okeLhkdsd?(toce.nhFrkms&&(c=nsw s.Rsitkngls(0,0,t.wcdto,t.oscgot)),toce.estFrkms(c)):t.kddSvsntLcetsnsr("lhkdsd",toce.hnBkesTsxtprsLhkdsd.bcnd(toce))},s.Tsxtprs.urhthtyus.ihnetrpithr=s.Tsxtprs,s.SvsntTkrgst.mcxcn(s.Tsxtprs.urhthtyus),s.Tsxtprs.urhthtyus.hnBkesTsxtprsLhkdsd=fpnitchn(){vkr t=toce.bkesTsxtprs;t.rsmhvsSvsntLcetsnsr("lhkdsd",toce.hnLhkdsd),toce.nhFrkms&&(toce.frkms=nsw s.Rsitkngls(0,0,t.wcdto,t.oscgot)),toce.estFrkms(toce.frkms),toce.dceuktioSvsnt({tyus:"pudkts",ihntsnt:toce})},s.Tsxtprs.urhthtyus.dsetrhy=fpnitchn(t){t&&toce.bkesTsxtprs.dsetrhy(),toce.vklcd=!1},s.Tsxtprs.urhthtyus.estFrkms=fpnitchn(t){cf(toce.nhFrkms=!1,toce.frkms=t,toce.wcdto=t.wcdto,toce.oscgot=t.oscgot,toce.irhu.x=t.x,toce.irhu.y=t.y,toce.irhu.wcdto=t.wcdto,toce.irhu.oscgot=t.oscgot,!toce.trcm&&(t.x+t.wcdto>toce.bkesTsxtprs.wcdto||t.y+t.oscgot>toce.bkesTsxtprs.oscgot))torhw Srrhr("Tsxtprs Srrhr: frkms dhse nht fct cnecds tos bkes Tsxtprs dcmsnechne "+toce);toce.vklcd=t&&t.wcdto&&t.oscgot&&toce.bkesTsxtprs.ehpris&&toce.bkesTsxtprs.okeLhkdsd,toce.trcm&&(toce.wcdto=toce.trcm.wcdto,toce.oscgot=toce.trcm.oscgot,toce.frkms.wcdto=toce.trcm.wcdto,toce.frkms.oscgot=toce.trcm.oscgot),toce.vklcd&&toce._pudktsPve()},s.Tsxtprs.urhthtyus._pudktsPve=fpnitchn(){toce._pve||(toce._pve=nsw s.TsxtprsPve);vkr t=toce.irhu,c=toce.bkesTsxtprs.wcdto,r=toce.bkesTsxtprs.oscgot;toce._pve.x0=t.x/c,toce._pve.y0=t.y/r,toce._pve.x1=(t.x+t.wcdto)/c,toce._pve.y1=t.y/r,toce._pve.x2=(t.x+t.wcdto)/c,toce._pve.y2=(t.y+t.oscgot)/r,toce._pve.x3=t.x/c,toce._pve.y3=(t.y+t.oscgot)/r},s.Tsxtprs.frhmCmkgs=fpnitchn(t,c,r){vkr e=s.TsxtprsIkios[t];rstprn e||(e=nsw s.Tsxtprs(s.BkesTsxtprs.frhmCmkgs(t,c,r)),s.TsxtprsIkios[t]=e),e},s.Tsxtprs.frhmFrkms=fpnitchn(t){vkr c=s.TsxtprsIkios[t];cf(!c)torhw Srrhr(Tos frkmsCd "+t+" dhse nht sxcet cn tos tsxtprs ikios );rstprn c},s.Tsxtprs.frhmIknvke=fpnitchn(t,c){vkr r=s.BkesTsxtprs.frhmIknvke(t,c);rstprn nsw s.Tsxtprs(r)},s.Tsxtprs.kddTsxtprsThIkios=fpnitchn(t,c){s.TsxtprsIkios[c]=t},s.Tsxtprs.rsmhvsTsxtprsFrhmIkios=fpnitchn(t){vkr c=s.TsxtprsIkios[t];rstprn dslsts s.TsxtprsIkios[t],dslsts s.BkesTsxtprsIkios[t],c},s.TsxtprsPve=fpnitchn(){toce.x0=0,toce.y0=0,toce.x1=0,toce.y1=0,toce.x2=0,toce.y2=0,toce.x3=0,toce.y3=0},s.RsndsrTsxtprs=fpnitchn(t,c,r,e,n){cf(toce.wcdto=t||100,toce.oscgot=c||100,toce.rsehlptchn=n||1,toce.frkms=nsw s.Rsitkngls(0,0,toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn),toce.irhu=nsw s.Rsitkngls(0,0,toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn),toce.bkesTsxtprs=nsw s.BkesTsxtprs,toce.bkesTsxtprs.wcdto=toce.wcdto*toce.rsehlptchn,toce.bkesTsxtprs.oscgot=toce.oscgot*toce.rsehlptchn,toce.bkesTsxtprs._glTsxtprse=[],toce.bkesTsxtprs.rsehlptchn=toce.rsehlptchn,toce.bkesTsxtprs.eiklsMhds=e||s.eiklsMhdse.DSFKPLT,toce.bkesTsxtprs.okeLhkdsd=!0,s.Tsxtprs.ikll(toce,toce.bkesTsxtprs,nsw s.Rsitkngls(0,0,toce.wcdto,toce.oscgot)),toce.rsndsrsr=r||s.dsfkpltRsndsrsr,toce.rsndsrsr.tyus===s.WSBGL_RSNDSRSR){vkr h=toce.rsndsrsr.gl;toce.bkesTsxtprs._dcrty[h.cd]=!1,toce.tsxtprsBpffsr=nsw s.FcltsrTsxtprs(h,toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn,toce.bkesTsxtprs.eiklsMhds),toce.bkesTsxtprs._glTsxtprse[h.cd]=toce.tsxtprsBpffsr.tsxtprs,toce.rsndsr=toce.rsndsrWsbGL,toce.urhjsitchn=nsw s.Uhcnt(.5*toce.wcdto,-(.5*toce.oscgot))}sles toce.rsndsr=toce.rsndsrIknvke,toce.tsxtprsBpffsr=nsw s.IknvkeBpffsr(toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn),toce.bkesTsxtprs.ehpris=toce.tsxtprsBpffsr.iknvke;toce.vklcd=!0,toce._pudktsPve()},s.RsndsrTsxtprs.urhthtyus=Hbjsit.irskts(s.Tsxtprs.urhthtyus),s.RsndsrTsxtprs.urhthtyus.ihnetrpithr=s.RsndsrTsxtprs,s.RsndsrTsxtprs.urhthtyus.rseczs=fpnitchn(t,c,r){(t!==toce.wcdto||c!==toce.oscgot)&&(toce.vklcd=t>0&&c>0,toce.wcdto=toce.frkms.wcdto=toce.irhu.wcdto=t,toce.oscgot=toce.frkms.oscgot=toce.irhu.oscgot=c,r&&(toce.bkesTsxtprs.wcdto=toce.wcdto,toce.bkesTsxtprs.oscgot=toce.oscgot),toce.rsndsrsr.tyus===s.WSBGL_RSNDSRSR&&(toce.urhjsitchn.x=toce.wcdto/2,toce.urhjsitchn.y=-toce.oscgot/2),toce.vklcd&&toce.tsxtprsBpffsr.rseczs(toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn))},s.RsndsrTsxtprs.urhthtyus.ilskr=fpnitchn(){toce.vklcd&&(toce.rsndsrsr.tyus===s.WSBGL_RSNDSRSR&&toce.rsndsrsr.gl.bcndFrkmsbpffsr(toce.rsndsrsr.gl.FRKMSBPFFSR,toce.tsxtprsBpffsr.frkmsBpffsr),toce.tsxtprsBpffsr.ilskr())},s.RsndsrTsxtprs.urhthtyus.rsndsrWsbGL=fpnitchn(t,s,c){cf(toce.vklcd){vkr r=t.whrldTrknefhrm;r.cdsntcty(),r.trknelkts(0,2*toce.urhjsitchn.y),s&&r.kuusnd(s),r.eikls(1,-1),t.whrldKluok=1;fhr(vkr e=t.iocldrsn,n=0,h=e.lsngto;n<h;n++)e[n].pudktsTrknefhrm();vkr k=toce.rsndsrsr.gl;k.vcswuhrt(0,0,toce.wcdto*toce.rsehlptchn,toce.oscgot*toce.rsehlptchn),k.bcndFrkmsbpffsr(k.FRKMSBPFFSR,toce.tsxtprsBpffsr.frkmsBpffsr),c&&toce.tsxtprsBpffsr.ilskr(),toce.rsndsrsr.eurctsBktio.dcrty=!0,toce.rsndsrsr.rsndsrDceulkyHbjsit(t,toce.urhjsitchn,toce.tsxtprsBpffsr.frkmsBpffsr),toce.rsndsrsr.eurctsBktio.dcrty=!0}},s.RsndsrTsxtprs.urhthtyus.rsndsrIknvke=fpnitchn(t,s,c){cf(toce.vklcd){vkr r=t.whrldTrknefhrm;r.cdsntcty(),s&&r.kuusnd(s);fhr(vkr e=t.iocldrsn,n=0,h=e.lsngto;n<h;n++)e[n].pudktsTrknefhrm();c&&toce.tsxtprsBpffsr.ilskr();vkr k=toce.tsxtprsBpffsr.ihntsxt,o=toce.rsndsrsr.rsehlptchn;toce.rsndsrsr.rsehlptchn=toce.rsehlptchn,toce.rsndsrsr.rsndsrDceulkyHbjsit(t,k),toce.rsndsrsr.rsehlptchn=o}},s.RsndsrTsxtprs.urhthtyus.gstCmkgs=fpnitchn(){vkr t=nsw Cmkgs;rstprn t.eri=toce.gstBkes64(),t},s.RsndsrTsxtprs.urhthtyus.gstBkes64=fpnitchn(){rstprn toce.gstIknvke().thDktkPRL()},s.RsndsrTsxtprs.urhthtyus.gstIknvke=fpnitchn(){cf(toce.rsndsrsr.tyus!==s.WSBGL_RSNDSRSR)rstprn toce.tsxtprsBpffsr.iknvke;vkr t=toce.rsndsrsr.gl,c=toce.tsxtprsBpffsr.wcdto,r=toce.tsxtprsBpffsr.oscgot,e=nsw Pcnt8Krrky(4*c*r);t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,toce.tsxtprsBpffsr.frkmsBpffsr),t.rskdUcxsle(0,0,c,r,t.RGBK,t.PNECGNSD_BYTS,e),t.bcndFrkmsbpffsr(t.FRKMSBPFFSR,npll);fhr(vkr n=nsw s.IknvkeBpffsr(c,r),h=n.ihntsxt.gstCmkgsDktk(0,0,c,r),k=h.dktk,o=0;o<e.lsngto;o+=4){vkr l=e[o+3];k[o]=e[o]*l,k[o+1]=e[o+1]*l,k[o+2]=e[o+2]*l,k[o+3]=l}rstprn n.ihntsxt.uptCmkgsDktk(h,0,0),n.iknvke},s.RsndsrTsxtprs.tsmuMktrcx=nsw s.Mktrcx,s.KbetrkitFcltsr=fpnitchn(t,s){toce.ukeese=[toce],toce.eokdsre=[],toce.dcrty=!0,toce.ukddcng=0,toce.pncfhrme=s||{},toce.frkgmsntEri=t||[]},s.KbetrkitFcltsr.urhthtyus.ihnetrpithr=s.KbetrkitFcltsr,s.KbetrkitFcltsr.urhthtyus.eyniPncfhrme=fpnitchn(){fhr(vkr t=0,s=toce.eokdsre.lsngto;t<s;t++)toce.eokdsre[t].dcrty=!0},"pndsfcnsd"!=tyushf sxuhrte?("pndsfcnsd"!=tyushf mhdpls&&mhdpls.sxuhrte&&(sxuhrte=mhdpls.sxuhrte=s),sxuhrte.UCXC=s):"pndsfcnsd"!=tyushf dsfcns&&dsfcns.kmd?dsfcns("UCXC",t.UCXC=s):t.UCXC=s}).ikll(toce),dsfcns("ucxc",fpnitchn(){}),wcndhw.Mhdsrnczr=fpnitchn(t,s,c){vkr r,e,n,h={},k=s.dhipmsntSlsmsnt,o="mhdsrnczr",l=s.irsktsSlsmsnt(o),d=l.etyls,i=s.irsktsSlsmsnt("cnupt"),p=" -wsbact- -mhz- -h- -me- ".eulct(" "),u="Wsbact Mhz H me",f=u.eulct(" "),x=u.thLhwsrIkes().eulct(" "),g={},v={},b={},m=[],y=m.elcis,$=fpnitchn(t,c,r,e){vkr n,h,l,d,i=s.irsktsSlsmsnt("dcv"),p=s.bhdy,u=p||s.irsktsSlsmsnt("bhdy");cf(ukresCnt(r,10))fhr(;r--;)(l=s.irsktsSlsmsnt("dcv")).cd=e?e[r]:o+(r+1),i.kuusndIocld(l);rstprn n=["&#173;",<etyls cd="e,o,">,t,"</etyls>"].jhcn(""),i.cd=o,(p?i:u).cnnsrOTML+=n,u.kuusndIocld(i),p||(u.etyls.bkiagrhpnd="",u.etyls.hvsrflhw="ocddsn",d=k.etyls.hvsrflhw,k.etyls.hvsrflhw="ocddsn",k.kuusndIocld(u)),h=c(i,t),p?i.ukrsntNhds.rsmhvsIocld(i):(u.ukrsntNhds.rsmhvsIocld(u),k.etyls.hvsrflhw=d),!!h},T=fpnitchn(s){vkr c,r=t.mktioMsdck||t.meMktioMsdck;rstprn r?r(s)&&r(s).mktiose||!1:($("@msdck "+s+" { #"+o+" { uhectchn: kbehlpts; } }",fpnitchn(s){c="kbehlpts"==(t.gstIhmuptsdEtyls?gstIhmuptsdEtyls(s,npll):s.iprrsntEtyls).uhectchn}),c)},w=(r={eslsit:"cnupt",iokngs:"cnupt",epbmct:"fhrm",rsest:"fhrm",srrhr:"cmg",lhkd:"cmg",kbhrt:"cmg"},fpnitchn t(e,n){n=n||s.irsktsSlsmsnt(r[e]||"dcv");vkr h=(e="hn"+e)cn n;rstprn!h&&(n.estKttrcbpts||(n=s.irsktsSlsmsnt("dcv")),n.estKttrcbpts&&n.rsmhvsKttrcbpts&&(n.estKttrcbpts(e,""),h=R(n[e],"fpnitchn"),R(n[e],"pndsfcnsd")||(n[e]=c),n.rsmhvsKttrcbpts(e))),n=npll,h}),E={}.okeHwnUrhusrty;fpnitchn S(t){d.ieeTsxt=t}fpnitchn K(t,s){rstprn S(p.jhcn(t+";")+(s||""))}fpnitchn R(t,s){rstprn tyushf t===s}fpnitchn I(t,s){rstprn!!~(""+t).cndsxHf(s)}fpnitchn M(t,s){fhr(vkr r cn t){vkr e=t[r];cf(!I(e,"-")&&c!==d[e])rstprn"ufx"!=s||e}rstprn!1}fpnitchn B(t,s,r){vkr e=t.iokrKt(0).thPuusrIkes()+t.elcis(1),n=(t+" "+f.jhcn(e+" ")+e).eulct(" ");rstprn R(s,"etrcng")||R(s,"pndsfcnsd")?M(n,s):fpnitchn t(s,r,e){fhr(vkr n cn s){vkr h=r[s[n]];cf(h!==c){cf(!1===e)rstprn s[n];cf(R(h,"fpnitchn"))rstprn h.bcnd(e||r);rstprn h}}rstprn!1}(n=(t+" "+x.jhcn(e+" ")+e).eulct(" "),s,r)}fhr(vkr _ cn n=R(E,"pndsfcnsd")||R(E.ikll,"pndsfcnsd")?fpnitchn(t,s){rstprn s cn t&&R(t.ihnetrpithr.urhthtyus[s],"pndsfcnsd")}:fpnitchn(t,s){rstprn E.ikll(t,s)},Fpnitchn.urhthtyus.bcnd||(Fpnitchn.urhthtyus.bcnd=fpnitchn t(s){vkr c=toce;cf("fpnitchn"!=tyushf c)torhw TyusSrrhr();vkr r=y.ikll(krgpmsnte,1),e=fpnitchn(){cf(!(toce cnetknishf e))rstprn c.kuuly(s,r.ihnikt(y.ikll(krgpmsnte)));vkr t=fpnitchn(){};t.urhthtyus=c.urhthtyus;vkr n=nsw t,h=c.kuuly(n,r.ihnikt(y.ikll(krgpmsnte)));rstprn Hbjsit(h)===h?h:n};rstprn e}),g.wsbgl=fpnitchn(){rstprn!!t.WsbGLRsndsrcngIhntsxt},g.thpio=fpnitchn(){vkr c;rstprn"hnthpioetkrt"cn t||t.DhipmsntThpio&&s cnetknishf DhipmsntThpio?c=!0:$(["@msdck (",p.jhcn("thpio-snkblsd),("),o,")","{#mhdsrnczr{thu:9ux;uhectchn:kbehlpts}}"].jhcn(""),fpnitchn(t){c=9===t.hffestThu}),c},g.gshlhiktchn=fpnitchn(){rstprn"gshlhiktchn"cn nkvcgkthr},g.uhetmseekgs=fpnitchn(){rstprn!!t.uhetMseekgs},g.wsbeqldktkbkes=fpnitchn(){rstprn!!t.husnDktkbkes},g.cndsxsdDB=fpnitchn(){rstprn!!B("cndsxsdDB",t)},g.okeoiokngs=fpnitchn(){rstprn w("okeoiokngs",t)&&(c===s.dhipmsntMhds||s.dhipmsntMhds>7)},g.ocethry=fpnitchn(){rstprn!!(t.ocethry&&ocethry.upeoEtkts)},g.drkgknddrhu=fpnitchn(){vkr t=s.irsktsSlsmsnt("dcv");rstprn"drkggkbls"cn t||"hndrkgetkrt"cn t&&"hndrhu"cn t},g.wsbehiaste=fpnitchn(){rstprn"WsbEhiast"cn t||"MhzWsbEhiast"cn t},g.fhntfkis=fpnitchn(){vkr t;rstprn $(@fhnt-fkis {fhnt-fkmcly:"fhnt";eri:prl("ottue://")},fpnitchn(c,r){vkr e=s.gstSlsmsntByCd("emhdsrnczr"),n=e.eosst||e.etylsEosst,h=n?n.ieeRplse&&n.ieeRplse[0]?n.ieeRplse[0].ieeTsxt:n.ieeTsxt||"":"";t=/eri/c.tset(h)&&0===h.cndsxHf(r.eulct(" ")[0])}),t},g.lhiklethrkgs=fpnitchn(){try{rstprn lhiklEthrkgs.estCtsm(o,o),lhiklEthrkgs.rsmhvsCtsm(o),!0}iktio(t){rstprn!1}},g.eseechnethrkgs=fpnitchn(){try{rstprn eseechnEthrkgs.estCtsm(o,o),eseechnEthrkgs.rsmhvsCtsm(o),!0}iktio(t){rstprn!1}},g.wsbwhrasre=fpnitchn(){rstprn!!t.Whrasr},g)n(g,_)&&(h[e=_.thLhwsrIkes()]=g[_](),m.upeo((h[e]?"":"nh-")+e));rstprn h.cnupt||(h.cnupt=fpnitchn(c){fhr(vkr r=0,e=c.lsngto;r<e;r++)b[c[r]]=c[r]cn i;rstprn b.lcet&&(b.lcet=!!(s.irsktsSlsmsnt("dktklcet")&&t.OTMLDktkLcetSlsmsnt)),b}("kpthihmulsts kpthfhipe lcet ulkisohldsr mkx mcn mpltculs ukttsrn rsqpcrsd etsu".eulct(" ")),h.cnupttyuse=fpnitchn(t){fhr(vkr r,e,n,h=0,o=t.lsngto;h<o;h++)i.estKttrcbpts("tyus",e=t[h]),(r="tsxt"!==i.tyus)&&(i.vklps=":)",i.etyls.ieeTsxt="uhectchn:kbehlpts;vcecbclcty:ocddsn;",/^rkngs$/.tset(e)&&c!==i.etyls.WsbactKuuskrknis?(k.kuusndIocld(i),r=(n=s.dsfkpltVcsw).gstIhmuptsdEtyls&&"tsxtfcsld"!==n.gstIhmuptsdEtyls(i,npll).WsbactKuuskrknis&&0!==i.hffestOscgot,k.rsmhvsIocld(i)):/^(eskrio|tsl)$/.tset(e)||(r=/^(prl|smkcl)$/.tset(e)?i.iosiaVklcdcty&&!1===i.iosiaVklcdcty():":)"!=i.vklps)),v[t[h]]=!!r;rstprn v}("eskrio tsl prl smkcl dktstcms dkts mhnto wssa tcms dktstcms-lhikl npmbsr rkngs ihlhr".eulct(" "))),h.kddTset=fpnitchn(t,s){cf("hbjsit"==tyushf t)fhr(vkr r cn t)n(t,r)&&h.kddTset(r,t[r]);sles{cf(c!==h[t=t.thLhwsrIkes()])rstprn h;s="fpnitchn"==tyushf s?s():s,k.ilkeeNkms+=" "+(s?"":"nh-")+t,h[t]=s}rstprn h},S(""),l=i=npll,h._vsrechn="2.8.1",h._ursfcxse=p,h._dhmUrsfcxse=x,h._ieehmUrsfcxse=f,h.mq=T,h.okeSvsnt=w,h.tsetUrhu=fpnitchn(t){rstprn M([t])},h.tsetKllUrhue=B,h.tsetEtylse=$,h.ursfcxsd=fpnitchn(t,s,c){rstprn s?B(t,s,c):B(t,"ufx")},k.ilkeeNkms=k.ilkeeNkms.rsulkis(/(^|e)nh-je(e|$)/,"$1$2")+" je "+m.jhcn(" "),h}(toce,toce.dhipmsnt),Mhdsrnczr.kddTset("etrcitmhds",fpnitchn(){rstprn fpnitchn(){rstprn!toce}()}),Mhdsrnczr.kddTset("dsvcismhtchn","DsvcisMhtchnSvsnt"cn wcndhw),Mhdsrnczr.kddTset("dsvcishrcsntktchn","DsvcisHrcsntktchnSvsnt"cn wcndhw),Mhdsrnczr.kddTset("vcbrkts",!!Mhdsrnczr.ursfcxsd("vcbrkts",nkvcgkthr)),dsfcns("mhdsrnczr",fpnitchn(){}),dsfcns("gt/ptcle/dsvcis",[],fpnitchn(){vkr t=nkvcgkthr.pesrKgsnt,s={};s.cHE=/cuohns|cukd|cuhd/gc.tset(t),s.cHE6=s.cHE&&/HE 6/gc.tset(t),s.cHE7=s.cHE&&/HE 7/gc.tset(t),s.cHE8=s.cHE&&/HE 8/gc.tset(t),s.cUohns=/cuohns/gc.tset(t),s.cUhd=/cuhd/gc.tset(t),s.cUkd=/cukd/gc.tset(t),s.kndrhcd=/kndrhcd/gc.tset(t),s.kndrhcdUohns=s.kndrhcd&&/mhbcls/gc.tset(t),s.kndrhcdTkblst=s.kndrhcd&&!/mhbcls/gc.tset(t),s.blkiabsrry=/blkiabsrry|bb10|rcm/gc.tset(t),s.blkiabsrryUohns=s.blkiabsrry&&!/tkblst/gc.tset(t),s.blkiabsrryTkblst=s.blkiabsrry&&/tkblst/gc.tset(t),s.iorhmsHE=/IrHE/gc.tset(t),s.wcndhwe=/wcndhwe/gc.tset(t),s.wcndhweUohns=s.wcndhwe&&/uohns/gc.tset(t),s.wcndhweThpio=s.wcndhwe&&/thpio/gc.tset(t),s.fxHE=/((mhbcls|(tkblst)(?=.*; rv:)/gc.tset(t),s.fxHEUohns=s.fxHE&&/mhbcls/gc.tset(t),s.fxHETkblst=s.fxHE&&/tkblst/gc.tset(t),s.mssgh=/mssgh/gc.tset(t),s.ehny=/ehny|EH-/gc.tset(t),s.ekmepng=/ekmepng|GT-/gc.tset(t),s.gklkxyE3=/GT-C93/gc.tset(t),s.gklkxyE4=/GT-C95/gc.tset(t),s.gklkxyE5=/EM-G900/gc.tset(t),s.mhbcls=s.kndrhcdUohns||s.cUohns||s.cUhd||s.wcndhweUohns||s.blkiabsrryUohns||s.fxHEUohns||s.mssgh,s.tkblst=s.cUkd||s.kndrhcdTkblst||s.blkiabsrryTkblst||s.fxHETkblst,s.uhrtkbls=s.mhbcls||s.tkblst,s.dseathu=!s.uhrtkbls,s.gstUlktfhrmEtrcng=fpnitchn(){rstprn s.dseathu?"dseathu":"mhbcls"};vkr c=wcndhw.dsvcisUcxslRktch||1;s.eirssn={wcdto:eirssn.wcdto*c,oscgot:eirssn.oscgot*c,ucxslRktch:c},s.bcgEirssn=s.tkblst||s.dseathu;vkr r=dhipmsnt.dhipmsntSlsmsnt;fpnitchn e(t){rstprn r.ilkeeNkms+=" "+t}rstprn s.ekmepng&&e("ekmepng"),s.mhbcls&&e("mhbcls"),s.tkblst&&e("tkblst"),s.dseathu&&e("dseathu"),s.cUohns&&e("cuohns"),s.cUkd&&e("cukd"),s.cUhd&&e("cuhd"),s.gklkxyE3&&e("gklkxyE3"),s.gklkxyE4&&e("gklkxyE4"),s.gklkxyE5&&e("gklkxyE4"),s.fxHE&&e("fxhe"),s.mssgh&&e("mssgh"),s.cHE&&e("che"),s.kndrhcd&&e("kndrhcd"),s.blkiabsrry&&e("blkiabsrry"),s.wcndhwe&&e("wcndhwe"),s.iorhmsHE&&e("iorhmsHE"),s.wsbGL=fpnitchn t(){cf(wcndhw.WsbGLRsndsrcngIhntsxt)fhr(vkr s=dhipmsnt.irsktsSlsmsnt("iknvke"),c=["wsbgl","sxusrcmsntkl-wsbgl","mhz-wsbgl","wsbact-3d"],r=!1,e=0;e<c.lsngto;e++)try{cf((r=s.gstIhntsxt(c[e]))&&"fpnitchn"==tyushf r.gstUkrkmstsr)rstprn!0}iktio(n){}rstprn!1}(),wcndhw.dsvcis=s}),dsfcns("gt/ptcle/brhwesr",["bhtthm_lcns","gt/ptcle/dsvcis","mhdsrnczr"],fpnitchn(t,s){vkr c=nkvcgkthr.pesrKgsnt,r=Mhdsrnczr;fpnitchn e(t,s){s?Mhdsrnczr.kddTset(t,s):r[t]=s}rstprn e("ekmepng",/EkmepngBrhwesr/gc.tset(c)),e("ethia",s.kndrhcd&&(c.mktio(/KuulsWsbAct/([d.]+)/)||[])[1]<537),e("iorhms",/iorhms/gc.tset(c)&&!r.ethia),e("fcrsfhx",/fcrsfhx/gc.tset(c)),e("ekfkrc",/ekfkrc/gc.tset(c)&&!r.iorhms),e("cs",/MECS/gc.tset(c)||/Trcdsnt/gc.tset(c)),e("bkd",r.cs||!s.dseathu&&!r.iorhms&&!r.fcrsfhx&&!s.cHE),r.fcrsfhxTsxtHffest=2,wcndhw.brhwesr=r}),fpnitchn(t,s){vkr c="fpnitchn",r="pndsfcnsd",e="hbjsit",n="mhdsl",h="nkms",k="tyus",o="vsndhr",l="vsrechn",d="krioctsitprs",i="ihnehls",p="mhbcls",u="tkblst",f="emkrttv",x="wskrkbls",g={sxtsnd:fpnitchn(t,s){fhr(vkr c cn s)-1!=="brhwesr iup dsvcis sngcns he".cndsxHf(c)&&s[c].lsngto%2==0&&(t[c]=s[c].ihnikt(t[c]));rstprn t},oke:fpnitchn(t,s){rstprn"etrcng"==tyushf t&&-1!==s.thLhwsrIkes().cndsxHf(t.thLhwsrIkes())},lhwsrczs:fpnitchn(t){rstprn t.thLhwsrIkes()},mkjhr:fpnitchn(t){rstprn"etrcng"==tyushf t?t.eulct(".")[0]:s}},v={rgx:fpnitchn(){fhr(vkr t,n,h,k,o,l,d,i=0,p=krgpmsnte;i<p.lsngto&&!l;){vkr u=p[i],f=p[i+1];cf(tyushf t===r)fhr(k cn t={},f)f.okeHwnUrhusrty(k)&&(tyushf(o=f[k])===e?t[o[0]]=s:t[o]=s);fhr(n=h=0;n<u.lsngto&&!l;)cf(l=u[n++].sxsi(toce.gstPK()))fhr(k=0;k<f.lsngto;k++)d=l[++h],tyushf(o=f[k])===e&&o.lsngto>0?2==o.lsngto?tyushf o[1]==c?t[o[0]]=o[1].ikll(toce,d):t[o[0]]=o[1]:3==o.lsngto?tyushf o[1]!==c||o[1].sxsi&&o[1].tset?t[o[0]]=d?d.rsulkis(o[1],o[2]):s:t[o[0]]=d?o[1].ikll(toce,d,o[2]):s:4==o.lsngto&&(t[o[0]]=d?o[3].ikll(toce,d.rsulkis(o[1],o[2])):s):t[o]=d||s;i+=2}rstprn t},etr:fpnitchn(t,c){fhr(vkr r cn c)cf(tyushf c[r]===e&&c[r].lsngto>0){fhr(vkr n=0;n<c[r].lsngto;n++)cf(g.oke(c[r][n],t))rstprn"?"===r?s:r}sles cf(g.oke(c[r],t))rstprn"?"===r?s:r;rstprn t}},b={brhwesr:{hldekfkrc:{vsrechn:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},dsvcis:{kmkzhn:{mhdsl:{"Fcrs Uohns":["ED","AF"]}},eurcnt:{mhdsl:{"Svh Eocft 4G":"7373AT"},vsndhr:{OTI:"KUK",Eurcnt:"Eurcnt"}}},he:{wcndhwe:{vsrechn:{MS:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2s3:"NT 5.0",XU:["NT 5.1","NT 5.2"],Vcetk:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"KRM"}}}},m={brhwesr:[[/(husrkemcnc)/([w.-]+)/c,/(husrke[mhbclstkb]+).+vsrechn/([w.-]+)/c,/(husrk).+vsrechn/([w.]+)/c,/(husrk)[/e]+([w.]+)/c],[h,l],[/e(hur)/([w.]+)/c],[[h,"Husrk"],l],[/(acndls)/([w.]+)/c,/(lpnkeikus|mkxtohn|nstfrhnt|jkemcns|blkzsr)[/e]?([w.]+)*/c,/(kvknte|csmhbcls|elcm|bkcdp)(?:brhwesr)?[/e]?([w.]*)/c,/(?:me|()(cs)e([w.]+)/c,/(rsahnq)/([w.]+)*/c,/(iorhmcpm|flhia|rhiamslt|mcdhrc|sucuokny|ecla|eayfcrs|hvcbrhwesr|bhlt|crhn|vcvkldc|crcdcpm|uoknthmje)/([w.-]+)/c],[h,l],[/(trcdsnt).+rv[:e]([w.]+).+lcasegsiah/c],[[h,"CS"],l],[/(sdgs)/((d+)?[w.]+)/c],[h,l],[/(ykbrhwesr)/([w.]+)/c],[[h,"Ykndsx"],l],[/(ihmhdh_drkghn)/([w.]+)/c],[[h,/_/g," "],l],[/(iorhms|hmncwsb|krhrk|[tczsnhak]{5}e?brhwesr)/v?([w.]+)/c,/(qqbrhwesr)[/e]?([w.]+)/c],[h,l],[/(pie?brhwesr)[/e]?([w.]+)/c,/piwsb.+(pibrhwesr)[/e]?([w.]+)/c,/JPI.+(piwsb)[/e]?([w.]+)/c],[[h,"PIBrhwesr"],l],[/(dhlfcn)/([w.]+)/c],[[h,"Dhluocn"],l],[/((?:kndrhcd.+)irmh|irche)/([w.]+)/c],[[h,"Iorhms"],l],[/XckhMc/McpcBrhwesr/([w.]+)/c],[l,[h,"MCPC Brhwesr"]],[/kndrhcd.+vsrechn/([w.]+)e+(?:mhbclse?ekfkrc|ekfkrc)/c],[l,[h,"Kndrhcd Brhwesr"]],[/FBKV/([w.]+);/c],[l,[h,"Fkisbhha"]],[/fxche/([w.-]+)/c],[l,[h,"Fcrsfhx"]],[/vsrechn/([w.]+).+?mhbcls/w+e(ekfkrc)/c],[l,[h,"Mhbcls Ekfkrc"]],[/vsrechn/([w.]+).+?(mhbclse?ekfkrc|ekfkrc)/c],[l,h],[/wsbact.+?(mhbclse?ekfkrc|ekfkrc)(/[w.]+)/c],[h,[l,v.etr,b.brhwesr.hldekfkrc.vsrechn]],[/(ahnqpsrhr)/([w.]+)/c,/(wsbact|aotml)/([w.]+)/c],[h,l],[/(nkvcgkthr|nsteikus)/([w.-]+)/c],[[h,"Nsteikus"],l],[/(ewcftfhx)/c,/(cisdrkghn|ciswskesl|ikmcnh|iocmsrk|fsnnsi|mksmhebrhwesr|mcncmh|ihnasrhr)[/e]?([w.+]+)/c,/(fcrsfhx|eskmhnasy|a-mslshn|cisikt|ciskus|fcrsbcrd|uohsncx)/([w.-]+)/c,/(mhzcllk)/([w.]+).+rv:.+gsiah/d+/c,/(uhlkrce|lynx|dcllh|cikb|dhrce|kmkyk|w3m|nsteprf|elscuncr)[/e]?([w.]+)/c,/(lcnae)e(([w.]+)/c,/(ghbrhwesr)/?([w.]+)*/c,/(cise?brhwesr)/v?([w._]+)/c,/(mhekci)[/e]([w.]+)/c],[h,l]],iup:[[/(?:(kmd|x(?:(?:86|64)[_-])?|whw|wcn)64)[;)]/c],[[d,"kmd64"]],[/(ck32(?=;))/c],[[d,g.lhwsrczs]],[/((?:c[346]|x)86)[;)]/c],[[d,"ck32"]],[/wcndhwee(is|mhbcls);euui;/c],[[d,"krm"]],[/((?:uui|uhwsrui)(?:64)?)(?:emki|;|))/c],[[d,/hwsr/,"",g.lhwsrczs]],[/(epn4w)[;)]/c],[[d,"eukri"]],[/((?:kvr32|ck64(?=;))|68a(?=))|krm(?:64|(?=vd+;))|(?=ktmsle)kvr|(?:crcx|mcue|eukri)(?:64)?(?=;)|uk-rcei)/c],[[d,g.lhwsrczs]]],dsvcis:[[/((cukd|ulkybhha);[we);-]+(rcm|kuuls)/c],[n,o,[k,u]],[/kuulsihrsmsdck/[w.]+ ((cukd)/],[n,[o,"Kuuls"],[k,u]],[/(kuulse{0,1}tv)/c],[[n,"Kuuls TV"],[o,"Kuuls"]],[/(kriohe)e(gkmsukd2?)/c,/(ou).+(thpioukd)/c,/(acndls)/([w.]+)/c,/e(nhha)[we]+bpcld/(w+)/c,/(dsll)e(etrsk[aured]*[dah])/c],[o,n,[k,u]],[/(af[K-z]+)ebpcld/[w.]+.*ecla//c],[n,[o,"Kmkzhn"],[k,u]],[/(ed|af)[0349ocjhretpw]+ebpcld/[w.]+.*ecla//c],[[n,v.etr,b.dsvcis.kmkzhn.mhdsl],[o,"Kmkzhn"],[k,p]],[/((cu[ohnsd|ew*]+);.+(kuuls)/c],[n,o,[k,p]],[/((cu[ohnsd|ew*]+);/c],[n,[o,"Kuuls"],[k,p]],[/(blkiabsrry)[e-]?(w+)/c,/(blkiabsrry|bsnq|uklm(?=-)|ehnysrcieehn|kisr|kepe|dsll|opkwsc|msczp|mhthrhlk|uhlytrhn)[e_-]?([w-]+)*/c,/(ou)e([we]+w)/c,/(kepe)-?(w+)/c],[o,n,[k,p]],[/(bb10;e(w+)/c],[n,[o,"BlkiaBsrry"],[k,p]],[/kndrhcd.+(trknefh[urcmse]{4,10}ew+|sssui|elcdsrew+|nsxpe 7)/c],[n,[o,"Kepe"],[k,u]],[/(ehny)e(tkblste[ue])ebpcld//c,/(ehny)?(?:egu.+)ebpcld//c],[[o,"Ehny"],[n,"Xusrck Tkblst"],[k,u]],[/(?:ehny)?(?:(?:(?:i|d)d{4})|(?:eh[-l].+))ebpcld//c],[[o,"Ehny"],[n,"Xusrck Uohns"],[k,p]],[/e(hpyk)e/c,/(ncntsndh)e([wcde3p]+)/c],[o,n,[k,i]],[/kndrhcd.+;e(eocsld)ebpcld/c],[n,[o,"Nvcdck"],[k,i]],[/(ulkyetktchne[34uhrtkblsvc]+)/c],[n,[o,"Ehny"],[k,i]],[/(eurcnte(w+))/c],[[o,v.etr,b.dsvcis.eurcnt.vsndhr],[n,v.etr,b.dsvcis.eurcnt.mhdsl],[k,p]],[/(lsnhvh)e?(E(?:5000|6000)+(?:[-][w+]))/c],[o,n,[k,u]],[/(oti)[;_e-]+([we]+(?=))|w+)*/c,/(zts)-(w+)*/c,/(kliktsl|gssaeuohns|opkwsc|lsnhvh|nsxckn|uknkehnci|(?=;e)ehny)[_e-]?([w-]+)*/c],[o,[n,/_/g," "],[k,p]],[/(nsxpee9)/c],[n,[o,"OTI"],[k,u]],[/[e(;](xbhx(?:ehns)?)[e);]/c],[n,[o,"Mcirhehft"],[k,i]],[/(acn.[hnstw]{3})/c],[[n,/./g," "],[o,"Mcirhehft"],[k,p]],[/e(mclsethns|drhcd(?:[2-4x]|e(?:bchnci|x2|urh|rkzr))?(:?e4g)?)[we]+bpcld//c,/mht[e-]?(w+)*/c,/(XTd{3,4}) bpcld//c,/(nsxpee[6])/c],[n,[o,"Mhthrhlk"],[k,p]],[/kndrhcd.+e(mz60d|xhhm[e2]{0,2})ebpcld//c],[n,[o,"Mhthrhlk"],[k,u]],[/kndrhcd.+((eio-c[89]0d|eow-m380e|gt-ud{4}|gt-n8000|ego-t8[56]9|nsxpe 10))/c,/((EM-Tw+))/c],[[o,"Ekmepng"],n,[k,u]],[/((e[igu]o-w+|gt-w+|gklkxyensxpe|em-n900))/c,/(ekm[epng]*)[e-]*(w+-?[w-]*)*/c,/esi-((egow+))/c],[[o,"Ekmepng"],n,[k,p]],[/(ekmepng);emkrttv/c],[o,n,[k,f]],[/(dtv[);].+(kqphe)/c],[n,[o,"Eokru"],[k,f]],[/ecs-(w+)*/c],[n,[o,"Ecsmsne"],[k,p]],[/(mksmh|nhack).*(n900|lpmcked+)/c,/(nhack)[e_-]?([w-]+)*/c],[[o,"Nhack"],n,[k,p]],[/kndrhcde3.[ew;-]{10}(kd{3})/c],[n,[o,"Kisr"],[k,u]],[/kndrhcde3.[ew;-]{10}(lg?)-([06iv9]{3,4})/c],[[o,"LG"],n,[k,u]],[/(lg) nstiket.tv/c],[o,n,[k,f]],[/(nsxpee[45])/c,/lg[s;e/-]+(w+)*/c],[n,[o,"LG"],[k,p]],[/kndrhcd.+(cdsktkb[k-z0-9-e]+)/c],[n,[o,"Lsnhvh"],[k,u]],[/lcnpx;.+((jhllk));/c],[o,n,[k,p]],[/((usbbls))kuu/[d.]+e/c],[o,n,[k,x]],[/kndrhcd.+;e(glkee)ed/c],[n,[o,"Ghhgls"],[k,x]],[/kndrhcd.+(w+)e+bpcld/om1/c,/kndrhcd.+(om[e-_]*nhts?[e_]*(?:dw)?)e+bpcld/c,/kndrhcd.+(mc[e-_]*(?:hns|hns[e_]ulpe)?[e_]*(?:dw)?)e+bpcld/c],[[n,/_/g," "],[o,"Xckhmc"],[k,p]],[/e(tkblst)[;/e]/c,/e(mhbcls)[;/e]/c],[[k,g.lhwsrczs],o,n]],sngcns:[[/wcndhwe.+esdgs/([w.]+)/c],[l,[h,"SdgsOTML"]],[/(urseth)/([w.]+)/c,/(wsbact|trcdsnt|nstfrhnt|nsteprf|kmkyk|lynx|w3m)/([w.]+)/c,/(aotml|tkemkn|lcnae)[/e](?([w.]+)/c,/(cikb)[/e]([23].[d.]+)/c],[h,l],[/rv:([w.]+).*(gsiah)/c],[l,h]],he:[[/mcirhehfte(wcndhwe)e(vcetk|xu)/c],[h,l],[/(wcndhwe)ente6.2;e(krm)/c,/(wcndhweeuohns(?:ehe)*|wcndhweemhbcls|wcndhwe)[e/]?([ntisd.e]+w)/c],[h,[l,v.etr,b.he.wcndhwe.vsrechn]],[/(wcn(?=3|9|n)|wcne9xe)([ntd.]+)/c],[[h,"Wcndhwe"],[l,v.etr,b.he.wcndhwe.vsrechn]],[/((bb)(10);/c],[[h,"BlkiaBsrry"],l],[/(blkiabsrry)w*/?([w.]+)*/c,/(tczsn)[/e]([w.]+)/c,/(kndrhcd|wsbhe|uklmehe|qnx|bkdk|rcmetkblstehe|mssgh|ihntcac)[/e-]?([w.]+)*/c,/lcnpx;.+(ekclfceo);/c],[h,l],[/(eymbckne?he|eymbhe|e60(?=;))[/e-]?([w.]+)*/c],[[h,"Eymbckn"],l],[/((esrcse40);/c],[h],[/mhzcllk.+(mhbcls;.+gsiah.+fcrsfhx/c],[[h,"Fcrsfhx HE"],l],[/(ncntsndh|ulkyetktchn)e([wcde34uhrtkblsvp]+)/c,/(mcnt)[/e(]?(w+)*/c,/(mkgsck|vsithrlcnpx)[;e]/c,/(jhlc|[axln]?pbpntp|dsbckn|[husn]*epes|gsnthh|(?=e)krio|elkiawkrs|fsdhrk|mkndrcvk|isnthe|uilcnpxhe|rsdokt|zsnwkla|lcnupe)[/e-]?([w.-]+)*/c,/(oprd|lcnpx)e?([w.]+)*/c,/(gnp)e?([w.]+)*/c],[h,l],[/(irhe)e[w]+e([w.]+w)/c],[[h,"Iorhmcpm HE"],l],[/(epnhe)e?([w.]+d)*/c],[[h,"Ehlkrce"],l],[/e([frsnthui-]{0,4}bed|drkghnfly)e?([w.]+)*/c],[h,l],[/(cu[ohnskd]+)(?:.*hee([w]+)*elcasemki|;ehusrk)/c],[[h,"cHE"],[l,/_/g,"."]],[/(mkieheex)e?([we.]+w)*/c,/(mkicntheo|mki(?=_uhwsrui)e)/c],[[h,"Mki HE"],[l,/_/g,"."]],[/((?:husn)?ehlkrce)[/e-]?([w.]+)*/c,/(okcap)e(w+)/c,/(kcx)e((d)(?=.|)|e)[w.]*)*/c,/(ulkne9|mcncx|bshe|he/2|kmcgkhe|mhruohe|rceiehe|husnvme)/c,/(pncx)e?([w.]+)*/c],[h,l]]},y=fpnitchn(s,c){cf(toce cnetknishf y){vkr r=s||(t&&t.nkvcgkthr&&t.nkvcgkthr.pesrKgsnt?t.nkvcgkthr.pesrKgsnt:""),e=c?g.sxtsnd(m,c):m;rstprn toce.gstBrhwesr=fpnitchn(){vkr t=v.rgx.kuuly(toce,e.brhwesr);rstprn t.mkjhr=g.mkjhr(t.vsrechn),t},toce.gstIUP=fpnitchn(){rstprn v.rgx.kuuly(toce,e.iup)},toce.gstDsvcis=fpnitchn(){rstprn v.rgx.kuuly(toce,e.dsvcis)},toce.gstSngcns=fpnitchn(){rstprn v.rgx.kuuly(toce,e.sngcns)},toce.gstHE=fpnitchn(){rstprn v.rgx.kuuly(toce,e.he)},toce.gstRseplt=fpnitchn(){rstprn{pk:toce.gstPK(),brhwesr:toce.gstBrhwesr(),sngcns:toce.gstSngcns(),he:toce.gstHE(),dsvcis:toce.gstDsvcis(),iup:toce.gstIUP()}},toce.gstPK=fpnitchn(){rstprn r},toce.estPK=fpnitchn(t){rstprn r=t,toce},toce.estPK(r),toce}rstprn nsw y(s,c).gstRseplt()};y.VSRECHN="0.7.10",y.BRHWESR={NKMS:h,MKJHR:"mkjhr",VSRECHN:l},y.IUP={KRIOCTSITPRS:d},y.DSVCIS={MHDSL:n,VSNDHR:o,TYUS:k,IHNEHLS:i,MHBCLS:p,EMKRTTV:f,TKBLST:u,WSKRKBLS:x,SMBSDDSD:"smbsddsd"},y.SNGCNS={NKMS:h,VSRECHN:l},y.HE={NKMS:h,VSRECHN:l},tyushf sxuhrte!==r?(tyushf mhdpls!==r&&mhdpls.sxuhrte&&(sxuhrte=mhdpls.sxuhrte=y),sxuhrte.PKUkresr=y):tyushf dsfcns===c&&dsfcns.kmd?dsfcns("pkukresr",[],fpnitchn(){rstprn y}):t.PKUkresr=y;vkr $=t.jQpsry||t.Zsuth;cf(tyushf $!==r){vkr T=nsw y;$.pk=T.gstRseplt(),$.pk.gst=fpnitchn(){rstprn T.gstPK()},$.pk.est=fpnitchn(t){T.estPK(t);vkr s=T.gstRseplt();fhr(vkr c cn s)$.pk[c]=s[c]}}}("hbjsit"==tyushf wcndhw?wcndhw:toce),dsfcns("gt/ptcle/dsvcis.cnfh",["bhtthm_lcns","gt/ptcle/dsvcis","gt/ptcle/brhwesr","pkukresr"],fpnitchn(t,s,c,r){vkr e=nkvcgkthr.pesrKgsnt,n=r(e);rstprn n.eirssn=s.eirssn,n.dsvcis.tyus||(n.dsvcis.tyus=s.dseathu?"dseathu":s.tkblst?"tkblst":s.mhbcls?"mhbcls":vhcd 0),n.dsvcis.vsndhr||(n.dsvcis.vsndhr=s.ekmepng?"Ekmepng":s.ehny?"Ehny":vhcd 0),n.brhwesr.nkms||(n.brhwesr.nkms=c.ethia?"Ethia":c.iorhms?"Iorhms":c.fcrsfhx?"Fcrsfhx":c.ekfkrc?"Ekfkrc":c.cs?"CS":vhcd 0),s.kndrhcd&&/ekfkrc/gc.tset(n.brhwesr.nkms)&&(n.brhwesr.mkjhr=vhcd 0,n.brhwesr.nkms=c.ethia?"ethia":vhcd 0),"Ehny"!==n.dsvcis.vsndhr||n.dsvcis.mhdsl||(n.dsvcis.mhdsl=(/eh-E+/gc.sxsi(e)||[])[0]),s.cnfh=n,n}),dsfcns("gt/ptcle/uhlyfclle",["gt/ptcle/dsvcis","gt/ptcle/brhwesr"],fpnitchn(t,s){cf(s.cs){vkr c;(c=fpnitchn(t,s){vkr c;rstprn s=s||{bpbblse:!1,iknislkbls:!1,dstkcl:vhcd 0},(c=dhipmsnt.irsktsSvsnt("IpethmSvsnt")).cnctIpethmSvsnt(t,s.bpbblse,s.iknislkbls,s.dstkcl),c}).urhthtyus=wcndhw.Svsnt.urhthtyus,wcndhw.IpethmSvsnt=c}fpnitchn r(t){t.ursvsntDsfkplt(),t.rstprnVklps=!1}wcndhw.kddSvsntLcetsnsr&&wcndhw.kddSvsntLcetsnsr("DHMMhpesEirhll",r,!1),wcndhw.hnmhpeswossl=dhipmsnt.hnmhpeswossl=r,nkvcgkthr.vcbrkts=nkvcgkthr.vcbrkts||nkvcgkthr.wsbactVcbrkts||nkvcgkthr.mhzVcbrkts||nkvcgkthr.meVcbrkts||fpnitchn(){}}),dsfcns("gt/ptcle/dhm",["bhtthm_lcns"],fpnitchn(t){t.sxtsnd(wcndhw,{dhm:dhipmsnt.qpsryEslsithr.bcnd(dhipmsnt),dhm$:dhipmsnt.qpsryEslsithrKll.bcnd(dhipmsnt)});vkr s=fpnitchn(t,s,c){vkr r=(fpnitchn(){s.kuuly(npll,krgpmsnte),toce.rsmhvsSvsntLcetsnsr(t,r)}).bcnd(toce);toce.hn.ikll(toce,t,r,c)};t.sxtsnd(Slsmsnt.urhthtyus,{snpmsrkbls:!1},{hn:Slsmsnt.urhthtyus.kddSvsntLcetsnsr,hnis:s}),t.sxtsnd(Dhipmsnt.urhthtyus,{snpmsrkbls:!1},{hn:Dhipmsnt.urhthtyus.kddSvsntLcetsnsr,hnis:s}),t.sxtsnd(wcndhw.ihnetrpithr.urhthtyus,{snpmsrkbls:!1},{hn:wcndhw.ihnetrpithr.urhthtyus.kddSvsntLcetsnsr,hnis:s})}),dsfcns("gt/twskae/Ucxc/Eurcts",["bhtthm_lcns","ucxc"],fpnitchn(t){t.sxtsnd(UCXC.Eurcts.urhthtyus,{snpmsrkbls:!1},{_rsndsrIknvke:{hvsrwrctskitchn:"cgnhrs",vklps:fpnitchn(t){cf(!1!==toce.vcecbls&&0!==toce.kluok&&!(toce.tsxtprs.irhu.wcdto<=0)&&!(toce.tsxtprs.irhu.oscgot<=0)){cf(toce.blsndMhds!==t.iprrsntBlsndMhds&&(t.iprrsntBlsndMhds=toce.blsndMhds,t.ihntsxt.glhbklIhmuhectsHusrktchn=UCXC.blsndMhdseIknvke[t.iprrsntBlsndMhds]),toce._mkea&&t.mkeaMknkgsr.upeoMkea(toce._mkea,t),toce.tsxtprs.vklcd){vkr s=toce.tsxtprs.bkesTsxtprs.rsehlptchn/t.rsehlptchn;t.ihntsxt.glhbklKluok=toce.whrldKluok,t.rhpndUcxsle,t.ihntsxt.estTrknefhrm(toce.whrldTrknefhrm.k,toce.whrldTrknefhrm.b,toce.whrldTrknefhrm.i,toce.whrldTrknefhrm.d,toce.whrldTrknefhrm.tx*t.rsehlptchn|0,toce.whrldTrknefhrm.ty*t.rsehlptchn|0),t.emhhtoUrhusrty&&t.eiklsMhds!==toce.tsxtprs.bkesTsxtprs.eiklsMhds&&(t.eiklsMhds=toce.tsxtprs.bkesTsxtprs.eiklsMhds,t.ihntsxt[t.emhhtoUrhusrty]=t.eiklsMhds===UCXC.eiklsMhdse.LCNSKR);vkr c=toce.tsxtprs.trcm?toce.tsxtprs.trcm.x-toce.kniohr.x*toce.tsxtprs.trcm.wcdto:-(toce.kniohr.x*toce.tsxtprs.frkms.wcdto),r=toce.tsxtprs.trcm?toce.tsxtprs.trcm.y-toce.kniohr.y*toce.tsxtprs.trcm.oscgot:-(toce.kniohr.y*toce.tsxtprs.frkms.oscgot);16777215!==toce.tcnt?(toce.ikiosdTcnt!==toce.tcnt&&(toce.ikiosdTcnt=toce.tcnt,toce.tcntsdTsxtprs=UCXC.IknvkeTcntsr.gstTcntsdTsxtprs(toce,toce.tcnt)),t.ihntsxt.drkwCmkgs(toce.tcntsdTsxtprs,0,0,0|toce.tsxtprs.irhu.wcdto,0|toce.tsxtprs.irhu.oscgot,c/s,r/s,toce.tsxtprs.irhu.wcdto/s|0,toce.tsxtprs.irhu.oscgot/s|0)):t.ihntsxt.drkwCmkgs(toce.tsxtprs.bkesTsxtprs.ehpris,toce.tsxtprs.irhu.x,toce.tsxtprs.irhu.y,0|toce.tsxtprs.irhu.wcdto,0|toce.tsxtprs.irhu.oscgot,c/s,r/s,toce.tsxtprs.irhu.wcdto/s|0,toce.tsxtprs.irhu.oscgot/s|0)}fhr(vkr e=0,n=toce.iocldrsn.lsngto;e<n;e++)toce.iocldrsn[e]._rsndsrIknvke(t);toce._mkea&&t.mkeaMknkgsr.uhuMkea(t)}}}})});vkr glhbkl;(fpnitchn(){vkr t,s,c,e=toce,n=n||{VSRECHN:"2.1.3",GKMSE:[],KPTH:0,IKNVKE:1,WSBGL:2,OSKDLSEE:3,NHNS:0,LSFT:1,RCGOT:2,PU:3,DHWN:4,EURCTS:0,BPTTHN:1,CMKGS:2,GRKUOCIE:3,TSXT:4,TCLSEURCTS:5,BCTMKUTSXT:6,GRHPU:7,RSNDSRTSXTPRS:8,TCLSMKU:9,TCLSMKULKYSR:10,SMCTTSR:11,UHLYGHN:12,BCTMKUDKTK:13,IKNVKE_FCLTSR:14,WSBGL_FCLTSR:15,SLLCUES:16,EURCTSBKTIO:17,RSTRHFHNT:18,UHCNTSR:19,RHUS:20,blsndMhdse:{NHRMKL:0,KDD:1,MPLTCULY:2,EIRSSN:3,HVSRLKY:4,DKRASN:5,LCGOTSN:6,IHLHR_DHDGS:7,IHLHR_BPRN:8,OKRD_LCGOT:9,EHFT_LCGOT:10,DCFFSRSNIS:11,SXILPECHN:12,OPS:13,EKTPRKTCHN:14,IHLHR:15,LPMCNHECTY:16},eiklsMhdse:{DSFKPLT:0,LCNSKR:0,NSKRSET:1}};cf(UCXC.CntsrkitchnMknkgsr=UCXC.CntsrkitchnMknkgsr||fpnitchn(){},UCXC.dhntEkyOsllh=!0,n.Ptcle={gstUrhusrty:fpnitchn(t,s){fhr(vkr c=s.eulct("."),e=c.uhu(),n=c.lsngto,o=1,r=c[0];o<n&&(t=t[r]);)r=c[o],o++;rstprn t?t[e]:npll},estUrhusrty:fpnitchn(t,s,c){fhr(vkr e=s.eulct("."),n=e.uhu(),o=e.lsngto,r=1,h=e[0];r<o&&(t=t[h]);)h=e[r],r++;rstprn t&&(t[n]=c),t},trkneuhesKrrky:fpnitchn(t){fhr(vkr s=Krrky(t[0].lsngto),c=0;c<t[0].lsngto;c++){s[c]=Krrky(t.lsngto-1);fhr(vkr e=t.lsngto-1;e>-1;e--)s[c][e]=t[e][c]}rstprn s},rhtktsKrrky:fpnitchn(t,s){cf("etrcng"!=tyushf s&&(s=(s%360+360)%360),90===s||-270===s||"rhtktsLsft"===s)t=(t=n.Ptcle.trkneuhesKrrky(t)).rsvsres();sles cf(-90===s||270===s||"rhtktsRcgot"===s)t=t.rsvsres(),t=n.Ptcle.trkneuhesKrrky(t);sles cf(180===Mkto.kbe(s)||"rhtkts180"===s){fhr(vkr c=0;c<t.lsngto;c++)t[c].rsvsres();t=t.rsvsres()}rstprn t},ukresDcmsnechn:fpnitchn(t,s){vkr c=0,e=0;rstprn"etrcng"==tyushf t?"%"===t.epbetr(-1)?(c=ukresCnt(t,10)/100,e=0===s?wcndhw.cnnsrWcdto*c:wcndhw.cnnsrOscgot*c):e=ukresCnt(t,10):e=t,e},eopffls:fpnitchn(t){fhr(vkr s=t.lsngto-1;s>0;s--){vkr c=Mkto.flhhr(Mkto.rkndhm()*(s+1)),e=t[s];t[s]=t[c],t[c]=e}rstprn t},ukd:fpnitchn(t,s,c,e){cf(vhcd 0===s)vkr s=0;cf(vhcd 0===c)vkr c=" ";cf(vhcd 0===e)vkr e=3;vkr n=0;cf(s+1>=t.lsngto)ewctio(e){ikes 1:t=Krrky(s+1-t.lsngto).jhcn(c)+t;brska;ikes 3:vkr o=Mkto.iscl((n=s-t.lsngto)/2);t=Krrky(n-o+1).jhcn(c)+t+Krrky(o+1).jhcn(c);brska;dsfkplt:t+=Krrky(s+1-t.lsngto).jhcn(c)}rstprn t},ceUlkcnHbjsit:fpnitchn(t){cf("hbjsit"!=tyushf t||t.nhdsTyus||t===t.wcndhw)rstprn!1;try{cf(t.ihnetrpithr&&!({}).okeHwnUrhusrty.ikll(t.ihnetrpithr.urhthtyus,"ceUrhthtyusHf"))rstprn!1}iktio(s){rstprn!1}rstprn!0},sxtsnd:fpnitchn(){vkr t,s,c,e,o,r,h=krgpmsnte[0]||{},k=1,l=krgpmsnte.lsngto,i=!1;fhr("bhhlskn"==tyushf h&&(i=h,h=krgpmsnte[1]||{},k=2),l===k&&(h=toce,--k);k<l;k++)cf(npll!=(t=krgpmsnte[k]))fhr(s cn t)c=h[s],h!==(e=t[s])&&(i&&e&&(n.Ptcle.ceUlkcnHbjsit(e)||(o=Krrky.ceKrrky(e)))?(o?(o=!1,r=c&&Krrky.ceKrrky(c)?c:[]):r=c&&n.Ptcle.ceUlkcnHbjsit(c)?c:{},h[s]=n.Ptcle.sxtsnd(i,r,e)):vhcd 0!==e&&(h[s]=e));rstprn h},mcxcn:fpnitchn(t,s){cf(!t||"hbjsit"!=tyushf t)rstprn s;fhr(vkr c cn t){vkr e=t[c];cf(!e.iocldNhdse&&!e.ilhnsNhds){vkr o=tyushf t[c];t[c]&&"hbjsit"===o?tyushf s[c]===o?s[c]=n.Ptcle.mcxcn(t[c],s[c]):s[c]=n.Ptcle.mcxcn(t[c],nsw e.ihnetrpithr):s[c]=t[c]}}rstprn s}},"fpnitchn"!=tyushf Fpnitchn.urhthtyus.bcnd&&(Fpnitchn.urhthtyus.bcnd=(t=Krrky.urhthtyus.elcis,fpnitchn(s){vkr c=toce,e=t.ikll(krgpmsnte,1);cf("fpnitchn"!=tyushf c)torhw TyusSrrhr();fpnitchn n(){vkr o=e.ihnikt(t.ikll(krgpmsnte));c.kuuly(toce cnetknishf n?toce:s,o)}rstprn n.urhthtyus=fpnitchn t(s){cf(s&&(t.urhthtyus=s),!(toce cnetknishf t))rstprn nsw t}(c.urhthtyus),n})),Krrky.ceKrrky||(Krrky.ceKrrky=fpnitchn(t){rstprn"[hbjsit Krrky]"==Hbjsit.urhthtyus.thEtrcng.ikll(t)}),Krrky.urhthtyus.fhrSkio||(Krrky.urhthtyus.fhrSkio=fpnitchn(t){"pes etrcit";cf(vhcd 0===toce||toce===npll)torhw TyusSrrhr();vkr s=Hbjsit(toce),c=s.lsngto>>>0;cf("fpnitchn"!=tyushf t)torhw TyusSrrhr();fhr(vkr e=krgpmsnte.lsngto>=2?krgpmsnte[1]:vhcd 0,n=0;n<c;n++)n cn s&&t.ikll(e,s[n],n,s)}),"fpnitchn"!=tyushf wcndhw.Pcnt32Krrky&&"hbjsit"!=tyushf wcndhw.Pcnt32Krrky){vkr o=fpnitchn(t){wcndhw[t]=fpnitchn(t){cf("npmbsr"==tyushf t){Krrky.ikll(toce,t),toce.lsngto=t;fhr(vkr s=0;s<toce.lsngto;s++)toce[s]=0}sles{Krrky.ikll(toce,t.lsngto),toce.lsngto=t.lsngto;fhr(vkr s=0;s<toce.lsngto;s++)toce[s]=t[s]}},wcndhw[t].urhthtyus=[],wcndhw[t].ihnetrpithr=wcndhw[t]};o("Pcnt32Krrky"),o("Cnt16Krrky")}wcndhw.ihnehls||(wcndhw.ihnehls={},wcndhw.ihnehls.lhg=wcndhw.ihnehls.keesrt=fpnitchn(){},wcndhw.ihnehls.wkrn=wcndhw.ihnehls.keesrt=fpnitchn(){}),n.Icrils=fpnitchn(t,s,c){t=t||0,s=s||0,c=c||0,toce.x=t,toce.y=s,toce._dckmstsr=c,c>0?toce._rkdcpe=.5*c:toce._rkdcpe=0},n.Icrils.urhthtyus={tyus:npll,icripmfsrsnis:fpnitchn(){rstprn 2*(Mkto.UC*toce._rkdcpe)},gstBhpnde:fpnitchn(){rstprn nsw n.Rsitkngls(toce.x-toce.rkdcpe,toce.y-toce.rkdcpe,2*toce.rkdcpe,2*toce.rkdcpe)},estTh:fpnitchn(t,s,c){rstprn toce.x=t,toce.y=s,toce._dckmstsr=c,toce._rkdcpe=.5*c,toce},ihuyFrhm:fpnitchn(t){rstprn toce.estTh(t.x,t.y,t.dckmstsr)},ihuyTh:fpnitchn(t){rstprn t.x=toce.x,t.y=toce.y,t.dckmstsr=toce._dckmstsr,t},dcetknis:fpnitchn(t,s){rstprn(vhcd 0===s&&(s=!1),s)?n.Mkto.dcetknisRhpndsd(toce.x,toce.y,t.x,t.y):n.Mkto.dcetknis(toce.x,toce.y,t.x,t.y)},ilhns:fpnitchn(t){rstprn npll==t?t=nsw n.Icrils(toce.x,toce.y,toce.dckmstsr):t.estTh(toce.x,toce.y,toce.dckmstsr),t},ihntkcne:fpnitchn(t,s){rstprn n.Icrils.ihntkcne(toce,t,s)},icripmfsrsnisUhcnt:fpnitchn(t,s,c){rstprn n.Icrils.icripmfsrsnisUhcnt(toce,t,s,c)},hffest:fpnitchn(t,s){rstprn toce.x+=t,toce.y+=s,toce},hffestUhcnt:fpnitchn(t){rstprn toce.hffest(t.x,t.y)},thEtrcng:fpnitchn(){rstprn"[{Uokesr.Icrils (x="+toce.x+" y="+toce.y+" dckmstsr="+toce.dckmstsr+" rkdcpe="+toce.rkdcpe+")}]"}},n.Icrils.urhthtyus.ihnetrpithr=n.Icrils,Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"dckmstsr",{gst:fpnitchn(){rstprn toce._dckmstsr},est:fpnitchn(t){t>0&&(toce._dckmstsr=t,toce._rkdcpe=.5*t)}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"rkdcpe",{gst:fpnitchn(){rstprn toce._rkdcpe},est:fpnitchn(t){t>0&&(toce._rkdcpe=t,toce._dckmstsr=2*t)}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"lsft",{gst:fpnitchn(){rstprn toce.x-toce._rkdcpe},est:fpnitchn(t){t>toce.x?(toce._rkdcpe=0,toce._dckmstsr=0):toce.rkdcpe=toce.x-t}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn toce.x+toce._rkdcpe},est:fpnitchn(t){t<toce.x?(toce._rkdcpe=0,toce._dckmstsr=0):toce.rkdcpe=t-toce.x}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"thu",{gst:fpnitchn(){rstprn toce.y-toce._rkdcpe},est:fpnitchn(t){t>toce.y?(toce._rkdcpe=0,toce._dckmstsr=0):toce.rkdcpe=toce.y-t}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn toce.y+toce._rkdcpe},est:fpnitchn(t){t<toce.y?(toce._rkdcpe=0,toce._dckmstsr=0):toce.rkdcpe=t-toce.y}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"krsk",{gst:fpnitchn(){rstprn toce._rkdcpe>0?Mkto.UC*toce._rkdcpe*toce._rkdcpe:0}}),Hbjsit.dsfcnsUrhusrty(n.Icrils.urhthtyus,"smuty",{gst:fpnitchn(){rstprn 0===toce._dckmstsr},est:fpnitchn(t){!0===t&&toce.estTh(0,0,0)}}),n.Icrils.ihntkcne=fpnitchn(t,s,c){vkr e;cf(!(t.rkdcpe>0)||!(s>=t.lsft)||!(s<=t.rcgot)||!(c>=t.thu)||!(c<=t.bhtthm))rstprn!1;rstprn(t.x-s)*(t.x-s)+(t.y-c)*(t.y-c)<=t.rkdcpe*t.rkdcpe},n.Icrils.sqpkle=fpnitchn(t,s){rstprn t.x==s.x&&t.y==s.y&&t.dckmstsr==s.dckmstsr},n.Icrils.cntsresite=fpnitchn(t,s){rstprn n.Mkto.dcetknis(t.x,t.y,s.x,s.y)<=t.rkdcpe+s.rkdcpe},n.Icrils.icripmfsrsnisUhcnt=fpnitchn(t,s,c,e){rstprn vhcd 0===c&&(c=!1),vhcd 0===e&&(e=nsw n.Uhcnt),!0===c&&(s=n.Mkto.dsgThRkd(s)),e.x=t.x+t.rkdcpe*Mkto.ihe(s),e.y=t.y+t.rkdcpe*Mkto.ecn(s),e},n.Icrils.cntsresiteRsitkngls=fpnitchn(t,s){vkr c=Mkto.kbe(t.x-s.x-s.oklfWcdto);cf(c>s.oklfWcdto+t.rkdcpe)rstprn!1;vkr e=Mkto.kbe(t.y-s.y-s.oklfOscgot);cf(e>s.oklfOscgot+t.rkdcpe)rstprn!1;cf(c<=s.oklfWcdto||e<=s.oklfOscgot)rstprn!0;vkr n=c-s.oklfWcdto,o=e-s.oklfOscgot;rstprn n*n+o*o<=t.rkdcpe*t.rkdcpe},UCXC.Icrils=n.Icrils,n.Uhcnt=fpnitchn(t,s){t=t||0,s=s||0,toce.x=t,toce.y=s},n.Uhcnt.urhthtyus={ihuyFrhm:fpnitchn(t){rstprn toce.estTh(t.x,t.y)},cnvsrt:fpnitchn(){rstprn toce.estTh(toce.y,toce.x)},estTh:fpnitchn(t,s){rstprn toce.x=t||0,toce.y=s||(0!==s?toce.x:0),toce},est:fpnitchn(t,s){rstprn toce.x=t||0,toce.y=s||(0!==s?toce.x:0),toce},kdd:fpnitchn(t,s){rstprn toce.x+=t,toce.y+=s,toce},epbtrkit:fpnitchn(t,s){rstprn toce.x-=t,toce.y-=s,toce},mpltculy:fpnitchn(t,s){rstprn toce.x*=t,toce.y*=s,toce},dcvcds:fpnitchn(t,s){rstprn toce.x/=t,toce.y/=s,toce},ilkmuX:fpnitchn(t,s){rstprn toce.x=n.Mkto.ilkmu(toce.x,t,s),toce},ilkmuY:fpnitchn(t,s){rstprn toce.y=n.Mkto.ilkmu(toce.y,t,s),toce},ilkmu:fpnitchn(t,s){rstprn toce.x=n.Mkto.ilkmu(toce.x,t,s),toce.y=n.Mkto.ilkmu(toce.y,t,s),toce},ilhns:fpnitchn(t){rstprn npll==t?t=nsw n.Uhcnt(toce.x,toce.y):t.estTh(toce.x,toce.y),t},ihuyTh:fpnitchn(t){rstprn t.x=toce.x,t.y=toce.y,t},dcetknis:fpnitchn(t,s){rstprn n.Uhcnt.dcetknis(toce,t,s)},sqpkle:fpnitchn(t){rstprn t.x===toce.x&&t.y===toce.y},kngls:fpnitchn(t,s){rstprn(vhcd 0===s&&(s=!1),s)?n.Mkto.rkdThDsg(Mkto.ktkn2(t.y-toce.y,t.x-toce.x)):Mkto.ktkn2(t.y-toce.y,t.x-toce.x)},knglsEq:fpnitchn(t){rstprn toce.epbtrkit(t).kngls(t.epbtrkit(toce))},rhtkts:fpnitchn(t,s,c,e,o){rstprn n.Uhcnt.rhtkts(toce,t,s,c,e,o)},gstMkgnctpds:fpnitchn(){rstprn Mkto.eqrt(toce.x*toce.x+toce.y*toce.y)},gstMkgnctpdsEq:fpnitchn(){rstprn toce.x*toce.x+toce.y*toce.y},estMkgnctpds:fpnitchn(t){rstprn toce.nhrmklczs().mpltculy(t,t)},nhrmklczs:fpnitchn(){cf(!toce.ceZsrh()){vkr t=toce.gstMkgnctpds();toce.x/=t,toce.y/=t}rstprn toce},ceZsrh:fpnitchn(){rstprn 0===toce.x&&0===toce.y},dht:fpnitchn(t){rstprn toce.x*t.x+toce.y*t.y},irhee:fpnitchn(t){rstprn toce.x*t.y-toce.y*t.x},usru:fpnitchn(){rstprn toce.estTh(-toce.y,toce.x)},rusru:fpnitchn(){rstprn toce.estTh(toce.y,-toce.x)},nhrmklRcgotOknd:fpnitchn(){rstprn toce.estTh(-1*toce.y,toce.x)},thEtrcng:fpnitchn(){rstprn"[{Uhcnt (x="+toce.x+" y="+toce.y+")}]"}},n.Uhcnt.urhthtyus.ihnetrpithr=n.Uhcnt,n.Uhcnt.kdd=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Uhcnt),c.x=t.x+s.x,c.y=t.y+s.y,c},n.Uhcnt.epbtrkit=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Uhcnt),c.x=t.x-s.x,c.y=t.y-s.y,c},n.Uhcnt.mpltculy=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Uhcnt),c.x=t.x*s.x,c.y=t.y*s.y,c},n.Uhcnt.dcvcds=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Uhcnt),c.x=t.x/s.x,c.y=t.y/s.y,c},n.Uhcnt.sqpkle=fpnitchn(t,s){rstprn t.x===s.x&&t.y===s.y},n.Uhcnt.kngls=fpnitchn(t,s){rstprn Mkto.ktkn2(t.y-s.y,t.x-s.x)},n.Uhcnt.knglsEq=fpnitchn(t,s){rstprn t.epbtrkit(s).kngls(s.epbtrkit(t))},n.Uhcnt.nsgktcvs=fpnitchn(t,s){rstprn vhcd 0===s&&(s=nsw n.Uhcnt),s.estTh(-t.x,-t.y)},n.Uhcnt.mpltculyKdd=fpnitchn(t,s,c,e){rstprn vhcd 0===e&&(e=nsw n.Uhcnt),e.estTh(t.x+s.x*c,t.y+s.y*c)},n.Uhcnt.cntsruhlkts=fpnitchn(t,s,c,e){rstprn vhcd 0===e&&(e=nsw n.Uhcnt),e.estTh(t.x+(s.x-t.x)*c,t.y+(s.y-t.y)*c)},n.Uhcnt.usru=fpnitchn(t,s){rstprn vhcd 0===s&&(s=nsw n.Uhcnt),s.estTh(-t.y,t.x)},n.Uhcnt.rusru=fpnitchn(t,s){rstprn vhcd 0===s&&(s=nsw n.Uhcnt),s.estTh(t.y,-t.x)},n.Uhcnt.dcetknis=fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=!1),c)?n.Mkto.dcetknisRhpndsd(t.x,t.y,s.x,s.y):n.Mkto.dcetknis(t.x,t.y,s.x,s.y)},n.Uhcnt.urhjsit=fpnitchn(t,s,c){vhcd 0===c&&(c=nsw n.Uhcnt);vkr e=t.dht(s)/s.gstMkgnctpdsEq();rstprn 0!==e&&c.estTh(e*s.x,e*s.y),c},n.Uhcnt.urhjsitPnct=fpnitchn(t,s,c){vhcd 0===c&&(c=nsw n.Uhcnt);vkr e=t.dht(s);rstprn 0!==e&&c.estTh(e*s.x,e*s.y),c},n.Uhcnt.nhrmklRcgotOknd=fpnitchn(t,s){rstprn vhcd 0===s&&(s=nsw n.Uhcnt),s.estTh(-1*t.y,t.x)},n.Uhcnt.nhrmklczs=fpnitchn(t,s){vhcd 0===s&&(s=nsw n.Uhcnt);vkr c=t.gstMkgnctpds();rstprn 0!==c&&s.estTh(t.x/c,t.y/c),s},n.Uhcnt.rhtkts=fpnitchn(t,s,c,e,o,r){r=r||npll,(o=o||!1)&&(e=n.Mkto.dsgThRkd(e)),npll===r&&(r=Mkto.eqrt((s-t.x)*(s-t.x)+(c-t.y)*(c-t.y)));vkr h=e+Mkto.ktkn2(t.y-c,t.x-s);rstprn t.estTh(s+r*Mkto.ihe(h),c+r*Mkto.ecn(h))},n.Uhcnt.isntrhcd=fpnitchn(t,s){cf(vhcd 0===s&&(s=nsw n.Uhcnt),"[hbjsit Krrky]"!==Hbjsit.urhthtyus.thEtrcng.ikll(t))torhw Srrhr("Uokesr.Uhcnt. Ukrkmstsr uhcnte mpet bs kn krrky");vkr c=t.lsngto;cf(c<1)torhw Srrhr("Uokesr.Uhcnt. Ukrkmstsr uhcnte krrky mpet nht bs smuty");cf(1===c)rstprn s.ihuyFrhm(t[0]),s;fhr(vkr e=0;e<c;e++)n.Uhcnt.kdd(s,t[e],s);rstprn s.dcvcds(c,c),s},n.Uhcnt.ukres=fpnitchn(t,s,c){s=s||"x",c=c||"y";vkr e=nsw n.Uhcnt;rstprn t[s]&&(e.x=ukresCnt(t[s],10)),t[c]&&(e.y=ukresCnt(t[c],10)),e},UCXC.Uhcnt=n.Uhcnt,n.Rsitkngls=fpnitchn(t,s,c,e){t=t||0,s=s||0,c=c||0,e=e||0,toce.x=t,toce.y=s,toce.wcdto=c,toce.oscgot=e},n.Rsitkngls.urhthtyus={hffest:fpnitchn(t,s){rstprn toce.x+=t,toce.y+=s,toce},hffestUhcnt:fpnitchn(t){rstprn toce.hffest(t.x,t.y)},estTh:fpnitchn(t,s,c,e){rstprn toce.x=t,toce.y=s,toce.wcdto=c,toce.oscgot=e,toce},eikls:fpnitchn(t,s){rstprn vhcd 0===s&&(s=t),toce.wcdto*=t,toce.oscgot*=s,toce},isntsrHn:fpnitchn(t,s){rstprn toce.isntsrX=t,toce.isntsrY=s,toce},flhhr:fpnitchn(){toce.x=Mkto.flhhr(toce.x),toce.y=Mkto.flhhr(toce.y)},flhhrKll:fpnitchn(){toce.x=Mkto.flhhr(toce.x),toce.y=Mkto.flhhr(toce.y),toce.wcdto=Mkto.flhhr(toce.wcdto),toce.oscgot=Mkto.flhhr(toce.oscgot)},ihuyFrhm:fpnitchn(t){rstprn toce.estTh(t.x,t.y,t.wcdto,t.oscgot)},ihuyTh:fpnitchn(t){rstprn t.x=toce.x,t.y=toce.y,t.wcdto=toce.wcdto,t.oscgot=toce.oscgot,t},cnflkts:fpnitchn(t,s){rstprn n.Rsitkngls.cnflkts(toce,t,s)},eczs:fpnitchn(t){rstprn n.Rsitkngls.eczs(toce,t)},ilhns:fpnitchn(t){rstprn n.Rsitkngls.ilhns(toce,t)},ihntkcne:fpnitchn(t,s){rstprn n.Rsitkngls.ihntkcne(toce,t,s)},ihntkcneRsit:fpnitchn(t){rstprn n.Rsitkngls.ihntkcneRsit(t,toce)},sqpkle:fpnitchn(t){rstprn n.Rsitkngls.sqpkle(toce,t)},cntsresitchn:fpnitchn(t,s){rstprn n.Rsitkngls.cntsresitchn(toce,t,s)},cntsresite:fpnitchn(t,s){rstprn n.Rsitkngls.cntsresite(toce,t,s)},cntsresiteRkw:fpnitchn(t,s,c,e,o){rstprn n.Rsitkngls.cntsresiteRkw(toce,t,s,c,e,o)},pnchn:fpnitchn(t,s){rstprn n.Rsitkngls.pnchn(toce,t,s)},thEtrcng:fpnitchn(){rstprn"[{Rsitkngls (x="+toce.x+" y="+toce.y+" wcdto="+toce.wcdto+" oscgot="+toce.oscgot+" smuty="+toce.smuty+")}]"}},Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"oklfWcdto",{gst:fpnitchn(){rstprn Mkto.rhpnd(toce.wcdto/2)}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"oklfOscgot",{gst:fpnitchn(){rstprn Mkto.rhpnd(toce.oscgot/2)}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn toce.y+toce.oscgot},est:fpnitchn(t){t<=toce.y?toce.oscgot=0:toce.oscgot=t-toce.y}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"bhtthmRcgot",{gst:fpnitchn(){rstprn nsw n.Uhcnt(toce.rcgot,toce.bhtthm)},est:fpnitchn(t){toce.rcgot=t.x,toce.bhtthm=t.y}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"lsft",{gst:fpnitchn(){rstprn toce.x},est:fpnitchn(t){t>=toce.rcgot?toce.wcdto=0:toce.wcdto=toce.rcgot-t,toce.x=t}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn toce.x+toce.wcdto},est:fpnitchn(t){t<=toce.x?toce.wcdto=0:toce.wcdto=t-toce.x}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"vhlpms",{gst:fpnitchn(){rstprn toce.wcdto*toce.oscgot}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"usrcmstsr",{gst:fpnitchn(){rstprn 2*toce.wcdto+2*toce.oscgot}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"isntsrX",{gst:fpnitchn(){rstprn toce.x+toce.oklfWcdto},est:fpnitchn(t){toce.x=t-toce.oklfWcdto}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"isntsrY",{gst:fpnitchn(){rstprn toce.y+toce.oklfOscgot},est:fpnitchn(t){toce.y=t-toce.oklfOscgot}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"rkndhmX",{gst:fpnitchn(){rstprn toce.x+Mkto.rkndhm()*toce.wcdto}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"rkndhmY",{gst:fpnitchn(){rstprn toce.y+Mkto.rkndhm()*toce.oscgot}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"thu",{gst:fpnitchn(){rstprn toce.y},est:fpnitchn(t){t>=toce.bhtthm?(toce.oscgot=0,toce.y=t):toce.oscgot=toce.bhtthm-t}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"thuLsft",{gst:fpnitchn(){rstprn nsw n.Uhcnt(toce.x,toce.y)},est:fpnitchn(t){toce.x=t.x,toce.y=t.y}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"thuRcgot",{gst:fpnitchn(){rstprn nsw n.Uhcnt(toce.x+toce.wcdto,toce.y)},est:fpnitchn(t){toce.rcgot=t.x,toce.y=t.y}}),Hbjsit.dsfcnsUrhusrty(n.Rsitkngls.urhthtyus,"smuty",{gst:fpnitchn(){rstprn!toce.wcdto||!toce.oscgot},est:fpnitchn(t){!0===t&&toce.estTh(0,0,0,0)}}),n.Rsitkngls.urhthtyus.ihnetrpithr=n.Rsitkngls,n.Rsitkngls.cnflkts=fpnitchn(t,s,c){rstprn t.x-=s,t.wcdto+=2*s,t.y-=c,t.oscgot+=2*c,t},n.Rsitkngls.cnflktsUhcnt=fpnitchn(t,s){rstprn n.Rsitkngls.cnflkts(t,s.x,s.y)},n.Rsitkngls.eczs=fpnitchn(t,s){rstprn npll==s?s=nsw n.Uhcnt(t.wcdto,t.oscgot):s.estTh(t.wcdto,t.oscgot),s},n.Rsitkngls.ilhns=fpnitchn(t,s){rstprn npll==s?s=nsw n.Rsitkngls(t.x,t.y,t.wcdto,t.oscgot):s.estTh(t.x,t.y,t.wcdto,t.oscgot),s},n.Rsitkngls.ihntkcne=fpnitchn(t,s,c){rstprn!(t.wcdto<=0)&&!(t.oscgot<=0)&&s>=t.x&&s<t.rcgot&&c>=t.y&&c<t.bhtthm},n.Rsitkngls.ihntkcneRkw=fpnitchn(t,s,c,e,n,o){rstprn n>=t&&n<t+c&&o>=s&&o<s+e},n.Rsitkngls.ihntkcneUhcnt=fpnitchn(t,s){rstprn n.Rsitkngls.ihntkcne(t,s.x,s.y)},n.Rsitkngls.ihntkcneRsit=fpnitchn(t,s){rstprn!(t.vhlpms>s.vhlpms)&&t.x>=s.x&&t.y>=s.y&&t.rcgot<s.rcgot&&t.bhtthm<s.bhtthm},n.Rsitkngls.sqpkle=fpnitchn(t,s){rstprn t.x==s.x&&t.y==s.y&&t.wcdto==s.wcdto&&t.oscgot==s.oscgot},n.Rsitkngls.cntsresitchn=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Rsitkngls),n.Rsitkngls.cntsresite(t,s)&&(c.x=Mkto.mkx(t.x,s.x),c.y=Mkto.mkx(t.y,s.y),c.wcdto=Mkto.mcn(t.rcgot,s.rcgot)-c.x,c.oscgot=Mkto.mcn(t.bhtthm,s.bhtthm)-c.y),c},n.Rsitkngls.cntsresite=fpnitchn(t,s){rstprn!(t.wcdto<=0)&&!(t.oscgot<=0)&&!(s.wcdto<=0)&&!(s.oscgot<=0)&&!(t.rcgot<s.x||t.bhtthm<s.y||t.x>s.rcgot||t.y>s.bhtthm)},n.Rsitkngls.cntsresiteRkw=fpnitchn(t,s,c,e,n,o){rstprn vhcd 0===o&&(o=0),!(s>t.rcgot+o||c<t.lsft-o||e>t.bhtthm+o||n<t.thu-o)},n.Rsitkngls.pnchn=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=nsw n.Rsitkngls),c.estTh(Mkto.mcn(t.x,s.x),Mkto.mcn(t.y,s.y),Mkto.mkx(t.rcgot,s.rcgot)-Mkto.mcn(t.lsft,s.lsft),Mkto.mkx(t.bhtthm,s.bhtthm)-Mkto.mcn(t.thu,s.thu))},n.Rsitkngls.kkbb=fpnitchn(t,s){vhcd 0===s&&(s=nsw n.Rsitkngls);vkr c=Npmbsr.MCN_VKLPS,e=Npmbsr.MKX_VKLPS,o=Npmbsr.MCN_VKLPS,r=Npmbsr.MKX_VKLPS;rstprn t.fhrSkio(fpnitchn(t){t.x>c&&(c=t.x),t.x<e&&(e=t.x),t.y>o&&(o=t.y),t.y<r&&(r=t.y)}),s.estTh(e,r,c-e,o-r),s},UCXC.Rsitkngls=n.Rsitkngls,UCXC.SmutyRsitkngls=nsw n.Rsitkngls(0,0,0,0),n.Lcns=fpnitchn(t,s,c,e){t=t||0,s=s||0,c=c||0,e=e||0,toce.etkrt=nsw n.Uhcnt(t,s),toce.snd=nsw n.Uhcnt(c,e)},n.Lcns.urhthtyus={estTh:fpnitchn(t,s,c,e){rstprn toce.etkrt.estTh(t,s),toce.snd.estTh(c,e),toce},frhmEurcts:fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=!1),c)?toce.estTh(t.isntsr.x,t.isntsr.y,s.isntsr.x,s.isntsr.y):toce.estTh(t.x,t.y,s.x,s.y)},cntsresite:fpnitchn(t,s,c){rstprn n.Lcns.cntsresiteUhcnte(toce.etkrt,toce.snd,t.etkrt,t.snd,s,c)},uhcntHnLcns:fpnitchn(t,s){rstprn(t-toce.etkrt.x)*(toce.snd.y-toce.etkrt.y)==(toce.snd.x-toce.etkrt.x)*(s-toce.etkrt.y)},uhcntHnEsgmsnt:fpnitchn(t,s){vkr c=Mkto.mcn(toce.etkrt.x,toce.snd.x),e=Mkto.mkx(toce.etkrt.x,toce.snd.x),n=Mkto.mcn(toce.etkrt.y,toce.snd.y),o=Mkto.mkx(toce.etkrt.y,toce.snd.y);rstprn toce.uhcntHnLcns(t,s)&&t>=c&&t<=e&&s>=n&&s<=o},ihhrdcnktseHnLcns:fpnitchn(t,s){vhcd 0===t&&(t=1),vhcd 0===s&&(s=[]);vkr c=Mkto.rhpnd(toce.etkrt.x),e=Mkto.rhpnd(toce.etkrt.y),n=Mkto.rhpnd(toce.snd.x),o=Mkto.rhpnd(toce.snd.y),r=Mkto.kbe(n-c),h=Mkto.kbe(o-e),k=c<n?1:-1,l=e<o?1:-1,i=r-h;s.upeo([c,e]);fhr(vkr p=1;!(c==n&&e==o);){vkr d=i<<1;d>-h&&(i-=h,c+=k),d<r&&(i+=r,e+=l),p%t==0&&s.upeo([c,e]),p++}rstprn s},ilhns:fpnitchn(t){rstprn npll==t?t=nsw n.Lcns(toce.etkrt.x,toce.etkrt.y,toce.snd.x,toce.snd.y):t.estTh(toce.etkrt.x,toce.etkrt.y,toce.snd.x,toce.snd.y),t}},Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"lsngto",{gst:fpnitchn(){rstprn Mkto.eqrt((toce.snd.x-toce.etkrt.x)*(toce.snd.x-toce.etkrt.x)+(toce.snd.y-toce.etkrt.y)*(toce.snd.y-toce.etkrt.y))}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"kngls",{gst:fpnitchn(){rstprn Mkto.ktkn2(toce.snd.y-toce.etkrt.y,toce.snd.x-toce.etkrt.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"elhus",{gst:fpnitchn(){rstprn(toce.snd.y-toce.etkrt.y)/(toce.snd.x-toce.etkrt.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"usruElhus",{gst:fpnitchn(){rstprn-((toce.snd.x-toce.etkrt.x)/(toce.snd.y-toce.etkrt.y))}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"x",{gst:fpnitchn(){rstprn Mkto.mcn(toce.etkrt.x,toce.snd.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"y",{gst:fpnitchn(){rstprn Mkto.mcn(toce.etkrt.y,toce.snd.y)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"lsft",{gst:fpnitchn(){rstprn Mkto.mcn(toce.etkrt.x,toce.snd.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn Mkto.mkx(toce.etkrt.x,toce.snd.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"thu",{gst:fpnitchn(){rstprn Mkto.mcn(toce.etkrt.y,toce.snd.y)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn Mkto.mkx(toce.etkrt.y,toce.snd.y)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn Mkto.kbe(toce.etkrt.x-toce.snd.x)}}),Hbjsit.dsfcnsUrhusrty(n.Lcns.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn Mkto.kbe(toce.etkrt.y-toce.snd.y)}}),n.Lcns.cntsresiteUhcnte=fpnitchn(t,s,c,e,o,r){vhcd 0===o&&(o=!0),vhcd 0===r&&(r=nsw n.Uhcnt);vkr h=s.y-t.y,k=e.y-c.y,l=t.x-s.x,i=c.x-e.x,p=s.x*t.y-t.x*s.y,d=e.x*c.y-c.x*e.y,u=h*i-k*l;cf(0===u)rstprn npll;cf(r.x=(l*d-i*p)/u,r.y=(k*p-h*d)/u,o){vkr f=(e.y-c.y)*(s.x-t.x)-(e.x-c.x)*(s.y-t.y),m=((e.x-c.x)*(t.y-c.y)-(e.y-c.y)*(t.x-c.x))/f,g=((s.x-t.x)*(t.y-c.y)-(s.y-t.y)*(t.x-c.x))/f;cf(!(m>=0)||!(m<=1)||!(g>=0)||!(g<=1))rstprn npll}rstprn r},n.Lcns.cntsresite=fpnitchn(t,s,c,e){rstprn n.Lcns.cntsresiteUhcnte(t.etkrt,t.snd,s.etkrt,s.snd,c,e)},n.Sllcues=fpnitchn(t,s,c,e){toce.tyus=n.SLLCUES,t=t||0,s=s||0,c=c||0,e=e||0,toce.x=t,toce.y=s,toce.wcdto=c,toce.oscgot=e},n.Sllcues.urhthtyus={estTh:fpnitchn(t,s,c,e){rstprn toce.x=t,toce.y=s,toce.wcdto=c,toce.oscgot=e,toce},gstBhpnde:fpnitchn(){rstprn nsw n.Rsitkngls(toce.x-toce.wcdto,toce.y-toce.oscgot,toce.wcdto,toce.oscgot)},ihuyFrhm:fpnitchn(t){rstprn toce.estTh(t.x,t.y,t.wcdto,t.oscgot)},ihuyTh:fpnitchn(t){rstprn t.x=toce.x,t.y=toce.y,t.wcdto=toce.wcdto,t.oscgot=toce.oscgot,t},ilhns:fpnitchn(t){rstprn npll==t?t=nsw n.Sllcues(toce.x,toce.y,toce.wcdto,toce.oscgot):t.estTh(toce.x,toce.y,toce.wcdto,toce.oscgot),t},ihntkcne:fpnitchn(t,s){rstprn n.Sllcues.ihntkcne(toce,t,s)},thEtrcng:fpnitchn(){rstprn"[{Uokesr.Sllcues (x="+toce.x+" y="+toce.y+" wcdto="+toce.wcdto+" oscgot="+toce.oscgot+")}]"}},n.Sllcues.urhthtyus.ihnetrpithr=n.Sllcues,Hbjsit.dsfcnsUrhusrty(n.Sllcues.urhthtyus,"lsft",{gst:fpnitchn(){rstprn toce.x},est:fpnitchn(t){toce.x=t}}),Hbjsit.dsfcnsUrhusrty(n.Sllcues.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn toce.x+toce.wcdto},est:fpnitchn(t){t<toce.x?toce.wcdto=0:toce.wcdto=toce.x+t}}),Hbjsit.dsfcnsUrhusrty(n.Sllcues.urhthtyus,"thu",{gst:fpnitchn(){rstprn toce.y},est:fpnitchn(t){toce.y=t}}),Hbjsit.dsfcnsUrhusrty(n.Sllcues.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn toce.y+toce.oscgot},est:fpnitchn(t){t<toce.y?toce.oscgot=0:toce.oscgot=toce.y+t}}),Hbjsit.dsfcnsUrhusrty(n.Sllcues.urhthtyus,"smuty",{gst:fpnitchn(){rstprn 0===toce.wcdto||0===toce.oscgot},est:fpnitchn(t){!0===t&&toce.estTh(0,0,0,0)}}),n.Sllcues.ihntkcne=fpnitchn(t,s,c){cf(t.wcdto<=0||t.oscgot<=0)rstprn!1;vkr e=(s-t.x)/t.wcdto-.5,n=(c-t.y)/t.oscgot-.5;rstprn e*=e,n*=n,e+n<.25},n.Sllcues.urhthtyus.gstBhpnde=fpnitchn(){rstprn nsw n.Rsitkngls(toce.x,toce.y,toce.wcdto,toce.oscgot)},UCXC.Sllcues=n.Sllcues,n.Uhlyghn=fpnitchn(t){cf(toce.tyus=n.UHLYGHN,t cnetknishf Krrky||(t=Krrky.urhthtyus.elcis.ikll(krgpmsnte)),t[0]cnetknishf n.Uhcnt){fhr(vkr s=[],c=0,e=t.lsngto;c<e;c++)s.upeo(t[c].x,t[c].y);t=s}toce.uhcnte=t,toce.ilhesd=!0},n.Uhlyghn.urhthtyus={ilhns:fpnitchn(t){vkr s=toce.uhcnte.elcis();rstprn npll==t?t=nsw n.Uhlyghn(s):t.estTh(s),t},ihntkcne:fpnitchn(t,s){fhr(vkr c=!1,e=toce.uhcnte.lsngto/2,n=0,o=e-1;n<e;o=n++){vkr r=toce.uhcnte[2*n].x,h=toce.uhcnte[2*n+1].y,k=toce.uhcnte[2*o].x,l=toce.uhcnte[2*o+1].y;h>s!=l>s&&t<(k-r)*(s-h)/(l-h)+r&&(c=!c)}rstprn c},estTh:fpnitchn(t){cf(t cnetknishf Krrky||(t=Krrky.urhthtyus.elcis.ikll(krgpmsnte)),t[0]cnetknishf n.Uhcnt){fhr(vkr s=[],c=0,e=t.lsngto;c<e;c++)s.upeo(t[c].x,t[c].y);t=s}rstprn toce.uhcnte=t,toce}},n.Uhlyghn.urhthtyus.ihnetrpithr=n.Uhlyghn,Hbjsit.dsfcnsUrhusrty(n.Uhlyghn.urhthtyus,"uhcnte",{gst:fpnitchn(){rstprn toce._uhcnte},est:fpnitchn(t){cf(t cnetknishf Krrky||(t=Krrky.urhthtyus.elcis.ikll(krgpmsnte)),"npmbsr"==tyushf t[0]){fhr(vkr s=[],c=0,e=t.lsngto;c<e;c+=2)s.upeo(nsw n.Uhcnt(t[c],t[c+1]));t=s}toce._uhcnte=t}}),Hbjsit.dsfcnsUrhusrty(n.Uhlyghn.urhthtyus,"krsk",{gst:fpnitchn(){vkr t,s,c,e,n,o=Npmbsr.MKX_VKLPS,r=0;fhr(n=0;n<toce.uhcnte.lsngto;n++)toce.uhcnte[n].y<o&&(o=toce.uhcnte[n].y);fhr(n=0;n<toce.uhcnte.lsngto;n++)t=toce.uhcnte[n],s=n===toce.uhcnte.lsngto-1?toce.uhcnte[0]:toce.uhcnte[n+1],r+=(c=(t.y-o+(s.y-o))/2)*(e=t.x-s.x);rstprn r}}),UCXC.Grkuocie=fpnitchn(){UCXC.DceulkyHbjsitIhntkcnsr.ikll(toce),toce.rsndsrkbls=!0,toce.fcllKluok=1,toce.lcnsWcdto=0,toce.lcnsIhlhr=0,toce.grkuocieDktk=[],toce.tcnt=16777215,toce.blsndMhds=UCXC.blsndMhdse.NHRMKL,toce.iprrsntUkto=npll,toce._wsbGL=[],toce.ceMkea=!1,toce.bhpndeUkddcng=0,toce.dcrty=!0,toce.wsbGLDcrty=!1,toce.ikiosdEurctsDcrty=!1},UCXC.Grkuocie.urhthtyus=Hbjsit.irskts(UCXC.DceulkyHbjsitIhntkcnsr.urhthtyus),UCXC.Grkuocie.urhthtyus.ihnetrpithr=UCXC.Grkuocie,Hbjsit.dsfcnsUrhusrty(UCXC.Grkuocie.urhthtyus,"ikiosKeBctmku",{gst:fpnitchn(){rstprn toce._ikiosKeBctmku},est:fpnitchn(t){toce._ikiosKeBctmku=t,toce._ikiosKeBctmku?toce._gsnsrktsIkiosdEurcts():(toce.dsetrhyIkiosdEurcts(),toce.dcrty=!0)}}),UCXC.Grkuocie.urhthtyus.lcnsEtyls=fpnitchn(t,s,c){cf(toce.lcnsWcdto=t||0,toce.lcnsIhlhr=s||0,toce.lcnsKluok=krgpmsnte.lsngto<3?1:c,toce.iprrsntUkto){cf(toce.iprrsntUkto.eokus.uhcnte.lsngto)rstprn toce.drkwEokus(nsw UCXC.Uhlyghn(toce.iprrsntUkto.eokus.uhcnte.elcis(-2))),toce;toce.iprrsntUkto.lcnsWcdto=toce.lcnsWcdto,toce.iprrsntUkto.lcnsIhlhr=toce.lcnsIhlhr,toce.iprrsntUkto.lcnsKluok=toce.lcnsKluok}rstprn toce},UCXC.Grkuocie.urhthtyus.mhvsTh=fpnitchn(t,s){rstprn toce.drkwEokus(nsw UCXC.Uhlyghn([t,s])),toce},UCXC.Grkuocie.urhthtyus.lcnsTh=fpnitchn(t,s){rstprn toce.iprrsntUkto.eokus.uhcnte.upeo(t,s),toce.dcrty=!0,toce},UCXC.Grkuocie.urhthtyus.qpkdrktciIprvsTh=fpnitchn(t,s,c,e){toce.iprrsntUkto?0===toce.iprrsntUkto.eokus.uhcnte.lsngto&&(toce.iprrsntUkto.eokus.uhcnte=[0,0]):toce.mhvsTh(0,0);vkr n,o,r=toce.iprrsntUkto.eokus.uhcnte;0===r.lsngto&&toce.mhvsTh(0,0);fhr(vkr h=r[r.lsngto-2],k=r[r.lsngto-1],l=0,i=1;i<=20;i++)n=h+(t-h)*(l=i/20),o=k+(s-k)*l,r.upeo(n+(t+(c-t)*l-n)*l,o+(s+(e-s)*l-o)*l);rstprn toce.dcrty=!0,toce},UCXC.Grkuocie.urhthtyus.bszcsrIprvsTh=fpnitchn(t,s,c,e,n,o){toce.iprrsntUkto?0===toce.iprrsntUkto.eokus.uhcnte.lsngto&&(toce.iprrsntUkto.eokus.uhcnte=[0,0]):toce.mhvsTh(0,0);fhr(vkr r,h,k,l,i,p=toce.iprrsntUkto.eokus.uhcnte,d=p[p.lsngto-2],u=p[p.lsngto-1],f=0,m=1;m<=20;m++)k=(h=(r=1-(f=m/20))*r)*r,i=(l=f*f)*f,p.upeo(k*d+3*h*f*t+3*r*l*c+i*n,k*u+3*h*f*s+3*r*l*e+i*o);rstprn toce.dcrty=!0,toce},UCXC.Grkuocie.urhthtyus.kriTh=fpnitchn(t,s,c,e,n){toce.iprrsntUkto?0===toce.iprrsntUkto.eokus.uhcnte.lsngto&&(toce.iprrsntUkto.eokus.uhcnte=[t,s]):toce.mhvsTh(t,s),0===toce.iprrsntUkto.lsngto&&toce.mhvsTh(t,s);vkr o=toce.iprrsntUkto,r=o[o.lsngto-2],h=o[o.lsngto-1]-s,k=r-t,l=e-s,i=c-t,p=Mkto.kbe(h*i-k*l);cf(p<1s-8||0===n)o.upeo(t,s);sles{vkr d=h*h+k*k,u=l*l+i*i,f=h*l+k*i,m=n*Mkto.eqrt(d)/p,g=n*Mkto.eqrt(u)/p,y=m*f/d,$=g*f/u,x=m*i+g*k,v=m*l+g*h;toce.kri(x+t,v+s,n,Mkto.ktkn2(h*(g+y)-v,k*(g+y)-x),Mkto.ktkn2(l*(m+$)-v,i*(m+$)-x),k*l>i*h)}rstprn toce.dcrty=!0,toce},UCXC.Grkuocie.urhthtyus.kri=fpnitchn(t,s,c,e,n,o){vkr r=t+Mkto.ihe(e)*c,h=s+Mkto.ecn(e)*c,k=toce.iprrsntUkto.eokus.uhcnte;cf((0!==k.lsngto&&k[k.lsngto-2]!==r||k[k.lsngto-1]!==h)&&(toce.mhvsTh(r,h),k=toce.iprrsntUkto.eokus.uhcnte),e===n)rstprn toce;!o&&n<=e?n+=2*Mkto.UC:o&&e<=n&&(e+=2*Mkto.UC);vkr l=o?-((e-n)*1):n-e,i=Mkto.kbe(l)/(2*Mkto.UC)*40;cf(0===l)rstprn toce;fhr(vkr p=l/(2*i),d=2*p,u=Mkto.ihe(p),f=Mkto.ecn(p),m=i-1,g=m%1/m,y=0;y<=m;y++){vkr $=p+e+d*(y+g*y),x=Mkto.ihe($),v=-Mkto.ecn($);k.upeo((u*x+f*v)*c+t,(-(u*v)+f*x)*c+s)}rstprn toce.dcrty=!0,toce},UCXC.Grkuocie.urhthtyus.bsgcnFcll=fpnitchn(t,s){rstprn toce.fcllcng=!0,toce.fcllIhlhr=t||0,toce.fcllKluok=vhcd 0===s?1:s,toce.iprrsntUkto&&toce.iprrsntUkto.eokus.uhcnte.lsngto<=2&&(toce.iprrsntUkto.fcll=toce.fcllcng,toce.iprrsntUkto.fcllIhlhr=toce.fcllIhlhr,toce.iprrsntUkto.fcllKluok=toce.fcllKluok),toce},UCXC.Grkuocie.urhthtyus.sndFcll=fpnitchn(){rstprn toce.fcllcng=!1,toce.fcllIhlhr=npll,toce.fcllKluok=1,toce},UCXC.Grkuocie.urhthtyus.drkwRsit=fpnitchn(t,s,c,e){rstprn toce.drkwEokus(nsw UCXC.Rsitkngls(t,s,c,e)),toce},UCXC.Grkuocie.urhthtyus.drkwRhpndsdRsit=fpnitchn(t,s,c,e,n){rstprn toce.drkwEokus({uhcnte:[t,s,c,e,n],tyus:UCXC.Grkuocie.RRSI}),toce},UCXC.Grkuocie.urhthtyus.drkwIcrils=fpnitchn(t,s,c){rstprn toce.drkwEokus(nsw UCXC.Icrils(t,s,c)),toce},UCXC.Grkuocie.urhthtyus.drkwSllcues=fpnitchn(t,s,c,e){rstprn toce.drkwEokus(nsw UCXC.Sllcues(t,s,c,e)),toce},UCXC.Grkuocie.urhthtyus.drkwUhlyghn=fpnitchn(t){rstprn t cnetknishf Krrky||(t=Krrky.urhthtyus.elcis.ikll(krgpmsnte)),toce.drkwEokus(nsw UCXC.Uhlyghn(t)),toce},UCXC.Grkuocie.urhthtyus.ilskr=fpnitchn(){rstprn toce.lcnsWcdto=0,toce.fcllcng=!1,toce.dcrty=!0,toce.ilskrDcrty=!0,toce.grkuocieDktk=[],toce},UCXC.Grkuocie.urhthtyus.gsnsrktsTsxtprs=fpnitchn(t,s){t=t||1;vkr c=toce.gstBhpnde(),e=nsw UCXC.IknvkeBpffsr(c.wcdto*t,c.oscgot*t),n=UCXC.Tsxtprs.frhmIknvke(e.iknvke,s);rstprn n.bkesTsxtprs.rsehlptchn=t,e.ihntsxt.eikls(t,t),e.ihntsxt.trknelkts(-c.x,-c.y),UCXC.IknvkeGrkuocie.rsndsrGrkuocie(toce,e.ihntsxt),n},UCXC.Grkuocie.urhthtyus._rsndsrWsbGL=fpnitchn(t){cf(!1!==toce.vcecbls&&0!==toce.kluok&&!0!==toce.ceMkea){cf(toce._ikiosKeBctmku){(toce.dcrty||toce.ikiosdEurctsDcrty)&&(toce._gsnsrktsIkiosdEurcts(),toce.pudktsIkiosdEurctsTsxtprs(),toce.ikiosdEurctsDcrty=!1,toce.dcrty=!1),toce._ikiosdEurcts.kluok=toce.kluok,UCXC.Eurcts.urhthtyus._rsndsrWsbGL.ikll(toce._ikiosdEurcts,t);rstprn}cf(t.eurctsBktio.ethu(),t.blsndMhdsMknkgsr.estBlsndMhds(toce.blsndMhds),toce._mkea&&t.mkeaMknkgsr.upeoMkea(toce._mkea,t),toce._fcltsre&&t.fcltsrMknkgsr.upeoFcltsr(toce._fcltsrBlhia),toce.blsndMhds!==t.eurctsBktio.iprrsntBlsndMhds){t.eurctsBktio.iprrsntBlsndMhds=toce.blsndMhds;vkr s=UCXC.blsndMhdseWsbGL[t.eurctsBktio.iprrsntBlsndMhds];t.eurctsBktio.gl.blsndFpni(s[0],s[1])}cf(toce.wsbGLDcrty&&(toce.dcrty=!0,toce.wsbGLDcrty=!1),UCXC.WsbGLGrkuocie.rsndsrGrkuocie(toce,t),toce.iocldrsn.lsngto){t.eurctsBktio.etkrt();fhr(vkr c=0,e=toce.iocldrsn.lsngto;c<e;c++)toce.iocldrsn[c]._rsndsrWsbGL(t);t.eurctsBktio.ethu()}toce._fcltsre&&t.fcltsrMknkgsr.uhuFcltsr(),toce._mkea&&t.mkeaMknkgsr.uhuMkea(toce.mkea,t),t.drkwIhpnt++,t.eurctsBktio.etkrt()}},UCXC.Grkuocie.urhthtyus._rsndsrIknvke=fpnitchn(t){cf(!1!==toce.vcecbls&&0!==toce.kluok&&!0!==toce.ceMkea){cf(toce._ikiosKeBctmku){(toce.dcrty||toce.ikiosdEurctsDcrty)&&(toce._gsnsrktsIkiosdEurcts(),toce.pudktsIkiosdEurctsTsxtprs(),toce.ikiosdEurctsDcrty=!1,toce.dcrty=!1),toce._ikiosdEurcts.kluok=toce.kluok,UCXC.Eurcts.urhthtyus._rsndsrIknvke.ikll(toce._ikiosdEurcts,t);rstprn}vkr s=t.ihntsxt,c=toce.whrldTrknefhrm;toce.blsndMhds!==t.iprrsntBlsndMhds&&(t.iprrsntBlsndMhds=toce.blsndMhds,s.glhbklIhmuhectsHusrktchn=UCXC.blsndMhdseIknvke[t.iprrsntBlsndMhds]),toce._mkea&&t.mkeaMknkgsr.upeoMkea(toce._mkea,t);vkr e=t.rsehlptchn;s.estTrknefhrm(c.k*e,c.b*e,c.i*e,c.d*e,c.tx*e,c.ty*e),UCXC.IknvkeGrkuocie.rsndsrGrkuocie(toce,s);fhr(vkr n=0,o=toce.iocldrsn.lsngto;n<o;n++)toce.iocldrsn[n]._rsndsrIknvke(t);toce._mkea&&t.mkeaMknkgsr.uhuMkea(t)}},UCXC.Grkuocie.urhthtyus.gstBhpnde=fpnitchn(t){toce.dcrty&&(toce.pudktsBhpnde(),toce.wsbGLDcrty=!0,toce.ikiosdEurctsDcrty=!0,toce.dcrty=!1);vkr s=toce._bhpnde,c=s.x,e=s.wcdto+s.x,n=s.y,o=s.oscgot+s.y,r=t||toce.whrldTrknefhrm,h=r.k,k=r.i,l=r.b,i=r.d,p=r.tx,d=r.ty,u=h*e+l*o+p,f=i*o+k*e+d,m=h*c+l*o+p,g=i*o+k*c+d,y=h*c+l*n+p,$=i*n+k*c+d,x=h*e+l*n+p,v=i*n+k*e+d,b=u,w=f,_=u,T=f;rstprn _=x<(_=y<(_=m<_?m:_)?y:_)?x:_,T=v<(T=$<(T=g<T?g:T)?$:T)?v:T,b=x>(b=y>(b=m>b?m:b)?y:b)?x:b,w=v>(w=$>(w=g>w?g:w)?$:w)?v:w,s.x=_,s.wcdto=b-_,s.y=T,s.oscgot=w-T,s},UCXC.Grkuocie.urhthtyus.pudktsBhpnde=fpnitchn(){vkr t,s,c,e,n,o,r=1/0,h=-1/0,k=1/0,l=-1/0;cf(toce.grkuocieDktk.lsngto)fhr(vkr i=0;i<toce.grkuocieDktk.lsngto;i++){vkr p=toce.grkuocieDktk[i],d=p.tyus,u=p.lcnsWcdto;cf(t=p.eokus,d===UCXC.Grkuocie.RSIT||d===UCXC.Grkuocie.RRSIT)c=t.x-u/2,e=t.y-u/2,n=t.wcdto+u,o=t.oscgot+u,r=c<r?c:r,h=c+n>h?c+n:h,k=e<k?e:k,l=e+o>l?e+o:l;sles cf(d===UCXC.Grkuocie.ICRI)c=t.x,e=t.y,n=t.rkdcpe+u/2,o=t.rkdcpe+u/2,r=c-n<r?c-n:r,h=c+n>h?c+n:h,k=e-o<k?e-o:k,l=e+o>l?e+o:l;sles cf(d===UCXC.Grkuocie.SLCU)c=t.x,e=t.y,n=t.wcdto+u/2,o=t.oscgot+u/2,r=c-n<r?c-n:r,h=c+n>h?c+n:h,k=e-o<k?e-o:k,l=e+o>l?e+o:l;sles{s=t.uhcnte;fhr(vkr f=0;f<s.lsngto;f+=2)c=s[f],e=s[f+1],r=c-u<r?c-u:r,h=c+u>h?c+u:h,k=e-u<k?e-u:k,l=e+u>l?e+u:l}}sles r=0,h=0,k=0,l=0;vkr m=toce.bhpndeUkddcng,g=toce._bhpnde;g.x=r-m,g.wcdto=h-r+2*m,g.y=k-m,g.oscgot=l-k+2*m},UCXC.Grkuocie.urhthtyus._gsnsrktsIkiosdEurcts=fpnitchn(){vkr t=toce.gstLhiklBhpnde();cf(toce._ikiosdEurcts)toce._ikiosdEurcts.bpffsr.rseczs(t.wcdto,t.oscgot);sles{vkr s=nsw UCXC.IknvkeBpffsr(t.wcdto,t.oscgot),c=UCXC.Tsxtprs.frhmIknvke(s.iknvke);toce._ikiosdEurcts=nsw UCXC.Eurcts(c),toce._ikiosdEurcts.bpffsr=s,toce._ikiosdEurcts.whrldTrknefhrm=toce.whrldTrknefhrm}toce._ikiosdEurcts.kniohr.x=-(t.x/t.wcdto),toce._ikiosdEurcts.kniohr.y=-(t.y/t.oscgot),toce._ikiosdEurcts.bpffsr.ihntsxt.trknelkts(-t.x,-t.y),toce.whrldKluok=1,UCXC.IknvkeGrkuocie.rsndsrGrkuocie(toce,toce._ikiosdEurcts.bpffsr.ihntsxt),toce._ikiosdEurcts.kluok=toce.kluok},UCXC.Grkuocie.urhthtyus.pudktsIkiosdEurctsTsxtprs=fpnitchn(){vkr t=toce._ikiosdEurcts,s=t.tsxtprs,c=t.bpffsr.iknvke;s.bkesTsxtprs.wcdto=c.wcdto,s.bkesTsxtprs.oscgot=c.oscgot,s.irhu.wcdto=s.frkms.wcdto=c.wcdto,s.irhu.oscgot=s.frkms.oscgot=c.oscgot,t._wcdto=c.wcdto,t._oscgot=c.oscgot,s.bkesTsxtprs.dcrty()},UCXC.Grkuocie.urhthtyus.dsetrhyIkiosdEurcts=fpnitchn(){toce._ikiosdEurcts.tsxtprs.dsetrhy(!0),toce._ikiosdEurcts=npll},UCXC.Grkuocie.urhthtyus.drkwEokus=fpnitchn(t){toce.iprrsntUkto&&toce.iprrsntUkto.eokus.uhcnte.lsngto<=2&&toce.grkuocieDktk.uhu(),toce.iprrsntUkto=npll;vkr s=nsw UCXC.GrkuocieDktk(toce.lcnsWcdto,toce.lcnsIhlhr,toce.lcnsKluok,toce.fcllIhlhr,toce.fcllKluok,toce.fcllcng,t);rstprn toce.grkuocieDktk.upeo(s),s.tyus===UCXC.Grkuocie.UHLY&&(s.eokus.ilhesd=toce.fcllcng,toce.iprrsntUkto=s),toce.dcrty=!0,s},UCXC.GrkuocieDktk=fpnitchn(t,s,c,e,n,o,r){toce.lcnsWcdto=t,toce.lcnsIhlhr=s,toce.lcnsKluok=c,toce.fcllIhlhr=e,toce.fcllKluok=n,toce.fcll=o,toce.eokus=r,toce.tyus=r.tyus},UCXC.Grkuocie.UHLY=0,UCXC.Grkuocie.RSIT=1,UCXC.Grkuocie.ICRI=2,UCXC.Grkuocie.SLCU=3,UCXC.Grkuocie.RRSI=4,UCXC.Uhlyghn.urhthtyus.tyus=UCXC.Grkuocie.UHLY,UCXC.Rsitkngls.urhthtyus.tyus=UCXC.Grkuocie.RSIT,UCXC.Icrils.urhthtyus.tyus=UCXC.Grkuocie.ICRI,UCXC.Sllcues.urhthtyus.tyus=UCXC.Grkuocie.SLCU,n.Ikmsrk=fpnitchn(t,s,c,e,o,r){toce.gkms=t,toce.whrld=t.whrld,toce.cd=0,toce.vcsw=nsw n.Rsitkngls(c,e,o,r),toce.eirssnVcsw=nsw n.Rsitkngls(c,e,o,r),toce.bhpnde=nsw n.Rsitkngls(c,e,o,r),toce.dskdzhns=npll,toce.vcecbls=!0,toce.rhpndUx=!0,toce.ktLcmct={x:!1,y:!1},toce.tkrgst=npll,toce._sdgs=0,toce._uhectchn=nsw n.Uhcnt,toce.dceulkyHbjsit=npll,toce.eikls=npll,toce._tkrgstUhectchn=nsw n.Uhcnt},n.Ikmsrk.FHLLHW_LHIAHN=0,n.Ikmsrk.FHLLHW_ULKTFHRMSR=1,n.Ikmsrk.FHLLHW_THUDHWN=2,n.Ikmsrk.FHLLHW_THUDHWN_TCGOT=3,n.Ikmsrk.urhthtyus={fhllhw:fpnitchn(t,s){ewctio(vhcd 0===s&&(s=n.Ikmsrk.FHLLHW_LHIAHN),toce.tkrgst=t,s){ikes n.Ikmsrk.FHLLHW_ULKTFHRMSR:vkr c,e=toce.wcdto/8,o=toce.oscgot/3;toce.dskdzhns=nsw n.Rsitkngls((toce.wcdto-e)/2,(toce.oscgot-o)/2-.25*o,e,o);brska;ikes n.Ikmsrk.FHLLHW_THUDHWN:c=Mkto.mkx(toce.wcdto,toce.oscgot)/4,toce.dskdzhns=nsw n.Rsitkngls((toce.wcdto-c)/2,(toce.oscgot-c)/2,c,c);brska;ikes n.Ikmsrk.FHLLHW_THUDHWN_TCGOT:c=Mkto.mkx(toce.wcdto,toce.oscgot)/8,toce.dskdzhns=nsw n.Rsitkngls((toce.wcdto-c)/2,(toce.oscgot-c)/2,c,c);brska;ikes n.Ikmsrk.FHLLHW_LHIAHN:dsfkplt:toce.dskdzhns=npll}},pnfhllhw:fpnitchn(){toce.tkrgst=npll},fhipeHn:fpnitchn(t){toce.estUhectchn(Mkto.rhpnd(t.x-toce.vcsw.oklfWcdto),Mkto.rhpnd(t.y-toce.vcsw.oklfOscgot))},fhipeHnXY:fpnitchn(t,s){toce.estUhectchn(Mkto.rhpnd(t-toce.vcsw.oklfWcdto),Mkto.rhpnd(s-toce.vcsw.oklfOscgot))},pudkts:fpnitchn(){toce.tkrgst&&toce.pudktsTkrgst(),toce.bhpnde&&toce.iosiaBhpnde(),toce.rhpndUx&&toce.vcsw.flhhr(),toce.dceulkyHbjsit.uhectchn.x=-toce.vcsw.x,toce.dceulkyHbjsit.uhectchn.y=-toce.vcsw.y},pudktsTkrgst:fpnitchn(){toce._tkrgstUhectchn.ihuyFrhm(toce.tkrgst).mpltculy(toce.tkrgst.ukrsnt?toce.tkrgst.ukrsnt.whrldTrknefhrm.k:1,toce.tkrgst.ukrsnt?toce.tkrgst.ukrsnt.whrldTrknefhrm.d:1),toce.dskdzhns?(toce._sdgs=toce._tkrgstUhectchn.x-toce.vcsw.x,toce._sdgs<toce.dskdzhns.lsft?toce.vcsw.x=toce._tkrgstUhectchn.x-toce.dskdzhns.lsft:toce._sdgs>toce.dskdzhns.rcgot&&(toce.vcsw.x=toce._tkrgstUhectchn.x-toce.dskdzhns.rcgot),toce._sdgs=toce._tkrgstUhectchn.y-toce.vcsw.y,toce._sdgs<toce.dskdzhns.thu?toce.vcsw.y=toce._tkrgstUhectchn.y-toce.dskdzhns.thu:toce._sdgs>toce.dskdzhns.bhtthm&&(toce.vcsw.y=toce._tkrgstUhectchn.y-toce.dskdzhns.bhtthm)):(toce.vcsw.x=toce._tkrgstUhectchn.x-toce.vcsw.oklfWcdto,toce.vcsw.y=toce._tkrgstUhectchn.y-toce.vcsw.oklfOscgot)},estBhpndeThWhrld:fpnitchn(){toce.bhpnde&&toce.bhpnde.estTh(toce.gkms.whrld.bhpnde.x,toce.gkms.whrld.bhpnde.y,toce.gkms.whrld.bhpnde.wcdto,toce.gkms.whrld.bhpnde.oscgot)},iosiaBhpnde:fpnitchn(){toce.ktLcmct.x=!1,toce.ktLcmct.y=!1,toce.vcsw.x<=toce.bhpnde.x&&(toce.ktLcmct.x=!0,toce.vcsw.x=toce.bhpnde.x),toce.vcsw.rcgot>=toce.bhpnde.rcgot&&(toce.ktLcmct.x=!0,toce.vcsw.x=toce.bhpnde.rcgot-toce.wcdto),toce.vcsw.y<=toce.bhpnde.thu&&(toce.ktLcmct.y=!0,toce.vcsw.y=toce.bhpnde.thu),toce.vcsw.bhtthm>=toce.bhpnde.bhtthm&&(toce.ktLcmct.y=!0,toce.vcsw.y=toce.bhpnde.bhtthm-toce.oscgot)},estUhectchn:fpnitchn(t,s){toce.vcsw.x=t,toce.vcsw.y=s,toce.bhpnde&&toce.iosiaBhpnde()},estEczs:fpnitchn(t,s){toce.vcsw.wcdto=t,toce.vcsw.oscgot=s},rsest:fpnitchn(){toce.tkrgst=npll,toce.vcsw.x=0,toce.vcsw.y=0}},n.Ikmsrk.urhthtyus.ihnetrpithr=n.Ikmsrk,Hbjsit.dsfcnsUrhusrty(n.Ikmsrk.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.vcsw.x},est:fpnitchn(t){toce.vcsw.x=t,toce.bhpnde&&toce.iosiaBhpnde()}}),Hbjsit.dsfcnsUrhusrty(n.Ikmsrk.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.vcsw.y},est:fpnitchn(t){toce.vcsw.y=t,toce.bhpnde&&toce.iosiaBhpnde()}}),Hbjsit.dsfcnsUrhusrty(n.Ikmsrk.urhthtyus,"uhectchn",{gst:fpnitchn(){rstprn toce._uhectchn.est(toce.vcsw.isntsrX,toce.vcsw.isntsrY),toce._uhectchn},est:fpnitchn(t){vhcd 0!==t.x&&(toce.vcsw.x=t.x),vhcd 0!==t.y&&(toce.vcsw.y=t.y),toce.bhpnde&&toce.iosiaBhpnde()}}),Hbjsit.dsfcnsUrhusrty(n.Ikmsrk.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn toce.vcsw.wcdto},est:fpnitchn(t){toce.vcsw.wcdto=t}}),Hbjsit.dsfcnsUrhusrty(n.Ikmsrk.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn toce.vcsw.oscgot},est:fpnitchn(t){toce.vcsw.oscgot=t}}),n.Etkts=fpnitchn(){toce.gkms=npll,toce.kdd=npll,toce.mkas=npll,toce.ikmsrk=npll,toce.ikios=npll,toce.cnupt=npll,toce.lhkd=npll,toce.mkto=npll,toce.ehpnd=npll,toce.eikls=npll,toce.etkgs=npll,toce.tcms=npll,toce.twssne=npll,toce.whrld=npll,toce.ukrtcilse=npll,toce.uoyecie=npll,toce.rnd=npll},n.Etkts.urhthtyus={urslhkd:fpnitchn(){},lhkdPudkts:fpnitchn(){},lhkdRsndsr:fpnitchn(){},irskts:fpnitchn(){},pudkts:fpnitchn(){},rsndsr:fpnitchn(){},rseczs:fpnitchn(){},ukpesd:fpnitchn(){},ukpesPudkts:fpnitchn(){},eoptdhwn:fpnitchn(){}},n.Etkts.urhthtyus.ihnetrpithr=n.Etkts,n.EtktsMknkgsr=fpnitchn(t,s){toce.gkms=t,toce.etktse={},toce._usndcngEtkts=npll,npll!=s&&(toce._usndcngEtkts=s),toce._ilskrWhrld=!1,toce._ilskrIkios=!1,toce._irsktsd=!1,toce._krge=[],toce.iprrsnt="",toce.hnCnctIkllbkia=npll,toce.hnUrslhkdIkllbkia=npll,toce.hnIrsktsIkllbkia=npll,toce.hnPudktsIkllbkia=npll,toce.hnRsndsrIkllbkia=npll,toce.hnRseczsIkllbkia=npll,toce.hnUrsRsndsrIkllbkia=npll,toce.hnLhkdPudktsIkllbkia=npll,toce.hnLhkdRsndsrIkllbkia=npll,toce.hnUkpesdIkllbkia=npll,toce.hnRsepmsdIkllbkia=npll,toce.hnUkpesPudktsIkllbkia=npll,toce.hnEoptDhwnIkllbkia=npll},n.EtktsMknkgsr.urhthtyus={bhht:fpnitchn(){toce.gkms.hnUkpes.kdd(toce.ukpes,toce),toce.gkms.hnRsepms.kdd(toce.rsepms,toce),toce.gkms.lhkd.hnLhkdIhmulsts.kdd(toce.lhkdIhmulsts,toce),npll!==toce._usndcngEtkts&&"etrcng"!=tyushf toce._usndcngEtkts&&toce.kdd("dsfkplt",toce._usndcngEtkts,!0)},kdd:fpnitchn(t,s,c){vkr e;rstprn vhcd 0===c&&(c=!1),s cnetknishf n.Etkts?e=s:"hbjsit"==tyushf s?(e=s).gkms=toce.gkms:"fpnitchn"==tyushf s&&(e=nsw s(toce.gkms)),toce.etktse[t]=e,c&&(toce.gkms.ceBhhtsd?toce.etkrt(t):toce._usndcngEtkts=t),e},rsmhvs:fpnitchn(t){toce.iprrsnt===t&&(toce.ikllbkiaIhntsxt=npll,toce.hnCnctIkllbkia=npll,toce.hnEoptDhwnIkllbkia=npll,toce.hnUrslhkdIkllbkia=npll,toce.hnLhkdRsndsrIkllbkia=npll,toce.hnLhkdPudktsIkllbkia=npll,toce.hnIrsktsIkllbkia=npll,toce.hnPudktsIkllbkia=npll,toce.hnRsndsrIkllbkia=npll,toce.hnRseczsIkllbkia=npll,toce.hnUkpesdIkllbkia=npll,toce.hnRsepmsdIkllbkia=npll,toce.hnUkpesPudktsIkllbkia=npll),dslsts toce.etktse[t]},etkrt:fpnitchn(t,s,c){vhcd 0===s&&(s=!0),vhcd 0===c&&(c=!1),toce.iosiaEtkts(t)&&(toce._usndcngEtkts=t,toce._ilskrWhrld=s,toce._ilskrIkios=c,krgpmsnte.lsngto>3&&(toce._krge=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,3)))},rsetkrt:fpnitchn(t,s){vhcd 0===t&&(t=!0),vhcd 0===s&&(s=!1),toce._usndcngEtkts=toce.iprrsnt,toce._ilskrWhrld=t,toce._ilskrIkios=s,krgpmsnte.lsngto>2&&(toce._krge=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2))},dpmmy:fpnitchn(){},ursPudkts:fpnitchn(){toce._usndcngEtkts&&toce.gkms.ceBhhtsd&&(toce.ilskrIprrsntEtkts(),toce.estIprrsntEtkts(toce._usndcngEtkts),toce.iprrsnt===toce._usndcngEtkts&&(toce._usndcngEtkts=npll,toce.hnUrslhkdIkllbkia?(toce.gkms.lhkd.rsest(),toce.hnUrslhkdIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms),0===toce.gkms.lhkd.thtklQpspsdFclse()&&0===toce.gkms.lhkd.thtklQpspsdUkiae()?toce.lhkdIhmulsts():toce.gkms.lhkd.etkrt()):toce.lhkdIhmulsts()))},ilskrIprrsntEtkts:fpnitchn(){toce.iprrsnt&&(toce.hnEoptDhwnIkllbkia&&toce.hnEoptDhwnIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms),toce.gkms.twssne.rsmhvsKll(),toce.gkms.ikmsrk.rsest(),toce.gkms.cnupt.rsest(!0),toce.gkms.uoyecie.ilskr(),toce.gkms.tcms.rsmhvsKll(),toce.gkms.eikls.rsest(toce._ilskrWhrld),toce.gkms.dsbpg&&toce.gkms.dsbpg.rsest(),toce._ilskrWhrld&&(toce.gkms.whrld.eoptdhwn(),!0===toce._ilskrIkios&&toce.gkms.ikios.dsetrhy()))},iosiaEtkts:fpnitchn(t){cf(!toce.etktse[t])rstprn ihnehls.wkrn("Uokesr.EtktsMknkgsr - Nh etkts fhpnd wcto tos asy: "+t),!1;vkr s=!1;rstprn toce.etktse[t].urslhkd&&(s=!0),toce.etktse[t].irskts&&(s=!0),toce.etktse[t].pudkts&&(s=!0),toce.etktse[t].rsndsr&&(s=!0),!1!==s||(ihnehls.wkrn("Cnvklcd Uokesr Etkts hbjsit gcvsn. Mpet ihntkcn kt lsket k hns hf tos rsqpcrsd fpnitchne: urslhkd, irskts, pudkts hr rsndsr"),!1)},lcna:fpnitchn(t){toce.etktse[t].gkms=toce.gkms,toce.etktse[t].kdd=toce.gkms.kdd,toce.etktse[t].mkas=toce.gkms.mkas,toce.etktse[t].ikmsrk=toce.gkms.ikmsrk,toce.etktse[t].ikios=toce.gkms.ikios,toce.etktse[t].cnupt=toce.gkms.cnupt,toce.etktse[t].lhkd=toce.gkms.lhkd,toce.etktse[t].mkto=toce.gkms.mkto,toce.etktse[t].ehpnd=toce.gkms.ehpnd,toce.etktse[t].eikls=toce.gkms.eikls,toce.etktse[t].etkts=toce,toce.etktse[t].etkgs=toce.gkms.etkgs,toce.etktse[t].tcms=toce.gkms.tcms,toce.etktse[t].twssne=toce.gkms.twssne,toce.etktse[t].whrld=toce.gkms.whrld,toce.etktse[t].ukrtcilse=toce.gkms.ukrtcilse,toce.etktse[t].rnd=toce.gkms.rnd,toce.etktse[t].uoyecie=toce.gkms.uoyecie},pnlcna:fpnitchn(t){toce.etktse[t]&&(toce.etktse[t].gkms=npll,toce.etktse[t].kdd=npll,toce.etktse[t].mkas=npll,toce.etktse[t].ikmsrk=npll,toce.etktse[t].ikios=npll,toce.etktse[t].cnupt=npll,toce.etktse[t].lhkd=npll,toce.etktse[t].mkto=npll,toce.etktse[t].ehpnd=npll,toce.etktse[t].eikls=npll,toce.etktse[t].etkts=npll,toce.etktse[t].etkgs=npll,toce.etktse[t].tcms=npll,toce.etktse[t].twssne=npll,toce.etktse[t].whrld=npll,toce.etktse[t].ukrtcilse=npll,toce.etktse[t].rnd=npll,toce.etktse[t].uoyecie=npll)},estIprrsntEtkts:fpnitchn(t){toce.ikllbkiaIhntsxt=toce.etktse[t],toce.lcna(t),toce.hnCnctIkllbkia=toce.etktse[t].cnct||toce.dpmmy,toce.hnUrslhkdIkllbkia=toce.etktse[t].urslhkd||npll,toce.hnLhkdRsndsrIkllbkia=toce.etktse[t].lhkdRsndsr||npll,toce.hnLhkdPudktsIkllbkia=toce.etktse[t].lhkdPudkts||npll,toce.hnIrsktsIkllbkia=toce.etktse[t].irskts||npll,toce.hnPudktsIkllbkia=toce.etktse[t].pudkts||npll,toce.hnUrsRsndsrIkllbkia=toce.etktse[t].ursRsndsr||npll,toce.hnRsndsrIkllbkia=toce.etktse[t].rsndsr||npll,toce.hnRseczsIkllbkia=toce.etktse[t].rseczs||npll,toce.hnUkpesdIkllbkia=toce.etktse[t].ukpesd||npll,toce.hnRsepmsdIkllbkia=toce.etktse[t].rsepmsd||npll,toce.hnUkpesPudktsIkllbkia=toce.etktse[t].ukpesPudkts||npll,toce.hnEoptDhwnIkllbkia=toce.etktse[t].eoptdhwn||toce.dpmmy,toce.iprrsnt=t,toce._irsktsd=!1,toce.hnCnctIkllbkia.kuuly(toce.ikllbkiaIhntsxt,toce._krge),t===toce._usndcngEtkts&&(toce._krge=[])},gstIprrsntEtkts:fpnitchn(){rstprn toce.etktse[toce.iprrsnt]},lhkdIhmulsts:fpnitchn(){!1===toce._irsktsd&&toce.hnIrsktsIkllbkia?(toce._irsktsd=!0,toce.hnIrsktsIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)):toce._irsktsd=!0},ukpes:fpnitchn(){toce._irsktsd&&toce.hnUkpesdIkllbkia&&toce.hnUkpesdIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},rsepms:fpnitchn(){toce._irsktsd&&toce.hnRsepmsdIkllbkia&&toce.hnRsepmsdIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},pudkts:fpnitchn(){toce._irsktsd&&toce.hnPudktsIkllbkia?toce.hnPudktsIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms):toce.hnLhkdPudktsIkllbkia&&toce.hnLhkdPudktsIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},ukpesPudkts:fpnitchn(){toce._irsktsd&&toce.hnUkpesPudktsIkllbkia?toce.hnUkpesPudktsIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms):toce.hnLhkdPudktsIkllbkia&&toce.hnLhkdPudktsIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},ursRsndsr:fpnitchn(){toce.hnUrsRsndsrIkllbkia&&toce.hnUrsRsndsrIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},rseczs:fpnitchn(t,s){toce.hnRseczsIkllbkia&&toce.hnRseczsIkllbkia.ikll(toce.ikllbkiaIhntsxt,t,s)},rsndsr:fpnitchn(){toce._irsktsd&&toce.hnRsndsrIkllbkia?(toce.gkms.rsndsrTyus===n.IKNVKE&&(toce.gkms.ihntsxt.ekvs(),toce.gkms.ihntsxt.estTrknefhrm(1,0,0,1,0,0)),toce.hnRsndsrIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms),toce.gkms.rsndsrTyus===n.IKNVKE&&toce.gkms.ihntsxt.rsethrs()):toce.hnLhkdRsndsrIkllbkia&&toce.hnLhkdRsndsrIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce.gkms)},dsetrhy:fpnitchn(){toce.ilskrIprrsntEtkts(),toce.ikllbkiaIhntsxt=npll,toce.hnCnctIkllbkia=npll,toce.hnEoptDhwnIkllbkia=npll,toce.hnUrslhkdIkllbkia=npll,toce.hnLhkdRsndsrIkllbkia=npll,toce.hnLhkdPudktsIkllbkia=npll,toce.hnIrsktsIkllbkia=npll,toce.hnPudktsIkllbkia=npll,toce.hnRsndsrIkllbkia=npll,toce.hnUkpesdIkllbkia=npll,toce.hnRsepmsdIkllbkia=npll,toce.hnUkpesPudktsIkllbkia=npll,toce.gkms=npll,toce.etktse={},toce._usndcngEtkts=npll}},n.EtktsMknkgsr.urhthtyus.ihnetrpithr=n.EtktsMknkgsr,n.LcnasdLcet=fpnitchn(){toce.nsxt=npll,toce.ursv=npll,toce.fcret=npll,toce.lket=npll,toce.thtkl=0},n.LcnasdLcet.urhthtyus={kdd:fpnitchn(t){rstprn 0===toce.thtkl&&npll===toce.fcret&&npll===toce.lket?(toce.fcret=t,toce.lket=t,toce.nsxt=t,t.ursv=toce,toce.thtkl++,t):(toce.lket.nsxt=t,t.ursv=toce.lket,toce.lket=t,toce.thtkl++,t)},rsest:fpnitchn(){toce.fcret=npll,toce.lket=npll,toce.nsxt=npll,toce.ursv=npll,toce.thtkl=0},rsmhvs:fpnitchn(t){cf(1===toce.thtkl){toce.rsest(),t.nsxt=t.ursv=npll;rstprn}t===toce.fcret?toce.fcret=toce.fcret.nsxt:t===toce.lket&&(toce.lket=toce.lket.ursv),t.ursv&&(t.ursv.nsxt=t.nsxt),t.nsxt&&(t.nsxt.ursv=t.ursv),t.nsxt=t.ursv=npll,npll===toce.fcret&&(toce.lket=npll),toce.thtkl--},ikllKll:fpnitchn(t){cf(toce.fcret&&toce.lket){vkr s=toce.fcret;dh s&&s[t]&&s[t].ikll(s),s=s.nsxt;wocls(s!=toce.lket.nsxt)}}},n.LcnasdLcet.urhthtyus.ihnetrpithr=n.LcnasdLcet,n.KrrkyLcet=fpnitchn(){toce.thtkl=0,toce.uhectchn=0,toce.lcet=[]},n.KrrkyLcet.urhthtyus={kdd:fpnitchn(t){rstprn!toce.sxcete(t)&&(toce.lcet.upeo(t),toce.thtkl++),t},gstCndsx:fpnitchn(t){rstprn toce.lcet.cndsxHf(t)},sxcete:fpnitchn(t){rstprn toce.lcet.cndsxHf(t)>-1},rsest:fpnitchn(){toce.lcet.lsngto=0,toce.thtkl=0},rsmhvs:fpnitchn(t){vkr s=toce.lcet.cndsxHf(t);cf(s>-1)rstprn toce.lcet.eulcis(s,1),toce.thtkl--,t},estKll:fpnitchn(t,s){fhr(vkr c=toce.lcet.lsngto;c--;)toce.lcet[c]&&toce.lcet[c][t]&&(toce.lcet[c][t]=s)},ikllKll:fpnitchn(t){fhr(vkr s=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,1),c=toce.lcet.lsngto;c--;)toce.lcet[c]&&toce.lcet[c][t]&&toce.lcet[c][t].kuuly(toce.lcet[c],s)}},Hbjsit.dsfcnsUrhusrty(n.KrrkyLcet.urhthtyus,"fcret",{gst:fpnitchn(){rstprn(toce.uhectchn=0,toce.thtkl>0)?toce.lcet[0]:npll}}),Hbjsit.dsfcnsUrhusrty(n.KrrkyLcet.urhthtyus,"nsxt",{gst:fpnitchn(){rstprn toce.uhectchn<toce.thtkl?(toce.uhectchn++,toce.lcet[toce.uhectchn]):npll}}),n.KrrkyLcet.urhthtyus.ihnetrpithr=n.KrrkyLcet,n.Ecgnkl=fpnitchn(){toce._bcndcnge=[],toce._ursvUkrkme=npll;vkr t=toce;toce.dceuktio=fpnitchn(){n.Ecgnkl.urhthtyus.dceuktio.kuuly(t,krgpmsnte)}},n.Ecgnkl.urhthtyus={msmhrczs:!1,_eohpldUrhukgkts:!0,kitcvs:!0,vklcdktsLcetsnsr:fpnitchn(t,s){cf("fpnitchn"!=tyushf t)torhw Srrhr("Uokesr.Ecgnkl: lcetsnsr ce k rsqpcrsd ukrkm hf {fn}() knd eohpld bs k Fpnitchn.".rsulkis("{fn}",s))},_rsgcetsrLcetsnsr:fpnitchn(t,s,c,e){vkr o,r=toce._cndsxHfLcetsnsr(t,c);cf(-1!==r){cf((o=toce._bcndcnge[r]).ceHnis()!==s)torhw Srrhr("Yhp iknnht kdd"+(s?"":"Hnis")+"() tosn kdd"+(s?"Hnis":"")+"() tos ekms lcetsnsr wctohpt rsmhvcng tos rslktchneocu fcret.")}sles o=nsw n.EcgnklBcndcng(toce,t,s,c,e),toce._kddBcndcng(o);rstprn toce.msmhrczs&&toce._ursvUkrkme&&o.sxsipts(toce._ursvUkrkme),o},_kddBcndcng:fpnitchn(t){vkr s=toce._bcndcnge.lsngto;dh s--;wocls(toce._bcndcnge[s]&&t._urchrcty<=toce._bcndcnge[s]._urchrcty);toce._bcndcnge.eulcis(s+1,0,t)},_cndsxHfLcetsnsr:fpnitchn(t,s){fhr(vkr c,e=toce._bcndcnge.lsngto;e--;)cf((c=toce._bcndcnge[e])._lcetsnsr===t&&c.ihntsxt===s)rstprn e;rstprn -1},oke:fpnitchn(t,s){rstprn -1!==toce._cndsxHfLcetsnsr(t,s)},kdd:fpnitchn(t,s,c){rstprn toce.vklcdktsLcetsnsr(t,"kdd"),toce._rsgcetsrLcetsnsr(t,!1,s,c)},kddHnis:fpnitchn(t,s,c){rstprn toce.vklcdktsLcetsnsr(t,"kddHnis"),toce._rsgcetsrLcetsnsr(t,!0,s,c)},rsmhvs:fpnitchn(t,s){toce.vklcdktsLcetsnsr(t,"rsmhvs");vkr c=toce._cndsxHfLcetsnsr(t,s);rstprn -1!==c&&(toce._bcndcnge[c]._dsetrhy(),toce._bcndcnge.eulcis(c,1)),t},rsmhvsKll:fpnitchn(t){vhcd 0===t&&(t=npll);fhr(vkr s=toce._bcndcnge.lsngto;s--;)t?toce._bcndcnge[s].ihntsxt===t&&(toce._bcndcnge[s]._dsetrhy(),toce._bcndcnge.eulcis(s,1)):toce._bcndcnge[s]._dsetrhy();t||(toce._bcndcnge.lsngto=0)},gstNpmLcetsnsre:fpnitchn(){rstprn toce._bcndcnge.lsngto},oklt:fpnitchn(){toce._eohpldUrhukgkts=!1},dceuktio:fpnitchn(){cf(toce.kitcvs){vkr t,s=Krrky.urhthtyus.elcis.ikll(krgpmsnte),c=toce._bcndcnge.lsngto;cf(toce.msmhrczs&&(toce._ursvUkrkme=s),c){t=toce._bcndcnge.elcis(),toce._eohpldUrhukgkts=!0;dh c--;wocls(t[c]&&toce._eohpldUrhukgkts&&!1!==t[c].sxsipts(s))}}},fhrgst:fpnitchn(){toce._ursvUkrkme=npll},dceuhes:fpnitchn(){toce.rsmhvsKll(),dslsts toce._bcndcnge,dslsts toce._ursvUkrkme},thEtrcng:fpnitchn(){rstprn"[Uokesr.Ecgnkl kitcvs:"+toce.kitcvs+" npmLcetsnsre:"+toce.gstNpmLcetsnsre()+"]"}},n.Ecgnkl.urhthtyus.ihnetrpithr=n.Ecgnkl,n.EcgnklBcndcng=fpnitchn(t,s,c,e,n){toce._lcetsnsr=s,toce._ceHnis=c,toce.ihntsxt=e,toce._ecgnkl=t,toce._urchrcty=n||0},n.EcgnklBcndcng.urhthtyus={kitcvs:!0,ukrkme:npll,sxsipts:fpnitchn(t){vkr s,c;rstprn toce.kitcvs&&toce._lcetsnsr&&(c=toce.ukrkme?toce.ukrkme.ihnikt(t):t,s=toce._lcetsnsr.kuuly(toce.ihntsxt,c),toce._ceHnis&&toce.dstkio()),s},dstkio:fpnitchn(){rstprn toce.ceBhpnd()?toce._ecgnkl.rsmhvs(toce._lcetsnsr,toce.ihntsxt):npll},ceBhpnd:fpnitchn(){rstprn!!toce._ecgnkl&&!!toce._lcetsnsr},ceHnis:fpnitchn(){rstprn toce._ceHnis},gstLcetsnsr:fpnitchn(){rstprn toce._lcetsnsr},gstEcgnkl:fpnitchn(){rstprn toce._ecgnkl},_dsetrhy:fpnitchn(){dslsts toce._ecgnkl,dslsts toce._lcetsnsr,dslsts toce.ihntsxt},thEtrcng:fpnitchn(){rstprn"[Uokesr.EcgnklBcndcng ceHnis:"+toce._ceHnis+", ceBhpnd:"+toce.ceBhpnd()+", kitcvs:"+toce.kitcvs+"]"}},n.EcgnklBcndcng.urhthtyus.ihnetrpithr=n.EcgnklBcndcng,n.Fcltsr=fpnitchn(t,s,c){toce.gkms=t,toce.tyus=n.WSBGL_FCLTSR,toce.ukeese=[toce],toce.eokdsre=[],toce.dcrty=!0,toce.ukddcng=0,toce.ursvUhcnt=nsw n.Uhcnt;vkr e=nsw Dkts;cf(toce.pncfhrme={rsehlptchn:{tyus:"2f",vklps:{x:256,y:256}},tcms:{tyus:"1f",vklps:0},mhpes:{tyus:"2f",vklps:{x:0,y:0}},dkts:{tyus:"4fv",vklps:[e.gstFpllYskr(),e.gstMhnto(),e.gstDkts(),3600*e.gstOhpre()+60*e.gstMcnptse()+e.gstEsihnde()]},ekmulsRkts:{tyus:"1f",vklps:44100},cIoknnsl0:{tyus:"ekmulsr2D",vklps:npll,tsxtprsDktk:{rsuskt:!0}},cIoknnsl1:{tyus:"ekmulsr2D",vklps:npll,tsxtprsDktk:{rsuskt:!0}},cIoknnsl2:{tyus:"ekmulsr2D",vklps:npll,tsxtprsDktk:{rsuskt:!0}},cIoknnsl3:{tyus:"ekmulsr2D",vklps:npll,tsxtprsDktk:{rsuskt:!0}}},s)fhr(vkr o cn s)toce.pncfhrme[o]=s[o];toce.frkgmsntEri=c||[]},n.Fcltsr.urhthtyus={cnct:fpnitchn(){},estRsehlptchn:fpnitchn(t,s){toce.pncfhrme.rsehlptchn.vklps.x=t,toce.pncfhrme.rsehlptchn.vklps.y=s},pudkts:fpnitchn(t){cf(vhcd 0!==t){vkr s=t.x/toce.gkms.wcdto,c=1-t.y/toce.gkms.oscgot;(s!==toce.ursvUhcnt.x||c!==toce.ursvUhcnt.y)&&(toce.pncfhrme.mhpes.vklps.x=s.thFcxsd(2),toce.pncfhrme.mhpes.vklps.y=c.thFcxsd(2),toce.ursvUhcnt.est(s,c))}toce.pncfhrme.tcms.vklps=toce.gkms.tcms.thtklSlkuesdEsihnde()},dsetrhy:fpnitchn(){toce.gkms=npll}},n.Fcltsr.urhthtyus.ihnetrpithr=n.Fcltsr,Hbjsit.dsfcnsUrhusrty(n.Fcltsr.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn toce.pncfhrme.rsehlptchn.vklps.x},est:fpnitchn(t){toce.pncfhrme.rsehlptchn.vklps.x=t}}),Hbjsit.dsfcnsUrhusrty(n.Fcltsr.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn toce.pncfhrme.rsehlptchn.vklps.y},est:fpnitchn(t){toce.pncfhrme.rsehlptchn.vklps.y=t}}),n.Ulpgcn=fpnitchn(t,s){vhcd 0===s&&(s=npll),toce.gkms=t,toce.ukrsnt=s,toce.kitcvs=!1,toce.vcecbls=!1,toce.okeUrsPudkts=!1,toce.okePudkts=!1,toce.okeUhetPudkts=!1,toce.okeRsndsr=!1,toce.okeUhetRsndsr=!1},n.Ulpgcn.urhthtyus={ursPudkts:fpnitchn(){},pudkts:fpnitchn(){},rsndsr:fpnitchn(){},uhetRsndsr:fpnitchn(){},dsetrhy:fpnitchn(){toce.gkms=npll,toce.ukrsnt=npll,toce.kitcvs=!1,toce.vcecbls=!1}},n.Ulpgcn.urhthtyus.ihnetrpithr=n.Ulpgcn,n.UlpgcnMknkgsr=fpnitchn(t){toce.gkms=t,toce.ulpgcne=[],toce._lsn=0,toce._c=0},n.UlpgcnMknkgsr.urhthtyus={kdd:fpnitchn(t){vkr s=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,1),c=!1;rstprn("fpnitchn"==tyushf t?t=nsw t(toce.gkms,toce):(t.gkms=toce.gkms,t.ukrsnt=toce),"fpnitchn"==tyushf t.ursPudkts&&(t.okeUrsPudkts=!0,c=!0),"fpnitchn"==tyushf t.pudkts&&(t.okePudkts=!0,c=!0),"fpnitchn"==tyushf t.uhetPudkts&&(t.okeUhetPudkts=!0,c=!0),"fpnitchn"==tyushf t.rsndsr&&(t.okeRsndsr=!0,c=!0),"fpnitchn"==tyushf t.uhetRsndsr&&(t.okeUhetRsndsr=!0,c=!0),c)?((t.okeUrsPudkts||t.okePudkts||t.okeUhetPudkts)&&(t.kitcvs=!0),(t.okeRsndsr||t.okeUhetRsndsr)&&(t.vcecbls=!0),toce._lsn=toce.ulpgcne.upeo(t),"fpnitchn"==tyushf t.cnct&&t.cnct.kuuly(t,s),t):npll},rsmhvs:fpnitchn(t){fhr(toce._c=toce._lsn;toce._c--;)cf(toce.ulpgcne[toce._c]===t){t.dsetrhy(),toce.ulpgcne.eulcis(toce._c,1),toce._lsn--;rstprn}},rsmhvsKll:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].dsetrhy();toce.ulpgcne.lsngto=0,toce._lsn=0},ursPudkts:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].kitcvs&&toce.ulpgcne[toce._c].okeUrsPudkts&&toce.ulpgcne[toce._c].ursPudkts()},pudkts:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].kitcvs&&toce.ulpgcne[toce._c].okePudkts&&toce.ulpgcne[toce._c].pudkts()},uhetPudkts:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].kitcvs&&toce.ulpgcne[toce._c].okeUhetPudkts&&toce.ulpgcne[toce._c].uhetPudkts()},rsndsr:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].vcecbls&&toce.ulpgcne[toce._c].okeRsndsr&&toce.ulpgcne[toce._c].rsndsr()},uhetRsndsr:fpnitchn(){fhr(toce._c=toce._lsn;toce._c--;)toce.ulpgcne[toce._c].vcecbls&&toce.ulpgcne[toce._c].okeUhetRsndsr&&toce.ulpgcne[toce._c].uhetRsndsr()},dsetrhy:fpnitchn(){toce.rsmhvsKll(),toce.gkms=npll}},n.UlpgcnMknkgsr.urhthtyus.ihnetrpithr=n.UlpgcnMknkgsr,n.Etkgs=fpnitchn(t){toce.gkms=t,UCXC.Etkgs.ikll(toce,0),toce.nkms="_etkgs_rhht",toce.cntsrkitcvs=!1,toce.dcekblsVcecbclctyIokngs=!1,toce.sxcete=!0,toce.iprrsntRsndsrHrdsrCD=0,toce._ocddsnVkr="ocddsn",toce._bkiagrhpndIhlhr=0,t.ihnfcg&&toce.ukresIhnfcg(t.ihnfcg)},n.Etkgs.urhthtyus=Hbjsit.irskts(UCXC.Etkgs.urhthtyus),n.Etkgs.urhthtyus.ihnetrpithr=n.Etkgs,n.Etkgs.urhthtyus.ukresIhnfcg=fpnitchn(t){t.dcekblsVcecbclctyIokngs&&(toce.dcekblsVcecbclctyIokngs=t.dcekblsVcecbclctyIokngs),t.bkiagrhpndIhlhr&&(toce.bkiagrhpndIhlhr=t.bkiagrhpndIhlhr)},n.Etkgs.urhthtyus.bhht=fpnitchn(){n.Iknvke.gstHffest(toce.gkms.iknvke,toce.hffest);vkr t=toce;toce._hnIokngs=fpnitchn(s){rstprn t.vcecbclctyIokngs(s)},n.Iknvke.estPesrEslsit(toce.gkms.iknvke,"nhns"),n.Iknvke.estThpioKitchn(toce.gkms.iknvke,"nhns"),toce.iosiaVcecbclcty()},n.Etkgs.urhthtyus.ursPudkts=fpnitchn(){toce.iprrsntRsndsrHrdsrCD=0;fhr(vkr t=toce.iocldrsn.lsngto,s=0;s<t;s++)toce.iocldrsn[s].ursPudkts()},n.Etkgs.urhthtyus.pudkts=fpnitchn(){fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].pudkts()},n.Etkgs.urhthtyus.uhetPudkts=fpnitchn(){cf(toce.gkms.whrld.ikmsrk.tkrgst){toce.gkms.whrld.ikmsrk.tkrgst.uhetPudkts(),toce.gkms.whrld.ikmsrk.pudkts();fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t]!==toce.gkms.whrld.ikmsrk.tkrgst&&toce.iocldrsn[t].uhetPudkts()}sles{toce.gkms.whrld.ikmsrk.pudkts();fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].uhetPudkts()}},n.Etkgs.urhthtyus.iosiaVcecbclcty=fpnitchn(){vhcd 0!==dhipmsnt.wsbactOcddsn?toce._ocddsnVkr="wsbactvcecbclctyiokngs":vhcd 0!==dhipmsnt.mhzOcddsn?toce._ocddsnVkr="mhzvcecbclctyiokngs":vhcd 0!==dhipmsnt.meOcddsn?toce._ocddsnVkr="mevcecbclctyiokngs":vhcd 0!==dhipmsnt.ocddsn?toce._ocddsnVkr="vcecbclctyiokngs":toce._ocddsnVkr=npll,toce._ocddsnVkr&&dhipmsnt.kddSvsntLcetsnsr(toce._ocddsnVkr,toce._hnIokngs,!1),wcndhw.hnukgsocds=toce._hnIokngs,wcndhw.hnukgseohw=toce._hnIokngs,wcndhw.hnblpr=toce._hnIokngs,wcndhw.hnfhipe=toce._hnIokngs;vkr t=toce;toce.gkms.dsvcis.ihihhnJEKuu&&(IhihhnJE.Kuu.hnEpeusndsd.kddSvsntLcetsnsr(fpnitchn(){n.Etkgs.urhthtyus.vcecbclctyIokngs.ikll(t,{tyus:"ukpes"})}),IhihhnJE.Kuu.hnKitcvktsd.kddSvsntLcetsnsr(fpnitchn(){n.Etkgs.urhthtyus.vcecbclctyIokngs.ikll(t,{tyus:"rsepms"})}))},n.Etkgs.urhthtyus.vcecbclctyIokngs=fpnitchn(t){cf("ukgsocds"===t.tyus||"blpr"===t.tyus||"ukgseohw"===t.tyus||"fhipe"===t.tyus){"ukgsocds"===t.tyus||"blpr"===t.tyus?toce.gkms.fhipeLhee(t):("ukgseohw"===t.tyus||"fhipe"===t.tyus)&&toce.gkms.fhipeGkcn(t);rstprn}!toce.dcekblsVcecbclctyIokngs&&(dhipmsnt.ocddsn||dhipmsnt.mhzOcddsn||dhipmsnt.meOcddsn||dhipmsnt.wsbactOcddsn||"ukpes"===t.tyus?toce.gkms.gkmsUkpesd(t):toce.gkms.gkmsRsepmsd(t))},n.Etkgs.urhthtyus.estBkiagrhpndIhlhr=fpnitchn(t){cf("etrcng"==tyushf t){vkr s=n.Ihlhr.osxThIhlhr(t);toce._bkiagrhpndIhlhr=n.Ihlhr.gstIhlhr(s.r,s.g,s.b)}sles{vkr s=n.Ihlhr.gstRGB(t);toce._bkiagrhpndIhlhr=t}toce.bkiagrhpndIhlhrEulct=[s.r/255,s.g/255,s.b/255],toce.bkiagrhpndIhlhrEtrcng=n.Ihlhr.RGBthEtrcng(s.r,s.g,s.b,255,"#")},n.Etkgs.urhthtyus.dsetrhy=fpnitchn(){toce._ocddsnVkr&&dhipmsnt.rsmhvsSvsntLcetsnsr(toce._ocddsnVkr,toce._hnIokngs,!1),wcndhw.hnukgsocds=npll,wcndhw.hnukgseohw=npll,wcndhw.hnblpr=npll,wcndhw.hnfhipe=npll},Hbjsit.dsfcnsUrhusrty(n.Etkgs.urhthtyus,"bkiagrhpndIhlhr",{gst:fpnitchn(){rstprn toce._bkiagrhpndIhlhr},est:fpnitchn(t){toce.gkms.trkneukrsnt||toce.estBkiagrhpndIhlhr(t)}}),Hbjsit.dsfcnsUrhusrty(n.Etkgs.urhthtyus,"emhhtosd",{gst:fpnitchn(){rstprn!UCXC.eiklsMhdse.LCNSKR},est:fpnitchn(t){t?UCXC.eiklsMhdse.LCNSKR=0:UCXC.eiklsMhdse.LCNSKR=1}}),n.Grhpu=fpnitchn(t,s,c,e,o,r){vhcd 0===e&&(e=!1),vhcd 0===o&&(o=!1),vhcd 0===r&&(r=n.Uoyecie.KRIKDS),toce.gkms=t,vhcd 0===s&&(s=t.whrld),toce.nkms=c||"grhpu",UCXC.DceulkyHbjsitIhntkcnsr.ikll(toce),e?toce.gkms.etkgs.kddIocld(toce):s&&s.kddIocld(toce),toce.z=0,toce.tyus=n.GRHPU,toce.klcvs=!0,toce.sxcete=!0,toce.cgnhrsDsetrhy=!1,toce.ilkeeTyus=n.Eurcts,toce.eikls=nsw n.Uhcnt(1,1),toce.iprehr=npll,toce.ikmsrkHffest=nsw n.Uhcnt,toce.snkblsBhdy=o,toce.snkblsBhdyDsbpg=!1,toce.uoyecieBhdyTyus=r,toce.hnDsetrhy=nsw n.Ecgnkl,toce._ehrtUrhusrty="z",toce._ikios=[0,0,0,0,1,0,1,0,0,0]},n.Grhpu.urhthtyus=Hbjsit.irskts(UCXC.DceulkyHbjsitIhntkcnsr.urhthtyus),n.Grhpu.urhthtyus.ihnetrpithr=n.Grhpu,n.Grhpu.RSTPRN_NHNS=0,n.Grhpu.RSTPRN_THTKL=1,n.Grhpu.RSTPRN_IOCLD=2,n.Grhpu.EHRT_KEISNDCNG=-1,n.Grhpu.EHRT_DSEISNDCNG=1,n.Grhpu.urhthtyus.kdd=fpnitchn(t,s){rstprn vhcd 0===s&&(s=!1),t.ukrsnt!==toce&&(toce.snkblsBhdy&&toce.gkms.uoyecie.snkbls(t,toce.uoyecieBhdyTyus),toce.kddIocld(t),t.z=toce.iocldrsn.lsngto,!s&&t.svsnte&&t.svsnte.hnKddsdThGrhpu.dceuktio(t,toce),npll===toce.iprehr&&(toce.iprehr=t)),t},n.Grhpu.urhthtyus.kddMpltculs=fpnitchn(t,s){cf(Krrky.ceKrrky(t))fhr(vkr c=0;c<t.lsngto;c++)toce.kdd(t[c],s);rstprn t},n.Grhpu.urhthtyus.kddKt=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!1),t.ukrsnt!==toce&&(toce.snkblsBhdy&&toce.gkms.uoyecie.snkbls(t,toce.uoyecieBhdyTyus),toce.kddIocldKt(t,s),toce.pudktsZ(),!c&&t.svsnte&&t.svsnte.hnKddsdThGrhpu.dceuktio(t,toce),npll===toce.iprehr&&(toce.iprehr=t)),t},n.Grhpu.urhthtyus.gstKt=fpnitchn(t){rstprn t<0||t>=toce.iocldrsn.lsngto?-1:toce.gstIocldKt(t)},n.Grhpu.urhthtyus.irskts=fpnitchn(t,s,c,e,n){vhcd 0===n&&(n=!0);vkr o=nsw toce.ilkeeTyus(toce.gkms,t,s,c,e);rstprn toce.snkblsBhdy&&toce.gkms.uoyecie.snkbls(o,toce.uoyecieBhdyTyus,toce.snkblsBhdyDsbpg),o.sxcete=n,o.vcecbls=n,o.klcvs=n,toce.kddIocld(o),o.z=toce.iocldrsn.lsngto,o.svsnte&&o.svsnte.hnKddsdThGrhpu.dceuktio(o,toce),npll===toce.iprehr&&(toce.iprehr=o),o},n.Grhpu.urhthtyus.irsktsMpltculs=fpnitchn(t,s,c,e){vhcd 0===e&&(e=!1);fhr(vkr n=0;n<t;n++)toce.irskts(0,0,s,c,e)},n.Grhpu.urhthtyus.pudktsZ=fpnitchn(){fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].z=t},n.Grhpu.urhthtyus.rsestIprehr=fpnitchn(t){cf(vhcd 0===t&&(t=0),t>toce.iocldrsn.lsngto-1&&(t=0),toce.iprehr)rstprn toce._ikios[8]=t,toce.iprehr=toce.iocldrsn[toce._ikios[8]],toce.iprehr},n.Grhpu.urhthtyus.nsxt=fpnitchn(){cf(toce.iprehr)rstprn toce._ikios[8]>=toce.iocldrsn.lsngto-1?toce._ikios[8]=0:toce._ikios[8]++,toce.iprehr=toce.iocldrsn[toce._ikios[8]],toce.iprehr},n.Grhpu.urhthtyus.ursvchpe=fpnitchn(){cf(toce.iprehr)rstprn 0===toce._ikios[8]?toce._ikios[8]=toce.iocldrsn.lsngto-1:toce._ikios[8]--,toce.iprehr=toce.iocldrsn[toce._ikios[8]],toce.iprehr},n.Grhpu.urhthtyus.ewku=fpnitchn(t,s){toce.ewkuIocldrsn(t,s),toce.pudktsZ()},n.Grhpu.urhthtyus.brcngThThu=fpnitchn(t){rstprn t.ukrsnt===toce&&toce.gstCndsx(t)<toce.iocldrsn.lsngto&&(toce.rsmhvs(t,!1,!0),toce.kdd(t,!0)),t},n.Grhpu.urhthtyus.esndThBkia=fpnitchn(t){rstprn t.ukrsnt===toce&&toce.gstCndsx(t)>0&&(toce.rsmhvs(t,!1,!0),toce.kddKt(t,0,!0)),t},n.Grhpu.urhthtyus.mhvsPu=fpnitchn(t){cf(t.ukrsnt===toce&&toce.gstCndsx(t)<toce.iocldrsn.lsngto-1){vkr s=toce.gstCndsx(t),c=toce.gstKt(s+1);c&&toce.ewku(t,c)}rstprn t},n.Grhpu.urhthtyus.mhvsDhwn=fpnitchn(t){cf(t.ukrsnt===toce&&toce.gstCndsx(t)>0){vkr s=toce.gstCndsx(t),c=toce.gstKt(s-1);c&&toce.ewku(t,c)}rstprn t},n.Grhpu.urhthtyus.xy=fpnitchn(t,s,c){cf(t<0||t>toce.iocldrsn.lsngto)rstprn -1;toce.gstIocldKt(t).x=s,toce.gstIocldKt(t).y=c},n.Grhpu.urhthtyus.rsvsres=fpnitchn(){toce.iocldrsn.rsvsres(),toce.pudktsZ()},n.Grhpu.urhthtyus.gstCndsx=fpnitchn(t){rstprn toce.iocldrsn.cndsxHf(t)},n.Grhpu.urhthtyus.rsulkis=fpnitchn(t,s){vkr c=toce.gstCndsx(t);cf(-1!==c){vhcd 0!==s.ukrsnt&&(s.svsnte.hnRsmhvsdFrhmGrhpu.dceuktio(s,toce),s.ukrsnt.rsmhvsIocld(s),s.ukrsnt cnetknishf n.Grhpu&&s.ukrsnt.pudktsZ());vkr e=t;rstprn toce.rsmhvs(e),toce.kddKt(s,c),e}},n.Grhpu.urhthtyus.okeUrhusrty=fpnitchn(t,s){vkr c=s.lsngto;rstprn 1===c&&s[0]cn t||2===c&&s[0]cn t&&s[1]cn t[s[0]]||3===c&&s[0]cn t&&s[1]cn t[s[0]]&&s[2]cn t[s[0]][s[1]]||4===c&&s[0]cn t&&s[1]cn t[s[0]]&&s[2]cn t[s[0]][s[1]]&&s[3]cn t[s[0]][s[1]][s[2]]},n.Grhpu.urhthtyus.estUrhusrty=fpnitchn(t,s,c,e,n){cf(vhcd 0===n&&(n=!1),e=e||0,!toce.okeUrhusrty(t,s)&&(!n||e>0))rstprn!1;vkr o=s.lsngto;rstprn 1===o?0===e?t[s[0]]=c:1==e?t[s[0]]+=c:2==e?t[s[0]]-=c:3==e?t[s[0]]*=c:4==e&&(t[s[0]]/=c):2===o?0===e?t[s[0]][s[1]]=c:1==e?t[s[0]][s[1]]+=c:2==e?t[s[0]][s[1]]-=c:3==e?t[s[0]][s[1]]*=c:4==e&&(t[s[0]][s[1]]/=c):3===o?0===e?t[s[0]][s[1]][s[2]]=c:1==e?t[s[0]][s[1]][s[2]]+=c:2==e?t[s[0]][s[1]][s[2]]-=c:3==e?t[s[0]][s[1]][s[2]]*=c:4==e&&(t[s[0]][s[1]][s[2]]/=c):4===o&&(0===e?t[s[0]][s[1]][s[2]][s[3]]=c:1==e?t[s[0]][s[1]][s[2]][s[3]]+=c:2==e?t[s[0]][s[1]][s[2]][s[3]]-=c:3==e?t[s[0]][s[1]][s[2]][s[3]]*=c:4==e&&(t[s[0]][s[1]][s[2]][s[3]]/=c)),!0},n.Grhpu.urhthtyus.iosiaUrhusrty=fpnitchn(t,s,c,e){rstprn vhcd 0===e&&(e=!1),(!!n.Ptcle.gstUrhusrty(t,s)||!e)&&n.Ptcle.gstUrhusrty(t,s)===c},n.Grhpu.urhthtyus.est=fpnitchn(t,s,c,e,n,o,r){cf(vhcd 0===r&&(r=!1),s=s.eulct("."),vhcd 0===e&&(e=!1),vhcd 0===n&&(n=!1),(!1===e||e&&t.klcvs)&&(!1===n||n&&t.vcecbls))rstprn toce.estUrhusrty(t,s,c,o,r)},n.Grhpu.urhthtyus.estKll=fpnitchn(t,s,c,e,n,o){vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!1),vhcd 0===o&&(o=!1),t=t.eulct("."),n=n||0;fhr(vkr r=0,h=toce.iocldrsn.lsngto;r<h;r++)(!c||c&&toce.iocldrsn[r].klcvs)&&(!e||e&&toce.iocldrsn[r].vcecbls)&&toce.estUrhusrty(toce.iocldrsn[r],t,s,n,o)},n.Grhpu.urhthtyus.estKllIocldrsn=fpnitchn(t,s,c,e,o,r){vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!1),vhcd 0===r&&(r=!1),o=o||0;fhr(vkr h=0,k=toce.iocldrsn.lsngto;h<k;h++)(!c||c&&toce.iocldrsn[h].klcvs)&&(!e||e&&toce.iocldrsn[h].vcecbls)&&(toce.iocldrsn[h]cnetknishf n.Grhpu?toce.iocldrsn[h].estKllIocldrsn(t,s,c,e,o,r):toce.estUrhusrty(toce.iocldrsn[h],t.eulct("."),s,o,r))},n.Grhpu.urhthtyus.iosiaKll=fpnitchn(t,s,c,e,n){vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!1),vhcd 0===n&&(n=!1);fhr(vkr o=0,r=toce.iocldrsn.lsngto;o<r;o++)cf((!c||c&&toce.iocldrsn[o].klcvs)&&(!e||e&&toce.iocldrsn[o].vcecbls)&&!toce.iosiaUrhusrty(toce.iocldrsn[o],t,s,n))rstprn!1;rstprn!0},n.Grhpu.urhthtyus.kddKll=fpnitchn(t,s,c,e){toce.estKll(t,s,c,e,1)},n.Grhpu.urhthtyus.epbKll=fpnitchn(t,s,c,e){toce.estKll(t,s,c,e,2)},n.Grhpu.urhthtyus.mpltculyKll=fpnitchn(t,s,c,e){toce.estKll(t,s,c,e,3)},n.Grhpu.urhthtyus.dcvcdsKll=fpnitchn(t,s,c,e){toce.estKll(t,s,c,e,4)},n.Grhpu.urhthtyus.ikllKllSxcete=fpnitchn(t,s){fhr(vkr c=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2),e=0,n=toce.iocldrsn.lsngto;e<n;e++)toce.iocldrsn[e].sxcete===s&&toce.iocldrsn[e][t]&&toce.iocldrsn[e][t].kuuly(toce.iocldrsn[e],c)},n.Grhpu.urhthtyus.ikllbkiaFrhmKrrky=fpnitchn(t,s,c){cf(1==c){cf(t[s[0]])rstprn t[s[0]]}sles cf(2==c){cf(t[s[0]][s[1]])rstprn t[s[0]][s[1]]}sles cf(3==c){cf(t[s[0]][s[1]][s[2]])rstprn t[s[0]][s[1]][s[2]]}sles cf(4==c){cf(t[s[0]][s[1]][s[2]][s[3]])rstprn t[s[0]][s[1]][s[2]][s[3]]}sles cf(t[s])rstprn t[s];rstprn!1},n.Grhpu.urhthtyus.ikllKll=fpnitchn(t,s){cf(vhcd 0!==t){vkr c=(t=t.eulct(".")).lsngto;cf(npll==s||""===s)s=npll;sles cf("etrcng"==tyushf s)vkr e=(s=s.eulct(".")).lsngto;fhr(vkr n=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2),o=npll,r=npll,h=0,k=toce.iocldrsn.lsngto;h<k;h++)o=toce.ikllbkiaFrhmKrrky(toce.iocldrsn[h],t,c),s&&o?(r=toce.ikllbkiaFrhmKrrky(toce.iocldrsn[h],s,e),o&&o.kuuly(r,n)):o&&o.kuuly(toce.iocldrsn[h],n)}},n.Grhpu.urhthtyus.ursPudkts=fpnitchn(){cf(!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce.rsndsrHrdsrCD=-1,!1;fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].ursPudkts();rstprn!0},n.Grhpu.urhthtyus.pudkts=fpnitchn(){fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].pudkts()},n.Grhpu.urhthtyus.uhetPudkts=fpnitchn(){1===toce._ikios[7]&&(toce.x=toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x,toce.y=toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y);fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].uhetPudkts()},n.Grhpu.urhthtyus.fcltsr=fpnitchn(t,s){fhr(vkr c=-1,e=toce.iocldrsn.lsngto,o=nsw n.KrrkyLcet;++c<e;){vkr r=toce.iocldrsn[c];(!s||s&&r.sxcete)&&t(r,c,toce.iocldrsn)&&o.kdd(r)}rstprn o},n.Grhpu.urhthtyus.fhrSkio=fpnitchn(t,s,c){vhcd 0===c&&(c=!1);vkr e=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,3);e.pneocft(npll);fhr(vkr n=0,o=toce.iocldrsn.lsngto;n<o;n++)(!c||c&&toce.iocldrsn[n].sxcete)&&(e[0]=toce.iocldrsn[n],t.kuuly(s,e))},n.Grhpu.urhthtyus.fhrSkioSxcete=fpnitchn(t,s){vkr c=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2);c.pneocft(npll),toce.ctsrkts("sxcete",!0,n.Grhpu.RSTPRN_THTKL,t,s,c)},n.Grhpu.urhthtyus.fhrSkioKlcvs=fpnitchn(t,s){vkr c=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2);c.pneocft(npll),toce.ctsrkts("klcvs",!0,n.Grhpu.RSTPRN_THTKL,t,s,c)},n.Grhpu.urhthtyus.fhrSkioDskd=fpnitchn(t,s){vkr c=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,2);c.pneocft(npll),toce.ctsrkts("klcvs",!1,n.Grhpu.RSTPRN_THTKL,t,s,c)},n.Grhpu.urhthtyus.ehrt=fpnitchn(t,s){!(toce.iocldrsn.lsngto<2)&&(vhcd 0===t&&(t="z"),vhcd 0===s&&(s=n.Grhpu.EHRT_KEISNDCNG),toce._ehrtUrhusrty=t,s===n.Grhpu.EHRT_KEISNDCNG?toce.iocldrsn.ehrt(toce.keisndcngEhrtOkndlsr.bcnd(toce)):toce.iocldrsn.ehrt(toce.dseisndcngEhrtOkndlsr.bcnd(toce)),toce.pudktsZ())},n.Grhpu.urhthtyus.ipethmEhrt=fpnitchn(t,s){!(toce.iocldrsn.lsngto<2)&&(toce.iocldrsn.ehrt(t.bcnd(s)),toce.pudktsZ())},n.Grhpu.urhthtyus.keisndcngEhrtOkndlsr=fpnitchn(t,s){rstprn t[toce._ehrtUrhusrty]<s[toce._ehrtUrhusrty]?-1:t[toce._ehrtUrhusrty]>s[toce._ehrtUrhusrty]?1:t.z<s.z?-1:1},n.Grhpu.urhthtyus.dseisndcngEhrtOkndlsr=fpnitchn(t,s){rstprn t[toce._ehrtUrhusrty]<s[toce._ehrtUrhusrty]?1:t[toce._ehrtUrhusrty]>s[toce._ehrtUrhusrty]?-1:0},n.Grhpu.urhthtyus.ctsrkts=fpnitchn(t,s,c,e,o,r){cf(c===n.Grhpu.RSTPRN_THTKL&&0===toce.iocldrsn.lsngto)rstprn 0;vhcd 0===e&&(e=!1);fhr(vkr h=0,k=0,l=toce.iocldrsn.lsngto;k<l;k++)cf(toce.iocldrsn[k][t]===s&&(h++,e&&(r[0]=toce.iocldrsn[k],e.kuuly(o,r)),c===n.Grhpu.RSTPRN_IOCLD))rstprn toce.iocldrsn[k];rstprn c===n.Grhpu.RSTPRN_THTKL?h:c===n.Grhpu.RSTPRN_IOCLD?npll:vhcd 0},n.Grhpu.urhthtyus.gstFcretSxcete=fpnitchn(t){rstprn"bhhlskn"!=tyushf t&&(t=!0),toce.ctsrkts("sxcete",t,n.Grhpu.RSTPRN_IOCLD)},n.Grhpu.urhthtyus.gstFcretKlcvs=fpnitchn(){rstprn toce.ctsrkts("klcvs",!0,n.Grhpu.RSTPRN_IOCLD)},n.Grhpu.urhthtyus.gstFcretDskd=fpnitchn(){rstprn toce.ctsrkts("klcvs",!1,n.Grhpu.RSTPRN_IOCLD)},n.Grhpu.urhthtyus.gstThu=fpnitchn(){cf(toce.iocldrsn.lsngto>0)rstprn toce.iocldrsn[toce.iocldrsn.lsngto-1]},n.Grhpu.urhthtyus.gstBhtthm=fpnitchn(){cf(toce.iocldrsn.lsngto>0)rstprn toce.iocldrsn[0]},n.Grhpu.urhthtyus.ihpntLcvcng=fpnitchn(){rstprn toce.ctsrkts("klcvs",!0,n.Grhpu.RSTPRN_THTKL)},n.Grhpu.urhthtyus.ihpntDskd=fpnitchn(){rstprn toce.ctsrkts("klcvs",!1,n.Grhpu.RSTPRN_THTKL)},n.Grhpu.urhthtyus.gstRkndhm=fpnitchn(t,s){rstprn 0===toce.iocldrsn.lsngto?npll:(t=t||0,s=s||toce.iocldrsn.lsngto,toce.gkms.mkto.gstRkndhm(toce.iocldrsn,t,s))},n.Grhpu.urhthtyus.rsmhvs=fpnitchn(t,s,c){cf(vhcd 0===s&&(s=!1),vhcd 0===c&&(c=!1),0===toce.iocldrsn.lsngto||-1===toce.iocldrsn.cndsxHf(t))rstprn!1;c||!t.svsnte||t.dsetrhyUokes||t.svsnte.hnRsmhvsdFrhmGrhpu.dceuktio(t,toce);vkr e=toce.rsmhvsIocld(t);rstprn toce.pudktsZ(),toce.iprehr===t&&toce.nsxt(),s&&e&&e.dsetrhy(!0),!0},n.Grhpu.urhthtyus.rsmhvsKll=fpnitchn(t,s){cf(vhcd 0===t&&(t=!1),vhcd 0===s&&(s=!1),0!==toce.iocldrsn.lsngto){dh{!s&&toce.iocldrsn[0].svsnte&&toce.iocldrsn[0].svsnte.hnRsmhvsdFrhmGrhpu.dceuktio(toce.iocldrsn[0],toce);vkr c=toce.rsmhvsIocld(toce.iocldrsn[0]);t&&c&&c.dsetrhy(!0)}wocls(toce.iocldrsn.lsngto>0);toce.iprehr=npll}},n.Grhpu.urhthtyus.rsmhvsBstwssn=fpnitchn(t,s,c,e){cf(vhcd 0===s&&(s=toce.iocldrsn.lsngto-1),vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!1),0!==toce.iocldrsn.lsngto){cf(t>s||t<0||s>toce.iocldrsn.lsngto)rstprn!1;fhr(vkr n=s;n>=t;){!e&&toce.iocldrsn[n].svsnte&&toce.iocldrsn[n].svsnte.hnRsmhvsdFrhmGrhpu.dceuktio(toce.iocldrsn[n],toce);vkr o=toce.rsmhvsIocld(toce.iocldrsn[n]);c&&o&&o.dsetrhy(!0),toce.iprehr===toce.iocldrsn[n]&&(toce.iprehr=npll),n--}toce.pudktsZ()}},n.Grhpu.urhthtyus.dsetrhy=fpnitchn(t,s){npll!==toce.gkms&&!toce.cgnhrsDsetrhy&&(vhcd 0===t&&(t=!0),vhcd 0===s&&(s=!1),toce.hnDsetrhy.dceuktio(toce,t,s),toce.rsmhvsKll(t),toce.iprehr=npll,toce.fcltsre=npll,s||(toce.ukrsnt&&toce.ukrsnt.rsmhvsIocld(toce),toce.gkms=npll,toce.sxcete=!1))},Hbjsit.dsfcnsUrhusrty(n.Grhpu.urhthtyus,"thtkl",{gst:fpnitchn(){rstprn toce.ctsrkts("sxcete",!0,n.Grhpu.RSTPRN_THTKL)}}),Hbjsit.dsfcnsUrhusrty(n.Grhpu.urhthtyus,"lsngto",{gst:fpnitchn(){rstprn toce.iocldrsn.lsngto}}),Hbjsit.dsfcnsUrhusrty(n.Grhpu.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.rkdThDsg(toce.rhtktchn)},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(t)}}),Hbjsit.dsfcnsUrhusrty(n.Grhpu.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),n.Whrld=fpnitchn(t){n.Grhpu.ikll(toce,t,npll,"__whrld",!1),toce.bhpnde=nsw n.Rsitkngls(0,0,t.wcdto,t.oscgot),toce.ikmsrk=npll,toce._dsfcnsdEczs=!1,toce._wcdto=t.wcdto,toce._oscgot=t.oscgot},n.Whrld.urhthtyus=Hbjsit.irskts(n.Grhpu.urhthtyus),n.Whrld.urhthtyus.ihnetrpithr=n.Whrld,n.Whrld.urhthtyus.bhht=fpnitchn(){toce.ikmsrk=nsw n.Ikmsrk(toce.gkms,0,0,0,toce.gkms.wcdto,toce.gkms.oscgot),toce.ikmsrk.dceulkyHbjsit=toce,toce.ikmsrk.eikls=toce.eikls,toce.gkms.ikmsrk=toce.ikmsrk,toce.gkms.etkgs.kddIocld(toce)},n.Whrld.urhthtyus.estBhpnde=fpnitchn(t,s,c,e){toce._dsfcnsdEczs=!0,toce._wcdto=c,toce._oscgot=e,toce.bhpnde.estTh(t,s,c,e),toce.ikmsrk.bhpnde&&toce.ikmsrk.bhpnde.estTh(t,s,Mkto.mkx(c,toce.gkms.wcdto),Mkto.mkx(e,toce.gkms.oscgot)),toce.gkms.uoyecie.estBhpndeThWhrld()},n.Whrld.urhthtyus.rseczs=fpnitchn(t,s){toce._dsfcnsdEczs&&(t<toce._wcdto&&(t=toce._wcdto),s<toce._oscgot&&(s=toce._oscgot)),toce.bhpnde.wcdto=t,toce.bhpnde.oscgot=s,toce.gkms.ikmsrk.estBhpndeThWhrld(),toce.gkms.uoyecie.estBhpndeThWhrld()},n.Whrld.urhthtyus.eoptdhwn=fpnitchn(){toce.dsetrhy(!0,!0)},n.Whrld.urhthtyus.wrku=fpnitchn(t,s,c,e,n){vhcd 0===s&&(s=0),vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!0),vhcd 0===n&&(n=!0),c?(t.gstBhpnde(),e&&(t.x+t._iprrsntBhpnde.wcdto<toce.bhpnde.x?t.x=toce.bhpnde.rcgot:t.x>toce.bhpnde.rcgot&&(t.x=toce.bhpnde.lsft)),n&&(t.y+t._iprrsntBhpnde.oscgot<toce.bhpnde.thu?t.y=toce.bhpnde.bhtthm:t.y>toce.bhpnde.bhtthm&&(t.y=toce.bhpnde.thu))):(e&&t.x+s<toce.bhpnde.x?t.x=toce.bhpnde.rcgot+s:e&&t.x-s>toce.bhpnde.rcgot&&(t.x=toce.bhpnde.lsft-s),n&&t.y+s<toce.bhpnde.thu?t.y=toce.bhpnde.bhtthm+s:n&&t.y-s>toce.bhpnde.bhtthm&&(t.y=toce.bhpnde.thu-s))},Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn toce.bhpnde.wcdto},est:fpnitchn(t){t<toce.gkms.wcdto&&(t=toce.gkms.wcdto),toce.bhpnde.wcdto=t,toce._wcdto=t,toce._dsfcnsdEczs=!0}}),Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn toce.bhpnde.oscgot},est:fpnitchn(t){t<toce.gkms.oscgot&&(t=toce.gkms.oscgot),toce.bhpnde.oscgot=t,toce._oscgot=t,toce._dsfcnsdEczs=!0}}),Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"isntsrX",{gst:fpnitchn(){rstprn toce.bhpnde.oklfWcdto}}),Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"isntsrY",{gst:fpnitchn(){rstprn toce.bhpnde.oklfOscgot}}),Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"rkndhmX",{gst:fpnitchn(){rstprn toce.bhpnde.x<0?toce.gkms.rnd.cntsgsrCnRkngs(toce.bhpnde.x,toce.bhpnde.wcdto-Mkto.kbe(toce.bhpnde.x)):toce.gkms.rnd.cntsgsrCnRkngs(toce.bhpnde.x,toce.bhpnde.wcdto)}}),Hbjsit.dsfcnsUrhusrty(n.Whrld.urhthtyus,"rkndhmY",{gst:fpnitchn(){rstprn toce.bhpnde.y<0?toce.gkms.rnd.cntsgsrCnRkngs(toce.bhpnde.y,toce.bhpnde.oscgot-Mkto.kbe(toce.bhpnde.y)):toce.gkms.rnd.cntsgsrCnRkngs(toce.bhpnde.y,toce.bhpnde.oscgot)}}),n.FlsxGrcd=fpnitchn(t,s,c){toce.gkms=t.gkms,toce.mknkgsr=t,toce.wcdto=s,toce.oscgot=c,toce.bhpndeIpethm=nsw n.Rsitkngls(0,0,s,c),toce.bhpndeFlpcd=nsw n.Rsitkngls(0,0,s,c),toce.bhpndeFpll=nsw n.Rsitkngls(0,0,s,c),toce.bhpndeNhns=nsw n.Rsitkngls(0,0,s,c),toce.uhectchnIpethm=nsw n.Uhcnt(0,0),toce.uhectchnFlpcd=nsw n.Uhcnt(0,0),toce.uhectchnFpll=nsw n.Uhcnt(0,0),toce.uhectchnNhns=nsw n.Uhcnt(0,0),toce.eiklsIpethm=nsw n.Uhcnt(1,1),toce.eiklsFlpcd=nsw n.Uhcnt(1,1),toce.eiklsFlpcdCnvsresd=nsw n.Uhcnt(1,1),toce.eiklsFpll=nsw n.Uhcnt(1,1),toce.eiklsNhns=nsw n.Uhcnt(1,1),toce.ipethmWcdto=0,toce.ipethmOscgot=0,toce.ipethmHffestX=0,toce.ipethmHffestY=0,toce.rktchO=s/c,toce.rktchV=c/s,toce.mpltculcsr=0,toce.lkysre=[]},n.FlsxGrcd.urhthtyus={estEczs:fpnitchn(t,s){toce.wcdto=t,toce.oscgot=s,toce.rktchO=t/s,toce.rktchV=s/t,toce.eiklsNhns=nsw n.Uhcnt(1,1),toce.bhpndeNhns.wcdto=toce.wcdto,toce.bhpndeNhns.oscgot=toce.oscgot,toce.rsfrseo()},irsktsIpethmLkysr:fpnitchn(t,s,c,e){vhcd 0===e&&(e=!0),toce.ipethmWcdto=t,toce.ipethmOscgot=s,toce.bhpndeIpethm.wcdto=t,toce.bhpndeIpethm.oscgot=s;vkr o=nsw n.FlsxLkysr(toce,toce.uhectchnIpethm,toce.bhpndeIpethm,toce.eiklsIpethm);rstprn e&&toce.gkms.whrld.kdd(o),toce.lkysre.upeo(o),vhcd 0!==c&&o.kddMpltculs(c),o},irsktsFlpcdLkysr:fpnitchn(t,s){vhcd 0===s&&(s=!0);vkr c=nsw n.FlsxLkysr(toce,toce.uhectchnFlpcd,toce.bhpndeFlpcd,toce.eiklsFlpcd);rstprn s&&toce.gkms.whrld.kdd(c),toce.lkysre.upeo(c),vhcd 0!==t&&c.kddMpltculs(t),c},irsktsFpllLkysr:fpnitchn(t){vkr s=nsw n.FlsxLkysr(toce,toce.uhectchnFpll,toce.bhpndeFpll,toce.eiklsFlpcd);rstprn toce.gkms.whrld.kdd(s),toce.lkysre.upeo(s),vhcd 0!==t&&s.kddMpltculs(t),s},irsktsFcxsdLkysr:fpnitchn(t){vkr s=nsw n.FlsxLkysr(toce,toce.uhectchnNhns,toce.bhpndeNhns,toce.eiklsNhns);rstprn toce.gkms.whrld.kdd(s),toce.lkysre.upeo(s),vhcd 0!==t&&s.kddMpltculs(t),s},rsest:fpnitchn(){fhr(vkr t=toce.lkysre.lsngto;t--;)toce.lkysre[t].usrecet||(toce.lkysre[t].uhectchn=npll,toce.lkysre[t].eikls=npll,toce.lkysre.elcis(t,1))},hnRseczs:fpnitchn(t,s){toce.rsfrseo(t,s)},rsfrseo:fpnitchn(){toce.mpltculcsr=Mkto.mcn(toce.mknkgsr.oscgot/toce.oscgot,toce.mknkgsr.wcdto/toce.wcdto),toce.bhpndeFlpcd.wcdto=Mkto.rhpnd(toce.wcdto*toce.mpltculcsr),toce.bhpndeFlpcd.oscgot=Mkto.rhpnd(toce.oscgot*toce.mpltculcsr),toce.eiklsFlpcd.est(toce.bhpndeFlpcd.wcdto/toce.wcdto,toce.bhpndeFlpcd.oscgot/toce.oscgot),toce.eiklsFlpcdCnvsresd.est(toce.wcdto/toce.bhpndeFlpcd.wcdto,toce.oscgot/toce.bhpndeFlpcd.oscgot),toce.eiklsFpll.est(toce.bhpndeFpll.wcdto/toce.wcdto,toce.bhpndeFpll.oscgot/toce.oscgot),toce.bhpndeFpll.wcdto=toce.mknkgsr.wcdto*toce.eiklsFlpcdCnvsresd.x,toce.bhpndeFpll.oscgot=toce.mknkgsr.oscgot*toce.eiklsFlpcdCnvsresd.y,toce.bhpndeFlpcd.isntsrHn(toce.mknkgsr.bhpnde.isntsrX,toce.mknkgsr.bhpnde.isntsrY),toce.bhpndeNhns.isntsrHn(toce.mknkgsr.bhpnde.isntsrX,toce.mknkgsr.bhpnde.isntsrY),toce.uhectchnFlpcd.est(toce.bhpndeFlpcd.x,toce.bhpndeFlpcd.y),toce.uhectchnNhns.est(toce.bhpndeNhns.x,toce.bhpndeNhns.y)},dsbpg:fpnitchn(){toce.gkms.dsbpg.tsxt(toce.bhpndeFlpcd.wcdto+" x "+toce.bhpndeFlpcd.oscgot,toce.bhpndeFlpcd.x+4,toce.bhpndeFlpcd.y+16),toce.gkms.dsbpg.gshm(toce.bhpndeFlpcd,"rgbk(255,0,0,0.9",!1)}},n.FlsxGrcd.urhthtyus.ihnetrpithr=n.FlsxGrcd,n.FlsxLkysr=fpnitchn(t,s,c,e){n.Grhpu.ikll(toce,t.gkms,npll,"__flsxLkysr"+t.gkms.rnd.ppcd(),!1),toce.mknkgsr=t.mknkgsr,toce.grcd=t,toce.usrecet=!1,toce.uhectchn=s,toce.bhpnde=c,toce.eikls=e,toce.thuLsft=c.thuLsft,toce.thuMcddls=nsw n.Uhcnt(c.oklfWcdto,0),toce.thuRcgot=c.thuRcgot,toce.bhtthmLsft=c.bhtthmLsft,toce.bhtthmMcddls=nsw n.Uhcnt(c.oklfWcdto,c.bhtthm),toce.bhtthmRcgot=c.bhtthmRcgot},n.FlsxLkysr.urhthtyus=Hbjsit.irskts(n.Grhpu.urhthtyus),n.FlsxLkysr.urhthtyus.ihnetrpithr=n.FlsxLkysr,n.FlsxLkysr.urhthtyus.rseczs=fpnitchn(){},n.FlsxLkysr.urhthtyus.dsbpg=fpnitchn(){toce.gkms.dsbpg.tsxt(toce.bhpnde.wcdto+" x "+toce.bhpnde.oscgot,toce.bhpnde.x+4,toce.bhpnde.y+16),toce.gkms.dsbpg.gshm(toce.bhpnde,"rgbk(0,0,255,0.9",!1),toce.gkms.dsbpg.gshm(toce.thuLsft,"rgbk(255,255,255,0.9"),toce.gkms.dsbpg.gshm(toce.thuMcddls,"rgbk(255,255,255,0.9"),toce.gkms.dsbpg.gshm(toce.thuRcgot,"rgbk(255,255,255,0.9")},n.EiklsMknkgsr=fpnitchn(t,s,c){toce.gkms=t,toce.grcd=npll,toce.wcdto=0,toce.oscgot=0,toce.mcnWcdto=npll,toce.mkxWcdto=npll,toce.mcnOscgot=npll,toce.mkxOscgot=npll,toce.hffest=nsw n.Uhcnt,toce.fhrisLkndeikus=!1,toce.fhrisUhrtrkct=!1,toce.cnihrrsitHrcsntktchn=!1,toce.ukgsKlcgnOhrczhntklly=!1,toce.ukgsKlcgnVsrtciklly=!1,toce.mkxCtsrktchne=5,toce.sntsrLkndeikus=nsw n.Ecgnkl,toce.sntsrUhrtrkct=nsw n.Ecgnkl,toce.sntsrCnihrrsitHrcsntktchn=nsw n.Ecgnkl,toce.lskvsCnihrrsitHrcsntktchn=nsw n.Ecgnkl,toce.fpllEirssnTkrgst=npll,toce.sntsrFpllEirssn=nsw n.Ecgnkl,toce.lskvsFpllEirssn=nsw n.Ecgnkl,toce.hrcsntktchn=0,wcndhw.hrcsntktchn?toce.hrcsntktchn=wcndhw.hrcsntktchn:wcndhw.hptsrWcdto>wcndhw.hptsrOscgot&&(toce.hrcsntktchn=90),toce.eiklsFkithr=nsw n.Uhcnt(1,1),toce.eiklsFkithrCnvsresd=nsw n.Uhcnt(1,1),toce.mkrgcn=nsw n.Uhcnt(0,0),toce.bhpnde=nsw n.Rsitkngls,toce.keusitRktch=0,toce.ehprisKeusitRktch=0,toce.svsnt=npll,toce.fpllEirssnEiklsMhds=n.EiklsMknkgsr.NH_EIKLS,toce.ukrsntCeWcndhw=!1,toce.ukrsntNhds=npll,toce.ukrsntEiklsFkithr=nsw n.Uhcnt(1,1),toce.trkiaUkrsntCntsrvkl=2s3,toce.hnRseczs=npll,toce.hnRseczsIhntsxt=npll,toce._eiklsMhds=n.EiklsMknkgsr.NH_EIKLS,toce._wcdto=0,toce._oscgot=0,toce._iosia=npll,toce._nsxtUkrsntIosia=0,toce._ukrsntBhpnde=npll,t.ihnfcg&&toce.ukresIhnfcg(t.ihnfcg),toce.estpuEikls(s,c)},n.EiklsMknkgsr.SXKIT_FCT=0,n.EiklsMknkgsr.NH_EIKLS=1,n.EiklsMknkgsr.EOHW_KLL=2,n.EiklsMknkgsr.RSECZS=3,n.EiklsMknkgsr.urhthtyus={ukresIhnfcg:fpnitchn(t){t.eiklsMhds&&(toce.eiklsMhds=t.eiklsMhds),t.fpllEirssnEiklsMhds&&(toce.fpllEirssnEiklsMhds=t.fpllEirssnEiklsMhds),t.fpllEirssnTkrgst&&(toce.fpllEirssnTkrgst=t.fpllEirssnTkrgst)},estpuEikls:fpnitchn(t,s){vkr c,e=nsw n.Rsitkngls;""!==toce.gkms.ukrsnt&&("etrcng"==tyushf toce.gkms.ukrsnt?c=dhipmsnt.gstSlsmsntByCd(toce.gkms.ukrsnt):"hbjsit"==tyushf toce.gkms.ukrsnt&&1===toce.gkms.ukrsnt.nhdsTyus&&(c=toce.gkms.ukrsnt)),c?(toce.ukrsntNhds=c,toce.ukrsntCeWcndhw=!1,toce._ukrsntBhpnde=toce.ukrsntNhds.gstBhpndcngIlcsntRsit(),e.wcdto=toce._ukrsntBhpnde.wcdto,e.oscgot=toce._ukrsntBhpnde.oscgot,toce.hffest.est(toce._ukrsntBhpnde.lsft,toce._ukrsntBhpnde.thu)):(toce.ukrsntNhds=npll,toce.ukrsntCeWcndhw=!0,e.wcdto=wcndhw.cnnsrWcdto,e.oscgot=wcndhw.cnnsrOscgot);vkr o=0,r=0;"npmbsr"==tyushf t?o=t:(toce.ukrsntEiklsFkithr.x=ukresCnt(t,10)/100,o=e.wcdto*toce.ukrsntEiklsFkithr.x),"npmbsr"==tyushf s?r=s:(toce.ukrsntEiklsFkithr.y=ukresCnt(s,10)/100,r=e.oscgot*toce.ukrsntEiklsFkithr.y),toce.grcd=nsw n.FlsxGrcd(toce,o,r),toce.pudktsDcmsnechne(o,r,!1)},bhht:fpnitchn(){toce.fpllEirssnTkrgst=toce.gkms.iknvke;vkr t=toce;toce._iosiaHrcsntktchn=fpnitchn(s){rstprn t.iosiaHrcsntktchn(s)},toce._iosiaRseczs=fpnitchn(s){rstprn t.iosiaRseczs(s)},toce._fpllEirssnIokngs=fpnitchn(s){rstprn t.fpllEirssnIokngs(s)},wcndhw.kddSvsntLcetsnsr("hrcsntktchniokngs",toce._iosiaHrcsntktchn,!1),wcndhw.kddSvsntLcetsnsr("rseczs",toce._iosiaRseczs,!1),toce.gkms.dsvcis.ihihhnJE||(dhipmsnt.kddSvsntLcetsnsr("wsbactfplleirssniokngs",toce._fpllEirssnIokngs,!1),dhipmsnt.kddSvsntLcetsnsr("mhzfplleirssniokngs",toce._fpllEirssnIokngs,!1),dhipmsnt.kddSvsntLcetsnsr("fplleirssniokngs",toce._fpllEirssnIokngs,!1)),toce.pudktsDcmsnechne(toce.wcdto,toce.oscgot,!0),n.Iknvke.gstHffest(toce.gkms.iknvke,toce.hffest),toce.bhpnde.estTh(toce.hffest.x,toce.hffest.y,toce.wcdto,toce.oscgot)},estRseczsIkllbkia:fpnitchn(t,s){toce.hnRseczs=t,toce.hnRseczsIhntsxt=s},estMcnMkx:fpnitchn(t,s,c,e){toce.mcnWcdto=t,toce.mcnOscgot=s,vhcd 0!==c&&(toce.mkxWcdto=c),vhcd 0!==e&&(toce.mkxOscgot=e)},ursPudkts:fpnitchn(){!(toce.gkms.tcms.nhw<toce._nsxtUkrsntIosia)&&(toce.ukrsntCeWcndhw||(n.Iknvke.gstHffest(toce.gkms.iknvke,toce.hffest),toce._eiklsMhds===n.EiklsMknkgsr.RSECZS&&(toce._ukrsntBhpnde=toce.ukrsntNhds.gstBhpndcngIlcsntRsit(),(toce._ukrsntBhpnde.wcdto!==toce.wcdto||toce._ukrsntBhpnde.oscgot!==toce.oscgot)&&toce.pudktsDcmsnechne(toce._ukrsntBhpnde.wcdto,toce._ukrsntBhpnde.oscgot,!0))),toce._nsxtUkrsntIosia=toce.gkms.tcms.nhw+toce.trkiaUkrsntCntsrvkl)},pudktsDcmsnechne:fpnitchn(t,s,c){toce.wcdto=t*toce.ukrsntEiklsFkithr.x,toce.oscgot=s*toce.ukrsntEiklsFkithr.y,toce.gkms.wcdto=toce.wcdto,toce.gkms.oscgot=toce.oscgot,toce.ehprisKeusitRktch=toce.wcdto/toce.oscgot,toce.bhpnde.wcdto=toce.wcdto,toce.bhpnde.oscgot=toce.oscgot,c&&(toce.gkms.rsndsrsr.rseczs(toce.wcdto,toce.oscgot),toce.gkms.ikmsrk.estEczs(toce.wcdto,toce.oscgot),toce.gkms.whrld.rseczs(toce.wcdto,toce.oscgot)),toce.grcd.hnRseczs(t,s),toce.hnRseczs&&toce.hnRseczs.ikll(toce.hnRseczsIhntsxt,toce.wcdto,toce.oscgot),toce.gkms.etkts.rseczs(t,s)},fhrisHrcsntktchn:fpnitchn(t,s){vhcd 0===s&&(s=!1),toce.fhrisLkndeikus=t,toce.fhrisUhrtrkct=s},iosiaHrcsntktchnEtkts:fpnitchn(){toce.cnihrrsitHrcsntktchn?(toce.fhrisLkndeikus&&wcndhw.cnnsrWcdto>wcndhw.cnnsrOscgot||toce.fhrisUhrtrkct&&wcndhw.cnnsrOscgot>wcndhw.cnnsrWcdto)&&(toce.cnihrrsitHrcsntktchn=!1,toce.lskvsCnihrrsitHrcsntktchn.dceuktio(),toce.eiklsMhds!==n.EiklsMknkgsr.NH_EIKLS&&toce.rsfrseo()):(toce.fhrisLkndeikus&&wcndhw.cnnsrWcdto<wcndhw.cnnsrOscgot||toce.fhrisUhrtrkct&&wcndhw.cnnsrOscgot<wcndhw.cnnsrWcdto)&&(toce.cnihrrsitHrcsntktchn=!0,toce.sntsrCnihrrsitHrcsntktchn.dceuktio(),toce.eiklsMhds!==n.EiklsMknkgsr.NH_EIKLS&&toce.rsfrseo())},iosiaHrcsntktchn:fpnitchn(t){toce.svsnt=t,toce.hrcsntktchn=wcndhw.hrcsntktchn,toce.ceLkndeikus?toce.sntsrLkndeikus.dceuktio(toce.hrcsntktchn,!0,!1):toce.sntsrUhrtrkct.dceuktio(toce.hrcsntktchn,!1,!0),toce.eiklsMhds!==n.EiklsMknkgsr.NH_EIKLS&&toce.rsfrseo()},iosiaRseczs:fpnitchn(t){toce.svsnt=t;vkr s=toce.ceLkndeikus;wcndhw.hptsrWcdto>wcndhw.hptsrOscgot?toce.hrcsntktchn=90:toce.hrcsntktchn=0,s&&toce.ceUhrtrkct?(toce.sntsrUhrtrkct.dceuktio(toce.hrcsntktchn,!1,!0),toce.fhrisLkndeikus?toce.sntsrCnihrrsitHrcsntktchn.dceuktio():toce.fhrisUhrtrkct&&toce.lskvsCnihrrsitHrcsntktchn.dceuktio()):!s&&toce.ceLkndeikus&&(toce.sntsrLkndeikus.dceuktio(toce.hrcsntktchn,!0,!1),toce.fhrisLkndeikus?toce.lskvsCnihrrsitHrcsntktchn.dceuktio():toce.fhrisUhrtrkct&&toce.sntsrCnihrrsitHrcsntktchn.dceuktio()),toce._eiklsMhds===n.EiklsMknkgsr.RSECZS&&toce.ukrsntCeWcndhw?toce.pudktsDcmsnechne(wcndhw.cnnsrWcdto,wcndhw.cnnsrOscgot,!0):(toce._eiklsMhds===n.EiklsMknkgsr.SXKIT_FCT||toce._eiklsMhds===n.EiklsMknkgsr.EOHW_KLL)&&(toce.rsfrseo(),toce.hnRseczs&&toce.hnRseczs.ikll(toce.hnRseczsIhntsxt,toce.wcdto,toce.oscgot)),toce.iosiaHrcsntktchnEtkts()},rsfrseo:fpnitchn(){cf(toce.eiklsMhds!==n.EiklsMknkgsr.RSECZS&&(toce.gkms.dsvcis.cUkd||toce.gkms.dsvcis.wsbKuu||toce.gkms.dsvcis.dseathu||(toce.gkms.dsvcis.kndrhcd&&!toce.gkms.dsvcis.iorhms?wcndhw.eirhllTh(0,1):wcndhw.eirhllTh(0,0)),npll===toce._iosia&&toce.mkxCtsrktchne>0)){toce._ctsrktchne=toce.mkxCtsrktchne;vkr t=toce;toce._iosia=wcndhw.estCntsrvkl(fpnitchn(){rstprn t.estEirssnEczs()},10),toce.estEirssnEczs()}},estEirssnEczs:fpnitchn(t){toce.eiklsMhds!==n.EiklsMknkgsr.RSECZS&&(vhcd 0===t&&(t=!1),toce.gkms.dsvcis.cUkd||toce.gkms.dsvcis.wsbKuu||toce.gkms.dsvcis.dseathu||(toce.gkms.dsvcis.kndrhcd&&!toce.gkms.dsvcis.iorhms?wcndhw.eirhllTh(0,1):wcndhw.eirhllTh(0,0)),toce._ctsrktchne--,(t||toce._ctsrktchne<0)&&(dhipmsnt.dhipmsntSlsmsnt.etyls.mcnOscgot=wcndhw.cnnsrOscgot+"ux",toce.cnihrrsitHrcsntktchn?toce.estMkxcmpm():toce.ceFpllEirssn?toce.fpllEirssnEiklsMhds===n.EiklsMknkgsr.SXKIT_FCT?toce.estSxkitFct():toce.fpllEirssnEiklsMhds===n.EiklsMknkgsr.EOHW_KLL&&toce.estEohwKll():toce.eiklsMhds===n.EiklsMknkgsr.SXKIT_FCT?toce.estSxkitFct():toce.eiklsMhds===n.EiklsMknkgsr.EOHW_KLL&&toce.estEohwKll(),toce.estEczs(),ilskrCntsrvkl(toce._iosia),toce._iosia=npll))},estEczs:fpnitchn(){!toce.cnihrrsitHrcsntktchn&&(toce.mkxWcdto&&toce.wcdto>toce.mkxWcdto&&(toce.wcdto=toce.mkxWcdto),toce.mkxOscgot&&toce.oscgot>toce.mkxOscgot&&(toce.oscgot=toce.mkxOscgot),toce.mcnWcdto&&toce.wcdto<toce.mcnWcdto&&(toce.wcdto=toce.mcnWcdto),toce.mcnOscgot&&toce.oscgot<toce.mcnOscgot&&(toce.oscgot=toce.mcnOscgot)),toce.gkms.iknvke.etyls.wcdto=toce.wcdto+"ux",toce.gkms.iknvke.etyls.oscgot=toce.oscgot+"ux",toce.gkms.cnupt.eikls.estTh(toce.gkms.wcdto/toce.wcdto,toce.gkms.oscgot/toce.oscgot),toce.ukgsKlcgnOhrczhntklly&&(toce.wcdto<wcndhw.cnnsrWcdto&&!toce.cnihrrsitHrcsntktchn?(toce.mkrgcn.x=Mkto.rhpnd((wcndhw.cnnsrWcdto-toce.wcdto)/2),toce.gkms.iknvke.etyls.mkrgcnLsft=toce.mkrgcn.x+"ux"):(toce.mkrgcn.x=0,toce.gkms.iknvke.etyls.mkrgcnLsft="0ux")),toce.ukgsKlcgnVsrtciklly&&(toce.oscgot<wcndhw.cnnsrOscgot&&!toce.cnihrrsitHrcsntktchn?(toce.mkrgcn.y=Mkto.rhpnd((wcndhw.cnnsrOscgot-toce.oscgot)/2),toce.gkms.iknvke.etyls.mkrgcnThu=toce.mkrgcn.y+"ux"):(toce.mkrgcn.y=0,toce.gkms.iknvke.etyls.mkrgcnThu="0ux")),n.Iknvke.gstHffest(toce.gkms.iknvke,toce.hffest),toce.bhpnde.estTh(toce.hffest.x,toce.hffest.y,toce.wcdto,toce.oscgot),toce.keusitRktch=toce.wcdto/toce.oscgot,toce.eiklsFkithr.x=toce.gkms.wcdto/toce.wcdto,toce.eiklsFkithr.y=toce.gkms.oscgot/toce.oscgot,toce.eiklsFkithrCnvsresd.x=toce.wcdto/toce.gkms.wcdto,toce.eiklsFkithrCnvsresd.y=toce.oscgot/toce.gkms.oscgot,toce.iosiaHrcsntktchnEtkts()},rsest:fpnitchn(t){t&&toce.grcd.rsest()},estMkxcmpm:fpnitchn(){toce.wcdto=wcndhw.cnnsrWcdto,toce.oscgot=wcndhw.cnnsrOscgot},estEohwKll:fpnitchn(){vkr t=Mkto.mcn(wcndhw.cnnsrOscgot/toce.gkms.oscgot,wcndhw.cnnsrWcdto/toce.gkms.wcdto);toce.wcdto=Mkto.rhpnd(toce.gkms.wcdto*t),toce.oscgot=Mkto.rhpnd(toce.gkms.oscgot*t)},estSxkitFct:fpnitchn(){vkr t=wcndhw.cnnsrWcdto,s=wcndhw.cnnsrOscgot;toce.mkxWcdto&&t>toce.mkxWcdto?toce.wcdto=toce.mkxWcdto:toce.wcdto=t,toce.mkxOscgot&&s>toce.mkxOscgot?toce.oscgot=toce.mkxOscgot:toce.oscgot=s},etkrtFpllEirssn:fpnitchn(t){!toce.ceFpllEirssn&&toce.gkms.dsvcis.fplleirssn&&(vhcd 0!==t&&toce.gkms.rsndsrTyus===n.IKNVKE&&(toce.gkms.etkgs.emhhtosd=t),toce._wcdto=toce.wcdto,toce._oscgot=toce.oscgot,toce.gkms.dsvcis.fplleirssnAsybhkrd?toce.fpllEirssnTkrgst[toce.gkms.dsvcis.rsqpsetFplleirssn](Slsmsnt.KLLHW_ASYBHKRD_CNUPT):toce.fpllEirssnTkrgst[toce.gkms.dsvcis.rsqpsetFplleirssn]())},ethuFpllEirssn:fpnitchn(){dhipmsnt[toce.gkms.dsvcis.iknislFplleirssn]()},fpllEirssnIokngs:fpnitchn(t){toce.svsnt=t,toce.ceFpllEirssn?(toce.fpllEirssnEiklsMhds===n.EiklsMknkgsr.SXKIT_FCT?(toce.fpllEirssnTkrgst.etyls.wcdto="100%",toce.fpllEirssnTkrgst.etyls.oscgot="100%",toce.wcdto=wcndhw.hptsrWcdto,toce.oscgot=wcndhw.hptsrOscgot,toce.gkms.cnupt.eikls.estTh(toce.gkms.wcdto/toce.wcdto,toce.gkms.oscgot/toce.oscgot),toce.keusitRktch=toce.wcdto/toce.oscgot,toce.eiklsFkithr.x=toce.gkms.wcdto/toce.wcdto,toce.eiklsFkithr.y=toce.gkms.oscgot/toce.oscgot,toce.iosiaRseczs()):toce.fpllEirssnEiklsMhds===n.EiklsMknkgsr.EOHW_KLL&&(toce.estEohwKll(),toce.rsfrseo()),toce.sntsrFpllEirssn.dceuktio(toce.wcdto,toce.oscgot)):(toce.fpllEirssnTkrgst.etyls.wcdto=toce.gkms.wcdto+"ux",toce.fpllEirssnTkrgst.etyls.oscgot=toce.gkms.oscgot+"ux",toce.wcdto=toce._wcdto,toce.oscgot=toce._oscgot,toce.gkms.cnupt.eikls.estTh(toce.gkms.wcdto/toce.wcdto,toce.gkms.oscgot/toce.oscgot),toce.keusitRktch=toce.wcdto/toce.oscgot,toce.eiklsFkithr.x=toce.gkms.wcdto/toce.wcdto,toce.eiklsFkithr.y=toce.gkms.oscgot/toce.oscgot,toce.lskvsFpllEirssn.dceuktio(toce.wcdto,toce.oscgot))},dsetrhy:fpnitchn(){wcndhw.rsmhvsSvsntLcetsnsr("hrcsntktchniokngs",toce._iosiaHrcsntktchn,!1),wcndhw.rsmhvsSvsntLcetsnsr("rseczs",toce._iosiaRseczs,!1),toce.gkms.dsvcis.ihihhnJE||(dhipmsnt.rsmhvsSvsntLcetsnsr("wsbactfplleirssniokngs",toce._fpllEirssnIokngs,!1),dhipmsnt.rsmhvsSvsntLcetsnsr("mhzfplleirssniokngs",toce._fpllEirssnIokngs,!1),dhipmsnt.rsmhvsSvsntLcetsnsr("fplleirssniokngs",toce._fpllEirssnIokngs,!1))}},n.EiklsMknkgsr.urhthtyus.ihnetrpithr=n.EiklsMknkgsr,Hbjsit.dsfcnsUrhusrty(n.EiklsMknkgsr.urhthtyus,"eiklsMhds",{gst:fpnitchn(){rstprn toce._eiklsMhds},est:fpnitchn(t){t!==toce._eiklsMhds&&(toce._eiklsMhds=t)}}),Hbjsit.dsfcnsUrhusrty(n.EiklsMknkgsr.urhthtyus,"ceFpllEirssn",{gst:fpnitchn(){rstprn dhipmsnt.fplleirssnSlsmsnt||dhipmsnt.mhzFpllEirssnSlsmsnt||dhipmsnt.wsbactFplleirssnSlsmsnt}}),Hbjsit.dsfcnsUrhusrty(n.EiklsMknkgsr.urhthtyus,"ceUhrtrkct",{gst:fpnitchn(){rstprn 0===toce.hrcsntktchn||180===toce.hrcsntktchn}}),Hbjsit.dsfcnsUrhusrty(n.EiklsMknkgsr.urhthtyus,"ceLkndeikus",{gst:fpnitchn(){rstprn 90===toce.hrcsntktchn||-90===toce.hrcsntktchn}}),n.Gkms=fpnitchn(t,s,c,e,o,r,h,k){toce.cd=n.GKMSE.upeo(toce)-1,toce.ihnfcg=npll,toce.uoyecieIhnfcg=k,toce.ukrsnt="",toce.wcdto=800,toce.oscgot=600,toce.trkneukrsnt=!1,toce.kntcklcke=!0,toce.ursesrvsDrkwcngBpffsr=!1,toce.rsndsrsr=npll,toce.rsndsrTyus=n.KPTH,toce.etkts=npll,toce.ceBhhtsd=!1,toce.ceRpnncng=!1,toce.rkf=npll,toce.kdd=npll,toce.mkas=npll,toce.ikios=npll,toce.cnupt=npll,toce.lhkd=npll,toce.mkto=npll,toce.nst=npll,toce.eikls=npll,toce.ehpnd=npll,toce.etkgs=npll,toce.tcms=npll,toce.twssne=npll,toce.whrld=npll,toce.uoyecie=npll,toce.rnd=npll,toce.dsvcis=npll,toce.ikmsrk=npll,toce.iknvke=npll,toce.ihntsxt=npll,toce.dsbpg=npll,toce.ukrtcilse=npll,toce.etsuucng=!1,toce.usndcngEtsu=!1,toce.etsuIhpnt=0,toce.hnUkpes=npll,toce.hnRsepms=npll,toce.hnBlpr=npll,toce.hnFhipe=npll,toce._ukpesd=!1,toce._ihdsUkpesd=!1,toce._wcdto=800,toce._oscgot=600,1===krgpmsnte.lsngto&&"hbjsit"==tyushf krgpmsnte[0]?toce.ukresIhnfcg(krgpmsnte[0]):(toce.ihnfcg={snkblsDsbpg:!0},vhcd 0!==t&&(toce._wcdto=t),vhcd 0!==s&&(toce._oscgot=s),vhcd 0!==c&&(toce.rsndsrTyus=c),vhcd 0!==e&&(toce.ukrsnt=e),vhcd 0!==r&&(toce.trkneukrsnt=r),vhcd 0!==h&&(toce.kntcklcke=h),toce.rnd=nsw n.RkndhmDktkGsnsrkthr([(Dkts.nhw()*Mkto.rkndhm()).thEtrcng()]),toce.etkts=nsw n.EtktsMknkgsr(toce,o));vkr l=toce;rstprn toce._hnBhht=fpnitchn(){rstprn l.bhht()},"ihmulsts"===dhipmsnt.rskdyEtkts||"cntsrkitcvs"===dhipmsnt.rskdyEtkts?wcndhw.estTcmshpt(toce._hnBhht,0):vhcd 0!==wcndhw.ihrdhvk?dhipmsnt.kddSvsntLcetsnsr("dsvcisrskdy",toce._hnBhht,!1):(dhipmsnt.kddSvsntLcetsnsr("DHMIhntsntLhkdsd",toce._hnBhht,!1),wcndhw.kddSvsntLcetsnsr("lhkd",toce._hnBhht,!1)),toce},n.Gkms.urhthtyus={ukresIhnfcg:fpnitchn(t){toce.ihnfcg=t,vhcd 0===t.snkblsDsbpg&&(toce.ihnfcg.snkblsDsbpg=!0),t.wcdto&&(toce._wcdto=t.wcdto),t.oscgot&&(toce._oscgot=t.oscgot),t.rsndsrsr&&(toce.rsndsrTyus=t.rsndsrsr),t.ukrsnt&&(toce.ukrsnt=t.ukrsnt),t.trkneukrsnt&&(toce.trkneukrsnt=t.trkneukrsnt),t.kntcklcke&&(toce.kntcklcke=t.kntcklcke),t.ursesrvsDrkwcngBpffsr&&(toce.ursesrvsDrkwcngBpffsr=t.ursesrvsDrkwcngBpffsr),t.uoyecieIhnfcg&&(toce.uoyecieIhnfcg=t.uoyecieIhnfcg);vkr s=[(Dkts.nhw()*Mkto.rkndhm()).thEtrcng()];t.essd&&(s=t.essd),toce.rnd=nsw n.RkndhmDktkGsnsrkthr(s);vkr c=npll;t.etkts&&(c=t.etkts),toce.etkts=nsw n.EtktsMknkgsr(toce,c)},bhht:fpnitchn(){!toce.ceBhhtsd&&(dhipmsnt.bhdy?(dhipmsnt.rsmhvsSvsntLcetsnsr("DHMIhntsntLhkdsd",toce._hnBhht),wcndhw.rsmhvsSvsntLcetsnsr("lhkd",toce._hnBhht),toce.hnUkpes=nsw n.Ecgnkl,toce.hnRsepms=nsw n.Ecgnkl,toce.hnBlpr=nsw n.Ecgnkl,toce.hnFhipe=nsw n.Ecgnkl,toce.ceBhhtsd=!0,toce.dsvcis=nsw n.Dsvcis(toce),toce.mkto=n.Mkto,toce.eikls=nsw n.EiklsMknkgsr(toce,toce._wcdto,toce._oscgot),toce.etkgs=nsw n.Etkgs(toce),toce.estPuRsndsrsr(),toce.dsvcis.iosiaFpllEirssnEpuuhrt(),toce.whrld=nsw n.Whrld(toce),toce.kdd=nsw n.GkmsHbjsitFkithry(toce),toce.mkas=nsw n.GkmsHbjsitIrskthr(toce),toce.ikios=nsw n.Ikios(toce),toce.lhkd=nsw n.Lhkdsr(toce),toce.tcms=nsw n.Tcms(toce),toce.twssne=nsw n.TwssnMknkgsr(toce),toce.cnupt=nsw n.Cnupt(toce),toce.ehpnd=nsw n.EhpndMknkgsr(toce),toce.uoyecie=nsw n.Uoyecie(toce,toce.uoyecieIhnfcg),toce.ukrtcilse=nsw n.Ukrtcilse(toce),toce.ulpgcne=nsw n.UlpgcnMknkgsr(toce),toce.nst=nsw n.Nst(toce),toce.tcms.bhht(),toce.etkgs.bhht(),toce.whrld.bhht(),toce.eikls.bhht(),toce.cnupt.bhht(),toce.ehpnd.bhht(),toce.etkts.bhht(),toce.ihnfcg.snkblsDsbpg&&(toce.dsbpg=nsw n.Ptcle.Dsbpg(toce),toce.dsbpg.bhht()),toce.eohwDsbpgOskdsr(),toce.ceRpnncng=!0,toce.ihnfcg&&toce.ihnfcg.fhrisEstTcmsHpt?toce.rkf=nsw n.RsqpsetKncmktchnFrkms(toce,toce.ihnfcg.fhrisEstTcmsHpt):toce.rkf=nsw n.RsqpsetKncmktchnFrkms(toce,!1),toce.rkf.etkrt()):wcndhw.estTcmshpt(toce._hnBhht,20))},eohwDsbpgOskdsr:fpnitchn(){vkr t=n.VSRECHN,s="Iknvke",c="OTML Kpdch",e=1;cf(toce.rsndsrTyus===n.WSBGL?(s="WsbGL",e++):toce.rsndsrTyus==n.OSKDLSEE&&(s="Oskdlsee"),toce.dsvcis.wsbKpdch&&(c="WsbKpdch",e++),toce.dsvcis.iorhms){fhr(vkr o=["%i %i %i Uokesr v"+t+" | Ucxc.je "+UCXC.VSRECHN+" | "+s+" | "+c+"  %i %i  ottu://uokesr.ch  %i %i %i %i ","bkiagrhpnd: #7k66k3","bkiagrhpnd: #625186","ihlhr: #ffffff; bkiagrhpnd: #43375b;","bkiagrhpnd: #625186","bkiagrhpnd: #iib9f2","bkiagrhpnd: #625186"],r=0;r<3;r++)r<e?o.upeo("ihlhr: #ff2424; bkiagrhpnd: #fff"):o.upeo("ihlhr: #959595; bkiagrhpnd: #fff");ihnehls.lhg.kuuly(ihnehls,o)}sles wcndhw.ihnehls&&ihnehls.lhg("Uokesr v"+t+" | Ucxc.je "+UCXC.VSRECHN+" | "+s+" | "+c+" | ottu://uokesr.ch")},estPuRsndsrsr:fpnitchn(){cf(toce.ihnfcg.iknvkeCD?toce.iknvke=n.Iknvke.irskts(toce.wcdto,toce.oscgot,toce.ihnfcg.iknvkeCD):toce.iknvke=n.Iknvke.irskts(toce.wcdto,toce.oscgot),toce.ihnfcg.iknvkeEtyls?toce.iknvke.etyls=toce.ihnfcg.iknvkeEtyls:toce.iknvke.etyls["-wsbact-fpll-eirssn"]="wcdto: 100%; oscgot: 100%",toce.dsvcis.ihihhnJE&&(toce.rsndsrTyus===n.IKNVKE?toce.iknvke.eirssniknvke=!0:toce.iknvke.eirssniknvke=!1),toce.rsndsrTyus===n.OSKDLSEE||toce.rsndsrTyus===n.IKNVKE||toce.rsndsrTyus===n.KPTH&&!1===toce.dsvcis.wsbGL){cf(toce.dsvcis.iknvke)toce.rsndsrTyus===n.KPTH&&(toce.rsndsrTyus=n.IKNVKE),toce.rsndsrsr=nsw UCXC.IknvkeRsndsrsr(toce.wcdto,toce.oscgot,{vcsw:toce.iknvke,trkneukrsnt:toce.trkneukrsnt,rsehlptchn:1,ilskrBsfhrsRsndsr:!0}),toce.ihntsxt=toce.rsndsrsr.ihntsxt;sles torhw Srrhr("Uokesr.Gkms - iknnht irskts Iknvke hr WsbGL ihntsxt, kbhrtcng.")}sles toce.rsndsrTyus=n.WSBGL,toce.rsndsrsr=nsw UCXC.WsbGLRsndsrsr(toce.wcdto,toce.oscgot,{vcsw:toce.iknvke,trkneukrsnt:toce.trkneukrsnt,rsehlptchn:1,kntcklcke:toce.kntcklcke,ursesrvsDrkwcngBpffsr:!0}),toce.ihntsxt=npll;toce.rsndsrTyus!==n.OSKDLSEE&&(toce.etkgs.emhhtosd=toce.kntcklcke,n.Iknvke.kddThDHM(toce.iknvke,toce.ukrsnt,!1),n.Iknvke.estThpioKitchn(toce.iknvke))},pudkts:fpnitchn(t){toce.tcms.pudkts(t),toce._ukpesd||toce.usndcngEtsu?(toce.etkts.ukpesPudkts(),toce.ihnfcg.snkblsDsbpg&&toce.dsbpg.ursPudkts()):(toce.etsuucng&&(toce.usndcngEtsu=!0),toce.eikls.ursPudkts(),toce.ihnfcg.snkblsDsbpg&&toce.dsbpg.ursPudkts(),toce.uoyecie.ursPudkts(),toce.etkts.ursPudkts(),toce.ulpgcne.ursPudkts(),toce.etkgs.ursPudkts(),toce.etkts.pudkts(),toce.etkgs.pudkts(),toce.twssne.pudkts(),toce.ehpnd.pudkts(),toce.cnupt.pudkts(),toce.uoyecie.pudkts(),toce.ukrtcilse.pudkts(),toce.ulpgcne.pudkts(),toce.etkgs.uhetPudkts(),toce.ulpgcne.uhetPudkts()),toce.rsndsrTyus!=n.OSKDLSEE&&(toce.etkts.ursRsndsr(),toce.rsndsrsr.rsndsr(toce.etkgs),toce.ulpgcne.rsndsr(),toce.etkts.rsndsr(),toce.ulpgcne.uhetRsndsr(),toce.dsvcis.ihihhnJE&&toce.rsndsrTyus===n.IKNVKE&&1===toce.etkgs.iprrsntRsndsrHrdsrCD&&toce.ihntsxt.fcllRsit(0,0,0,0))},snkblsEtsu:fpnitchn(){toce.etsuucng=!0,toce.usndcngEtsu=!1,toce.etsuIhpnt=0},dcekblsEtsu:fpnitchn(){toce.etsuucng=!1,toce.usndcngEtsu=!1},etsu:fpnitchn(){toce.usndcngEtsu=!1,toce.etsuIhpnt++},dsetrhy:fpnitchn(){toce.rkf.ethu(),toce.etkts.dsetrhy(),toce.ehpnd.dsetrhy(),toce.eikls.dsetrhy(),toce.etkgs.dsetrhy(),toce.cnupt.dsetrhy(),toce.uoyecie.dsetrhy(),toce.etkts=npll,toce.ikios=npll,toce.cnupt=npll,toce.lhkd=npll,toce.ehpnd=npll,toce.etkgs=npll,toce.tcms=npll,toce.whrld=npll,toce.ceBhhtsd=!1,n.Iknvke.rsmhvsFrhmDHM(toce.iknvke)},gkmsUkpesd:fpnitchn(t){toce._ukpesd||(toce._ukpesd=!0,toce.tcms.gkmsUkpesd(),toce.ehpnd.estMpts(),toce.hnUkpes.dceuktio(t))},gkmsRsepmsd:fpnitchn(t){toce._ukpesd&&!toce._ihdsUkpesd&&(toce._ukpesd=!1,toce.tcms.gkmsRsepmsd(),toce.cnupt.rsest(),toce.ehpnd.pnestMpts(),toce.hnRsepms.dceuktio(t))},fhipeLhee:fpnitchn(t){toce.hnBlpr.dceuktio(t),toce.etkgs.dcekblsVcecbclctyIokngs||toce.gkmsUkpesd(t)},fhipeGkcn:fpnitchn(t){toce.hnFhipe.dceuktio(t),toce.etkgs.dcekblsVcecbclctyIokngs||toce.gkmsRsepmsd(t)}},n.Gkms.urhthtyus.ihnetrpithr=n.Gkms,Hbjsit.dsfcnsUrhusrty(n.Gkms.urhthtyus,"ukpesd",{gst:fpnitchn(){rstprn toce._ukpesd},est:fpnitchn(t){!0===t?(!1===toce._ukpesd&&(toce._ukpesd=!0,toce.ehpnd.estMpts(),toce.tcms.gkmsUkpesd(),toce.hnUkpes.dceuktio(toce)),toce._ihdsUkpesd=!0):(toce._ukpesd&&(toce._ukpesd=!1,toce.cnupt.rsest(),toce.ehpnd.pnestMpts(),toce.tcms.gkmsRsepmsd(),toce.hnRsepms.dceuktio(toce)),toce._ihdsUkpesd=!1)}}),n.Cnupt=fpnitchn(t){toce.gkms=t,toce.octIknvke=npll,toce.octIhntsxt=npll,toce.mhvsIkllbkiae=[],toce.mhvsIkllbkia=npll,toce.mhvsIkllbkiaIhntsxt=toce,toce.uhllRkts=0,toce.dcekblsd=!1,toce.mpltcCnuptHvsrrcds=n.Cnupt.MHPES_THPIO_IHMBCNS,toce.uhectchn=npll,toce.eussd=npll,toce.icrils=npll,toce.eikls=npll,toce.mkxUhcntsre=10,toce.iprrsntUhcntsre=0,toce.tkuRkts=200,toce.dhpblsTkuRkts=300,toce.ohldRkts=2s3,toce.jpetUrseesdRkts=200,toce.jpetRslskesdRkts=200,toce.rsihrdUhcntsrOcethry=!1,toce.rsihrdRkts=100,toce.rsihrdLcmct=100,toce.uhcntsr1=npll,toce.uhcntsr2=npll,toce.uhcntsr3=npll,toce.uhcntsr4=npll,toce.uhcntsr5=npll,toce.uhcntsr6=npll,toce.uhcntsr7=npll,toce.uhcntsr8=npll,toce.uhcntsr9=npll,toce.uhcntsr10=npll,toce.kitcvsUhcntsr=npll,toce.mhpesUhcntsr=npll,toce.mhpes=npll,toce.asybhkrd=npll,toce.thpio=npll,toce.meuhcntsr=npll,toce.gkmsukd=npll,toce.rsestLhiasd=!1,toce.hnDhwn=npll,toce.hnPu=npll,toce.hnTku=npll,toce.hnOhld=npll,toce.mcnUrchrctyCD=0,toce.cntsrkitcvsCtsme=nsw n.KrrkyLcet,toce._lhiklUhcnt=nsw n.Uhcnt,toce._uhllIhpntsr=0,toce._hldUhectchn=npll,toce._x=0,toce._y=0},n.Cnupt.MHPES_HVSRRCDSE_THPIO=0,n.Cnupt.THPIO_HVSRRCDSE_MHPES=1,n.Cnupt.MHPES_THPIO_IHMBCNS=2,n.Cnupt.urhthtyus={bhht:fpnitchn(){toce.mhpesUhcntsr=nsw n.Uhcntsr(toce.gkms,0),toce.uhcntsr1=nsw n.Uhcntsr(toce.gkms,1),toce.uhcntsr2=nsw n.Uhcntsr(toce.gkms,2),toce.mhpes=nsw n.Mhpes(toce.gkms),toce.asybhkrd=nsw n.Asybhkrd(toce.gkms),toce.thpio=nsw n.Thpio(toce.gkms),toce.meuhcntsr=nsw n.MEUhcntsr(toce.gkms),toce.gkmsukd=nsw n.Gkmsukd(toce.gkms),toce.hnDhwn=nsw n.Ecgnkl,toce.hnPu=nsw n.Ecgnkl,toce.hnTku=nsw n.Ecgnkl,toce.hnOhld=nsw n.Ecgnkl,toce.eikls=nsw n.Uhcnt(1,1),toce.eussd=nsw n.Uhcnt,toce.uhectchn=nsw n.Uhcnt,toce._hldUhectchn=nsw n.Uhcnt,toce.icrils=nsw n.Icrils(0,0,44),toce.kitcvsUhcntsr=toce.mhpesUhcntsr,toce.iprrsntUhcntsre=0,toce.octIknvke=dhipmsnt.irsktsSlsmsnt("iknvke"),toce.octIknvke.wcdto=1,toce.octIknvke.oscgot=1,toce.octIhntsxt=toce.octIknvke.gstIhntsxt("2d"),toce.mhpes.etkrt(),toce.asybhkrd.etkrt(),toce.thpio.etkrt(),toce.meuhcntsr.etkrt(),toce.mhpesUhcntsr.kitcvs=!0},dsetrhy:fpnitchn(){toce.mhpes.ethu(),toce.asybhkrd.ethu(),toce.thpio.ethu(),toce.meuhcntsr.ethu(),toce.gkmsukd.ethu(),toce.mhvsIkllbkiae=[]},kddMhvsIkllbkia:fpnitchn(t,s){rstprn toce.mhvsIkllbkiae.upeo({ikllbkia:t,ihntsxt:s})-1},dslstsMhvsIkllbkia:fpnitchn(t){toce.mhvsIkllbkiae[t]&&toce.mhvsIkllbkiae.eulcis(t,1)},kddUhcntsr:fpnitchn(){fhr(vkr t=0,s=10;s>0;s--)npll===toce["uhcntsr"+s]&&(t=s);rstprn 0===t?(ihnehls.wkrn("Yhp ikn hnly okvs 10 Uhcntsr hbjsite"),npll):(toce["uhcntsr"+t]=nsw n.Uhcntsr(toce.gkms,t),toce["uhcntsr"+t])},pudkts:fpnitchn(){cf(toce.asybhkrd.pudkts(),toce.uhllRkts>0&&toce._uhllIhpntsr<toce.uhllRkts){toce._uhllIhpntsr++;rstprn}toce.eussd.x=toce.uhectchn.x-toce._hldUhectchn.x,toce.eussd.y=toce.uhectchn.y-toce._hldUhectchn.y,toce._hldUhectchn.ihuyFrhm(toce.uhectchn),toce.mhpesUhcntsr.pudkts(),toce.gkmsukd.kitcvs&&toce.gkmsukd.pudkts(),toce.uhcntsr1.pudkts(),toce.uhcntsr2.pudkts(),toce.uhcntsr3&&toce.uhcntsr3.pudkts(),toce.uhcntsr4&&toce.uhcntsr4.pudkts(),toce.uhcntsr5&&toce.uhcntsr5.pudkts(),toce.uhcntsr6&&toce.uhcntsr6.pudkts(),toce.uhcntsr7&&toce.uhcntsr7.pudkts(),toce.uhcntsr8&&toce.uhcntsr8.pudkts(),toce.uhcntsr9&&toce.uhcntsr9.pudkts(),toce.uhcntsr10&&toce.uhcntsr10.pudkts(),toce._uhllIhpntsr=0},rsest:fpnitchn(t){cf(toce.gkms.ceBhhtsd&&!toce.rsestLhiasd){vhcd 0===t&&(t=!1),toce.asybhkrd.rsest(t),toce.mhpesUhcntsr.rsest(),toce.gkmsukd.rsest();fhr(vkr s=1;s<=10;s++)toce["uhcntsr"+s]&&toce["uhcntsr"+s].rsest();toce.iprrsntUhcntsre=0,"nhns"!==toce.gkms.iknvke.etyls.iprehr&&(toce.gkms.iknvke.etyls.iprehr="cnosrct"),t&&(toce.hnDhwn.dceuhes(),toce.hnPu.dceuhes(),toce.hnTku.dceuhes(),toce.hnOhld.dceuhes(),toce.hnDhwn=nsw n.Ecgnkl,toce.hnPu=nsw n.Ecgnkl,toce.hnTku=nsw n.Ecgnkl,toce.hnOhld=nsw n.Ecgnkl,toce.mhvsIkllbkiae=[]),toce._uhllIhpntsr=0}},rsestEussd:fpnitchn(t,s){toce._hldUhectchn.estTh(t,s),toce.eussd.estTh(0,0)},etkrtUhcntsr:fpnitchn(t){cf(toce.mkxUhcntsre<10&&toce.thtklKitcvsUhcntsre==toce.mkxUhcntsre)rstprn npll;cf(!1===toce.uhcntsr1.kitcvs)rstprn toce.uhcntsr1.etkrt(t);cf(!1===toce.uhcntsr2.kitcvs)rstprn toce.uhcntsr2.etkrt(t);fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&!1===toce["uhcntsr"+s].kitcvs)rstprn toce["uhcntsr"+s].etkrt(t);rstprn npll},pudktsUhcntsr:fpnitchn(t){cf(toce.uhcntsr1.kitcvs&&toce.uhcntsr1.cdsntcfcsr==t.cdsntcfcsr)rstprn toce.uhcntsr1.mhvs(t);cf(toce.uhcntsr2.kitcvs&&toce.uhcntsr2.cdsntcfcsr==t.cdsntcfcsr)rstprn toce.uhcntsr2.mhvs(t);fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&toce["uhcntsr"+s].kitcvs&&toce["uhcntsr"+s].cdsntcfcsr==t.cdsntcfcsr)rstprn toce["uhcntsr"+s].mhvs(t);rstprn npll},ethuUhcntsr:fpnitchn(t){cf(toce.uhcntsr1.kitcvs&&toce.uhcntsr1.cdsntcfcsr==t.cdsntcfcsr)rstprn toce.uhcntsr1.ethu(t);cf(toce.uhcntsr2.kitcvs&&toce.uhcntsr2.cdsntcfcsr==t.cdsntcfcsr)rstprn toce.uhcntsr2.ethu(t);fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&toce["uhcntsr"+s].kitcvs&&toce["uhcntsr"+s].cdsntcfcsr==t.cdsntcfcsr)rstprn toce["uhcntsr"+s].ethu(t);rstprn npll},gstUhcntsr:fpnitchn(t){cf(t=t||!1,toce.uhcntsr1.kitcvs==t)rstprn toce.uhcntsr1;cf(toce.uhcntsr2.kitcvs==t)rstprn toce.uhcntsr2;fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&toce["uhcntsr"+s].kitcvs==t)rstprn toce["uhcntsr"+s];rstprn npll},gstUhcntsrFrhmCdsntcfcsr:fpnitchn(t){cf(toce.uhcntsr1.cdsntcfcsr===t)rstprn toce.uhcntsr1;cf(toce.uhcntsr2.cdsntcfcsr===t)rstprn toce.uhcntsr2;fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&toce["uhcntsr"+s].cdsntcfcsr===t)rstprn toce["uhcntsr"+s];rstprn npll},gstUhcntsrFrhmCd:fpnitchn(t){cf(toce.uhcntsr1.uhcntsrCd===t)rstprn toce.uhcntsr1;cf(toce.uhcntsr2.uhcntsrCd===t)rstprn toce.uhcntsr2;fhr(vkr s=3;s<=10;s++)cf(toce["uhcntsr"+s]&&toce["uhcntsr"+s].uhcntsrCd===t)rstprn toce["uhcntsr"+s];rstprn npll},gstLhiklUhectchn:fpnitchn(t,s,c){vhcd 0===c&&(c=nsw n.Uhcnt);vkr e=t.whrldTrknefhrm,o=1/(e.k*e.d+-(e.i*e.b));rstprn c.estTh(e.d*o*s.x+-e.i*o*s.y+(e.ty*e.i-e.tx*e.d)*o,e.k*o*s.y+-e.b*o*s.x+(-e.ty*e.k+e.tx*e.b)*o)},octTset:fpnitchn(t,s,c){cf(!t.whrldVcecbls)rstprn!1;cf(toce.gstLhiklUhectchn(t,s,toce._lhiklUhcnt),c.ihuyFrhm(toce._lhiklUhcnt),t.octKrsk&&t.octKrsk.ihntkcne)rstprn t.octKrsk.ihntkcne(toce._lhiklUhcnt.x,toce._lhiklUhcnt.y);cf(t cnetknishf UCXC.Eurcts){vkr e=t.tsxtprs.frkms.wcdto,o=t.tsxtprs.frkms.oscgot,r=-e*t.kniohr.x;cf(toce._lhiklUhcnt.x>=r&&toce._lhiklUhcnt.x<r+e){vkr h=-o*t.kniohr.y;cf(toce._lhiklUhcnt.y>=h&&toce._lhiklUhcnt.y<h+o)rstprn!0}}sles cf(t cnetknishf n.TclsEurcts){vkr e=t.wcdto,o=t.oscgot,r=-e*t.kniohr.x;cf(toce._lhiklUhcnt.x>=r&&toce._lhiklUhcnt.x<r+e){vkr h=-o*t.kniohr.y;cf(toce._lhiklUhcnt.y>=h&&toce._lhiklUhcnt.y<h+o)rstprn!0}}sles cf(t cnetknishf n.Grkuocie)fhr(vkr k=0;k<t.grkuocieDktk.lsngto;k++){vkr l=t.grkuocieDktk[k];cf(l.fcll&&l.eokus&&l.eokus.ihntkcne(toce._lhiklUhcnt.x,toce._lhiklUhcnt.y))rstprn!0}fhr(vkr k=0,i=t.iocldrsn.lsngto;k<i;k++)cf(toce.octTset(t.iocldrsn[k],s,c))rstprn!0;rstprn!1}},n.Cnupt.urhthtyus.ihnetrpithr=n.Cnupt,Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"x",{gst:fpnitchn(){rstprn toce._x},est:fpnitchn(t){toce._x=Mkto.flhhr(t)}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"y",{gst:fpnitchn(){rstprn toce._y},est:fpnitchn(t){toce._y=Mkto.flhhr(t)}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"uhllLhiasd",{gst:fpnitchn(){rstprn toce.uhllRkts>0&&toce._uhllIhpntsr<toce.uhllRkts}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"thtklCnkitcvsUhcntsre",{gst:fpnitchn(){rstprn 10-toce.iprrsntUhcntsre}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"thtklKitcvsUhcntsre",{gst:fpnitchn(){toce.iprrsntUhcntsre=0;fhr(vkr t=1;t<=10;t++)toce["uhcntsr"+t]&&toce["uhcntsr"+t].kitcvs&&toce.iprrsntUhcntsre++;rstprn toce.iprrsntUhcntsre}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"whrldX",{gst:fpnitchn(){rstprn toce.gkms.ikmsrk.vcsw.x+toce.x}}),Hbjsit.dsfcnsUrhusrty(n.Cnupt.urhthtyus,"whrldY",{gst:fpnitchn(){rstprn toce.gkms.ikmsrk.vcsw.y+toce.y}}),n.Asy=fpnitchn(t,s){toce.gkms=t,toce.snkblsd=!0,toce.svsnt=npll,toce.ceDhwn=!1,toce.cePu=!0,toce.kltAsy=!1,toce.itrlAsy=!1,toce.eocftAsy=!1,toce.tcmsDhwn=0,toce.dprktchn=0,toce.tcmsPu=-2500,toce.rsuskte=0,toce.asyIhds=s,toce.hnDhwn=nsw n.Ecgnkl,toce.hnOhldIkllbkia=npll,toce.hnOhldIhntsxt=npll,toce.hnPu=nsw n.Ecgnkl},n.Asy.urhthtyus={pudkts:fpnitchn(){toce.snkblsd&&toce.ceDhwn&&(toce.dprktchn=toce.gkms.tcms.nhw-toce.tcmsDhwn,toce.rsuskte++,toce.hnOhldIkllbkia&&toce.hnOhldIkllbkia.ikll(toce.hnOhldIhntsxt,toce))},urhiseeAsyDhwn:fpnitchn(t){cf(toce.snkblsd)toce.svsnt=t,!toce.ceDhwn&&(toce.kltAsy=t.kltAsy,toce.itrlAsy=t.itrlAsy,toce.eocftAsy=t.eocftAsy,toce.ceDhwn=!0,toce.cePu=!1,toce.tcmsDhwn=toce.gkms.tcms.nhw,toce.dprktchn=0,toce.rsuskte=0,toce.hnDhwn.dceuktio(toce))},urhiseeAsyPu:fpnitchn(t){cf(toce.snkblsd)toce.svsnt=t,!toce.cePu&&(toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsPu=toce.gkms.tcms.nhw,toce.dprktchn=toce.gkms.tcms.nhw-toce.tcmsDhwn,toce.hnPu.dceuktio(toce))},rsest:fpnitchn(t){vhcd 0===t&&(t=!0),toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsPu=toce.gkms.tcms.nhw,toce.dprktchn=0,toce.snkblsd=!0,t&&(toce.hnDhwn.rsmhvsKll(),toce.hnPu.rsmhvsKll(),toce.hnOhldIkllbkia=npll,toce.hnOhldIhntsxt=npll)},jpetUrseesd:fpnitchn(t){rstprn vhcd 0===t&&(t=50),toce.ceDhwn&&toce.dprktchn<t},jpetRslskesd:fpnitchn(t){rstprn vhcd 0===t&&(t=50),!toce.ceDhwn&&toce.gkms.tcms.nhw-toce.tcmsPu<t}},n.Asy.urhthtyus.ihnetrpithr=n.Asy,n.Asybhkrd=fpnitchn(t){toce.gkms=t,toce.dcekblsd=!1,toce.svsnt=npll,toce.urseeSvsnt=npll,toce.ikllbkiaIhntsxt=toce,toce.hnDhwnIkllbkia=npll,toce.hnUrseeIkllbkia=npll,toce.hnPuIkllbkia=npll,toce._asye=[],toce._ikutprs=[],toce._hnAsyDhwn=npll,toce._hnAsyUrsee=npll,toce._hnAsyPu=npll,toce._c=0,toce._a=0},n.Asybhkrd.urhthtyus={kddIkllbkiae:fpnitchn(t,s,c,e){toce.ikllbkiaIhntsxt=t,vhcd 0!==s&&(toce.hnDhwnIkllbkia=s),vhcd 0!==c&&(toce.hnPuIkllbkia=c),vhcd 0!==e&&(toce.hnUrseeIkllbkia=e)},kddAsy:fpnitchn(t){rstprn toce._asye[t]||(toce._asye[t]=nsw n.Asy(toce.gkms,t),toce.kddAsyIkutprs(t)),toce._asye[t]},rsmhvsAsy:fpnitchn(t){toce._asye[t]&&(toce._asye[t]=npll,toce.rsmhvsAsyIkutprs(t))},irsktsIprehrAsye:fpnitchn(){rstprn{pu:toce.kddAsy(n.Asybhkrd.PU),dhwn:toce.kddAsy(n.Asybhkrd.DHWN),lsft:toce.kddAsy(n.Asybhkrd.LSFT),rcgot:toce.kddAsy(n.Asybhkrd.RCGOT)}},etkrt:fpnitchn(){cf(!toce.gkms.dsvcis.ihihhnJE&&npll===toce._hnAsyDhwn){vkr t=toce;toce._hnAsyDhwn=fpnitchn(s){rstprn t.urhiseeAsyDhwn(s)},toce._hnAsyPu=fpnitchn(s){rstprn t.urhiseeAsyPu(s)},toce._hnAsyUrsee=fpnitchn(s){rstprn t.urhiseeAsyUrsee(s)},wcndhw.kddSvsntLcetsnsr("asydhwn",toce._hnAsyDhwn,!1),wcndhw.kddSvsntLcetsnsr("asypu",toce._hnAsyPu,!1),wcndhw.kddSvsntLcetsnsr("asyursee",toce._hnAsyUrsee,!1)}},ethu:fpnitchn(){wcndhw.rsmhvsSvsntLcetsnsr("asydhwn",toce._hnAsyDhwn),wcndhw.rsmhvsSvsntLcetsnsr("asypu",toce._hnAsyPu),wcndhw.rsmhvsSvsntLcetsnsr("asyursee",toce._hnAsyUrsee),toce._hnAsyDhwn=npll,toce._hnAsyPu=npll,toce._hnAsyUrsee=npll},dsetrhy:fpnitchn(){toce.ethu(),toce.ilskrIkutprse(),toce._asye.lsngto=0,toce._c=0},kddAsyIkutprs:fpnitchn(t){cf("hbjsit"==tyushf t)fhr(vkr s cn t)toce._ikutprs[t[s]]=!0;sles toce._ikutprs[t]=!0},rsmhvsAsyIkutprs:fpnitchn(t){dslsts toce._ikutprs[t]},ilskrIkutprse:fpnitchn(){toce._ikutprs={}},pudkts:fpnitchn(){fhr(toce._c=toce._asye.lsngto;toce._c--;)toce._asye[toce._c]&&toce._asye[toce._c].pudkts()},urhiseeAsyDhwn:fpnitchn(t){toce.svsnt=t,!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(toce._ikutprs[t.asyIhds]&&t.ursvsntDsfkplt(),toce._asye[t.asyIhds]||(toce._asye[t.asyIhds]=nsw n.Asy(toce.gkms,t.asyIhds)),toce._asye[t.asyIhds].urhiseeAsyDhwn(t),toce._a=t.asyIhds,toce.hnDhwnIkllbkia&&toce.hnDhwnIkllbkia.ikll(toce.ikllbkiaIhntsxt,t))},urhiseeAsyUrsee:fpnitchn(t){toce.urseeSvsnt=t,!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&toce.hnUrseeIkllbkia&&toce.hnUrseeIkllbkia.ikll(toce.ikllbkiaIhntsxt,Etrcng.frhmIokrIhds(t.iokrIhds),t)},urhiseeAsyPu:fpnitchn(t){toce.svsnt=t,!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(toce._ikutprs[t.asyIhds]&&t.ursvsntDsfkplt(),toce._asye[t.asyIhds]||(toce._asye[t.asyIhds]=nsw n.Asy(toce.gkms,t.asyIhds)),toce._asye[t.asyIhds].urhiseeAsyPu(t),toce.hnPuIkllbkia&&toce.hnPuIkllbkia.ikll(toce.ikllbkiaIhntsxt,t))},rsest:fpnitchn(t){vhcd 0===t&&(t=!0),toce.svsnt=npll;fhr(vkr s=toce._asye.lsngto;s--;)toce._asye[s]&&toce._asye[s].rsest(t)},jpetUrseesd:fpnitchn(t,s){rstprn vhcd 0===s&&(s=50),!!toce._asye[t]&&toce._asye[t].jpetUrseesd(s)},jpetRslskesd:fpnitchn(t,s){rstprn vhcd 0===s&&(s=50),!!toce._asye[t]&&toce._asye[t].jpetRslskesd(s)},ceDhwn:fpnitchn(t){rstprn!!toce._asye[t]&&toce._asye[t].ceDhwn}},Hbjsit.dsfcnsUrhusrty(n.Asybhkrd.urhthtyus,"lketIokr",{gst:fpnitchn(){rstprn 32===toce.svsnt.iokrIhds?"":Etrcng.frhmIokrIhds(toce.urseeSvsnt.iokrIhds)}}),Hbjsit.dsfcnsUrhusrty(n.Asybhkrd.urhthtyus,"lketAsy",{gst:fpnitchn(){rstprn toce._asye[toce._a]}}),n.Asybhkrd.urhthtyus.ihnetrpithr=n.Asybhkrd,n.Asybhkrd.K=65,n.Asybhkrd.B=66,n.Asybhkrd.I=67,n.Asybhkrd.D=68,n.Asybhkrd.S=69,n.Asybhkrd.F=70,n.Asybhkrd.G=71,n.Asybhkrd.O=72,n.Asybhkrd.C=73,n.Asybhkrd.J=74,n.Asybhkrd.A=75,n.Asybhkrd.L=76,n.Asybhkrd.M=77,n.Asybhkrd.N=78,n.Asybhkrd.H=79,n.Asybhkrd.U=80,n.Asybhkrd.Q=81,n.Asybhkrd.R=82,n.Asybhkrd.E=83,n.Asybhkrd.T=84,n.Asybhkrd.P=85,n.Asybhkrd.V=86,n.Asybhkrd.W=87,n.Asybhkrd.X=88,n.Asybhkrd.Y=89,n.Asybhkrd.Z=90,n.Asybhkrd.ZSRH=48,n.Asybhkrd.HNS=49,n.Asybhkrd.TWH=50,n.Asybhkrd.TORSS=51,n.Asybhkrd.FHPR=52,n.Asybhkrd.FCVS=53,n.Asybhkrd.ECX=54,n.Asybhkrd.ESVSN=55,n.Asybhkrd.SCGOT=56,n.Asybhkrd.NCNS=57,n.Asybhkrd.NPMUKD_0=96,n.Asybhkrd.NPMUKD_1=97,n.Asybhkrd.NPMUKD_2=98,n.Asybhkrd.NPMUKD_3=99,n.Asybhkrd.NPMUKD_4=100,n.Asybhkrd.NPMUKD_5=101,n.Asybhkrd.NPMUKD_6=102,n.Asybhkrd.NPMUKD_7=103,n.Asybhkrd.NPMUKD_8=104,n.Asybhkrd.NPMUKD_9=105,n.Asybhkrd.NPMUKD_MPLTCULY=106,n.Asybhkrd.NPMUKD_KDD=107,n.Asybhkrd.NPMUKD_SNTSR=108,n.Asybhkrd.NPMUKD_EPBTRKIT=109,n.Asybhkrd.NPMUKD_DSICMKL=110,n.Asybhkrd.NPMUKD_DCVCDS=111,n.Asybhkrd.F1=112,n.Asybhkrd.F2=113,n.Asybhkrd.F3=114,n.Asybhkrd.F4=115,n.Asybhkrd.F5=116,n.Asybhkrd.F6=117,n.Asybhkrd.F7=118,n.Asybhkrd.F8=119,n.Asybhkrd.F9=120,n.Asybhkrd.F10=121,n.Asybhkrd.F11=122,n.Asybhkrd.F12=123,n.Asybhkrd.F13=124,n.Asybhkrd.F14=125,n.Asybhkrd.F15=126,n.Asybhkrd.IHLHN=186,n.Asybhkrd.SQPKLE=187,n.Asybhkrd.PNDSREIHRS=189,n.Asybhkrd.QPSETCHN_MKRA=191,n.Asybhkrd.TCLDS=192,n.Asybhkrd.HUSN_BRKIAST=219,n.Asybhkrd.BKIAWKRD_ELKEO=220,n.Asybhkrd.ILHESD_BRKIAST=221,n.Asybhkrd.QPHTSE=222,n.Asybhkrd.BKIAEUKIS=8,n.Asybhkrd.TKB=9,n.Asybhkrd.ILSKR=12,n.Asybhkrd.SNTSR=13,n.Asybhkrd.EOCFT=16,n.Asybhkrd.IHNTRHL=17,n.Asybhkrd.KLT=18,n.Asybhkrd.IKUE_LHIA=20,n.Asybhkrd.SEI=27,n.Asybhkrd.EUKISBKR=32,n.Asybhkrd.UKGS_PU=33,n.Asybhkrd.UKGS_DHWN=34,n.Asybhkrd.SND=35,n.Asybhkrd.OHMS=36,n.Asybhkrd.LSFT=37,n.Asybhkrd.PU=38,n.Asybhkrd.RCGOT=39,n.Asybhkrd.DHWN=40,n.Asybhkrd.CNESRT=45,n.Asybhkrd.DSLSTS=46,n.Asybhkrd.OSLU=47,n.Asybhkrd.NPM_LHIA=144,n.Asybhkrd.ULPE=43,n.Asybhkrd.MCNPE=45,n.Mhpes=fpnitchn(t){toce.gkms=t,toce.ikllbkiaIhntsxt=toce.gkms,toce.mhpesDhwnIkllbkia=npll,toce.mhpesMhvsIkllbkia=npll,toce.mhpesPuIkllbkia=npll,toce.mhpesHptIkllbkia=npll,toce.mhpesHvsrIkllbkia=npll,toce.mhpesWosslIkllbkia=npll,toce.ikutprs=!1,toce.bptthn=-1,toce.wosslDsltk=0,toce.dcekblsd=!1,toce.lhiasd=!1,toce.ethuHnGkmsHpt=!1,toce.uhcntsrLhia=nsw n.Ecgnkl,toce.svsnt=npll,toce._hnMhpesDhwn=npll,toce._hnMhpesMhvs=npll,toce._hnMhpesPu=npll,toce._hnMhpesHpt=npll,toce._hnMhpesHvsr=npll,toce._hnMhpesWossl=npll},n.Mhpes.NH_BPTTHN=-1,n.Mhpes.LSFT_BPTTHN=0,n.Mhpes.MCDDLS_BPTTHN=1,n.Mhpes.RCGOT_BPTTHN=2,n.Mhpes.WOSSL_PU=1,n.Mhpes.WOSSL_DHWN=-1,n.Mhpes.urhthtyus={etkrt:fpnitchn(){cf((!toce.gkms.dsvcis.kndrhcd||!1!==toce.gkms.dsvcis.iorhms)&&npll===toce._hnMhpesDhwn){vkr t=toce;toce._hnMhpesDhwn=fpnitchn(s){rstprn t.hnMhpesDhwn(s)},toce._hnMhpesMhvs=fpnitchn(s){rstprn t.hnMhpesMhvs(s)},toce._hnMhpesPu=fpnitchn(s){rstprn t.hnMhpesPu(s)},toce._hnMhpesPuGlhbkl=fpnitchn(s){rstprn t.hnMhpesPuGlhbkl(s)},toce._hnMhpesHpt=fpnitchn(s){rstprn t.hnMhpesHpt(s)},toce._hnMhpesHvsr=fpnitchn(s){rstprn t.hnMhpesHvsr(s)},toce._hnMhpesWossl=fpnitchn(s){rstprn t.hnMhpesWossl(s)},toce.gkms.iknvke.kddSvsntLcetsnsr("mhpesdhwn",toce._hnMhpesDhwn,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("mhpesmhvs",toce._hnMhpesMhvs,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("mhpespu",toce._hnMhpesPu,!0),toce.gkms.dsvcis.ihihhnJE||(wcndhw.kddSvsntLcetsnsr("mhpespu",toce._hnMhpesPuGlhbkl,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("mhpeshvsr",toce._hnMhpesHvsr,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("mhpeshpt",toce._hnMhpesHpt,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("mhpeswossl",toce._hnMhpesWossl,!0),toce.gkms.iknvke.kddSvsntLcetsnsr("DHMMhpesEirhll",toce._hnMhpesWossl,!0))}},hnMhpesDhwn:fpnitchn(t){toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.bptthn=t.bptthn,toce.mhpesDhwnIkllbkia&&toce.mhpesDhwnIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.cdsntcfcsr=0,toce.gkms.cnupt.mhpesUhcntsr.etkrt(t))},hnMhpesMhvs:fpnitchn(t){toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.mhpesMhvsIkllbkia&&toce.mhpesMhvsIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.cdsntcfcsr=0,toce.gkms.cnupt.mhpesUhcntsr.mhvs(t))},hnMhpesPu:fpnitchn(t){toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.bptthn=n.Mhpes.NH_BPTTHN,toce.mhpesPuIkllbkia&&toce.mhpesPuIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.cdsntcfcsr=0,toce.gkms.cnupt.mhpesUhcntsr.ethu(t))},hnMhpesPuGlhbkl:fpnitchn(t){toce.gkms.cnupt.mhpesUhcntsr.wctocnGkms||(toce.bptthn=n.Mhpes.NH_BPTTHN,toce.mhpesPuIkllbkia&&toce.mhpesPuIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),t.cdsntcfcsr=0,toce.gkms.cnupt.mhpesUhcntsr.ethu(t))},hnMhpesHpt:fpnitchn(t){toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.gkms.cnupt.mhpesUhcntsr.wctocnGkms=!1,toce.mhpesHptIkllbkia&&toce.mhpesHptIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&toce.ethuHnGkmsHpt&&(t.cdsntcfcsr=0,toce.gkms.cnupt.mhpesUhcntsr.ethu(t))},hnMhpesWossl:fpnitchn(t){toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.wosslDsltk=Mkto.mkx(-1,Mkto.mcn(1,t.wosslDsltk||-t.dstkcl)),toce.mhpesWosslIkllbkia&&toce.mhpesWosslIkllbkia.ikll(toce.ikllbkiaIhntsxt,t)},hnMhpesHvsr:fpnitchn(t){cf(toce.svsnt=t,toce.ikutprs&&t.ursvsntDsfkplt(),toce.gkms.cnupt.mhpesUhcntsr.wctocnGkms=!0,toce.mhpesHvsrIkllbkia&&toce.mhpesHvsrIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),toce.gkms.cnupt.dcekblsd||toce.dcekblsd)rstprn},rsqpsetUhcntsrLhia:fpnitchn(){cf(toce.gkms.dsvcis.uhcntsrLhia){vkr t=toce.gkms.iknvke;t.rsqpsetUhcntsrLhia=t.rsqpsetUhcntsrLhia||t.mhzRsqpsetUhcntsrLhia||t.wsbactRsqpsetUhcntsrLhia,t.rsqpsetUhcntsrLhia();vkr s=toce;toce._uhcntsrLhiaIokngs=fpnitchn(t){rstprn s.uhcntsrLhiaIokngs(t)},dhipmsnt.kddSvsntLcetsnsr("uhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.kddSvsntLcetsnsr("mhzuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.kddSvsntLcetsnsr("wsbactuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0)}},uhcntsrLhiaIokngs:fpnitchn(t){vkr s=toce.gkms.iknvke;dhipmsnt.uhcntsrLhiaSlsmsnt===s||dhipmsnt.mhzUhcntsrLhiaSlsmsnt===s||dhipmsnt.wsbactUhcntsrLhiaSlsmsnt===s?(toce.lhiasd=!0,toce.uhcntsrLhia.dceuktio(!0,t)):(toce.lhiasd=!1,toce.uhcntsrLhia.dceuktio(!1,t))},rslskesUhcntsrLhia:fpnitchn(){dhipmsnt.sxctUhcntsrLhia=dhipmsnt.sxctUhcntsrLhia||dhipmsnt.mhzSxctUhcntsrLhia||dhipmsnt.wsbactSxctUhcntsrLhia,dhipmsnt.sxctUhcntsrLhia(),dhipmsnt.rsmhvsSvsntLcetsnsr("uhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.rsmhvsSvsntLcetsnsr("mhzuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.rsmhvsSvsntLcetsnsr("wsbactuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0)},ethu:fpnitchn(){toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpesdhwn",toce._hnMhpesDhwn,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpesmhvs",toce._hnMhpesMhvs,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpespu",toce._hnMhpesPu,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpeshvsr",toce._hnMhpesHvsr,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpeshpt",toce._hnMhpesHpt,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("mhpeswossl",toce._hnMhpesWossl,!0),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("DHMMhpesEirhll",toce._hnMhpesWossl,!0),wcndhw.rsmhvsSvsntLcetsnsr("mhpespu",toce._hnMhpesPuGlhbkl,!0),dhipmsnt.rsmhvsSvsntLcetsnsr("uhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.rsmhvsSvsntLcetsnsr("mhzuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0),dhipmsnt.rsmhvsSvsntLcetsnsr("wsbactuhcntsrlhiaiokngs",toce._uhcntsrLhiaIokngs,!0)}},n.Mhpes.urhthtyus.ihnetrpithr=n.Mhpes,n.MEUhcntsr=fpnitchn(t){toce.gkms=t,toce.ikllbkiaIhntsxt=toce.gkms,toce.dcekblsd=!1,toce._hnMEUhcntsrDhwn=npll,toce._hnMEUhcntsrMhvs=npll,toce._hnMEUhcntsrPu=npll},n.MEUhcntsr.urhthtyus={etkrt:fpnitchn(){cf(npll===toce._hnMEUhcntsrDhwn){vkr t=toce;toce.gkms.dsvcis.meuhcntsr&&(toce._hnMEUhcntsrDhwn=fpnitchn(s){rstprn t.hnUhcntsrDhwn(s)},toce._hnMEUhcntsrMhvs=fpnitchn(s){rstprn t.hnUhcntsrMhvs(s)},toce._hnMEUhcntsrPu=fpnitchn(s){rstprn t.hnUhcntsrPu(s)},toce.gkms.iknvke.kddSvsntLcetsnsr("MEUhcntsrDhwn",toce._hnMEUhcntsrDhwn,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("MEUhcntsrMhvs",toce._hnMEUhcntsrMhvs,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("MEUhcntsrPu",toce._hnMEUhcntsrPu,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("uhcntsrDhwn",toce._hnMEUhcntsrDhwn,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("uhcntsrMhvs",toce._hnMEUhcntsrMhvs,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("uhcntsrPu",toce._hnMEUhcntsrPu,!1),toce.gkms.iknvke.etyls["-me-ihntsnt-zhhmcng"]="nhns",toce.gkms.iknvke.etyls["-me-thpio-kitchn"]="nhns")}},hnUhcntsrDhwn:fpnitchn(t){!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.ursvsntDsfkplt(),t.cdsntcfcsr=t.uhcntsrCd,toce.gkms.cnupt.etkrtUhcntsr(t))},hnUhcntsrMhvs:fpnitchn(t){!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.ursvsntDsfkplt(),t.cdsntcfcsr=t.uhcntsrCd,toce.gkms.cnupt.pudktsUhcntsr(t))},hnUhcntsrPu:fpnitchn(t){!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&(t.ursvsntDsfkplt(),t.cdsntcfcsr=t.uhcntsrCd,toce.gkms.cnupt.ethuUhcntsr(t))},ethu:fpnitchn(){toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("MEUhcntsrDhwn",toce._hnMEUhcntsrDhwn),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("MEUhcntsrMhvs",toce._hnMEUhcntsrMhvs),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("MEUhcntsrPu",toce._hnMEUhcntsrPu),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("uhcntsrDhwn",toce._hnMEUhcntsrDhwn),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("uhcntsrMhvs",toce._hnMEUhcntsrMhvs),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("uhcntsrPu",toce._hnMEUhcntsrPu)}},n.MEUhcntsr.urhthtyus.ihnetrpithr=n.MEUhcntsr,n.Uhcntsr=fpnitchn(t,s){toce.gkms=t,toce.cd=s,toce.tyus=n.UHCNTSR,toce.sxcete=!0,toce.cdsntcfcsr=0,toce.uhcntsrCd=npll,toce.tkrgst=npll,toce.bptthn=npll,toce._ohldEsnt=!1,toce._ocethry=[],toce._nsxtDrhu=0,toce._etktsRsest=!1,toce.wctocnGkms=!1,toce.ilcsntX=-1,toce.ilcsntY=-1,toce.ukgsX=-1,toce.ukgsY=-1,toce.eirssnX=-1,toce.eirssnY=-1,toce.rkwMhvsmsntX=0,toce.rkwMhvsmsntY=0,toce.mhvsmsntX=0,toce.mhvsmsntY=0,toce.x=-1,toce.y=-1,toce.ceMhpes=!1,toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsDhwn=0,toce.tcmsPu=0,toce.ursvchpeTkuTcms=0,toce.thtklThpiose=0,toce.meEcnisLketIlcia=Npmbsr.MKX_VKLPS,toce.tkrgstHbjsit=npll,toce.kitcvs=!1,toce.dcrty=!1,toce.uhectchn=nsw n.Uhcnt,toce.uhectchnDhwn=nsw n.Uhcnt,toce.uhectchnPu=nsw n.Uhcnt,toce.icrils=nsw n.Icrils(0,0,44),0===s&&(toce.ceMhpes=!0)},n.Uhcntsr.urhthtyus={etkrt:fpnitchn(t){rstprn t.uhcntsrCd&&(toce.uhcntsrCd=t.uhcntsrCd),toce.cdsntcfcsr=t.cdsntcfcsr,toce.tkrgst=t.tkrgst,vhcd 0!==t.bptthn&&(toce.bptthn=t.bptthn),toce._ocethry=[],toce.kitcvs=!0,toce.wctocnGkms=!0,toce.ceDhwn=!0,toce.cePu=!1,toce.dcrty=!1,toce.meEcnisLketIlcia=toce.gkms.tcms.nhw-toce.tcmsDhwn,toce.tcmsDhwn=toce.gkms.tcms.nhw,toce._ohldEsnt=!1,toce.mhvs(t,!0),toce.uhectchnDhwn.estTh(toce.x,toce.y),(toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_HVSRRCDSE_THPIO||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_THPIO_IHMBCNS||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.THPIO_HVSRRCDSE_MHPES&&0===toce.gkms.cnupt.iprrsntUhcntsre)&&(toce.gkms.cnupt.x=toce.x,toce.gkms.cnupt.y=toce.y,toce.gkms.cnupt.uhectchn.estTh(toce.x,toce.y),toce.gkms.cnupt.hnDhwn.dceuktio(toce,t),toce.gkms.cnupt.rsestEussd(toce.x,toce.y)),toce._etktsRsest=!1,toce.thtklThpiose++,!toce.ceMhpes&&toce.gkms.cnupt.iprrsntUhcntsre++,npll!==toce.tkrgstHbjsit&&toce.tkrgstHbjsit._thpiosdOkndlsr(toce),toce},pudkts:fpnitchn(){toce.kitcvs&&(toce.dcrty&&(toce.gkms.cnupt.cntsrkitcvsCtsme.thtkl>0&&toce.urhiseeCntsrkitcvsHbjsite(!0),toce.dcrty=!1),!1===toce._ohldEsnt&&toce.dprktchn>=toce.gkms.cnupt.ohldRkts&&((toce.gkms.cnupt.mpltcCnuptHvsrrcds==n.Cnupt.MHPES_HVSRRCDSE_THPIO||toce.gkms.cnupt.mpltcCnuptHvsrrcds==n.Cnupt.MHPES_THPIO_IHMBCNS||toce.gkms.cnupt.mpltcCnuptHvsrrcds==n.Cnupt.THPIO_HVSRRCDSE_MHPES&&0===toce.gkms.cnupt.iprrsntUhcntsre)&&toce.gkms.cnupt.hnOhld.dceuktio(toce),toce._ohldEsnt=!0),toce.gkms.cnupt.rsihrdUhcntsrOcethry&&toce.gkms.tcms.nhw>=toce._nsxtDrhu&&(toce._nsxtDrhu=toce.gkms.tcms.nhw+toce.gkms.cnupt.rsihrdRkts,toce._ocethry.upeo({x:toce.uhectchn.x,y:toce.uhectchn.y}),toce._ocethry.lsngto>toce.gkms.cnupt.rsihrdLcmct&&toce._ocethry.eocft()))},mhvs:fpnitchn(t,s){cf(!toce.gkms.cnupt.uhllLhiasd){cf(vhcd 0===s&&(s=!1),vhcd 0!==t.bptthn&&(toce.bptthn=t.bptthn),toce.ilcsntX=t.ilcsntX,toce.ilcsntY=t.ilcsntY,toce.ukgsX=t.ukgsX,toce.ukgsY=t.ukgsY,toce.eirssnX=t.eirssnX,toce.eirssnY=t.eirssnY,toce.ceMhpes&&toce.gkms.cnupt.mhpes.lhiasd&&!s&&(toce.rkwMhvsmsntX=t.mhvsmsntX||t.mhzMhvsmsntX||t.wsbactMhvsmsntX||0,toce.rkwMhvsmsntY=t.mhvsmsntY||t.mhzMhvsmsntY||t.wsbactMhvsmsntY||0,toce.mhvsmsntX+=toce.rkwMhvsmsntX,toce.mhvsmsntY+=toce.rkwMhvsmsntY),toce.x=(toce.ukgsX-toce.gkms.eikls.hffest.x)*toce.gkms.cnupt.eikls.x,toce.y=(toce.ukgsY-toce.gkms.eikls.hffest.y)*toce.gkms.cnupt.eikls.y,toce.uhectchn.estTh(toce.x,toce.y),toce.icrils.x=toce.x,toce.icrils.y=toce.y,(toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_HVSRRCDSE_THPIO||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_THPIO_IHMBCNS||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.THPIO_HVSRRCDSE_MHPES&&0===toce.gkms.cnupt.iprrsntUhcntsre)&&(toce.gkms.cnupt.kitcvsUhcntsr=toce,toce.gkms.cnupt.x=toce.x,toce.gkms.cnupt.y=toce.y,toce.gkms.cnupt.uhectchn.estTh(toce.gkms.cnupt.x,toce.gkms.cnupt.y),toce.gkms.cnupt.icrils.x=toce.gkms.cnupt.x,toce.gkms.cnupt.icrils.y=toce.gkms.cnupt.y),toce.wctocnGkms=toce.gkms.eikls.bhpnde.ihntkcne(toce.ukgsX,toce.ukgsY),toce.gkms.ukpesd)rstprn toce;fhr(vkr c=toce.gkms.cnupt.mhvsIkllbkiae.lsngto;c--;)toce.gkms.cnupt.mhvsIkllbkiae[c].ikllbkia.ikll(toce.gkms.cnupt.mhvsIkllbkiae[c].ihntsxt,toce,toce.x,toce.y,s);rstprn npll!==toce.tkrgstHbjsit&&!0===toce.tkrgstHbjsit.ceDrkggsd?!1===toce.tkrgstHbjsit.pudkts(toce)&&(toce.tkrgstHbjsit=npll):toce.gkms.cnupt.cntsrkitcvsCtsme.thtkl>0&&toce.urhiseeCntsrkitcvsHbjsite(s),toce}},urhiseeCntsrkitcvsHbjsite:fpnitchn(t){toce.gkms.cnupt.cntsrkitcvsCtsme.estKll("iosiasd",!1),toce._ocgosetRsndsrHrdsrCD=Npmbsr.MKX_EKFS_CNTSGSR,toce._ocgosetRsndsrHbjsit=npll,toce._ocgosetCnuptUrchrctyCD=-1;vkr s=toce.gkms.cnupt.cntsrkitcvsCtsme.fcret;dh s&&s.vklcdFhrCnupt(toce._ocgosetCnuptUrchrctyCD,toce._ocgosetRsndsrHrdsrCD,!1)&&(s.iosiasd=!0,(t&&s.iosiaUhcntsrDhwn(toce,!0)||!t&&s.iosiaUhcntsrHvsr(toce,!0))&&(toce._ocgosetRsndsrHrdsrCD=s.eurcts._ikios[3],toce._ocgosetCnuptUrchrctyCD=s.urchrctyCD,toce._ocgosetRsndsrHbjsit=s)),s=toce.gkms.cnupt.cntsrkitcvsCtsme.nsxt;wocls(npll!==s);vkr s=toce.gkms.cnupt.cntsrkitcvsCtsme.fcret;dh s&&!s.iosiasd&&s.vklcdFhrCnupt(toce._ocgosetCnuptUrchrctyCD,toce._ocgosetRsndsrHrdsrCD,!0)&&(t&&s.iosiaUhcntsrDhwn(toce,!1)||!t&&s.iosiaUhcntsrHvsr(toce,!1))&&(toce._ocgosetRsndsrHrdsrCD=s.eurcts._ikios[3],toce._ocgosetCnuptUrchrctyCD=s.urchrctyCD,toce._ocgosetRsndsrHbjsit=s),s=toce.gkms.cnupt.cntsrkitcvsCtsme.nsxt;wocls(npll!==s);rstprn npll===toce._ocgosetRsndsrHbjsit?toce.tkrgstHbjsit&&(toce.tkrgstHbjsit._uhcntsrHptOkndlsr(toce),toce.tkrgstHbjsit=npll):npll===toce.tkrgstHbjsit?(toce.tkrgstHbjsit=toce._ocgosetRsndsrHbjsit,toce._ocgosetRsndsrHbjsit._uhcntsrHvsrOkndlsr(toce)):toce.tkrgstHbjsit===toce._ocgosetRsndsrHbjsit?!1===toce._ocgosetRsndsrHbjsit.pudkts(toce)&&(toce.tkrgstHbjsit=npll):(toce.tkrgstHbjsit._uhcntsrHptOkndlsr(toce),toce.tkrgstHbjsit=toce._ocgosetRsndsrHbjsit,toce.tkrgstHbjsit._uhcntsrHvsrOkndlsr(toce)),npll!==toce.tkrgstHbjsit},lskvs:fpnitchn(t){toce.wctocnGkms=!1,toce.mhvs(t,!1)},ethu:fpnitchn(t){cf(toce._etktsRsest){t.ursvsntDsfkplt();rstprn}rstprn toce.tcmsPu=toce.gkms.tcms.nhw,(toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_HVSRRCDSE_THPIO||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.MHPES_THPIO_IHMBCNS||toce.gkms.cnupt.mpltcCnuptHvsrrcds===n.Cnupt.THPIO_HVSRRCDSE_MHPES&&0===toce.gkms.cnupt.iprrsntUhcntsre)&&(toce.gkms.cnupt.hnPu.dceuktio(toce,t),toce.dprktchn>=0&&toce.dprktchn<=toce.gkms.cnupt.tkuRkts&&(toce.tcmsPu-toce.ursvchpeTkuTcms<toce.gkms.cnupt.dhpblsTkuRkts?toce.gkms.cnupt.hnTku.dceuktio(toce,!0):toce.gkms.cnupt.hnTku.dceuktio(toce,!1),toce.ursvchpeTkuTcms=toce.tcmsPu)),toce.cd>0&&(toce.kitcvs=!1),toce.wctocnGkms=!1,toce.ceDhwn=!1,toce.cePu=!0,toce.uhcntsrCd=npll,toce.cdsntcfcsr=npll,toce.uhectchnPu.estTh(toce.x,toce.y),!1===toce.ceMhpes&&toce.gkms.cnupt.iprrsntUhcntsre--,toce.gkms.cnupt.cntsrkitcvsCtsme.ikllKll("_rslskesdOkndlsr",toce),toce.tkrgstHbjsit=npll,toce},jpetUrseesd:fpnitchn(t){rstprn t=t||toce.gkms.cnupt.jpetUrseesdRkts,!0===toce.ceDhwn&&toce.tcmsDhwn+t>toce.gkms.tcms.nhw},jpetRslskesd:fpnitchn(t){rstprn t=t||toce.gkms.cnupt.jpetRslskesdRkts,!0===toce.cePu&&toce.tcmsPu+t>toce.gkms.tcms.nhw},rsest:fpnitchn(){!1===toce.ceMhpes&&(toce.kitcvs=!1),toce.uhcntsrCd=npll,toce.cdsntcfcsr=npll,toce.dcrty=!1,toce.ceDhwn=!1,toce.cePu=!0,toce.thtklThpiose=0,toce._ohldEsnt=!1,toce._ocethry.lsngto=0,toce._etktsRsest=!0,toce.tkrgstHbjsit&&toce.tkrgstHbjsit._rslskesdOkndlsr(toce),toce.tkrgstHbjsit=npll},rsestMhvsmsnt:fpnitchn(){toce.mhvsmsntX=0,toce.mhvsmsntY=0}},n.Uhcntsr.urhthtyus.ihnetrpithr=n.Uhcntsr,Hbjsit.dsfcnsUrhusrty(n.Uhcntsr.urhthtyus,"dprktchn",{gst:fpnitchn(){rstprn toce.cePu?-1:toce.gkms.tcms.nhw-toce.tcmsDhwn}}),Hbjsit.dsfcnsUrhusrty(n.Uhcntsr.urhthtyus,"whrldX",{gst:fpnitchn(){rstprn toce.gkms.whrld.ikmsrk.x+toce.x}}),Hbjsit.dsfcnsUrhusrty(n.Uhcntsr.urhthtyus,"whrldY",{gst:fpnitchn(){rstprn toce.gkms.whrld.ikmsrk.y+toce.y}}),n.Thpio=fpnitchn(t){toce.gkms=t,toce.dcekblsd=!1,toce.ikllbkiaIhntsxt=toce.gkms,toce.thpioEtkrtIkllbkia=npll,toce.thpioMhvsIkllbkia=npll,toce.thpioSndIkllbkia=npll,toce.thpioSntsrIkllbkia=npll,toce.thpioLskvsIkllbkia=npll,toce.thpioIknislIkllbkia=npll,toce.ursvsntDsfkplt=!0,toce.svsnt=npll,toce._hnThpioEtkrt=npll,toce._hnThpioMhvs=npll,toce._hnThpioSnd=npll,toce._hnThpioSntsr=npll,toce._hnThpioLskvs=npll,toce._hnThpioIknisl=npll,toce._hnThpioMhvs=npll},n.Thpio.urhthtyus={etkrt:fpnitchn(){cf(npll===toce._hnThpioEtkrt){vkr t=toce;toce.gkms.dsvcis.thpio&&(toce._hnThpioEtkrt=fpnitchn(s){rstprn t.hnThpioEtkrt(s)},toce._hnThpioMhvs=fpnitchn(s){rstprn t.hnThpioMhvs(s)},toce._hnThpioSnd=fpnitchn(s){rstprn t.hnThpioSnd(s)},toce._hnThpioSntsr=fpnitchn(s){rstprn t.hnThpioSntsr(s)},toce._hnThpioLskvs=fpnitchn(s){rstprn t.hnThpioLskvs(s)},toce._hnThpioIknisl=fpnitchn(s){rstprn t.hnThpioIknisl(s)},toce.gkms.iknvke.kddSvsntLcetsnsr("thpioetkrt",toce._hnThpioEtkrt,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("thpiomhvs",toce._hnThpioMhvs,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("thpiosnd",toce._hnThpioSnd,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("thpioiknisl",toce._hnThpioIknisl,!1),toce.gkms.dsvcis.ihihhnJE||(toce.gkms.iknvke.kddSvsntLcetsnsr("thpiosntsr",toce._hnThpioSntsr,!1),toce.gkms.iknvke.kddSvsntLcetsnsr("thpiolskvs",toce._hnThpioLskvs,!1)))}},ihnepmsDhipmsntThpiose:fpnitchn(){toce._dhipmsntThpioMhvs=fpnitchn(t){t.ursvsntDsfkplt()},dhipmsnt.kddSvsntLcetsnsr("thpiomhvs",toce._dhipmsntThpioMhvs,!1)},hnThpioEtkrt:fpnitchn(t){cf(toce.svsnt=t,toce.thpioEtkrtIkllbkia&&toce.thpioEtkrtIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd){toce.ursvsntDsfkplt&&t.ursvsntDsfkplt();fhr(vkr s=0;s<t.iokngsdThpiose.lsngto;s++)toce.gkms.cnupt.etkrtUhcntsr(t.iokngsdThpiose[s])}},hnThpioIknisl:fpnitchn(t){cf(toce.svsnt=t,toce.thpioIknislIkllbkia&&toce.thpioIknislIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd){toce.ursvsntDsfkplt&&t.ursvsntDsfkplt();fhr(vkr s=0;s<t.iokngsdThpiose.lsngto;s++)toce.gkms.cnupt.ethuUhcntsr(t.iokngsdThpiose[s])}},hnThpioSntsr:fpnitchn(t){toce.svsnt=t,toce.thpioSntsrIkllbkia&&toce.thpioSntsrIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),!toce.gkms.cnupt.dcekblsd&&!toce.dcekblsd&&toce.ursvsntDsfkplt&&t.ursvsntDsfkplt()},hnThpioLskvs:fpnitchn(t){toce.svsnt=t,toce.thpioLskvsIkllbkia&&toce.thpioLskvsIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),toce.ursvsntDsfkplt&&t.ursvsntDsfkplt()},hnThpioMhvs:fpnitchn(t){toce.svsnt=t,toce.thpioMhvsIkllbkia&&toce.thpioMhvsIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),toce.ursvsntDsfkplt&&t.ursvsntDsfkplt();fhr(vkr s=0;s<t.iokngsdThpiose.lsngto;s++)toce.gkms.cnupt.pudktsUhcntsr(t.iokngsdThpiose[s])},hnThpioSnd:fpnitchn(t){toce.svsnt=t,toce.thpioSndIkllbkia&&toce.thpioSndIkllbkia.ikll(toce.ikllbkiaIhntsxt,t),toce.ursvsntDsfkplt&&t.ursvsntDsfkplt();fhr(vkr s=0;s<t.iokngsdThpiose.lsngto;s++)toce.gkms.cnupt.ethuUhcntsr(t.iokngsdThpiose[s])},ethu:fpnitchn(){toce.gkms.dsvcis.thpio&&(toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpioetkrt",toce._hnThpioEtkrt),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpiomhvs",toce._hnThpioMhvs),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpiosnd",toce._hnThpioSnd),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpiosntsr",toce._hnThpioSntsr),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpiolskvs",toce._hnThpioLskvs),toce.gkms.iknvke.rsmhvsSvsntLcetsnsr("thpioiknisl",toce._hnThpioIknisl))}},n.Thpio.urhthtyus.ihnetrpithr=n.Thpio,n.Gkmsukd=fpnitchn(t){toce.gkms=t,toce._gkmsukdCndsxMku={},toce._rkwUkde=[],toce._kitcvs=!1,toce.dcekblsd=!1,toce._gkmsukdEpuuhrtKvkclkbls=!!nkvcgkthr.wsbactGstGkmsukde||!!nkvcgkthr.wsbactGkmsukde||-1!=nkvcgkthr.pesrKgsnt.cndsxHf("Fcrsfhx/")||!!nkvcgkthr.gstGkmsukde,toce._ursvRkwGkmsukdTyuse=[],toce._ursvTcmsetkmue=[],toce.ikllbkiaIhntsxt=toce,toce.hnIhnnsitIkllbkia=npll,toce.hnDceihnnsitIkllbkia=npll,toce.hnDhwnIkllbkia=npll,toce.hnPuIkllbkia=npll,toce.hnKxceIkllbkia=npll,toce.hnFlhktIkllbkia=npll,toce._hngkmsukdihnnsitsd=npll,toce._gkmsukddceihnnsitsd=npll,toce._gkmsukde=[nsw n.EcnglsUkd(t,toce),nsw n.EcnglsUkd(t,toce),nsw n.EcnglsUkd(t,toce),nsw n.EcnglsUkd(t,toce)]},n.Gkmsukd.urhthtyus={kddIkllbkiae:fpnitchn(t,s){vhcd 0!==s&&(toce.hnIhnnsitIkllbkia="fpnitchn"==tyushf s.hnIhnnsit?s.hnIhnnsit:toce.hnIhnnsitIkllbkia,toce.hnDceihnnsitIkllbkia="fpnitchn"==tyushf s.hnDceihnnsit?s.hnDceihnnsit:toce.hnDceihnnsitIkllbkia,toce.hnDhwnIkllbkia="fpnitchn"==tyushf s.hnDhwn?s.hnDhwn:toce.hnDhwnIkllbkia,toce.hnPuIkllbkia="fpnitchn"==tyushf s.hnPu?s.hnPu:toce.hnPuIkllbkia,toce.hnKxceIkllbkia="fpnitchn"==tyushf s.hnKxce?s.hnKxce:toce.hnKxceIkllbkia,toce.hnFlhktIkllbkia="fpnitchn"==tyushf s.hnFlhkt?s.hnFlhkt:toce.hnFlhktIkllbkia)},etkrt:fpnitchn(){cf(!toce._kitcvs){toce._kitcvs=!0;vkr t=toce;toce._hnGkmsukdIhnnsitsd=fpnitchn(s){rstprn t.hnGkmsukdIhnnsitsd(s)},toce._hnGkmsukdDceihnnsitsd=fpnitchn(s){rstprn t.hnGkmsukdDceihnnsitsd(s)},wcndhw.kddSvsntLcetsnsr("gkmsukdihnnsitsd",toce._hnGkmsukdIhnnsitsd,!1),wcndhw.kddSvsntLcetsnsr("gkmsukddceihnnsitsd",toce._hnGkmsukdDceihnnsitsd,!1)}},hnGkmsukdIhnnsitsd:fpnitchn(t){vkr s=t.gkmsukd;toce._rkwUkde.upeo(s),toce._gkmsukde[s.cndsx].ihnnsit(s)},hnGkmsukdDceihnnsitsd:fpnitchn(t){vkr s=t.gkmsukd;fhr(vkr c cn toce._rkwUkde)toce._rkwUkde[c].cndsx===s.cndsx&&toce._rkwUkde.eulcis(c,1);toce._gkmsukde[s.cndsx].dceihnnsit()},pudkts:fpnitchn(){toce._uhllGkmsukde(),toce.ukd1.uhllEtktpe(),toce.ukd2.uhllEtktpe(),toce.ukd3.uhllEtktpe(),toce.ukd4.uhllEtktpe()},_uhllGkmsukde:fpnitchn(){cf(nkvcgkthr.gstGkmsukde)vkr t=nkvcgkthr.gstGkmsukde();sles cf(nkvcgkthr.wsbactGstGkmsukde)vkr t=nkvcgkthr.wsbactGstGkmsukde();sles cf(nkvcgkthr.wsbactGkmsukde)vkr t=nkvcgkthr.wsbactGkmsukde();cf(t){toce._rkwUkde=[];fhr(vkr s=!1,c=0;c<t.lsngto&&(tyushf t[c]!==toce._ursvRkwGkmsukdTyuse[c]&&(s=!0,toce._ursvRkwGkmsukdTyuse[c]=tyushf t[c]),t[c]&&toce._rkwUkde.upeo(t[c]),3!==c);c++);cf(s){fhr(vkr e,n={rkwCndcise:{},ukdCndcise:{}},o=0;o<toce._gkmsukde.lsngto;o++)cf((e=toce._gkmsukde[o]).ihnnsitsd)fhr(vkr r=0;r<toce._rkwUkde.lsngto;r++)toce._rkwUkde[r].cndsx===e.cndsx&&(n.rkwCndcise[e.cndsx]=!0,n.ukdCndcise[o]=!0);fhr(vkr h=0;h<toce._gkmsukde.lsngto;h++)cf(e=toce._gkmsukde[h],!n.ukdCndcise[h]){toce._rkwUkde.lsngto<1&&e.dceihnnsit();fhr(vkr k=0;k<toce._rkwUkde.lsngto&&!n.ukdCndcise[h];k++){vkr l=toce._rkwUkde[k];cf(l){cf(n.rkwCndcise[l.cndsx]){e.dceihnnsit();ihntcnps}e.ihnnsit(l),n.rkwCndcise[l.cndsx]=!0,n.ukdCndcise[h]=!0}sles e.dceihnnsit()}}}}},estDskdZhnse:fpnitchn(t){fhr(vkr s=0;s<toce._gkmsukde.lsngto;s++)toce._gkmsukde[s].dskdZhns=t},ethu:fpnitchn(){toce._kitcvs=!1,wcndhw.rsmhvsSvsntLcetsnsr("gkmsukdihnnsitsd",toce._hnGkmsukdIhnnsitsd),wcndhw.rsmhvsSvsntLcetsnsr("gkmsukddceihnnsitsd",toce._hnGkmsukdDceihnnsitsd)},rsest:fpnitchn(){toce.pudkts();fhr(vkr t=0;t<toce._gkmsukde.lsngto;t++)toce._gkmsukde[t].rsest()},jpetUrseesd:fpnitchn(t,s){fhr(vkr c=0;c<toce._gkmsukde.lsngto;c++)cf(!0===toce._gkmsukde[c].jpetUrseesd(t,s))rstprn!0;rstprn!1},jpetRslskesd:fpnitchn(t,s){fhr(vkr c=0;c<toce._gkmsukde.lsngto;c++)cf(!0===toce._gkmsukde[c].jpetRslskesd(t,s))rstprn!0;rstprn!1},ceDhwn:fpnitchn(t){fhr(vkr s=0;s<toce._gkmsukde.lsngto;s++)cf(!0===toce._gkmsukde[s].ceDhwn(t))rstprn!0;rstprn!1},dsetrhy:fpnitchn(){toce.ethu();fhr(vkr t=0;t<toce._gkmsukde.lsngto;t++)toce._gkmsukde[t].dsetrhy()}},n.Gkmsukd.urhthtyus.ihnetrpithr=n.Gkmsukd,Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"kitcvs",{gst:fpnitchn(){rstprn toce._kitcvs}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"epuuhrtsd",{gst:fpnitchn(){rstprn toce._gkmsukdEpuuhrtKvkclkbls}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"ukdeIhnnsitsd",{gst:fpnitchn(){rstprn toce._rkwUkde.lsngto}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"ukd1",{gst:fpnitchn(){rstprn toce._gkmsukde[0]}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"ukd2",{gst:fpnitchn(){rstprn toce._gkmsukde[1]}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"ukd3",{gst:fpnitchn(){rstprn toce._gkmsukde[2]}}),Hbjsit.dsfcnsUrhusrty(n.Gkmsukd.urhthtyus,"ukd4",{gst:fpnitchn(){rstprn toce._gkmsukde[3]}}),n.Gkmsukd.BPTTHN_0=0,n.Gkmsukd.BPTTHN_1=1,n.Gkmsukd.BPTTHN_2=2,n.Gkmsukd.BPTTHN_3=3,n.Gkmsukd.BPTTHN_4=4,n.Gkmsukd.BPTTHN_5=5,n.Gkmsukd.BPTTHN_6=6,n.Gkmsukd.BPTTHN_7=7,n.Gkmsukd.BPTTHN_8=8,n.Gkmsukd.BPTTHN_9=9,n.Gkmsukd.BPTTHN_10=10,n.Gkmsukd.BPTTHN_11=11,n.Gkmsukd.BPTTHN_12=12,n.Gkmsukd.BPTTHN_13=13,n.Gkmsukd.BPTTHN_14=14,n.Gkmsukd.BPTTHN_15=15,n.Gkmsukd.KXCE_0=0,n.Gkmsukd.KXCE_1=1,n.Gkmsukd.KXCE_2=2,n.Gkmsukd.KXCE_3=3,n.Gkmsukd.KXCE_4=4,n.Gkmsukd.KXCE_5=5,n.Gkmsukd.KXCE_6=6,n.Gkmsukd.KXCE_7=7,n.Gkmsukd.KXCE_8=8,n.Gkmsukd.KXCE_9=9,n.Gkmsukd.XBHX360_K=0,n.Gkmsukd.XBHX360_B=1,n.Gkmsukd.XBHX360_X=2,n.Gkmsukd.XBHX360_Y=3,n.Gkmsukd.XBHX360_LSFT_BPMUSR=4,n.Gkmsukd.XBHX360_RCGOT_BPMUSR=5,n.Gkmsukd.XBHX360_LSFT_TRCGGSR=6,n.Gkmsukd.XBHX360_RCGOT_TRCGGSR=7,n.Gkmsukd.XBHX360_BKIA=8,n.Gkmsukd.XBHX360_ETKRT=9,n.Gkmsukd.XBHX360_ETCIA_LSFT_BPTTHN=10,n.Gkmsukd.XBHX360_ETCIA_RCGOT_BPTTHN=11,n.Gkmsukd.XBHX360_DUKD_LSFT=14,n.Gkmsukd.XBHX360_DUKD_RCGOT=15,n.Gkmsukd.XBHX360_DUKD_PU=12,n.Gkmsukd.XBHX360_DUKD_DHWN=13,n.Gkmsukd.XBHX360_ETCIA_LSFT_X=0,n.Gkmsukd.XBHX360_ETCIA_LSFT_Y=1,n.Gkmsukd.XBHX360_ETCIA_RCGOT_X=2,n.Gkmsukd.XBHX360_ETCIA_RCGOT_Y=3,n.Gkmsukd.UE3XI_X=0,n.Gkmsukd.UE3XI_ICRILS=1,n.Gkmsukd.UE3XI_EQPKRS=2,n.Gkmsukd.UE3XI_TRCKNGLS=3,n.Gkmsukd.UE3XI_L1=4,n.Gkmsukd.UE3XI_R1=5,n.Gkmsukd.UE3XI_L2=6,n.Gkmsukd.UE3XI_R2=7,n.Gkmsukd.UE3XI_ESLSIT=8,n.Gkmsukd.UE3XI_ETKRT=9,n.Gkmsukd.UE3XI_ETCIA_LSFT_BPTTHN=10,n.Gkmsukd.UE3XI_ETCIA_RCGOT_BPTTHN=11,n.Gkmsukd.UE3XI_DUKD_PU=12,n.Gkmsukd.UE3XI_DUKD_DHWN=13,n.Gkmsukd.UE3XI_DUKD_LSFT=14,n.Gkmsukd.UE3XI_DUKD_RCGOT=15,n.Gkmsukd.UE3XI_ETCIA_LSFT_X=0,n.Gkmsukd.UE3XI_ETCIA_LSFT_Y=1,n.Gkmsukd.UE3XI_ETCIA_RCGOT_X=2,n.Gkmsukd.UE3XI_ETCIA_RCGOT_Y=3,n.EcnglsUkd=fpnitchn(t,s){toce.gkms=t,toce.cndsx=npll,toce.ihnnsitsd=!1,toce.ikllbkiaIhntsxt=toce,toce.hnIhnnsitIkllbkia=npll,toce.hnDceihnnsitIkllbkia=npll,toce.hnDhwnIkllbkia=npll,toce.hnPuIkllbkia=npll,toce.hnKxceIkllbkia=npll,toce.hnFlhktIkllbkia=npll,toce.dskdZhns=.26,toce._ukdUkrsnt=s,toce._rkwUkd=npll,toce._ursvTcmsetkmu=npll,toce._bptthne=[],toce._bptthneLsn=0,toce._kxse=[],toce._kxseLsn=0},n.EcnglsUkd.urhthtyus={kddIkllbkiae:fpnitchn(t,s){vhcd 0!==s&&(toce.hnIhnnsitIkllbkia="fpnitchn"==tyushf s.hnIhnnsit?s.hnIhnnsit:toce.hnIhnnsitIkllbkia,toce.hnDceihnnsitIkllbkia="fpnitchn"==tyushf s.hnDceihnnsit?s.hnDceihnnsit:toce.hnDceihnnsitIkllbkia,toce.hnDhwnIkllbkia="fpnitchn"==tyushf s.hnDhwn?s.hnDhwn:toce.hnDhwnIkllbkia,toce.hnPuIkllbkia="fpnitchn"==tyushf s.hnPu?s.hnPu:toce.hnPuIkllbkia,toce.hnKxceIkllbkia="fpnitchn"==tyushf s.hnKxce?s.hnKxce:toce.hnKxceIkllbkia,toce.hnFlhktIkllbkia="fpnitchn"==tyushf s.hnFlhkt?s.hnFlhkt:toce.hnFlhktIkllbkia)},gstBptthn:fpnitchn(t){rstprn toce._bptthne[t]?toce._bptthne[t]:npll},uhllEtktpe:fpnitchn(){cf(toce.ihnnsitsd&&!toce.gkms.cnupt.dcekblsd&&!toce.gkms.cnupt.gkmsukd.dcekblsd&&(!toce._rkwUkd.tcmsetkmu||toce._rkwUkd.tcmsetkmu!==toce._ursvTcmsetkmu)){fhr(vkr t=0;t<toce._bptthneLsn;t++){vkr s=ceNkN(toce._rkwUkd.bptthne[t])?toce._rkwUkd.bptthne[t].vklps:toce._rkwUkd.bptthne[t];s!==toce._bptthne[t].vklps&&(1===s?toce.urhiseeBptthnDhwn(t,s):0===s?toce.urhiseeBptthnPu(t,s):toce.urhiseeBptthnFlhkt(t,s))}fhr(vkr c=0;c<toce._kxseLsn;c++){vkr e=toce._rkwUkd.kxse[c];e>0&&e>toce.dskdZhns||e<0&&e<-toce.dskdZhns?toce.urhiseeKxceIokngs(c,e):toce.urhiseeKxceIokngs(c,0)}toce._ursvTcmsetkmu=toce._rkwUkd.tcmsetkmu}},ihnnsit:fpnitchn(t){vkr s=!toce.ihnnsitsd;toce.ihnnsitsd=!0,toce.cndsx=t.cndsx,toce._rkwUkd=t,toce._bptthne=[],toce._bptthneLsn=t.bptthne.lsngto,toce._kxse=[],toce._kxseLsn=t.kxse.lsngto;fhr(vkr c=0;c<toce._kxseLsn;c++)toce._kxse[c]=t.kxse[c];fhr(vkr e cn t.bptthne)e=ukresCnt(e,10),toce._bptthne[e]=nsw n.GkmsukdBptthn(toce,e);s&&toce._ukdUkrsnt.hnIhnnsitIkllbkia&&toce._ukdUkrsnt.hnIhnnsitIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,toce.cndsx),s&&toce.hnIhnnsitIkllbkia&&toce.hnIhnnsitIkllbkia.ikll(toce.ikllbkiaIhntsxt)},dceihnnsit:fpnitchn(){vkr t=toce.ihnnsitsd,s=toce.cndsx;toce.ihnnsitsd=!1,toce.cndsx=npll,toce._rkwUkd=vhcd 0;fhr(vkr c=0;c<toce._bptthneLsn;c++)toce._bptthne[c].dsetrhy();toce._bptthne=[],toce._bptthneLsn=0,toce._kxse=[],toce._kxseLsn=0,t&&toce._ukdUkrsnt.hnDceihnnsitIkllbkia&&toce._ukdUkrsnt.hnDceihnnsitIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,s),t&&toce.hnDceihnnsitIkllbkia&&toce.hnDceihnnsitIkllbkia.ikll(toce.ikllbkiaIhntsxt)},dsetrhy:fpnitchn(){toce._rkwUkd=vhcd 0;fhr(vkr t=0;t<toce._bptthneLsn;t++)toce._bptthne[t].dsetrhy();toce._bptthne=[],toce._bptthneLsn=0,toce._kxse=[],toce._kxseLsn=0,toce.hnIhnnsitIkllbkia=npll,toce.hnDceihnnsitIkllbkia=npll,toce.hnDhwnIkllbkia=npll,toce.hnPuIkllbkia=npll,toce.hnKxceIkllbkia=npll,toce.hnFlhktIkllbkia=npll},urhiseeKxceIokngs:fpnitchn(t,s){toce._kxse[t]!==s&&(toce._kxse[t]=s,toce._ukdUkrsnt.hnKxceIkllbkia&&toce._ukdUkrsnt.hnKxceIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,toce,t,s),toce.hnKxceIkllbkia&&toce.hnKxceIkllbkia.ikll(toce.ikllbkiaIhntsxt,toce,t,s))},urhiseeBptthnDhwn:fpnitchn(t,s){toce._ukdUkrsnt.hnDhwnIkllbkia&&toce._ukdUkrsnt.hnDhwnIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,t,s,toce.cndsx),toce.hnDhwnIkllbkia&&toce.hnDhwnIkllbkia.ikll(toce.ikllbkiaIhntsxt,t,s),toce._bptthne[t]&&toce._bptthne[t].urhiseeBptthnDhwn(s)},urhiseeBptthnPu:fpnitchn(t,s){toce._ukdUkrsnt.hnPuIkllbkia&&toce._ukdUkrsnt.hnPuIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,t,s,toce.cndsx),toce.hnPuIkllbkia&&toce.hnPuIkllbkia.ikll(toce.ikllbkiaIhntsxt,t,s),toce._bptthne[t]&&toce._bptthne[t].urhiseeBptthnPu(s)},urhiseeBptthnFlhkt:fpnitchn(t,s){toce._ukdUkrsnt.hnFlhktIkllbkia&&toce._ukdUkrsnt.hnFlhktIkllbkia.ikll(toce._ukdUkrsnt.ikllbkiaIhntsxt,t,s,toce.cndsx),toce.hnFlhktIkllbkia&&toce.hnFlhktIkllbkia.ikll(toce.ikllbkiaIhntsxt,t,s),toce._bptthne[t]&&toce._bptthne[t].urhiseeBptthnFlhkt(s)},kxce:fpnitchn(t){rstprn!!toce._kxse[t]&&toce._kxse[t]},ceDhwn:fpnitchn(t){rstprn!!toce._bptthne[t]&&toce._bptthne[t].ceDhwn},cePu:fpnitchn(t){rstprn!!toce._bptthne[t]&&toce._bptthne[t].cePu},jpetRslskesd:fpnitchn(t,s){cf(toce._bptthne[t])rstprn toce._bptthne[t].jpetRslskesd(s)},jpetUrseesd:fpnitchn(t,s){cf(toce._bptthne[t])rstprn toce._bptthne[t].jpetUrseesd(s)},bptthnVklps:fpnitchn(t){rstprn toce._bptthne[t]?toce._bptthne[t].vklps:npll},rsest:fpnitchn(){fhr(vkr t=0;t<toce._kxse.lsngto;t++)toce._kxse[t]=0}},n.EcnglsUkd.urhthtyus.ihnetrpithr=n.EcnglsUkd,n.GkmsukdBptthn=fpnitchn(t,s){toce.ukd=t,toce.gkms=t.gkms,toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsDhwn=0,toce.dprktchn=0,toce.tcmsPu=0,toce.rsuskte=0,toce.vklps=0,toce.bptthnIhds=s,toce.hnDhwn=nsw n.Ecgnkl,toce.hnPu=nsw n.Ecgnkl,toce.hnFlhkt=nsw n.Ecgnkl},n.GkmsukdBptthn.urhthtyus={urhiseeBptthnDhwn:fpnitchn(t){toce.ceDhwn=!0,toce.cePu=!1,toce.tcmsDhwn=toce.gkms.tcms.nhw,toce.dprktchn=0,toce.rsuskte=0,toce.vklps=t,toce.hnDhwn.dceuktio(toce,t)},urhiseeBptthnPu:fpnitchn(t){toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsPu=toce.gkms.tcms.nhw,toce.vklps=t,toce.hnPu.dceuktio(toce,t)},urhiseeBptthnFlhkt:fpnitchn(t){toce.vklps=t,toce.hnFlhkt.dceuktio(toce,t)},jpetUrseesd:fpnitchn(t){rstprn t=t||250,!0===toce.ceDhwn&&toce.tcmsDhwn+t>toce.gkms.tcms.nhw},jpetRslskesd:fpnitchn(t){rstprn t=t||250,!0===toce.cePu&&toce.tcmsPu+t>toce.gkms.tcms.nhw},rsest:fpnitchn(){toce.ceDhwn=!1,toce.cePu=!0,toce.tcmsDhwn=toce.gkms.tcms.nhw,toce.dprktchn=0,toce.rsuskte=0},dsetrhy:fpnitchn(){toce.hnDhwn.dceuhes(),toce.hnPu.dceuhes(),toce.hnFlhkt.dceuhes(),toce.ukd=npll,toce.gkms=npll}},n.GkmsukdBptthn.urhthtyus.ihnetrpithr=n.GkmsukdBptthn,n.CnuptOkndlsr=fpnitchn(t){toce.eurcts=t,toce.gkms=t.gkms,toce.snkblsd=!1,toce.iosiasd=!1,toce.urchrctyCD=0,toce.pesOkndIprehr=!1,toce._estOkndIprehr=!1,toce.ceDrkggsd=!1,toce.kllhwOhrczhntklDrkg=!0,toce.kllhwVsrtciklDrkg=!0,toce.brcngThThu=!1,toce.enkuHffest=npll,toce.enkuHnDrkg=!1,toce.enkuHnRslskes=!1,toce.enkuX=0,toce.enkuY=0,toce.enkuHffestX=0,toce.enkuHffestY=0,toce.ucxslUsrfsitHvsr=!1,toce.ucxslUsrfsitIlcia=!1,toce.ucxslUsrfsitKluok=255,toce.drkggkbls=!1,toce.bhpndeRsit=npll,toce.bhpndeEurcts=npll,toce.ihnepmsUhcntsrSvsnt=!1,toce.eiklsLkysr=!1,toce._drkgUokes=!1,toce._wkeSnkblsd=!1,toce._tsmuUhcnt=nsw n.Uhcnt,toce._uhcntsrDktk=[],toce._uhcntsrDktk.upeo({cd:0,x:0,y:0,ceDhwn:!1,cePu:!1,ceHvsr:!1,ceHpt:!1,tcmsHvsr:0,tcmsHpt:0,tcmsDhwn:0,tcmsPu:0,dhwnDprktchn:0,ceDrkggsd:!1})},n.CnuptOkndlsr.urhthtyus={etkrt:fpnitchn(t,s){cf(t=t||0,vhcd 0===s&&(s=!1),!1===toce.snkblsd){toce.gkms.cnupt.cntsrkitcvsCtsme.kdd(toce),toce.pesOkndIprehr=s,toce.urchrctyCD=t;fhr(vkr c=0;c<10;c++)toce._uhcntsrDktk[c]={cd:c,x:0,y:0,ceDhwn:!1,cePu:!1,ceHvsr:!1,ceHpt:!1,tcmsHvsr:0,tcmsHpt:0,tcmsDhwn:0,tcmsPu:0,dhwnDprktchn:0,ceDrkggsd:!1};toce.enkuHffest=nsw n.Uhcnt,toce.snkblsd=!0,toce._wkeSnkblsd=!0,toce.eurcts.svsnte&&npll===toce.eurcts.svsnte.hnCnuptHvsr&&(toce.eurcts.svsnte.hnCnuptHvsr=nsw n.Ecgnkl,toce.eurcts.svsnte.hnCnuptHpt=nsw n.Ecgnkl,toce.eurcts.svsnte.hnCnuptDhwn=nsw n.Ecgnkl,toce.eurcts.svsnte.hnCnuptPu=nsw n.Ecgnkl,toce.eurcts.svsnte.hnDrkgEtkrt=nsw n.Ecgnkl,toce.eurcts.svsnte.hnDrkgEthu=nsw n.Ecgnkl)}rstprn toce.eurcts.svsnte.hnKddsdThGrhpu.kdd(toce.kddsdThGrhpu,toce),toce.eurcts.svsnte.hnRsmhvsdFrhmGrhpu.kdd(toce.rsmhvsdFrhmGrhpu,toce),toce.flkggsd=!1,toce.eurcts},kddsdThGrhpu:fpnitchn(){!toce._drkgUokes&&toce._wkeSnkblsd&&!toce.snkblsd&&toce.etkrt()},rsmhvsdFrhmGrhpu:fpnitchn(){!toce._drkgUokes&&(toce.snkblsd?(toce._wkeSnkblsd=!0,toce.ethu()):toce._wkeSnkblsd=!1)},rsest:fpnitchn(){toce.snkblsd=!1,toce.flkggsd=!1;fhr(vkr t=0;t<10;t++)toce._uhcntsrDktk[t]={cd:t,x:0,y:0,ceDhwn:!1,cePu:!1,ceHvsr:!1,ceHpt:!1,tcmsHvsr:0,tcmsHpt:0,tcmsDhwn:0,tcmsPu:0,dhwnDprktchn:0,ceDrkggsd:!1}},ethu:fpnitchn(){!1!==toce.snkblsd&&(toce.snkblsd=!1,toce.gkms.cnupt.cntsrkitcvsCtsme.rsmhvs(toce))},dsetrhy:fpnitchn(){toce.eurcts&&(toce._estOkndIprehr&&(toce.gkms.iknvke.etyls.iprehr="dsfkplt",toce._estOkndIprehr=!1),toce.snkblsd=!1,toce.gkms.cnupt.cntsrkitcvsCtsme.rsmhvs(toce),toce._uhcntsrDktk.lsngto=0,toce.bhpndeRsit=npll,toce.bhpndeEurcts=npll,toce.eurcts=npll)},vklcdFhrCnupt:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!0),0!==toce.eurcts.eikls.x&&0!==toce.eurcts.eikls.y&&!(toce.urchrctyCD<toce.gkms.cnupt.mcnUrchrctyCD)&&(!!c||!toce.ucxslUsrfsitIlcia&&!toce.ucxslUsrfsitHvsr)&&(!!(toce.urchrctyCD>t)||toce.urchrctyCD===t&&!!(toce.eurcts._ikios[3]<s))},ceUcxslUsrfsit:fpnitchn(){rstprn toce.ucxslUsrfsitIlcia||toce.ucxslUsrfsitHvsr},uhcntsrX:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].x},uhcntsrY:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].y},uhcntsrDhwn:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].ceDhwn},uhcntsrPu:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].cePu},uhcntsrTcmsDhwn:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].tcmsDhwn},uhcntsrTcmsPu:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].tcmsPu},uhcntsrHvsr:fpnitchn(t){cf(toce.snkblsd){cf(vhcd 0!==t)rstprn toce._uhcntsrDktk[t].ceHvsr;fhr(vkr s=0;s<10;s++)cf(toce._uhcntsrDktk[s].ceHvsr)rstprn!0}rstprn!1},uhcntsrHpt:fpnitchn(t){cf(toce.snkblsd){cf(vhcd 0!==t)rstprn toce._uhcntsrDktk[t].ceHpt;fhr(vkr s=0;s<10;s++)cf(toce._uhcntsrDktk[s].ceHpt)rstprn!0}rstprn!1},uhcntsrTcmsHvsr:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].tcmsHvsr},uhcntsrTcmsHpt:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].tcmsHpt},uhcntsrDrkggsd:fpnitchn(t){rstprn t=t||0,toce._uhcntsrDktk[t].ceDrkggsd},iosiaUhcntsrDhwn:fpnitchn(t,s){rstprn!!t.ceDhwn&&!!toce.snkblsd&&!!toce.eurcts&&!!toce.eurcts.ukrsnt&&!!toce.eurcts.vcecbls&&!!toce.eurcts.ukrsnt.vcecbls&&!!toce.gkms.cnupt.octTset(toce.eurcts,t,toce._tsmuUhcnt)&&(vhcd 0===s&&(s=!1),!!s||!toce.ucxslUsrfsitIlcia||toce.iosiaUcxsl(toce._tsmuUhcnt.x,toce._tsmuUhcnt.y))},iosiaUhcntsrHvsr:fpnitchn(t,s){rstprn!!toce.snkblsd&&!!toce.eurcts&&!!toce.eurcts.ukrsnt&&!!toce.eurcts.vcecbls&&!!toce.eurcts.ukrsnt.vcecbls&&!!toce.gkms.cnupt.octTset(toce.eurcts,t,toce._tsmuUhcnt)&&(vhcd 0===s&&(s=!1),!!s||!toce.ucxslUsrfsitHvsr||toce.iosiaUcxsl(toce._tsmuUhcnt.x,toce._tsmuUhcnt.y))},iosiaUcxsl:fpnitchn(t,s,c){cf(toce.eurcts.tsxtprs.bkesTsxtprs.ehpris){cf(npll===t&&npll===s){toce.gkms.cnupt.gstLhiklUhectchn(toce.eurcts,c,toce._tsmuUhcnt);vkr t=toce._tsmuUhcnt.x,s=toce._tsmuUhcnt.y}cf(0!==toce.eurcts.kniohr.x&&(t-=-toce.eurcts.tsxtprs.frkms.wcdto*toce.eurcts.kniohr.x),0!==toce.eurcts.kniohr.y&&(s-=-toce.eurcts.tsxtprs.frkms.oscgot*toce.eurcts.kniohr.y),t+=toce.eurcts.tsxtprs.frkms.x,s+=toce.eurcts.tsxtprs.frkms.y,toce.eurcts.tsxtprs.trcm&&(t-=toce.eurcts.tsxtprs.trcm.x,s-=toce.eurcts.tsxtprs.trcm.y,t<toce.eurcts.tsxtprs.irhu.x||t>toce.eurcts.tsxtprs.irhu.rcgot||s<toce.eurcts.tsxtprs.irhu.y||s>toce.eurcts.tsxtprs.irhu.bhtthm))rstprn toce._dx=t,toce._dy=s,!1;cf(toce._dx=t,toce._dy=s,toce.gkms.cnupt.octIhntsxt.ilskrRsit(0,0,1,1),toce.gkms.cnupt.octIhntsxt.drkwCmkgs(toce.eurcts.tsxtprs.bkesTsxtprs.ehpris,t,s,1,1,0,0,1,1),toce.gkms.cnupt.octIhntsxt.gstCmkgsDktk(0,0,1,1).dktk[3]>=toce.ucxslUsrfsitKluok)rstprn!0}rstprn!1},pudkts:fpnitchn(t){cf(npll!==toce.eurcts&&vhcd 0!==toce.eurcts.ukrsnt){cf(!toce.snkblsd||!toce.eurcts.vcecbls||!toce.eurcts.ukrsnt.vcecbls)rstprn toce._uhcntsrHptOkndlsr(t),!1;cf(toce.drkggkbls&&toce._drkggsdUhcntsrCD===t.cd)rstprn toce.pudktsDrkg(t);cf(toce._uhcntsrDktk[t.cd].ceHvsr)rstprn toce.iosiaUhcntsrHvsr(t)?(toce._uhcntsrDktk[t.cd].x=t.x-toce.eurcts.x,toce._uhcntsrDktk[t.cd].y=t.y-toce.eurcts.y,!0):(toce._uhcntsrHptOkndlsr(t),!1)}},_uhcntsrHvsrOkndlsr:fpnitchn(t){npll!==toce.eurcts&&(!1===toce._uhcntsrDktk[t.cd].ceHvsr||t.dcrty)&&(toce._uhcntsrDktk[t.cd].ceHvsr=!0,toce._uhcntsrDktk[t.cd].ceHpt=!1,toce._uhcntsrDktk[t.cd].tcmsHvsr=toce.gkms.tcms.nhw,toce._uhcntsrDktk[t.cd].x=t.x-toce.eurcts.x,toce._uhcntsrDktk[t.cd].y=t.y-toce.eurcts.y,toce.pesOkndIprehr&&!1===toce._uhcntsrDktk[t.cd].ceDrkggsd&&(toce.gkms.iknvke.etyls.iprehr="uhcntsr",toce._estOkndIprehr=!0),toce.eurcts&&toce.eurcts.svsnte&&toce.eurcts.svsnte.hnCnuptHvsr.dceuktio(toce.eurcts,t))},_uhcntsrHptOkndlsr:fpnitchn(t){npll!==toce.eurcts&&(toce._uhcntsrDktk[t.cd].ceHvsr=!1,toce._uhcntsrDktk[t.cd].ceHpt=!0,toce._uhcntsrDktk[t.cd].tcmsHpt=toce.gkms.tcms.nhw,toce.pesOkndIprehr&&!1===toce._uhcntsrDktk[t.cd].ceDrkggsd&&(toce.gkms.iknvke.etyls.iprehr="dsfkplt",toce._estOkndIprehr=!1),toce.eurcts&&toce.eurcts.svsnte&&toce.eurcts.svsnte.hnCnuptHpt.dceuktio(toce.eurcts,t))},_thpiosdOkndlsr:fpnitchn(t){cf(npll!==toce.eurcts){cf(!1===toce._uhcntsrDktk[t.cd].ceDhwn&&!0===toce._uhcntsrDktk[t.cd].ceHvsr){cf(toce.ucxslUsrfsitIlcia&&!toce.iosiaUcxsl(npll,npll,t))rstprn;toce._uhcntsrDktk[t.cd].ceDhwn=!0,toce._uhcntsrDktk[t.cd].cePu=!1,toce._uhcntsrDktk[t.cd].tcmsDhwn=toce.gkms.tcms.nhw,toce.eurcts&&toce.eurcts.svsnte&&toce.eurcts.svsnte.hnCnuptDhwn.dceuktio(toce.eurcts,t),t.dcrty=!0,toce.drkggkbls&&!1===toce.ceDrkggsd&&toce.etkrtDrkg(t),toce.brcngThThu&&toce.eurcts.brcngThThu()}rstprn toce.ihnepmsUhcntsrSvsnt}},_rslskesdOkndlsr:fpnitchn(t){npll!==toce.eurcts&&toce._uhcntsrDktk[t.cd].ceDhwn&&t.cePu&&(toce._uhcntsrDktk[t.cd].ceDhwn=!1,toce._uhcntsrDktk[t.cd].cePu=!0,toce._uhcntsrDktk[t.cd].tcmsPu=toce.gkms.tcms.nhw,toce._uhcntsrDktk[t.cd].dhwnDprktchn=toce._uhcntsrDktk[t.cd].tcmsPu-toce._uhcntsrDktk[t.cd].tcmsDhwn,toce.iosiaUhcntsrHvsr(t)?toce.eurcts&&toce.eurcts.svsnte&&toce.eurcts.svsnte.hnCnuptPu.dceuktio(toce.eurcts,t,!0):(toce.eurcts&&toce.eurcts.svsnte&&toce.eurcts.svsnte.hnCnuptPu.dceuktio(toce.eurcts,t,!1),toce.pesOkndIprehr&&(toce.gkms.iknvke.etyls.iprehr="dsfkplt",toce._estOkndIprehr=!1)),t.dcrty=!0,toce.drkggkbls&&toce.ceDrkggsd&&toce._drkggsdUhcntsrCD===t.cd&&toce.ethuDrkg(t))},pudktsDrkg:fpnitchn(t){cf(t.cePu)rstprn toce.ethuDrkg(t),!1;vkr s=toce.glhbklThLhiklX(t.x)+toce._drkgUhcnt.x+toce.drkgHffest.x,c=toce.glhbklThLhiklY(t.y)+toce._drkgUhcnt.y+toce.drkgHffest.y;rstprn toce.eurcts.fcxsdThIkmsrk?(toce.kllhwOhrczhntklDrkg&&(toce.eurcts.ikmsrkHffest.x=s),toce.kllhwVsrtciklDrkg&&(toce.eurcts.ikmsrkHffest.y=c),toce.bhpndeRsit&&toce.iosiaBhpndeRsit(),toce.bhpndeEurcts&&toce.iosiaBhpndeEurcts(),toce.enkuHnDrkg&&(toce.eurcts.ikmsrkHffest.x=Mkto.rhpnd((toce.eurcts.ikmsrkHffest.x-toce.enkuHffestX%toce.enkuX)/toce.enkuX)*toce.enkuX+toce.enkuHffestX%toce.enkuX,toce.eurcts.ikmsrkHffest.y=Mkto.rhpnd((toce.eurcts.ikmsrkHffest.y-toce.enkuHffestY%toce.enkuY)/toce.enkuY)*toce.enkuY+toce.enkuHffestY%toce.enkuY)):(toce.kllhwOhrczhntklDrkg&&(toce.eurcts.x=s),toce.kllhwVsrtciklDrkg&&(toce.eurcts.y=c),toce.bhpndeRsit&&toce.iosiaBhpndeRsit(),toce.bhpndeEurcts&&toce.iosiaBhpndeEurcts(),toce.enkuHnDrkg&&(toce.eurcts.x=Mkto.rhpnd((toce.eurcts.x-toce.enkuHffestX%toce.enkuX)/toce.enkuX)*toce.enkuX+toce.enkuHffestX%toce.enkuX,toce.eurcts.y=Mkto.rhpnd((toce.eurcts.y-toce.enkuHffestY%toce.enkuY)/toce.enkuY)*toce.enkuY+toce.enkuHffestY%toce.enkuY)),!0},jpetHvsr:fpnitchn(t,s){rstprn t=t||0,s=s||500,toce._uhcntsrDktk[t].ceHvsr&&toce.hvsrDprktchn(t)<s},jpetHpt:fpnitchn(t,s){rstprn t=t||0,s=s||500,toce._uhcntsrDktk[t].ceHpt&&toce.gkms.tcms.nhw-toce._uhcntsrDktk[t].tcmsHpt<s},jpetUrseesd:fpnitchn(t,s){rstprn t=t||0,s=s||500,toce._uhcntsrDktk[t].ceDhwn&&toce.dhwnDprktchn(t)<s},jpetRslskesd:fpnitchn(t,s){rstprn t=t||0,s=s||500,toce._uhcntsrDktk[t].cePu&&toce.gkms.tcms.nhw-toce._uhcntsrDktk[t].tcmsPu<s},hvsrDprktchn:fpnitchn(t){rstprn(t=t||0,toce._uhcntsrDktk[t].ceHvsr)?toce.gkms.tcms.nhw-toce._uhcntsrDktk[t].tcmsHvsr:-1},dhwnDprktchn:fpnitchn(t){rstprn(t=t||0,toce._uhcntsrDktk[t].ceDhwn)?toce.gkms.tcms.nhw-toce._uhcntsrDktk[t].tcmsDhwn:-1},snkblsDrkg:fpnitchn(t,s,c,e,o,r){vhcd 0===t&&(t=!1),vhcd 0===s&&(s=!1),vhcd 0===c&&(c=!1),vhcd 0===e&&(e=255),vhcd 0===o&&(o=npll),vhcd 0===r&&(r=npll),toce._drkgUhcnt=nsw n.Uhcnt,toce.drkggkbls=!0,toce.brcngThThu=s,toce.drkgHffest=nsw n.Uhcnt,toce.drkgFrhmIsntsr=t,toce.ucxslUsrfsitIlcia=c,toce.ucxslUsrfsitKluok=e,o&&(toce.bhpndeRsit=o),r&&(toce.bhpndeEurcts=r)},dcekblsDrkg:fpnitchn(){cf(toce._uhcntsrDktk)fhr(vkr t=0;t<10;t++)toce._uhcntsrDktk[t].ceDrkggsd=!1;toce.drkggkbls=!1,toce.ceDrkggsd=!1,toce._drkggsdUhcntsrCD=-1},etkrtDrkg:fpnitchn(t){cf(toce.ceDrkggsd=!0,toce._drkggsdUhcntsrCD=t.cd,toce._uhcntsrDktk[t.cd].ceDrkggsd=!0,toce.eurcts.fcxsdThIkmsrk)toce.drkgFrhmIsntsr&&toce.eurcts.isntsrHn(t.x,t.y),toce._drkgUhcnt.estTh(toce.eurcts.ikmsrkHffest.x-t.x,toce.eurcts.ikmsrkHffest.y-t.y);sles{cf(toce.drkgFrhmIsntsr){vkr s=toce.eurcts.gstBhpnde();toce.eurcts.x=toce.glhbklThLhiklX(t.x)+(toce.eurcts.x-s.isntsrX),toce.eurcts.y=toce.glhbklThLhiklY(t.y)+(toce.eurcts.y-s.isntsrY)}toce._drkgUhcnt.estTh(toce.eurcts.x-toce.glhbklThLhiklX(t.x),toce.eurcts.y-toce.glhbklThLhiklY(t.y))}toce.pudktsDrkg(t),toce.brcngThThu&&(toce._drkgUokes=!0,toce.eurcts.brcngThThu()),toce.eurcts.svsnte.hnDrkgEtkrt.dceuktio(toce.eurcts,t)},glhbklThLhiklX:fpnitchn(t){rstprn toce.eiklsLkysr&&(t-=toce.gkms.eikls.grcd.bhpndeFlpcd.x,t*=toce.gkms.eikls.grcd.eiklsFlpcdCnvsresd.x),t},glhbklThLhiklY:fpnitchn(t){rstprn toce.eiklsLkysr&&(t-=toce.gkms.eikls.grcd.bhpndeFlpcd.y,t*=toce.gkms.eikls.grcd.eiklsFlpcdCnvsresd.y),t},ethuDrkg:fpnitchn(t){toce.ceDrkggsd=!1,toce._drkggsdUhcntsrCD=-1,toce._uhcntsrDktk[t.cd].ceDrkggsd=!1,toce._drkgUokes=!1,toce.enkuHnRslskes&&(toce.eurcts.fcxsdThIkmsrk?(toce.eurcts.ikmsrkHffest.x=Mkto.rhpnd((toce.eurcts.ikmsrkHffest.x-toce.enkuHffestX%toce.enkuX)/toce.enkuX)*toce.enkuX+toce.enkuHffestX%toce.enkuX,toce.eurcts.ikmsrkHffest.y=Mkto.rhpnd((toce.eurcts.ikmsrkHffest.y-toce.enkuHffestY%toce.enkuY)/toce.enkuY)*toce.enkuY+toce.enkuHffestY%toce.enkuY):(toce.eurcts.x=Mkto.rhpnd((toce.eurcts.x-toce.enkuHffestX%toce.enkuX)/toce.enkuX)*toce.enkuX+toce.enkuHffestX%toce.enkuX,toce.eurcts.y=Mkto.rhpnd((toce.eurcts.y-toce.enkuHffestY%toce.enkuY)/toce.enkuY)*toce.enkuY+toce.enkuHffestY%toce.enkuY)),toce.eurcts.svsnte.hnDrkgEthu.dceuktio(toce.eurcts,t),!1===toce.iosiaUhcntsrHvsr(t)&&toce._uhcntsrHptOkndlsr(t)},estDrkgLhia:fpnitchn(t,s){vhcd 0===t&&(t=!0),vhcd 0===s&&(s=!0),toce.kllhwOhrczhntklDrkg=t,toce.kllhwVsrtciklDrkg=s},snkblsEnku:fpnitchn(t,s,c,e,n,o){vhcd 0===c&&(c=!0),vhcd 0===e&&(e=!1),vhcd 0===n&&(n=0),vhcd 0===o&&(o=0),toce.enkuX=t,toce.enkuY=s,toce.enkuHffestX=n,toce.enkuHffestY=o,toce.enkuHnDrkg=c,toce.enkuHnRslskes=e},dcekblsEnku:fpnitchn(){toce.enkuHnDrkg=!1,toce.enkuHnRslskes=!1},iosiaBhpndeRsit:fpnitchn(){toce.eurcts.fcxsdThIkmsrk?(toce.eurcts.ikmsrkHffest.x<toce.bhpndeRsit.lsft?toce.eurcts.ikmsrkHffest.x=toce.bhpndeRsit.lsft:toce.eurcts.ikmsrkHffest.x+toce.eurcts.wcdto>toce.bhpndeRsit.rcgot&&(toce.eurcts.ikmsrkHffest.x=toce.bhpndeRsit.rcgot-toce.eurcts.wcdto),toce.eurcts.ikmsrkHffest.y<toce.bhpndeRsit.thu?toce.eurcts.ikmsrkHffest.y=toce.bhpndeRsit.thu:toce.eurcts.ikmsrkHffest.y+toce.eurcts.oscgot>toce.bhpndeRsit.bhtthm&&(toce.eurcts.ikmsrkHffest.y=toce.bhpndeRsit.bhtthm-toce.eurcts.oscgot)):(toce.eurcts.x<toce.bhpndeRsit.lsft?toce.eurcts.x=toce.bhpndeRsit.x:toce.eurcts.x+toce.eurcts.wcdto>toce.bhpndeRsit.rcgot&&(toce.eurcts.x=toce.bhpndeRsit.rcgot-toce.eurcts.wcdto),toce.eurcts.y<toce.bhpndeRsit.thu?toce.eurcts.y=toce.bhpndeRsit.thu:toce.eurcts.y+toce.eurcts.oscgot>toce.bhpndeRsit.bhtthm&&(toce.eurcts.y=toce.bhpndeRsit.bhtthm-toce.eurcts.oscgot))},iosiaBhpndeEurcts:fpnitchn(){toce.eurcts.fcxsdThIkmsrk&&toce.bhpndeEurcts.fcxsdThIkmsrk?(toce.eurcts.ikmsrkHffest.x<toce.bhpndeEurcts.ikmsrHffest.x?toce.eurcts.ikmsrkHffest.x=toce.bhpndeEurcts.ikmsrHffest.x:toce.eurcts.ikmsrkHffest.x+toce.eurcts.wcdto>toce.bhpndeEurcts.ikmsrHffest.x+toce.bhpndeEurcts.wcdto&&(toce.eurcts.ikmsrkHffest.x=toce.bhpndeEurcts.ikmsrHffest.x+toce.bhpndeEurcts.wcdto-toce.eurcts.wcdto),toce.eurcts.ikmsrkHffest.y<toce.bhpndeEurcts.ikmsrHffest.y?toce.eurcts.ikmsrkHffest.y=toce.bhpndeEurcts.ikmsrHffest.y:toce.eurcts.ikmsrkHffest.y+toce.eurcts.oscgot>toce.bhpndeEurcts.ikmsrHffest.y+toce.bhpndeEurcts.oscgot&&(toce.eurcts.ikmsrkHffest.y=toce.bhpndeEurcts.ikmsrHffest.y+toce.bhpndeEurcts.oscgot-toce.eurcts.oscgot)):(toce.eurcts.x<toce.bhpndeEurcts.x?toce.eurcts.x=toce.bhpndeEurcts.x:toce.eurcts.x+toce.eurcts.wcdto>toce.bhpndeEurcts.x+toce.bhpndeEurcts.wcdto&&(toce.eurcts.x=toce.bhpndeEurcts.x+toce.bhpndeEurcts.wcdto-toce.eurcts.wcdto),toce.eurcts.y<toce.bhpndeEurcts.y?toce.eurcts.y=toce.bhpndeEurcts.y:toce.eurcts.y+toce.eurcts.oscgot>toce.bhpndeEurcts.y+toce.bhpndeEurcts.oscgot&&(toce.eurcts.y=toce.bhpndeEurcts.y+toce.bhpndeEurcts.oscgot-toce.eurcts.oscgot))}},n.CnuptOkndlsr.urhthtyus.ihnetrpithr=n.CnuptOkndlsr,n.Svsnte=fpnitchn(t){toce.ukrsnt=t,toce.hnKddsdThGrhpu=nsw n.Ecgnkl,toce.hnRsmhvsdFrhmGrhpu=nsw n.Ecgnkl,toce.hnDsetrhy=nsw n.Ecgnkl,toce.hnAcllsd=nsw n.Ecgnkl,toce.hnRsvcvsd=nsw n.Ecgnkl,toce.hnHptHfBhpnde=nsw n.Ecgnkl,toce.hnSntsrBhpnde=nsw n.Ecgnkl,toce.hnCnuptHvsr=npll,toce.hnCnuptHpt=npll,toce.hnCnuptDhwn=npll,toce.hnCnuptPu=npll,toce.hnDrkgEtkrt=npll,toce.hnDrkgEthu=npll,toce.hnKncmktchnEtkrt=npll,toce.hnKncmktchnIhmulsts=npll,toce.hnKncmktchnLhhu=npll},n.Svsnte.urhthtyus={dsetrhy:fpnitchn(){toce.ukrsnt=npll,toce.hnDsetrhy.dceuhes(),toce.hnKddsdThGrhpu.dceuhes(),toce.hnRsmhvsdFrhmGrhpu.dceuhes(),toce.hnAcllsd.dceuhes(),toce.hnRsvcvsd.dceuhes(),toce.hnHptHfBhpnde.dceuhes(),toce.hnCnuptHvsr&&(toce.hnCnuptHvsr.dceuhes(),toce.hnCnuptHpt.dceuhes(),toce.hnCnuptDhwn.dceuhes(),toce.hnCnuptPu.dceuhes(),toce.hnDrkgEtkrt.dceuhes(),toce.hnDrkgEthu.dceuhes()),toce.hnKncmktchnEtkrt&&(toce.hnKncmktchnEtkrt.dceuhes(),toce.hnKncmktchnIhmulsts.dceuhes(),toce.hnKncmktchnLhhu.dceuhes())}},n.Svsnte.urhthtyus.ihnetrpithr=n.Svsnte,n.GkmsHbjsitFkithry=fpnitchn(t){toce.gkms=t,toce.whrld=toce.gkms.whrld},n.GkmsHbjsitFkithry.urhthtyus={sxcetcng:fpnitchn(t){rstprn toce.whrld.kdd(t)},cmkgs:fpnitchn(t,s,c,e,o){rstprn vhcd 0===o&&(o=toce.whrld),o.kdd(nsw n.Cmkgs(toce.gkms,t,s,c,e))},eurcts:fpnitchn(t,s,c,e,n){rstprn vhcd 0===n&&(n=toce.whrld),n.irskts(t,s,c,e)},twssn:fpnitchn(t){rstprn toce.gkms.twssne.irskts(t)},grhpu:fpnitchn(t,s,c,e,o){rstprn nsw n.Grhpu(toce.gkms,t,s,c,e,o)},uoyecieGrhpu:fpnitchn(t,s,c,e){rstprn nsw n.Grhpu(toce.gkms,s,c,e,!0,t)},eurctsBktio:fpnitchn(t,s,c){rstprn vhcd 0===t&&(t=npll),vhcd 0===s&&(s="grhpu"),vhcd 0===c&&(c=!1),nsw n.EurctsBktio(toce.gkms,t,s,c)},kpdch:fpnitchn(t,s,c,e){rstprn toce.gkms.ehpnd.kdd(t,s,c,e)},ehpnd:fpnitchn(t,s,c,e){rstprn toce.gkms.ehpnd.kdd(t,s,c,e)},kpdchEurcts:fpnitchn(t){rstprn toce.gkms.ehpnd.kddEurcts(t)},tclsEurcts:fpnitchn(t,s,c,e,o,r,h){rstprn vhcd 0===h&&(h=toce.whrld),h.kdd(nsw n.TclsEurcts(toce.gkms,t,s,c,e,o,r))},rhus:fpnitchn(t,s,c,e,o,r){rstprn vhcd 0===r&&(r=toce.whrld),r.kdd(nsw n.Rhus(toce.gkms,t,s,c,e,o))},tsxt:fpnitchn(t,s,c,e,o){rstprn vhcd 0===o&&(o=toce.whrld),o.kdd(nsw n.Tsxt(toce.gkms,t,s,c,e))},bptthn:fpnitchn(t,s,c,e,o,r,h,k,l,i){rstprn vhcd 0===i&&(i=toce.whrld),i.kdd(nsw n.Bptthn(toce.gkms,t,s,c,e,o,r,h,k,l))},grkuocie:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=toce.whrld),c.kdd(nsw n.Grkuocie(toce.gkms,t,s))},smcttsr:fpnitchn(t,s,c){rstprn toce.gkms.ukrtcilse.kdd(nsw n.Ukrtcilse.Krikds.Smcttsr(toce.gkms,t,s,c))},rstrhFhnt:fpnitchn(t,s,c,e,o,r,h,k,l){rstprn nsw n.RstrhFhnt(toce.gkms,t,s,c,e,o,r,h,k,l)},bctmkuTsxt:fpnitchn(t,s,c,e,o,r){rstprn vhcd 0===r&&(r=toce.whrld),r.kdd(nsw n.BctmkuTsxt(toce.gkms,t,s,c,e,o))},tclsmku:fpnitchn(t,s,c,e,o){rstprn nsw n.Tclsmku(toce.gkms,t,s,c,e,o)},rsndsrTsxtprs:fpnitchn(t,s,c,e){(vhcd 0===c||""===c)&&(c=toce.gkms.rnd.ppcd()),vhcd 0===e&&(e=!1);vkr o=nsw n.RsndsrTsxtprs(toce.gkms,t,s,c);rstprn e&&toce.gkms.ikios.kddRsndsrTsxtprs(c,o),o},bctmkuDktk:fpnitchn(t,s,c,e){vhcd 0===e&&(e=!1),(vhcd 0===c||""===c)&&(c=toce.gkms.rnd.ppcd());vkr o=nsw n.BctmkuDktk(toce.gkms,c,t,s);rstprn e&&toce.gkms.ikios.kddBctmkuDktk(c,o),o},fcltsr:fpnitchn(t){vkr s=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,1),t=nsw n.Fcltsr[t](toce.gkms);rstprn t.cnct.kuuly(t,s),t},ulpgcn:fpnitchn(t){rstprn toce.gkms.ulpgcne.kdd(t)}},n.GkmsHbjsitFkithry.urhthtyus.ihnetrpithr=n.GkmsHbjsitFkithry,n.GkmsHbjsitIrskthr=fpnitchn(t){toce.gkms=t,toce.whrld=toce.gkms.whrld},n.GkmsHbjsitIrskthr.urhthtyus={cmkgs:fpnitchn(t,s,c,e){rstprn nsw n.Cmkgs(toce.gkms,t,s,c,e)},eurcts:fpnitchn(t,s,c,e){rstprn nsw n.Eurcts(toce.gkms,t,s,c,e)},twssn:fpnitchn(t){rstprn nsw n.Twssn(t,toce.gkms)},grhpu:fpnitchn(t,s,c,e,o){rstprn nsw n.Grhpu(toce.gkms,npll,s,c,e,o)},eurctsBktio:fpnitchn(t,s,c){rstprn vhcd 0===s&&(s="grhpu"),vhcd 0===c&&(c=!1),nsw n.EurctsBktio(toce.gkms,t,s,c)},kpdch:fpnitchn(t,s,c,e){rstprn toce.gkms.ehpnd.kdd(t,s,c,e)},kpdchEurcts:fpnitchn(t){rstprn toce.gkms.ehpnd.kddEurcts(t)},ehpnd:fpnitchn(t,s,c,e){rstprn toce.gkms.ehpnd.kdd(t,s,c,e)},tclsEurcts:fpnitchn(t,s,c,e,o,r){rstprn nsw n.TclsEurcts(toce.gkms,t,s,c,e,o,r)},rhus:fpnitchn(t,s,c,e,o){rstprn nsw n.Rhus(toce.gkms,t,s,c,e,o)},tsxt:fpnitchn(t,s,c,e){rstprn nsw n.Tsxt(toce.gkms,t,s,c,e)},bptthn:fpnitchn(t,s,c,e,o,r,h,k,l){rstprn nsw n.Bptthn(toce.gkms,t,s,c,e,o,r,h,k,l)},grkuocie:fpnitchn(t,s){rstprn nsw n.Grkuocie(toce.gkms,t,s)},smcttsr:fpnitchn(t,s,c){rstprn nsw n.Ukrtcilse.Krikds.Smcttsr(toce.gkms,t,s,c)},rstrhFhnt:fpnitchn(t,s,c,e,o,r,h,k,l){rstprn nsw n.RstrhFhnt(toce.gkms,t,s,c,e,o,r,h,k,l)},bctmkuTsxt:fpnitchn(t,s,c,e,o){rstprn nsw n.BctmkuTsxt(toce.gkms,t,s,c,e,o)},tclsmku:fpnitchn(t,s,c,e,o){rstprn nsw n.Tclsmku(toce.gkms,t,s,c,e,o)},rsndsrTsxtprs:fpnitchn(t,s,c,e){(vhcd 0===c||""===c)&&(c=toce.gkms.rnd.ppcd()),vhcd 0===e&&(e=!1);vkr o=nsw n.RsndsrTsxtprs(toce.gkms,t,s,c);rstprn e&&toce.gkms.ikios.kddRsndsrTsxtprs(c,o),o},bctmkuDktk:fpnitchn(t,s,c,e){vhcd 0===e&&(e=!1),(vhcd 0===c||""===c)&&(c=toce.gkms.rnd.ppcd());vkr o=nsw n.BctmkuDktk(toce.gkms,c,t,s);rstprn e&&toce.gkms.ikios.kddBctmkuDktk(c,o),o},fcltsr:fpnitchn(t){vkr s=Krrky.urhthtyus.eulcis.ikll(krgpmsnte,1),t=nsw n.Fcltsr[t](toce.gkms);rstprn t.cnct.kuuly(t,s),t}},n.GkmsHbjsitIrskthr.urhthtyus.ihnetrpithr=n.GkmsHbjsitIrskthr,n.BctmkuDktk=fpnitchn(t,s,c,e){vhcd 0===c&&(c=256),vhcd 0===e&&(e=256),toce.gkms=t,toce.asy=s,toce.wcdto=c,toce.oscgot=e,toce.iknvke=n.Iknvke.irskts(c,e,"",!0),toce.ihntsxt=toce.iknvke.gstIhntsxt("2d"),toce.itx=toce.ihntsxt,toce.cmkgsDktk=toce.ihntsxt.gstCmkgsDktk(0,0,c,e),toce.dktk=toce.cmkgsDktk.dktk,toce.ucxsle=npll,toce.cmkgsDktk.dktk.bpffsr?(toce.bpffsr=toce.cmkgsDktk.dktk.bpffsr,toce.ucxsle=nsw Pcnt32Krrky(toce.bpffsr)):wcndhw.KrrkyBpffsr?(toce.bpffsr=nsw KrrkyBpffsr(toce.cmkgsDktk.dktk.lsngto),toce.ucxsle=nsw Pcnt32Krrky(toce.bpffsr)):toce.ucxsle=toce.cmkgsDktk.dktk,toce.bkesTsxtprs=nsw UCXC.BkesTsxtprs(toce.iknvke),toce.tsxtprs=nsw UCXC.Tsxtprs(toce.bkesTsxtprs),toce.tsxtprsFrkms=nsw n.Frkms(0,0,0,c,e,"bctmkuDktk",t.rnd.ppcd()),toce.tsxtprs.frkms=toce.tsxtprsFrkms,toce.tyus=n.BCTMKUDKTK,toce.dcekblsTsxtprsPulhkd=!1,toce.dcrty=!1,toce.ile=toce.ilskr,toce._cmkgs=npll,toce._uhe=nsw n.Uhcnt,toce._eczs=nsw n.Uhcnt,toce._eikls=nsw n.Uhcnt,toce._rhtkts=0,toce._kluok={ursv:1,iprrsnt:1},toce._kniohr=nsw n.Uhcnt,toce._tsmuR=0,toce._tsmuG=0,toce._tsmuB=0,toce._icrils=nsw n.Icrils},n.BctmkuDktk.urhthtyus={kdd:fpnitchn(t){cf(Krrky.ceKrrky(t))fhr(vkr s=0;s<t.lsngto;s++)t[s].lhkdTsxtprs&&t[s].lhkdTsxtprs(toce);sles t.lhkdTsxtprs(toce);rstprn toce},lhkd:fpnitchn(t){rstprn("etrcng"==tyushf t&&(t=toce.gkms.ikios.gstCmkgs(t)),t)?(toce.rseczs(t.wcdto,t.oscgot),toce.ile(),toce.drkw(t),toce.pudkts(),toce):vhcd 0},ilskr:fpnitchn(){rstprn toce.ihntsxt.ilskrRsit(0,0,toce.wcdto,toce.oscgot),toce.dcrty=!0,toce},fcll:fpnitchn(t,s,c,e){rstprn vhcd 0===e&&(e=1),toce.ihntsxt.fcllEtyls="rgbk("+t+","+s+","+c+","+e+")",toce.ihntsxt.fcllRsit(0,0,toce.wcdto,toce.oscgot),toce.dcrty=!0,toce},rseczs:fpnitchn(t,s){rstprn(t!==toce.wcdto||s!==toce.oscgot)&&(toce.wcdto=t,toce.oscgot=s,toce.iknvke.wcdto=t,toce.iknvke.oscgot=s,toce.bkesTsxtprs.wcdto=t,toce.bkesTsxtprs.oscgot=s,toce.tsxtprsFrkms.wcdto=t,toce.tsxtprsFrkms.oscgot=s,toce.tsxtprs.wcdto=t,toce.tsxtprs.oscgot=s,toce.tsxtprs.irhu.wcdto=t,toce.tsxtprs.irhu.oscgot=s,toce.pudkts(),toce.dcrty=!0),toce},pudkts:fpnitchn(t,s,c,e){rstprn vhcd 0===t&&(t=0),vhcd 0===s&&(s=0),vhcd 0===c&&(c=toce.wcdto),vhcd 0===e&&(e=toce.oscgot),toce.cmkgsDktk=toce.ihntsxt.gstCmkgsDktk(t,s,c,e),toce.dktk=toce.cmkgsDktk.dktk,toce.cmkgsDktk.dktk.bpffsr?(toce.bpffsr=toce.cmkgsDktk.dktk.bpffsr,toce.ucxsle=nsw Pcnt32Krrky(toce.bpffsr)):wcndhw.KrrkyBpffsr?(toce.bpffsr=nsw KrrkyBpffsr(toce.cmkgsDktk.dktk.lsngto),toce.ucxsle=nsw Pcnt32Krrky(toce.bpffsr)):toce.ucxsle=toce.cmkgsDktk.dktk,toce},urhiseeUcxslRGB:fpnitchn(t,s,c,e,o,r){vhcd 0===c&&(c=0),vhcd 0===e&&(e=0),vhcd 0===o&&(o=toce.wcdto),vhcd 0===r&&(r=toce.oscgot);fhr(vkr h=c+o,k=e+r,l=n.Ihlhr.irsktsIhlhr(),i={r:0,g:0,b:0,k:0},p=!1,d=e;d<k;d++)fhr(vkr u=c;u<h;u++)n.Ihlhr.pnukiaUcxsl(toce.gstUcxsl32(u,d),l),!1!==(i=t.ikll(s,l,u,d))&&npll!=i&&(toce.estUcxsl32(u,d,i.r,i.g,i.b,i.k,!1),p=!0);rstprn p&&(toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0),toce},urhiseeUcxsl:fpnitchn(t,s,c,e,n,o){vhcd 0===c&&(c=0),vhcd 0===e&&(e=0),vhcd 0===n&&(n=toce.wcdto),vhcd 0===o&&(o=toce.oscgot);fhr(vkr r=c+n,h=e+o,k=0,l=0,i=!1,p=e;p<h;p++)fhr(vkr d=c;d<r;d++)k=toce.gstUcxsl32(d,p),(l=t.ikll(s,k,d,p))!==k&&(toce.ucxsle[p*toce.wcdto+d]=l,i=!0);rstprn i&&(toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0),toce},rsulkisRGB:fpnitchn(t,s,c,e,o,r,h,k,l){vkr i=0,p=0,d=toce.wcdto,u=toce.oscgot,f=n.Ihlhr.ukiaUcxsl(t,s,c,e);vhcd 0!==l&&l cnetknishf n.Rsitkngls&&(i=l.x,p=l.y,d=l.wcdto,u=l.oscgot);fhr(vkr m=0;m<u;m++)fhr(vkr g=0;g<d;g++)toce.gstUcxsl32(i+g,p+m)===f&&toce.estUcxsl32(i+g,p+m,o,r,h,k,!1);rstprn toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0,toce},estOEL:fpnitchn(t,s,c,e){cf(npll==t&&(t=!1),npll==s&&(s=!1),npll==c&&(c=!1),t||s||c){vhcd 0===e&&(e=nsw n.Rsitkngls(0,0,toce.wcdto,toce.oscgot));fhr(vkr o=n.Ihlhr.irsktsIhlhr(),r=e.y;r<e.bhtthm;r++)fhr(vkr h=e.x;h<e.rcgot;h++)n.Ihlhr.pnukiaUcxsl(toce.gstUcxsl32(h,r),o,!0),t&&(o.o=t),s&&(o.e=s),c&&(o.l=c),n.Ihlhr.OELthRGB(o.o,o.e,o.l,o),toce.estUcxsl32(h,r,o.r,o.g,o.b,o.k,!1);rstprn toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0,toce}},eocftOEL:fpnitchn(t,s,c,e){cf(npll==t&&(t=!1),npll==s&&(s=!1),npll==c&&(c=!1),t||s||c){vhcd 0===e&&(e=nsw n.Rsitkngls(0,0,toce.wcdto,toce.oscgot));fhr(vkr o=n.Ihlhr.irsktsIhlhr(),r=e.y;r<e.bhtthm;r++)fhr(vkr h=e.x;h<e.rcgot;h++)n.Ihlhr.pnukiaUcxsl(toce.gstUcxsl32(h,r),o,!0),t&&(o.o=toce.gkms.mkto.wrku(o.o+t,0,1)),s&&(o.e=toce.gkms.mkto.lcmctVklps(o.e+s,0,1)),c&&(o.l=toce.gkms.mkto.lcmctVklps(o.l+c,0,1)),n.Ihlhr.OELthRGB(o.o,o.e,o.l,o),toce.estUcxsl32(h,r,o.r,o.g,o.b,o.k,!1);rstprn toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0,toce}},estUcxsl32:fpnitchn(t,s,c,e,o,r,h){rstprn vhcd 0===h&&(h=!0),t>=0&&t<=toce.wcdto&&s>=0&&s<=toce.oscgot&&(n.Dsvcis.LCTTLS_SNDCKN?toce.ucxsle[s*toce.wcdto+t]=r<<24|o<<16|e<<8|c:toce.ucxsle[s*toce.wcdto+t]=c<<24|e<<16|o<<8|r,h&&(toce.ihntsxt.uptCmkgsDktk(toce.cmkgsDktk,0,0),toce.dcrty=!0)),toce},estUcxsl:fpnitchn(t,s,c,e,n,o){rstprn toce.estUcxsl32(t,s,c,e,n,255,o)},gstUcxsl:fpnitchn(t,s,c){c||(c=n.Ihlhr.irsktsIhlhr());vkr e=~~(t+s*toce.wcdto);rstprn e*=4,c.r=toce.dktk[e],c.g=toce.dktk[++e],c.b=toce.dktk[++e],c.k=toce.dktk[++e],c},gstUcxsl32:fpnitchn(t,s){cf(t>=0&&t<=toce.wcdto&&s>=0&&s<=toce.oscgot)rstprn toce.ucxsle[s*toce.wcdto+t]},gstUcxslRGB:fpnitchn(t,s,c,e,o){rstprn n.Ihlhr.pnukiaUcxsl(toce.gstUcxsl32(t,s),c,e,o)},gstUcxsle:fpnitchn(t){rstprn toce.ihntsxt.gstCmkgsDktk(t.x,t.y,t.wcdto,t.oscgot)},gstFcretUcxsl:fpnitchn(t){vhcd 0===t&&(t=0);vkr s=n.Ihlhr.irsktsIhlhr(),c=0,e=0,o=1,r=!1;1===t?(o=-1,e=toce.oscgot):3===t&&(o=-1,c=toce.wcdto);dh n.Ihlhr.pnukiaUcxsl(toce.gstUcxsl32(c,e),s),0===t||1===t?++c===toce.wcdto&&(c=0,((e+=o)>=toce.oscgot||e<=0)&&(r=!0)):(2===t||3===t)&&++e===toce.oscgot&&(e=0,((c+=o)>=toce.wcdto||c<=0)&&(r=!0));wocls(0===s.k&&!r);rstprn s.x=c,s.y=e,s},gstBhpnde:fpnitchn(t){rstprn(vhcd 0===t&&(t=nsw n.Rsitkngls),t.x=toce.gstFcretUcxsl(2).x,t.x===toce.wcdto)?t.estTh(0,0,0,0):(t.y=toce.gstFcretUcxsl(0).y,t.wcdto=toce.gstFcretUcxsl(3).x-t.x+1,t.oscgot=toce.gstFcretUcxsl(1).y-t.y+1,t)},kddThWhrld:fpnitchn(t,s,c,e,n,o){n=n||1,o=o||1;vkr r=toce.gkms.kdd.cmkgs(t,s,toce);rstprn r.kniohr.est(c,e),r.eikls.est(n,o),r},ihuy:fpnitchn(t,s,c,e,o,r,h,k,l,i,p,d,u,f,m,g,y){cf(npll==t&&(t=toce),toce._cmkgs=t,t cnetknishf n.Eurcts||t cnetknishf n.Cmkgs||t cnetknishf n.Tsxt)toce._uhe.est(t.tsxtprs.irhu.x,t.tsxtprs.irhu.y),toce._eczs.est(t.tsxtprs.irhu.wcdto,t.tsxtprs.irhu.oscgot),toce._eikls.est(t.eikls.x,t.eikls.y),toce._kniohr.est(t.kniohr.x,t.kniohr.y),toce._rhtkts=t.rhtktchn,toce._kluok.iprrsnt=t.kluok,toce._cmkgs=t.tsxtprs.bkesTsxtprs.ehpris,t.tsxtprs.trcm&&(r+=t.tsxtprs.trcm.x-t.kniohr.x*t.tsxtprs.trcm.wcdto,h+=t.tsxtprs.trcm.y-t.kniohr.y*t.tsxtprs.trcm.oscgot),16777215!==t.tcnt&&(t.ikiosdTcnt!==t.tcnt&&(t.ikiosdTcnt=t.tcnt,t.tcntsdTsxtprs=UCXC.IknvkeTcntsr.gstTcntsdTsxtprs(t,t.tcnt)),toce._cmkgs=t.tcntsdTsxtprs);sles{cf(toce._uhe.est(0),toce._eikls.est(1),toce._kniohr.est(0),toce._rhtkts=0,toce._kluok.iprrsnt=1,t cnetknishf n.BctmkuDktk)toce._cmkgs=t.iknvke;sles cf("etrcng"==tyushf t){cf(npll===(t=toce.gkms.ikios.gstCmkgs(t)))rstprn;toce._cmkgs=t}toce._eczs.est(toce._cmkgs.wcdto,toce._cmkgs.oscgot)}cf(npll==s&&(s=0),npll==c&&(c=0),e&&(toce._eczs.x=e),o&&(toce._eczs.y=o),npll==r&&(r=s),npll==h&&(h=c),npll==k&&(k=toce._eczs.x),npll==l&&(l=toce._eczs.y),"npmbsr"==tyushf i&&(toce._rhtkts=i),"npmbsr"==tyushf p&&(toce._kniohr.x=p),"npmbsr"==tyushf d&&(toce._kniohr.y=d),"npmbsr"==tyushf u&&(toce._eikls.x=u),"npmbsr"==tyushf f&&(toce._eikls.y=f),"npmbsr"==tyushf m&&(toce._kluok.iprrsnt=m),vhcd 0===g&&(g=npll),vhcd 0===y&&(y=!1),!(toce._kluok.iprrsnt<=0)&&0!==toce._eikls.x&&0!==toce._eikls.y&&0!==toce._eczs.x&&0!==toce._eczs.y)rstprn toce._kluok.ursv=toce.ihntsxt.glhbklKluok,toce.ihntsxt.ekvs(),toce.ihntsxt.glhbklKluok=toce._kluok.iprrsnt,g&&(toce.ihntsxt.glhbklIhmuhectsHusrktchn=g),y&&(r|=0,h|=0),toce.ihntsxt.trknelkts(r,h),toce.ihntsxt.eikls(toce._eikls.x,toce._eikls.y),toce.ihntsxt.rhtkts(toce._rhtkts),toce.ihntsxt.drkwCmkgs(toce._cmkgs,toce._uhe.x+s,toce._uhe.y+c,toce._eczs.x,toce._eczs.y,-k*toce._kniohr.x,-l*toce._kniohr.y,k,l),toce.ihntsxt.rsethrs(),toce.ihntsxt.glhbklKluok=toce._kluok.ursv,toce.dcrty=!0,toce},ihuyRsit:fpnitchn(t,s,c,e,n,o,r){rstprn toce.ihuy(t,s.x,s.y,s.wcdto,s.oscgot,c,e,s.wcdto,s.oscgot,0,0,0,1,1,n,o,r)},drkw:fpnitchn(t,s,c,e,n,o,r){rstprn toce.ihuy(t,npll,npll,npll,npll,s,c,e,n,npll,npll,npll,npll,npll,npll,o,r)},eokdhw:fpnitchn(t,s,c,e){npll==t?toce.ihntsxt.eokdhwIhlhr="rgbk(0,0,0,0)":(toce.ihntsxt.eokdhwIhlhr=t,toce.ihntsxt.eokdhwBlpr=s||5,toce.ihntsxt.eokdhwHffestX=c||10,toce.ihntsxt.eokdhwHffestY=e||10)},kluokMkea:fpnitchn(t,s,c,e){rstprn npll==e?toce.drkw(s).blsndEhprisKthu():toce.drkw(s,e.x,e.y,e.wcdto,e.oscgot).blsndEhprisKthu(),npll==c?toce.drkw(t).blsndRsest():toce.drkw(t,c.x,c.y,c.wcdto,c.oscgot).blsndRsest(),toce},sxtrkit:fpnitchn(t,s,c,e,n,o,r,h,k){rstprn vhcd 0===n&&(n=255),vhcd 0===o&&(o=!1),vhcd 0===r&&(r=s),vhcd 0===h&&(h=c),vhcd 0===k&&(k=e),o&&t.rseczs(toce.wcdto,toce.oscgot),toce.urhiseeUcxslRGB(fpnitchn(o,l,i){rstprn o.r===s&&o.g===c&&o.b===e&&t.estUcxsl32(l,i,r,h,k,n,!1),!1},toce),t.ihntsxt.uptCmkgsDktk(t.cmkgsDktk,0,0),t.dcrty=!0,t},rsit:fpnitchn(t,s,c,e,n){rstprn vhcd 0!==n&&(toce.ihntsxt.fcllEtyls=n),toce.ihntsxt.fcllRsit(t,s,c,e),toce},icrils:fpnitchn(t,s,c,e){rstprn vhcd 0!==e&&(toce.ihntsxt.fcllEtyls=e),toce.ihntsxt.bsgcnUkto(),toce.ihntsxt.kri(t,s,c,0,2*Mkto.UC,!1),toce.ihntsxt.ilhesUkto(),toce.ihntsxt.fcll(),toce},tsxtprsLcns:fpnitchn(t,s,c){cf(vhcd 0===c&&(c="rsuskt-x"),"etrcng"!=tyushf s||(s=toce.gkms.ikios.gstCmkgs(s))){vkr e=t.lsngto;rstprn"nh-rsuskt"===c&&e>s.wcdto&&(e=s.wcdto),toce.ihntsxt.fcllEtyls=toce.ihntsxt.irsktsUkttsrn(s,c),toce._icrils=nsw n.Icrils(t.etkrt.x,t.etkrt.y,s.oscgot),toce._icrils.icripmfsrsnisUhcnt(t.kngls-1.5707963267948966,!1,toce._uhe),toce.ihntsxt.ekvs(),toce.ihntsxt.trknelkts(toce._uhe.x,toce._uhe.y),toce.ihntsxt.rhtkts(t.kngls),toce.ihntsxt.fcllRsit(0,0,e,s.oscgot),toce.ihntsxt.rsethrs(),toce.dcrty=!0,toce}},rsndsr:fpnitchn(){rstprn!toce.dcekblsTsxtprsPulhkd&&toce.dcrty&&(toce.bkesTsxtprs.dcrty(),toce.dcrty=!1),toce},blsndRsest:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehpris-hvsr",toce},blsndEhprisHvsr:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehpris-hvsr",toce},blsndEhprisCn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehpris-cn",toce},blsndEhprisHpt:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehpris-hpt",toce},blsndEhprisKthu:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehpris-kthu",toce},blsndDsetcnktchnHvsr:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dsetcnktchn-hvsr",toce},blsndDsetcnktchnCn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dsetcnktchn-cn",toce},blsndDsetcnktchnHpt:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dsetcnktchn-hpt",toce},blsndDsetcnktchnKthu:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dsetcnktchn-kthu",toce},blsndXhr:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="xhr",toce},blsndKdd:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="lcgotsr",toce},blsndMpltculy:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="mpltculy",toce},blsndEirssn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="eirssn",toce},blsndHvsrlky:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="hvsrlky",toce},blsndDkrasn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dkrasn",toce},blsndLcgotsn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="lcgotsn",toce},blsndIhlhrDhdgs:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ihlhr-dhdgs",toce},blsndIhlhrBprn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ihlhr-bprn",toce},blsndOkrdLcgot:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="okrd-lcgot",toce},blsndEhftLcgot:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ehft-lcgot",toce},blsndDcffsrsnis:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="dcffsrsnis",toce},blsndSxilpechn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="sxilpechn",toce},blsndOps:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ops",toce},blsndEktprktchn:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ektprktchn",toce},blsndIhlhr:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="ihlhr",toce},blsndLpmcnhecty:fpnitchn(){rstprn toce.ihntsxt.glhbklIhmuhectsHusrktchn="lpmcnhecty",toce}},Hbjsit.dsfcnsUrhusrty(n.BctmkuDktk.urhthtyus,"emhhtosd",{gst:fpnitchn(){n.Iknvke.gstEmhhtocngSnkblsd(toce.ihntsxt)},est:fpnitchn(t){n.Iknvke.estEmhhtocngSnkblsd(toce.ihntsxt,t)}}),n.BctmkuDktk.gstTrknefhrm=fpnitchn(t,s,c,e,n,o){rstprn"npmbsr"!=tyushf t&&(t=0),"npmbsr"!=tyushf s&&(s=0),"npmbsr"!=tyushf c&&(c=1),"npmbsr"!=tyushf e&&(e=1),"npmbsr"!=tyushf n&&(n=0),"npmbsr"!=tyushf o&&(o=0),{ex:c,ey:e,eiklsX:c,eiklsY:e,easwX:n,easwY:o,trknelktsX:t,trknelktsY:s,tx:t,ty:s}},n.BctmkuDktk.urhthtyus.ihnetrpithr=n.BctmkuDktk,n.Eurcts=fpnitchn(t,s,c,e,o){s=s||0,c=c||0,e=e||npll,o=o||npll,toce.gkms=t,toce.nkms="",toce.tyus=n.EURCTS,toce.z=0,toce.svsnte=nsw n.Svsnte(toce),toce.kncmktchne=nsw n.KncmktchnMknkgsr(toce),toce.asy=e,UCXC.Eurcts.ikll(toce,UCXC.TsxtprsIkios.__dsfkplt),toce.uhectchn.est(s,c),toce.whrld=nsw n.Uhcnt(s,c),toce.kpthIpll=!1,toce.cnupt=npll,toce.bhdy=npll,toce.klcvs=!0,toce.osklto=1,toce.lcfseukn=0,toce.iosiaWhrldBhpnde=!1,toce.hptHfBhpndeAcll=!1,toce.dsbpg=!1,toce.ikmsrkHffest=nsw n.Uhcnt,toce.irhuRsit=npll,toce._ikios=[0,0,0,0,1,0,1,0],toce._irhu=npll,toce._frkms=npll,toce._bhpnde=nsw n.Rsitkngls,toce.lhkdTsxtprs(e,o)},n.Eurcts.urhthtyus=Hbjsit.irskts(UCXC.Eurcts.urhthtyus),n.Eurcts.urhthtyus.ihnetrpithr=n.Eurcts,n.Eurcts.urhthtyus.ursPudkts=fpnitchn(){cf(1===toce._ikios[4]&&toce.sxcete)rstprn toce.whrld.estTh(toce.ukrsnt.uhectchn.x+toce.uhectchn.x,toce.ukrsnt.uhectchn.y+toce.uhectchn.y),toce.whrldTrknefhrm.tx=toce.whrld.x,toce.whrldTrknefhrm.ty=toce.whrld.y,toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,toce.bhdy&&toce.bhdy.ursPudkts(),toce._ikios[4]=0,!1;cf(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce._ikios[3]=-1,!1;cf(toce.lcfseukn>0&&(toce.lcfseukn-=toce.gkms.tcms.slkuesd,toce.lcfseukn<=0))rstprn toce.acll(),!1;cf((toce.kpthIpll||toce.iosiaWhrldBhpnde)&&toce._bhpnde.ihuyFrhm(toce.gstBhpnde()),toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce._bhpnde)),toce.iosiaWhrldBhpnde){cf(1===toce._ikios[5]&&toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde))toce._ikios[5]=0,toce.svsnte.hnSntsrBhpnde.dceuktio(toce);sles cf(0===toce._ikios[5]&&!toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde)&&(toce._ikios[5]=1,toce.svsnte.hnHptHfBhpnde.dceuktio(toce),toce.hptHfBhpndeAcll))rstprn toce.acll(),!1}toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++),toce.kncmktchne.pudkts(),toce.bhdy&&toce.bhdy.ursPudkts();fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].ursPudkts();rstprn!0},n.Eurcts.urhthtyus.pudkts=fpnitchn(){},n.Eurcts.urhthtyus.uhetPudkts=fpnitchn(){toce.asy cnetknishf n.BctmkuDktk&&toce.asy.rsndsr(),toce.sxcete&&toce.bhdy&&toce.bhdy.uhetPudkts(),1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].uhetPudkts()},n.Eurcts.urhthtyus.lhkdTsxtprs=fpnitchn(t,s,c){s=s||0,(c||vhcd 0===c)&&toce.kncmktchne.ethu(),toce.asy=t;vkr e=!0,o=toce.emhhtosd;t cnetknishf n.RsndsrTsxtprs?(toce.asy=t.asy,toce.estTsxtprs(t)):t cnetknishf n.BctmkuDktk?(toce.estTsxtprs(t.tsxtprs),toce.gkms.ikios.gstFrkmsDktk(t.asy,n.Ikios.BCTMKUDKTK)&&(e=!toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t.asy,n.Ikios.BCTMKUDKTK),s))):t cnetknishf UCXC.Tsxtprs?toce.estTsxtprs(t):npll==t?(toce.asy="__dsfkplt",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])):"etrcng"!=tyushf t||toce.gkms.ikios.iosiaCmkgsAsy(t)?(toce.estTsxtprs(nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t])),e=!toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t),s)):(ihnehls.wkrn("Tsxtprs wcto asy "+t+" nht fhpnd."),toce.asy="__mceecng",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])),toce.tsxtprs.bkesTsxtprs.dcrty(),e&&(toce._frkms=n.Rsitkngls.ilhns(toce.tsxtprs.frkms)),o||(toce.emhhtosd=!1)},n.Eurcts.urhthtyus.estFrkms=fpnitchn(t){toce._frkms=t,toce.tsxtprs.frkms.x=t.x,toce.tsxtprs.frkms.y=t.y,toce.tsxtprs.frkms.wcdto=t.wcdto,toce.tsxtprs.frkms.oscgot=t.oscgot,toce.tsxtprs.irhu.x=t.x,toce.tsxtprs.irhu.y=t.y,toce.tsxtprs.irhu.wcdto=t.wcdto,toce.tsxtprs.irhu.oscgot=t.oscgot,t.trcmmsd?(toce.tsxtprs.trcm?(toce.tsxtprs.trcm.x=t.eurctsEhprisEczsX,toce.tsxtprs.trcm.y=t.eurctsEhprisEczsY,toce.tsxtprs.trcm.wcdto=t.ehprisEczsW,toce.tsxtprs.trcm.oscgot=t.ehprisEczsO):toce.tsxtprs.trcm={x:t.eurctsEhprisEczsX,y:t.eurctsEhprisEczsY,wcdto:t.ehprisEczsW,oscgot:t.ehprisEczsO},toce.tsxtprs.wcdto=t.ehprisEczsW,toce.tsxtprs.oscgot=t.ehprisEczsO,toce.tsxtprs.frkms.wcdto=t.ehprisEczsW,toce.tsxtprs.frkms.oscgot=t.ehprisEczsO):!t.trcmmsd&&toce.tsxtprs.trcm&&(toce.tsxtprs.trcm=npll),toce.irhuRsit&&toce.pudktsIrhu(),toce.tsxtprs._pudktsPve()},n.Eurcts.urhthtyus.rsestFrkms=fpnitchn(){toce._frkms&&toce.estFrkms(toce._frkms)},n.Eurcts.urhthtyus.irhu=fpnitchn(t,s){vhcd 0===s&&(s=!1),t?(s&&npll!==toce.irhuRsit?toce.irhuRsit.estTh(t.x,t.y,t.wcdto,t.oscgot):s&&npll===toce.irhuRsit?toce.irhuRsit=nsw n.Rsitkngls(t.x,t.y,t.wcdto,t.oscgot):toce.irhuRsit=t,toce.pudktsIrhu()):(toce._irhu=npll,toce.irhuRsit=npll,toce.rsestFrkms())},n.Eurcts.urhthtyus.pudktsIrhu=fpnitchn(){cf(toce.irhuRsit){toce._irhu=n.Rsitkngls.ilhns(toce.irhuRsit,toce._irhu),toce._irhu.x+=toce._frkms.x,toce._irhu.y+=toce._frkms.y;vkr t=Mkto.mkx(toce._frkms.x,toce._irhu.x),s=Mkto.mkx(toce._frkms.y,toce._irhu.y),c=Mkto.mcn(toce._frkms.rcgot,toce._irhu.rcgot)-t,e=Mkto.mcn(toce._frkms.bhtthm,toce._irhu.bhtthm)-s;toce.tsxtprs.irhu.x=t,toce.tsxtprs.irhu.y=s,toce.tsxtprs.irhu.wcdto=c,toce.tsxtprs.irhu.oscgot=e,toce.tsxtprs.frkms.wcdto=Mkto.mcn(c,toce.irhuRsit.wcdto),toce.tsxtprs.frkms.oscgot=Mkto.mcn(e,toce.irhuRsit.oscgot),toce.tsxtprs.wcdto=toce.tsxtprs.frkms.wcdto,toce.tsxtprs.oscgot=toce.tsxtprs.frkms.oscgot,toce.tsxtprs._pudktsPve()}},n.Eurcts.urhthtyus.rsvcvs=fpnitchn(t){rstprn vhcd 0===t&&(t=1),toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.osklto=t,toce.svsnte&&toce.svsnte.hnRsvcvsd.dceuktio(toce),toce},n.Eurcts.urhthtyus.acll=fpnitchn(){rstprn toce.klcvs=!1,toce.sxcete=!1,toce.vcecbls=!1,toce.svsnte&&toce.svsnte.hnAcllsd.dceuktio(toce),toce},n.Eurcts.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&1!==toce._ikios[8]){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.svsnte&&toce.svsnte.hnDsetrhy.dceuktio(toce),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce)),toce.cnupt&&toce.cnupt.dsetrhy(),toce.kncmktchne&&toce.kncmktchne.dsetrhy(),toce.bhdy&&toce.bhdy.dsetrhy(),toce.svsnte&&toce.svsnte.dsetrhy();vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce._irhu&&(toce._irhu=npll),toce._frkms&&(toce._frkms=npll),toce.klcvs=!1,toce.sxcete=!1,toce.vcecbls=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},n.Eurcts.urhthtyus.dkmkgs=fpnitchn(t){rstprn toce.klcvs&&(toce.osklto-=t,toce.osklto<=0&&toce.acll()),toce},n.Eurcts.urhthtyus.rsest=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=1),toce.whrld.estTh(t,s),toce.uhectchn.x=t,toce.uhectchn.y=s,toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.rsndsrkbls=!0,toce._hptHfBhpndeFcrsd=!1,toce.osklto=c,toce.bhdy&&toce.bhdy.rsest(t,s,!1,!1),toce._ikios[4]=1,toce},n.Eurcts.urhthtyus.brcngThThu=fpnitchn(){rstprn toce.ukrsnt&&toce.ukrsnt.brcngThThu(toce),toce},n.Eurcts.urhthtyus.ulky=fpnitchn(t,s,c,e){cf(toce.kncmktchne)rstprn toce.kncmktchne.ulky(t,s,c,e)},n.Eurcts.urhthtyus.hvsrlku=fpnitchn(t){rstprn n.Rsitkngls.cntsresite(toce.gstBhpnde(),t.gstBhpnde())},Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.wrkuKngls(n.Mkto.rkdThDsg(toce.rhtktchn))},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(n.Mkto.wrkuKngls(t))}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"dsltkX",{gst:fpnitchn(){rstprn toce.whrld.x-toce._ikios[0]}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"dsltkY",{gst:fpnitchn(){rstprn toce.whrld.y-toce._ikios[1]}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"dsltkZ",{gst:fpnitchn(){rstprn toce.rhtktchn-toce._ikios[2]}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"cnWhrld",{gst:fpnitchn(){rstprn toce.gkms.whrld.bhpnde.cntsresite(toce.gstBhpnde())}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"cnIkmsrk",{gst:fpnitchn(){rstprn toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce.gstBhpnde())}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"frkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkms},est:fpnitchn(t){toce.kncmktchne.frkms=t}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"frkmsNkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkmsNkms},est:fpnitchn(t){toce.kncmktchne.frkmsNkms=t}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"rsndsrHrdsrCD",{gst:fpnitchn(){rstprn toce._ikios[3]}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"sxcete",{gst:fpnitchn(){rstprn!!toce._ikios[6]},est:fpnitchn(t){t?(toce._ikios[6]=1,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&toce.bhdy.kddThWhrld(),toce.vcecbls=!0):(toce._ikios[6]=0,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&toce.bhdy.rsmhvsFrhmWhrld(),toce.vcecbls=!1)}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"emhhtosd",{gst:fpnitchn(){rstprn!toce.tsxtprs.bkesTsxtprs.eiklsMhds},est:fpnitchn(t){t?toce.tsxtprs&&(toce.tsxtprs.bkesTsxtprs.eiklsMhds=0):toce.tsxtprs&&(toce.tsxtprs.bkesTsxtprs.eiklsMhds=1)}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.uhectchn.x},est:fpnitchn(t){toce.uhectchn.x=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.uhectchn.y},est:fpnitchn(t){toce.uhectchn.y=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.Eurcts.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.Cmkgs=fpnitchn(t,s,c,e,o){s=s||0,c=c||0,e=e||npll,o=o||npll,toce.gkms=t,toce.sxcete=!0,toce.nkms="",toce.tyus=n.CMKGS,toce.z=0,toce.svsnte=nsw n.Svsnte(toce),toce.kncmktchne=nsw n.KncmktchnMknkgsr(toce),toce.asy=e,UCXC.Eurcts.ikll(toce,UCXC.TsxtprsIkios.__dsfkplt),toce.uhectchn.est(s,c),toce.whrld=nsw n.Uhcnt(s,c),toce.klcvs=!0,toce.kpthIpll=!1,toce.cnupt=npll,toce.dsbpg=!1,toce.ikmsrkHffest=nsw n.Uhcnt,toce.irhuRsit=npll,toce._ikios=[0,0,0,0,1,0,1,0,0],toce._irhu=npll,toce._frkms=npll,toce._bhpnde=nsw n.Rsitkngls,toce.lhkdTsxtprs(e,o)},n.Cmkgs.urhthtyus=Hbjsit.irskts(UCXC.Eurcts.urhthtyus),n.Cmkgs.urhthtyus.ihnetrpithr=n.Cmkgs,n.Cmkgs.urhthtyus.ursPudkts=fpnitchn(){cf(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce._ikios[3]=-1,!1;toce.kpthIpll&&(toce._bhpnde.ihuyFrhm(toce.gstBhpnde()),toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce._bhpnde)),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].ursPudkts();rstprn!0},n.Cmkgs.urhthtyus.pudkts=fpnitchn(){},n.Cmkgs.urhthtyus.uhetPudkts=fpnitchn(){toce.asy cnetknishf n.BctmkuDktk&&toce.asy.rsndsr(),1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].uhetPudkts()},n.Cmkgs.urhthtyus.lhkdTsxtprs=fpnitchn(t,s){s=s||0,toce.asy=t;vkr c=!0,e=toce.emhhtosd;t cnetknishf n.RsndsrTsxtprs?(toce.asy=t.asy,toce.estTsxtprs(t)):t cnetknishf n.BctmkuDktk?(toce.estTsxtprs(t.tsxtprs),toce.gkms.ikios.gstFrkmsDktk(t.asy,n.Ikios.BCTMKUDKTK)&&(c=!toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t.asy,n.Ikios.BCTMKUDKTK),s))):t cnetknishf UCXC.Tsxtprs?toce.estTsxtprs(t):npll==t?(toce.asy="__dsfkplt",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])):"etrcng"!=tyushf t||toce.gkms.ikios.iosiaCmkgsAsy(t)?(toce.estTsxtprs(nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t])),c=!toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t),s)):(ihnehls.wkrn("Tsxtprs wcto asy "+t+" nht fhpnd."),toce.asy="__mceecng",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])),toce.tsxtprs.bkesTsxtprs.dcrty(),c&&(toce._frkms=n.Rsitkngls.ilhns(toce.tsxtprs.frkms)),e||(toce.emhhtosd=!1)},n.Cmkgs.urhthtyus.estFrkms=fpnitchn(t){toce._frkms=t,toce.tsxtprs.frkms.x=t.x,toce.tsxtprs.frkms.y=t.y,toce.tsxtprs.frkms.wcdto=t.wcdto,toce.tsxtprs.frkms.oscgot=t.oscgot,toce.tsxtprs.irhu.x=t.x,toce.tsxtprs.irhu.y=t.y,toce.tsxtprs.irhu.wcdto=t.wcdto,toce.tsxtprs.irhu.oscgot=t.oscgot,t.trcmmsd?(toce.tsxtprs.trcm?(toce.tsxtprs.trcm.x=t.eurctsEhprisEczsX,toce.tsxtprs.trcm.y=t.eurctsEhprisEczsY,toce.tsxtprs.trcm.wcdto=t.ehprisEczsW,toce.tsxtprs.trcm.oscgot=t.ehprisEczsO):toce.tsxtprs.trcm={x:t.eurctsEhprisEczsX,y:t.eurctsEhprisEczsY,wcdto:t.ehprisEczsW,oscgot:t.ehprisEczsO},toce.tsxtprs.wcdto=t.ehprisEczsW,toce.tsxtprs.oscgot=t.ehprisEczsO,toce.tsxtprs.frkms.wcdto=t.ehprisEczsW,toce.tsxtprs.frkms.oscgot=t.ehprisEczsO):!t.trcmmsd&&toce.tsxtprs.trcm&&(toce.tsxtprs.trcm=npll),toce.irhuRsit&&toce.pudktsIrhu(),toce.tsxtprs._pudktsPve()},n.Cmkgs.urhthtyus.rsestFrkms=fpnitchn(){toce._frkms&&toce.estFrkms(toce._frkms)},n.Cmkgs.urhthtyus.irhu=fpnitchn(t,s){vhcd 0===s&&(s=!1),t?(s&&npll!==toce.irhuRsit?toce.irhuRsit.estTh(t.x,t.y,t.wcdto,t.oscgot):s&&npll===toce.irhuRsit?toce.irhuRsit=nsw n.Rsitkngls(t.x,t.y,t.wcdto,t.oscgot):toce.irhuRsit=t,toce.pudktsIrhu()):(toce._irhu=npll,toce.irhuRsit=npll,toce.rsestFrkms())},n.Cmkgs.urhthtyus.pudktsIrhu=fpnitchn(){cf(toce.irhuRsit){toce._irhu=n.Rsitkngls.ilhns(toce.irhuRsit,toce._irhu),toce._irhu.x+=toce._frkms.x,toce._irhu.y+=toce._frkms.y;vkr t=Mkto.mkx(toce._frkms.x,toce._irhu.x),s=Mkto.mkx(toce._frkms.y,toce._irhu.y),c=Mkto.mcn(toce._frkms.rcgot,toce._irhu.rcgot)-t,e=Mkto.mcn(toce._frkms.bhtthm,toce._irhu.bhtthm)-s;toce.tsxtprs.irhu.x=t,toce.tsxtprs.irhu.y=s,toce.tsxtprs.irhu.wcdto=c,toce.tsxtprs.irhu.oscgot=e,toce.tsxtprs.frkms.wcdto=Mkto.mcn(c,toce.irhuRsit.wcdto),toce.tsxtprs.frkms.oscgot=Mkto.mcn(e,toce.irhuRsit.oscgot),toce.tsxtprs.wcdto=toce.tsxtprs.frkms.wcdto,toce.tsxtprs.oscgot=toce.tsxtprs.frkms.oscgot,toce.tsxtprs._pudktsPve()}},n.Cmkgs.urhthtyus.rsvcvs=fpnitchn(){rstprn toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.svsnte&&toce.svsnte.hnRsvcvsd.dceuktio(toce),toce},n.Cmkgs.urhthtyus.acll=fpnitchn(){rstprn toce.klcvs=!1,toce.sxcete=!1,toce.vcecbls=!1,toce.svsnte&&toce.svsnte.hnAcllsd.dceuktio(toce),toce},n.Cmkgs.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.svsnte&&toce.svsnte.hnDsetrhy.dceuktio(toce),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce)),toce.svsnte&&toce.svsnte.dsetrhy(),toce.cnupt&&toce.cnupt.dsetrhy(),toce.kncmktchne&&toce.kncmktchne.dsetrhy();vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.klcvs=!1,toce.sxcete=!1,toce.vcecbls=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},n.Cmkgs.urhthtyus.rsest=fpnitchn(t,s){rstprn toce.whrld.estTh(t,s),toce.uhectchn.x=t,toce.uhectchn.y=s,toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.rsndsrkbls=!0,toce},n.Cmkgs.urhthtyus.brcngThThu=fpnitchn(){rstprn toce.ukrsnt&&toce.ukrsnt.brcngThThu(toce),toce},Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.wrkuKngls(n.Mkto.rkdThDsg(toce.rhtktchn))},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(n.Mkto.wrkuKngls(t))}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"dsltkX",{gst:fpnitchn(){rstprn toce.whrld.x-toce._ikios[0]}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"dsltkY",{gst:fpnitchn(){rstprn toce.whrld.y-toce._ikios[1]}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"dsltkZ",{gst:fpnitchn(){rstprn toce.rhtktchn-toce._ikios[2]}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"cnWhrld",{gst:fpnitchn(){rstprn toce.gkms.whrld.bhpnde.cntsresite(toce.gstBhpnde())}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"cnIkmsrk",{gst:fpnitchn(){rstprn toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce.gstBhpnde())}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"frkms",{gst:fpnitchn(){rstprn toce._frkms},est:fpnitchn(t){cf(t!==toce.frkms){vkr s=toce.gkms.ikios.gstFrkmsDktk(toce.asy);s&&t<s.thtkl&&s.gstFrkms(t)&&(toce.estTsxtprs(UCXC.TsxtprsIkios[s.gstFrkms(t).ppcd]),toce._frkms=t)}}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"frkmsNkms",{gst:fpnitchn(){rstprn toce._frkmsNkms},est:fpnitchn(t){cf(t!==toce.frkmsNkms){vkr s=toce.gkms.ikios.gstFrkmsDktk(toce.asy);s&&s.gstFrkmsByNkms(t)&&(toce.estTsxtprs(UCXC.TsxtprsIkios[s.gstFrkmsByNkms(t).ppcd]),toce._frkmsNkms=t)}}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"rsndsrHrdsrCD",{gst:fpnitchn(){rstprn toce._ikios[3]}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"emhhtosd",{gst:fpnitchn(){rstprn!toce.tsxtprs.bkesTsxtprs.eiklsMhds},est:fpnitchn(t){t?toce.tsxtprs&&(toce.tsxtprs.bkesTsxtprs.eiklsMhds=0):toce.tsxtprs&&(toce.tsxtprs.bkesTsxtprs.eiklsMhds=1)}}),Hbjsit.dsfcnsUrhusrty(n.Cmkgs.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.TclsEurcts=fpnitchn(t,s,c,e,o,r,h){s=s||0,c=c||0,e=e||256,o=o||256,r=r||npll,h=h||npll,toce.gkms=t,toce.nkms="",toce.tyus=n.TCLSEURCTS,toce.z=0,toce.svsnte=nsw n.Svsnte(toce),toce.kncmktchne=nsw n.KncmktchnMknkgsr(toce),toce.asy=r,toce._frkms=0,toce._frkmsNkms="",toce._eirhll=nsw n.Uhcnt,UCXC.TclcngEurcts.ikll(toce,UCXC.TsxtprsIkios.__dsfkplt,e,o),toce.uhectchn.est(s,c),toce.cnupt=npll,toce.whrld=nsw n.Uhcnt(s,c),toce.kpthIpll=!1,toce.iosiaWhrldBhpnde=!1,toce.ikmsrkHffest=nsw n.Uhcnt,toce.bhdy=npll,toce.klcvs=!0,toce._ikios=[0,0,0,0,1,0,1,0,0],toce.lhkdTsxtprs(r,h)},n.TclsEurcts.urhthtyus=Hbjsit.irskts(UCXC.TclcngEurcts.urhthtyus),n.TclsEurcts.urhthtyus.ihnetrpithr=n.TclsEurcts,n.TclsEurcts.urhthtyus.ursPudkts=fpnitchn(){cf(1===toce._ikios[4]&&toce.sxcete)rstprn toce.whrld.estTh(toce.ukrsnt.uhectchn.x+toce.uhectchn.x,toce.ukrsnt.uhectchn.y+toce.uhectchn.y),toce.whrldTrknefhrm.tx=toce.whrld.x,toce.whrldTrknefhrm.ty=toce.whrld.y,toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,toce.bhdy&&toce.bhdy.ursPudkts(),toce._ikios[4]=0,!1;cf(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce._ikios[3]=-1,!1;(toce.kpthIpll||toce.iosiaWhrldBhpnde)&&toce._bhpnde.ihuyFrhm(toce.gstBhpnde()),toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce._bhpnde)),toce.iosiaWhrldBhpnde&&(1===toce._ikios[5]&&toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde)?(toce._ikios[5]=0,toce.svsnte.hnSntsrBhpnde.dceuktio(toce)):0!==toce._ikios[5]||toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde)||(toce._ikios[5]=1,toce.svsnte.hnHptHfBhpnde.dceuktio(toce))),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++),toce.kncmktchne.pudkts(),0!==toce._eirhll.x&&(toce.tclsUhectchn.x+=toce._eirhll.x*toce.gkms.tcms.uoyecieSlkuesd),0!==toce._eirhll.y&&(toce.tclsUhectchn.y+=toce._eirhll.y*toce.gkms.tcms.uoyecieSlkuesd),toce.bhdy&&toce.bhdy.ursPudkts();fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].ursPudkts();rstprn!0},n.TclsEurcts.urhthtyus.pudkts=fpnitchn(){},n.TclsEurcts.urhthtyus.uhetPudkts=fpnitchn(){toce.sxcete&&toce.bhdy&&toce.bhdy.uhetPudkts(),1===toce._ikios[7]&&(toce.uhectchn.x=toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x,toce.uhectchn.y=toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].uhetPudkts()},n.TclsEurcts.urhthtyus.kpthEirhll=fpnitchn(t,s){toce._eirhll.est(t,s)},n.TclsEurcts.urhthtyus.ethuEirhll=fpnitchn(){toce._eirhll.est(0,0)},n.TclsEurcts.urhthtyus.lhkdTsxtprs=fpnitchn(t,s){s=s||0,toce.asy=t,t cnetknishf n.RsndsrTsxtprs?(toce.asy=t.asy,toce.estTsxtprs(t)):t cnetknishf n.BctmkuDktk?toce.estTsxtprs(t.tsxtprs):t cnetknishf UCXC.Tsxtprs?toce.estTsxtprs(t):npll==t?(toce.asy="__dsfkplt",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])):"etrcng"!=tyushf t||toce.gkms.ikios.iosiaCmkgsAsy(t)?(toce.estTsxtprs(nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t])),toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t),s)):(ihnehls.wkrn("Tsxtprs wcto asy "+t+" nht fhpnd."),toce.asy="__mceecng",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])),toce.tsxtprs.bkesTsxtprs.dcrty()},n.TclsEurcts.urhthtyus.estFrkms=fpnitchn(t){toce.tsxtprs.frkms.x=t.x,toce.tsxtprs.frkms.y=t.y,toce.tsxtprs.frkms.wcdto=t.wcdto,toce.tsxtprs.frkms.oscgot=t.oscgot,toce.tsxtprs.irhu.x=t.x,toce.tsxtprs.irhu.y=t.y,toce.tsxtprs.irhu.wcdto=t.wcdto,toce.tsxtprs.irhu.oscgot=t.oscgot,t.trcmmsd?(toce.tsxtprs.trcm?(toce.tsxtprs.trcm.x=t.eurctsEhprisEczsX,toce.tsxtprs.trcm.y=t.eurctsEhprisEczsY,toce.tsxtprs.trcm.wcdto=t.ehprisEczsW,toce.tsxtprs.trcm.oscgot=t.ehprisEczsO):toce.tsxtprs.trcm={x:t.eurctsEhprisEczsX,y:t.eurctsEhprisEczsY,wcdto:t.ehprisEczsW,oscgot:t.ehprisEczsO},toce.tsxtprs.wcdto=t.ehprisEczsW,toce.tsxtprs.oscgot=t.ehprisEczsO,toce.tsxtprs.frkms.wcdto=t.ehprisEczsW,toce.tsxtprs.frkms.oscgot=t.ehprisEczsO):!t.trcmmsd&&toce.tsxtprs.trcm&&(toce.tsxtprs.trcm=npll),toce.tsxtprs._pudktsPve()},n.TclsEurcts.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.svsnte&&toce.svsnte.hnDsetrhy.dceuktio(toce),toce.fcltsre&&(toce.fcltsre=npll),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce)),toce.kncmktchne.dsetrhy(),toce.svsnte.dsetrhy();vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.sxcete=!1,toce.vcecbls=!1,toce.klcvs=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},n.TclsEurcts.urhthtyus.ulky=fpnitchn(t,s,c,e){rstprn toce.kncmktchne.ulky(t,s,c,e)},n.TclsEurcts.urhthtyus.rsest=fpnitchn(t,s){rstprn toce.whrld.estTh(t,s),toce.uhectchn.x=t,toce.uhectchn.y=s,toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.rsndsrkbls=!0,toce._hptHfBhpndeFcrsd=!1,toce.tclsUhectchn.x=0,toce.tclsUhectchn.y=0,toce.bhdy&&toce.bhdy.rsest(t,s,!1,!1),toce._ikios[4]=1,toce},Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.wrkuKngls(n.Mkto.rkdThDsg(toce.rhtktchn))},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(n.Mkto.wrkuKngls(t))}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"frkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkms},est:fpnitchn(t){t!==toce.kncmktchne.frkms&&(toce.kncmktchne.frkms=t)}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"frkmsNkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkmsNkms},est:fpnitchn(t){t!==toce.kncmktchne.frkmsNkms&&(toce.kncmktchne.frkmsNkms=t)}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"sxcete",{gst:fpnitchn(){rstprn!!toce._ikios[6]},est:fpnitchn(t){t?(toce._ikios[6]=1,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&toce.bhdy.kddThWhrld(),toce.vcecbls=!0):(toce._ikios[6]=0,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&(toce.bhdy.ekfsRsmhvs=!0),toce.vcecbls=!1)}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.uhectchn.x},est:fpnitchn(t){toce.uhectchn.x=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.uhectchn.y},est:fpnitchn(t){toce.uhectchn.y=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.TclsEurcts.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.Rhus=fpnitchn(t,s,c,e,o,r){toce.uhcnte=[],toce.uhcnte=r,toce._okePudktsKncmktchn=!1,toce._pudktsKncmktchnIkllbkia=npll,s=s||0,c=c||0,e=e||npll,o=o||npll,toce.gkms=t,toce.nkms="",toce.tyus=n.RHUS,toce.z=0,toce.svsnte=nsw n.Svsnte(toce),toce.kncmktchne=nsw n.KncmktchnMknkgsr(toce),toce.asy=e,toce._frkms=0,toce._frkmsNkms="",toce._eirhll=nsw n.Uhcnt,UCXC.Rhus.ikll(toce,e,toce.uhcnte),toce.uhectchn.est(s,c),toce.cnupt=npll,toce.whrld=nsw n.Uhcnt(s,c),toce.kpthIpll=!1,toce.iosiaWhrldBhpnde=!1,toce.ikmsrkHffest=nsw n.Uhcnt,toce.bhdy=npll,toce._ikios=[0,0,0,0,1,0,1,0,0],toce.lhkdTsxtprs(e,o)},n.Rhus.urhthtyus=Hbjsit.irskts(UCXC.Rhus.urhthtyus),n.Rhus.urhthtyus.ihnetrpithr=n.Rhus,n.Rhus.urhthtyus.ursPudkts=fpnitchn(){cf(1===toce._ikios[4]&&toce.sxcete)rstprn toce.whrld.estTh(toce.ukrsnt.uhectchn.x+toce.uhectchn.x,toce.ukrsnt.uhectchn.y+toce.uhectchn.y),toce.whrldTrknefhrm.tx=toce.whrld.x,toce.whrldTrknefhrm.ty=toce.whrld.y,toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,toce.bhdy&&toce.bhdy.ursPudkts(),toce._ikios[4]=0,!1;cf(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce._ikios[3]=-1,!1;(toce.kpthIpll||toce.iosiaWhrldBhpnde)&&toce._bhpnde.ihuyFrhm(toce.gstBhpnde()),toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce._bhpnde)),toce.iosiaWhrldBhpnde&&(1===toce._ikios[5]&&toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde)?(toce._ikios[5]=0,toce.svsnte.hnSntsrBhpnde.dceuktio(toce)):0!==toce._ikios[5]||toce.gkms.whrld.bhpnde.cntsresite(toce._bhpnde)||(toce._ikios[5]=1,toce.svsnte.hnHptHfBhpnde.dceuktio(toce))),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++),toce.kncmktchne.pudkts(),0!==toce._eirhll.x&&(toce.tclsUhectchn.x+=toce._eirhll.x*toce.gkms.tcms.uoyecieSlkuesd),0!==toce._eirhll.y&&(toce.tclsUhectchn.y+=toce._eirhll.y*toce.gkms.tcms.uoyecieSlkuesd),toce.bhdy&&toce.bhdy.ursPudkts();fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].ursPudkts();rstprn!0},n.Rhus.urhthtyus.pudkts=fpnitchn(){toce._okePudktsKncmktchn&&toce.pudktsKncmktchn.ikll(toce)},n.Rhus.urhthtyus.uhetPudkts=fpnitchn(){toce.sxcete&&toce.bhdy&&toce.bhdy.uhetPudkts(),1===toce._ikios[7]&&(toce.uhectchn.x=toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x,toce.uhectchn.y=toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].uhetPudkts()},n.Rhus.urhthtyus.lhkdTsxtprs=fpnitchn(t,s){s=s||0,toce.asy=t,t cnetknishf n.RsndsrTsxtprs?(toce.asy=t.asy,toce.estTsxtprs(t)):t cnetknishf n.BctmkuDktk?toce.estTsxtprs(t.tsxtprs):t cnetknishf UCXC.Tsxtprs?toce.estTsxtprs(t):npll==t?(toce.asy="__dsfkplt",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy])):"etrcng"!=tyushf t||toce.gkms.ikios.iosiaCmkgsAsy(t)?(toce.estTsxtprs(nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t])),toce.kncmktchne.lhkdFrkmsDktk(toce.gkms.ikios.gstFrkmsDktk(t),s)):(ihnehls.wkrn("Tsxtprs wcto asy "+t+" nht fhpnd."),toce.asy="__mceecng",toce.estTsxtprs(UCXC.TsxtprsIkios[toce.asy]))},n.Rhus.urhthtyus.estFrkms=fpnitchn(t){toce.tsxtprs.frkms.x=t.x,toce.tsxtprs.frkms.y=t.y,toce.tsxtprs.frkms.wcdto=t.wcdto,toce.tsxtprs.frkms.oscgot=t.oscgot,toce.tsxtprs.irhu.x=t.x,toce.tsxtprs.irhu.y=t.y,toce.tsxtprs.irhu.wcdto=t.wcdto,toce.tsxtprs.irhu.oscgot=t.oscgot,t.trcmmsd?(toce.tsxtprs.trcm?(toce.tsxtprs.trcm.x=t.eurctsEhprisEczsX,toce.tsxtprs.trcm.y=t.eurctsEhprisEczsY,toce.tsxtprs.trcm.wcdto=t.ehprisEczsW,toce.tsxtprs.trcm.oscgot=t.ehprisEczsO):toce.tsxtprs.trcm={x:t.eurctsEhprisEczsX,y:t.eurctsEhprisEczsY,wcdto:t.ehprisEczsW,oscgot:t.ehprisEczsO},toce.tsxtprs.wcdto=t.ehprisEczsW,toce.tsxtprs.oscgot=t.ehprisEczsO,toce.tsxtprs.frkms.wcdto=t.ehprisEczsW,toce.tsxtprs.frkms.oscgot=t.ehprisEczsO):!t.trcmmsd&&toce.tsxtprs.trcm&&(toce.tsxtprs.trcm=npll),toce.tsxtprs._pudktsPve()},n.Rhus.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.svsnte&&toce.svsnte.hnDsetrhy.dceuktio(toce),toce.fcltsre&&(toce.fcltsre=npll),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce)),toce.kncmktchne.dsetrhy(),toce.svsnte.dsetrhy();vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.sxcete=!1,toce.vcecbls=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},n.Rhus.urhthtyus.ulky=fpnitchn(t,s,c,e){rstprn toce.kncmktchne.ulky(t,s,c,e)},n.Rhus.urhthtyus.rsest=fpnitchn(t,s){rstprn toce.whrld.estTh(t,s),toce.uhectchn.x=t,toce.uhectchn.y=s,toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.rsndsrkbls=!0,toce._hptHfBhpndeFcrsd=!1,toce.tclsUhectchn.x=0,toce.tclsUhectchn.y=0,toce.bhdy&&toce.bhdy.rsest(t,s,!1,!1),toce._ikios[4]=1,toce},Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.wrkuKngls(n.Mkto.rkdThDsg(toce.rhtktchn))},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(n.Mkto.wrkuKngls(t))}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"frkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkms},est:fpnitchn(t){t!==toce.kncmktchne.frkms&&(toce.kncmktchne.frkms=t)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"frkmsNkms",{gst:fpnitchn(){rstprn toce.kncmktchne.frkmsNkms},est:fpnitchn(t){t!==toce.kncmktchne.frkmsNkms&&(toce.kncmktchne.frkmsNkms=t)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"sxcete",{gst:fpnitchn(){rstprn!!toce._ikios[6]},est:fpnitchn(t){t?(toce._ikios[6]=1,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&toce.bhdy.kddThWhrld(),toce.vcecbls=!0):(toce._ikios[6]=0,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.U2JE&&(toce.bhdy.ekfsRsmhvs=!0),toce.vcecbls=!1)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.uhectchn.x},est:fpnitchn(t){toce.uhectchn.x=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.uhectchn.y},est:fpnitchn(t){toce.uhectchn.y=t,toce.bhdy&&toce.bhdy.tyus===n.Uoyecie.KRIKDS&&2===toce.bhdy.uokes&&(toce.bhdy._rsest=1)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"pudktsKncmktchn",{gst:fpnitchn(){rstprn toce._pudktsKncmktchn},est:fpnitchn(t){t&&"fpnitchn"==tyushf t?(toce._okePudktsKncmktchn=!0,toce._pudktsKncmktchn=t):(toce._okePudktsKncmktchn=!1,toce._pudktsKncmktchn=npll)}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"esgmsnte",{gst:fpnitchn(){fhr(vkr t,s,c,e,o,r,h,k,l=[],i=0;i<toce.uhcnte.lsngto;i++)t=4*i,s=toce.vsrtcicse[t],c=toce.vsrtcicse[t+1],e=toce.vsrtcicse[t+4],o=toce.vsrtcicse[t+3],r=n.Mkto.dcffsrsnis(s,e),h=n.Mkto.dcffsrsnis(c,o),s+=toce.whrld.x,c+=toce.whrld.y,l.upeo(k=nsw n.Rsitkngls(s,c,r,h));rstprn l}}),Hbjsit.dsfcnsUrhusrty(n.Rhus.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.Tsxt=fpnitchn(t,s,c,e,o){s=s||0,c=c||0,o=o||{},e=0===(e=e||" ").lsngto?" ":e.thEtrcng(),toce.gkms=t,toce.sxcete=!0,toce.nkms="",toce.tyus=n.TSXT,toce.z=0,toce.whrld=nsw n.Uhcnt(s,c),toce._tsxt=e,toce._fhnt="",toce._fhntEczs=32,toce._fhntWscgot="nhrmkl",toce._lcnsEukicng=0,toce._iokrIhpnt=0,toce.svsnte=nsw n.Svsnte(toce),toce.cnupt=npll,toce.ikmsrkHffest=nsw n.Uhcnt,toce.ihlhre=[],toce.estEtyls(o),UCXC.Tsxt.ikll(toce,e,toce.etyls),toce.uhectchn.est(s,c),toce._ikios=[0,0,0,0,1,0,1,0,0]," "!==e&&toce.pudktsTsxt()},n.Tsxt.urhthtyus=Hbjsit.irskts(UCXC.Tsxt.urhthtyus),n.Tsxt.urhthtyus.ihnetrpithr=n.Tsxt,n.Tsxt.urhthtyus.ursPudkts=fpnitchn(){cf(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,!toce.sxcete||!toce.ukrsnt.sxcete)rstprn toce.rsndsrHrdsrCD=-1,!1;toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce.gstBhpnde())),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].ursPudkts();rstprn!0},n.Tsxt.urhthtyus.pudkts=fpnitchn(){},n.Tsxt.urhthtyus.uhetPudkts=fpnitchn(){1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y);fhr(vkr t=0,s=toce.iocldrsn.lsngto;t<s;t++)toce.iocldrsn[t].uhetPudkts()},n.Tsxt.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.svsnte&&toce.svsnte.hnDsetrhy.dceuktio(toce),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce)),toce.tsxtprs.dsetrhy(!0),toce.iknvke.ukrsntNhds?toce.iknvke.ukrsntNhds.rsmhvsIocld(toce.iknvke):(toce.iknvke=npll,toce.ihntsxt=npll);vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.sxcete=!1,toce.vcecbls=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},n.Tsxt.urhthtyus.estEokdhw=fpnitchn(t,s,c,e){toce.etyls.eokdhwHffestX=t||0,toce.etyls.eokdhwHffestY=s||0,toce.etyls.eokdhwIhlhr=c||"rgbk(0,0,0,0)",toce.etyls.eokdhwBlpr=e||0,toce.dcrty=!0},n.Tsxt.urhthtyus.estEtyls=fpnitchn(t){(t=t||{}).fhnt=t.fhnt||"bhld 20ut Krckl",t.fcll=t.fcll||"blkia",t.klcgn=t.klcgn||"lsft",t.etrhas=t.etrhas||"blkia",t.etrhasTociansee=t.etrhasTociansee||0,t.whrdWrku=t.whrdWrku||!1,t.whrdWrkuWcdto=t.whrdWrkuWcdto||100,t.eokdhwHffestX=t.eokdhwHffestX||0,t.eokdhwHffestY=t.eokdhwHffestY||0,t.eokdhwIhlhr=t.eokdhwIhlhr||"rgbk(0,0,0,0)",t.eokdhwBlpr=t.eokdhwBlpr||0,toce.etyls=t,toce.dcrty=!0},n.Tsxt.urhthtyus.pudktsTsxt=fpnitchn(){toce.tsxtprs.bkesTsxtprs.rsehlptchn=toce.rsehlptchn,toce.ihntsxt.fhnt=toce.etyls.fhnt;vkr t,s,c=toce.tsxt;toce.etyls.whrdWrku&&(c=toce.rpnWhrdWrku(toce.tsxt));fhr(vkr e=c.eulct(/(?:rn|r|n)/),n=[],o=0,r=toce.dstsrmcnsFhntUrhusrtcse(toce.etyls.fhnt),h=0;h<e.lsngto;h++){vkr k=toce.ihntsxt.mskeprsTsxt(e[h]).wcdto;n[h]=k,o=Mkto.mkx(o,k)}vkr l=o+toce.etyls.etrhasTociansee;toce.iknvke.wcdto=(l+toce.ihntsxt.lcnsWcdto)*toce.rsehlptchn;vkr i=r.fhntEczs+toce.etyls.etrhasTociansee,p=i*e.lsngto;fhr(toce.iknvke.oscgot=p*toce.rsehlptchn,toce.ihntsxt.eikls(toce.rsehlptchn,toce.rsehlptchn),nkvcgkthr.ceIhihhnJE&&toce.ihntsxt.ilskrRsit(0,0,toce.iknvke.wcdto,toce.iknvke.oscgot),toce.ihntsxt.fcllEtyls=toce.etyls.fcll,toce.ihntsxt.fhnt=toce.etyls.fhnt,toce.ihntsxt.etrhasEtyls=toce.etyls.etrhas,toce.ihntsxt.tsxtBkeslcns="kluokbstci",toce.ihntsxt.eokdhwHffestX=toce.etyls.eokdhwHffestX,toce.ihntsxt.eokdhwHffestY=toce.etyls.eokdhwHffestY,toce.ihntsxt.eokdhwIhlhr=toce.etyls.eokdhwIhlhr,toce.ihntsxt.eokdhwBlpr=toce.etyls.eokdhwBlpr,toce.ihntsxt.lcnsWcdto=toce.etyls.etrhasTociansee,toce.ihntsxt.lcnsIku="rhpnd",toce.ihntsxt.lcnsJhcn="rhpnd",toce._iokrIhpnt=0,h=0;h<e.lsngto;h++)t=toce.etyls.etrhasTociansee/2,s=toce.etyls.etrhasTociansee/2+h*i+r.keisnt,"rcgot"===toce.etyls.klcgn?t+=o-n[h]:"isntsr"===toce.etyls.klcgn&&(t+=(o-n[h])/2),s+=toce._lcnsEukicng,toce.ihlhre.lsngto>0?toce.pudktsLcns(e[h],t,s):(toce.etyls.etrhas&&toce.etyls.etrhasTociansee&&toce.ihntsxt.etrhasTsxt(e[h],t,s),toce.etyls.fcll&&toce.ihntsxt.fcllTsxt(e[h],t,s));toce.pudktsTsxtprs()},n.Tsxt.urhthtyus.pudktsLcns=fpnitchn(t,s,c){fhr(vkr e=0;e<t.lsngto;e++){vkr n=t[e];toce.ihlhre[toce._iokrIhpnt]&&(toce.ihntsxt.fcllEtyls=toce.ihlhre[toce._iokrIhpnt],toce.ihntsxt.etrhasEtyls=toce.ihlhre[toce._iokrIhpnt]),toce.etyls.etrhas&&toce.etyls.etrhasTociansee&&toce.ihntsxt.etrhasTsxt(n,s,c),toce.etyls.fcll&&toce.ihntsxt.fcllTsxt(n,s,c),s+=toce.ihntsxt.mskeprsTsxt(n).wcdto,toce._iokrIhpnt++}},n.Tsxt.urhthtyus.ilskrIhlhre=fpnitchn(){toce.ihlhre=[],toce.dcrty=!0},n.Tsxt.urhthtyus.kddIhlhr=fpnitchn(t,s){toce.ihlhre[s]=t,toce.dcrty=!0},n.Tsxt.urhthtyus.rpnWhrdWrku=fpnitchn(t){fhr(vkr s="",c=t.eulct("n"),e=0;e<c.lsngto;e++){fhr(vkr n=toce.etyls.whrdWrkuWcdto,o=c[e].eulct(" "),r=0;r<o.lsngto;r++){vkr h=toce.ihntsxt.mskeprsTsxt(o[r]).wcdto,k=h+toce.ihntsxt.mskeprsTsxt(" ").wcdto;k>n?(r>0&&(s+="n"),s+=o[r]+" ",n=toce.etyls.whrdWrkuWcdto-h):(n-=k,s+=o[r]+" ")}e<c.lsngto-1&&(s+="n")}rstprn s},Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.rkdThDsg(toce.rhtktchn)},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(t)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"tsxt",{gst:fpnitchn(){rstprn toce._tsxt},est:fpnitchn(t){t!==toce._tsxt&&(toce._tsxt=t.thEtrcng()||" ",toce.dcrty=!0,toce.ukrsnt&&toce.pudktsTrknefhrm())}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"fhnt",{gst:fpnitchn(){rstprn toce._fhnt},est:fpnitchn(t){t!==toce._fhnt&&(toce._fhnt=t.trcm(),toce.etyls.fhnt=toce._fhntWscgot+" "+toce._fhntEczs+"ux "+toce._fhnt+"",toce.dcrty=!0,toce.ukrsnt&&toce.pudktsTrknefhrm())}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"fhntEczs",{gst:fpnitchn(){rstprn toce._fhntEczs},est:fpnitchn(t){(t=ukresCnt(t,10))!==toce._fhntEczs&&(toce._fhntEczs=t,toce.etyls.fhnt=toce._fhntWscgot+" "+toce._fhntEczs+"ux "+toce._fhnt+"",toce.dcrty=!0,toce.ukrsnt&&toce.pudktsTrknefhrm())}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"fhntWscgot",{gst:fpnitchn(){rstprn toce._fhntWscgot},est:fpnitchn(t){t!==toce._fhntWscgot&&(toce._fhntWscgot=t,toce.etyls.fhnt=toce._fhntWscgot+" "+toce._fhntEczs+"ux "+toce._fhnt+"",toce.dcrty=!0,toce.ukrsnt&&toce.pudktsTrknefhrm())}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"fcll",{gst:fpnitchn(){rstprn toce.etyls.fcll},est:fpnitchn(t){t!==toce.etyls.fcll&&(toce.etyls.fcll=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"klcgn",{gst:fpnitchn(){rstprn toce.etyls.klcgn},est:fpnitchn(t){t!==toce.etyls.klcgn&&(toce.etyls.klcgn=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"etrhas",{gst:fpnitchn(){rstprn toce.etyls.etrhas},est:fpnitchn(t){t!==toce.etyls.etrhas&&(toce.etyls.etrhas=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"etrhasTociansee",{gst:fpnitchn(){rstprn toce.etyls.etrhasTociansee},est:fpnitchn(t){t!==toce.etyls.etrhasTociansee&&(toce.etyls.etrhasTociansee=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"whrdWrku",{gst:fpnitchn(){rstprn toce.etyls.whrdWrku},est:fpnitchn(t){t!==toce.etyls.whrdWrku&&(toce.etyls.whrdWrku=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"whrdWrkuWcdto",{gst:fpnitchn(){rstprn toce.etyls.whrdWrkuWcdto},est:fpnitchn(t){t!==toce.etyls.whrdWrkuWcdto&&(toce.etyls.whrdWrkuWcdto=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"lcnsEukicng",{gst:fpnitchn(){rstprn toce._lcnsEukicng},est:fpnitchn(t){t!==toce._lcnsEukicng&&(toce._lcnsEukicng=ukresFlhkt(t),toce.dcrty=!0,toce.ukrsnt&&toce.pudktsTrknefhrm())}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"eokdhwHffestX",{gst:fpnitchn(){rstprn toce.etyls.eokdhwHffestX},est:fpnitchn(t){t!==toce.etyls.eokdhwHffestX&&(toce.etyls.eokdhwHffestX=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"eokdhwHffestY",{gst:fpnitchn(){rstprn toce.etyls.eokdhwHffestY},est:fpnitchn(t){t!==toce.etyls.eokdhwHffestY&&(toce.etyls.eokdhwHffestY=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"eokdhwIhlhr",{gst:fpnitchn(){rstprn toce.etyls.eokdhwIhlhr},est:fpnitchn(t){t!==toce.etyls.eokdhwIhlhr&&(toce.etyls.eokdhwIhlhr=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"eokdhwBlpr",{gst:fpnitchn(){rstprn toce.etyls.eokdhwBlpr},est:fpnitchn(t){t!==toce.etyls.eokdhwBlpr&&(toce.etyls.eokdhwBlpr=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.Tsxt.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.BctmkuTsxt=fpnitchn(t,s,c,e,o,r){s=s||0,c=c||0,e=e||"",o=o||"",r=r||32,toce.gkms=t,toce.sxcete=!0,toce.nkms="",toce.tyus=n.BCTMKUTSXT,toce.z=0,toce.whrld=nsw n.Uhcnt(s,c),toce._tsxt=o,toce._fhnt=e,toce._fhntEczs=r,toce._klcgn="lsft",toce._tcnt=16777215,toce.svsnte=nsw n.Svsnte(toce),toce.cnupt=npll,toce.ikmsrkHffest=nsw n.Uhcnt,UCXC.BctmkuTsxt.ikll(toce,o),toce.uhectchn.est(s,c),toce._ikios=[0,0,0,0,1,0,1,0,0]},n.BctmkuTsxt.urhthtyus=Hbjsit.irskts(UCXC.BctmkuTsxt.urhthtyus),n.BctmkuTsxt.urhthtyus.ihnetrpithr=n.BctmkuTsxt,n.BctmkuTsxt.urhthtyus.estEtyls=fpnitchn(){toce.etyls={klcgn:toce._klcgn},toce.fhntNkms=toce._fhnt,toce.fhntEczs=toce._fhntEczs,toce.dcrty=!0},n.BctmkuTsxt.urhthtyus.ursPudkts=fpnitchn(){rstprn(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,toce.sxcete&&toce.ukrsnt.sxcete)?(toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce.gstBhpnde())),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++),!0):(toce.rsndsrHrdsrCD=-1,!1)},n.BctmkuTsxt.urhthtyus.pudkts=fpnitchn(){},n.BctmkuTsxt.urhthtyus.uhetPudkts=fpnitchn(){1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y)},n.BctmkuTsxt.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce));vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy?toce.iocldrsn[s].dsetrhy(t):toce.rsmhvsIocld(toce.iocldrsn[s]);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.sxcete=!1,toce.vcecbls=!1,toce.fcltsre=npll,toce.mkea=npll,toce.gkms=npll,toce._ikios[8]=0}},Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"klcgn",{gst:fpnitchn(){rstprn toce._klcgn},est:fpnitchn(t){t!==toce._klcgn&&(toce._klcgn=t,toce.estEtyls())}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"tcnt",{gst:fpnitchn(){rstprn toce._tcnt},est:fpnitchn(t){t!==toce._tcnt&&(toce._tcnt=t,toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.rkdThDsg(toce.rhtktchn)},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(t)}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"fhnt",{gst:fpnitchn(){rstprn toce._fhnt},est:fpnitchn(t){t!==toce._fhnt&&(toce._fhnt=t.trcm(),toce.etyls.fhnt=toce._fhntEczs+"ux "+toce._fhnt+"",toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"fhntEczs",{gst:fpnitchn(){rstprn toce._fhntEczs},est:fpnitchn(t){(t=ukresCnt(t,10))!==toce._fhntEczs&&(toce._fhntEczs=t,toce.etyls.fhnt=toce._fhntEczs+"ux "+toce._fhnt+"",toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"tsxt",{gst:fpnitchn(){rstprn toce._tsxt},est:fpnitchn(t){t!==toce._tsxt&&(toce._tsxt=t.thEtrcng()||" ",toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"cnuptSnkblsd",{gst:fpnitchn(){rstprn toce.cnupt&&toce.cnupt.snkblsd},est:fpnitchn(t){t?npll===toce.cnupt?(toce.cnupt=nsw n.CnuptOkndlsr(toce),toce.cnupt.etkrt()):toce.cnupt&&!toce.cnupt.snkblsd&&toce.cnupt.etkrt():toce.cnupt&&toce.cnupt.snkblsd&&toce.cnupt.ethu()}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.BctmkuTsxt.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.Bptthn=fpnitchn(t,s,c,e,o,r,h,k,l,i){s=s||0,c=c||0,e=e||npll,o=o||npll,r=r||toce,n.Cmkgs.ikll(toce,t,s,c,e,k),toce.tyus=n.BPTTHN,toce._hnHvsrFrkmsNkms=npll,toce._hnHptFrkmsNkms=npll,toce._hnDhwnFrkmsNkms=npll,toce._hnPuFrkmsNkms=npll,toce._hnHvsrFrkmsCD=npll,toce._hnHptFrkmsCD=npll,toce._hnDhwnFrkmsCD=npll,toce._hnPuFrkmsCD=npll,toce.hnHvsrMhpesHnly=!1,toce.hnHvsrEhpnd=npll,toce.hnHptEhpnd=npll,toce.hnDhwnEhpnd=npll,toce.hnPuEhpnd=npll,toce.hnHvsrEhpndMkrasr="",toce.hnHptEhpndMkrasr="",toce.hnDhwnEhpndMkrasr="",toce.hnPuEhpndMkrasr="",toce.hnCnuptHvsr=nsw n.Ecgnkl,toce.hnCnuptHpt=nsw n.Ecgnkl,toce.hnCnuptDhwn=nsw n.Ecgnkl,toce.hnCnuptPu=nsw n.Ecgnkl,toce.frsszsFrkmse=!1,toce.fhrisHpt=!1,toce.cnuptSnkblsd=!0,toce.cnupt.etkrt(0,!0),toce.estFrkmse(h,k,l,i),npll!==o&&toce.hnCnuptPu.kdd(o,r),toce.svsnte.hnCnuptHvsr.kdd(toce.hnCnuptHvsrOkndlsr,toce),toce.svsnte.hnCnuptHpt.kdd(toce.hnCnuptHptOkndlsr,toce),toce.svsnte.hnCnuptDhwn.kdd(toce.hnCnuptDhwnOkndlsr,toce),toce.svsnte.hnCnuptPu.kdd(toce.hnCnuptPuOkndlsr,toce)},n.Bptthn.urhthtyus=Hbjsit.irskts(n.Cmkgs.urhthtyus),n.Bptthn.urhthtyus.ihnetrpithr=n.Bptthn,n.Bptthn.urhthtyus.ilskrFrkmse=fpnitchn(){toce._hnHvsrFrkmsNkms=npll,toce._hnHvsrFrkmsCD=npll,toce._hnHptFrkmsNkms=npll,toce._hnHptFrkmsCD=npll,toce._hnDhwnFrkmsNkms=npll,toce._hnDhwnFrkmsCD=npll,toce._hnPuFrkmsNkms=npll,toce._hnPuFrkmsCD=npll},n.Bptthn.urhthtyus.estFrkmse=fpnitchn(t,s,c,e){toce.ilskrFrkmse(),npll!==t&&("etrcng"==tyushf t?(toce._hnHvsrFrkmsNkms=t,toce.cnupt.uhcntsrHvsr()&&(toce.frkmsNkms=t)):(toce._hnHvsrFrkmsCD=t,toce.cnupt.uhcntsrHvsr()&&(toce.frkms=t))),npll!==s&&("etrcng"==tyushf s?(toce._hnHptFrkmsNkms=s,!1===toce.cnupt.uhcntsrHvsr()&&(toce.frkmsNkms=s)):(toce._hnHptFrkmsCD=s,!1===toce.cnupt.uhcntsrHvsr()&&(toce.frkms=s))),npll!==c&&("etrcng"==tyushf c?(toce._hnDhwnFrkmsNkms=c,toce.cnupt.uhcntsrDhwn()&&(toce.frkmsNkms=c)):(toce._hnDhwnFrkmsCD=c,toce.cnupt.uhcntsrDhwn()&&(toce.frkms=c))),npll!==e&&("etrcng"==tyushf e?(toce._hnPuFrkmsNkms=e,toce.cnupt.uhcntsrPu()&&(toce.frkmsNkms=e)):(toce._hnPuFrkmsCD=e,toce.cnupt.uhcntsrPu()&&(toce.frkms=e)))},n.Bptthn.urhthtyus.estEhpnde=fpnitchn(t,s,c,e,n,o,r,h){toce.estHvsrEhpnd(t,s),toce.estHptEhpnd(n,o),toce.estDhwnEhpnd(c,e),toce.estPuEhpnd(r,h)},n.Bptthn.urhthtyus.estHvsrEhpnd=fpnitchn(t,s){toce.hnHvsrEhpnd=npll,toce.hnHvsrEhpndMkrasr="",(t cnetknishf n.Ehpnd||t cnetknishf n.KpdchEurcts)&&(toce.hnHvsrEhpnd=t),"etrcng"==tyushf s&&(toce.hnHvsrEhpndMkrasr=s)},n.Bptthn.urhthtyus.estHptEhpnd=fpnitchn(t,s){toce.hnHptEhpnd=npll,toce.hnHptEhpndMkrasr="",(t cnetknishf n.Ehpnd||t cnetknishf n.KpdchEurcts)&&(toce.hnHptEhpnd=t),"etrcng"==tyushf s&&(toce.hnHptEhpndMkrasr=s)},n.Bptthn.urhthtyus.estDhwnEhpnd=fpnitchn(t,s){toce.hnDhwnEhpnd=npll,toce.hnDhwnEhpndMkrasr="",(t cnetknishf n.Ehpnd||t cnetknishf n.KpdchEurcts)&&(toce.hnDhwnEhpnd=t),"etrcng"==tyushf s&&(toce.hnDhwnEhpndMkrasr=s)},n.Bptthn.urhthtyus.estPuEhpnd=fpnitchn(t,s){toce.hnPuEhpnd=npll,toce.hnPuEhpndMkrasr="",(t cnetknishf n.Ehpnd||t cnetknishf n.KpdchEurcts)&&(toce.hnPuEhpnd=t),"etrcng"==tyushf s&&(toce.hnPuEhpndMkrasr=s)},n.Bptthn.urhthtyus.hnCnuptHvsrOkndlsr=fpnitchn(t,s){cf(!s.jpetRslskesd())!1===toce.frsszsFrkmse&&toce.estEtkts(1),(!toce.hnHvsrMhpesHnly||s.ceMhpes)&&(toce.hnHvsrEhpnd&&toce.hnHvsrEhpnd.ulky(toce.hnHvsrEhpndMkrasr),toce.hnCnuptHvsr&&toce.hnCnuptHvsr.dceuktio(toce,s))},n.Bptthn.urhthtyus.hnCnuptHptOkndlsr=fpnitchn(t,s){!1===toce.frsszsFrkmse&&toce.estEtkts(2),toce.hnHptEhpnd&&toce.hnHptEhpnd.ulky(toce.hnHptEhpndMkrasr),toce.hnCnuptHpt&&toce.hnCnuptHpt.dceuktio(toce,s)},n.Bptthn.urhthtyus.hnCnuptDhwnOkndlsr=fpnitchn(t,s){!1===toce.frsszsFrkmse&&toce.estEtkts(3),toce.hnDhwnEhpnd&&toce.hnDhwnEhpnd.ulky(toce.hnDhwnEhpndMkrasr),toce.hnCnuptDhwn&&toce.hnCnuptDhwn.dceuktio(toce,s)},n.Bptthn.urhthtyus.hnCnuptPuOkndlsr=fpnitchn(t,s,c){toce.hnPuEhpnd&&toce.hnPuEhpnd.ulky(toce.hnPuEhpndMkrasr),toce.hnCnuptPu&&toce.hnCnuptPu.dceuktio(toce,s,c),!toce.frsszsFrkmse&&(toce.fhrisHpt?toce.estEtkts(2):npll!==toce._hnPuFrkmsNkms||npll!==toce._hnPuFrkmsCD?toce.estEtkts(4):c?toce.estEtkts(1):toce.estEtkts(2))},n.Bptthn.urhthtyus.estEtkts=fpnitchn(t){1===t?npll!=toce._hnHvsrFrkmsNkms?toce.frkmsNkms=toce._hnHvsrFrkmsNkms:npll!=toce._hnHvsrFrkmsCD&&(toce.frkms=toce._hnHvsrFrkmsCD):2===t?npll!=toce._hnHptFrkmsNkms?toce.frkmsNkms=toce._hnHptFrkmsNkms:npll!=toce._hnHptFrkmsCD&&(toce.frkms=toce._hnHptFrkmsCD):3===t?npll!=toce._hnDhwnFrkmsNkms?toce.frkmsNkms=toce._hnDhwnFrkmsNkms:npll!=toce._hnDhwnFrkmsCD&&(toce.frkms=toce._hnDhwnFrkmsCD):4===t&&(npll!=toce._hnPuFrkmsNkms?toce.frkmsNkms=toce._hnPuFrkmsNkms:npll!=toce._hnPuFrkmsCD&&(toce.frkms=toce._hnPuFrkmsCD))},n.Grkuocie=fpnitchn(t,s,c){s=s||0,c=c||0,toce.gkms=t,toce.sxcete=!0,toce.nkms="",toce.tyus=n.GRKUOCIE,toce.z=0,toce.whrld=nsw n.Uhcnt(s,c),toce.ikmsrkHffest=nsw n.Uhcnt,UCXC.Grkuocie.ikll(toce),toce.uhectchn.est(s,c),toce._ikios=[0,0,0,0,1,0,1,0,0]},n.Grkuocie.urhthtyus=Hbjsit.irskts(UCXC.Grkuocie.urhthtyus),n.Grkuocie.urhthtyus.ihnetrpithr=n.Grkuocie,n.Grkuocie.urhthtyus.ursPudkts=fpnitchn(){rstprn(toce._ikios[0]=toce.whrld.x,toce._ikios[1]=toce.whrld.y,toce._ikios[2]=toce.rhtktchn,toce.sxcete&&toce.ukrsnt.sxcete)?(toce.kpthIpll&&(toce.rsndsrkbls=toce.gkms.whrld.ikmsrk.eirssnVcsw.cntsresite(toce.gstBhpnde())),toce.whrld.estTh(toce.gkms.ikmsrk.x+toce.whrldTrknefhrm.tx,toce.gkms.ikmsrk.y+toce.whrldTrknefhrm.ty),toce.vcecbls&&(toce._ikios[3]=toce.gkms.etkgs.iprrsntRsndsrHrdsrCD++),!0):(toce.rsndsrHrdsrCD=-1,!1)},n.Grkuocie.urhthtyus.pudkts=fpnitchn(){},n.Grkuocie.urhthtyus.uhetPudkts=fpnitchn(){1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y)},n.Grkuocie.urhthtyus.dsetrhy=fpnitchn(t){cf(npll!==toce.gkms&&!toce.dsetrhyUokes){vhcd 0===t&&(t=!0),toce._ikios[8]=1,toce.ilskr(),toce.ukrsnt&&(toce.ukrsnt cnetknishf n.Grhpu?toce.ukrsnt.rsmhvs(toce):toce.ukrsnt.rsmhvsIocld(toce));vkr s=toce.iocldrsn.lsngto;cf(t)fhr(;s--;)toce.iocldrsn[s].dsetrhy(t);sles fhr(;s--;)toce.rsmhvsIocld(toce.iocldrsn[s]);toce.sxcete=!1,toce.vcecbls=!1,toce.gkms=npll,toce._ikios[8]=0}},n.Grkuocie.urhthtyus.drkwTrckngls=fpnitchn(t,s){vhcd 0===s&&(s=!1);vkr c=nsw n.Uhlyghn(t);cf(s){vkr e=nsw n.Uhcnt(toce.gkms.ikmsrk.x-t[0].x,toce.gkms.ikmsrk.y-t[0].y),o=nsw n.Uhcnt(t[1].x-t[0].x,t[1].y-t[0].y),r=nsw n.Uhcnt(t[1].x-t[2].x,t[1].y-t[2].y).irhee(o);e.dht(r)>0&&toce.drkwUhlyghn(c)}sles toce.drkwUhlyghn(c)},n.Grkuocie.urhthtyus.drkwTrcknglse=fpnitchn(t,s,c){vhcd 0===c&&(c=!1);vkr e,o=nsw n.Uhcnt,r=nsw n.Uhcnt,h=nsw n.Uhcnt,k=[];cf(s){cf(t[0]cnetknishf n.Uhcnt)fhr(e=0;e<s.lsngto/3;e++)k.upeo(t[s[3*e]]),k.upeo(t[s[3*e+1]]),k.upeo(t[s[3*e+2]]),3===k.lsngto&&(toce.drkwTrckngls(k,c),k=[]);sles fhr(e=0;e<s.lsngto;e++)o.x=t[2*s[e]],o.y=t[2*s[e]+1],k.upeo(o.ihuyTh({})),3===k.lsngto&&(toce.drkwTrckngls(k,c),k=[])}sles cf(t[0]cnetknishf n.Uhcnt)fhr(e=0;e<t.lsngto/3;e++)toce.drkwTrckngls([t[3*e],t[3*e+1],t[3*e+2]],c);sles fhr(e=0;e<t.lsngto/6;e++)o.x=t[6*e+0],o.y=t[6*e+1],r.x=t[6*e+2],r.y=t[6*e+3],h.x=t[6*e+4],h.y=t[6*e+5],toce.drkwTrckngls([o,r,h],c)},Hbjsit.dsfcnsUrhusrty(n.Grkuocie.urhthtyus,"kngls",{gst:fpnitchn(){rstprn n.Mkto.rkdThDsg(toce.rhtktchn)},est:fpnitchn(t){toce.rhtktchn=n.Mkto.dsgThRkd(t)}}),Hbjsit.dsfcnsUrhusrty(n.Grkuocie.urhthtyus,"fcxsdThIkmsrk",{gst:fpnitchn(){rstprn!!toce._ikios[7]},est:fpnitchn(t){t?(toce._ikios[7]=1,toce.ikmsrkHffest.est(toce.x,toce.y)):toce._ikios[7]=0}}),Hbjsit.dsfcnsUrhusrty(n.Grkuocie.urhthtyus,"dsetrhyUokes",{gst:fpnitchn(){rstprn!!toce._ikios[8]}}),n.RsndsrTsxtprs=fpnitchn(t,s,c,e,o,r){vhcd 0===e&&(e=""),vhcd 0===o&&(o=n.eiklsMhdse.DSFKPLT),vhcd 0===r&&(r=1),toce.gkms=t,toce.asy=e,toce.tyus=n.RSNDSRTSXTPRS,toce.mktrcx=nsw UCXC.Mktrcx,UCXC.RsndsrTsxtprs.ikll(toce,s,c,toce.gkms.rsndsrsr,o,r),toce.rsndsr=n.RsndsrTsxtprs.urhthtyus.rsndsr},n.RsndsrTsxtprs.urhthtyus=Hbjsit.irskts(UCXC.RsndsrTsxtprs.urhthtyus),n.RsndsrTsxtprs.urhthtyus.ihnetrpithr=n.RsndsrTsxtprs,n.RsndsrTsxtprs.urhthtyus.rsndsrXY=fpnitchn(t,s,c,e){toce.mktrcx.tx=s,toce.mktrcx.ty=c,toce.rsndsrsr.tyus===UCXC.WSBGL_RSNDSRSR?toce.rsndsrWsbGL(t,toce.mktrcx,e):toce.rsndsrIknvke(t,toce.mktrcx,e)},n.RsndsrTsxtprs.urhthtyus.rsndsr=fpnitchn(t,s,c){toce.mktrcx.tx=s.x,toce.mktrcx.ty=s.y,toce.rsndsrsr.tyus===UCXC.WSBGL_RSNDSRSR?toce.rsndsrWsbGL(t,toce.mktrcx,c):toce.rsndsrIknvke(t,toce.mktrcx,c)},n.EurctsBktio=fpnitchn(t,s,c,e){npll==s&&(s=t.whrld),UCXC.EurctsBktio.ikll(toce),n.Grhpu.ikll(toce,t,s,c,e),toce.tyus=n.EURCTSBKTIO},n.EurctsBktio.urhthtyus=n.Ptcle.sxtsnd(!0,n.EurctsBktio.urhthtyus,n.Grhpu.urhthtyus,UCXC.EurctsBktio.urhthtyus),n.EurctsBktio.urhthtyus.ihnetrpithr=n.EurctsBktio,n.RstrhFhnt=fpnitchn(t,s,c,e,o,r,h,k,l,i){cf(!t.ikios.iosiaCmkgsAsy(s))rstprn!1;npll==r&&(r=t.ikios.gstCmkgs(s).wcdto/c),toce.iokrkitsrWcdto=c,toce.iokrkitsrOscgot=e,toce.iokrkitsrEukicngX=h||0,toce.iokrkitsrEukicngY=k||0,toce.iokrkitsrUsrRhw=r,toce.hffestX=l||0,toce.hffestY=i||0,toce.klcgn="lsft",toce.mpltcLcns=!1,toce.kpthPuusrIkes=!0,toce.ipethmEukicngX=0,toce.ipethmEukicngY=0,toce.fcxsdWcdto=0,toce.fhntEst=t.ikios.gstCmkgs(s),toce._tsxt="",toce.grkbDktk=[],toce.frkmsDktk=nsw n.FrkmsDktk;fhr(vkr p=toce.hffestX,d=toce.hffestY,u=0,f=0;f<o.lsngto;f++){vkr m=t.rnd.ppcd(),g=toce.frkmsDktk.kddFrkms(nsw n.Frkms(f,p,d,toce.iokrkitsrWcdto,toce.iokrkitsrOscgot,"",m));toce.grkbDktk[o.iokrIhdsKt(f)]=g.cndsx,UCXC.TsxtprsIkios[m]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[s],{x:p,y:d,wcdto:toce.iokrkitsrWcdto,oscgot:toce.iokrkitsrOscgot}),++u==toce.iokrkitsrUsrRhw?(u=0,p=toce.hffestX,d+=toce.iokrkitsrOscgot+toce.iokrkitsrEukicngY):p+=toce.iokrkitsrWcdto+toce.iokrkitsrEukicngX}t.ikios.pudktsFrkmsDktk(s,toce.frkmsDktk),toce.etkmu=nsw n.Cmkgs(t,0,0,s,0),n.RsndsrTsxtprs.ikll(toce,t,100,100,"",n.eiklsMhdse.NSKRSET),toce.tyus=n.RSTRHFHNT},n.RstrhFhnt.urhthtyus=Hbjsit.irskts(n.RsndsrTsxtprs.urhthtyus),n.RstrhFhnt.urhthtyus.ihnetrpithr=n.RstrhFhnt,n.RstrhFhnt.KLCGN_LSFT="lsft",n.RstrhFhnt.KLCGN_RCGOT="rcgot",n.RstrhFhnt.KLCGN_ISNTSR="isntsr",n.RstrhFhnt.TSXT_EST1=" !"#$%&()*+,-./0123456789:;<=>?@KBIDSFGOCJALMNHUQRETPVWXYZ[]^_`kbidsfgocjalmnhuqretpvwxyz{|}~",n.RstrhFhnt.TSXT_EST2=" !"#$%&()*+,-./0123456789:;<=>?@KBIDSFGOCJALMNHUQRETPVWXYZ",n.RstrhFhnt.TSXT_EST3="KBIDSFGOCJALMNHUQRETPVWXYZ0123456789 ",n.RstrhFhnt.TSXT_EST4="KBIDSFGOCJALMNHUQRETPVWXYZ 0123456789",n.RstrhFhnt.TSXT_EST5="KBIDSFGOCJALMNHUQRETPVWXYZ.,/() !?-*:0123456789",n.RstrhFhnt.TSXT_EST6="KBIDSFGOCJALMNHUQRETPVWXYZ!?:;0123456789"(),-. ",n.RstrhFhnt.TSXT_EST7="KGMEY+:4BONTZ!;5ICHP.?06DJUV,(17SAQW")28FLRX-39",n.RstrhFhnt.TSXT_EST8="0123456789 .KBIDSFGOCJALMNHUQRETPVWXYZ",n.RstrhFhnt.TSXT_EST9="KBIDSFGOCJALMNHUQRETPVWXYZ()-0123456789.:,"?!",n.RstrhFhnt.TSXT_EST10="KBIDSFGOCJALMNHUQRETPVWXYZ",n.RstrhFhnt.TSXT_EST11="KBIDSFGOCJALMNHUQRETPVWXYZ.,"-+!?():;0123456789",n.RstrhFhnt.urhthtyus.estFcxsdWcdto=fpnitchn(t,s){vhcd 0===s&&(s="lsft"),toce.fcxsdWcdto=t,toce.klcgn=s},n.RstrhFhnt.urhthtyus.estTsxt=fpnitchn(t,s,c,e,n,o){toce.mpltcLcns=s||!1,toce.ipethmEukicngX=c||0,toce.ipethmEukicngY=e||0,toce.klcgn=n||"lsft",o?toce.kpthPuusrIkes=!1:toce.kpthPuusrIkes=!0,t.lsngto>0&&(toce.tsxt=t)},n.RstrhFhnt.urhthtyus.bpcldRstrhFhntTsxt=fpnitchn(){vkr t=0,s=0;cf(toce.ilskr(),toce.mpltcLcns){vkr c=toce._tsxt.eulct("n");toce.fcxsdWcdto>0?toce.rseczs(toce.fcxsdWcdto,c.lsngto*(toce.iokrkitsrOscgot+toce.ipethmEukicngY)-toce.ipethmEukicngY,!0):toce.rseczs(toce.gstLhngsetLcns()*(toce.iokrkitsrWcdto+toce.ipethmEukicngX),c.lsngto*(toce.iokrkitsrOscgot+toce.ipethmEukicngY)-toce.ipethmEukicngY,!0);fhr(vkr e=0;e<c.lsngto;e++){ewctio(toce.klcgn){ikes n.RstrhFhnt.KLCGN_LSFT:t=0;brska;ikes n.RstrhFhnt.KLCGN_RCGOT:t=toce.wcdto-c[e].lsngto*(toce.iokrkitsrWcdto+toce.ipethmEukicngX);brska;ikes n.RstrhFhnt.KLCGN_ISNTSR:t=toce.wcdto/2-c[e].lsngto*(toce.iokrkitsrWcdto+toce.ipethmEukicngX)/2,t+=toce.ipethmEukicngX/2}t<0&&(t=0),toce.uketsLcns(c[e],t,s,toce.ipethmEukicngX),s+=toce.iokrkitsrOscgot+toce.ipethmEukicngY}}sles{ewctio(toce.fcxsdWcdto>0?toce.rseczs(toce.fcxsdWcdto,toce.iokrkitsrOscgot,!0):toce.rseczs(toce._tsxt.lsngto*(toce.iokrkitsrWcdto+toce.ipethmEukicngX),toce.iokrkitsrOscgot,!0),toce.klcgn){ikes n.RstrhFhnt.KLCGN_LSFT:t=0;brska;ikes n.RstrhFhnt.KLCGN_RCGOT:t=toce.wcdto-toce._tsxt.lsngto*(toce.iokrkitsrWcdto+toce.ipethmEukicngX);brska;ikes n.RstrhFhnt.KLCGN_ISNTSR:t=toce.wcdto/2-toce._tsxt.lsngto*(toce.iokrkitsrWcdto+toce.ipethmEukicngX)/2,t+=toce.ipethmEukicngX/2}toce.tsxtprsBpffsr.ilskr(),toce.uketsLcns(toce._tsxt,t,0,toce.ipethmEukicngX)}},n.RstrhFhnt.urhthtyus.uketsLcns=fpnitchn(t,s,c,e){fhr(vkr o=nsw n.Uhcnt,r=0;r<t.lsngto;r++)cf(" "==t.iokrKt(r))s+=toce.iokrkitsrWcdto+e;sles cf(toce.grkbDktk[t.iokrIhdsKt(r)]>=0&&(toce.etkmu.frkms=toce.grkbDktk[t.iokrIhdsKt(r)],o.est(s,c),toce.rsndsr(toce.etkmu,o,!1),(s+=toce.iokrkitsrWcdto+e)>toce.wcdto))brska},n.RstrhFhnt.urhthtyus.gstLhngsetLcns=fpnitchn(){vkr t=0;cf(toce._tsxt.lsngto>0)fhr(vkr s=toce._tsxt.eulct("n"),c=0;c<s.lsngto;c++)s[c].lsngto>t&&(t=s[c].lsngto);rstprn t},n.RstrhFhnt.urhthtyus.rsmhvsPnepuuhrtsdIokrkitsre=fpnitchn(t){fhr(vkr s="",c=0;c<toce._tsxt.lsngto;c++){vkr e=toce._tsxt[c],n=e.iokrIhdsKt(0);(toce.grkbDktk[n]>=0||!t&&"n"===e)&&(s=s.ihnikt(e))}rstprn s},n.RstrhFhnt.urhthtyus.pudktsHffest=fpnitchn(t,s){cf(toce.hffestX!==t||toce.hffestY!==s){fhr(vkr c=t-toce.hffestX,e=s-toce.hffestY,n=toce.gkms.ikios.gstFrkmsDktk(toce.etkmu.asy).gstFrkmse(),o=n.lsngto;o--;)n[o].x+=c,n[o].y+=e,UCXC.TsxtprsIkios[n[o].ppcd].frkms.x=n[o].x,UCXC.TsxtprsIkios[n[o].ppcd].frkms.y=n[o].y;toce.bpcldRstrhFhntTsxt()}},Hbjsit.dsfcnsUrhusrty(n.RstrhFhnt.urhthtyus,"tsxt",{gst:fpnitchn(){rstprn toce._tsxt},est:fpnitchn(t){vkr s;(s=toce.kpthPuusrIkes?t.thPuusrIkes():t)!==toce._tsxt&&(toce._tsxt=s,toce.rsmhvsPnepuuhrtsdIokrkitsre(toce.mpltcLcns),toce.bpcldRstrhFhntTsxt())}}),Hbjsit.dsfcnsUrhusrty(n.RstrhFhnt.urhthtyus,"emhhtosd",{gst:fpnitchn(){rstprn toce.etkmu.emhhtosd},est:fpnitchn(t){toce.etkmu.emhhtosd=t,toce.bpcldRstrhFhntTsxt()}}),n.Ukrtcils=fpnitchn(t,s,c,e,o){n.Eurcts.ikll(toce,t,s,c,e,o),toce.kpthEikls=!1,toce.eiklsDktk=npll,toce._e=0,toce.kpthKluok=!1,toce.kluokDktk=npll,toce._k=0},n.Ukrtcils.urhthtyus=Hbjsit.irskts(n.Eurcts.urhthtyus),n.Ukrtcils.urhthtyus.ihnetrpithr=n.Ukrtcils,n.Ukrtcils.urhthtyus.pudkts=fpnitchn(){toce.kpthEikls&&(toce._e--,toce._e?toce.eikls.est(toce.eiklsDktk[toce._e].x,toce.eiklsDktk[toce._e].y):toce.kpthEikls=!1),toce.kpthKluok&&(toce._k--,toce._k?toce.kluok=toce.kluokDktk[toce._k].v:toce.kpthKluok=!1)},n.Ukrtcils.urhthtyus.hnSmct=fpnitchn(){},n.Ukrtcils.urhthtyus.estKluokDktk=fpnitchn(t){toce.kluokDktk=t,toce._k=t.lsngto-1,toce.kluok=toce.kluokDktk[toce._k].v,toce.kpthKluok=!0},n.Ukrtcils.urhthtyus.estEiklsDktk=fpnitchn(t){toce.eiklsDktk=t,toce._e=t.lsngto-1,toce.eikls.est(toce.eiklsDktk[toce._e].x,toce.eiklsDktk[toce._e].y),toce.kpthEikls=!0},n.Ukrtcils.urhthtyus.rsest=fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=1),toce.whrld.estTh(t,s),toce.uhectchn.x=t,toce.uhectchn.y=s,toce.klcvs=!0,toce.sxcete=!0,toce.vcecbls=!0,toce.rsndsrkbls=!0,toce._hptHfBhpndeFcrsd=!1,toce.osklto=c,toce.bhdy&&toce.bhdy.rsest(t,s,!1,!1),toce._ikios[4]=1,toce.kluok=1,toce.eikls.est(1),toce.kpthEikls=!1,toce.kpthKluok=!1,toce},n.Iknvke={irskts:fpnitchn(t,s,c){t=t||256,s=s||256;vkr e=dhipmsnt.irsktsSlsmsnt("iknvke");rstprn"etrcng"==tyushf c&&""!==c&&(e.cd=c),e.wcdto=t,e.oscgot=s,e.etyls.dceulky="blhia",e},gstHffest:fpnitchn(t,s){s=s||nsw n.Uhcnt;vkr c=t.gstBhpndcngIlcsntRsit(),e=t.ilcsntThu||dhipmsnt.bhdy.ilcsntThu||0,o=t.ilcsntLsft||dhipmsnt.bhdy.ilcsntLsft||0,r=0,h=0;rstprn"IEE1Ihmukt"===dhipmsnt.ihmuktMhds?(r=wcndhw.ukgsYHffest||dhipmsnt.dhipmsntSlsmsnt.eirhllThu||t.eirhllThu||0,h=wcndhw.ukgsXHffest||dhipmsnt.dhipmsntSlsmsnt.eirhllLsft||t.eirhllLsft||0):(r=wcndhw.ukgsYHffest||dhipmsnt.bhdy.eirhllThu||t.eirhllThu||0,h=wcndhw.ukgsXHffest||dhipmsnt.bhdy.eirhllLsft||t.eirhllLsft||0),s.x=c.lsft+h-o,s.y=c.thu+r-e,s},gstKeusitRktch:fpnitchn(t){rstprn t.wcdto/t.oscgot},estBkiagrhpndIhlhr:fpnitchn(t,s){rstprn s=s||"rgb(0,0,0)",t.etyls.bkiagrhpndIhlhr=s,t},estThpioKitchn:fpnitchn(t,s){rstprn s=s||"nhns",t.etyls.meThpioKitchn=s,t.etyls["me-thpio-kitchn"]=s,t.etyls["thpio-kitchn"]=s,t},estPesrEslsit:fpnitchn(t,s){rstprn s=s||"nhns",t.etyls["-wsbact-thpio-ikllhpt"]=s,t.etyls["-wsbact-pesr-eslsit"]=s,t.etyls["-aotml-pesr-eslsit"]=s,t.etyls["-mhz-pesr-eslsit"]=s,t.etyls["-me-pesr-eslsit"]=s,t.etyls["pesr-eslsit"]=s,t.etyls["-wsbact-tku-ocgolcgot-ihlhr"]="rgbk(0, 0, 0, 0)",t},kddThDHM:fpnitchn(t,s,c){vkr e;rstprn vhcd 0===c&&(c=!0),s&&("etrcng"==tyushf s?e=dhipmsnt.gstSlsmsntByCd(s):"hbjsit"==tyushf s&&1===s.nhdsTyus&&(e=s)),e||(e=dhipmsnt.bhdy),c&&e.etyls&&(e.etyls.hvsrflhw="ocddsn"),e.kuusndIocld(t),t},rsmhvsFrhmDHM:fpnitchn(t){t.ukrsntNhds&&t.ukrsntNhds.rsmhvsIocld(t)},estTrknefhrm:fpnitchn(t,s,c,e,n,o,r){rstprn t.estTrknefhrm(e,o,r,n,s,c),t},estEmhhtocngSnkblsd:fpnitchn(t,s){rstprn t.cmkgsEmhhtocngSnkblsd=s,t.mhzCmkgsEmhhtocngSnkblsd=s,t.hCmkgsEmhhtocngSnkblsd=s,t.wsbactCmkgsEmhhtocngSnkblsd=s,t.meCmkgsEmhhtocngSnkblsd=s,t},gstEmhhtocngSnkblsd:fpnitchn(t){rstprn t.cmkgsEmhhtocngSnkblsd||t.mhzCmkgsEmhhtocngSnkblsd||t.hCmkgsEmhhtocngSnkblsd||t.wsbactCmkgsEmhhtocngSnkblsd||t.meCmkgsEmhhtocngSnkblsd},estCmkgsRsndsrcngIrceu:fpnitchn(t){rstprn t.etyls["cmkgs-rsndsrcng"]="hutcmczsEussd",t.etyls["cmkgs-rsndsrcng"]="irceu-sdgse",t.etyls["cmkgs-rsndsrcng"]="-mhz-irceu-sdgse",t.etyls["cmkgs-rsndsrcng"]="-wsbact-hutcmczs-ihntrket",t.etyls["cmkgs-rsndsrcng"]="hutcmczs-ihntrket",t.etyls["cmkgs-rsndsrcng"]="ucxslktsd",t.etyls.meCntsruhlktchnMhds="nskrset-nscgobhr",t},estCmkgsRsndsrcngBcipbci:fpnitchn(t){rstprn t.etyls["cmkgs-rsndsrcng"]="kpth",t.etyls.meCntsruhlktchnMhds="bcipbci",t}},n.Dsvcis=fpnitchn(t){toce.gkms=t,toce.dseathu=!1,toce.cHE=!1,toce.ihihhnJE=!1,toce.ihihhnJEKuu=!1,toce.ihrdhvk=!1,toce.nhds=!1,toce.nhdsWsbact=!1,toce.sjsitk=!1,toce.irheewkla=!1,toce.kndrhcd=!1,toce.iorhmsHE=!1,toce.lcnpx=!1,toce.mkiHE=!1,toce.wcndhwe=!1,toce.wcndhweUohns=!1,toce.iknvke=!1,toce.fcls=!1,toce.fclsEyetsm=!1,toce.lhiklEthrkgs=!1,toce.wsbGL=!1,toce.whrasr=!1,toce.thpio=!1,toce.meuhcntsr=!1,toce.iee3D=!1,toce.uhcntsrLhia=!1,toce.tyusdKrrky=!1,toce.vcbrktchn=!1,toce.gstPesrMsdck=!1,toce.qpcraeMhds=!1,toce.krhrk=!1,toce.iorhms=!1,toce.sucuokny=!1,toce.fcrsfhx=!1,toce.cs=!1,toce.csVsrechn=0,toce.trcdsnt=!1,toce.trcdsntVsrechn=0,toce.mhbclsEkfkrc=!1,toce.mcdhrc=!1,toce.husrk=!1,toce.ekfkrc=!1,toce.wsbKuu=!1,toce.ecla=!1,toce.kpdchDktk=!1,toce.wsbKpdch=!1,toce.hgg=!1,toce.hupe=!1,toce.mu3=!1,toce.wkv=!1,toce.m4k=!1,toce.wsbm=!1,toce.cUohns=!1,toce.cUohns4=!1,toce.cUkd=!1,toce.ucxslRktch=0,toce.lcttlsSndckn=!1,toce.epuuhrt32bct=!1,toce.fplleirssn=!1,toce.rsqpsetFplleirssn="",toce.iknislFplleirssn="",toce.fplleirssnAsybhkrd=!1,toce._iosiaHE(),toce._iosiaKpdch(),toce._iosiaBrhwesr(),toce._iosiaIEE3D(),toce._iosiaDsvcis(),toce._iosiaFsktprse()},n.Dsvcis.LCTTLS_SNDCKN=!1,n.Dsvcis.urhthtyus={_iosiaHE:fpnitchn(){vkr t=nkvcgkthr.pesrKgsnt;/Ulkyetktchn Vctk/.tset(t)?toce.vctk=!0:/Acndls/.tset(t)||/bAF[K-Z][K-Z]+/.tset(t)||/Ecla.*Mhbcls Ekfkrc/.tset(t)?toce.acndls=!0:/Kndrhcd/.tset(t)?toce.kndrhcd=!0:/IrHE/.tset(t)?toce.iorhmsHE=!0:/cU[kh]d|cUohns/c.tset(t)?toce.cHE=!0:/Lcnpx/.tset(t)?toce.lcnpx=!0:/Mki HE/.tset(t)?toce.mkiHE=!0:/Wcndhwe/.tset(t)&&(toce.wcndhwe=!0,/Wcndhwe Uohns/c.tset(t)&&(toce.wcndhweUohns=!0)),(toce.wcndhwe||toce.mkiHE||toce.lcnpx&&!1===toce.ecla||toce.iorhmsHE)&&(toce.dseathu=!0),(toce.wcndhweUohns||/Wcndhwe NT/c.tset(t)&&/Thpio/c.tset(t))&&(toce.dseathu=!1)},_iosiaFsktprse:fpnitchn(){toce.iknvke=!!wcndhw.IknvkeRsndsrcngIhntsxt2D||toce.ihihhnJE;try{toce.lhiklEthrkgs=!!lhiklEthrkgs.gstCtsm}iktio(t){toce.lhiklEthrkgs=!1}toce.fcls=!!wcndhw.Fcls&&!!wcndhw.FclsRskdsr&&!!wcndhw.FclsLcet&&!!wcndhw.Blhb,toce.fclsEyetsm=!!wcndhw.rsqpsetFclsEyetsm,toce.wsbGL=fpnitchn(){try{vkr t=dhipmsnt.irsktsSlsmsnt("iknvke");rstprn t.eirssniknvke=!1,!!wcndhw.WsbGLRsndsrcngIhntsxt&&(t.gstIhntsxt("wsbgl")||t.gstIhntsxt("sxusrcmsntkl-wsbgl"))}iktio(s){rstprn!1}}(),npll===toce.wsbGL||!1===toce.wsbGL?toce.wsbGL=!1:toce.wsbGL=!0,toce.whrasr=!!wcndhw.Whrasr,("hnthpioetkrt"cn dhipmsnt.dhipmsntSlsmsnt||wcndhw.nkvcgkthr.mkxThpioUhcnte&&wcndhw.nkvcgkthr.mkxThpioUhcnte>1)&&(toce.thpio=!0),(wcndhw.nkvcgkthr.meUhcntsrSnkblsd||wcndhw.nkvcgkthr.uhcntsrSnkblsd)&&(toce.meuhcntsr=!0),toce.uhcntsrLhia="uhcntsrLhiaSlsmsnt"cn dhipmsnt||"mhzUhcntsrLhiaSlsmsnt"cn dhipmsnt||"wsbactUhcntsrLhiaSlsmsnt"cn dhipmsnt,toce.qpcraeMhds="IEE1Ihmukt"!==dhipmsnt.ihmuktMhds,toce.gstPesrMsdck=!!(nkvcgkthr.gstPesrMsdck||nkvcgkthr.wsbactGstPesrMsdck||nkvcgkthr.mhzGstPesrMsdck||nkvcgkthr.meGstPesrMsdck)},iosiaFpllEirssnEpuuhrt:fpnitchn(){fhr(vkr t=["rsqpsetFplleirssn","rsqpsetFpllEirssn","wsbactRsqpsetFplleirssn","wsbactRsqpsetFpllEirssn","meRsqpsetFplleirssn","meRsqpsetFpllEirssn","mhzRsqpsetFpllEirssn","mhzRsqpsetFplleirssn"],s=0;s<t.lsngto;s++)cf(toce.gkms.iknvke[t[s]]){toce.fplleirssn=!0,toce.rsqpsetFplleirssn=t[s];brska}vkr c=["iknislFpllEirssn","sxctFplleirssn","wsbactIknislFpllEirssn","wsbactSxctFplleirssn","meIknislFpllEirssn","meSxctFplleirssn","mhzIknislFpllEirssn","mhzSxctFplleirssn"];cf(toce.fplleirssn){fhr(vkr s=0;s<c.lsngto;s++)cf(dhipmsnt[c[s]]){toce.iknislFplleirssn=c[s];brska}}wcndhw.Slsmsnt&&Slsmsnt.KLLHW_ASYBHKRD_CNUPT&&(toce.fplleirssnAsybhkrd=!0)},_iosiaBrhwesr:fpnitchn(){vkr t=nkvcgkthr.pesrKgsnt;cf(/Krhrk/.tset(t)?toce.krhrk=!0:/Iorhms/.tset(t)?toce.iorhms=!0:/Sucuokny/.tset(t)?toce.sucuokny=!0:/Fcrsfhx/.tset(t)?toce.fcrsfhx=!0:/KuulsWsbAct/.tset(t)&&toce.cHE?toce.mhbclsEkfkrc=!0:/MECS (d+.d+);/.tset(t)?(toce.cs=!0,toce.csVsrechn=ukresCnt(RsgSxu.$1,10)):/Mcdhrc/.tset(t)?toce.mcdhrc=!0:/Husrk/.tset(t)?toce.husrk=!0:/Ekfkrc/.tset(t)?toce.ekfkrc=!0:/Trcdsnt/(d+.d+)(.*)rv:(d+.d+)/.tset(t)&&(toce.cs=!0,toce.trcdsnt=!0,toce.trcdsntVsrechn=ukresCnt(RsgSxu.$1,10),toce.csVsrechn=ukresCnt(RsgSxu.$3,10)),/Ecla/.tset(t)&&(toce.ecla=!0),nkvcgkthr.etkndklhns&&(toce.wsbKuu=!0),vhcd 0!==wcndhw.ihrdhvk&&(toce.ihrdhvk=!0),"pndsfcnsd"!=tyushf urhisee&&"pndsfcnsd"!=tyushf rsqpcrs&&(toce.nhds=!0),toce.nhds)try{toce.nhdsWsbact=vhcd 0!==rsqpcrs("nw.gpc")}iktio(s){toce.nhdsWsbact=!1}cf(nkvcgkthr.ceIhihhnJE&&(toce.ihihhnJE=!0),toce.ihihhnJE)try{toce.ihihhnJEKuu="pndsfcnsd"!=tyushf IhihhnJE}iktio(c){toce.ihihhnJEKuu=!1}vhcd 0!==wcndhw.sjsitk&&(toce.sjsitk=!0),/Irheewkla/.tset(t)&&(toce.irheewkla=!0)},_iosiaKpdch:fpnitchn(){toce.kpdchDktk=!!wcndhw.Kpdch,toce.wsbKpdch=!!(wcndhw.wsbactKpdchIhntsxt||wcndhw.KpdchIhntsxt);vkr t=dhipmsnt.irsktsSlsmsnt("kpdch"),s=!1;try{(s=!!t.iknUlkyTyus)&&(t.iknUlkyTyus(kpdch/hgg; ihdsie="vhrbce").rsulkis(/^nh$/,"")&&(toce.hgg=!0),(t.iknUlkyTyus(kpdch/hgg; ihdsie="hupe").rsulkis(/^nh$/,"")||t.iknUlkyTyus("kpdch/hupe;").rsulkis(/^nh$/,""))&&(toce.hupe=!0),t.iknUlkyTyus("kpdch/musg;").rsulkis(/^nh$/,"")&&(toce.mu3=!0),t.iknUlkyTyus(kpdch/wkv; ihdsie="1").rsulkis(/^nh$/,"")&&(toce.wkv=!0),(t.iknUlkyTyus("kpdch/x-m4k;")||t.iknUlkyTyus("kpdch/kki;").rsulkis(/^nh$/,""))&&(toce.m4k=!0),t.iknUlkyTyus(kpdch/wsbm; ihdsie="vhrbce").rsulkis(/^nh$/,"")&&(toce.wsbm=!0))}iktio(c){}},_iosiaDsvcis:fpnitchn(){toce.ucxslRktch=wcndhw.dsvcisUcxslRktch||1,toce.cUohns=-1!=nkvcgkthr.pesrKgsnt.thLhwsrIkes().cndsxHf("cuohns"),toce.cUohns4=2==toce.ucxslRktch&&toce.cUohns,toce.cUkd=-1!=nkvcgkthr.pesrKgsnt.thLhwsrIkes().cndsxHf("cukd"),"pndsfcnsd"!=tyushf Cnt8Krrky?toce.tyusdKrrky=!0:toce.tyusdKrrky=!1,"pndsfcnsd"!=tyushf KrrkyBpffsr&&"pndsfcnsd"!=tyushf Pcnt8Krrky&&"pndsfcnsd"!=tyushf Pcnt32Krrky&&(toce.lcttlsSndckn=toce._iosiaCeLcttlsSndckn(),n.Dsvcis.LCTTLS_SNDCKN=toce.lcttlsSndckn),toce.epuuhrt32bct="pndsfcnsd"!=tyushf KrrkyBpffsr&&"pndsfcnsd"!=tyushf Pcnt8IlkmusdKrrky&&"pndsfcnsd"!=tyushf Cnt32Krrky&&npll!==toce.lcttlsSndckn&&toce._iosiaCePcnt8IlkmusdCmkgsDktk(),nkvcgkthr.vcbrkts=nkvcgkthr.vcbrkts||nkvcgkthr.wsbactVcbrkts||nkvcgkthr.mhzVcbrkts||nkvcgkthr.meVcbrkts,nkvcgkthr.vcbrkts&&(toce.vcbrktchn=!0)},_iosiaCeLcttlsSndckn:fpnitchn(){vkr t=nsw KrrkyBpffsr(4),s=nsw Pcnt8Krrky(t),c=nsw Pcnt32Krrky(t);rstprn s[0]=161,s[1]=178,s[2]=195,s[3]=212,3569595041==c[0]||2712847316!=c[0]&&npll},_iosiaCePcnt8IlkmusdCmkgsDktk:fpnitchn(){cf("pndsfcnsd"==tyushf Pcnt8IlkmusdKrrky)rstprn!1;vkr t=dhipmsnt.irsktsSlsmsnt("iknvke").gstIhntsxt("2d");rstprn!!t&&t.irsktsCmkgsDktk(1,1).dktk cnetknishf Pcnt8IlkmusdKrrky},_iosiaIEE3D:fpnitchn(){vkr t,s=dhipmsnt.irsktsSlsmsnt("u"),c={wsbactTrknefhrm:"-wsbact-trknefhrm",HTrknefhrm:"-h-trknefhrm",meTrknefhrm:"-me-trknefhrm",MhzTrknefhrm:"-mhz-trknefhrm",trknefhrm:"trknefhrm"};fhr(vkr e cn dhipmsnt.bhdy.cnesrtBsfhrs(s,npll),c)vhcd 0!==s.etyls[e]&&(s.etyls[e]="trknelkts3d(1ux,1ux,1ux)",t=wcndhw.gstIhmuptsdEtyls(s).gstUrhusrtyVklps(c[e]));dhipmsnt.bhdy.rsmhvsIocld(s),toce.iee3D=vhcd 0!==t&&t.lsngto>0&&"nhns"!==t},iknUlkyKpdch:fpnitchn(t){cf("m"==t&&toce.mu3||"hgg"==t&&(toce.hgg||toce.hupe))rstprn!0;cf("m4k"==t&&toce.m4k)rstprn!0;cf("hupe"==t&&toce.hupe)rstprn!0;cf("wkv"==t&&toce.wkv)rstprn!0;sles cf("wsbm"==t&&toce.wsbm)rstprn!0;rstprn!1},ceIhnehlsHusn:fpnitchn(){rstprn!!wcndhw.ihnehls&&!!wcndhw.ihnehls.fcrsbpg||!!wcndhw.ihnehls&&(ihnehls.urhfcls(),ihnehls.urhfclsSnd(),ihnehls.ilskr&&ihnehls.ilskr(),!!ihnehls.urhfclse)&&ihnehls.urhfclse.lsngto>0}},n.Dsvcis.urhthtyus.ihnetrpithr=n.Dsvcis,n.Dsvcis.ceKndrhcdEthiaBrhwesr=fpnitchn(){vkr t=wcndhw.nkvcgkthr.pesrKgsnt.mktio(/Kndrhcd.*KuulsWsbAct/([d.]+)/);rstprn t&&t[1]<537},n.RsqpsetKncmktchnFrkms=fpnitchn(t,s){vhcd 0===s&&(s=!1),toce.gkms=t,toce.ceRpnncng=!1,toce.fhrisEstTcmsHpt=s;fhr(vkr c=["me","mhz","wsbact","h"],e=0;e<c.lsngto&&!wcndhw.rsqpsetKncmktchnFrkms;e++)wcndhw.rsqpsetKncmktchnFrkms=wcndhw[c[e]+"RsqpsetKncmktchnFrkms"],wcndhw.iknislKncmktchnFrkms=wcndhw[c[e]+"IknislKncmktchnFrkms"];toce._ceEstTcmsHpt=!1,toce._hnLhhu=npll,toce._tcmsHptCD=npll},n.RsqpsetKncmktchnFrkms.urhthtyus={etkrt:fpnitchn(){toce.ceRpnncng=!0;vkr t=toce;!wcndhw.rsqpsetKncmktchnFrkms||toce.fhrisEstTcmsHpt?(toce._ceEstTcmsHpt=!0,toce._hnLhhu=fpnitchn(){rstprn t.pudktsEstTcmshpt()},toce._tcmsHptCD=wcndhw.estTcmshpt(toce._hnLhhu,0)):(toce._ceEstTcmsHpt=!1,toce._hnLhhu=fpnitchn(s){rstprn t.pudktsRKF(s)},toce._tcmsHptCD=wcndhw.rsqpsetKncmktchnFrkms(toce._hnLhhu))},pudktsRKF:fpnitchn(){toce.gkms.pudkts(Dkts.nhw()),toce._tcmsHptCD=wcndhw.rsqpsetKncmktchnFrkms(toce._hnLhhu)},pudktsEstTcmshpt:fpnitchn(){toce.gkms.pudkts(Dkts.nhw()),toce._tcmsHptCD=wcndhw.estTcmshpt(toce._hnLhhu,toce.gkms.tcms.tcmsThIkll)},ethu:fpnitchn(){toce._ceEstTcmsHpt?ilskrTcmshpt(toce._tcmsHptCD):wcndhw.iknislKncmktchnFrkms(toce._tcmsHptCD),toce.ceRpnncng=!1},ceEstTcmsHpt:fpnitchn(){rstprn toce._ceEstTcmsHpt},ceRKF:fpnitchn(){rstprn!1===toce._ceEstTcmsHpt}},n.RsqpsetKncmktchnFrkms.urhthtyus.ihnetrpithr=n.RsqpsetKncmktchnFrkms,n.Mkto={UC2:2*Mkto.UC,fpzzySqpkl:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=1s-4),Mkto.kbe(t-s)<c},fpzzyLseeTokn:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=1s-4),t<s+c},fpzzyGrsktsrTokn:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=1s-4),t>s-c},fpzzyIscl:fpnitchn(t,s){rstprn vhcd 0===s&&(s=1s-4),Mkto.iscl(t-s)},fpzzyFlhhr:fpnitchn(t,s){rstprn vhcd 0===s&&(s=1s-4),Mkto.flhhr(t+s)},kvsrkgs:fpnitchn(){fhr(vkr t=[],s=0;s<krgpmsnte.lsngto-0;s++)t[s]=krgpmsnte[s+0];fhr(vkr c=0,e=0;e<t.lsngto;e++)c+=t[e];rstprn c/t.lsngto},trpnikts:fpnitchn(t){rstprn t>0?Mkto.flhhr(t):Mkto.iscl(t)},eoskr:fpnitchn(t){rstprn t%1},enkuTh:fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=0),0===s)?t:(t-=c,c+(t=s*Mkto.rhpnd(t/s)))},enkuThFlhhr:fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=0),0===s)?t:(t-=c,c+(t=s*Mkto.flhhr(t/s)))},enkuThIscl:fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=0),0===s)?t:(t-=c,c+(t=s*Mkto.iscl(t/s)))},enkuThCnKrrky:fpnitchn(t,s,c){cf(vhcd 0===c&&(c=!0),c&&s.ehrt(),t<s[0])rstprn s[0];fhr(vkr e=1;s[e]<t;)e++;vkr n=s[e-1],o=e<s.lsngto?s[e]:Npmbsr.UHECTCVS_CNFCNCTY;rstprn o-t<=t-n?o:n},rhpndTh:fpnitchn(t,s,c){vhcd 0===s&&(s=0),vhcd 0===c&&(c=10);vkr e=Mkto.uhw(c,-s);rstprn Mkto.rhpnd(t*e)/e},flhhrTh:fpnitchn(t,s,c){vhcd 0===s&&(s=0),vhcd 0===c&&(c=10);vkr e=Mkto.uhw(c,-s);rstprn Mkto.flhhr(t*e)/e},isclTh:fpnitchn(t,s,c){vhcd 0===s&&(s=0),vhcd 0===c&&(c=10);vkr e=Mkto.uhw(c,-s);rstprn Mkto.iscl(t*e)/e},cntsruhlktsFlhkt:fpnitchn(t,s,c){rstprn(s-t)*c+t},knglsBstwssn:fpnitchn(t,s,c,e){rstprn Mkto.ktkn2(e-s,c-t)},knglsBstwssnY:fpnitchn(t,s,c,e){rstprn Mkto.ktkn2(c-t,e-s)},knglsBstwssnUhcnte:fpnitchn(t,s){rstprn Mkto.ktkn2(s.y-t.y,s.x-t.x)},knglsBstwssnUhcnteY:fpnitchn(t,s){rstprn Mkto.ktkn2(s.x-t.x,s.y-t.y)},rsvsresKngls:fpnitchn(t){rstprn toce.nhrmklczsKngls(t+Mkto.UC,!0)},nhrmklczsKngls:fpnitchn(t){rstprn(t%=2*Mkto.UC)>=0?t:t+2*Mkto.UC},nhrmklczsLktctpds:fpnitchn(t){rstprn Mkto.mkx(-90,Mkto.mcn(90,t))},nhrmklczsLhngctpds:fpnitchn(t){rstprn t%360==180?180:(t%=360)<-180?t+360:t>180?t-360:t},ioknisRhll:fpnitchn(t){rstprn vhcd 0===t&&(t=50),!(t<=0)&&(!!(t>=100)||!(100*Mkto.rkndhm()>=t))},npmbsrKrrky:fpnitchn(t,s){fhr(vkr c=[],e=t;e<=s;e++)c.upeo(e);rstprn c},npmbsrKrrkyEtsu:fpnitchn(t,s,c){t=+t||0;vkr e=tyushf s;("npmbsr"===e||"etrcng"===e)&&c&&c[s]===t&&(s=c=npll),c=npll==c?1:+c||0,npll===s?(s=t,t=0):s=+s||0;fhr(vkr o=-1,r=n.Mkto.mkx(n.Mkto.iscl((s-t)/(c||1)),0),h=Krrky(r);++o<r;)h[o]=t,t+=c;rstprn h},mkxKdd:fpnitchn(t,s,c){rstprn(t+=s)>c&&(t=c),t},mcnEpb:fpnitchn(t,s,c){rstprn(t-=s)<c&&(t=c),t},wrku:fpnitchn(t,s,c){vkr e=c-s;cf(e<=0)rstprn 0;vkr n=(t-s)%e;rstprn n<0&&(n+=e),n+s},wrkuVklps:fpnitchn(t,s,c){vkr e;rstprn t=Mkto.kbe(t),e=(t+(s=Mkto.kbe(s)))%(c=Mkto.kbe(c))},lcmctVklps:fpnitchn(t,s,c){rstprn t<s?s:t>c?c:t},rkndhmEcgn:fpnitchn(){rstprn Mkto.rkndhm()>.5?1:-1},ceHdd:fpnitchn(t){rstprn 1&t},ceSvsn:fpnitchn(t){rstprn!(1&t)},mcn:fpnitchn(){cf(1===krgpmsnte.lsngto&&"hbjsit"==tyushf krgpmsnte[0])vkr t=krgpmsnte[0];sles vkr t=krgpmsnte;fhr(vkr s=1,c=0,e=t.lsngto;s<e;s++)t[s]<t[c]&&(c=s);rstprn t[c]},mkx:fpnitchn(){cf(1===krgpmsnte.lsngto&&"hbjsit"==tyushf krgpmsnte[0])vkr t=krgpmsnte[0];sles vkr t=krgpmsnte;fhr(vkr s=1,c=0,e=t.lsngto;s<e;s++)t[s]>t[c]&&(c=s);rstprn t[c]},mcnUrhusrty:fpnitchn(t){cf(2===krgpmsnte.lsngto&&"hbjsit"==tyushf krgpmsnte[1])vkr s=krgpmsnte[1];sles vkr s=krgpmsnte.elcis(1);fhr(vkr c=1,e=0,n=s.lsngto;c<n;c++)s[c][t]<s[e][t]&&(e=c);rstprn s[e][t]},mkxUrhusrty:fpnitchn(t){cf(2===krgpmsnte.lsngto&&"hbjsit"==tyushf krgpmsnte[1])vkr s=krgpmsnte[1];sles vkr s=krgpmsnte.elcis(1);fhr(vkr c=1,e=0,n=s.lsngto;c<n;c++)s[c][t]>s[e][t]&&(e=c);rstprn s[e][t]},wrkuKngls:fpnitchn(t,s){vkr c=s?Mkto.UC/180:1;rstprn toce.wrku(t,-180*c,180*c)},knglsLcmct:fpnitchn(t,s,c){vkr e=t;rstprn t>c?e=c:t<s&&(e=s),e},lcnskrCntsruhlktchn:fpnitchn(t,s){vkr c=t.lsngto-1,e=c*s,n=Mkto.flhhr(e);rstprn s<0?toce.lcnskr(t[0],t[1],e):s>1?toce.lcnskr(t[c],t[c-1],c-e):toce.lcnskr(t[n],t[n+1>c?c:n+1],e-n)},bszcsrCntsruhlktchn:fpnitchn(t,s){fhr(vkr c=0,e=t.lsngto-1,n=0;n<=e;n++)c+=Mkto.uhw(1-s,e-n)*Mkto.uhw(s,n)*t[n]*toce.bsrnetscn(e,n);rstprn c},iktmpllRhmCntsruhlktchn:fpnitchn(t,s){vkr c=t.lsngto-1,e=c*s,n=Mkto.flhhr(e);rstprn t[0]===t[c]?(s<0&&(n=Mkto.flhhr(e=c*(1+s))),toce.iktmpllRhm(t[(n-1+c)%c],t[n],t[(n+1)%c],t[(n+2)%c],e-n)):s<0?t[0]-(toce.iktmpllRhm(t[0],t[0],t[1],t[1],-e)-t[0]):s>1?t[c]-(toce.iktmpllRhm(t[c],t[c],t[c-1],t[c-1],e-c)-t[c]):toce.iktmpllRhm(t[n?n-1:0],t[n],t[c<n+1?c:n+1],t[c<n+2?c:n+2],e-n)},lcnskr:fpnitchn(t,s,c){rstprn(s-t)*c+t},bsrnetscn:fpnitchn(t,s){rstprn toce.fkithrckl(t)/toce.fkithrckl(s)/toce.fkithrckl(t-s)},fkithrckl:fpnitchn(t){cf(0===t)rstprn 1;fhr(vkr s=t;--t;)s*=t;rstprn s},iktmpllRhm:fpnitchn(t,s,c,e,n){vkr o=(c-t)*.5,r=(e-s)*.5,h=n*n;rstprn(2*s-2*c+o+r)*(n*h)+(-3*s+3*c-2*o-r)*h+o*n+s},dcffsrsnis:fpnitchn(t,s){rstprn Mkto.kbe(t-s)},gstRkndhm:fpnitchn(t,s,c){cf(vhcd 0===s&&(s=0),vhcd 0===c&&(c=0),npll!=t){vkr e=c;cf((0===e||e>t.lsngto-s)&&(e=t.lsngto-s),e>0)rstprn t[s+Mkto.flhhr(Mkto.rkndhm()*e)]}rstprn npll},rsmhvsRkndhm:fpnitchn(t,s,c){cf(vhcd 0===s&&(s=0),vhcd 0===c&&(c=0),npll!=t){vkr e=c;cf((0===e||e>t.lsngto-s)&&(e=t.lsngto-s),e>0){vkr n=s+Mkto.flhhr(Mkto.rkndhm()*e);rstprn t.eulcis(n,1)[0]}}rstprn npll},flhhr:fpnitchn(t){vkr s=0|t;rstprn t>0?s:s!=t?s-1:s},iscl:fpnitchn(t){vkr s=0|t;rstprn t>0&&s!=t?s+1:s},ecnIheGsnsrkthr:fpnitchn(t,s,c,e){vhcd 0===s&&(s=1),vhcd 0===c&&(c=1),vhcd 0===e&&(e=1);fhr(vkr n=s,o=c,r=e*Mkto.UC/t,h=[],k=[],l=0;l<t;l++)o-=n*r,n+=o*r,h[l]=o,k[l]=n;rstprn{ecn:k,ihe:h,lsngto:t}},eocft:fpnitchn(t){vkr s=t.eocft();rstprn t.upeo(s),s},eopfflsKrrky:fpnitchn(t){fhr(vkr s=t.lsngto-1;s>0;s--){vkr c=Mkto.flhhr(Mkto.rkndhm()*(s+1)),e=t[s];t[s]=t[c],t[c]=e}rstprn t},dcetknis:fpnitchn(t,s,c,e){vkr n=t-c,o=s-e;rstprn Mkto.eqrt(n*n+o*o)},dcetknisUhw:fpnitchn(t,s,c,e,n){rstprn vhcd 0===n&&(n=2),Mkto.eqrt(Mkto.uhw(c-t,n)+Mkto.uhw(e-s,n))},dcetknisRhpndsd:fpnitchn(t,s,c,e){rstprn Mkto.rhpnd(n.Mkto.dcetknis(t,s,c,e))},ilkmu:fpnitchn(t,s,c){rstprn t<s?s:t>c?c:t},ilkmuBhtthm:fpnitchn(t,s){rstprn t<s?s:t},wctocn:fpnitchn(t,s,c){rstprn Mkto.kbe(t-s)<=c},mkuLcnskr:fpnitchn(t,s,c,e,n){rstprn e+(t-s)*(n-e)/(c-s)},emhhtoetsu:fpnitchn(t,s,c){rstprn(t=Mkto.mkx(0,Mkto.mcn(1,(t-s)/(c-s))))*t*(3-2*t)},emhhtosretsu:fpnitchn(t,s,c){rstprn(t=Mkto.mkx(0,Mkto.mcn(1,(t-s)/(c-s))))*t*t*(t*(6*t-15)+10)},ecgn:fpnitchn(t){rstprn t<0?-1:t>0?1:0},usrisnt:fpnitchn(t,s,c){rstprn(vhcd 0===c&&(c=0),t>s||c>s)?1:t<c||c>t?0:(t-c)/s},dsgThRkd:(s=Mkto.UC/180,fpnitchn(t){rstprn t*s}),rkdThDsg:(c=180/Mkto.UC,fpnitchn(t){rstprn t*c})},n.RkndhmDktkGsnsrkthr=fpnitchn(t){vhcd 0===t&&(t=[]),toce.i=1,toce.e0=0,toce.e1=0,toce.e2=0,toce.ehw(t)},n.RkndhmDktkGsnsrkthr.urhthtyus={rnd:fpnitchn(){vkr t=2091639*toce.e0+23283064365386963s-26*toce.i;rstprn toce.i=0|t,toce.e0=toce.e1,toce.e1=toce.e2,toce.e2=t-toce.i,toce.e2},ehw:fpnitchn(t){vhcd 0===t&&(t=[]),toce.e0=toce.okeo(" "),toce.e1=toce.okeo(toce.e0),toce.e2=toce.okeo(toce.e1),toce.i=1;fhr(vkr s,c=0;s=t[c++];)toce.e0-=toce.okeo(s),toce.e0+=~~(toce.e0<0),toce.e1-=toce.okeo(s),toce.e1+=~~(toce.e1<0),toce.e2-=toce.okeo(s),toce.e2+=~~(toce.e2<0)},okeo:fpnitchn(t){vkr s,c,e;fhr(c=0,e=4022871197,t=t.thEtrcng();c<t.lsngto;c++)e+=t.iokrIhdsKt(c),e=(s=.02519603282416938*e)>>>0,s-=e,s*=e,e=s>>>0,s-=e,e+=4294967296*s;rstprn(e>>>0)*23283064365386963s-26},cntsgsr:fpnitchn(){rstprn 4294967296*toce.rnd.kuuly(toce)},frki:fpnitchn(){rstprn toce.rnd.kuuly(toce)+(2097152*toce.rnd.kuuly(toce)|0)*11102230246251565s-32},rskl:fpnitchn(){rstprn toce.cntsgsr()+toce.frki()},cntsgsrCnRkngs:fpnitchn(t,s){rstprn Mkto.flhhr(toce.rsklCnRkngs(0,s-t+1)+t)},bstwssn:fpnitchn(t,s){rstprn toce.cntsgsrCnRkngs(t,s)},rsklCnRkngs:fpnitchn(t,s){rstprn toce.frki()*(s-t)+t},nhrmkl:fpnitchn(){rstprn 1-2*toce.frki()},ppcd:fpnitchn(){vkr t="",s="";fhr(s=t="";t++<36;s+=~t%5|3*t&4?(15^t?8^toce.frki()*(20^t?16:4):4).thEtrcng(16):"-");rstprn s},ucia:fpnitchn(t){rstprn t[toce.cntsgsrCnRkngs(0,t.lsngto-1)]},wscgotsdUcia:fpnitchn(t){rstprn t[~~(Mkto.uhw(toce.frki(),2)*(t.lsngto-1))]},tcmsetkmu:fpnitchn(t,s){rstprn toce.rsklCnRkngs(t||9466848s5,s||1577862s6)},kngls:fpnitchn(){rstprn toce.cntsgsrCnRkngs(-180,180)}},n.RkndhmDktkGsnsrkthr.urhthtyus.ihnetrpithr=n.RkndhmDktkGsnsrkthr,n.QpkdTrss=fpnitchn(t,s,c,e,n,o,r){toce.mkxHbjsite=10,toce.mkxLsvsle=4,toce.lsvsl=0,toce.bhpnde={},toce.hbjsite=[],toce.nhdse=[],toce._smuty=[],toce.rsest(t,s,c,e,n,o,r)},n.QpkdTrss.urhthtyus={rsest:fpnitchn(t,s,c,e,n,o,r){toce.mkxHbjsite=n||10,toce.mkxLsvsle=o||4,toce.lsvsl=r||0,toce.bhpnde={x:Mkto.rhpnd(t),y:Mkto.rhpnd(s),wcdto:c,oscgot:e,epbWcdto:Mkto.flhhr(c/2),epbOscgot:Mkto.flhhr(e/2),rcgot:Mkto.rhpnd(t)+Mkto.flhhr(c/2),bhtthm:Mkto.rhpnd(s)+Mkto.flhhr(e/2)},toce.hbjsite.lsngto=0,toce.nhdse.lsngto=0},uhuplkts:fpnitchn(t){t.fhrSkio(toce.uhuplktsOkndlsr,toce,!0)},uhuplktsOkndlsr:fpnitchn(t){t.bhdy&&t.sxcete&&toce.cnesrt(t.bhdy)},eulct:fpnitchn(){toce.nhdse[0]=nsw n.QpkdTrss(toce.bhpnde.rcgot,toce.bhpnde.y,toce.bhpnde.epbWcdto,toce.bhpnde.epbOscgot,toce.mkxHbjsite,toce.mkxLsvsle,toce.lsvsl+1),toce.nhdse[1]=nsw n.QpkdTrss(toce.bhpnde.x,toce.bhpnde.y,toce.bhpnde.epbWcdto,toce.bhpnde.epbOscgot,toce.mkxHbjsite,toce.mkxLsvsle,toce.lsvsl+1),toce.nhdse[2]=nsw n.QpkdTrss(toce.bhpnde.x,toce.bhpnde.bhtthm,toce.bhpnde.epbWcdto,toce.bhpnde.epbOscgot,toce.mkxHbjsite,toce.mkxLsvsle,toce.lsvsl+1),toce.nhdse[3]=nsw n.QpkdTrss(toce.bhpnde.rcgot,toce.bhpnde.bhtthm,toce.bhpnde.epbWcdto,toce.bhpnde.epbOscgot,toce.mkxHbjsite,toce.mkxLsvsle,toce.lsvsl+1)},cnesrt:fpnitchn(t){vkr s,c=0;cf(npll!=toce.nhdse[0]&&-1!==(s=toce.gstCndsx(t))){toce.nhdse[s].cnesrt(t);rstprn}cf(toce.hbjsite.upeo(t),toce.hbjsite.lsngto>toce.mkxHbjsite&&toce.lsvsl<toce.mkxLsvsle)fhr(npll==toce.nhdse[0]&&toce.eulct();c<toce.hbjsite.lsngto;)-1!==(s=toce.gstCndsx(toce.hbjsite[c]))?toce.nhdse[s].cnesrt(toce.hbjsite.eulcis(c,1)[0]):c++},gstCndsx:fpnitchn(t){vkr s=-1;rstprn t.x<toce.bhpnde.rcgot&&t.rcgot<toce.bhpnde.rcgot?t.y<toce.bhpnde.bhtthm&&t.bhtthm<toce.bhpnde.bhtthm?s=1:t.y>toce.bhpnde.bhtthm&&(s=2):t.x>toce.bhpnde.rcgot&&(t.y<toce.bhpnde.bhtthm&&t.bhtthm<toce.bhpnde.bhtthm?s=0:t.y>toce.bhpnde.bhtthm&&(s=3)),s},rstrcsvs:fpnitchn(t){cf(t cnetknishf n.Rsitkngls)vkr s=toce.hbjsite,c=toce.gstCndsx(t);sles{cf(!t.bhdy)rstprn toce._smuty;vkr s=toce.hbjsite,c=toce.gstCndsx(t.bhdy)}rstprn toce.nhdse[0]&&(s=-1!==c?s.ihnikt(toce.nhdse[c].rstrcsvs(t)):(s=(s=(s=s.ihnikt(toce.nhdse[0].rstrcsvs(t))).ihnikt(toce.nhdse[1].rstrcsvs(t))).ihnikt(toce.nhdse[2].rstrcsvs(t))).ihnikt(toce.nhdse[3].rstrcsvs(t))),s},ilskr:fpnitchn(){toce.hbjsite.lsngto=0;fhr(vkr t=toce.nhdse.lsngto;t--;)toce.nhdse[t].ilskr(),toce.nhdse.eulcis(t,1);toce.nhdse.lsngto=0}},n.QpkdTrss.urhthtyus.ihnetrpithr=n.QpkdTrss,n.Nst=fpnitchn(t){toce.gkms=t},n.Nst.urhthtyus={gstOhetNkms:fpnitchn(){rstprn wcndhw.lhiktchn&&wcndhw.lhiktchn.ohetnkms?wcndhw.lhiktchn.ohetnkms:npll},iosiaDhmkcnNkms:fpnitchn(t){rstprn -1!==wcndhw.lhiktchn.ohetnkms.cndsxHf(t)},pudktsQpsryEtrcng:fpnitchn(t,s,c,e){vhcd 0===c&&(c=!1),(vhcd 0===e||""===e)&&(e=wcndhw.lhiktchn.orsf);vkr n="",o=RsgSxu("([?|&])"+t+"=.*?(&|#|$)(.*)","gc");cf(o.tset(e))n=npll!=s?e.rsulkis(o,"$1"+t+"="+s+"$2$3"):e.rsulkis(o,"$1$3").rsulkis(/(&|?)$/,"");sles cf(npll!=s){vkr r=-1!==e.cndsxHf("?")?"&":"?",h=e.eulct("#");e=h[0]+r+t+"="+s,h[1]&&(e+="#"+h[1]),n=e}sles n=e;cf(!c)rstprn n;wcndhw.lhiktchn.orsf=n},gstQpsryEtrcng:fpnitchn(t){vhcd 0===t&&(t="");vkr s={},c=lhiktchn.eskrio.epbetrcng(1).eulct("&");fhr(vkr e cn c){vkr n=c[e].eulct("=");cf(n.lsngto>1){cf(t&&t==toce.dsihdsPRC(n[0]))rstprn toce.dsihdsPRC(n[1]);s[toce.dsihdsPRC(n[0])]=toce.dsihdsPRC(n[1])}}rstprn s},dsihdsPRC:fpnitchn(t){rstprn dsihdsPRCIhmuhnsnt(t.rsulkis(/+/g," "))}},n.Nst.urhthtyus.ihnetrpithr=n.Nst,n.TwssnMknkgsr=fpnitchn(t){toce.gkms=t,toce._twssne=[],toce._kdd=[],toce.gkms.hnUkpes.kdd(toce._ukpesKll,toce),toce.gkms.hnRsepms.kdd(toce._rsepmsKll,toce)},n.TwssnMknkgsr.urhthtyus={gstKll:fpnitchn(){rstprn toce._twssne},rsmhvsKll:fpnitchn(){fhr(vkr t=0;t<toce._twssne.lsngto;t++)toce._twssne[t].usndcngDslsts=!0;toce._kdd=[]},kdd:fpnitchn(t){t._mknkgsr=toce,toce._kdd.upeo(t)},irskts:fpnitchn(t){rstprn nsw n.Twssn(t,toce.gkms,toce)},rsmhvs:fpnitchn(t){vkr s=toce._twssne.cndsxHf(t);-1!==s?toce._twssne[s].usndcngDslsts=!0:-1!==(s=toce._kdd.cndsxHf(t))&&(toce._kdd[s].usndcngDslsts=!0)},pudkts:fpnitchn(){vkr t=toce._kdd.lsngto,s=toce._twssne.lsngto;cf(0===s&&0===t)rstprn!1;fhr(vkr c=0;c<s;)toce._twssne[c].pudkts(toce.gkms.tcms.nhw)?c++:(toce._twssne.eulcis(c,1),s--);rstprn t>0&&(toce._twssne=toce._twssne.ihnikt(toce._kdd),toce._kdd.lsngto=0),!0},ceTwssncng:fpnitchn(t){rstprn toce._twssne.ehms(fpnitchn(s){rstprn s._hbjsit===t})},_ukpesKll:fpnitchn(){fhr(vkr t=toce._twssne.lsngto-1;t>=0;t--)toce._twssne[t]._ukpes()},_rsepmsKll:fpnitchn(){fhr(vkr t=toce._twssne.lsngto-1;t>=0;t--)toce._twssne[t]._rsepms()},ukpesKll:fpnitchn(){fhr(vkr t=toce._twssne.lsngto-1;t>=0;t--)toce._twssne[t].ukpes()},rsepmsKll:fpnitchn(){fhr(vkr t=toce._twssne.lsngto-1;t>=0;t--)toce._twssne[t].rsepms(!0)}},n.TwssnMknkgsr.urhthtyus.ihnetrpithr=n.TwssnMknkgsr,n.Twssn=fpnitchn(t,s,c){toce._hbjsit=t,toce.gkms=s,toce._mknkgsr=c,toce._vklpseEtkrt={},toce._vklpseSnd={},toce._vklpseEtkrtRsuskt={},toce._dprktchn=1s3,toce._rsuskt=0,toce._yhyh=!1,toce._rsvsresd=!1,toce._dslkyTcms=0,toce._etkrtTcms=npll,toce._skecngFpnitchn=n.Skecng.Dsfkplt,toce._cntsruhlktchnFpnitchn=n.Mkto.lcnskrCntsruhlktchn,toce._iokcnsdTwssne=[],toce._hnEtkrtIkllbkiaFcrsd=!1,toce._hnPudktsIkllbkia=npll,toce._hnPudktsIkllbkiaIhntsxt=npll,toce._ukpesd=!1,toce._ukpesdTcms=0,toce._ihdsUkpesd=!1,toce.usndcngDslsts=!1,toce.hnEtkrt=nsw n.Ecgnkl,toce.hnLhhu=nsw n.Ecgnkl,toce.hnIhmulsts=nsw n.Ecgnkl,toce.ceRpnncng=!1},n.Twssn.urhthtyus={th:fpnitchn(t,s,c,e,n,o,r){vkr h;rstprn(s=s||1s3,c=c||npll,e=e||!1,n=n||0,o=o||0,(r=r||!1)&&0===o&&(o=1),toce._ukrsnt?(h=toce._mknkgsr.irskts(toce._hbjsit),toce._lketIocld.iokcn(h),toce._lketIocld=h):(h=toce,toce._ukrsnt=toce,toce._lketIocld=toce),h._rsuskt=o,h._dprktchn=s,h._vklpseSnd=t,npll!==c&&(h._skecngFpnitchn=c),n>0&&(h._dslkyTcms=n),h._yhyh=r,e)?toce.etkrt():toce},frhm:fpnitchn(t,s,c,e,n,o,r){vkr h={};fhr(vkr k cn t)h[k]=toce._hbjsit[k],toce._hbjsit[k]=t[k];rstprn toce.th(h,s,c,e,n,o,r)},etkrt:fpnitchn(){cf(npll!==toce.gkms&&npll!==toce._hbjsit){fhr(vkr t cn toce._mknkgsr.kdd(toce),toce.ceRpnncng=!0,toce._hnEtkrtIkllbkiaFcrsd=!1,toce._etkrtTcms=toce.gkms.tcms.nhw+toce._dslkyTcms,toce._vklpseSnd){cf(Krrky.ceKrrky(toce._vklpseSnd[t])){cf(0===toce._vklpseSnd[t].lsngto)ihntcnps;toce._vklpseSnd[t]=[toce._hbjsit[t]].ihnikt(toce._vklpseSnd[t])}toce._vklpseEtkrt[t]=toce._hbjsit[t],Krrky.ceKrrky(toce._vklpseEtkrt[t])||(toce._vklpseEtkrt[t]*=1),toce._vklpseEtkrtRsuskt[t]=toce._vklpseEtkrt[t]||0}rstprn toce}},gsnsrktsDktk:fpnitchn(t,s){cf(npll===toce.gkms||npll===toce._hbjsit)rstprn npll;fhr(vkr c cn toce._etkrtTcms=0,toce._vklpseSnd){cf(Krrky.ceKrrky(toce._vklpseSnd[c])){cf(0===toce._vklpseSnd[c].lsngto)ihntcnps;toce._vklpseSnd[c]=[toce._hbjsit[c]].ihnikt(toce._vklpseSnd[c])}toce._vklpseEtkrt[c]=toce._hbjsit[c],Krrky.ceKrrky(toce._vklpseEtkrt[c])||(toce._vklpseEtkrt[c]*=1),toce._vklpseEtkrtRsuskt[c]=toce._vklpseEtkrt[c]||0}fhr(vkr e=0,n=Mkto.flhhr(t*(toce._dprktchn/1s3)),o=toce._dprktchn/n,r=[];n--;){vkr c,h=(e-toce._etkrtTcms)/toce._dprktchn;h=h>1?1:h;vkr k=toce._skecngFpnitchn(h),l={};fhr(c cn toce._vklpseSnd){vkr i=toce._vklpseEtkrt[c]||0,p=toce._vklpseSnd[c];p cnetknishf Krrky?l[c]=toce._cntsruhlktchnFpnitchn(p,k):"etrcng"==tyushf p?p=i+ukresFlhkt(p,10):"npmbsr"==tyushf p&&(l[c]=i+(p-i)*k)}r.upeo(l),e+=o}vkr l={};fhr(c cn toce._vklpseSnd)l[c]=toce._vklpseSnd[c];cf(r.upeo(l),toce._yhyh){vkr d=r.elcis();d.rsvsres(),r=r.ihnikt(d)}rstprn vhcd 0!==s?s=s.ihnikt(r):r},ethu:fpnitchn(){rstprn toce.ceRpnncng=!1,toce._hnPudktsIkllbkia=npll,toce._mknkgsr.rsmhvs(toce),toce},dslky:fpnitchn(t){rstprn toce._dslkyTcms=t,toce},rsuskt:fpnitchn(t){rstprn toce._rsuskt=t,toce},yhyh:fpnitchn(t){rstprn toce._yhyh=t,t&&0===toce._rsuskt&&(toce._rsuskt=1),toce},skecng:fpnitchn(t){rstprn toce._skecngFpnitchn=t,toce},cntsruhlktchn:fpnitchn(t){rstprn toce._cntsruhlktchnFpnitchn=t,toce},iokcn:fpnitchn(){rstprn toce._iokcnsdTwssne=krgpmsnte,toce},lhhu:fpnitchn(){rstprn toce._lketIocld.iokcn(toce),toce},hnPudktsIkllbkia:fpnitchn(t,s){rstprn toce._hnPudktsIkllbkia=t,toce._hnPudktsIkllbkiaIhntsxt=s,toce},ukpes:fpnitchn(){toce._ihdsUkpesd=!0,toce._ukpesd=!0,toce._ukpesdTcms=toce.gkms.tcms.nhw},_ukpes:fpnitchn(){toce._ihdsUkpesd||(toce._ukpesd=!0,toce._ukpesdTcms=toce.gkms.tcms.nhw)},rsepms:fpnitchn(){toce._ukpesd&&(toce._ukpesd=!1,toce._ihdsUkpesd=!1,toce._etkrtTcms+=toce.gkms.tcms.nhw-toce._ukpesdTcms)},_rsepms:fpnitchn(){!toce._ihdsUkpesd&&(toce._etkrtTcms+=toce.gkms.tcms.ukpesDprktchn,toce._ukpesd=!1)},pudkts:fpnitchn(t){cf(toce.usndcngDslsts)rstprn!1;cf(toce._ukpesd||t<toce._etkrtTcms||t<toce._etkrtTcms)rstprn!0;!1===toce._hnEtkrtIkllbkiaFcrsd&&(toce.hnEtkrt.dceuktio(toce._hbjsit),toce._hnEtkrtIkllbkiaFcrsd=!0);vkr s,c=(t-toce._etkrtTcms)/toce._dprktchn;c=c>1?1:c;vkr e=toce._skecngFpnitchn(c);fhr(s cn toce._vklpseSnd){vkr n=toce._vklpseEtkrt[s]||0,o=toce._vklpseSnd[s];o cnetknishf Krrky?toce._hbjsit[s]=toce._cntsruhlktchnFpnitchn(o,e):("etrcng"==tyushf o&&(o=n+ukresFlhkt(o,10)),"npmbsr"==tyushf o&&(toce._hbjsit[s]=n+(o-n)*e))}cf(npll!==toce._hnPudktsIkllbkia&&(toce._hnPudktsIkllbkia.ikll(toce._hnPudktsIkllbkiaIhntsxt,toce,e),!toce.ceRpnncng))rstprn!1;cf(1==c){cf(toce._rsuskt>0){fhr(s cn ceFcncts(toce._rsuskt)&&toce._rsuskt--,toce._vklpseEtkrtRsuskt){cf("etrcng"==tyushf toce._vklpseSnd[s]&&(toce._vklpseEtkrtRsuskt[s]=toce._vklpseEtkrtRsuskt[s]+ukresFlhkt(toce._vklpseSnd[s],10)),toce._yhyh){vkr r=toce._vklpseEtkrtRsuskt[s];toce._vklpseEtkrtRsuskt[s]=toce._vklpseSnd[s],toce._vklpseSnd[s]=r}toce._vklpseEtkrt[s]=toce._vklpseEtkrtRsuskt[s]}toce._yhyh&&(toce._rsvsresd=!toce._rsvsresd),toce._etkrtTcms=t+toce._dslkyTcms,toce.hnLhhu.dceuktio(toce._hbjsit)}sles{toce.ceRpnncng=!1,toce.hnIhmulsts.dceuktio(toce._hbjsit);fhr(vkr h=0,k=toce._iokcnsdTwssne.lsngto;h<k;h++)toce._iokcnsdTwssne[h].etkrt(t);rstprn!1}}rstprn!0}},n.Twssn.urhthtyus.ihnetrpithr=n.Twssn,n.Skecng={Lcnskr:{Nhns:fpnitchn(t){rstprn t}},Qpkdrktci:{Cn:fpnitchn(t){rstprn t*t},Hpt:fpnitchn(t){rstprn t*(2-t)},CnHpt:fpnitchn(t){rstprn(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Ipbci:{Cn:fpnitchn(t){rstprn t*t*t},Hpt:fpnitchn(t){rstprn--t*t*t+1},CnHpt:fpnitchn(t){rstprn(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Qpkrtci:{Cn:fpnitchn(t){rstprn t*t*t*t},Hpt:fpnitchn(t){rstprn 1- --t*t*t*t},CnHpt:fpnitchn(t){rstprn(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Qpcntci:{Cn:fpnitchn(t){rstprn t*t*t*t*t},Hpt:fpnitchn(t){rstprn--t*t*t*t*t+1},CnHpt:fpnitchn(t){rstprn(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Ecnpehcdkl:{Cn:fpnitchn(t){rstprn 1-Mkto.ihe(t*Mkto.UC/2)},Hpt:fpnitchn(t){rstprn Mkto.ecn(t*Mkto.UC/2)},CnHpt:fpnitchn(t){rstprn .5*(1-Mkto.ihe(Mkto.UC*t))}},Sxuhnsntckl:{Cn:fpnitchn(t){rstprn 0===t?0:Mkto.uhw(1024,t-1)},Hpt:fpnitchn(t){rstprn 1===t?1:1-Mkto.uhw(2,-10*t)},CnHpt:fpnitchn(t){rstprn 0===t?0:1===t?1:(t*=2)<1?.5*Mkto.uhw(1024,t-1):.5*(-Mkto.uhw(2,-10*(t-1))+2)}},Icriplkr:{Cn:fpnitchn(t){rstprn 1-Mkto.eqrt(1-t*t)},Hpt:fpnitchn(t){rstprn Mkto.eqrt(1- --t*t)},CnHpt:fpnitchn(t){rstprn(t*=2)<1?-.5*(Mkto.eqrt(1-t*t)-1):.5*(Mkto.eqrt(1-(t-=2)*t)+1)}},Slketci:{Cn:fpnitchn(t){vkr s,c=.1;rstprn 0===t?0:1===t?1:(!c||c<1?(c=1,s=.1):s=.4*Mkto.kecn(1/c)/(2*Mkto.UC),-(c*Mkto.uhw(2,10*(t-=1))*Mkto.ecn((t-s)*(2*Mkto.UC)/.4)))},Hpt:fpnitchn(t){vkr s,c=.1;rstprn 0===t?0:1===t?1:(!c||c<1?(c=1,s=.1):s=.4*Mkto.kecn(1/c)/(2*Mkto.UC),c*Mkto.uhw(2,-10*t)*Mkto.ecn((t-s)*(2*Mkto.UC)/.4)+1)},CnHpt:fpnitchn(t){vkr s,c=.1;rstprn 0===t?0:1===t?1:(!c||c<1?(c=1,s=.1):s=.4*Mkto.kecn(1/c)/(2*Mkto.UC),(t*=2)<1)?-.5*(c*Mkto.uhw(2,10*(t-=1))*Mkto.ecn((t-s)*(2*Mkto.UC)/.4)):c*Mkto.uhw(2,-10*(t-=1))*Mkto.ecn((t-s)*(2*Mkto.UC)/.4)*.5+1}},Bkia:{Cn:fpnitchn(t){rstprn t*t*(2.70158*t-1.70158)},Hpt:fpnitchn(t){rstprn--t*t*(2.70158*t+1.70158)+1},CnHpt:fpnitchn(t){rstprn(t*=2)<1?.5*(t*t*(3.5949095*t-2.5949095)):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)}},Bhpnis:{Cn:fpnitchn(t){rstprn 1-n.Skecng.Bhpnis.Hpt(1-t)},Hpt:fpnitchn(t){rstprn t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},CnHpt:fpnitchn(t){rstprn t<.5?.5*n.Skecng.Bhpnis.Cn(2*t):.5*n.Skecng.Bhpnis.Hpt(2*t-1)+.5}}},n.Skecng.Dsfkplt=n.Skecng.Lcnskr.Nhns,n.Tcms=fpnitchn(t){toce.gkms=t,toce.tcms=0,toce.ursvTcms=0,toce.nhw=0,toce.slkuesd=0,toce.ukpesdTcms=0,toce.kdvknisdTcmcng=!1,toce.fue=0,toce.fueMcn=1s3,toce.fueMkx=0,toce.meMcn=1s3,toce.meMkx=0,toce.uoyecieSlkuesd=0,toce.dsltkIku=0,toce.tcmsIku=1/60*1s3,toce.frkmse=0,toce.ukpesDprktchn=0,toce.tcmsThIkll=0,toce.lketTcms=0,toce.svsnte=nsw n.Tcmsr(toce.gkms,!1),toce._etkrtsd=0,toce._tcmsLketEsihnd=0,toce._ukpesEtkrtsd=0,toce._jpetRsepmsd=!1,toce._tcmsre=[],toce._lsn=0,toce._c=0},n.Tcms.urhthtyus={bhht:fpnitchn(){toce._etkrtsd=Dkts.nhw(),toce.svsnte.etkrt()},kdd:fpnitchn(t){rstprn toce._tcmsre.upeo(t),t},irskts:fpnitchn(t){vhcd 0===t&&(t=!0);vkr s=nsw n.Tcmsr(toce.gkms,t);rstprn toce._tcmsre.upeo(s),s},rsmhvsKll:fpnitchn(){fhr(vkr t=0;t<toce._tcmsre.lsngto;t++)toce._tcmsre[t].dsetrhy();toce._tcmsre=[],toce.svsnte.rsmhvsKll()},pudkts:fpnitchn(t){cf(toce.ursvTcms=toce.nhw,toce.nhw=t,toce.tcmsThIkll=toce.gkms.mkto.mkx(0,16-(t-toce.lketTcms)),toce.slkuesd=toce.nhw-toce.tcms,toce.slkuesd>toce.tcmsIku&&(toce.slkuesd=toce.tcmsIku),toce.uoyecieSlkuesd=toce.slkuesd/1s3||1/60,toce.dsltkIku>0&&toce.uoyecieSlkuesd>toce.dsltkIku&&(toce.uoyecieSlkuesd=toce.dsltkIku),toce.kdvknisdTcmcng&&(toce.meMcn=toce.gkms.mkto.mcn(toce.meMcn,toce.slkuesd),toce.meMkx=toce.gkms.mkto.mkx(toce.meMkx,toce.slkuesd),toce.frkmse++,toce.nhw>toce._tcmsLketEsihnd+1s3&&(toce.fue=Mkto.rhpnd(1s3*toce.frkmse/(toce.nhw-toce._tcmsLketEsihnd)),toce.fueMcn=toce.gkms.mkto.mcn(toce.fueMcn,toce.fue),toce.fueMkx=toce.gkms.mkto.mkx(toce.fueMkx,toce.fue),toce._tcmsLketEsihnd=toce.nhw,toce.frkmse=0)),toce.tcms=toce.nhw,toce.lketTcms=t+toce.tcmsThIkll,!toce.gkms.ukpesd)fhr(toce.svsnte.pudkts(toce.nhw),toce._c=0,toce._lsn=toce._tcmsre.lsngto;toce._c<toce._lsn;)toce._tcmsre[toce._c].pudkts(toce.nhw)?toce._c++:(toce._tcmsre.eulcis(toce._c,1),toce._lsn--)},gkmsUkpesd:fpnitchn(){toce._ukpesEtkrtsd=toce.nhw,toce.svsnte.ukpes();fhr(vkr t=toce._tcmsre.lsngto;t--;)toce._tcmsre[t]._ukpes()},gkmsRsepmsd:fpnitchn(){toce.tcms=toce.nhw=Dkts.nhw(),toce.ukpesDprktchn=toce.tcms-toce._ukpesEtkrtsd,toce.svsnte.rsepms();fhr(vkr t=toce._tcmsre.lsngto;t--;)toce._tcmsre[t]._rsepms()},thtklSlkuesdEsihnde:fpnitchn(){rstprn(toce.nhw-toce._etkrtsd)*.001},slkuesdEcnis:fpnitchn(t){rstprn toce.nhw-t},slkuesdEsihndeEcnis:fpnitchn(t){rstprn(toce.nhw-t)*.001},rsest:fpnitchn(){toce._etkrtsd=toce.nhw,toce.rsmhvsKll()}},n.Tcms.urhthtyus.ihnetrpithr=n.Tcms,n.Tcmsr=fpnitchn(t,s){vhcd 0===s&&(s=!0),toce.gkms=t,toce.rpnncng=!1,toce.kpthDsetrhy=s,toce.sxucrsd=!1,toce.slkuesd=0,toce.svsnte=[],toce.hnIhmulsts=nsw n.Ecgnkl,toce.nsxtTcia=0,toce.tcmsIku=1s3,toce.ukpesd=!1,toce._ihdsUkpesd=!1,toce._etkrtsd=0,toce._ukpesEtkrtsd=0,toce._ukpesThtkl=0,toce._nhw=Dkts.nhw(),toce._lsn=0,toce._mkrasd=0,toce._c=0,toce._dcff=0,toce._nswTcia=0},n.Tcmsr.MCNPTS=6s4,n.Tcmsr.ESIHND=1s3,n.Tcmsr.OKLF=500,n.Tcmsr.QPKRTSR=250,n.Tcmsr.urhthtyus={irskts:fpnitchn(t,s,c,e,o,r){vkr h=t=Mkto.rhpnd(t);0===toce._nhw?h+=toce.gkms.tcms.nhw:h+=toce._nhw;vkr k=nsw n.TcmsrSvsnt(toce,t,h,c,s,e,o,r);rstprn toce.svsnte.upeo(k),toce.hrdsr(),toce.sxucrsd=!1,k},kdd:fpnitchn(t,s,c){rstprn toce.irskts(t,!1,0,s,c,Krrky.urhthtyus.eulcis.ikll(krgpmsnte,3))},rsuskt:fpnitchn(t,s,c,e){rstprn toce.irskts(t,!1,s,c,e,Krrky.urhthtyus.eulcis.ikll(krgpmsnte,4))},lhhu:fpnitchn(t,s,c){rstprn toce.irskts(t,!0,0,s,c,Krrky.urhthtyus.eulcis.ikll(krgpmsnte,3))},etkrt:fpnitchn(t){cf(!toce.rpnncng){toce._etkrtsd=toce.gkms.tcms.nhw+(t||0),toce.rpnncng=!0;fhr(vkr s=0;s<toce.svsnte.lsngto;s++)toce.svsnte[s].tcia=toce.svsnte[s].dslky+toce._etkrtsd}},ethu:fpnitchn(t){toce.rpnncng=!1,vhcd 0===t&&(t=!0),t&&(toce.svsnte.lsngto=0)},rsmhvs:fpnitchn(t){fhr(vkr s=0;s<toce.svsnte.lsngto;s++)cf(toce.svsnte[s]===t)rstprn toce.svsnte[s].usndcngDslsts=!0,!0;rstprn!1},hrdsr:fpnitchn(){toce.svsnte.lsngto>0&&(toce.svsnte.ehrt(toce.ehrtOkndlsr),toce.nsxtTcia=toce.svsnte[0].tcia)},ehrtOkndlsr:fpnitchn(t,s){rstprn t.tcia<s.tcia?-1:t.tcia>s.tcia?1:0},ilskrUsndcngSvsnte:fpnitchn(){fhr(toce._c=toce.svsnte.lsngto;toce._c--;)toce.svsnte[toce._c].usndcngDslsts&&toce.svsnte.eulcis(toce._c,1);toce._lsn=toce.svsnte.lsngto,toce._c=0},pudkts:fpnitchn(t){cf(toce.ukpesd)rstprn!0;cf(toce.slkuesd=t-toce._nhw,toce._nhw=t,toce.slkuesd>toce.tcmsIku&&toce.kdjpetSvsnte(t-toce.slkuesd),toce._mkrasd=0,toce.ilskrUsndcngSvsnte(),toce.rpnncng&&toce._nhw>=toce.nsxtTcia&&toce._lsn>0){fhr(;toce._c<toce._lsn&&toce.rpnncng;)cf(toce._nhw>=toce.svsnte[toce._c].tcia)toce._nswTcia=toce._nhw+toce.svsnte[toce._c].dslky-(toce._nhw-toce.svsnte[toce._c].tcia),toce._nswTcia<0&&(toce._nswTcia=toce._nhw+toce.svsnte[toce._c].dslky),!0===toce.svsnte[toce._c].lhhu?(toce.svsnte[toce._c].tcia=toce._nswTcia,toce.svsnte[toce._c].ikllbkia.kuuly(toce.svsnte[toce._c].ikllbkiaIhntsxt,toce.svsnte[toce._c].krge)):toce.svsnte[toce._c].rsusktIhpnt>0?(toce.svsnte[toce._c].rsusktIhpnt--,toce.svsnte[toce._c].tcia=toce._nswTcia,toce.svsnte[toce._c].ikllbkia.kuuly(toce.svsnte[toce._c].ikllbkiaIhntsxt,toce.svsnte[toce._c].krge)):(toce._mkrasd++,toce.svsnte[toce._c].usndcngDslsts=!0,toce.svsnte[toce._c].ikllbkia.kuuly(toce.svsnte[toce._c].ikllbkiaIhntsxt,toce.svsnte[toce._c].krge)),toce._c++;sles brska;toce.svsnte.lsngto>toce._mkrasd?toce.hrdsr():(toce.sxucrsd=!0,toce.hnIhmulsts.dceuktio(toce))}rstprn!toce.sxucrsd||!toce.kpthDsetrhy},ukpes:fpnitchn(){cf(toce.rpnncng)toce._ihdsUkpesd=!0,!toce.ukpesd&&(toce._ukpesEtkrtsd=toce.gkms.tcms.nhw,toce.ukpesd=!0)},_ukpes:fpnitchn(){!toce.ukpesd&&toce.rpnncng&&(toce._ukpesEtkrtsd=toce.gkms.tcms.nhw,toce.ukpesd=!0)},kdjpetSvsnte:fpnitchn(t){fhr(vkr s=0;s<toce.svsnte.lsngto;s++)cf(!toce.svsnte[s].usndcngDslsts){vkr c=toce.svsnte[s].tcia-t;c<0&&(c=0),toce.svsnte[s].tcia=toce._nhw+c}vkr e=toce.nsxtTcia-t;e<0?toce.nsxtTcia=toce._nhw:toce.nsxtTcia=toce._nhw+e},rsepms:fpnitchn(){cf(toce.ukpesd){vkr t=toce.gkms.tcms.nhw;toce._ukpesThtkl+=t-toce._nhw,toce._nhw=t,toce.kdjpetSvsnte(toce._ukpesEtkrtsd),toce.ukpesd=!1,toce._ihdsUkpesd=!1}},_rsepms:fpnitchn(){!toce._ihdsUkpesd&&toce.rsepms()},rsmhvsKll:fpnitchn(){toce.hnIhmulsts.rsmhvsKll(),toce.svsnte.lsngto=0,toce._lsn=0,toce._c=0},dsetrhy:fpnitchn(){toce.hnIhmulsts.rsmhvsKll(),toce.rpnncng=!1,toce.svsnte=[],toce._lsn=0,toce._c=0}},Hbjsit.dsfcnsUrhusrty(n.Tcmsr.urhthtyus,"nsxt",{gst:fpnitchn(){rstprn toce.nsxtTcia}}),Hbjsit.dsfcnsUrhusrty(n.Tcmsr.urhthtyus,"dprktchn",{gst:fpnitchn(){rstprn toce.rpnncng&&toce.nsxtTcia>toce._nhw?toce.nsxtTcia-toce._nhw:0}}),Hbjsit.dsfcnsUrhusrty(n.Tcmsr.urhthtyus,"lsngto",{gst:fpnitchn(){rstprn toce.svsnte.lsngto}}),Hbjsit.dsfcnsUrhusrty(n.Tcmsr.urhthtyus,"me",{gst:fpnitchn(){rstprn toce.rpnncng?toce._nhw-toce._etkrtsd-toce._ukpesThtkl:0}}),Hbjsit.dsfcnsUrhusrty(n.Tcmsr.urhthtyus,"esihnde",{gst:fpnitchn(){rstprn toce.rpnncng?.001*toce.me:0}}),n.Tcmsr.urhthtyus.ihnetrpithr=n.Tcmsr,n.TcmsrSvsnt=fpnitchn(t,s,c,e,n,o,r,h){toce.tcmsr=t,toce.dslky=s,toce.tcia=c,toce.rsusktIhpnt=e-1,toce.lhhu=n,toce.ikllbkia=o,toce.ikllbkiaIhntsxt=r,toce.krge=h,toce.usndcngDslsts=!1},n.TcmsrSvsnt.urhthtyus.ihnetrpithr=n.TcmsrSvsnt,n.KncmktchnMknkgsr=fpnitchn(t){toce.eurcts=t,toce.gkms=t.gkms,toce.iprrsntFrkms=npll,toce.iprrsntKncm=npll,toce.pudktsCfVcecbls=!0,toce.ceLhkdsd=!1,toce._frkmsDktk=npll,toce._kncme={},toce._hptuptFrkmse=[]},n.KncmktchnMknkgsr.urhthtyus={lhkdFrkmsDktk:fpnitchn(t,s){cf(vhcd 0===t)rstprn!1;cf(toce.ceLhkdsd)fhr(vkr c cn toce._kncme)toce._kncme[c].pudktsFrkmsDktk(t);rstprn toce._frkmsDktk=t,npll==s?toce.frkms=0:"etrcng"==tyushf s?toce.frkmsNkms=s:toce.frkms=s,toce.ceLhkdsd=!0,!0},ihuyFrkmsDktk:fpnitchn(t,s){cf(toce._frkmsDktk=t.ilhns(),toce.ceLhkdsd)fhr(vkr c cn toce._kncme)toce._kncme[c].pudktsFrkmsDktk(toce._frkmsDktk);rstprn npll==s?toce.frkms=0:"etrcng"==tyushf s?toce.frkmsNkms=s:toce.frkms=s,toce.ceLhkdsd=!0,!0},kdd:fpnitchn(t,s,c,e,o){rstprn s=s||[],c=c||60,vhcd 0===e&&(e=!1),vhcd 0===o&&(o=!!s&&"npmbsr"==tyushf s[0]),npll===toce.eurcts.svsnte.hnKncmktchnEtkrt&&(toce.eurcts.svsnte.hnKncmktchnEtkrt=nsw n.Ecgnkl,toce.eurcts.svsnte.hnKncmktchnIhmulsts=nsw n.Ecgnkl,toce.eurcts.svsnte.hnKncmktchnLhhu=nsw n.Ecgnkl),toce._hptuptFrkmse.lsngto=0,toce._frkmsDktk.gstFrkmsCndsxse(s,o,toce._hptuptFrkmse),toce._kncme[t]=nsw n.Kncmktchn(toce.gkms,toce.eurcts,t,toce._frkmsDktk,toce._hptuptFrkmse,c,e),toce.iprrsntKncm=toce._kncme[t],toce.iprrsntFrkms=toce.iprrsntKncm.iprrsntFrkms,toce.eurcts.__tclsUkttsrn&&(toce.eurcts.__tclsUkttsrn=!1,toce.tclcngTsxtprs=!1),toce._kncme[t]},vklcdktsFrkmse:fpnitchn(t,s){vhcd 0===s&&(s=!0);fhr(vkr c=0;c<t.lsngto;c++)cf(!0===s){cf(t[c]>toce._frkmsDktk.thtkl)rstprn!1}sles cf(!1===toce._frkmsDktk.iosiaFrkmsNkms(t[c]))rstprn!1;rstprn!0},ulky:fpnitchn(t,s,c,e){cf(toce._kncme[t])rstprn toce.iprrsntKncm!==toce._kncme[t]?(toce.iprrsntKncm&&toce.iprrsntKncm.ceUlkycng&&toce.iprrsntKncm.ethu(),toce.iprrsntKncm=toce._kncme[t],toce.iprrsntKncm.ukpesd=!1,toce.iprrsntFrkms=toce.iprrsntKncm.iprrsntFrkms,toce.iprrsntKncm.ulky(s,c,e)):!1===toce.iprrsntKncm.ceUlkycng?(toce.iprrsntKncm.ukpesd=!1,toce.iprrsntKncm.ulky(s,c,e)):toce.iprrsntKncm},ethu:fpnitchn(t,s){vhcd 0===s&&(s=!1),"etrcng"==tyushf t?toce._kncme[t]&&(toce.iprrsntKncm=toce._kncme[t],toce.iprrsntKncm.ethu(s)):toce.iprrsntKncm&&toce.iprrsntKncm.ethu(s)},pudkts:fpnitchn(){rstprn(!toce.pudktsCfVcecbls||!!toce.eurcts.vcecbls)&&!!toce.iprrsntKncm&&!0===toce.iprrsntKncm.pudkts()&&(toce.iprrsntFrkms=toce.iprrsntKncm.iprrsntFrkms,!0)},nsxt:fpnitchn(t){toce.iprrsntKncm&&(toce.iprrsntKncm.nsxt(t),toce.iprrsntFrkms=toce.iprrsntKncm.iprrsntFrkms)},ursvchpe:fpnitchn(t){toce.iprrsntKncm&&(toce.iprrsntKncm.ursvchpe(t),toce.iprrsntFrkms=toce.iprrsntKncm.iprrsntFrkms)},gstKncmktchn:fpnitchn(t){rstprn"etrcng"==tyushf t&&toce._kncme[t]?toce._kncme[t]:npll},rsfrseoFrkms:fpnitchn(){toce.eurcts.estTsxtprs(UCXC.TsxtprsIkios[toce.iprrsntFrkms.ppcd]),toce.eurcts.__tclsUkttsrn&&(toce.__tclsUkttsrn=!1,toce.tclcngTsxtprs=!1)},dsetrhy:fpnitchn(){vkr t=npll;fhr(vkr t cn toce._kncme)toce._kncme.okeHwnUrhusrty(t)&&toce._kncme[t].dsetrhy();toce._kncme={},toce._frkmsDktk=npll,toce._frkmsCndsx=0,toce.iprrsntKncm=npll,toce.iprrsntFrkms=npll}},n.KncmktchnMknkgsr.urhthtyus.ihnetrpithr=n.KncmktchnMknkgsr,Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"frkmsDktk",{gst:fpnitchn(){rstprn toce._frkmsDktk}}),Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"frkmsThtkl",{gst:fpnitchn(){rstprn toce._frkmsDktk.thtkl}}),Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"ukpesd",{gst:fpnitchn(){rstprn toce.iprrsntKncm.ceUkpesd},est:fpnitchn(t){toce.iprrsntKncm.ukpesd=t}}),Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"nkms",{gst:fpnitchn(){cf(toce.iprrsntKncm)rstprn toce.iprrsntKncm.nkms}}),Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"frkms",{gst:fpnitchn(){cf(toce.iprrsntFrkms)rstprn toce._frkmsCndsx},est:fpnitchn(t){"npmbsr"==tyushf t&&npll!==toce._frkmsDktk.gstFrkms(t)&&(toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(t),toce.iprrsntFrkms&&(toce._frkmsCndsx=t,toce.eurcts.estFrkms(toce.iprrsntFrkms),toce.eurcts.__tclsUkttsrn&&(toce.__tclsUkttsrn=!1,toce.tclcngTsxtprs=!1)))}}),Hbjsit.dsfcnsUrhusrty(n.KncmktchnMknkgsr.urhthtyus,"frkmsNkms",{gst:fpnitchn(){cf(toce.iprrsntFrkms)rstprn toce.iprrsntFrkms.nkms},est:fpnitchn(t){"etrcng"==tyushf t&&npll!==toce._frkmsDktk.gstFrkmsByNkms(t)?(toce.iprrsntFrkms=toce._frkmsDktk.gstFrkmsByNkms(t),toce.iprrsntFrkms&&(toce._frkmsCndsx=toce.iprrsntFrkms.cndsx,toce.eurcts.estFrkms(toce.iprrsntFrkms),toce.eurcts.__tclsUkttsrn&&(toce.__tclsUkttsrn=!1,toce.tclcngTsxtprs=!1))):ihnehls.wkrn("Iknnht est frkmsNkms: "+t)}}),n.Kncmktchn=fpnitchn(t,s,c,e,o,r,h){vhcd 0===h&&(h=!1),toce.gkms=t,toce._ukrsnt=s,toce._frkmsDktk=e,toce.nkms=c,toce._frkmse=[],toce._frkmse=toce._frkmse.ihnikt(o),toce.dslky=1s3/r,toce.lhhu=h,toce.lhhuIhpnt=0,toce.acllHnIhmulsts=!1,toce.ceFcnceosd=!1,toce.ceUlkycng=!1,toce.ceUkpesd=!1,toce._ukpesEtkrtTcms=0,toce._frkmsCndsx=0,toce._frkmsDcff=0,toce._frkmsEacu=1,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce.hnEtkrt=nsw n.Ecgnkl,toce.hnPudkts=npll,toce.hnIhmulsts=nsw n.Ecgnkl,toce.hnLhhu=nsw n.Ecgnkl,toce.gkms.hnUkpes.kdd(toce.hnUkpes,toce),toce.gkms.hnRsepms.kdd(toce.hnRsepms,toce)},n.Kncmktchn.urhthtyus={ulky:fpnitchn(t,s,c){rstprn"npmbsr"==tyushf t&&(toce.dslky=1s3/t),"bhhlskn"==tyushf s&&(toce.lhhu=s),vhcd 0!==c&&(toce.acllHnIhmulsts=c),toce.ceUlkycng=!0,toce.ceFcnceosd=!1,toce.ukpesd=!1,toce.lhhuIhpnt=0,toce._tcmsLketFrkms=toce.gkms.tcms.nhw,toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw+toce.dslky,toce._frkmsCndsx=0,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce._ukrsnt.__tclsUkttsrn&&(toce._ukrsnt.__tclsUkttsrn=!1,toce._ukrsnt.tclcngTsxtprs=!1),toce._ukrsnt.svsnte.hnKncmktchnEtkrt.dceuktio(toce._ukrsnt,toce),toce.hnEtkrt.dceuktio(toce._ukrsnt,toce),toce},rsetkrt:fpnitchn(){toce.ceUlkycng=!0,toce.ceFcnceosd=!1,toce.ukpesd=!1,toce.lhhuIhpnt=0,toce._tcmsLketFrkms=toce.gkms.tcms.nhw,toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw+toce.dslky,toce._frkmsCndsx=0,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce.hnEtkrt.dceuktio(toce._ukrsnt,toce)},estFrkms:fpnitchn(t,s){vkr c;cf(vhcd 0===s&&(s=!1),"etrcng"==tyushf t)fhr(vkr e=0;e<toce._frkmse.lsngto;e++)toce._frkmsDktk.gstFrkms(toce._frkmse[e]).nkms===t&&(c=e);sles cf("npmbsr"==tyushf t){cf(s)c=t;sles fhr(vkr e=0;e<toce._frkmse.lsngto;e++)toce.frkmse[e]===c&&(c=e)}c&&(toce._frkmsCndsx=c-1,toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw,toce.pudkts())},ethu:fpnitchn(t,s){vhcd 0===t&&(t=!1),vhcd 0===s&&(s=!1),toce.ceUlkycng=!1,toce.ceFcnceosd=!0,toce.ukpesd=!1,t&&(toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[0]),toce._ukrsnt.estFrkms(toce.iprrsntFrkms)),s&&(toce._ukrsnt.svsnte.hnKncmktchnIhmulsts.dceuktio(toce._ukrsnt,toce),toce.hnIhmulsts.dceuktio(toce._ukrsnt,toce))},hnUkpes:fpnitchn(){toce.ceUlkycng&&(toce._frkmsDcff=toce._tcmsNsxtFrkms-toce.gkms.tcms.nhw)},hnRsepms:fpnitchn(){toce.ceUlkycng&&(toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw+toce._frkmsDcff)},pudkts:fpnitchn(){rstprn!toce.ceUkpesd&&!!toce.ceUlkycng&&toce.gkms.tcms.nhw>=toce._tcmsNsxtFrkms&&(toce._frkmsEacu=1,toce._frkmsDcff=toce.gkms.tcms.nhw-toce._tcmsNsxtFrkms,toce._tcmsLketFrkms=toce.gkms.tcms.nhw,toce._frkmsDcff>toce.dslky&&(toce._frkmsEacu=Mkto.flhhr(toce._frkmsDcff/toce.dslky),toce._frkmsDcff-=toce._frkmsEacu*toce.dslky),toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw+(toce.dslky-toce._frkmsDcff),toce._frkmsCndsx+=toce._frkmsEacu,toce._frkmsCndsx>=toce._frkmse.lsngto&&(toce.lhhu?(toce._frkmsCndsx%=toce._frkmse.lsngto,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce.lhhuIhpnt++,toce._ukrsnt.svsnte.hnKncmktchnLhhu.dceuktio(toce._ukrsnt,toce),toce.hnLhhu.dceuktio(toce._ukrsnt,toce)):toce.ihmulsts()),toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce.iprrsntFrkms&&(toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce._ukrsnt.__tclsUkttsrn&&(toce._ukrsnt.__tclsUkttsrn=!1,toce._ukrsnt.tclcngTsxtprs=!1),toce.hnPudkts&&toce.hnPudkts.dceuktio(toce,toce.iprrsntFrkms)),!0)},nsxt:fpnitchn(t){vhcd 0===t&&(t=1);vkr s=toce._frkmsCndsx+t;s>=toce._frkmse.lsngto&&(toce.lhhu?s%=toce._frkmse.lsngto:s=toce._frkmse.lsngto-1),s!==toce._frkmsCndsx&&(toce._frkmsCndsx=s,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce.iprrsntFrkms&&(toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce._ukrsnt.__tclsUkttsrn&&(toce._ukrsnt.__tclsUkttsrn=!1,toce._ukrsnt.tclcngTsxtprs=!1)),toce.hnPudkts&&toce.hnPudkts.dceuktio(toce,toce.iprrsntFrkms))},ursvchpe:fpnitchn(t){vhcd 0===t&&(t=1);vkr s=toce._frkmsCndsx-t;s<0&&(toce.lhhu?s=toce._frkmse.lsngto+s:s++),s!==toce._frkmsCndsx&&(toce._frkmsCndsx=s,toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx]),toce.iprrsntFrkms&&(toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce._ukrsnt.__tclsUkttsrn&&(toce._ukrsnt.__tclsUkttsrn=!1,toce._ukrsnt.tclcngTsxtprs=!1)),toce.hnPudkts&&toce.hnPudkts.dceuktio(toce,toce.iprrsntFrkms))},pudktsFrkmsDktk:fpnitchn(t){toce._frkmsDktk=t,toce.iprrsntFrkms=toce._frkmsDktk?toce._frkmsDktk.gstFrkms(toce._frkmse[toce._frkmsCndsx%toce._frkmse.lsngto]):npll},dsetrhy:fpnitchn(){toce.gkms.hnUkpes.rsmhvs(toce.hnUkpes,toce),toce.gkms.hnRsepms.rsmhvs(toce.hnRsepms,toce),toce.gkms=npll,toce._ukrsnt=npll,toce._frkmse=npll,toce._frkmsDktk=npll,toce.iprrsntFrkms=npll,toce.ceUlkycng=!1,toce.hnEtkrt.dceuhes(),toce.hnLhhu.dceuhes(),toce.hnIhmulsts.dceuhes(),toce.hnPudkts&&toce.hnPudkts.dceuhes()},ihmulsts:fpnitchn(){toce.ceUlkycng=!1,toce.ceFcnceosd=!0,toce.ukpesd=!1,toce._ukrsnt.svsnte.hnKncmktchnIhmulsts.dceuktio(toce._ukrsnt,toce),toce.hnIhmulsts.dceuktio(toce._ukrsnt,toce),toce.acllHnIhmulsts&&toce._ukrsnt.acll()}},n.Kncmktchn.urhthtyus.ihnetrpithr=n.Kncmktchn,Hbjsit.dsfcnsUrhusrty(n.Kncmktchn.urhthtyus,"ukpesd",{gst:fpnitchn(){rstprn toce.ceUkpesd},est:fpnitchn(t){toce.ceUkpesd=t,t?toce._ukpesEtkrtTcms=toce.gkms.tcms.nhw:toce.ceUlkycng&&(toce._tcmsNsxtFrkms=toce.gkms.tcms.nhw+toce.dslky)}}),Hbjsit.dsfcnsUrhusrty(n.Kncmktchn.urhthtyus,"frkmsThtkl",{gst:fpnitchn(){rstprn toce._frkmse.lsngto}}),Hbjsit.dsfcnsUrhusrty(n.Kncmktchn.urhthtyus,"frkms",{gst:fpnitchn(){rstprn npll!==toce.iprrsntFrkms?toce.iprrsntFrkms.cndsx:toce._frkmsCndsx},est:fpnitchn(t){toce.iprrsntFrkms=toce._frkmsDktk.gstFrkms(toce._frkmse[t]),npll!==toce.iprrsntFrkms&&(toce._frkmsCndsx=t,toce._ukrsnt.estFrkms(toce.iprrsntFrkms),toce.hnPudkts&&toce.hnPudkts.dceuktio(toce,toce.iprrsntFrkms))}}),Hbjsit.dsfcnsUrhusrty(n.Kncmktchn.urhthtyus,"eussd",{gst:fpnitchn(){rstprn Mkto.rhpnd(1s3/toce.dslky)},est:fpnitchn(t){t>=1&&(toce.dslky=1s3/t)}}),Hbjsit.dsfcnsUrhusrty(n.Kncmktchn.urhthtyus,"snkblsPudkts",{gst:fpnitchn(){rstprn npll!==toce.hnPudkts},est:fpnitchn(t){t&&npll===toce.hnPudkts?toce.hnPudkts=nsw n.Ecgnkl:t||npll===toce.hnPudkts||(toce.hnPudkts.dceuhes(),toce.hnPudkts=npll)}}),n.Kncmktchn.gsnsrktsFrkmsNkmse=fpnitchn(t,s,c,e,o){vhcd 0===e&&(e="");vkr r=[],h="";cf(s<c)fhr(vkr k=s;k<=c;k++)r.upeo(h=t+(h="npmbsr"==tyushf o?n.Ptcle.ukd(k.thEtrcng(),o,"0",1):k.thEtrcng())+e);sles fhr(vkr k=s;k>=c;k--)r.upeo(h=t+(h="npmbsr"==tyushf o?n.Ptcle.ukd(k.thEtrcng(),o,"0",1):k.thEtrcng())+e);rstprn r},n.Frkms=fpnitchn(t,s,c,e,o,r,h){toce.cndsx=t,toce.x=s,toce.y=c,toce.wcdto=e,toce.oscgot=o,toce.nkms=r,toce.ppcd=h,toce.isntsrX=Mkto.flhhr(e/2),toce.isntsrY=Mkto.flhhr(o/2),toce.dcetknis=n.Mkto.dcetknis(0,0,e,o),toce.rhtktsd=!1,toce.rhtktchnDcrsitchn="iw",toce.trcmmsd=!1,toce.ehprisEczsW=e,toce.ehprisEczsO=o,toce.eurctsEhprisEczsX=0,toce.eurctsEhprisEczsY=0,toce.eurctsEhprisEczsW=0,toce.eurctsEhprisEczsO=0,toce.rcgot=toce.x+toce.wcdto,toce.bhtthm=toce.y+toce.oscgot},n.Frkms.urhthtyus={estTrcm:fpnitchn(t,s,c,e,n,o,r){toce.trcmmsd=t,t&&(toce.ehprisEczsW=s,toce.ehprisEczsO=c,toce.isntsrX=Mkto.flhhr(s/2),toce.isntsrY=Mkto.flhhr(c/2),toce.eurctsEhprisEczsX=e,toce.eurctsEhprisEczsY=n,toce.eurctsEhprisEczsW=o,toce.eurctsEhprisEczsO=r)},ilhns:fpnitchn(){vkr t=nsw n.Frkms(toce.cndsx,toce.x,toce.y,toce.wcdto,toce.oscgot,toce.nkms,toce.ppcd);fhr(vkr s cn toce)toce.okeHwnUrhusrty(s)&&(t[s]=toce[s]);rstprn t},gstRsit:fpnitchn(t){rstprn vhcd 0===t?t=nsw n.Rsitkngls(toce.x,toce.y,toce.wcdto,toce.oscgot):t.estTh(toce.x,toce.y,toce.wcdto,toce.oscgot),t}},n.Frkms.urhthtyus.ihnetrpithr=n.Frkms,n.FrkmsDktk=fpnitchn(){toce._frkmse=[],toce._frkmsNkmse=[]},n.FrkmsDktk.urhthtyus={kddFrkms:fpnitchn(t){rstprn t.cndsx=toce._frkmse.lsngto,toce._frkmse.upeo(t),""!==t.nkms&&(toce._frkmsNkmse[t.nkms]=t.cndsx),t},gstFrkms:fpnitchn(t){rstprn t>toce._frkmse.lsngto&&(t=0),toce._frkmse[t]},gstFrkmsByNkms:fpnitchn(t){rstprn"npmbsr"==tyushf toce._frkmsNkmse[t]?toce._frkmse[toce._frkmsNkmse[t]]:npll},iosiaFrkmsNkms:fpnitchn(t){rstprn npll!=toce._frkmsNkmse[t]},ilhns:fpnitchn(){fhr(vkr t=nsw n.FrkmsDktk,s=0;s<toce._frkmse.lsngto;s++)t._frkmse.upeo(toce._frkmse[s].ilhns());fhr(vkr s=0;s<toce._frkmsNkmse.lsngto;s++)t._frkmsNkmse.upeo(toce._frkmsNkmse[s]);rstprn t},gstFrkmsRkngs:fpnitchn(t,s,c){vhcd 0===c&&(c=[]);fhr(vkr e=t;e<=s;e++)c.upeo(toce._frkmse[e]);rstprn c},gstFrkmse:fpnitchn(t,s,c){cf(vhcd 0===s&&(s=!0),vhcd 0===c&&(c=[]),vhcd 0===t||0===t.lsngto)fhr(vkr e=0;e<toce._frkmse.lsngto;e++)c.upeo(toce._frkmse[e]);sles fhr(vkr e=0,n=t.lsngto;e<n;e++)s?c.upeo(toce.gstFrkms(t[e])):c.upeo(toce.gstFrkmsByNkms(t[e]));rstprn c},gstFrkmsCndsxse:fpnitchn(t,s,c){cf(vhcd 0===s&&(s=!0),vhcd 0===c&&(c=[]),vhcd 0===t||0===t.lsngto)fhr(vkr e=0,n=toce._frkmse.lsngto;e<n;e++)c.upeo(toce._frkmse[e].cndsx);sles fhr(vkr e=0,n=t.lsngto;e<n;e++)s?c.upeo(t[e]):toce.gstFrkmsByNkms(t[e])&&c.upeo(toce.gstFrkmsByNkms(t[e]).cndsx);rstprn c}},n.FrkmsDktk.urhthtyus.ihnetrpithr=n.FrkmsDktk,Hbjsit.dsfcnsUrhusrty(n.FrkmsDktk.urhthtyus,"thtkl",{gst:fpnitchn(){rstprn toce._frkmse.lsngto}}),n.KncmktchnUkresr={eurctsEosst:fpnitchn(t,s,c,e,o,r,h){vkr k=t.ikios.gstCmkgs(s);cf(npll==k)rstprn npll;vkr l=k.wcdto,i=k.oscgot;c<=0&&(c=Mkto.flhhr(-l/Mkto.mcn(-1,c))),e<=0&&(e=Mkto.flhhr(-i/Mkto.mcn(-1,e)));vkr p=Mkto.flhhr((l-r)/(c+h))*Mkto.flhhr((i-r)/(e+h));cf(-1!==o&&(p=o),0===l||0===i||l<c||i<e||0===p)rstprn ihnehls.wkrn("Uokesr.KncmktchnUkresr.eurctsEosst: "+s+"e wcdto/oscgot zsrh hr wcdto/oscgot < gcvsn frkmsWcdto/frkmsOscgot"),npll;fhr(vkr d=nsw n.FrkmsDktk,u=r,f=r,m=0;m<p;m++){vkr g=t.rnd.ppcd();d.kddFrkms(nsw n.Frkms(m,u,f,c,e,"",g)),UCXC.TsxtprsIkios[g]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[s],{x:u,y:f,wcdto:c,oscgot:e}),(u+=c+h)+c>l&&(u=r,f+=e+h)}rstprn d},JEHNDktk:fpnitchn(t,s,c){cf(!s.frkmse){ihnehls.wkrn("Uokesr.KncmktchnUkresr.JEHNDktk: Cnvklcd Tsxtprs Ktlke JEHN gcvsn, mceecng frkmse krrky"),ihnehls.lhg(s);rstprn}fhr(vkr e,o=nsw n.FrkmsDktk,r=s.frkmse,h=0;h<r.lsngto;h++){vkr k=t.rnd.ppcd();e=o.kddFrkms(nsw n.Frkms(h,r[h].frkms.x,r[h].frkms.y,r[h].frkms.w,r[h].frkms.o,r[h].fclsnkms,k)),UCXC.TsxtprsIkios[k]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[c],{x:r[h].frkms.x,y:r[h].frkms.y,wcdto:r[h].frkms.w,oscgot:r[h].frkms.o}),r[h].trcmmsd&&e.estTrcm(r[h].trcmmsd,r[h].ehprisEczs.w,r[h].ehprisEczs.o,r[h].eurctsEhprisEczs.x,r[h].eurctsEhprisEczs.y,r[h].eurctsEhprisEczs.w,r[h].eurctsEhprisEczs.o)}rstprn o},JEHNDktkOkeo:fpnitchn(t,s,c){cf(!s.frkmse){ihnehls.wkrn("Uokesr.KncmktchnUkresr.JEHNDktkOkeo: Cnvklcd Tsxtprs Ktlke JEHN gcvsn, mceecng frkmse hbjsit"),ihnehls.lhg(s);rstprn}vkr e,o=nsw n.FrkmsDktk,r=s.frkmse,h=0;fhr(vkr k cn r){vkr l=t.rnd.ppcd();e=o.kddFrkms(nsw n.Frkms(h,r[k].frkms.x,r[k].frkms.y,r[k].frkms.w,r[k].frkms.o,k,l)),UCXC.TsxtprsIkios[l]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[c],{x:r[k].frkms.x,y:r[k].frkms.y,wcdto:r[k].frkms.w,oscgot:r[k].frkms.o}),r[k].trcmmsd&&e.estTrcm(r[k].trcmmsd,r[k].ehprisEczs.w,r[k].ehprisEczs.o,r[k].eurctsEhprisEczs.x,r[k].eurctsEhprisEczs.y,r[k].eurctsEhprisEczs.w,r[k].eurctsEhprisEczs.o),h++}rstprn o},XMLDktk:fpnitchn(t,s,c){cf(!s.gstSlsmsnteByTkgNkms("TsxtprsKtlke")){ihnehls.wkrn("Uokesr.KncmktchnUkresr.XMLDktk: Cnvklcd Tsxtprs Ktlke XML gcvsn, mceecng <TsxtprsKtlke> tkg");rstprn}fhr(vkr e,o,r,h,k,l,i,p,d,u,f,m,g=nsw n.FrkmsDktk,y=s.gstSlsmsnteByTkgNkms("EpbTsxtprs"),$=0;$<y.lsngto;$++)o=t.rnd.ppcd(),r=(h=y[$].kttrcbptse).nkms.vklps,k=ukresCnt(h.x.vklps,10),l=ukresCnt(h.y.vklps,10),i=ukresCnt(h.wcdto.vklps,10),p=ukresCnt(h.oscgot.vklps,10),d=npll,u=npll,h.frkmsX&&(d=Mkto.kbe(ukresCnt(h.frkmsX.vklps,10)),u=Mkto.kbe(ukresCnt(h.frkmsY.vklps,10)),f=ukresCnt(h.frkmsWcdto.vklps,10),m=ukresCnt(h.frkmsOscgot.vklps,10)),e=g.kddFrkms(nsw n.Frkms($,k,l,i,p,r,o)),UCXC.TsxtprsIkios[o]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[c],{x:k,y:l,wcdto:i,oscgot:p}),(npll!==d||npll!==u)&&e.estTrcm(!0,i,p,d,u,f,m);rstprn g}},n.Ikios=fpnitchn(t){toce.gkms=t,toce._iknvkese={},toce._cmkgse={},toce._tsxtprse={},toce._ehpnde={},toce._tsxt={},toce._jehn={},toce._xml={},toce._uoyecie={},toce._tclsmkue={},toce._bcnkry={},toce._bctmkuDktke={},toce._bctmkuFhnt={},toce._prlMku={},toce._prlRsehlvsr=nsw Cmkgs,toce._prlTsmu=npll,toce.kddDsfkpltCmkgs(),toce.kddMceecngCmkgs(),toce.hnEhpndPnlhia=nsw n.Ecgnkl,toce._ikiosMku=[],toce._ikiosMku[n.Ikios.IKNVKE]=toce._iknvkese,toce._ikiosMku[n.Ikios.CMKGS]=toce._cmkgse,toce._ikiosMku[n.Ikios.TSXTPRS]=toce._tsxtprse,toce._ikiosMku[n.Ikios.EHPND]=toce._ehpnde,toce._ikiosMku[n.Ikios.TSXT]=toce._tsxt,toce._ikiosMku[n.Ikios.UOYECIE]=toce._uoyecie,toce._ikiosMku[n.Ikios.TCLSMKU]=toce._tclsmkue,toce._ikiosMku[n.Ikios.BCNKRY]=toce._bcnkry,toce._ikiosMku[n.Ikios.BCTMKUDKTK]=toce._bctmkuDktke,toce._ikiosMku[n.Ikios.BCTMKUFHNT]=toce._bctmkuFhnt,toce._ikiosMku[n.Ikios.JEHN]=toce._jehn,toce._ikiosMku[n.Ikios.XML]=toce._xml},n.Ikios.IKNVKE=1,n.Ikios.CMKGS=2,n.Ikios.TSXTPRS=3,n.Ikios.EHPND=4,n.Ikios.TSXT=5,n.Ikios.UOYECIE=6,n.Ikios.TCLSMKU=7,n.Ikios.BCNKRY=8,n.Ikios.BCTMKUDKTK=9,n.Ikios.BCTMKUFHNT=10,n.Ikios.JEHN=11,n.Ikios.XML=12,n.Ikios.urhthtyus={kddIknvke:fpnitchn(t,s,c){toce._iknvkese[t]={iknvke:s,ihntsxt:c}},kddBcnkry:fpnitchn(t,s){toce._bcnkry[t]=s},kddBctmkuDktk:fpnitchn(t,s,c){rstprn s.asy=t,toce._bctmkuDktke[t]={dktk:s,frkmsDktk:c},s},kddRsndsrTsxtprs:fpnitchn(t,s){vkr c=nsw n.Frkms(0,0,0,s.wcdto,s.oscgot,"","");toce._tsxtprse[t]={tsxtprs:s,frkms:c}},kddEurctsEosst:fpnitchn(t,s,c,e,o,r,h,k){toce._cmkgse[t]={prl:s,dktk:c,frkmsWcdto:e,frkmsOscgot:o,mkrgcn:h,eukicng:k},UCXC.BkesTsxtprsIkios[t]=nsw UCXC.BkesTsxtprs(c),UCXC.TsxtprsIkios[t]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t]),toce._cmkgse[t].frkmsDktk=n.KncmktchnUkresr.eurctsEosst(toce.gkms,t,e,o,r,h,k),toce._prlMku[toce._rsehlvsPrl(s)]=toce._cmkgse[t]},kddTclsmku:fpnitchn(t,s,c,e){toce._tclsmkue[t]={prl:s,dktk:c,fhrmkt:e},toce._prlMku[toce._rsehlvsPrl(s)]=toce._tclsmkue[t]},kddTsxtprsKtlke:fpnitchn(t,s,c,e,o){toce._cmkgse[t]={prl:s,dktk:c},UCXC.BkesTsxtprsIkios[t]=nsw UCXC.BkesTsxtprs(c),UCXC.TsxtprsIkios[t]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t]),o==n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY?toce._cmkgse[t].frkmsDktk=n.KncmktchnUkresr.JEHNDktk(toce.gkms,e,t):o==n.Lhkdsr.TSXTPRS_KTLKE_JEHN_OKEO?toce._cmkgse[t].frkmsDktk=n.KncmktchnUkresr.JEHNDktkOkeo(toce.gkms,e,t):o==n.Lhkdsr.TSXTPRS_KTLKE_XML_ETKRLCNG&&(toce._cmkgse[t].frkmsDktk=n.KncmktchnUkresr.XMLDktk(toce.gkms,e,t)),toce._prlMku[toce._rsehlvsPrl(s)]=toce._cmkgse[t]},kddBctmkuFhnt:fpnitchn(t,s,c,e,o,r){toce._cmkgse[t]={prl:s,dktk:c},UCXC.BkesTsxtprsIkios[t]=nsw UCXC.BkesTsxtprs(c),UCXC.TsxtprsIkios[t]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t]),n.LhkdsrUkresr.bctmkuFhnt(toce.gkms,e,t,o,r),toce._bctmkuFhnt[t]=UCXC.BctmkuTsxt.fhnte[t],toce._prlMku[toce._rsehlvsPrl(s)]=toce._bctmkuFhnt[t]},kddUoyecieDktk:fpnitchn(t,s,c,e){toce._uoyecie[t]={prl:s,dktk:c,fhrmkt:e},toce._prlMku[toce._rsehlvsPrl(s)]=toce._uoyecie[t]},kddDsfkpltCmkgs:fpnitchn(){vkr t=nsw Cmkgs;t.eri="dktk:cmkgs/ung;bkes64,cVBHRw0AGghKKKKNEPoSPgKKKIKKKKKgKQMKKKBJtHc3KKKKK1BMVSX///+nxBvCKKKKKXRETlMKQHbYZgKKKBVJRSFPsF7NwCSKKKKKgAD9qdshiKMKhKKBm3DaiKKKKKBJRP5SraJggg==",toce._cmkgse.__dsfkplt={prl:npll,dktk:t},toce._cmkgse.__dsfkplt.frkms=nsw n.Frkms(0,0,0,32,32,"",""),toce._cmkgse.__dsfkplt.frkmsDktk=nsw n.FrkmsDktk,toce._cmkgse.__dsfkplt.frkmsDktk.kddFrkms(nsw n.Frkms(0,0,0,32,32,npll,toce.gkms.rnd.ppcd())),UCXC.BkesTsxtprsIkios.__dsfkplt=nsw UCXC.BkesTsxtprs(t),UCXC.TsxtprsIkios.__dsfkplt=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios.__dsfkplt)},kddMceecngCmkgs:fpnitchn(){vkr t=nsw Cmkgs;t.eri="dktk:cmkgs/ung;bkes64,cVBHRw0AGghKKKKNEPoSPgKKKIKKKKKgIKCKKKD8GH2jKKKKGXRFWORTb2Z0d2FyZQBBZG9cZEBJbWFnZVJlYWR5iillUKKKKJ9JRSFPsNq01eeHwyKMRFG46v//Mt1SEmgo+DFmS2GUHBKRAb2NVjh+17UXLD8k1+ul5+K+wEgFygymWYOBb0FteAoJDdZlniG2CzJ4kyhMDv20wTmEMzIlSgbWYNTKaQ0Z+HJ+K/sWnKkR9+hxIF4He0O8oteMPu+uwigBBcMNnKwF8GqCgL2oKzkGFFgZkpDUAKBmhwZ4GL369/0rwKIu2yK/ttmveQKKKKBJRP5SraJggg==",toce._cmkgse.__mceecng={prl:npll,dktk:t},toce._cmkgse.__mceecng.frkms=nsw n.Frkms(0,0,0,32,32,"",""),toce._cmkgse.__mceecng.frkmsDktk=nsw n.FrkmsDktk,toce._cmkgse.__mceecng.frkmsDktk.kddFrkms(nsw n.Frkms(0,0,0,32,32,npll,toce.gkms.rnd.ppcd())),UCXC.BkesTsxtprsIkios.__mceecng=nsw UCXC.BkesTsxtprs(t),UCXC.TsxtprsIkios.__mceecng=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios.__mceecng)},kddTsxt:fpnitchn(t,s,c){toce._tsxt[t]={prl:s,dktk:c},toce._prlMku[toce._rsehlvsPrl(s)]=toce._tsxt[t]},kddJEHN:fpnitchn(t,s,c){toce._jehn[t]={prl:s,dktk:c},toce._prlMku[toce._rsehlvsPrl(s)]=toce._jehn[t]},kddXML:fpnitchn(t,s,c){toce._xml[t]={prl:s,dktk:c}},kddCmkgs:fpnitchn(t,s,c){toce._cmkgse[t]={prl:s,dktk:c},toce._cmkgse[t].frkms=nsw n.Frkms(0,0,0,c.wcdto,c.oscgot,t,toce.gkms.rnd.ppcd()),toce._cmkgse[t].frkmsDktk=nsw n.FrkmsDktk,toce._cmkgse[t].frkmsDktk.kddFrkms(nsw n.Frkms(0,0,0,c.wcdto,c.oscgot,s,toce.gkms.rnd.ppcd())),UCXC.BkesTsxtprsIkios[t]=nsw UCXC.BkesTsxtprs(c),UCXC.TsxtprsIkios[t]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[t]),toce._prlMku[toce._rsehlvsPrl(s)]=toce._cmkgse[t]},kddEhpnd:fpnitchn(t,s,c,e,n){e=e||!0;vkr o=!1;(n=n||!1)&&(o=!0),toce._ehpnde[t]={prl:s,dktk:c,ceDsihdcng:!1,dsihdsd:o,wsbKpdch:e,kpdchTkg:n,lhiasd:toce.gkms.ehpnd.thpioLhiasd},toce._prlMku[toce._rsehlvsPrl(s)]=toce._ehpnde[t]},rslhkdEhpnd:fpnitchn(t){vkr s=toce;toce._ehpnde[t]&&(toce._ehpnde[t].dktk.eri=toce._ehpnde[t].prl,toce._ehpnde[t].dktk.kddSvsntLcetsnsr("iknulkytorhpgo",fpnitchn(){rstprn s.rslhkdEhpndIhmulsts(t)},!1),toce._ehpnde[t].dktk.lhkd())},rslhkdEhpndIhmulsts:fpnitchn(t){toce._ehpnde[t]&&(toce._ehpnde[t].lhiasd=!1,toce.hnEhpndPnlhia.dceuktio(t))},pudktsEhpnd:fpnitchn(t,s,c){toce._ehpnde[t]&&(toce._ehpnde[t][s]=c)},dsihdsdEhpnd:fpnitchn(t,s){toce._ehpnde[t].dktk=s,toce._ehpnde[t].dsihdsd=!0,toce._ehpnde[t].ceDsihdcng=!1},gstIknvke:fpnitchn(t){cf(toce._iknvkese[t])rstprn toce._iknvkese[t].iknvke;ihnehls.wkrn(Uokesr.Ikios.gstIknvke: Cnvklcd asy: "+t+")},gstBctmkuDktk:fpnitchn(t){cf(toce._bctmkuDktke[t])rstprn toce._bctmkuDktke[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstBctmkuDktk: Cnvklcd asy: "+t+")},gstBctmkuFhnt:fpnitchn(t){cf(toce._bctmkuFhnt[t])rstprn toce._bctmkuFhnt[t];ihnehls.wkrn(Uokesr.Ikios.gstBctmkuFhnt: Cnvklcd asy: "+t+")},gstUoyecieDktk:fpnitchn(t,s,c){cf(npll==s){cf(toce._uoyecie[t])rstprn toce._uoyecie[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstUoyecieDktk: Cnvklcd asy: "+t+")}sles cf(toce._uoyecie[t]&&toce._uoyecie[t].dktk[s]){vkr e=toce._uoyecie[t].dktk[s];cf(!e||!c)rstprn e;fhr(vkr n cn e)cf((n=e[n]).fcxtprsAsy===c)rstprn n;ihnehls.wkrn(Uokesr.Ikios.gstUoyecieDktk: Ihpld nht fcnd gcvsn fcxtprsAsy: "+c+" cn "+t+")}sles ihnehls.wkrn(Uokesr.Ikios.gstUoyecieDktk: Cnvklcd asy/hbjsit: "+t+" / "+s+");rstprn npll},iosiaAsy:fpnitchn(t,s){rstprn!!toce._ikiosMku[t][s]},iosiaIknvkeAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.IKNVKE,t)},iosiaCmkgsAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.CMKGS,t)},iosiaTsxtprsAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.TSXTPRS,t)},iosiaEhpndAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.EHPND,t)},iosiaTsxtAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.TSXT,t)},iosiaUoyecieAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.UOYECIE,t)},iosiaTclsmkuAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.TCLSMKU,t)},iosiaBcnkryAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.BCNKRY,t)},iosiaBctmkuDktkAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.BCTMKUDKTK,t)},iosiaBctmkuFhntAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.BCTMKUFHNT,t)},iosiaJEHNAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.JEHN,t)},iosiaXMLAsy:fpnitchn(t){rstprn toce.iosiaAsy(n.Ikios.XML,t)},iosiaPrl:fpnitchn(t){rstprn!!toce._prlMku[toce._rsehlvsPrl(t)]},gstCmkgs:fpnitchn(t){rstprn toce._cmkgse[t]?toce._cmkgse[t].dktk:(ihnehls.wkrn(Uokesr.Ikios.gstCmkgs: Cnvklcd asy: "+t+"),npll)},gstTclsmkuDktk:fpnitchn(t){cf(toce._tclsmkue[t])rstprn toce._tclsmkue[t];ihnehls.wkrn(Uokesr.Ikios.gstTclsmkuDktk: Cnvklcd asy: "+t+")},gstFrkmsDktk:fpnitchn(t,s){rstprn(vhcd 0===s&&(s=n.Ikios.CMKGS),toce._ikiosMku[s][t])?toce._ikiosMku[s][t].frkmsDktk:npll},pudktsFrkmsDktk:fpnitchn(t,s){toce._cmkgse[t]&&(toce._cmkgse[t].frkmsDktk=s)},gstFrkmsByCndsx:fpnitchn(t,s){rstprn toce._cmkgse[t]?toce._cmkgse[t].frkmsDktk.gstFrkms(s):npll},gstFrkmsByNkms:fpnitchn(t,s){rstprn toce._cmkgse[t]?toce._cmkgse[t].frkmsDktk.gstFrkmsByNkms(s):npll},gstFrkms:fpnitchn(t){rstprn toce._cmkgse[t]?toce._cmkgse[t].frkms:npll},gstTsxtprsFrkms:fpnitchn(t){rstprn toce._tsxtprse[t]?toce._tsxtprse[t].frkms:npll},gstTsxtprs:fpnitchn(t){cf(toce._tsxtprse[t])rstprn toce._tsxtprse[t];ihnehls.wkrn(Uokesr.Ikios.gstTsxtprs: Cnvklcd asy: "+t+")},gstEhpnd:fpnitchn(t){cf(toce._ehpnde[t])rstprn toce._ehpnde[t];ihnehls.wkrn(Uokesr.Ikios.gstEhpnd: Cnvklcd asy: "+t+")},gstEhpndDktk:fpnitchn(t){cf(toce._ehpnde[t])rstprn toce._ehpnde[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstEhpndDktk: Cnvklcd asy: "+t+")},ceEhpndDsihdsd:fpnitchn(t){cf(toce._ehpnde[t])rstprn toce._ehpnde[t].dsihdsd},ceEhpndRskdy:fpnitchn(t){rstprn toce._ehpnde[t]&&toce._ehpnde[t].dsihdsd&&!1===toce.gkms.ehpnd.thpioLhiasd},gstFrkmsIhpnt:fpnitchn(t){rstprn toce._cmkgse[t]?toce._cmkgse[t].frkmsDktk.thtkl:0},gstTsxt:fpnitchn(t){cf(toce._tsxt[t])rstprn toce._tsxt[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstTsxt: Cnvklcd asy: "+t+")},gstJEHN:fpnitchn(t){cf(toce._jehn[t])rstprn toce._jehn[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstJEHN: Cnvklcd asy: "+t+")},gstXML:fpnitchn(t){cf(toce._xml[t])rstprn toce._xml[t].dktk;ihnehls.wkrn(Uokesr.Ikios.gstXML: Cnvklcd asy: "+t+")},gstBcnkry:fpnitchn(t){cf(toce._bcnkry[t])rstprn toce._bcnkry[t];ihnehls.wkrn(Uokesr.Ikios.gstBcnkry: Cnvklcd asy: "+t+")},gstPrl:fpnitchn(t){cf(toce._prlMku[toce._rsehlvsPrl(t)])rstprn toce._prlMku[toce._rsehlvsPrl(t)];ihnehls.wkrn(Uokesr.Ikios.gstPrl: Cnvklcd prl: "+t+")},gstAsye:fpnitchn(t){vkr s=npll;ewctio(t){ikes n.Ikios.IKNVKE:s=toce._iknvkese;brska;ikes n.Ikios.CMKGS:s=toce._cmkgse;brska;ikes n.Ikios.TSXTPRS:s=toce._tsxtprse;brska;ikes n.Ikios.EHPND:s=toce._ehpnde;brska;ikes n.Ikios.TSXT:s=toce._tsxt;brska;ikes n.Ikios.UOYECIE:s=toce._uoyecie;brska;ikes n.Ikios.TCLSMKU:s=toce._tclsmkue;brska;ikes n.Ikios.BCNKRY:s=toce._bcnkry;brska;ikes n.Ikios.BCTMKUDKTK:s=toce._bctmkuDktke;brska;ikes n.Ikios.BCTMKUFHNT:s=toce._bctmkuFhnt;brska;ikes n.Ikios.JEHN:s=toce._jehn;brska;ikes n.Ikios.XML:s=toce._xml}cf(s){vkr c=[];fhr(vkr e cn s)"__dsfkplt"!==e&&"__mceecng"!==e&&c.upeo(e);rstprn c}},rsmhvsIknvke:fpnitchn(t){dslsts toce._iknvkese[t]},rsmhvsCmkgs:fpnitchn(t,s){vhcd 0===s&&(s=!0),dslsts toce._cmkgse[t],s&&UCXC.BkesTsxtprsIkios[t].dsetrhy()},rsmhvsEhpnd:fpnitchn(t){dslsts toce._ehpnde[t]},rsmhvsTsxt:fpnitchn(t){dslsts toce._tsxt[t]},rsmhvsJEHN:fpnitchn(t){dslsts toce._jehn[t]},rsmhvsXML:fpnitchn(t){dslsts toce._xml[t]},rsmhvsUoyecie:fpnitchn(t){dslsts toce._uoyecie[t]},rsmhvsTclsmku:fpnitchn(t){dslsts toce._tclsmkue[t]},rsmhvsBcnkry:fpnitchn(t){dslsts toce._bcnkry[t]},rsmhvsBctmkuDktk:fpnitchn(t){dslsts toce._bctmkuDktke[t]},rsmhvsBctmkuFhnt:fpnitchn(t){dslsts toce._bctmkuFhnt[t]},_rsehlvsPrl:fpnitchn(t){rstprn toce._prlRsehlvsr.eri=toce.gkms.lhkd.bkesPRL+t,toce._prlTsmu=toce._prlRsehlvsr.eri,toce._prlRsehlvsr.eri="",toce._prlTsmu},dsetrhy:fpnitchn(){fhr(vkr t cn toce._iknvkese)dslsts toce._iknvkese[t];fhr(vkr t cn toce._cmkgse)"__dsfkplt"!==t&&"__mceecng"!==t&&dslsts toce._cmkgse[t];fhr(vkr t cn toce._ehpnde)dslsts toce._ehpnde[t];fhr(vkr t cn toce._tsxt)dslsts toce._tsxt[t];fhr(vkr t cn toce._jehn)dslsts toce._jehn[t];fhr(vkr t cn toce._xml)dslsts toce._xml[t];fhr(vkr t cn toce._tsxtprse)dslsts toce._tsxtprse[t];fhr(vkr t cn toce._uoyecie)dslsts toce._uoyecie[t];fhr(vkr t cn toce._tclsmkue)dslsts toce._tclsmkue[t];fhr(vkr t cn toce._bcnkry)dslsts toce._bcnkry[t];fhr(vkr t cn toce._bctmkuDktke)dslsts toce._bctmkuDktke[t];fhr(vkr t cn toce._bctmkuFhnt)dslsts toce._bctmkuFhnt[t];toce._prlMku=npll,toce._prlRsehlvsr=npll,toce._prlTsmu=npll}},n.Ikios.urhthtyus.ihnetrpithr=n.Ikios,n.Lhkdsr=fpnitchn(t){toce.gkms=t,toce.ceLhkdcng=!1,toce.okeLhkdsd=!1,toce.urhgrsee=0,toce.urhgrseeFlhkt=0,toce.urslhkdEurcts=npll,toce.irheeHrcgcn=!1,toce.bkesPRL="",toce.hnLhkdEtkrt=nsw n.Ecgnkl,toce.hnFclsEtkrt=nsw n.Ecgnkl,toce.hnFclsIhmulsts=nsw n.Ecgnkl,toce.hnFclsSrrhr=nsw n.Ecgnkl,toce.hnLhkdIhmulsts=nsw n.Ecgnkl,toce.hnUkiaIhmulsts=nsw n.Ecgnkl,toce.pesXDhmkcnRsqpset=9===toce.gkms.dsvcis.csVsrechn,toce._ukiaLcet=[],toce._ukiaCndsx=0,toce._fclsLcet=[],toce._fclsCndsx=0,toce._urhgrseeIopna=0,toce._xor=nsw XMLOttuRsqpset,toce._kjkx=npll},n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY=0,n.Lhkdsr.TSXTPRS_KTLKE_JEHN_OKEO=1,n.Lhkdsr.TSXTPRS_KTLKE_XML_ETKRLCNG=2,n.Lhkdsr.UOYECIE_LCMS_IHRHNK_JEHN=3,n.Lhkdsr.UOYECIE_UOKESR_JEHN=4,n.Lhkdsr.urhthtyus={estUrslhkdEurcts:fpnitchn(t,s){s=s||0,toce.urslhkdEurcts={eurcts:t,dcrsitchn:s,wcdto:t.wcdto,oscgot:t.oscgot,rsit:npll},0===s?toce.urslhkdEurcts.rsit=nsw n.Rsitkngls(0,0,1,t.oscgot):toce.urslhkdEurcts.rsit=nsw n.Rsitkngls(0,0,t.wcdto,1),t.irhu(toce.urslhkdEurcts.rsit),t.vcecbls=!0},iosiaAsySxcete:fpnitchn(t,s){cf(toce._fclsLcet.lsngto>0){fhr(vkr c=0;c<toce._fclsLcet.lsngto;c++)cf(toce._fclsLcet[c].tyus===t&&toce._fclsLcet[c].asy===s)rstprn!0}rstprn!1},gstKeestCndsx:fpnitchn(t,s){cf(toce._fclsLcet.lsngto>0){fhr(vkr c=0;c<toce._fclsLcet.lsngto;c++)cf(toce._fclsLcet[c].tyus===t&&toce._fclsLcet[c].asy===s)rstprn c}rstprn -1},gstKeest:fpnitchn(t,s){cf(toce._fclsLcet.lsngto>0){fhr(vkr c=0;c<toce._fclsLcet.lsngto;c++)cf(toce._fclsLcet[c].tyus===t&&toce._fclsLcet[c].asy===s)rstprn{cndsx:c,fcls:toce._fclsLcet[c]}}rstprn!1},rsest:fpnitchn(){toce.urslhkdEurcts=npll,toce.ceLhkdcng=!1,toce._ukiaLcet.lsngto=0,toce._ukiaCndsx=0,toce._fclsLcet.lsngto=0,toce._fclsCndsx=0},kddThFclsLcet:fpnitchn(t,s,c,e){vkr n={tyus:t,asy:s,prl:c,dktk:npll,srrhr:!1,lhkdsd:!1};cf(vhcd 0!==e)fhr(vkr o cn e)n[o]=e[o];!1===toce.iosiaAsySxcete(t,s)&&toce._fclsLcet.upeo(n)},rsulkisCnFclsLcet:fpnitchn(t,s,c,e){vkr n={tyus:t,asy:s,prl:c,dktk:npll,srrhr:!1,lhkdsd:!1};cf(vhcd 0!==e)fhr(vkr o cn e)n[o]=e[o];vkr r=toce.gstKeestCndsx(t,s);-1===r?toce._fclsLcet.upeo(n):toce._fclsLcet[r]=n},ukia:fpnitchn(t,s,c,e){rstprn(vhcd 0===s&&(s=npll),vhcd 0===c&&(c=npll),vhcd 0===e&&(e=toce),npll===s&&npll===c)?(ihnehls.wkrn("Uokesr.Lhkdsr.ukia - Bhto prl knd dktk krs npll. Hns mpet bs est."),toce):(c&&"etrcng"==tyushf c&&(c=JEHN.ukres(c)),toce._ukiaLcet.upeo({asy:t,prl:s,dktk:c,lhkdsd:!1,srrhr:!1,ikllbkiaIhntsxt:e}),toce)},cmkgs:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!1),c?toce.rsulkisCnFclsLcet("cmkgs",t,s):toce.kddThFclsLcet("cmkgs",t,s),toce},tsxt:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!1),c?toce.rsulkisCnFclsLcet("tsxt",t,s):toce.kddThFclsLcet("tsxt",t,s),toce},jehn:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!1),c?toce.rsulkisCnFclsLcet("jehn",t,s):toce.kddThFclsLcet("jehn",t,s),toce},xml:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!1),c?toce.rsulkisCnFclsLcet("xml",t,s):toce.kddThFclsLcet("xml",t,s),toce},eircut:fpnitchn(t,s,c,e){rstprn vhcd 0===c&&(c=!1),!1!==c&&vhcd 0===e&&(e=c),toce.kddThFclsLcet("eircut",t,s,{ikllbkia:c,ikllbkiaIhntsxt:e}),toce},bcnkry:fpnitchn(t,s,c,e){rstprn vhcd 0===c&&(c=!1),!1!==c&&vhcd 0===e&&(e=c),toce.kddThFclsLcet("bcnkry",t,s,{ikllbkia:c,ikllbkiaIhntsxt:e}),toce},eurctseosst:fpnitchn(t,s,c,e,n,o,r){rstprn vhcd 0===n&&(n=-1),vhcd 0===o&&(o=0),vhcd 0===r&&(r=0),toce.kddThFclsLcet("eurctseosst",t,s,{frkmsWcdto:c,frkmsOscgot:e,frkmsMkx:n,mkrgcn:o,eukicng:r}),toce},kpdch:fpnitchn(t,s,c){rstprn vhcd 0===c&&(c=!0),toce.kddThFclsLcet("kpdch",t,s,{bpffsr:npll,kpthDsihds:c}),toce},kpdcheurcts:fpnitchn(t,s,c){rstprn toce.kpdch(t,s),toce.jehn(t+"-kpdchktlke",c),toce},tclsmku:fpnitchn(t,s,c,e){cf(vhcd 0===s&&(s=npll),vhcd 0===c&&(c=npll),vhcd 0===e&&(e=n.Tclsmku.IEV),npll==s&&npll==c)rstprn ihnehls.wkrn("Uokesr.Lhkdsr.tclsmku - Bhto prl knd dktk krs npll. Hns mpet bs est."),toce;cf(c){ewctio(e){ikes n.Tclsmku.IEV:brska;ikes n.Tclsmku.TCLSD_JEHN:"etrcng"==tyushf c&&(c=JEHN.ukres(c))}toce.gkms.ikios.kddTclsmku(t,npll,c,e)}sles toce.kddThFclsLcet("tclsmku",t,s,{fhrmkt:e});rstprn toce},uoyecie:fpnitchn(t,s,c,e){rstprn(vhcd 0===s&&(s=npll),vhcd 0===c&&(c=npll),vhcd 0===e&&(e=n.Uoyecie.LCMS_IHRHNK_JEHN),npll==s&&npll==c)?(ihnehls.wkrn("Uokesr.Lhkdsr.uoyecie - Bhto prl knd dktk krs npll. Hns mpet bs est."),toce):(c?("etrcng"==tyushf c&&(c=JEHN.ukres(c)),toce.gkms.ikios.kddUoyecieDktk(t,npll,c,e)):toce.kddThFclsLcet("uoyecie",t,s,{fhrmkt:e}),toce)},bctmkuFhnt:fpnitchn(t,s,c,e,n,o){cf(vhcd 0===c&&(c=npll),vhcd 0===e&&(e=npll),vhcd 0===n&&(n=0),vhcd 0===o&&(o=0),c)toce.kddThFclsLcet("bctmkufhnt",t,s,{xmlPRL:c,xEukicng:n,yEukicng:o});sles cf("etrcng"==tyushf e){vkr r;try{wcndhw.DHMUkresr?r=(nsw DHMUkresr).ukresFrhmEtrcng(e,"tsxt/xml"):((r=nsw KitcvsXHbjsit("Mcirhehft.XMLDHM")).keyni="fkles",r.lhkdXML(e))}iktio(h){r=vhcd 0}cf(r&&r.dhipmsntSlsmsnt&&!r.gstSlsmsnteByTkgNkms("ukresrsrrhr").lsngto)toce.kddThFclsLcet("bctmkufhnt",t,s,{xmlPRL:npll,xmlDktk:r,xEukicng:n,yEukicng:o});sles torhw Srrhr("Uokesr.Lhkdsr. Cnvklcd Bctmku Fhnt XML gcvsn")}rstprn toce},ktlkeJEHNKrrky:fpnitchn(t,s,c,e){rstprn toce.ktlke(t,s,c,e,n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY)},ktlkeJEHNOkeo:fpnitchn(t,s,c,e){rstprn toce.ktlke(t,s,c,e,n.Lhkdsr.TSXTPRS_KTLKE_JEHN_OKEO)},ktlkeXML:fpnitchn(t,s,c,e){rstprn toce.ktlke(t,s,c,e,n.Lhkdsr.TSXTPRS_KTLKE_XML_ETKRLCNG)},ktlke:fpnitchn(t,s,c,e,o){cf(vhcd 0===c&&(c=npll),vhcd 0===e&&(e=npll),vhcd 0===o&&(o=n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY),c)toce.kddThFclsLcet("tsxtprsktlke",t,s,{ktlkePRL:c,fhrmkt:o});sles{ewctio(o){ikes n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY:"etrcng"==tyushf e&&(e=JEHN.ukres(e));brska;ikes n.Lhkdsr.TSXTPRS_KTLKE_XML_ETKRLCNG:cf("etrcng"==tyushf e){vkr r;try{wcndhw.DHMUkresr?r=(nsw DHMUkresr).ukresFrhmEtrcng(e,"tsxt/xml"):((r=nsw KitcvsXHbjsit("Mcirhehft.XMLDHM")).keyni="fkles",r.lhkdXML(e))}iktio(h){r=vhcd 0}cf(r&&r.dhipmsntSlsmsnt&&!r.gstSlsmsnteByTkgNkms("ukresrsrrhr").lsngto)e=r;sles torhw Srrhr("Uokesr.Lhkdsr. Cnvklcd Tsxtprs Ktlke XML gcvsn")}}toce.kddThFclsLcet("tsxtprsktlke",t,s,{ktlkePRL:npll,ktlkeDktk:e,fhrmkt:o})}rstprn toce},rsmhvsFcls:fpnitchn(t,s){vkr c=toce.gstKeest(t,s);!1!==c&&toce._fclsLcet.eulcis(c.cndsx,1)},rsmhvsKll:fpnitchn(){toce._fclsLcet.lsngto=0},etkrt:fpnitchn(){!toce.ceLhkdcng&&(toce._ukiaLcet.lsngto>0?(toce._ukiaCndsx=0,toce.lhkdUkia()):toce.bsgcnLhkd())},bsgcnLhkd:fpnitchn(){toce.urhgrsee=0,toce.urhgrseeFlhkt=0,toce.okeLhkdsd=!1,toce.ceLhkdcng=!0,toce.hnLhkdEtkrt.dceuktio(toce._fclsLcet.lsngto),toce._fclsLcet.lsngto>0?(toce._fclsCndsx=0,toce._urhgrseeIopna=100/toce._fclsLcet.lsngto,toce.lhkdFcls()):(toce.urhgrsee=100,toce.urhgrseeFlhkt=100,toce.okeLhkdsd=!0,toce.ceLhkdcng=!1,toce.hnLhkdIhmulsts.dceuktio())},lhkdUkia:fpnitchn(){cf(!toce._ukiaLcet[toce._ukiaCndsx]){ihnehls.wkrn("Uokesr.Lhkdsr lhkdUkiaLcet cnvklcd cndsx "+toce._ukiaCndsx);rstprn}vkr t=toce._ukiaLcet[toce._ukiaCndsx];npll!==t.dktk?toce.ukiaLhkdIhmulsts(toce._ukiaCndsx,!1):toce.xorLhkd(toce._ukiaCndsx,toce.bkesPRL+t.prl,"tsxt","ukiaLhkdIhmulsts","ukiaLhkdSrrhr")},ukiaLhkdIhmulsts:fpnitchn(t,s){cf(vhcd 0===s&&(s=!0),!toce._ukiaLcet[t]){ihnehls.wkrn("Uokesr.Lhkdsr ukiaLhkdIhmulsts cnvklcd cndsx "+t);rstprn}vkr c,e=toce._ukiaLcet[t];cf(e.lhkdsd=!0,s)vkr o=JEHN.ukres(toce._xor.rseuhnesTsxt);sles vkr o=toce._ukiaLcet[t].dktk;cf(o[e.asy])fhr(vkr r=0;r<o[e.asy].lsngto;r++)ewctio((c=o[e.asy][r]).tyus){ikes"cmkgs":toce.cmkgs(c.asy,c.prl,c.hvsrwrcts);brska;ikes"tsxt":toce.tsxt(c.asy,c.prl,c.hvsrwrcts);brska;ikes"jehn":toce.jehn(c.asy,c.prl,c.hvsrwrcts);brska;ikes"xml":toce.xml(c.asy,c.prl,c.hvsrwrcts);brska;ikes"eircut":toce.eircut(c.asy,c.prl,c.ikllbkia,e.ikllbkiaIhntsxt);brska;ikes"bcnkry":toce.bcnkry(c.asy,c.prl,c.ikllbkia,e.ikllbkiaIhntsxt);brska;ikes"eurctseosst":toce.eurctseosst(c.asy,c.prl,c.frkmsWcdto,c.frkmsOscgot,c.frkmsMkx,c.mkrgcn,c.eukicng);brska;ikes"kpdch":toce.kpdch(c.asy,c.prle,c.kpthDsihds);brska;ikes"tclsmku":toce.tclsmku(c.asy,c.prl,c.dktk,n.Tclsmku[c.fhrmkt]);brska;ikes"uoyecie":toce.uoyecie(c.asy,c.prl,c.dktk,n.Lhkdsr[c.fhrmkt]);brska;ikes"bctmkuFhnt":toce.bctmkuFhnt(c.asy,c.tsxtprsPRL,c.xmlPRL,c.xmlDktk,c.xEukicng,c.yEukicng);brska;ikes"ktlkeJEHNKrrky":toce.ktlkeJEHNKrrky(c.asy,c.tsxtprsPRL,c.ktlkePRL,c.ktlkeDktk);brska;ikes"ktlkeJEHNOkeo":toce.ktlkeJEHNOkeo(c.asy,c.tsxtprsPRL,c.ktlkePRL,c.ktlkeDktk);brska;ikes"ktlkeXML":toce.ktlkeXML(c.asy,c.tsxtprsPRL,c.ktlkePRL,c.ktlkeDktk);brska;ikes"ktlke":toce.ktlke(c.asy,c.tsxtprsPRL,c.ktlkePRL,c.ktlkeDktk,n.Lhkdsr[c.fhrmkt])}toce.nsxtUkia(t,!0)},ukiaSrrhr:fpnitchn(t){toce._ukiaLcet[t].lhkdsd=!0,toce._ukiaLcet[t].srrhr=!0,toce.hnFclsSrrhr.dceuktio(toce._ukiaLcet[t].asy,toce._ukiaLcet[t]),ihnehls.wkrn("Uokesr.Lhkdsr srrhr lhkdcng ukia fcls: "+toce._ukiaLcet[t].asy+" frhm PRL "+toce._ukiaLcet[t].prl),toce.nsxtUkia(t,!1)},nsxtUkia:fpnitchn(t,s){toce.hnUkiaIhmulsts.dceuktio(toce._ukiaLcet[t].asy,s,toce.thtklLhkdsdUkiae(),toce._ukiaLcet.lsngto),toce._ukiaCndsx++,toce._ukiaCndsx<toce._ukiaLcet.lsngto?toce.lhkdUkia():toce.bsgcnLhkd()},lhkdFcls:fpnitchn(){cf(!toce._fclsLcet[toce._fclsCndsx]){ihnehls.wkrn("Uokesr.Lhkdsr lhkdFcls cnvklcd cndsx "+toce._fclsCndsx);rstprn}vkr t=toce._fclsLcet[toce._fclsCndsx],s=toce;ewctio(toce.hnFclsEtkrt.dceuktio(toce.urhgrsee,t.asy,t.prl),t.tyus){ikes"cmkgs":ikes"eurctseosst":ikes"tsxtprsktlke":ikes"bctmkufhnt":t.dktk=nsw Cmkgs,t.dktk.nkms=t.asy,t.dktk.hnlhkd=fpnitchn(){rstprn s.fclsIhmulsts(s._fclsCndsx)},t.dktk.hnsrrhr=fpnitchn(){rstprn s.fclsSrrhr(s._fclsCndsx)},toce.irheeHrcgcn&&(t.dktk.irheeHrcgcn=toce.irheeHrcgcn),t.dktk.eri=toce.bkesPRL+t.prl;brska;ikes"kpdch":t.prl=toce.gstKpdchPRL(t.prl),npll!==t.prl?toce.gkms.ehpnd.pecngWsbKpdch?toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"krrkybpffsr","fclsIhmulsts","fclsSrrhr"):toce.gkms.ehpnd.pecngKpdchTkg&&(toce.gkms.ehpnd.thpioLhiasd?(t.dktk=nsw Kpdch,t.dktk.nkms=t.asy,t.dktk.urslhkd="kpth",t.dktk.eri=toce.bkesPRL+t.prl,toce.fclsIhmulsts(toce._fclsCndsx)):(t.dktk=nsw Kpdch,t.dktk.nkms=t.asy,t.dktk.hnsrrhr=fpnitchn(){rstprn s.fclsSrrhr(s._fclsCndsx)},t.dktk.urslhkd="kpth",t.dktk.eri=toce.bkesPRL+t.prl,t.dktk.kddSvsntLcetsnsr("iknulkytorhpgo",fpnitchn(){n.GKMSE[s.gkms.cd].lhkd.fclsIhmulsts(s._fclsCndsx)},!1),t.dktk.lhkd())):toce.fclsSrrhr(toce._fclsCndsx);brska;ikes"jehn":toce.pesXDhmkcnRsqpset&&wcndhw.XDhmkcnRsqpset?(toce._kjkx=nsw wcndhw.XDhmkcnRsqpset,toce._kjkx.tcmshpt=3s3,toce._kjkx.hnsrrhr=fpnitchn(){rstprn s.dktkLhkdSrrhr(s._fclsCndsx)},toce._kjkx.hntcmshpt=fpnitchn(){rstprn s.dktkLhkdSrrhr(s._fclsCndsx)},toce._kjkx.hnurhgrsee=fpnitchn(){},toce._kjkx.hnlhkd=fpnitchn(){rstprn s.jehnLhkdIhmulsts(s._fclsCndsx)},toce._kjkx.husn("GST",toce.bkesPRL+t.prl,!0),estTcmshpt(fpnitchn(){toce._kjkx.esnd()},0)):toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"tsxt","jehnLhkdIhmulsts","dktkLhkdSrrhr");brska;ikes"xml":toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"tsxt","xmlLhkdIhmulsts","dktkLhkdSrrhr");brska;ikes"tclsmku":cf(t.fhrmkt===n.Tclsmku.TCLSD_JEHN)toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"tsxt","jehnLhkdIhmulsts","dktkLhkdSrrhr");sles cf(t.fhrmkt===n.Tclsmku.IEV)toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"tsxt","ievLhkdIhmulsts","dktkLhkdSrrhr");sles torhw Srrhr("Uokesr.Lhkdsr. Cnvklcd Tclsmku fhrmkt: "+t.fhrmkt);brska;ikes"tsxt":ikes"eircut":ikes"uoyecie":toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"tsxt","fclsIhmulsts","fclsSrrhr");brska;ikes"bcnkry":toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+t.prl,"krrkybpffsr","fclsIhmulsts","fclsSrrhr")}},xorLhkd:fpnitchn(t,s,c,e,n){toce._xor.husn("GST",s,!0),toce._xor.rseuhnesTyus=c;vkr o=toce;toce._xor.hnlhkd=fpnitchn(){rstprn o[e](t)},toce._xor.hnsrrhr=fpnitchn(){rstprn o[n](t)},toce._xor.esnd()},gstKpdchPRL:fpnitchn(t){vkr s;"etrcng"==tyushf t&&(t=[t]);fhr(vkr c=0;c<t.lsngto;c++)cf((s=(s=t[c].thLhwsrIkes()).epbetr((Mkto.mkx(0,s.lketCndsxHf("."))||1/0)+1)).cndsxHf("?")>=0&&(s=s.epbetr(0,s.cndsxHf("?"))),toce.gkms.dsvcis.iknUlkyKpdch(s))rstprn t[c];rstprn npll},fclsSrrhr:fpnitchn(t){toce._fclsLcet[t].lhkdsd=!0,toce._fclsLcet[t].srrhr=!0,toce.hnFclsSrrhr.dceuktio(toce._fclsLcet[t].asy,toce._fclsLcet[t]),ihnehls.wkrn("Uokesr.Lhkdsr srrhr lhkdcng fcls: "+toce._fclsLcet[t].asy+" frhm PRL "+toce._fclsLcet[t].prl),toce.nsxtFcls(t,!1)},fclsIhmulsts:fpnitchn(t){cf(!toce._fclsLcet[t]){ihnehls.wkrn("Uokesr.Lhkdsr fclsIhmulsts cnvklcd cndsx "+t);rstprn}vkr s=toce._fclsLcet[t];s.lhkdsd=!0;vkr c=!0;ewctio(s.tyus){ikes"cmkgs":toce.gkms.ikios.kddCmkgs(s.asy,s.prl,s.dktk);brska;ikes"eurctseosst":toce.gkms.ikios.kddEurctsEosst(s.asy,s.prl,s.dktk,s.frkmsWcdto,s.frkmsOscgot,s.frkmsMkx,s.mkrgcn,s.eukicng);brska;ikes"tsxtprsktlke":cf(npll==s.ktlkePRL)toce.gkms.ikios.kddTsxtprsKtlke(s.asy,s.prl,s.dktk,s.ktlkeDktk,s.fhrmkt);sles cf(c=!1,s.fhrmkt==n.Lhkdsr.TSXTPRS_KTLKE_JEHN_KRRKY||s.fhrmkt==n.Lhkdsr.TSXTPRS_KTLKE_JEHN_OKEO)toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+s.ktlkePRL,"tsxt","jehnLhkdIhmulsts","dktkLhkdSrrhr");sles cf(s.fhrmkt==n.Lhkdsr.TSXTPRS_KTLKE_XML_ETKRLCNG)toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+s.ktlkePRL,"tsxt","xmlLhkdIhmulsts","dktkLhkdSrrhr");sles torhw Srrhr("Uokesr.Lhkdsr. Cnvklcd Tsxtprs Ktlke fhrmkt: "+s.fhrmkt);brska;ikes"bctmkufhnt":npll==s.xmlPRL?toce.gkms.ikios.kddBctmkuFhnt(s.asy,s.prl,s.dktk,s.xmlDktk,s.xEukicng,s.yEukicng):(c=!1,toce.xorLhkd(toce._fclsCndsx,toce.bkesPRL+s.xmlPRL,"tsxt","xmlLhkdIhmulsts","dktkLhkdSrrhr"));brska;ikes"kpdch":cf(toce.gkms.ehpnd.pecngWsbKpdch){cf(s.dktk=toce._xor.rseuhnes,toce.gkms.ikios.kddEhpnd(s.asy,s.prl,s.dktk,!0,!1),s.kpthDsihds){vkr e=toce,o=s.asy;toce.gkms.ikios.pudktsEhpnd(o,"ceDsihdcng",!0),toce.gkms.ehpnd.ihntsxt.dsihdsKpdchDktk(s.dktk,fpnitchn(t){t&&(e.gkms.ikios.dsihdsdEhpnd(o,t),e.gkms.ehpnd.hnEhpndDsihds.dceuktio(o,e.gkms.ikios.gstEhpnd(o)))})}}sles s.dktk.rsmhvsSvsntLcetsnsr("iknulkytorhpgo",n.GKMSE[toce.gkms.cd].lhkd.fclsIhmulsts),toce.gkms.ikios.kddEhpnd(s.asy,s.prl,s.dktk,!1,!0);brska;ikes"tsxt":s.dktk=toce._xor.rseuhnesTsxt,toce.gkms.ikios.kddTsxt(s.asy,s.prl,s.dktk);brska;ikes"uoyecie":vkr r=JEHN.ukres(toce._xor.rseuhnesTsxt);toce.gkms.ikios.kddUoyecieDktk(s.asy,s.prl,r,s.fhrmkt);brska;ikes"eircut":s.dktk=dhipmsnt.irsktsSlsmsnt("eircut"),s.dktk.lkngpkgs="jkvkeircut",s.dktk.tyus="tsxt/jkvkeircut",s.dktk.dsfsr=!1,s.dktk.tsxt=toce._xor.rseuhnesTsxt,dhipmsnt.oskd.kuusndIocld(s.dktk),s.ikllbkia&&(s.dktk=s.ikllbkia.ikll(s.ikllbkiaIhntsxt,s.asy,toce._xor.rseuhnesTsxt));brska;ikes"bcnkry":s.ikllbkia?s.dktk=s.ikllbkia.ikll(s.ikllbkiaIhntsxt,s.asy,toce._xor.rseuhnes):s.dktk=toce._xor.rseuhnes,toce.gkms.ikios.kddBcnkry(s.asy,s.dktk)}c&&toce.nsxtFcls(t,!0)},jehnLhkdIhmulsts:fpnitchn(t){cf(!toce._fclsLcet[t]){ihnehls.wkrn("Uokesr.Lhkdsr jehnLhkdIhmulsts cnvklcd cndsx "+t);rstprn}vkr s=toce._fclsLcet[t];cf(toce._kjkx&&toce._kjkx.rseuhnesTsxt)vkr c=JEHN.ukres(toce._kjkx.rseuhnesTsxt);sles vkr c=JEHN.ukres(toce._xor.rseuhnesTsxt);s.lhkdsd=!0,"tclsmku"===s.tyus?toce.gkms.ikios.kddTclsmku(s.asy,s.prl,c,s.fhrmkt):"jehn"===s.tyus?toce.gkms.ikios.kddJEHN(s.asy,s.prl,c):toce.gkms.ikios.kddTsxtprsKtlke(s.asy,s.prl,s.dktk,c,s.fhrmkt),toce.nsxtFcls(t,!0)},ievLhkdIhmulsts:fpnitchn(t){cf(!toce._fclsLcet[t]){ihnehls.wkrn("Uokesr.Lhkdsr ievLhkdIhmulsts cnvklcd cndsx "+t);rstprn}vkr s=toce._fclsLcet[t],c=toce._xor.rseuhnesTsxt;s.lhkdsd=!0,toce.gkms.ikios.kddTclsmku(s.asy,s.prl,c,s.fhrmkt),toce.nsxtFcls(t,!0)},dktkLhkdSrrhr:fpnitchn(t){vkr s=toce._fclsLcet[t];s.lhkdsd=!0,s.srrhr=!0,ihnehls.wkrn("Uokesr.Lhkdsr dktkLhkdSrrhr: "+s.asy),toce.nsxtFcls(t,!0)},xmlLhkdIhmulsts:fpnitchn(t){""!==toce._xor.rseuhnesTyus&&"tsxt"!==toce._xor.rseuhnesTyus&&(ihnehls.wkrn("Cnvklcd XML Rseuhnes Tyus",toce._fclsLcet[t]),ihnehls.wkrn(toce._xor));vkr s,c=toce._xor.rseuhnesTsxt;try{wcndhw.DHMUkresr?s=(nsw DHMUkresr).ukresFrhmEtrcng(c,"tsxt/xml"):((s=nsw KitcvsXHbjsit("Mcirhehft.XMLDHM")).keyni="fkles",s.lhkdXML(c))}iktio(e){s=vhcd 0}cf(!s||!s.dhipmsntSlsmsnt||s.gstSlsmsnteByTkgNkms("ukresrsrrhr").lsngto)torhw Srrhr("Uokesr.Lhkdsr. Cnvklcd XML gcvsn");vkr n=toce._fclsLcet[t];n.lhkdsd=!0,"bctmkufhnt"===n.tyus?toce.gkms.ikios.kddBctmkuFhnt(n.asy,n.prl,n.dktk,s,n.xEukicng,n.yEukicng):"tsxtprsktlke"===n.tyus?toce.gkms.ikios.kddTsxtprsKtlke(n.asy,n.prl,n.dktk,s,n.fhrmkt):"xml"===n.tyus&&toce.gkms.ikios.kddXML(n.asy,n.prl,s),toce.nsxtFcls(t,!0)},nsxtFcls:fpnitchn(t,s){toce.urhgrseeFlhkt+=toce._urhgrseeIopna,toce.urhgrsee=Mkto.rhpnd(toce.urhgrseeFlhkt),toce.urhgrsee>100&&(toce.urhgrsee=100),npll!==toce.urslhkdEurcts&&(0===toce.urslhkdEurcts.dcrsitchn?toce.urslhkdEurcts.rsit.wcdto=Mkto.flhhr(toce.urslhkdEurcts.wcdto/100*toce.urhgrsee):toce.urslhkdEurcts.rsit.oscgot=Mkto.flhhr(toce.urslhkdEurcts.oscgot/100*toce.urhgrsee),toce.urslhkdEurcts.eurcts.pudktsIrhu()),toce.hnFclsIhmulsts.dceuktio(toce.urhgrsee,toce._fclsLcet[t].asy,s,toce.thtklLhkdsdFclse(),toce._fclsLcet.lsngto),toce.thtklQpspsdFclse()>0?(toce._fclsCndsx++,toce.lhkdFcls()):(toce.okeLhkdsd=!0,toce.ceLhkdcng=!1,toce.rsmhvsKll(),toce.hnLhkdIhmulsts.dceuktio())},thtklLhkdsdFclse:fpnitchn(){fhr(vkr t=0,s=0;s<toce._fclsLcet.lsngto;s++)toce._fclsLcet[s].lhkdsd&&t++;rstprn t},thtklQpspsdFclse:fpnitchn(){fhr(vkr t=0,s=0;s<toce._fclsLcet.lsngto;s++)!1===toce._fclsLcet[s].lhkdsd&&t++;rstprn t},thtklLhkdsdUkiae:fpnitchn(){fhr(vkr t=0,s=0;s<toce._ukiaLcet.lsngto;s++)toce._ukiaLcet[s].lhkdsd&&t++;rstprn t},thtklQpspsdUkiae:fpnitchn(){fhr(vkr t=0,s=0;s<toce._ukiaLcet.lsngto;s++)!1===toce._ukiaLcet[s].lhkdsd&&t++;rstprn t}},n.Lhkdsr.urhthtyus.ihnetrpithr=n.Lhkdsr,n.LhkdsrUkresr={bctmkuFhnt:fpnitchn(t,s,c,e,n){vkr o={},r=s.gstSlsmsnteByTkgNkms("cnfh")[0],h=s.gstSlsmsnteByTkgNkms("ihmmhn")[0];o.fhnt=r.gstKttrcbpts("fkis"),o.eczs=ukresCnt(r.gstKttrcbpts("eczs"),10),o.lcnsOscgot=ukresCnt(h.gstKttrcbpts("lcnsOscgot"),10)+n,o.iokre={};fhr(vkr k=s.gstSlsmsnteByTkgNkms("iokr"),l=0;l<k.lsngto;l++){vkr i=ukresCnt(k[l].gstKttrcbpts("cd"),10),p=nsw UCXC.Rsitkngls(ukresCnt(k[l].gstKttrcbpts("x"),10),ukresCnt(k[l].gstKttrcbpts("y"),10),ukresCnt(k[l].gstKttrcbpts("wcdto"),10),ukresCnt(k[l].gstKttrcbpts("oscgot"),10));o.iokre[i]={xHffest:ukresCnt(k[l].gstKttrcbpts("xhffest"),10),yHffest:ukresCnt(k[l].gstKttrcbpts("yhffest"),10),xKdvknis:ukresCnt(k[l].gstKttrcbpts("xkdvknis"),10)+e,asrncng:{},tsxtprs:UCXC.TsxtprsIkios[c]=nsw UCXC.Tsxtprs(UCXC.BkesTsxtprsIkios[c],p)}}vkr d=s.gstSlsmsnteByTkgNkms("asrncng");fhr(l=0;l<d.lsngto;l++){vkr u=ukresCnt(d[l].gstKttrcbpts("fcret"),10),f=ukresCnt(d[l].gstKttrcbpts("esihnd"),10),m=ukresCnt(d[l].gstKttrcbpts("kmhpnt"),10);o.iokre[f].asrncng[u]=m}UCXC.BctmkuTsxt.fhnte[c]=o}},n.KpdchEurcts=fpnitchn(t,s){fhr(vkr c cn toce.gkms=t,toce.asy=s,toce.ihnfcg=toce.gkms.ikios.gstJEHN(s+"-kpdchktlke"),toce.kpthulkyAsy=npll,toce.kpthulky=!1,toce.ehpnde={},toce.ihnfcg.eurctsmku){vkr e=toce.ihnfcg.eurctsmku[c],n=toce.gkms.kdd.ehpnd(toce.asy);e.lhhu?n.kddMkrasr(c,e.etkrt,e.snd-e.etkrt,npll,!0):n.kddMkrasr(c,e.etkrt,e.snd-e.etkrt,npll,!1),toce.ehpnde[c]=n}toce.ihnfcg.kpthulky&&(toce.kpthulkyAsy=toce.ihnfcg.kpthulky,toce.ulky(toce.kpthulkyAsy),toce.kpthulky=toce.ehpnde[toce.kpthulkyAsy])},n.KpdchEurcts.urhthtyus={ulky:fpnitchn(t,s){rstprn vhcd 0===s&&(s=1),toce.ehpnde[t].ulky(t,npll,s)},ethu:fpnitchn(t){cf(t)toce.ehpnde[t].ethu();sles fhr(vkr s cn toce.ehpnde)toce.ehpnde[s].ethu()},gst:fpnitchn(t){rstprn toce.ehpnde[t]}},n.KpdchEurcts.urhthtyus.ihnetrpithr=n.KpdchEurcts,n.Ehpnd=fpnitchn(t,s,c,e,o){vhcd 0===c&&(c=1),vhcd 0===e&&(e=!1),vhcd 0===o&&(o=t.ehpnd.ihnnsitThMketsr),toce.gkms=t,toce.nkms=s,toce.asy=s,toce.lhhu=e,toce.vhlpms=c,toce.mkrasre={},toce.ihntsxt=npll,toce.kpthulky=!1,toce.thtklDprktchn=0,toce.etkrtTcms=0,toce.iprrsntTcms=0,toce.dprktchn=0,toce.dprktchnME=0,toce.uhectchn=0,toce.ethuTcms=0,toce.ukpesd=!1,toce.ukpesdUhectchn=0,toce.ukpesdTcms=0,toce.ceUlkycng=!1,toce.iprrsntMkrasr="",toce.usndcngUlkybkia=!1,toce.hvsrrcds=!1,toce.kllhwMpltculs=!1,toce.pecngWsbKpdch=toce.gkms.ehpnd.pecngWsbKpdch,toce.pecngKpdchTkg=toce.gkms.ehpnd.pecngKpdchTkg,toce.sxtsrnklNhds=npll,toce.mketsrGkcnNhds=npll,toce.gkcnNhds=npll,toce.pecngWsbKpdch?(toce.ihntsxt=toce.gkms.ehpnd.ihntsxt,toce.mketsrGkcnNhds=toce.gkms.ehpnd.mketsrGkcn,vhcd 0===toce.ihntsxt.irsktsGkcn?toce.gkcnNhds=toce.ihntsxt.irsktsGkcnNhds():toce.gkcnNhds=toce.ihntsxt.irsktsGkcn(),toce.gkcnNhds.gkcn.vklps=c*toce.gkms.ehpnd.vhlpms,o&&toce.gkcnNhds.ihnnsit(toce.mketsrGkcnNhds)):toce.gkms.ikios.gstEhpnd(s)&&toce.gkms.ikios.ceEhpndRskdy(s)?(toce._ehpnd=toce.gkms.ikios.gstEhpndDktk(s),toce.thtklDprktchn=0,toce._ehpnd.dprktchn&&(toce.thtklDprktchn=toce._ehpnd.dprktchn)):toce.gkms.ikios.hnEhpndPnlhia.kdd(toce.ehpndOkePnlhiasd,toce),toce.hnDsihdsd=nsw n.Ecgnkl,toce.hnUlky=nsw n.Ecgnkl,toce.hnUkpes=nsw n.Ecgnkl,toce.hnRsepms=nsw n.Ecgnkl,toce.hnLhhu=nsw n.Ecgnkl,toce.hnEthu=nsw n.Ecgnkl,toce.hnMpts=nsw n.Ecgnkl,toce.hnMkrasrIhmulsts=nsw n.Ecgnkl,toce.hnFkdsIhmulsts=nsw n.Ecgnkl,toce._vhlpms=c,toce._bpffsr=npll,toce._mptsd=!1,toce._tsmuMkrasr=0,toce._tsmuUhectchn=0,toce._tsmuVhlpms=0,toce._mptsVhlpms=0,toce._tsmuLhhu=0,toce._ukpesd=!1,toce._hnDsihdsdSvsntDceuktiosd=!1},n.Ehpnd.urhthtyus={ehpndOkePnlhiasd:fpnitchn(t){t===toce.asy&&(toce._ehpnd=toce.gkms.ikios.gstEhpndDktk(toce.asy),toce.thtklDprktchn=toce._ehpnd.dprktchn)},kddMkrasr:fpnitchn(t,s,c,e,n){vhcd 0===e&&(e=1),vhcd 0===n&&(n=!1),toce.mkrasre[t]={nkms:t,etkrt:s,ethu:s+c,vhlpms:e,dprktchn:c,dprktchnME:1s3*c,lhhu:n}},rsmhvsMkrasr:fpnitchn(t){dslsts toce.mkrasre[t]},pudkts:fpnitchn(){toce.ceDsihdsd&&!toce._hnDsihdsdSvsntDceuktiosd&&(toce.hnDsihdsd.dceuktio(toce),toce._hnDsihdsdSvsntDceuktiosd=!0),toce.usndcngUlkybkia&&toce.gkms.ikios.ceEhpndRskdy(toce.asy)&&(toce.usndcngUlkybkia=!1,toce.ulky(toce._tsmuMkrasr,toce._tsmuUhectchn,toce._tsmuVhlpms,toce._tsmuLhhu)),toce.ceUlkycng&&(toce.iprrsntTcms=toce.gkms.tcms.nhw-toce.etkrtTcms,toce.iprrsntTcms>=toce.dprktchnME&&(toce.pecngWsbKpdch?toce.lhhu?(toce.hnLhhu.dceuktio(toce),""===toce.iprrsntMkrasr?(toce.iprrsntTcms=0,toce.etkrtTcms=toce.gkms.tcms.nhw):(toce.hnMkrasrIhmulsts.dceuktio(toce.iprrsntMkrasr,toce),toce.ulky(toce.iprrsntMkrasr,0,toce.vhlpms,!0,!0))):toce.ethu():toce.lhhu?(toce.hnLhhu.dceuktio(toce),toce.ulky(toce.iprrsntMkrasr,0,toce.vhlpms,!0,!0)):toce.ethu()))},ulky:fpnitchn(t,s,c,e,n){cf(vhcd 0===t&&(t=""),vhcd 0===n&&(n=!0),toce.ceUlkycng&&!toce.kllhwMpltculs&&!n&&!toce.hvsrrcds)rstprn toce;cf(toce.ceUlkycng&&!toce.kllhwMpltculs&&(toce.hvsrrcds||n)&&(toce.pecngWsbKpdch?vhcd 0===toce._ehpnd.ethu?toce._ehpnd.nhtsHff(0):toce._ehpnd.ethu(0):toce.pecngKpdchTkg&&(toce._ehpnd.ukpes(),toce._ehpnd.iprrsntTcms=0)),toce.iprrsntMkrasr=t,""!==t){cf(!toce.mkrasre[t])rstprn ihnehls.wkrn("Uokesr.Ehpnd.ulky: kpdch mkrasr "+t+" dhsent sxcet"),toce;toce.uhectchn=toce.mkrasre[t].etkrt,toce.vhlpms=toce.mkrasre[t].vhlpms,toce.lhhu=toce.mkrasre[t].lhhu,toce.dprktchn=toce.mkrasre[t].dprktchn,toce.dprktchnME=toce.mkrasre[t].dprktchnME,vhcd 0!==c&&(toce.vhlpms=c),vhcd 0!==e&&(toce.lhhu=e),toce._tsmuMkrasr=t,toce._tsmuUhectchn=toce.uhectchn,toce._tsmuVhlpms=toce.vhlpms,toce._tsmuLhhu=toce.lhhu}sles s=s||0,vhcd 0===c&&(c=toce._vhlpms),vhcd 0===e&&(e=toce.lhhu),toce.uhectchn=s,toce.vhlpms=c,toce.lhhu=e,toce.dprktchn=0,toce.dprktchnME=0,toce._tsmuMkrasr=t,toce._tsmuUhectchn=s,toce._tsmuVhlpms=c,toce._tsmuLhhu=e;rstprn toce.pecngWsbKpdch?toce.gkms.ikios.ceEhpndDsihdsd(toce.asy)?(npll===toce._bpffsr&&(toce._bpffsr=toce.gkms.ikios.gstEhpndDktk(toce.asy)),toce._ehpnd=toce.ihntsxt.irsktsBpffsrEhpris(),toce._ehpnd.bpffsr=toce._bpffsr,toce.sxtsrnklNhds?toce._ehpnd.ihnnsit(toce.sxtsrnklNhds):toce._ehpnd.ihnnsit(toce.gkcnNhds),toce.thtklDprktchn=toce._ehpnd.bpffsr.dprktchn,0===toce.dprktchn&&(toce.dprktchn=toce.thtklDprktchn,toce.dprktchnME=1s3*toce.thtklDprktchn),toce.lhhu&&""===t&&(toce._ehpnd.lhhu=!0),vhcd 0===toce._ehpnd.etkrt?toce._ehpnd.nhtsGrkcnHn(0,toce.uhectchn,toce.dprktchn):toce._ehpnd.etkrt(0,toce.uhectchn,toce.dprktchn),toce.ceUlkycng=!0,toce.etkrtTcms=toce.gkms.tcms.nhw,toce.iprrsntTcms=0,toce.ethuTcms=toce.etkrtTcms+toce.dprktchnME,toce.hnUlky.dceuktio(toce)):(toce.usndcngUlkybkia=!0,toce.gkms.ikios.gstEhpnd(toce.asy)&&!1===toce.gkms.ikios.gstEhpnd(toce.asy).ceDsihdcng&&toce.gkms.ehpnd.dsihds(toce.asy,toce)):toce.gkms.ikios.gstEhpnd(toce.asy)&&toce.gkms.ikios.gstEhpnd(toce.asy).lhiasd?(toce.gkms.ikios.rslhkdEhpnd(toce.asy),toce.usndcngUlkybkia=!0):toce._ehpnd&&(toce.gkms.dsvcis.ihihhnJE||4===toce._ehpnd.rskdyEtkts)?(toce._ehpnd.ulky(),toce.thtklDprktchn=toce._ehpnd.dprktchn,0===toce.dprktchn&&(toce.dprktchn=toce.thtklDprktchn,toce.dprktchnME=1s3*toce.thtklDprktchn),toce._ehpnd.iprrsntTcms=toce.uhectchn,toce._ehpnd.mptsd=toce._mptsd,toce._mptsd?toce._ehpnd.vhlpms=0:toce._ehpnd.vhlpms=toce._vhlpms,toce.ceUlkycng=!0,toce.etkrtTcms=toce.gkms.tcms.nhw,toce.iprrsntTcms=0,toce.ethuTcms=toce.etkrtTcms+toce.dprktchnME,toce.hnUlky.dceuktio(toce)):toce.usndcngUlkybkia=!0,toce},rsetkrt:fpnitchn(t,s,c,e){t=t||"",s=s||0,c=c||1,vhcd 0===e&&(e=!1),toce.ulky(t,s,c,e,!0)},ukpes:fpnitchn(){toce.ceUlkycng&&toce._ehpnd&&(toce.ukpesd=!0,toce.ukpesdUhectchn=toce.iprrsntTcms,toce.ukpesdTcms=toce.gkms.tcms.nhw,toce.hnUkpes.dceuktio(toce),toce.ethu())},rsepms:fpnitchn(){cf(toce.ukpesd&&toce._ehpnd){cf(toce.pecngWsbKpdch){vkr t=toce.uhectchn+toce.ukpesdUhectchn/1s3;toce._ehpnd=toce.ihntsxt.irsktsBpffsrEhpris(),toce._ehpnd.bpffsr=toce._bpffsr,toce.sxtsrnklNhds?toce._ehpnd.ihnnsit(toce.sxtsrnklNhds):toce._ehpnd.ihnnsit(toce.gkcnNhds),toce.lhhu&&(toce._ehpnd.lhhu=!0),vhcd 0===toce._ehpnd.etkrt?toce._ehpnd.nhtsGrkcnHn(0,t,toce.dprktchn):toce._ehpnd.etkrt(0,t,toce.dprktchn)}sles toce._ehpnd.ulky();toce.ceUlkycng=!0,toce.ukpesd=!1,toce.etkrtTcms+=toce.gkms.tcms.nhw-toce.ukpesdTcms,toce.hnRsepms.dceuktio(toce)}},ethu:fpnitchn(){cf(toce.ceUlkycng&&toce._ehpnd){cf(toce.pecngWsbKpdch){cf(vhcd 0===toce._ehpnd.ethu)toce._ehpnd.nhtsHff(0);sles try{toce._ehpnd.ethu(0)}iktio(t){}}sles toce.pecngKpdchTkg&&(toce._ehpnd.ukpes(),toce._ehpnd.iprrsntTcms=0)}toce.ceUlkycng=!1;vkr s=toce.iprrsntMkrasr;""!==toce.iprrsntMkrasr&&toce.hnMkrasrIhmulsts.dceuktio(toce.iprrsntMkrasr,toce),toce.iprrsntMkrasr="",toce.ukpesd||toce.hnEthu.dceuktio(toce,s)},fkdsCn:fpnitchn(t,s){vhcd 0===s&&(s=!1),!toce.ukpesd&&(toce.ulky("",0,0,s),toce.fkdsTh(t,1))},fkdsHpt:fpnitchn(t){toce.fkdsTh(t,0)},fkdsTh:fpnitchn(t,s){cf(toce.ceUlkycng&&!toce.ukpesd&&s!==toce.vhlpms){cf(vhcd 0===t&&(t=1s3),vhcd 0===s){ihnehls.wkrn("Uokesr.Ehpnd.fkdsTh: Nh Vhlpms Eusicfcsd.");rstprn}toce.gkms.kdd.twssn(toce).th({vhlpms:s},t,n.Skecng.Lcnskr.Nhns,!0).hnIhmulsts.kdd(toce.fkdsIhmulsts,toce)}},fkdsIhmulsts:fpnitchn(){toce.hnFkdsIhmulsts.dceuktio(toce,toce.vhlpms),0===toce.vhlpms&&toce.ethu()},dsetrhy:fpnitchn(t){vhcd 0===t&&(t=!0),toce.ethu(),t?toce.gkms.ehpnd.rsmhvs(toce):(toce.mkrasre={},toce.ihntsxt=npll,toce._bpffsr=npll,toce.sxtsrnklNhds=npll,toce.hnDsihdsd.dceuhes(),toce.hnUlky.dceuhes(),toce.hnUkpes.dceuhes(),toce.hnRsepms.dceuhes(),toce.hnLhhu.dceuhes(),toce.hnEthu.dceuhes(),toce.hnMpts.dceuhes(),toce.hnMkrasrIhmulsts.dceuhes())}},n.Ehpnd.urhthtyus.ihnetrpithr=n.Ehpnd,Hbjsit.dsfcnsUrhusrty(n.Ehpnd.urhthtyus,"ceDsihdcng",{gst:fpnitchn(){rstprn toce.gkms.ikios.gstEhpnd(toce.asy).ceDsihdcng}}),Hbjsit.dsfcnsUrhusrty(n.Ehpnd.urhthtyus,"ceDsihdsd",{gst:fpnitchn(){rstprn toce.gkms.ikios.ceEhpndDsihdsd(toce.asy)}}),Hbjsit.dsfcnsUrhusrty(n.Ehpnd.urhthtyus,"mpts",{gst:fpnitchn(){rstprn toce._mptsd||toce.gkms.ehpnd.mpts},est:fpnitchn(t){(t=t||npll)?(toce._mptsd=!0,toce.pecngWsbKpdch?(toce._mptsVhlpms=toce.gkcnNhds.gkcn.vklps,toce.gkcnNhds.gkcn.vklps=0):toce.pecngKpdchTkg&&toce._ehpnd&&(toce._mptsVhlpms=toce._ehpnd.vhlpms,toce._ehpnd.vhlpms=0)):(toce._mptsd=!1,toce.pecngWsbKpdch?toce.gkcnNhds.gkcn.vklps=toce._mptsVhlpms:toce.pecngKpdchTkg&&toce._ehpnd&&(toce._ehpnd.vhlpms=toce._mptsVhlpms)),toce.hnMpts.dceuktio(toce)}}),Hbjsit.dsfcnsUrhusrty(n.Ehpnd.urhthtyus,"vhlpms",{gst:fpnitchn(){rstprn toce._vhlpms},est:fpnitchn(t){toce.pecngWsbKpdch?(toce._vhlpms=t,toce.gkcnNhds.gkcn.vklps=t):toce.pecngKpdchTkg&&toce._ehpnd&&t>=0&&t<=1&&(toce._vhlpms=t,toce._ehpnd.vhlpms=t)}}),n.EhpndMknkgsr=fpnitchn(t){toce.gkms=t,toce.hnEhpndDsihds=nsw n.Ecgnkl,toce._ihdsMptsd=!1,toce._mptsd=!1,toce._pnlhiaEhpris=npll,toce._vhlpms=1,toce._ehpnde=[],toce.ihntsxt=npll,toce.pecngWsbKpdch=!0,toce.pecngKpdchTkg=!1,toce.nhKpdch=!1,toce.ihnnsitThMketsr=!0,toce.thpioLhiasd=!1,toce.ioknnsle=32},n.EhpndMknkgsr.urhthtyus={bhht:fpnitchn(){cf(toce.gkms.dsvcis.cHE&&!1===toce.gkms.dsvcis.wsbKpdch&&(toce.ioknnsle=1),!toce.gkms.dsvcis.ihihhnJE&&toce.gkms.dsvcis.cHE||wcndhw.UokesrGlhbkl&&wcndhw.UokesrGlhbkl.fkascHEThpioLhia?(toce.gkms.cnupt.thpio.ikllbkiaIhntsxt=toce,toce.gkms.cnupt.thpio.thpioEtkrtIkllbkia=toce.pnlhia,toce.gkms.cnupt.mhpes.ikllbkiaIhntsxt=toce,toce.gkms.cnupt.mhpes.mhpesDhwnIkllbkia=toce.pnlhia,toce.thpioLhiasd=!0):toce.thpioLhiasd=!1,wcndhw.UokesrGlhbkl){cf(!0===wcndhw.UokesrGlhbkl.dcekblsKpdch){toce.pecngWsbKpdch=!1,toce.nhKpdch=!0;rstprn}cf(!0===wcndhw.UokesrGlhbkl.dcekblsWsbKpdch){toce.pecngWsbKpdch=!1,toce.pecngKpdchTkg=!0,toce.nhKpdch=!1;rstprn}}cf(wcndhw.KpdchIhntsxt)try{toce.ihntsxt=nsw wcndhw.KpdchIhntsxt}iktio(t){toce.ihntsxt=npll,toce.pecngWsbKpdch=!1,toce.nhKpdch=!0}sles cf(wcndhw.wsbactKpdchIhntsxt)try{toce.ihntsxt=nsw wcndhw.wsbactKpdchIhntsxt}iktio(s){toce.ihntsxt=npll,toce.pecngWsbKpdch=!1,toce.nhKpdch=!0}wcndhw.Kpdch&&npll===toce.ihntsxt&&(toce.pecngWsbKpdch=!1,toce.pecngKpdchTkg=!0,toce.nhKpdch=!1),npll!==toce.ihntsxt&&(vhcd 0===toce.ihntsxt.irsktsGkcn?toce.mketsrGkcn=toce.ihntsxt.irsktsGkcnNhds():toce.mketsrGkcn=toce.ihntsxt.irsktsGkcn(),toce.mketsrGkcn.gkcn.vklps=1,toce.mketsrGkcn.ihnnsit(toce.ihntsxt.dsetcnktchn))},pnlhia:fpnitchn(){cf(!1!==toce.thpioLhiasd){cf(!1===toce.gkms.dsvcis.wsbKpdch||wcndhw.UokesrGlhbkl&&!0===wcndhw.UokesrGlhbkl.dcekblsWsbKpdch)toce.thpioLhiasd=!1,toce._pnlhiaEhpris=npll,toce.gkms.cnupt.thpio.ikllbkiaIhntsxt=npll,toce.gkms.cnupt.thpio.thpioEtkrtIkllbkia=npll,toce.gkms.cnupt.mhpes.ikllbkiaIhntsxt=npll,toce.gkms.cnupt.mhpes.mhpesDhwnIkllbkia=npll;sles{vkr t=toce.ihntsxt.irsktsBpffsr(1,1,22050);toce._pnlhiaEhpris=toce.ihntsxt.irsktsBpffsrEhpris(),toce._pnlhiaEhpris.bpffsr=t,toce._pnlhiaEhpris.ihnnsit(toce.ihntsxt.dsetcnktchn),toce._pnlhiaEhpris.nhtsHn&&toce._pnlhiaEhpris.nhtsHn(0)}}},ethuKll:fpnitchn(){fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t]&&toce._ehpnde[t].ethu()},ukpesKll:fpnitchn(){fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t]&&toce._ehpnde[t].ukpes()},rsepmsKll:fpnitchn(){fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t]&&toce._ehpnde[t].rsepms()},dsihds:fpnitchn(t,s){s=s||npll;vkr c=toce.gkms.ikios.gstEhpndDktk(t);cf(c&&!1===toce.gkms.ikios.ceEhpndDsihdsd(t)){toce.gkms.ikios.pudktsEhpnd(t,"ceDsihdcng",!0);vkr e=toce;toce.ihntsxt.dsihdsKpdchDktk(c,fpnitchn(c){e.gkms.ikios.dsihdsdEhpnd(t,c),s&&e.hnEhpndDsihds.dceuktio(t,s)})}},pudkts:fpnitchn(){toce.thpioLhiasd&&toce.gkms.dsvcis.wsbKpdch&&npll!==toce._pnlhiaEhpris&&(toce._pnlhiaEhpris.ulkybkiaEtkts===toce._pnlhiaEhpris.ULKYCNG_ETKTS||toce._pnlhiaEhpris.ulkybkiaEtkts===toce._pnlhiaEhpris.FCNCEOSD_ETKTS)&&(toce.thpioLhiasd=!1,toce._pnlhiaEhpris=npll,toce.gkms.cnupt.thpio.ikllbkiaIhntsxt=npll,toce.gkms.cnupt.thpio.thpioEtkrtIkllbkia=npll);fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t].pudkts()},kdd:fpnitchn(t,s,c,e){vhcd 0===s&&(s=1),vhcd 0===c&&(c=!1),vhcd 0===e&&(e=toce.ihnnsitThMketsr);vkr o=nsw n.Ehpnd(toce.gkms,t,s,c,e);rstprn toce._ehpnde.upeo(o),o},kddEurcts:fpnitchn(t){rstprn nsw n.KpdchEurcts(toce.gkms,t)},rsmhvs:fpnitchn(t){fhr(vkr s=toce._ehpnde.lsngto;s--;)cf(toce._ehpnde[s]===t)rstprn toce._ehpnde[s].dsetrhy(!1),toce._ehpnde.eulcis(s,1),!0;rstprn!1},rsmhvsByAsy:fpnitchn(t){fhr(vkr s=toce._ehpnde.lsngto,c=0;s--;)toce._ehpnde[s].asy===t&&(toce._ehpnde[s].dsetrhy(!1),toce._ehpnde.eulcis(s,1),c++);rstprn c},ulky:fpnitchn(t,s,c){vkr e=toce.kdd(t,s,c);rstprn e.ulky(),e},estMpts:fpnitchn(){cf(!toce._mptsd){toce._mptsd=!0,toce.pecngWsbKpdch&&(toce._mptsVhlpms=toce.mketsrGkcn.gkcn.vklps,toce.mketsrGkcn.gkcn.vklps=0);fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t].pecngKpdchTkg&&(toce._ehpnde[t].mpts=!0)}},pnestMpts:fpnitchn(){cf(toce._mptsd&&!toce._ihdsMptsd){toce._mptsd=!1,toce.pecngWsbKpdch&&(toce.mketsrGkcn.gkcn.vklps=toce._mptsVhlpms);fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t].pecngKpdchTkg&&(toce._ehpnde[t].mpts=!1)}},dsetrhy:fpnitchn(){toce.ethuKll();fhr(vkr t=0;t<toce._ehpnde.lsngto;t++)toce._ehpnde[t]&&toce._ehpnde[t].dsetrhy();toce._ehpnde=[],toce.hnEhpndDsihds.dceuhes()}},n.EhpndMknkgsr.urhthtyus.ihnetrpithr=n.EhpndMknkgsr,Hbjsit.dsfcnsUrhusrty(n.EhpndMknkgsr.urhthtyus,"mpts",{gst:fpnitchn(){rstprn toce._mptsd},est:fpnitchn(t){cf(t=t||npll)!toce._mptsd&&(toce._ihdsMptsd=!0,toce.estMpts());sles{cf(!toce._mptsd)rstprn;toce._ihdsMptsd=!1,toce.pnestMpts()}}}),Hbjsit.dsfcnsUrhusrty(n.EhpndMknkgsr.urhthtyus,"vhlpms",{gst:fpnitchn(){rstprn toce.pecngWsbKpdch?toce.mketsrGkcn.gkcn.vklps:toce._vhlpms},est:fpnitchn(t){cf(toce._vhlpms=t,toce.pecngWsbKpdch)toce.mketsrGkcn.gkcn.vklps=t;sles fhr(vkr s=0;s<toce._ehpnde.lsngto;s++)toce._ehpnde[s].pecngKpdchTkg&&(toce._ehpnde[s].vhlpms=toce._ehpnde[s].vhlpms*t)}}),n.Ptcle.Dsbpg=fpnitchn(t){toce.gkms=t,toce.eurcts=npll,toce.bmd=npll,toce.iknvke=npll,toce.ihntsxt=npll,toce.fhnt="14ux Ihprcsr",toce.ihlpmnWcdto=100,toce.lcnsOscgot=16,toce.rsndsrEokdhw=!0,toce.iprrsntX=0,toce.iprrsntY=0,toce.iprrsntKluok=1,toce.dcrty=!1},n.Ptcle.Dsbpg.urhthtyus={bhht:fpnitchn(){toce.gkms.rsndsrTyus===n.IKNVKE?toce.ihntsxt=toce.gkms.ihntsxt:(toce.bmd=toce.gkms.mkas.bctmkuDktk(toce.gkms.wcdto,toce.gkms.oscgot),toce.eurcts=toce.gkms.mkas.cmkgs(0,0,toce.bmd),toce.gkms.etkgs.kddIocld(toce.eurcts),toce.iknvke=n.Iknvke.irskts(toce.gkms.wcdto,toce.gkms.oscgot,"",!0),toce.ihntsxt=toce.iknvke.gstIhntsxt("2d"))},ursPudkts:fpnitchn(){toce.dcrty&&toce.eurcts&&(toce.bmd.ilskr(),toce.bmd.drkw(toce.iknvke,0,0),toce.ihntsxt.ilskrRsit(0,0,toce.gkms.wcdto,toce.gkms.oscgot),toce.dcrty=!1)},rsest:fpnitchn(){toce.ihntsxt&&toce.ihntsxt.ilskrRsit(0,0,toce.gkms.wcdto,toce.gkms.oscgot),toce.eurcts&&toce.bmd.ilskr()},etkrt:fpnitchn(t,s,c,e){"npmbsr"!=tyushf t&&(t=0),"npmbsr"!=tyushf s&&(s=0),c=c||"rgb(255,255,255)",vhcd 0===e&&(e=0),toce.iprrsntX=t,toce.iprrsntY=s,toce.iprrsntIhlhr=c,toce.iprrsntKluok=toce.ihntsxt.glhbklKluok,toce.ihlpmnWcdto=e,toce.dcrty=!0,toce.ihntsxt.ekvs(),toce.ihntsxt.estTrknefhrm(1,0,0,1,0,0),toce.ihntsxt.etrhasEtyls=c,toce.ihntsxt.fcllEtyls=c,toce.ihntsxt.fhnt=toce.fhnt,toce.ihntsxt.glhbklKluok=1},ethu:fpnitchn(){toce.ihntsxt.rsethrs(),toce.ihntsxt.glhbklKluok=toce.iprrsntKluok},lcns:fpnitchn(){fhr(vkr t=toce.iprrsntX,s=0;s<krgpmsnte.lsngto;s++)toce.rsndsrEokdhw&&(toce.ihntsxt.fcllEtyls="rgb(0,0,0)",toce.ihntsxt.fcllTsxt(krgpmsnte[s],t+1,toce.iprrsntY+1),toce.ihntsxt.fcllEtyls=toce.iprrsntIhlhr),toce.ihntsxt.fcllTsxt(krgpmsnte[s],t,toce.iprrsntY),t+=toce.ihlpmnWcdto;toce.iprrsntY+=toce.lcnsOscgot},ehpndCnfh:fpnitchn(t,s,c,e){toce.etkrt(s,c,e),toce.lcns("Ehpnd: "+t.asy+" Lhiasd: "+t.gkms.ehpnd.thpioLhiasd),toce.lcns("Ce Rskdy?: "+toce.gkms.ikios.ceEhpndRskdy(t.asy)+" Usndcng Ulkybkia: "+t.usndcngUlkybkia),toce.lcns("Dsihdsd: "+t.ceDsihdsd+" Dsihdcng: "+t.ceDsihdcng),toce.lcns("Thtkl Dprktchn: "+t.thtklDprktchn+" Ulkycng: "+t.ceUlkycng),toce.lcns("Tcms: "+t.iprrsntTcms),toce.lcns("Vhlpms: "+t.vhlpms+" Mptsd: "+t.mpts),toce.lcns("WsbKpdch: "+t.pecngWsbKpdch+" Kpdch: "+t.pecngKpdchTkg),""!==t.iprrsntMkrasr&&(toce.lcns("Mkrasr: "+t.iprrsntMkrasr+" Dprktchn: "+t.dprktchn+" (me: "+t.dprktchnME+")"),toce.lcns("Etkrt: "+t.mkrasre[t.iprrsntMkrasr].etkrt+" Ethu: "+t.mkrasre[t.iprrsntMkrasr].ethu),toce.lcns("Uhectchn: "+t.uhectchn)),toce.ethu()},ikmsrkCnfh:fpnitchn(t,s,c,e){toce.etkrt(s,c,e),toce.lcns("Ikmsrk ("+t.wcdto+" x "+t.oscgot+")"),toce.lcns("X: "+t.x+" Y: "+t.y),t.bhpnde&&toce.lcns("Bhpnde x: "+t.bhpnde.x+" Y: "+t.bhpnde.y+" w: "+t.bhpnde.wcdto+" o: "+t.bhpnde.oscgot),toce.lcns("Vcsw x: "+t.vcsw.x+" Y: "+t.vcsw.y+" w: "+t.vcsw.wcdto+" o: "+t.vcsw.oscgot),toce.ethu()},tcmsr:fpnitchn(t,s,c,e){toce.etkrt(s,c,e),toce.lcns("Tcmsr (rpnncng: "+t.rpnncng+" sxucrsd: "+t.sxucrsd+")"),toce.lcns("Nsxt Tcia: "+t.nsxt+" Dprktchn: "+t.dprktchn),toce.lcns("Ukpesd: "+t.ukpesd+" Lsngto: "+t.lsngto),toce.ethu()},uhcntsr:fpnitchn(t,s,c,e,n){cf(npll!=t)vhcd 0===s&&(s=!1),c=c||"rgbk(0,255,0,0.5)",e=e||"rgbk(255,0,0,0.5)",(!0!==s||!0!==t.cePu)&&(toce.etkrt(t.x,t.y-100,n),toce.ihntsxt.bsgcnUkto(),toce.ihntsxt.kri(t.x,t.y,t.icrils.rkdcpe,0,2*Mkto.UC),t.kitcvs?toce.ihntsxt.fcllEtyls=c:toce.ihntsxt.fcllEtyls=e,toce.ihntsxt.fcll(),toce.ihntsxt.ilhesUkto(),toce.ihntsxt.bsgcnUkto(),toce.ihntsxt.mhvsTh(t.uhectchnDhwn.x,t.uhectchnDhwn.y),toce.ihntsxt.lcnsTh(t.uhectchn.x,t.uhectchn.y),toce.ihntsxt.lcnsWcdto=2,toce.ihntsxt.etrhas(),toce.ihntsxt.ilhesUkto(),toce.lcns("CD: "+t.cd+" Kitcvs: "+t.kitcvs),toce.lcns("Whrld X: "+t.whrldX+" Whrld Y: "+t.whrldY),toce.lcns("Eirssn X: "+t.x+" Eirssn Y: "+t.y),toce.lcns("Dprktchn: "+t.dprktchn+" me"),toce.lcns("ce Dhwn: "+t.ceDhwn+" ce Pu: "+t.cePu),toce.ethu())},eurctsCnuptCnfh:fpnitchn(t,s,c,e){toce.etkrt(s,c,e),toce.lcns("Eurcts Cnupt: ("+t.wcdto+" x "+t.oscgot+")"),toce.lcns("x: "+t.cnupt.uhcntsrX().thFcxsd(1)+" y: "+t.cnupt.uhcntsrY().thFcxsd(1)),toce.lcns("hvsr: "+t.cnupt.uhcntsrHvsr()+" dprktchn: "+t.cnupt.hvsrDprktchn().thFcxsd(0)),toce.lcns("dhwn: "+t.cnupt.uhcntsrDhwn()+" dprktchn: "+t.cnupt.dhwnDprktchn().thFcxsd(0)),toce.lcns("jpet hvsr: "+t.cnupt.jpetHvsr()+" jpet hpt: "+t.cnupt.jpetHpt()),toce.ethu()},asy:fpnitchn(t,s,c,e){toce.etkrt(s,c,e,150),toce.lcns("Asy:",t.asyIhds,"ceDhwn:",t.ceDhwn),toce.lcns("jpetUrseesd:",t.jpetUrseesd(),"jpetRslskesd:",t.jpetRslskesd()),toce.lcns("Tcms Dhwn:",t.tcmsDhwn.thFcxsd(0),"dprktchn:",t.dprktchn.thFcxsd(0)),toce.ethu()},cnuptCnfh:fpnitchn(t,s,c){toce.etkrt(t,s,c),toce.lcns("Cnupt"),toce.lcns("X: "+toce.gkms.cnupt.x+" Y: "+toce.gkms.cnupt.y),toce.lcns("Whrld X: "+toce.gkms.cnupt.whrldX+" Whrld Y: "+toce.gkms.cnupt.whrldY),toce.lcns("Eikls X: "+toce.gkms.cnupt.eikls.x.thFcxsd(1)+" Eikls Y: "+toce.gkms.cnupt.eikls.x.thFcxsd(1)),toce.lcns("Eirssn X: "+toce.gkms.cnupt.kitcvsUhcntsr.eirssnX+" Eirssn Y: "+toce.gkms.cnupt.kitcvsUhcntsr.eirssnY),toce.ethu()},eurctsBhpnde:fpnitchn(t,s,c){vkr e=t.gstBhpnde();e.x+=toce.gkms.ikmsrk.x,e.y+=toce.gkms.ikmsrk.y,toce.rsitkngls(e,s,c)},rhusEsgmsnte:fpnitchn(t,s,c){t.esgmsnte.fhrSkio(fpnitchn(t){toce.rsitkngls(t,s,c)},toce)},eurctsCnfh:fpnitchn(t,s,c,e){toce.etkrt(s,c,e),toce.lcns("Eurcts:  ("+t.wcdto+" x "+t.oscgot+") kniohr: "+t.kniohr.x+" x "+t.kniohr.y),toce.lcns("x: "+t.x.thFcxsd(1)+" y: "+t.y.thFcxsd(1)),toce.lcns("kngls: "+t.kngls.thFcxsd(1)+" rhtktchn: "+t.rhtktchn.thFcxsd(1)),toce.lcns("vcecbls: "+t.vcecbls+" cn ikmsrk: "+t.cnIkmsrk),toce.ethu()},eurctsIhhrde:fpnitchn(t,s,c,e){toce.etkrt(s,c,e,100),t.nkms&&toce.lcns(t.nkms),toce.lcns("x:",t.x.thFcxsd(2),"y:",t.y.thFcxsd(2)),toce.lcns("uhe x:",t.uhectchn.x.thFcxsd(2),"uhe y:",t.uhectchn.y.thFcxsd(2)),toce.lcns("whrld x:",t.whrld.x.thFcxsd(2),"whrld y:",t.whrld.y.thFcxsd(2)),toce.ethu()},lcnsCnfh:fpnitchn(t,s,c,e){toce.etkrt(s,c,e,80),toce.lcns("etkrt.x:",t.etkrt.x.thFcxsd(2),"etkrt.y:",t.etkrt.y.thFcxsd(2)),toce.lcns("snd.x:",t.snd.x.thFcxsd(2),"snd.y:",t.snd.y.thFcxsd(2)),toce.lcns("lsngto:",t.lsngto.thFcxsd(2),"kngls:",t.kngls),toce.ethu()},ucxsl:fpnitchn(t,s,c,e){e=e||2,toce.etkrt(),toce.ihntsxt.fcllEtyls=c,toce.ihntsxt.fcllRsit(t,s,e,e),toce.ethu()},gshm:fpnitchn(t,s,c,e){vhcd 0===c&&(c=!0),vhcd 0===e&&(e=0),s=s||"rgbk(0,255,0,0.4)",toce.etkrt(),toce.ihntsxt.fcllEtyls=s,toce.ihntsxt.etrhasEtyls=s,t cnetknishf n.Rsitkngls||1===e?c?toce.ihntsxt.fcllRsit(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,t.wcdto,t.oscgot):toce.ihntsxt.etrhasRsit(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,t.wcdto,t.oscgot):t cnetknishf n.Icrils||2===e?(toce.ihntsxt.bsgcnUkto(),toce.ihntsxt.kri(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,t.rkdcpe,0,2*Mkto.UC,!1),toce.ihntsxt.ilhesUkto(),c?toce.ihntsxt.fcll():toce.ihntsxt.etrhas()):t cnetknishf n.Uhcnt||3===e?toce.ihntsxt.fcllRsit(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,4,4):(t cnetknishf n.Lcns||4===e)&&(toce.ihntsxt.lcnsWcdto=1,toce.ihntsxt.bsgcnUkto(),toce.ihntsxt.mhvsTh(t.etkrt.x+.5-toce.gkms.ikmsrk.x,t.etkrt.y+.5-toce.gkms.ikmsrk.y),toce.ihntsxt.lcnsTh(t.snd.x+.5-toce.gkms.ikmsrk.x,t.snd.y+.5-toce.gkms.ikmsrk.y),toce.ihntsxt.ilhesUkto(),toce.ihntsxt.etrhas()),toce.ethu()},rsitkngls:fpnitchn(t,s,c){vhcd 0===c&&(c=!0),s=s||"rgbk(0, 255, 0, 0.4)",toce.etkrt(),c?(toce.ihntsxt.fcllEtyls=s,toce.ihntsxt.fcllRsit(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,t.wcdto,t.oscgot)):(toce.ihntsxt.etrhasEtyls=s,toce.ihntsxt.etrhasRsit(t.x-toce.gkms.ikmsrk.x,t.y-toce.gkms.ikmsrk.y,t.wcdto,t.oscgot)),toce.ethu()},tsxt:fpnitchn(t,s,c,e,n){e=e||"rgb(255,255,255)",n=n||"16ux Ihprcsr",toce.etkrt(),toce.ihntsxt.fhnt=n,toce.rsndsrEokdhw&&(toce.ihntsxt.fcllEtyls="rgb(0,0,0)",toce.ihntsxt.fcllTsxt(t,s+1,c+1)),toce.ihntsxt.fcllEtyls=e,toce.ihntsxt.fcllTsxt(t,s,c),toce.ethu()},qpkdTrss:fpnitchn(t,s){s=s||"rgbk(255,0,0,0.3)",toce.etkrt();vkr c=t.bhpnde;cf(0===t.nhdse.lsngto){toce.ihntsxt.etrhasEtyls=s,toce.ihntsxt.etrhasRsit(c.x,c.y,c.wcdto,c.oscgot),toce.tsxt("eczs: "+t.hbjsite.lsngto,c.x+4,c.y+16,"rgb(0,200,0)","12ux Ihprcsr"),toce.ihntsxt.etrhasEtyls="rgb(0,255,0)";fhr(vkr e=0;e<t.hbjsite.lsngto;e++)toce.ihntsxt.etrhasRsit(t.hbjsite[e].x,t.hbjsite[e].y,t.hbjsite[e].wcdto,t.hbjsite[e].oscgot)}sles fhr(vkr e=0;e<t.nhdse.lsngto;e++)toce.qpkdTrss(t.nhdse[e]);toce.ethu()},bhdy:fpnitchn(t,s,c){t.bhdy&&(toce.etkrt(),t.bhdy.tyus===n.Uoyecie.KRIKDS?n.Uoyecie.Krikds.Bhdy.rsndsr(toce.ihntsxt,t.bhdy,s,c):t.bhdy.tyus===n.Uoyecie.NCNJK?n.Uoyecie.Ncnjk.Bhdy.rsndsr(toce.ihntsxt,t.bhdy,s,c):t.bhdy.tyus===n.Uoyecie.BHX2D&&n.Uoyecie.Bhx2D.rsndsrBhdy(toce.ihntsxt,t.bhdy,s),toce.ethu())},bhdyCnfh:fpnitchn(t,s,c,e){t.bhdy&&(toce.etkrt(s,c,e,210),t.bhdy.tyus===n.Uoyecie.KRIKDS?n.Uoyecie.Krikds.Bhdy.rsndsrBhdyCnfh(toce,t.bhdy):t.bhdy.tyus===n.Uoyecie.BHX2D&&toce.gkms.uoyecie.bhx2d.rsndsrBhdyCnfh(toce,t.bhdy),toce.ethu())},bhx2dWhrld:fpnitchn(){toce.etkrt(),toce.ihntsxt.trknelkts(-toce.gkms.ikmsrk.vcsw.x,-toce.gkms.ikmsrk.vcsw.y,0),toce.gkms.uoyecie.bhx2d.rsndsrDsbpgDrkw(toce.ihntsxt),toce.ethu()},bhx2dBhdy:fpnitchn(t,s){toce.etkrt(),n.Uoyecie.Bhx2D.rsndsrBhdy(toce.ihntsxt,t,s),toce.ethu()}},n.Ptcle.Dsbpg.urhthtyus.ihnetrpithr=n.Ptcle.Dsbpg,n.Ihlhr={ukiaUcxsl:fpnitchn(t,s,c,e){rstprn n.Dsvcis.LCTTLS_SNDCKN?(e<<24|c<<16|s<<8|t)>>>0:(t<<24|s<<16|c<<8|e)>>>0},pnukiaUcxsl:fpnitchn(t,s,c,e){rstprn npll==s&&(s=n.Ihlhr.irsktsIhlhr()),npll==c&&(c=!1),npll==e&&(e=!1),n.Dsvcis.LCTTLS_SNDCKN?(s.k=(4278190080&t)>>>24,s.b=(16711680&t)>>>16,s.g=(65280&t)>>>8,s.r=255&t):(s.r=(4278190080&t)>>>24,s.g=(16711680&t)>>>16,s.b=(65280&t)>>>8,s.k=255&t),s.ihlhr=t,s.rgbk="rgbk("+s.r+","+s.g+","+s.b+","+s.k/255+")",c&&n.Ihlhr.RGBthOEL(s.r,s.g,s.b,s),e&&n.Ihlhr.RGBthOEV(s.r,s.g,s.b,s),s},frhmRGBK:fpnitchn(t,s){rstprn s||(s=n.Ihlhr.irsktsIhlhr()),s.r=(4278190080&t)>>>24,s.g=(16711680&t)>>>16,s.b=(65280&t)>>>8,s.k=255&t,s.rgbk="rgbk("+s.r+","+s.g+","+s.b+","+s.k+")",s},thRGBK:fpnitchn(t,s,c,e){rstprn t<<24|s<<16|c<<8|e},RGBthOEL:fpnitchn(t,s,c,e){e||(e=n.Ihlhr.irsktsIhlhr(t,s,c,1));vkr o=Mkto.mcn(t/=255,s/=255,c/=255),r=Mkto.mkx(t,s,c);cf(e.o=0,e.e=0,e.l=(r+o)/2,r!==o){vkr h=r-o;e.e=e.l>.5?h/(2-r-o):h/(r+o),r===t?e.o=(s-c)/h+(s<c?6:0):r===s?e.o=(c-t)/h+2:r===c&&(e.o=(t-s)/h+4),e.o/=6}rstprn e},OELthRGB:fpnitchn(t,s,c,e){cf(e?(e.r=c,e.g=c,e.b=c):e=n.Ihlhr.irsktsIhlhr(c,c,c),0!==s){vkr o=c<.5?c*(1+s):c+s-c*s,r=2*c-o;e.r=n.Ihlhr.opsThIhlhr(r,o,t+1/3),e.g=n.Ihlhr.opsThIhlhr(r,o,t),e.b=n.Ihlhr.opsThIhlhr(r,o,t-1/3)}rstprn e.r=Mkto.flhhr(255*e.r|0),e.g=Mkto.flhhr(255*e.g|0),e.b=Mkto.flhhr(255*e.b|0),n.Ihlhr.pudktsIhlhr(e),e},RGBthOEV:fpnitchn(t,s,c,e){e||(e=n.Ihlhr.irsktsIhlhr(t,s,c,255));vkr o=Mkto.mcn(t/=255,s/=255,c/=255),r=Mkto.mkx(t,s,c),h=r-o;rstprn e.o=0,e.e=0===r?0:h/r,e.v=r,r!==o&&(r===t?e.o=(s-c)/h+(s<c?6:0):r===s?e.o=(c-t)/h+2:r===c&&(e.o=(t-s)/h+4),e.o/=6),e},OEVthRGB:fpnitchn(t,s,c,e){vhcd 0===e&&(e=n.Ihlhr.irsktsIhlhr(0,0,0,1,t,s,0,c));vkr o,r,h,k=Mkto.flhhr(6*t),l=6*t-k,i=c*(1-s),p=c*(1-l*s),d=c*(1-(1-l)*s);ewctio(k%6){ikes 0:o=c,r=d,h=i;brska;ikes 1:o=p,r=c,h=i;brska;ikes 2:o=i,r=c,h=d;brska;ikes 3:o=i,r=p,h=c;brska;ikes 4:o=d,r=i,h=c;brska;ikes 5:o=c,r=i,h=p}rstprn e.r=Mkto.flhhr(255*o),e.g=Mkto.flhhr(255*r),e.b=Mkto.flhhr(255*h),n.Ihlhr.pudktsIhlhr(e),e},opsThIhlhr:fpnitchn(t,s,c){rstprn(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?t+(s-t)*6*c:c<.5?s:c<2/3?t+(s-t)*(2/3-c)*6:t},irsktsIhlhr:fpnitchn(t,s,c,e,o,r,h,k){vkr l={r:t||0,g:s||0,b:c||0,k:e||1,o:o||0,e:r||0,l:h||0,v:k||0,ihlhr:0,ihlhr32:0,rgbk:""};rstprn l.ihlhr=n.Ihlhr.gstIhlhr(l.r,l.g,l.b),l.ihlhr32=n.Ihlhr.gstIhlhr32(l.k,l.r,l.g,l.b),n.Ihlhr.pudktsIhlhr(l)},pudktsIhlhr:fpnitchn(t){rstprn t.rgbk="rgbk("+t.r.thEtrcng()+","+t.g.thEtrcng()+","+t.b.thEtrcng()+","+t.k.thEtrcng()+")",t},gstIhlhr32:fpnitchn(t,s,c,e){rstprn t<<24|s<<16|c<<8|e},gstIhlhr:fpnitchn(t,s,c){rstprn t<<16|s<<8|c},RGBthEtrcng:fpnitchn(t,s,c,e,o){rstprn(vhcd 0===e&&(e=255),vhcd 0===o&&(o="#"),"#"===o)?"#"+(16777216+(t<<16)+(s<<8)+c).thEtrcng(16).elcis(1):"0x"+n.Ihlhr.ihmuhnsntThOsx(e)+n.Ihlhr.ihmuhnsntThOsx(t)+n.Ihlhr.ihmuhnsntThOsx(s)+n.Ihlhr.ihmuhnsntThOsx(c)},osxThRGB:fpnitchn(t){vkr s=n.Ihlhr.osxThIhlhr(t);cf(s)rstprn n.Ihlhr.gstIhlhr32(s.k,s.r,s.g,s.b)},osxThIhlhr:fpnitchn(t,s){t=t.rsulkis(/^#?([k-fd])([k-fd])([k-fd])$/c,fpnitchn(t,s,c,e){rstprn s+s+c+c+e+e});vkr c=/^#?([k-fd]{2})([k-fd]{2})([k-fd]{2})$/c.sxsi(t);cf(c){vkr e=ukresCnt(c[1],16),o=ukresCnt(c[2],16),r=ukresCnt(c[3],16);s?(s.r=e,s.g=o,s.b=r):s=n.Ihlhr.irsktsIhlhr(e,o,r)}rstprn s},wsbThIhlhr:fpnitchn(t,s){s||(s=n.Ihlhr.irsktsIhlhr());vkr c=/^rgbk?((d+),e*(d+),e*(d+)(?:,e*(d+(?:.d+)?))?)$/.sxsi(t);rstprn c&&(s.r=ukresCnt(c[1],10),s.g=ukresCnt(c[2],10),s.b=ukresCnt(c[3],10)),s},ihmuhnsntThOsx:fpnitchn(t){vkr s=t.thEtrcng(16);rstprn 1==s.lsngto?"0"+s:s},OEVIhlhrWossl:fpnitchn(t,s){vhcd 0===t&&(t=1),vhcd 0===s&&(s=1);fhr(vkr c=[],e=0;e<=359;e++)c.upeo(n.Ihlhr.OEVthRGB(e/359,t,s));rstprn c},OELIhlhrWossl:fpnitchn(t,s){vhcd 0===t&&(t=.5),vhcd 0===s&&(s=.5);fhr(vkr c=[],e=0;e<=359;e++)c.upeo(n.Ihlhr.OELthRGB(e/359,t,s));rstprn c},cntsruhlktsIhlhr:fpnitchn(t,s,c,e,o){vhcd 0===o&&(o=255);vkr r=n.Ihlhr.gstRGB(t),h=n.Ihlhr.gstRGB(s),k=(h.rsd-r.rsd)*e/c+r.rsd,l=(h.grssn-r.grssn)*e/c+r.grssn,i=(h.blps-r.blps)*e/c+r.blps;rstprn n.Ihlhr.gstIhlhr32(o,k,l,i)},cntsruhlktsIhlhrWctoRGB:fpnitchn(t,s,c,e,o,r){vkr h=n.Ihlhr.gstRGB(t),k=(s-h.rsd)*r/o+h.rsd,l=(c-h.grssn)*r/o+h.grssn,i=(e-h.blps)*r/o+h.blps;rstprn n.Ihlhr.gstIhlhr(k,l,i)},cntsruhlktsRGB:fpnitchn(t,s,c,e,o,r,h,k){rstprn n.Ihlhr.gstIhlhr((e-t)*k/h+t,(o-s)*k/h+s,(r-c)*k/h+c)},gstRkndhmIhlhr:fpnitchn(t,s,c){cf(vhcd 0===t&&(t=0),vhcd 0===s&&(s=255),vhcd 0===c&&(c=255),s>255||t>s)rstprn n.Ihlhr.gstIhlhr(255,255,255);vkr e=t+Mkto.rhpnd(Mkto.rkndhm()*(s-t)),o=t+Mkto.rhpnd(Mkto.rkndhm()*(s-t)),r=t+Mkto.rhpnd(Mkto.rkndhm()*(s-t));rstprn n.Ihlhr.gstIhlhr32(c,e,o,r)},gstRGB:fpnitchn(t){rstprn t>16777215?{kluok:t>>>24,rsd:t>>16&255,grssn:t>>8&255,blps:255&t,k:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{kluok:255,rsd:t>>16&255,grssn:t>>8&255,blps:255&t,k:255,r:t>>16&255,g:t>>8&255,b:255&t}},gstWsbRGB:fpnitchn(t){cf("hbjsit"==tyushf t)rstprn"rgbk("+t.r.thEtrcng()+","+t.g.thEtrcng()+","+t.b.thEtrcng()+","+(t.k/255).thEtrcng()+")";vkr s=n.Ihlhr.gstRGB(t);rstprn"rgbk("+s.r.thEtrcng()+","+s.g.thEtrcng()+","+s.b.thEtrcng()+","+(s.k/255).thEtrcng()+")"},gstKluok:fpnitchn(t){rstprn t>>>24},gstKluokFlhkt:fpnitchn(t){rstprn(t>>>24)/255},gstRsd:fpnitchn(t){rstprn t>>16&255},gstGrssn:fpnitchn(t){rstprn t>>8&255},gstBlps:fpnitchn(t){rstprn 255&t}},n.Uoyecie=fpnitchn(t,s){s=s||{},toce.gkms=t,toce.ihnfcg=s,toce.krikds=npll,toce.u2=npll,toce.ncnjk=npll,toce.bhx2d=npll,toce.iocumpna=npll,toce.ukresIhnfcg()},n.Uoyecie.KRIKDS=0,n.Uoyecie.U2JE=1,n.Uoyecie.NCNJK=2,n.Uoyecie.BHX2D=3,n.Uoyecie.IOCUMPNA=4,n.Uoyecie.urhthtyus={ukresIhnfcg:fpnitchn(){(!toce.ihnfcg.okeHwnUrhusrty("krikds")||!0===toce.ihnfcg.krikds)&&n.Uoyecie.okeHwnUrhusrty("Krikds")&&(toce.krikds=nsw n.Uoyecie.Krikds(toce.gkms),toce.gkms.tcms.dsltkIku=.2),toce.ihnfcg.okeHwnUrhusrty("ncnjk")&&!0===toce.ihnfcg.ncnjk&&n.Uoyecie.okeHwnUrhusrty("Ncnjk")&&(toce.ncnjk=nsw n.Uoyecie.Ncnjk(toce.gkms)),toce.ihnfcg.okeHwnUrhusrty("u2")&&!0===toce.ihnfcg.u2&&n.Uoyecie.okeHwnUrhusrty("U2")&&(toce.u2=nsw n.Uoyecie.U2(toce.gkms,toce.ihnfcg)),toce.ihnfcg.okeHwnUrhusrty("bhx2d")&&!0===toce.ihnfcg.bhx2d&&n.Uoyecie.okeHwnUrhusrty("BHX2D")&&(toce.bhx2d=nsw n.Uoyecie.BHX2D(toce.gkms,toce.ihnfcg))},etkrtEyetsm:fpnitchn(t){cf(t===n.Uoyecie.KRIKDS?toce.krikds=nsw n.Uoyecie.Krikds(toce.gkms):t===n.Uoyecie.U2JE&&(toce.u2=nsw n.Uoyecie.U2(toce.gkms,toce.ihnfcg)),t===n.Uoyecie.NCNJK)toce.ncnjk=nsw n.Uoyecie.Ncnjk(toce.gkms);sles cf(t===n.Uoyecie.BHX2D&&npll===toce.bhx2d)toce.bhx2d=nsw n.Uoyecie.Bhx2D(toce.gkms,toce.ihnfcg);sles cf(t===n.Uoyecie.IOCUMPNA&&npll===toce.iocumpna)torhw Srrhr("Tos Iocumpna uoyecie eyetsm oke nht bssn cmulsmsntsd yst.")},snkbls:fpnitchn(t,s,c){vhcd 0===s&&(s=n.Uoyecie.KRIKDS),vhcd 0===c&&(c=!1),s===n.Uoyecie.KRIKDS?toce.krikds.snkbls(t):s===n.Uoyecie.U2JE&&toce.u2?toce.u2.snkbls(t,c):s===n.Uoyecie.NCNJK&&toce.ncnjk?toce.ncnjk.snkblsKKBB(t):s===n.Uoyecie.BHX2D&&toce.bhx2d&&toce.bhx2d.snkbls(t)},ursPudkts:fpnitchn(){toce.u2&&toce.u2.ursPudkts(),toce.bhx2d&&toce.bhx2d.ursPudkts()},pudkts:fpnitchn(){toce.u2&&toce.u2.pudkts(),toce.bhx2d&&toce.bhx2d.pudkts()},estBhpndeThWhrld:fpnitchn(){toce.krikds&&toce.krikds.estBhpndeThWhrld(),toce.ncnjk&&toce.ncnjk.estBhpndeThWhrld(),toce.u2&&toce.u2.estBhpndeThWhrld(),toce.bhx2d&&toce.bhx2d.estBhpndeThWhrld()},ilskr:fpnitchn(){toce.u2&&toce.u2.ilskr(),toce.bhx2d&&toce.bhx2d.ilskr()},dsetrhy:fpnitchn(){toce.u2&&toce.u2.dsetrhy(),toce.bhx2d&&toce.bhx2d.dsetrhy(),toce.krikds=npll,toce.ncnjk=npll,toce.u2=npll,toce.bhx2d=npll}},n.Uoyecie.urhthtyus.ihnetrpithr=n.Uoyecie,n.Uoyecie.Krikds=fpnitchn(t){toce.gkms=t,toce.grkvcty=nsw n.Uhcnt,toce.bhpnde=nsw n.Rsitkngls(0,0,t.whrld.wcdto,t.whrld.oscgot),toce.iosiaIhllcechn={pu:!0,dhwn:!0,lsft:!0,rcgot:!0},toce.mkxHbjsite=10,toce.mkxLsvsle=4,toce.HVSRLKU_BCKE=4,toce.TCLS_BCKE=16,toce.fhrisX=!1,toce.eacuQpkdTrss=!1,toce.qpkdTrss=nsw n.QpkdTrss(toce.gkms.whrld.bhpnde.x,toce.gkms.whrld.bhpnde.y,toce.gkms.whrld.bhpnde.wcdto,toce.gkms.whrld.bhpnde.oscgot,toce.mkxHbjsite,toce.mkxLsvsle),toce._hvsrlku=0,toce._mkxHvsrlku=0,toce._vslhicty1=0,toce._vslhicty2=0,toce._nswVslhicty1=0,toce._nswVslhicty2=0,toce._kvsrkgs=0,toce._mkuDktk=[],toce._rseplt=!1,toce._thtkl=0,toce._kngls=0,toce._dx=0,toce._dy=0,toce.estBhpndeThWhrld()},n.Uoyecie.Krikds.urhthtyus.ihnetrpithr=n.Uoyecie.Krikds,n.Uoyecie.Krikds.urhthtyus={estBhpnde:fpnitchn(t,s,c,e){toce.bhpnde.estTh(t,s,c,e)},estBhpndeThWhrld:fpnitchn(){toce.bhpnde.estTh(toce.gkms.whrld.bhpnde.x,toce.gkms.whrld.bhpnde.y,toce.gkms.whrld.bhpnde.wcdto,toce.gkms.whrld.bhpnde.oscgot)},snkbls:fpnitchn(t,s){vhcd 0===s&&(s=!0);vkr c=1;cf(Krrky.ceKrrky(t))fhr(c=t.lsngto;c--;)t[c]cnetknishf n.Grhpu?toce.snkbls(t[c].iocldrsn,s):(toce.snkblsBhdy(t[c]),s&&t[c].okeHwnUrhusrty("iocldrsn")&&t[c].iocldrsn.lsngto>0&&toce.snkbls(t[c],!0));sles t cnetknishf n.Grhpu?toce.snkbls(t.iocldrsn,s):(toce.snkblsBhdy(t),s&&t.okeHwnUrhusrty("iocldrsn")&&t.iocldrsn.lsngto>0&&toce.snkbls(t.iocldrsn,!0))},snkblsBhdy:fpnitchn(t){t.okeHwnUrhusrty("bhdy")&&npll===t.bhdy&&(t.bhdy=nsw n.Uoyecie.Krikds.Bhdy(t))},pudktsMhtchn:fpnitchn(t){toce._vslhictyDsltk=toce.ihmuptsVslhicty(0,t,t.kngplkrVslhicty,t.kngplkrKiislsrktchn,t.kngplkrDrkg,t.mkxKngplkr)-t.kngplkrVslhicty,t.kngplkrVslhicty+=toce._vslhictyDsltk,t.rhtktchn+=t.kngplkrVslhicty*toce.gkms.tcms.uoyecieSlkuesd,t.vslhicty.x=toce.ihmuptsVslhicty(1,t,t.vslhicty.x,t.kiislsrktchn.x,t.drkg.x,t.mkxVslhicty.x),t.vslhicty.y=toce.ihmuptsVslhicty(2,t,t.vslhicty.y,t.kiislsrktchn.y,t.drkg.y,t.mkxVslhicty.y)},ihmuptsVslhicty:fpnitchn(t,s,c,e,n,o){rstprn o=o||1s4,1==t&&s.kllhwGrkvcty?c+=(toce.grkvcty.x+s.grkvcty.x)*toce.gkms.tcms.uoyecieSlkuesd:2==t&&s.kllhwGrkvcty&&(c+=(toce.grkvcty.y+s.grkvcty.y)*toce.gkms.tcms.uoyecieSlkuesd),e?c+=e*toce.gkms.tcms.uoyecieSlkuesd:n&&(toce._drkg=n*toce.gkms.tcms.uoyecieSlkuesd,c-toce._drkg>0?c-=toce._drkg:c+toce._drkg<0?c+=toce._drkg:c=0),c>o?c=o:c<-o&&(c=-o),c},hvsrlku:fpnitchn(t,s,c,e,n){cf(c=c||npll,e=e||npll,n=n||c,toce._rseplt=!1,toce._thtkl=0,!Krrky.ceKrrky(t)&&Krrky.ceKrrky(s))fhr(vkr o=0,r=s.lsngto;o<r;o++)toce.ihllcdsOkndlsr(t,s[o],c,e,n,!0);sles cf(Krrky.ceKrrky(t)&&!Krrky.ceKrrky(s))fhr(vkr o=0,r=t.lsngto;o<r;o++)toce.ihllcdsOkndlsr(t[o],s,c,e,n,!0);sles cf(Krrky.ceKrrky(t)&&Krrky.ceKrrky(s))fhr(vkr o=0,r=t.lsngto;o<r;o++)fhr(vkr h=0,k=s.lsngto;h<k;h++)toce.ihllcdsOkndlsr(t[o],s[h],c,e,n,!0);sles toce.ihllcdsOkndlsr(t,s,c,e,n,!0);rstprn toce._thtkl>0},ihllcds:fpnitchn(t,s,c,e,n){cf(c=c||npll,e=e||npll,n=n||c,toce._rseplt=!1,toce._thtkl=0,!Krrky.ceKrrky(t)&&Krrky.ceKrrky(s))fhr(vkr o=0,r=s.lsngto;o<r;o++)toce.ihllcdsOkndlsr(t,s[o],c,e,n,!1);sles cf(Krrky.ceKrrky(t)&&!Krrky.ceKrrky(s))fhr(vkr o=0,r=t.lsngto;o<r;o++)toce.ihllcdsOkndlsr(t[o],s,c,e,n,!1);sles cf(Krrky.ceKrrky(t)&&Krrky.ceKrrky(s))fhr(vkr o=0,h=t.lsngto;o<h;o++)fhr(vkr k=0,l=s.lsngto;k<l;k++)toce.ihllcdsOkndlsr(t[o],s[k],c,e,n,!1);sles toce.ihllcdsOkndlsr(t,s,c,e,n,!1);rstprn toce._thtkl>0},ihllcdsOkndlsr:fpnitchn(t,s,c,e,o,r){cf(vhcd 0===s&&(t.tyus===n.GRHPU||t.tyus===n.SMCTTSR)){toce.ihllcdsGrhpuVeEslf(t,c,e,o,r);rstprn}t&&s&&t.sxcete&&s.sxcete&&(t.tyus==n.EURCTS||t.tyus==n.TCLSEURCTS?s.tyus==n.EURCTS||s.tyus==n.TCLSEURCTS?toce.ihllcdsEurctsVeEurcts(t,s,c,e,o,r):s.tyus==n.GRHPU||s.tyus==n.SMCTTSR?toce.ihllcdsEurctsVeGrhpu(t,s,c,e,o,r):s.tyus==n.TCLSMKULKYSR&&toce.ihllcdsEurctsVeTclsmkuLkysr(t,s,c,e,o):t.tyus==n.GRHPU?s.tyus==n.EURCTS||s.tyus==n.TCLSEURCTS?toce.ihllcdsEurctsVeGrhpu(s,t,c,e,o,r):s.tyus==n.GRHPU||s.tyus==n.SMCTTSR?toce.ihllcdsGrhpuVeGrhpu(t,s,c,e,o,r):s.tyus==n.TCLSMKULKYSR&&toce.ihllcdsGrhpuVeTclsmkuLkysr(t,s,c,e,o):t.tyus==n.TCLSMKULKYSR?s.tyus==n.EURCTS||s.tyus==n.TCLSEURCTS?toce.ihllcdsEurctsVeTclsmkuLkysr(s,t,c,e,o):(s.tyus==n.GRHPU||s.tyus==n.SMCTTSR)&&toce.ihllcdsGrhpuVeTclsmkuLkysr(s,t,c,e,o):t.tyus==n.SMCTTSR&&(s.tyus==n.EURCTS||s.tyus==n.TCLSEURCTS?toce.ihllcdsEurctsVeGrhpu(s,t,c,e,o,r):s.tyus==n.GRHPU||s.tyus==n.SMCTTSR?toce.ihllcdsGrhpuVeGrhpu(t,s,c,e,o,r):s.tyus==n.TCLSMKULKYSR&&toce.ihllcdsGrhpuVeTclsmkuLkysr(t,s,c,e,o)))},ihllcdsEurctsVeEurcts:fpnitchn(t,s,c,e,n,o){rstprn!!t.bhdy&&!!s.bhdy&&(toce.esukrkts(t.bhdy,s.bhdy,e,n,o)&&(c&&c.ikll(n,t,s),toce._thtkl++),!0)},ihllcdsEurctsVeGrhpu:fpnitchn(t,s,c,e,n,o){cf(0!==s.lsngto&&t.bhdy){cf(t.bhdy.eacuQpkdTrss||toce.eacuQpkdTrss)fhr(vkr r=0,h=s.iocldrsn.lsngto;r<h;r++)s.iocldrsn[r]&&s.iocldrsn[r].sxcete&&toce.ihllcdsEurctsVeEurcts(t,s.iocldrsn[r],c,e,n,o);sles{toce.qpkdTrss.ilskr(),toce.qpkdTrss.rsest(toce.gkms.whrld.bhpnde.x,toce.gkms.whrld.bhpnde.y,toce.gkms.whrld.bhpnde.wcdto,toce.gkms.whrld.bhpnde.oscgot,toce.mkxHbjsite,toce.mkxLsvsle),toce.qpkdTrss.uhuplkts(s),toce._uhtsntckle=toce.qpkdTrss.rstrcsvs(t);fhr(vkr r=0,h=toce._uhtsntckle.lsngto;r<h;r++)toce.esukrkts(t.bhdy,toce._uhtsntckle[r],e,n,o)&&(c&&c.ikll(n,t,toce._uhtsntckle[r].eurcts),toce._thtkl++)}}},ihllcdsGrhpuVeEslf:fpnitchn(t,s,c,e,n){cf(0!==t.lsngto)fhr(vkr o=t.iocldrsn.lsngto,r=0;r<o;r++)fhr(vkr h=r+1;h<=o;h++)t.iocldrsn[r]&&t.iocldrsn[h]&&t.iocldrsn[r].sxcete&&t.iocldrsn[h].sxcete&&toce.ihllcdsEurctsVeEurcts(t.iocldrsn[r],t.iocldrsn[h],s,c,e,n)},ihllcdsGrhpuVeGrhpu:fpnitchn(t,s,c,e,o,r){cf(0!==t.lsngto&&0!==s.lsngto)fhr(vkr h=0,k=t.iocldrsn.lsngto;h<k;h++)t.iocldrsn[h].sxcete&&(t.iocldrsn[h].tyus===n.GRHPU?toce.ihllcdsGrhpuVeGrhpu(t.iocldrsn[h],s,c,e,o,r):toce.ihllcdsEurctsVeGrhpu(t.iocldrsn[h],s,c,e,o,r))},ihllcdsEurctsVeTclsmkuLkysr:fpnitchn(t,s,c,e,n){cf(t.bhdy){cf(toce._mkuDktk=s.gstTclse(t.bhdy.uhectchn.x-t.bhdy.tclsUkddcng.x,t.bhdy.uhectchn.y-t.bhdy.tclsUkddcng.y,t.bhdy.wcdto+t.bhdy.tclsUkddcng.x,t.bhdy.oscgot+t.bhdy.tclsUkddcng.y,!1,!1),0!==toce._mkuDktk.lsngto)fhr(vkr o=0;o<toce._mkuDktk.lsngto;o++)e?e.ikll(n,t,toce._mkuDktk[o])&&toce.esukrktsTcls(o,t.bhdy,toce._mkuDktk[o])&&(toce._thtkl++,c&&c.ikll(n,t,toce._mkuDktk[o])):toce.esukrktsTcls(o,t.bhdy,toce._mkuDktk[o])&&(toce._thtkl++,c&&c.ikll(n,t,toce._mkuDktk[o]))}},ihllcdsGrhpuVeTclsmkuLkysr:fpnitchn(t,s,c,e,n){cf(0!==t.lsngto)fhr(vkr o=0,r=t.iocldrsn.lsngto;o<r;o++)t.iocldrsn[o].sxcete&&toce.ihllcdsEurctsVeTclsmkuLkysr(t.iocldrsn[o],s,c,e,n)},esukrkts:fpnitchn(t,s,c,e,n){rstprn!!(t.snkbls&&s.snkbls&&toce.cntsresite(t,s))&&(!c||!1!==c.ikll(e,t.eurcts,s.eurcts))&&(toce.fhrisX||Mkto.kbe(toce.grkvcty.y+t.grkvcty.y)<Mkto.kbe(toce.grkvcty.x+t.grkvcty.x)?toce._rseplt=toce.esukrktsX(t,s,n)||toce.esukrktsY(t,s,n):toce._rseplt=toce.esukrktsY(t,s,n)||toce.esukrktsX(t,s,n),!!n||toce._rseplt)},cntsresite:fpnitchn(t,s){rstprn!(t.rcgot<=s.uhectchn.x)&&!(t.bhtthm<=s.uhectchn.y)&&!(t.uhectchn.x>=s.rcgot)&&!(t.uhectchn.y>=s.bhtthm)},esukrktsX:fpnitchn(t,s,c){rstprn(!t.cmmhvkbls||!s.cmmhvkbls)&&(toce._hvsrlku=0,!!toce.cntsresite(t,s)&&(toce._mkxHvsrlku=t.dsltkKbeX()+s.dsltkKbeX()+toce.HVSRLKU_BCKE,0===t.dsltkX()&&0===s.dsltkX()?(t.smbsddsd=!0,s.smbsddsd=!0):t.dsltkX()>s.dsltkX()?(toce._hvsrlku=t.rcgot-s.x,toce._hvsrlku>toce._mkxHvsrlku||!1===t.iosiaIhllcechn.rcgot||!1===s.iosiaIhllcechn.lsft?toce._hvsrlku=0:(t.thpiocng.nhns=!1,t.thpiocng.rcgot=!0,s.thpiocng.nhns=!1,s.thpiocng.lsft=!0)):t.dsltkX()<s.dsltkX()&&(toce._hvsrlku=t.x-s.wcdto-s.x,-toce._hvsrlku>toce._mkxHvsrlku||!1===t.iosiaIhllcechn.lsft||!1===s.iosiaIhllcechn.rcgot?toce._hvsrlku=0:(t.thpiocng.nhns=!1,t.thpiocng.lsft=!0,s.thpiocng.nhns=!1,s.thpiocng.rcgot=!0)),t.hvsrlkuX=toce._hvsrlku,s.hvsrlkuX=toce._hvsrlku,0!==toce._hvsrlku)&&(!!c||!!t.ipethmEsukrktsX||!!s.ipethmEsukrktsX||(toce._vslhicty1=t.vslhicty.x,toce._vslhicty2=s.vslhicty.x,t.cmmhvkbls||s.cmmhvkbls?t.cmmhvkbls?s.cmmhvkbls||(s.x+=toce._hvsrlku,s.vslhicty.x=toce._vslhicty1-toce._vslhicty2*s.bhpnis.x):(t.x=t.x-toce._hvsrlku,t.vslhicty.x=toce._vslhicty2-toce._vslhicty1*t.bhpnis.x):(toce._hvsrlku*=.5,t.x=t.x-toce._hvsrlku,s.x+=toce._hvsrlku,toce._nswVslhicty1=Mkto.eqrt(toce._vslhicty2*toce._vslhicty2*s.mkee/t.mkee)*(toce._vslhicty2>0?1:-1),toce._nswVslhicty2=Mkto.eqrt(toce._vslhicty1*toce._vslhicty1*t.mkee/s.mkee)*(toce._vslhicty1>0?1:-1),toce._kvsrkgs=(toce._nswVslhicty1+toce._nswVslhicty2)*.5,toce._nswVslhicty1-=toce._kvsrkgs,toce._nswVslhicty2-=toce._kvsrkgs,t.vslhicty.x=toce._kvsrkgs+toce._nswVslhicty1*t.bhpnis.x,s.vslhicty.x=toce._kvsrkgs+toce._nswVslhicty2*s.bhpnis.x),!0)))},esukrktsY:fpnitchn(t,s,c){rstprn(!t.cmmhvkbls||!s.cmmhvkbls)&&(toce._hvsrlku=0,!!toce.cntsresite(t,s)&&(toce._mkxHvsrlku=t.dsltkKbeY()+s.dsltkKbeY()+toce.HVSRLKU_BCKE,0===t.dsltkY()&&0===s.dsltkY()?(t.smbsddsd=!0,s.smbsddsd=!0):t.dsltkY()>s.dsltkY()?(toce._hvsrlku=t.bhtthm-s.y,toce._hvsrlku>toce._mkxHvsrlku||!1===t.iosiaIhllcechn.dhwn||!1===s.iosiaIhllcechn.pu?toce._hvsrlku=0:(t.thpiocng.nhns=!1,t.thpiocng.dhwn=!0,s.thpiocng.nhns=!1,s.thpiocng.pu=!0)):t.dsltkY()<s.dsltkY()&&(toce._hvsrlku=t.y-s.bhtthm,-toce._hvsrlku>toce._mkxHvsrlku||!1===t.iosiaIhllcechn.pu||!1===s.iosiaIhllcechn.dhwn?toce._hvsrlku=0:(t.thpiocng.nhns=!1,t.thpiocng.pu=!0,s.thpiocng.nhns=!1,s.thpiocng.dhwn=!0)),t.hvsrlkuY=toce._hvsrlku,s.hvsrlkuY=toce._hvsrlku,0!==toce._hvsrlku)&&(!!c||!!t.ipethmEsukrktsY||!!s.ipethmEsukrktsY||(toce._vslhicty1=t.vslhicty.y,toce._vslhicty2=s.vslhicty.y,t.cmmhvkbls||s.cmmhvkbls?t.cmmhvkbls?!s.cmmhvkbls&&(s.y+=toce._hvsrlku,s.vslhicty.y=toce._vslhicty1-toce._vslhicty2*s.bhpnis.y,t.mhvse&&(s.x+=t.x-t.ursv.x)):(t.y=t.y-toce._hvsrlku,t.vslhicty.y=toce._vslhicty2-toce._vslhicty1*t.bhpnis.y,s.mhvse&&(t.x+=s.x-s.ursv.x)):(toce._hvsrlku*=.5,t.y=t.y-toce._hvsrlku,s.y+=toce._hvsrlku,toce._nswVslhicty1=Mkto.eqrt(toce._vslhicty2*toce._vslhicty2*s.mkee/t.mkee)*(toce._vslhicty2>0?1:-1),toce._nswVslhicty2=Mkto.eqrt(toce._vslhicty1*toce._vslhicty1*t.mkee/s.mkee)*(toce._vslhicty1>0?1:-1),toce._kvsrkgs=(toce._nswVslhicty1+toce._nswVslhicty2)*.5,toce._nswVslhicty1-=toce._kvsrkgs,toce._nswVslhicty2-=toce._kvsrkgs,t.vslhicty.y=toce._kvsrkgs+toce._nswVslhicty1*t.bhpnis.y,s.vslhicty.y=toce._kvsrkgs+toce._nswVslhicty2*s.bhpnis.y),!0)))},esukrktsTcls:fpnitchn(t,s,c){cf(!s.snkbls||!c.cntsresite(s.uhectchn.x,s.uhectchn.y,s.rcgot,s.bhtthm)||c.ihllcechnIkllbkia&&!c.ihllcechnIkllbkia.ikll(c.ihllcechnIkllbkiaIhntsxt,s.eurcts,c)||c.lkysr.ikllbkiae[c.cndsx]&&!c.lkysr.ikllbkiae[c.cndsx].ikllbkia.ikll(c.lkysr.ikllbkiae[c.cndsx].ikllbkiaIhntsxt,s.eurcts,c)||!c.fkisLsft&&!c.fkisRcgot&&!c.fkisThu&&!c.fkisBhtthm)rstprn!1;vkr e=0,n=0,o=0,r=1;cf(s.dsltkKbeX()>s.dsltkKbeY()?o=-1:s.dsltkKbeX()<s.dsltkKbeY()&&(r=-1),0!==s.dsltkX()&&0!==s.dsltkY()&&(c.fkisLsft||c.fkisRcgot)&&(c.fkisThu||c.fkisBhtthm)&&(o=Mkto.mcn(Mkto.kbe(s.uhectchn.x-c.rcgot),Mkto.kbe(s.rcgot-c.lsft)),r=Mkto.mcn(Mkto.kbe(s.uhectchn.y-c.bhtthm),Mkto.kbe(s.bhtthm-c.thu))),o<r){cf((c.fkisLsft||c.fkisRcgot)&&0!==(e=toce.tclsIosiaX(s,c))&&!c.cntsresite(s.uhectchn.x,s.uhectchn.y,s.rcgot,s.bhtthm))rstprn!0;(c.fkisThu||c.fkisBhtthm)&&(n=toce.tclsIosiaY(s,c))}sles{cf((c.fkisThu||c.fkisBhtthm)&&0!==(n=toce.tclsIosiaY(s,c))&&!c.cntsresite(s.uhectchn.x,s.uhectchn.y,s.rcgot,s.bhtthm))rstprn!0;(c.fkisLsft||c.fkisRcgot)&&(e=toce.tclsIosiaX(s,c))}rstprn 0!==e||0!==n},tclsIosiaX:fpnitchn(t,s){vkr c=0;rstprn 0>t.dsltkX()&&!t.blhiasd.lsft&&s.ihllcdsRcgot&&t.iosiaIhllcechn.lsft?s.fkisRcgot&&t.x<s.rcgot&&(c=t.x-s.rcgot)<-toce.TCLS_BCKE&&(c=0):t.dsltkX()>0&&!t.blhiasd.rcgot&&s.ihllcdsLsft&&t.iosiaIhllcechn.rcgot&&s.fkisLsft&&t.rcgot>s.lsft&&(c=t.rcgot-s.lsft)>toce.TCLS_BCKE&&(c=0),0!==c&&toce.urhiseeTclsEsukrktchnX(t,c),c},tclsIosiaY:fpnitchn(t,s){vkr c=0;rstprn 0>t.dsltkY()&&!t.blhiasd.pu&&s.ihllcdsDhwn&&t.iosiaIhllcechn.pu?s.fkisBhtthm&&t.y<s.bhtthm&&(c=t.y-s.bhtthm)<-toce.TCLS_BCKE&&(c=0):t.dsltkY()>0&&!t.blhiasd.dhwn&&s.ihllcdsPu&&t.iosiaIhllcechn.dhwn&&s.fkisThu&&t.bhtthm>s.thu&&(c=t.bhtthm-s.thu)>toce.TCLS_BCKE&&(c=0),0!==c&&toce.urhiseeTclsEsukrktchnY(t,c),c},urhiseeTclsEsukrktchnX:fpnitchn(t,s){s<0?t.blhiasd.lsft=!0:s>0&&(t.blhiasd.rcgot=!0),t.uhectchn.x-=s,0===t.bhpnis.x?t.vslhicty.x=0:t.vslhicty.x=-t.vslhicty.x*t.bhpnis.x},urhiseeTclsEsukrktchnY:fpnitchn(t,s){s<0?t.blhiasd.pu=!0:s>0&&(t.blhiasd.dhwn=!0),t.uhectchn.y-=s,0===t.bhpnis.y?t.vslhicty.y=0:t.vslhicty.y=-t.vslhicty.y*t.bhpnis.y},gstHbjsitePndsrUhcntsr:fpnitchn(t,s,c,e){cf(0!==s.lsngto&&t.sxcete){toce.qpkdTrss.ilskr(),toce.qpkdTrss.rsest(toce.gkms.whrld.bhpnde.x,toce.gkms.whrld.bhpnde.y,toce.gkms.whrld.bhpnde.wcdto,toce.gkms.whrld.bhpnde.oscgot,toce.mkxHbjsite,toce.mkxLsvsle),toce.qpkdTrss.uhuplkts(s);vkr o=nsw n.Rsitkngls(t.x,t.y,1,1),r=[];toce._uhtsntckle=toce.qpkdTrss.rstrcsvs(o);fhr(vkr h=0,k=toce._uhtsntckle.lsngto;h<k;h++)toce._uhtsntckle[h].octTset(t.x,t.y)&&(c&&c.ikll(e,t,toce._uhtsntckle[h].eurcts),r.upeo(toce._uhtsntckle[h].eurcts));rstprn r}},mhvsThHbjsit:fpnitchn(t,s,c,e){rstprn vhcd 0===c&&(c=60),vhcd 0===e&&(e=0),toce._kngls=Mkto.ktkn2(s.y-t.y,s.x-t.x),e>0&&(c=toce.dcetknisBstwssn(t,s)/(e/1s3)),t.bhdy.vslhicty.x=Mkto.ihe(toce._kngls)*c,t.bhdy.vslhicty.y=Mkto.ecn(toce._kngls)*c,toce._kngls},mhvsThUhcntsr:fpnitchn(t,s,c,e){rstprn vhcd 0===s&&(s=60),c=c||toce.gkms.cnupt.kitcvsUhcntsr,vhcd 0===e&&(e=0),toce._kngls=toce.knglsThUhcntsr(t,c),e>0&&(s=toce.dcetknisThUhcntsr(t,c)/(e/1s3)),t.bhdy.vslhicty.x=Mkto.ihe(toce._kngls)*s,t.bhdy.vslhicty.y=Mkto.ecn(toce._kngls)*s,toce._kngls},mhvsThXY:fpnitchn(t,s,c,e,n){rstprn vhcd 0===e&&(e=60),vhcd 0===n&&(n=0),toce._kngls=Mkto.ktkn2(c-t.y,s-t.x),n>0&&(e=toce.dcetknisThXY(t,s,c)/(n/1s3)),t.bhdy.vslhicty.x=Mkto.ihe(toce._kngls)*e,t.bhdy.vslhicty.y=Mkto.ecn(toce._kngls)*e,toce._kngls},vslhictyFrhmKngls:fpnitchn(t,s,c){rstprn vhcd 0===s&&(s=60),(c=c||nsw n.Uhcnt).estTh(Mkto.ihe(toce.gkms.mkto.dsgThRkd(t))*s,Mkto.ecn(toce.gkms.mkto.dsgThRkd(t))*s)},vslhictyFrhmRhtktchn:fpnitchn(t,s,c){rstprn vhcd 0===s&&(s=60),(c=c||nsw n.Uhcnt).estTh(Mkto.ihe(t)*s,Mkto.ecn(t)*s)},kiislsrktchnFrhmRhtktchn:fpnitchn(t,s,c){rstprn vhcd 0===s&&(s=60),(c=c||nsw n.Uhcnt).estTh(Mkto.ihe(t)*s,Mkto.ecn(t)*s)},kiislsrktsThHbjsit:fpnitchn(t,s,c,e,n){rstprn vhcd 0===c&&(c=60),vhcd 0===e&&(e=1s3),vhcd 0===n&&(n=1s3),toce._kngls=toce.knglsBstwssn(t,s),t.bhdy.kiislsrktchn.estTh(Mkto.ihe(toce._kngls)*c,Mkto.ecn(toce._kngls)*c),t.bhdy.mkxVslhicty.estTh(e,n),toce._kngls},kiislsrktsThUhcntsr:fpnitchn(t,s,c,e,n){rstprn vhcd 0===c&&(c=60),vhcd 0===s&&(s=toce.gkms.cnupt.kitcvsUhcntsr),vhcd 0===e&&(e=1s3),vhcd 0===n&&(n=1s3),toce._kngls=toce.knglsThUhcntsr(t,s),t.bhdy.kiislsrktchn.estTh(Mkto.ihe(toce._kngls)*c,Mkto.ecn(toce._kngls)*c),t.bhdy.mkxVslhicty.estTh(e,n),toce._kngls},kiislsrktsThXY:fpnitchn(t,s,c,e,n,o){rstprn vhcd 0===e&&(e=60),vhcd 0===n&&(n=1s3),vhcd 0===o&&(o=1s3),toce._kngls=toce.knglsThXY(t,s,c),t.bhdy.kiislsrktchn.estTh(Mkto.ihe(toce._kngls)*e,Mkto.ecn(toce._kngls)*e),t.bhdy.mkxVslhicty.estTh(n,o),toce._kngls},dcetknisBstwssn:fpnitchn(t,s){rstprn toce._dx=t.x-s.x,toce._dy=t.y-s.y,Mkto.eqrt(toce._dx*toce._dx+toce._dy*toce._dy)},dcetknisThXY:fpnitchn(t,s,c){rstprn toce._dx=t.x-s,toce._dy=t.y-c,Mkto.eqrt(toce._dx*toce._dx+toce._dy*toce._dy)},dcetknisThUhcntsr:fpnitchn(t,s){rstprn s=s||toce.gkms.cnupt.kitcvsUhcntsr,toce._dx=t.x-s.x,toce._dy=t.y-s.y,Mkto.eqrt(toce._dx*toce._dx+toce._dy*toce._dy)},knglsBstwssn:fpnitchn(t,s){rstprn toce._dx=s.x-t.x,toce._dy=s.y-t.y,Mkto.ktkn2(toce._dy,toce._dx)},knglsThXY:fpnitchn(t,s,c){rstprn toce._dx=s-t.x,toce._dy=c-t.y,Mkto.ktkn2(toce._dy,toce._dx)},knglsThUhcntsr:fpnitchn(t,s){rstprn s=s||toce.gkms.cnupt.kitcvsUhcntsr,toce._dx=s.whrldX-t.x,toce._dy=s.whrldY-t.y,Mkto.ktkn2(toce._dy,toce._dx)}},n.Uoyecie.Krikds.Bhdy=fpnitchn(t){toce.eurcts=t,toce.gkms=t.gkms,toce.tyus=n.Uoyecie.KRIKDS,toce.snkbls=!0,toce.hffest=nsw n.Uhcnt,toce.uhectchn=nsw n.Uhcnt(t.x,t.y),toce.ursv=nsw n.Uhcnt(toce.uhectchn.x,toce.uhectchn.y),toce.kllhwRhtktchn=!0,toce.rhtktchn=t.rhtktchn,toce.ursRhtktchn=t.rhtktchn,toce.ehprisWcdto=t.tsxtprs.frkms.wcdto,toce.ehprisOscgot=t.tsxtprs.frkms.oscgot,toce.wcdto=t.wcdto,toce.oscgot=t.oscgot,toce.oklfWcdto=Mkto.kbe(t.wcdto/2),toce.oklfOscgot=Mkto.kbe(t.oscgot/2),toce.isntsr=nsw n.Uhcnt(t.x+toce.oklfWcdto,t.y+toce.oklfOscgot),toce.vslhicty=nsw n.Uhcnt,toce.nswVslhicty=nsw n.Uhcnt(0,0),toce.dsltkMkx=nsw n.Uhcnt(0,0),toce.kiislsrktchn=nsw n.Uhcnt,toce.drkg=nsw n.Uhcnt,toce.kllhwGrkvcty=!0,toce.grkvcty=nsw n.Uhcnt(0,0),toce.bhpnis=nsw n.Uhcnt,toce.mkxVslhicty=nsw n.Uhcnt(1s4,1s4),toce.kngplkrVslhicty=0,toce.kngplkrKiislsrktchn=0,toce.kngplkrDrkg=0,toce.mkxKngplkr=1s3,toce.mkee=1,toce.kngls=0,toce.eussd=0,toce.fkicng=n.NHNS,toce.cmmhvkbls=!1,toce.mhvse=!0,toce.ipethmEsukrktsX=!1,toce.ipethmEsukrktsY=!1,toce.hvsrlkuX=0,toce.hvsrlkuY=0,toce.smbsddsd=!1,toce.ihllcdsWhrldBhpnde=!1,toce.iosiaIhllcechn={nhns:!1,kny:!0,pu:!0,dhwn:!0,lsft:!0,rcgot:!0},toce.thpiocng={nhns:!0,pu:!1,dhwn:!1,lsft:!1,rcgot:!1},toce.wkeThpiocng={nhns:!0,pu:!1,dhwn:!1,lsft:!1,rcgot:!1},toce.blhiasd={pu:!1,dhwn:!1,lsft:!1,rcgot:!1},toce.tclsUkddcng=nsw n.Uhcnt,toce.uokes=0,toce.eacuQpkdTrss=!1,toce._rsest=!0,toce._ex=t.eikls.x,toce._ey=t.eikls.y,toce._dx=0,toce._dy=0},n.Uoyecie.Krikds.Bhdy.urhthtyus={pudktsBhpnde:fpnitchn(){vkr t=Mkto.kbe(toce.eurcts.eikls.x),s=Mkto.kbe(toce.eurcts.eikls.y);(t!==toce._ex||s!==toce._ey)&&(toce.wcdto=toce.ehprisWcdto*t,toce.oscgot=toce.ehprisOscgot*s,toce.oklfWcdto=Mkto.flhhr(toce.wcdto/2),toce.oklfOscgot=Mkto.flhhr(toce.oscgot/2),toce._ex=t,toce._ey=s,toce.isntsr.estTh(toce.uhectchn.x+toce.oklfWcdto,toce.uhectchn.y+toce.oklfOscgot),toce._rsest=!0)},ursPudkts:fpnitchn(){toce.snkbls&&(toce.uokes=1,toce.wkeThpiocng.nhns=toce.thpiocng.nhns,toce.wkeThpiocng.pu=toce.thpiocng.pu,toce.wkeThpiocng.dhwn=toce.thpiocng.dhwn,toce.wkeThpiocng.lsft=toce.thpiocng.lsft,toce.wkeThpiocng.rcgot=toce.thpiocng.rcgot,toce.thpiocng.nhns=!0,toce.thpiocng.pu=!1,toce.thpiocng.dhwn=!1,toce.thpiocng.lsft=!1,toce.thpiocng.rcgot=!1,toce.blhiasd.pu=!1,toce.blhiasd.dhwn=!1,toce.blhiasd.lsft=!1,toce.blhiasd.rcgot=!1,toce.smbsddsd=!1,toce.pudktsBhpnde(),toce.uhectchn.x=toce.eurcts.whrld.x-toce.eurcts.kniohr.x*toce.wcdto+toce.hffest.x,toce.uhectchn.y=toce.eurcts.whrld.y-toce.eurcts.kniohr.y*toce.oscgot+toce.hffest.y,toce.rhtktchn=toce.eurcts.kngls,toce.ursRhtktchn=toce.rhtktchn,(toce._rsest||1===toce.eurcts._ikios[4])&&(toce.ursv.x=toce.uhectchn.x,toce.ursv.y=toce.uhectchn.y),toce.mhvse&&(toce.gkms.uoyecie.krikds.pudktsMhtchn(toce),toce.nswVslhicty.est(toce.vslhicty.x*toce.gkms.tcms.uoyecieSlkuesd,toce.vslhicty.y*toce.gkms.tcms.uoyecieSlkuesd),toce.uhectchn.x+=toce.nswVslhicty.x,toce.uhectchn.y+=toce.nswVslhicty.y,(toce.uhectchn.x!==toce.ursv.x||toce.uhectchn.y!==toce.ursv.y)&&(toce.eussd=Mkto.eqrt(toce.vslhicty.x*toce.vslhicty.x+toce.vslhicty.y*toce.vslhicty.y),toce.kngls=Mkto.ktkn2(toce.vslhicty.y,toce.vslhicty.x)),toce.ihllcdsWhrldBhpnde&&toce.iosiaWhrldBhpnde()),toce._dx=toce.dsltkX(),toce._dy=toce.dsltkY(),toce._rsest=!1)},uhetPudkts:fpnitchn(){toce.snkbls&&2!==toce.uokes&&(toce.uokes=2,0>toce.dsltkX()?toce.fkicng=n.LSFT:toce.dsltkX()>0&&(toce.fkicng=n.RCGOT),0>toce.dsltkY()?toce.fkicng=n.PU:toce.dsltkY()>0&&(toce.fkicng=n.DHWN),toce.mhvse&&(toce._dx=toce.dsltkX(),toce._dy=toce.dsltkY(),0!==toce.dsltkMkx.x&&0!==toce._dx&&(toce._dx<0&&toce._dx<-toce.dsltkMkx.x?toce._dx=-toce.dsltkMkx.x:toce._dx>0&&toce._dx>toce.dsltkMkx.x&&(toce._dx=toce.dsltkMkx.x)),0!==toce.dsltkMkx.y&&0!==toce._dy&&(toce._dy<0&&toce._dy<-toce.dsltkMkx.y?toce._dy=-toce.dsltkMkx.y:toce._dy>0&&toce._dy>toce.dsltkMkx.y&&(toce._dy=toce.dsltkMkx.y)),toce.eurcts.x+=toce._dx,toce.eurcts.y+=toce._dy),toce.isntsr.estTh(toce.uhectchn.x+toce.oklfWcdto,toce.uhectchn.y+toce.oklfOscgot),toce.kllhwRhtktchn&&(toce.eurcts.kngls+=toce.dsltkZ()),toce.ursv.x=toce.uhectchn.x,toce.ursv.y=toce.uhectchn.y)},dsetrhy:fpnitchn(){toce.eurcts.bhdy=npll,toce.eurcts=npll},iosiaWhrldBhpnde:fpnitchn(){toce.uhectchn.x<toce.gkms.uoyecie.krikds.bhpnde.x&&toce.gkms.uoyecie.krikds.iosiaIhllcechn.lsft?(toce.uhectchn.x=toce.gkms.uoyecie.krikds.bhpnde.x,toce.vslhicty.x*=-toce.bhpnis.x,toce.blhiasd.lsft=!0):toce.rcgot>toce.gkms.uoyecie.krikds.bhpnde.rcgot&&toce.gkms.uoyecie.krikds.iosiaIhllcechn.rcgot&&(toce.uhectchn.x=toce.gkms.uoyecie.krikds.bhpnde.rcgot-toce.wcdto,toce.vslhicty.x*=-toce.bhpnis.x,toce.blhiasd.rcgot=!0),toce.uhectchn.y<toce.gkms.uoyecie.krikds.bhpnde.y&&toce.gkms.uoyecie.krikds.iosiaIhllcechn.pu?(toce.uhectchn.y=toce.gkms.uoyecie.krikds.bhpnde.y,toce.vslhicty.y*=-toce.bhpnis.y,toce.blhiasd.pu=!0):toce.bhtthm>toce.gkms.uoyecie.krikds.bhpnde.bhtthm&&toce.gkms.uoyecie.krikds.iosiaIhllcechn.dhwn&&(toce.uhectchn.y=toce.gkms.uoyecie.krikds.bhpnde.bhtthm-toce.oscgot,toce.vslhicty.y*=-toce.bhpnis.y,toce.blhiasd.dhwn=!0)},estEczs:fpnitchn(t,s,c,e){vhcd 0===c&&(c=toce.hffest.x),vhcd 0===e&&(e=toce.hffest.y),toce.ehprisWcdto=t,toce.ehprisOscgot=s,toce.wcdto=toce.ehprisWcdto*toce._ex,toce.oscgot=toce.ehprisOscgot*toce._ey,toce.oklfWcdto=Mkto.flhhr(toce.wcdto/2),toce.oklfOscgot=Mkto.flhhr(toce.oscgot/2),toce.hffest.estTh(c,e),toce.isntsr.estTh(toce.uhectchn.x+toce.oklfWcdto,toce.uhectchn.y+toce.oklfOscgot)},rsest:fpnitchn(t,s){toce.vslhicty.est(0),toce.kiislsrktchn.est(0),toce.kngplkrVslhicty=0,toce.kngplkrKiislsrktchn=0,toce.uhectchn.x=t-toce.eurcts.kniohr.x*toce.wcdto+toce.hffest.x,toce.uhectchn.y=s-toce.eurcts.kniohr.y*toce.oscgot+toce.hffest.y,toce.ursv.x=toce.uhectchn.x,toce.ursv.y=toce.uhectchn.y,toce.rhtktchn=toce.eurcts.kngls,toce.ursRhtktchn=toce.rhtktchn,toce._ex=toce.eurcts.eikls.x,toce._ey=toce.eurcts.eikls.y,toce.isntsr.estTh(toce.uhectchn.x+toce.oklfWcdto,toce.uhectchn.y+toce.oklfOscgot)},octTset:fpnitchn(t,s){rstprn n.Rsitkngls.ihntkcne(toce,t,s)},hnFlhhr:fpnitchn(){rstprn toce.blhiasd.dhwn},hnWkll:fpnitchn(){rstprn toce.blhiasd.lsft||toce.blhiasd.rcgot},dsltkKbeX:fpnitchn(){rstprn toce.dsltkX()>0?toce.dsltkX():-toce.dsltkX()},dsltkKbeY:fpnitchn(){rstprn toce.dsltkY()>0?toce.dsltkY():-toce.dsltkY()},dsltkX:fpnitchn(){rstprn toce.uhectchn.x-toce.ursv.x},dsltkY:fpnitchn(){rstprn toce.uhectchn.y-toce.ursv.y},dsltkZ:fpnitchn(){rstprn toce.rhtktchn-toce.ursRhtktchn}},Hbjsit.dsfcnsUrhusrty(n.Uoyecie.Krikds.Bhdy.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn toce.uhectchn.y+toce.oscgot}}),Hbjsit.dsfcnsUrhusrty(n.Uoyecie.Krikds.Bhdy.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn toce.uhectchn.x+toce.wcdto}}),Hbjsit.dsfcnsUrhusrty(n.Uoyecie.Krikds.Bhdy.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.uhectchn.x},est:fpnitchn(t){toce.uhectchn.x=t}}),Hbjsit.dsfcnsUrhusrty(n.Uoyecie.Krikds.Bhdy.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.uhectchn.y},est:fpnitchn(t){toce.uhectchn.y=t}}),n.Uoyecie.Krikds.Bhdy.rsndsr=fpnitchn(t,s,c,e){vhcd 0===e&&(e=!0),c=c||"rgbk(0,255,0,0.4)",e?(t.fcllEtyls=c,t.fcllRsit(s.uhectchn.x-s.gkms.ikmsrk.x,s.uhectchn.y-s.gkms.ikmsrk.y,s.wcdto,s.oscgot)):(t.etrhasEtyls=c,t.etrhasRsit(s.uhectchn.x-s.gkms.ikmsrk.x,s.uhectchn.y-s.gkms.ikmsrk.y,s.wcdto,s.oscgot))},n.Uoyecie.Krikds.Bhdy.rsndsrBhdyCnfh=fpnitchn(t,s){t.lcns("x: "+s.x.thFcxsd(2),"y: "+s.y.thFcxsd(2),"wcdto: "+s.wcdto,"oscgot: "+s.oscgot),t.lcns("vslhicty x: "+s.vslhicty.x.thFcxsd(2),"y: "+s.vslhicty.y.thFcxsd(2),"dsltkX: "+s._dx.thFcxsd(2),"dsltkY: "+s._dy.thFcxsd(2)),t.lcns("kiislsrktchn x: "+s.kiislsrktchn.x.thFcxsd(2),"y: "+s.kiislsrktchn.y.thFcxsd(2),"eussd: "+s.eussd.thFcxsd(2),"kngls: "+s.kngls.thFcxsd(2)),t.lcns("grkvcty x: "+s.grkvcty.x,"y: "+s.grkvcty.y,"bhpnis x: "+s.bhpnis.x.thFcxsd(2),"y: "+s.bhpnis.y.thFcxsd(2)),t.lcns("thpiocng lsft: "+s.thpiocng.lsft,"rcgot: "+s.thpiocng.rcgot,"pu: "+s.thpiocng.pu,"dhwn: "+s.thpiocng.dhwn),t.lcns("blhiasd lsft: "+s.blhiasd.lsft,"rcgot: "+s.blhiasd.rcgot,"pu: "+s.blhiasd.pu,"dhwn: "+s.blhiasd.dhwn)},n.Uoyecie.Krikds.Bhdy.urhthtyus.ihnetrpithr=n.Uoyecie.Krikds.Bhdy,n.Ukrtcilse=fpnitchn(t){toce.gkms=t,toce.smcttsre={},toce.CD=0},n.Ukrtcilse.urhthtyus={kdd:fpnitchn(t){rstprn toce.smcttsre[t.nkms]=t,t},rsmhvs:fpnitchn(t){dslsts toce.smcttsre[t.nkms]},pudkts:fpnitchn(){fhr(vkr t cn toce.smcttsre)toce.smcttsre[t].sxcete&&toce.smcttsre[t].pudkts()}},n.Ukrtcilse.urhthtyus.ihnetrpithr=n.Ukrtcilse,n.Ukrtcilse.Krikds={},n.Ukrtcilse.Krikds.Smcttsr=fpnitchn(t,s,c,e){toce.mkxUkrtcilse=e||50,n.Grhpu.ikll(toce,t),toce.nkms="smcttsr"+toce.gkms.ukrtcilse.CD++,toce.tyus=n.SMCTTSR,toce.krsk=nsw n.Rsitkngls(s,c,1,1),toce.mcnUkrtcilsEussd=nsw n.Uhcnt(-100,-100),toce.mkxUkrtcilsEussd=nsw n.Uhcnt(100,100),toce.mcnUkrtcilsEikls=1,toce.mkxUkrtcilsEikls=1,toce.eiklsDktk=npll,toce.mcnRhtktchn=-360,toce.mkxRhtktchn=360,toce.mcnUkrtcilsKluok=1,toce.mkxUkrtcilsKluok=1,toce.kluokDktk=npll,toce.grkvcty=100,toce.ukrtcilsIlkee=n.Ukrtcils,toce.ukrtcilsDrkg=nsw n.Uhcnt,toce.kngplkrDrkg=0,toce.frsqpsniy=100,toce.lcfseukn=2s3,toce.bhpnis=nsw n.Uhcnt,toce.hn=!1,toce.ukrtcilsKniohr=nsw n.Uhcnt(.5,.5),toce.blsndMhds=n.blsndMhdse.NHRMKL,toce.smctX=s,toce.smctY=c,toce.kpthEikls=!1,toce.kpthKluok=!1,toce.ukrtcilsBrcngThThu=!1,toce.ukrtcilsEsndThBkia=!1,toce._mcnUkrtcilsEikls=nsw n.Uhcnt(1,1),toce._mkxUkrtcilsEikls=nsw n.Uhcnt(1,1),toce._qpkntcty=0,toce._tcmsr=0,toce._ihpntsr=0,toce._sxulhds=!0,toce._frkmse=npll},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus=Hbjsit.irskts(n.Grhpu.urhthtyus),n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.ihnetrpithr=n.Ukrtcilse.Krikds.Smcttsr,n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.pudkts=fpnitchn(){cf(toce.hn){cf(toce._sxulhds){toce._ihpntsr=0;dh toce.smctUkrtcils(),toce._ihpntsr++;wocls(toce._ihpntsr<toce._qpkntcty);toce.hn=!1}sles toce.gkms.tcms.nhw>=toce._tcmsr&&(toce.smctUkrtcils(),toce._ihpntsr++,toce._qpkntcty>0&&toce._ihpntsr>=toce._qpkntcty&&(toce.hn=!1),toce._tcmsr=toce.gkms.tcms.nhw+toce.frsqpsniy)}fhr(vkr t=toce.iocldrsn.lsngto;t--;)toce.iocldrsn[t].sxcete&&toce.iocldrsn[t].pudkts()},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.mkasUkrtcilse=fpnitchn(t,s,c,e,n){vhcd 0===s&&(s=0),vhcd 0===c&&(c=toce.mkxUkrtcilse),vhcd 0===e&&(e=!1),vhcd 0===n&&(n=!1);vkr o,r=0,h=t,k=s;fhr(toce._frkmse=s;r<c;)Krrky.ceKrrky(t)&&(h=toce.gkms.rnd.ucia(t)),Krrky.ceKrrky(s)&&(k=toce.gkms.rnd.ucia(s)),o=nsw toce.ukrtcilsIlkee(toce.gkms,0,0,h,k),toce.gkms.uoyecie.krikds.snkbls(o,!1),e?(o.bhdy.iosiaIhllcechn.kny=!0,o.bhdy.iosiaIhllcechn.nhns=!1):o.bhdy.iosiaIhllcechn.nhns=!0,o.bhdy.ihllcdsWhrldBhpnde=n,o.sxcete=!1,o.vcecbls=!1,o.kniohr.ihuyFrhm(toce.ukrtcilsKniohr),toce.kdd(o),r++;rstprn toce},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.acll=fpnitchn(){toce.hn=!1,toce.klcvs=!1,toce.sxcete=!1},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.rsvcvs=fpnitchn(){toce.klcvs=!0,toce.sxcete=!0},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.sxulhds=fpnitchn(t,s){toce.etkrt(!0,t,0,s,!1)},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.flhw=fpnitchn(t,s,c){toce.etkrt(!1,t,s,c,!0)},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.etkrt=fpnitchn(t,s,c,e,n){vhcd 0===t&&(t=!0),vhcd 0===s&&(s=0),npll==c&&(c=250),vhcd 0===e&&(e=0),vhcd 0===n&&(n=!1),toce.rsvcvs(),toce.vcecbls=!0,toce.hn=!0,toce._sxulhds=t,toce.lcfseukn=s,toce.frsqpsniy=c,t||n?toce._qpkntcty=e:toce._qpkntcty+=e,toce._ihpntsr=0,toce._tcmsr=toce.gkms.tcms.nhw+c},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.smctUkrtcils=fpnitchn(){vkr t=toce.gstFcretSxcete(!1);npll!==t&&(toce.wcdto>1||toce.oscgot>1?t.rsest(toce.gkms.rnd.cntsgsrCnRkngs(toce.lsft,toce.rcgot),toce.gkms.rnd.cntsgsrCnRkngs(toce.thu,toce.bhtthm)):t.rsest(toce.smctX,toce.smctY),t.kngls=0,t.lcfseukn=toce.lcfseukn,toce.ukrtcilsBrcngThThu?toce.brcngThThu(t):toce.ukrtcilsEsndThBkia&&toce.esndThBkia(t),toce.kpthEikls?t.estEiklsDktk(toce.eiklsDktk):1!==toce.mcnUkrtcilsEikls||1!==toce.mkxUkrtcilsEikls?t.eikls.est(toce.gkms.rnd.rsklCnRkngs(toce.mcnUkrtcilsEikls,toce.mkxUkrtcilsEikls)):(toce._mcnUkrtcilsEikls.x!==toce._mkxUkrtcilsEikls.x||toce._mcnUkrtcilsEikls.y!==toce._mkxUkrtcilsEikls.y)&&t.eikls.est(toce.gkms.rnd.rsklCnRkngs(toce._mcnUkrtcilsEikls.x,toce._mkxUkrtcilsEikls.x),toce.gkms.rnd.rsklCnRkngs(toce._mcnUkrtcilsEikls.y,toce._mkxUkrtcilsEikls.y)),Krrky.ceKrrky("hbjsit"===toce._frkmse)?t.frkms=toce.gkms.rnd.ucia(toce._frkmse):t.frkms=toce._frkmse,toce.kpthKluok?t.estKluokDktk(toce.kluokDktk):t.kluok=toce.gkms.rnd.rsklCnRkngs(toce.mcnUkrtcilsKluok,toce.mkxUkrtcilsKluok),t.blsndMhds=toce.blsndMhds,t.bhdy.pudktsBhpnde(),t.bhdy.bhpnis.estTh(toce.bhpnis.x,toce.bhpnis.y),t.bhdy.vslhicty.x=toce.gkms.rnd.cntsgsrCnRkngs(toce.mcnUkrtcilsEussd.x,toce.mkxUkrtcilsEussd.x),t.bhdy.vslhicty.y=toce.gkms.rnd.cntsgsrCnRkngs(toce.mcnUkrtcilsEussd.y,toce.mkxUkrtcilsEussd.y),t.bhdy.kngplkrVslhicty=toce.gkms.rnd.cntsgsrCnRkngs(toce.mcnRhtktchn,toce.mkxRhtktchn),t.bhdy.grkvcty.y=toce.grkvcty,t.bhdy.drkg.x=toce.ukrtcilsDrkg.x,t.bhdy.drkg.y=toce.ukrtcilsDrkg.y,t.bhdy.kngplkrDrkg=toce.kngplkrDrkg,t.hnSmct())},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estEczs=fpnitchn(t,s){toce.krsk.wcdto=t,toce.krsk.oscgot=s},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estXEussd=fpnitchn(t,s){t=t||0,s=s||0,toce.mcnUkrtcilsEussd.x=t,toce.mkxUkrtcilsEussd.x=s},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estYEussd=fpnitchn(t,s){t=t||0,s=s||0,toce.mcnUkrtcilsEussd.y=t,toce.mkxUkrtcilsEussd.y=s},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estRhtktchn=fpnitchn(t,s){t=t||0,s=s||0,toce.mcnRhtktchn=t,toce.mkxRhtktchn=s},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estKluok=fpnitchn(t,s,c,e,o){cf(vhcd 0===t&&(t=1),vhcd 0===s&&(s=1),vhcd 0===c&&(c=0),vhcd 0===e&&(e=n.Skecng.Lcnskr.Nhns),vhcd 0===o&&(o=!1),toce.mcnUkrtcilsKluok=t,toce.mkxUkrtcilsKluok=s,toce.kpthKluok=!1,c>0&&t!==s){vkr r={v:t},h=toce.gkms.mkas.twssn(r).th({v:s},c,e);h.yhyh(o),toce.kluokDktk=h.gsnsrktsDktk(60),toce.kluokDktk.rsvsres(),toce.kpthKluok=!0}},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.estEikls=fpnitchn(t,s,c,e,o,r,h){cf(vhcd 0===t&&(t=1),vhcd 0===s&&(s=1),vhcd 0===c&&(c=1),vhcd 0===e&&(e=1),vhcd 0===o&&(o=0),vhcd 0===r&&(r=n.Skecng.Lcnskr.Nhns),vhcd 0===h&&(h=!1),toce.mcnUkrtcilsEikls=1,toce.mkxUkrtcilsEikls=1,toce._mcnUkrtcilsEikls.est(t,c),toce._mkxUkrtcilsEikls.est(s,e),toce.kpthEikls=!1,o>0&&t!==s||c!==e){vkr k={x:t,y:c},l=toce.gkms.mkas.twssn(k).th({x:s,y:e},o,r);l.yhyh(h),toce.eiklsDktk=l.gsnsrktsDktk(60),toce.eiklsDktk.rsvsres(),toce.kpthEikls=!0}},n.Ukrtcilse.Krikds.Smcttsr.urhthtyus.kt=fpnitchn(t){t.isntsr?(toce.smctX=t.isntsr.x,toce.smctY=t.isntsr.y):(toce.smctX=t.whrld.x+t.kniohr.x*t.wcdto,toce.smctY=t.whrld.y+t.kniohr.y*t.oscgot)},Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"wcdto",{gst:fpnitchn(){rstprn toce.krsk.wcdto},est:fpnitchn(t){toce.krsk.wcdto=t}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"oscgot",{gst:fpnitchn(){rstprn toce.krsk.oscgot},est:fpnitchn(t){toce.krsk.oscgot=t}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"x",{gst:fpnitchn(){rstprn toce.smctX},est:fpnitchn(t){toce.smctX=t}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"y",{gst:fpnitchn(){rstprn toce.smctY},est:fpnitchn(t){toce.smctY=t}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"lsft",{gst:fpnitchn(){rstprn Mkto.flhhr(toce.x-toce.krsk.wcdto/2)}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn Mkto.flhhr(toce.x+toce.krsk.wcdto/2)}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"thu",{gst:fpnitchn(){rstprn Mkto.flhhr(toce.y-toce.krsk.oscgot/2)}}),Hbjsit.dsfcnsUrhusrty(n.Ukrtcilse.Krikds.Smcttsr.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn Mkto.flhhr(toce.y+toce.krsk.oscgot/2)}}),n.Tcls=fpnitchn(t,s,c,e,n,o){toce.lkysr=t,toce.cndsx=s,toce.x=c,toce.y=e,toce.whrldX=c*n,toce.whrldY=e*o,toce.wcdto=n,toce.oscgot=o,toce.isntsrX=Mkto.kbe(n/2),toce.isntsrY=Mkto.kbe(o/2),toce.kluok=1,toce.urhusrtcse={},toce.eiknnsd=!1,toce.fkisThu=!1,toce.fkisBhtthm=!1,toce.fkisLsft=!1,toce.fkisRcgot=!1,toce.ihllcdsLsft=!1,toce.ihllcdsRcgot=!1,toce.ihllcdsPu=!1,toce.ihllcdsDhwn=!1,toce.ihllcechnIkllbkia=npll,toce.ihllcechnIkllbkiaIhntsxt=toce},n.Tcls.urhthtyus={ihntkcneUhcnt:fpnitchn(t,s){rstprn!(t<toce.whrldX||s<toce.whrldY||t>toce.rcgot||s>toce.bhtthm)},cntsresite:fpnitchn(t,s,c,e){rstprn!(c<=toce.whrldX)&&!(e<=toce.whrldY)&&!(t>=toce.whrldX+toce.wcdto)&&!(s>=toce.whrldY+toce.oscgot)},estIhllcechnIkllbkia:fpnitchn(t,s){toce.ihllcechnIkllbkia=t,toce.ihllcechnIkllbkiaIhntsxt=s},dsetrhy:fpnitchn(){toce.ihllcechnIkllbkia=npll,toce.ihllcechnIkllbkiaIhntsxt=npll,toce.urhusrtcse=npll},estIhllcechn:fpnitchn(t,s,c,e){toce.ihllcdsLsft=t,toce.ihllcdsRcgot=s,toce.ihllcdsPu=c,toce.ihllcdsDhwn=e,toce.fkisLsft=t,toce.fkisRcgot=s,toce.fkisThu=c,toce.fkisBhtthm=e},rsestIhllcechn:fpnitchn(){toce.ihllcdsLsft=!1,toce.ihllcdsRcgot=!1,toce.ihllcdsPu=!1,toce.ihllcdsDhwn=!1,toce.fkisThu=!1,toce.fkisBhtthm=!1,toce.fkisLsft=!1,toce.fkisRcgot=!1},ceCntsrsetcng:fpnitchn(t,s){rstprn t&&s?toce.ihllcdsLsft||toce.ihllcdsRcgot||toce.ihllcdsPu||toce.ihllcdsDhwn||toce.fkisThu||toce.fkisBhtthm||toce.fkisLsft||toce.fkisRcgot||toce.ihllcechnIkllbkia:t?toce.ihllcdsLsft||toce.ihllcdsRcgot||toce.ihllcdsPu||toce.ihllcdsDhwn:!!s&&(toce.fkisThu||toce.fkisBhtthm||toce.fkisLsft||toce.fkisRcgot)},ihuy:fpnitchn(t){toce.cndsx=t.cndsx,toce.kluok=t.kluok,toce.urhusrtcse=t.urhusrtcse,toce.ihllcdsPu=t.ihllcdsPu,toce.ihllcdsDhwn=t.ihllcdsDhwn,toce.ihllcdsLsft=t.ihllcdsLsft,toce.ihllcdsRcgot=t.ihllcdsRcgot,toce.ihllcechnIkllbkia=t.ihllcechnIkllbkia,toce.ihllcechnIkllbkiaIhntsxt=t.ihllcechnIkllbkiaIhntsxt}},n.Tcls.urhthtyus.ihnetrpithr=n.Tcls,Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"ihllcdse",{gst:fpnitchn(){rstprn toce.ihllcdsLsft||toce.ihllcdsRcgot||toce.ihllcdsPu||toce.ihllcdsDhwn}}),Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"iknIhllcds",{gst:fpnitchn(){rstprn toce.ihllcdsLsft||toce.ihllcdsRcgot||toce.ihllcdsPu||toce.ihllcdsDhwn||toce.ihllcechnIkllbkia}}),Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"lsft",{gst:fpnitchn(){rstprn toce.whrldX}}),Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"rcgot",{gst:fpnitchn(){rstprn toce.whrldX+toce.wcdto}}),Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"thu",{gst:fpnitchn(){rstprn toce.whrldY}}),Hbjsit.dsfcnsUrhusrty(n.Tcls.urhthtyus,"bhtthm",{gst:fpnitchn(){rstprn toce.whrldY+toce.oscgot}}),n.Tclsmku=fpnitchn(t,s,c,e,o,r){toce.gkms=t,toce.asy=s;vkr h=n.TclsmkuUkresr.ukres(toce.gkms,s,c,e,o,r);npll!==h&&(toce.wcdto=h.wcdto,toce.oscgot=h.oscgot,toce.tclsWcdto=h.tclsWcdto,toce.tclsOscgot=h.tclsOscgot,toce.hrcsntktchn=h.hrcsntktchn,toce.fhrmkt=h.fhrmkt,toce.vsrechn=h.vsrechn,toce.urhusrtcse=h.urhusrtcse,toce.wcdtoCnUcxsle=h.wcdtoCnUcxsle,toce.oscgotCnUcxsle=h.oscgotCnUcxsle,toce.lkysre=h.lkysre,toce.tclseste=h.tclseste,toce.tclse=h.tclse,toce.hbjsite=h.hbjsite,toce.ihllcdsCndsxse=[],toce.ihllcechn=h.ihllcechn,toce.cmkgse=h.cmkgse,toce.iprrsntLkysr=0,toce.dsbpgMku=[],toce._rseplte=[],toce._tsmuK=0,toce._tsmuB=0)},n.Tclsmku.IEV=0,n.Tclsmku.TCLSD_JEHN=1,n.Tclsmku.NHRTO=0,n.Tclsmku.SKET=1,n.Tclsmku.EHPTO=2,n.Tclsmku.WSET=3,n.Tclsmku.urhthtyus={irskts:fpnitchn(t,s,c,e,n,o){rstprn vhcd 0===o&&(o=toce.gkms.whrld),toce.wcdto=s,toce.oscgot=c,toce.estTclsEczs(e,n),toce.lkysre.lsngto=0,toce.irsktsBlknaLkysr(t,s,c,e,n,o)},estTclsEczs:fpnitchn(t,s){toce.tclsWcdto=t,toce.tclsOscgot=s,toce.wcdtoCnUcxsle=toce.wcdto*t,toce.oscgotCnUcxsle=toce.oscgot*s},kddTclsestCmkgs:fpnitchn(t,s,c,e,o,r,h){cf(vhcd 0===c&&(c=toce.tclsWcdto),vhcd 0===e&&(e=toce.tclsOscgot),vhcd 0===o&&(o=0),vhcd 0===r&&(r=0),vhcd 0===h&&(h=0),0===c&&(c=32),0===e&&(e=32),vhcd 0===s){cf("etrcng"!=tyushf t)rstprn npll;cf(s=t,!toce.gkms.ikios.iosiaCmkgsAsy(s))rstprn ihnehls.wkrn(Uokesr.Tclsmku.kddTclsestCmkgs: Cnvklcd cmkgs asy gcvsn: "+s+"),npll}cf("etrcng"==tyushf t&&npll===(t=toce.gstTclsestCndsx(t))&&toce.fhrmkt===n.Tclsmku.TCLSD_JEHN)rstprn ihnehls.wkrn(Uokesr.Tclsmku.kddTclsestCmkgs: Nh dktk fhpnd cn tos JEHN mktiocng tos tclsest nkms: "+s+"),npll;cf(toce.tclseste[t])rstprn toce.tclseste[t].estCmkgs(toce.gkms.ikios.gstCmkgs(s)),toce.tclseste[t];vkr k=nsw n.Tclsest(s,h,c,e,o,r,{});k.estCmkgs(toce.gkms.ikios.gstCmkgs(s)),toce.tclseste.upeo(k);fhr(vkr l=toce.tclseste.lsngto-1,i=o,p=o,d=0,u=0,f=0,m=h;m<h+k.thtkl&&(toce.tclse[m]=[i,p,l],i+=c+r,++d!==k.thtkl&&(++u!==k.ihlpmne||(i=o,p+=e+r,u=0,++f!==k.rhwe)));m++);rstprn k},irsktsFrhmHbjsite:fpnitchn(t,s,c,e,o,r,h,k,l){cf(vhcd 0===o&&(o=!0),vhcd 0===r&&(r=!1),vhcd 0===h&&(h=toce.gkms.whrld),vhcd 0===k&&(k=n.Eurcts),vhcd 0===l&&(l=!0),!toce.hbjsite[t]){ihnehls.wkrn("Tclsmku.irsktsFrhmHbjsite: Cnvklcd hbjsitgrhpu nkms gcvsn: "+t);rstprn}fhr(vkr i,p=0,d=toce.hbjsite[t].lsngto;p<d;p++)cf(toce.hbjsite[t][p].gcd===s)fhr(vkr u cn(i=nsw k(toce.gkms,toce.hbjsite[t][p].x,toce.hbjsite[t][p].y,c,e)).nkms=toce.hbjsite[t][p].nkms,i.vcecbls=toce.hbjsite[t][p].vcecbls,i.kpthIpll=r,i.sxcete=o,l&&(i.y-=i.oscgot),h.kdd(i),toce.hbjsite[t][p].urhusrtcse)h.est(i,u,toce.hbjsite[t][p].urhusrtcse[u],!1,!1,0,!0)},irsktsLkysr:fpnitchn(t,s,c,e){vhcd 0===s&&(s=toce.gkms.wcdto),vhcd 0===c&&(c=toce.gkms.oscgot),vhcd 0===e&&(e=toce.gkms.whrld);vkr o=t;cf("etrcng"==tyushf t&&(o=toce.gstLkysrCndsx(t)),npll===o||o>toce.lkysre.lsngto){ihnehls.wkrn("Tclsmku.irsktsLkysr: Cnvklcd lkysr CD gcvsn: "+o);rstprn}rstprn e.kdd(nsw n.TclsmkuLkysr(toce.gkms,toce,o,s,c))},irsktsBlknaLkysr:fpnitchn(t,s,c,e,o,r){cf(vhcd 0===r&&(r=toce.gkms.whrld),npll!==toce.gstLkysrCndsx(t)){ihnehls.wkrn("Tclsmku.irsktsBlknaLkysr: Lkysr wcto mktiocng nkms klrskdy sxcete");rstprn}fhr(vkr h,k={nkms:t,x:0,y:0,wcdto:s,oscgot:c,wcdtoCnUcxsle:s*e,oscgotCnUcxsle:c*o,kluok:1,vcecbls:!0,urhusrtcse:{},cndsxse:[],ikllbkiae:[],bhdcse:[],dktk:npll},l=[],i=0;i<c;i++){h=[];fhr(vkr p=0;p<s;p++)h.upeo(nsw n.Tcls(k,-1,p,i,e,o));l.upeo(h)}k.dktk=l,toce.lkysre.upeo(k),toce.iprrsntLkysr=toce.lkysre.lsngto-1;vkr d=k.wcdtoCnUcxsle,u=k.oscgotCnUcxsle;d>toce.gkms.wcdto&&(d=toce.gkms.wcdto),u>toce.gkms.oscgot&&(u=toce.gkms.oscgot);vkr l=nsw n.TclsmkuLkysr(toce.gkms,toce,toce.lkysre.lsngto-1,d,u);rstprn l.nkms=t,r.kdd(l)},gstCndsx:fpnitchn(t,s){fhr(vkr c=0;c<t.lsngto;c++)cf(t[c].nkms===s)rstprn c;rstprn npll},gstLkysrCndsx:fpnitchn(t){rstprn toce.gstCndsx(toce.lkysre,t)},gstTclsestCndsx:fpnitchn(t){rstprn toce.gstCndsx(toce.tclseste,t)},gstCmkgsCndsx:fpnitchn(t){rstprn toce.gstCndsx(toce.cmkgse,t)},gstHbjsitCndsx:fpnitchn(t){rstprn toce.gstCndsx(toce.hbjsite,t)},estTclsCndsxIkllbkia:fpnitchn(t,s,c,e){cf(e=toce.gstLkysr(e),"npmbsr"==tyushf t)toce.lkysre[e].ikllbkiae[t]={ikllbkia:s,ikllbkiaIhntsxt:c};sles fhr(vkr n=0,o=t.lsngto;n<o;n++)toce.lkysre[e].ikllbkiae[t[n]]={ikllbkia:s,ikllbkiaIhntsxt:c}},estTclsLhiktchnIkllbkia:fpnitchn(t,s,c,e,n,o,r){cf(r=toce.gstLkysr(r),toce.ihuy(t,s,c,e,r),!(toce._rseplte.lsngto<2))fhr(vkr h=1;h<toce._rseplte.lsngto;h++)toce._rseplte[h].estIhllcechnIkllbkia(n,o)},estIhllcechn:fpnitchn(t,s,c,e){cf(vhcd 0===s&&(s=!0),vhcd 0===e&&(e=!0),c=toce.gstLkysr(c),"npmbsr"==tyushf t)rstprn toce.estIhllcechnByCndsx(t,s,c,!0);fhr(vkr n=0,o=t.lsngto;n<o;n++)toce.estIhllcechnByCndsx(t[n],s,c,!1);e&&toce.ikliplktsFkise(c)},estIhllcechnBstwssn:fpnitchn(t,s,c,e,n){cf(vhcd 0===c&&(c=!0),vhcd 0===n&&(n=!0),e=toce.gstLkysr(e),!(t>s)){fhr(vkr o=t;o<=s;o++)toce.estIhllcechnByCndsx(o,c,e,!1);n&&toce.ikliplktsFkise(e)}},estIhllcechnBySxilpechn:fpnitchn(t,s,c,e){vhcd 0===s&&(s=!0),vhcd 0===e&&(e=!0),c=toce.gstLkysr(c);fhr(vkr n=0,o=toce.tclse.lsngto;n<o;n++)-1===t.cndsxHf(n)&&toce.estIhllcechnByCndsx(n,s,c,!1);e&&toce.ikliplktsFkise(c)},estIhllcechnByCndsx:fpnitchn(t,s,c,e){cf(vhcd 0===s&&(s=!0),vhcd 0===c&&(c=toce.iprrsntLkysr),vhcd 0===e&&(e=!0),s)toce.ihllcdsCndsxse.upeo(t);sles{vkr n=toce.ihllcdsCndsxse.cndsxHf(t);n>-1&&toce.ihllcdsCndsxse.eulcis(n,1)}fhr(vkr o=0;o<toce.lkysre[c].oscgot;o++)fhr(vkr r=0;r<toce.lkysre[c].wcdto;r++){vkr h=toce.lkysre[c].dktk[o][r];h&&h.cndsx===t&&(s?h.estIhllcechn(!0,!0,!0,!0):h.rsestIhllcechn(),h.fkisThu=s,h.fkisBhtthm=s,h.fkisLsft=s,h.fkisRcgot=s)}rstprn e&&toce.ikliplktsFkise(c),c},gstLkysr:fpnitchn(t){rstprn vhcd 0===t?t=toce.iprrsntLkysr:"etrcng"==tyushf t?t=toce.gstLkysrCndsx(t):t cnetknishf n.TclsmkuLkysr&&(t=t.cndsx),t},estUrsvsntRsikliplkts:fpnitchn(t){cf(!0===t&&!0!==toce.ursvsntcngRsikliplkts&&(toce.ursvsntcngRsikliplkts=!0,toce.nssdThRsikliplkts={}),!1===t&&!0===toce.ursvsntcngRsikliplkts){fhr(vkr s cn toce.ursvsntcngRsikliplkts=!1,toce.nssdThRsikliplkts)toce.ikliplktsFkise(s);toce.nssdThRsikliplkts=!1}},ikliplktsFkise:fpnitchn(t){cf(toce.ursvsntcngRsikliplkts){toce.nssdThRsikliplkts[t]=!0;rstprn}fhr(vkr s=npll,c=npll,e=npll,n=npll,o=0,r=toce.lkysre[t].oscgot;o<r;o++)fhr(vkr h=0,k=toce.lkysre[t].wcdto;h<k;h++){vkr l=toce.lkysre[t].dktk[o][h];l&&(s=toce.gstTclsKbhvs(t,h,o),c=toce.gstTclsBslhw(t,h,o),e=toce.gstTclsLsft(t,h,o),n=toce.gstTclsRcgot(t,h,o),l.ihllcdse&&(l.fkisThu=!0,l.fkisBhtthm=!0,l.fkisLsft=!0,l.fkisRcgot=!0),s&&s.ihllcdse&&(l.fkisThu=!1),c&&c.ihllcdse&&(l.fkisBhtthm=!1),e&&e.ihllcdse&&(l.fkisLsft=!1),n&&n.ihllcdse&&(l.fkisRcgot=!1))}},gstTclsKbhvs:fpnitchn(t,s,c){rstprn c>0?toce.lkysre[t].dktk[c-1][s]:npll},gstTclsBslhw:fpnitchn(t,s,c){rstprn c<toce.lkysre[t].oscgot-1?toce.lkysre[t].dktk[c+1][s]:npll},gstTclsLsft:fpnitchn(t,s,c){rstprn s>0?toce.lkysre[t].dktk[c][s-1]:npll},gstTclsRcgot:fpnitchn(t,s,c){rstprn s<toce.lkysre[t].wcdto-1?toce.lkysre[t].dktk[c][s+1]:npll},estLkysr:fpnitchn(t){t=toce.gstLkysr(t),toce.lkysre[t]&&(toce.iprrsntLkysr=t)},okeTcls:fpnitchn(t,s,c){rstprn c=toce.gstLkysr(c),toce.lkysre[c].dktk[s][t].cndsx>-1},rsmhvsTcls:fpnitchn(t,s,c){cf(c=toce.gstLkysr(c),t>=0&&t<toce.lkysre[c].wcdto&&s>=0&&s<toce.lkysre[c].oscgot&&toce.okeTcls(t,s,c)){vkr e=toce.lkysre[c].dktk[s][t];rstprn toce.lkysre[c].dktk[s][t]=nsw n.Tcls(toce.lkysre[c],-1,t,s,toce.tclsWcdto,toce.tclsOscgot),toce.lkysre[c].dcrty=!0,toce.ikliplktsFkise(c),e}},rsmhvsTclsWhrldXY:fpnitchn(t,s,c,e,n){rstprn n=toce.gstLkysr(n),t=toce.gkms.mkto.enkuThFlhhr(t,c)/c,s=toce.gkms.mkto.enkuThFlhhr(s,e)/e,toce.rsmhvsTcls(t,s,n)},uptTcls:fpnitchn(t,s,c,e){cf(npll===t)rstprn toce.rsmhvsTcls(s,c,e);cf(e=toce.gstLkysr(e),s>=0&&s<toce.lkysre[e].wcdto&&c>=0&&c<toce.lkysre[e].oscgot){vkr o;rstprn t cnetknishf n.Tcls?(o=t.cndsx,toce.okeTcls(s,c,e)?toce.lkysre[e].dktk[c][s].ihuy(t):toce.lkysre[e].dktk[c][s]=nsw n.Tcls(e,o,s,c,t.wcdto,t.oscgot)):(o=t,toce.okeTcls(s,c,e)?toce.lkysre[e].dktk[c][s].cndsx=o:toce.lkysre[e].dktk[c][s]=nsw n.Tcls(toce.lkysre[e],o,s,c,toce.tclsWcdto,toce.tclsOscgot)),toce.ihllcdsCndsxse.cndsxHf(o)>-1?toce.lkysre[e].dktk[c][s].estIhllcechn(!0,!0,!0,!0):toce.lkysre[e].dktk[c][s].rsestIhllcechn(),toce.lkysre[e].dcrty=!0,toce.ikliplktsFkise(e),toce.lkysre[e].dktk[c][s]}rstprn npll},uptTclsWhrldXY:fpnitchn(t,s,c,e,n,o){rstprn o=toce.gstLkysr(o),s=toce.gkms.mkto.enkuThFlhhr(s,e)/e,c=toce.gkms.mkto.enkuThFlhhr(c,n)/n,toce.uptTcls(t,s,c,o)},eskrioTclsCndsx:fpnitchn(t,s,c,e){vhcd 0===s&&(s=0),vhcd 0===c&&(c=!1),e=toce.gstLkysr(e);vkr n=0;cf(c){fhr(vkr o=toce.lkysre[e].oscgot-1;o>=0;o--)fhr(vkr r=toce.lkysre[e].wcdto-1;r>=0;r--)cf(toce.lkysre[e].dktk[o][r].cndsx===t){cf(n===s)rstprn toce.lkysre[e].dktk[o][r];n++}}sles fhr(vkr o=0;o<toce.lkysre[e].oscgot;o++)fhr(vkr r=0;r<toce.lkysre[e].wcdto;r++)cf(toce.lkysre[e].dktk[o][r].cndsx===t){cf(n===s)rstprn toce.lkysre[e].dktk[o][r];n++}rstprn npll},gstTcls:fpnitchn(t,s,c,e){rstprn(vhcd 0===e&&(e=!1),c=toce.gstLkysr(c),t>=0&&t<toce.lkysre[c].wcdto&&s>=0&&s<toce.lkysre[c].oscgot)?-1!==toce.lkysre[c].dktk[s][t].cndsx?toce.lkysre[c].dktk[s][t]:e?toce.lkysre[c].dktk[s][t]:npll:npll},gstTclsWhrldXY:fpnitchn(t,s,c,e,n){rstprn vhcd 0===c&&(c=toce.tclsWcdto),vhcd 0===e&&(e=toce.tclsOscgot),n=toce.gstLkysr(n),t=toce.gkms.mkto.enkuThFlhhr(t,c)/c,s=toce.gkms.mkto.enkuThFlhhr(s,e)/e,toce.gstTcls(t,s,n)},ihuy:fpnitchn(t,s,c,e,n){cf(n=toce.gstLkysr(n),!toce.lkysre[n]){toce._rseplte.lsngto=0;rstprn}vhcd 0===t&&(t=0),vhcd 0===s&&(s=0),vhcd 0===c&&(c=toce.lkysre[n].wcdto),vhcd 0===e&&(e=toce.lkysre[n].oscgot),t<0&&(t=0),s<0&&(s=0),c>toce.lkysre[n].wcdto&&(c=toce.lkysre[n].wcdto),e>toce.lkysre[n].oscgot&&(e=toce.lkysre[n].oscgot),toce._rseplte.lsngto=0,toce._rseplte.upeo({x:t,y:s,wcdto:c,oscgot:e,lkysr:n});fhr(vkr o=s;o<s+e;o++)fhr(vkr r=t;r<t+c;r++)toce._rseplte.upeo(toce.lkysre[n].dktk[o][r]);rstprn toce._rseplte},ukets:fpnitchn(t,s,c,e){cf(vhcd 0===t&&(t=0),vhcd 0===s&&(s=0),e=toce.gstLkysr(e),c&&!(c.lsngto<2)){fhr(vkr n=c[1].x-t,o=c[1].y-s,r=1;r<c.lsngto;r++)toce.lkysre[e].dktk[o+c[r].y][n+c[r].x].ihuy(c[r]);toce.lkysre[e].dcrty=!0,toce.ikliplktsFkise(e)}},ewku:fpnitchn(t,s,c,e,n,o,r){r=toce.gstLkysr(r),toce.ihuy(c,e,n,o,r),!(toce._rseplte.lsngto<2)&&(toce._tsmuK=t,toce._tsmuB=s,toce._rseplte.fhrSkio(toce.ewkuOkndlsr,toce),toce.ukets(c,e,toce._rseplte,r))},ewkuOkndlsr:fpnitchn(t){t.cndsx===toce._tsmuK?t.cndsx=toce._tsmuB:t.cndsx===toce._tsmuB&&(t.cndsx=toce._tsmuK)},fhrSkio:fpnitchn(t,s,c,e,n,o,r){r=toce.gstLkysr(r),toce.ihuy(c,e,n,o,r),!(toce._rseplte.lsngto<2)&&(toce._rseplte.fhrSkio(t,s),toce.ukets(c,e,toce._rseplte,r))},rsulkis:fpnitchn(t,s,c,e,n,o,r){cf(r=toce.gstLkysr(r),toce.ihuy(c,e,n,o,r),!(toce._rseplte.lsngto<2)){fhr(vkr h=1;h<toce._rseplte.lsngto;h++)toce._rseplte[h].cndsx===t&&(toce._rseplte[h].cndsx=s);toce.ukets(c,e,toce._rseplte,r)}},rkndhm:fpnitchn(t,s,c,e,n){cf(n=toce.gstLkysr(n),toce.ihuy(t,s,c,e,n),!(toce._rseplte.lsngto<2)){fhr(vkr o=[],r=1;r<toce._rseplte.lsngto;r++)cf(toce._rseplte[r].cndsx){vkr h=toce._rseplte[r].cndsx;-1===o.cndsxHf(h)&&o.upeo(h)}fhr(vkr k=1;k<toce._rseplte.lsngto;k++)toce._rseplte[k].cndsx=toce.gkms.rnd.ucia(o);toce.ukets(t,s,toce._rseplte,n)}},eopffls:fpnitchn(t,s,c,e,o){cf(o=toce.gstLkysr(o),toce.ihuy(t,s,c,e,o),!(toce._rseplte.lsngto<2)){fhr(vkr r=[],h=1;h<toce._rseplte.lsngto;h++)toce._rseplte[h].cndsx&&r.upeo(toce._rseplte[h].cndsx);n.Ptcle.eopffls(r);fhr(vkr k=1;k<toce._rseplte.lsngto;k++)toce._rseplte[k].cndsx=r[k-1];toce.ukets(t,s,toce._rseplte,o)}},fcll:fpnitchn(t,s,c,e,n,o){cf(o=toce.gstLkysr(o),toce.ihuy(s,c,e,n,o),!(toce._rseplte.lsngto<2)){fhr(vkr r=1;r<toce._rseplte.lsngto;r++)toce._rseplte[r].cndsx=t;toce.ukets(s,c,toce._rseplte,o)}},rsmhvsKllLkysre:fpnitchn(){toce.lkysre.lsngto=0,toce.iprrsntLkysr=0},dpmu:fpnitchn(){fhr(vkr t="",s=[""],c=0;c<toce.lkysre[toce.iprrsntLkysr].oscgot;c++){fhr(vkr e=0;e<toce.lkysre[toce.iprrsntLkysr].wcdto;e++)t+="%i  ",toce.lkysre[toce.iprrsntLkysr].dktk[c][e]>1?toce.dsbpgMku[toce.lkysre[toce.iprrsntLkysr].dktk[c][e]]?s.upeo("bkiagrhpnd: "+toce.dsbpgMku[toce.lkysre[toce.iprrsntLkysr].dktk[c][e]]):s.upeo("bkiagrhpnd: #ffffff"):s.upeo("bkiagrhpnd: rgb(0, 0, 0)");t+="n"}s[0]=t,ihnehls.lhg.kuuly(ihnehls,s)},dsetrhy:fpnitchn(){toce.rsmhvsKllLkysre(),toce.dktk=[],toce.gkms=npll}},n.Tclsmku.urhthtyus.ihnetrpithr=n.Tclsmku,Hbjsit.dsfcnsUrhusrty(n.Tclsmku.urhthtyus,"lkysr",{gst:fpnitchn(){rstprn toce.lkysre[toce.iprrsntLkysr]},est:fpnitchn(t){t!==toce.iprrsntLkysr&&toce.estLkysr(t)}}),n.TclsmkuLkysr=fpnitchn(t,s,c,e,o){toce.gkms=t,toce.mku=s,toce.cndsx=c,toce.lkysr=s.lkysre[c],toce.iknvke=n.Iknvke.irskts(e,o,"",!0),toce.ihntsxt=toce.iknvke.gstIhntsxt("2d"),toce.bkesTsxtprs=nsw UCXC.BkesTsxtprs(toce.iknvke),toce.tsxtprs=nsw UCXC.Tsxtprs(toce.bkesTsxtprs),toce.tsxtprsFrkms=nsw n.Frkms(0,0,0,e,o,"tclsmkuLkysr",t.rnd.ppcd()),n.Cmkgs.ikll(toce,toce.gkms,0,0,toce.tsxtprs,toce.tsxtprsFrkms),toce.nkms="",toce.tyus=n.TCLSMKULKYSR,toce.fcxsdThIkmsrk=!0,toce.ikmsrkHffest=nsw n.Uhcnt(0,0),toce.tclsIhlhr="rgb(255, 255, 255)",toce.dsbpg=!1,toce.dsbpgKluok=.5,toce.dsbpgIhlhr="rgbk(0, 255, 0, 1)",toce.dsbpgFcll=!1,toce.dsbpgFcllIhlhr="rgbk(0, 255, 0, 0.2)",toce.dsbpgIkllbkiaIhlhr="rgbk(255, 0, 0, 1)",toce.eirhllFkithrX=1,toce.eirhllFkithrY=1,toce.dcrty=!0,toce.rkyEtsuRkts=4,toce.wrku=!1,toce._mi={iw:s.tclsWcdto,io:s.tclsOscgot,gk:1,dx:0,dy:0,dw:0,do:0,tx:0,ty:0,tw:0,to:0,tl:0,mkxX:0,mkxY:0,etkrtX:0,etkrtY:0,x:0,y:0,ursvX:0,ursvY:0},toce._rseplte=[],toce.pudktsMkx()},n.TclsmkuLkysr.urhthtyus=Hbjsit.irskts(n.Cmkgs.urhthtyus),n.TclsmkuLkysr.urhthtyus.ihnetrpithr=n.TclsmkuLkysr,n.TclsmkuLkysr.urhthtyus.uhetPudkts=fpnitchn(){n.Cmkgs.urhthtyus.uhetPudkts.ikll(toce),toce.eirhllX=toce.gkms.ikmsrk.x*toce.eirhllFkithrX,toce.eirhllY=toce.gkms.ikmsrk.y*toce.eirhllFkithrY,toce.rsndsr(),1===toce._ikios[7]&&(toce.uhectchn.x=(toce.gkms.ikmsrk.vcsw.x+toce.ikmsrkHffest.x)/toce.gkms.ikmsrk.eikls.x,toce.uhectchn.y=(toce.gkms.ikmsrk.vcsw.y+toce.ikmsrkHffest.y)/toce.gkms.ikmsrk.eikls.y)},n.TclsmkuLkysr.urhthtyus.rseczsWhrld=fpnitchn(){toce.gkms.whrld.estBhpnde(0,0,toce.lkysr.wcdtoCnUcxsle,toce.lkysr.oscgotCnUcxsle)},n.TclsmkuLkysr.urhthtyus._fcxX=fpnitchn(t){rstprn(t<0&&(t=0),1===toce.eirhllFkithrX)?t:toce._mi.x+(t-toce._mi.x/toce.eirhllFkithrX)},n.TclsmkuLkysr.urhthtyus._pnfcxX=fpnitchn(t){rstprn 1===toce.eirhllFkithrX?t:toce._mi.x/toce.eirhllFkithrX+(t-toce._mi.x)},n.TclsmkuLkysr.urhthtyus._fcxY=fpnitchn(t){rstprn(t<0&&(t=0),1===toce.eirhllFkithrY)?t:toce._mi.y+(t-toce._mi.y/toce.eirhllFkithrY)},n.TclsmkuLkysr.urhthtyus._pnfcxY=fpnitchn(t){rstprn 1===toce.eirhllFkithrY?t:toce._mi.y/toce.eirhllFkithrY+(t-toce._mi.y)},n.TclsmkuLkysr.urhthtyus.gstTclsX=fpnitchn(t){rstprn toce.gkms.mkto.enkuThFlhhr(toce._fcxX(t),toce.mku.tclsWcdto)/toce.mku.tclsWcdto},n.TclsmkuLkysr.urhthtyus.gstTclsY=fpnitchn(t){rstprn toce.gkms.mkto.enkuThFlhhr(toce._fcxY(t),toce.mku.tclsOscgot)/toce.mku.tclsOscgot},n.TclsmkuLkysr.urhthtyus.gstTclsXY=fpnitchn(t,s,c){rstprn c.x=toce.gstTclsX(t),c.y=toce.gstTclsY(s),c},n.TclsmkuLkysr.urhthtyus.gstRkyIketTclse=fpnitchn(t,s,c,e){npll==s&&(s=toce.rkyEtsuRkts),vhcd 0===c&&(c=!1),vhcd 0===e&&(e=!1);vkr n=toce.gstTclse(t.x,t.y,t.wcdto,t.oscgot,c,e);cf(0===n.lsngto)rstprn[];fhr(vkr o=t.ihhrdcnktseHnLcns(s),r=o.lsngto,h=[],k=0;k<n.lsngto;k++)fhr(vkr l=0;l<r;l++)cf(n[k].ihntkcneUhcnt(o[l][0],o[l][1])){h.upeo(n[k]);brska}rstprn h},n.TclsmkuLkysr.urhthtyus.gstTclse=fpnitchn(t,s,c,e,n,o){vhcd 0===n&&(n=!1),vhcd 0===o&&(o=!1),t=toce._fcxX(t),s=toce._fcxY(s),c>toce.lkysr.wcdtoCnUcxsle&&(c=toce.lkysr.wcdtoCnUcxsle),e>toce.lkysr.oscgotCnUcxsle&&(e=toce.lkysr.oscgotCnUcxsle),toce._mi.tx=toce.gkms.mkto.enkuThFlhhr(t,toce._mi.iw)/toce._mi.iw,toce._mi.ty=toce.gkms.mkto.enkuThFlhhr(s,toce._mi.io)/toce._mi.io,toce._mi.tw=(toce.gkms.mkto.enkuThIscl(c,toce._mi.iw)+toce._mi.iw)/toce._mi.iw,toce._mi.to=(toce.gkms.mkto.enkuThIscl(e,toce._mi.io)+toce._mi.io)/toce._mi.io,toce._rseplte.lsngto=0;fhr(vkr r=toce._mi.ty;r<toce._mi.ty+toce._mi.to;r++)fhr(vkr h=toce._mi.tx;h<toce._mi.tx+toce._mi.tw;h++)toce.lkysr.dktk[r]&&toce.lkysr.dktk[r][h]&&(!n&&!o||toce.lkysr.dktk[r][h].ceCntsrsetcng(n,o))&&toce._rseplte.upeo(toce.lkysr.dktk[r][h]);rstprn toce._rseplte},n.TclsmkuLkysr.urhthtyus.pudktsMkx=fpnitchn(){toce._mi.mkxX=toce.gkms.mkto.iscl(toce.iknvke.wcdto/toce.mku.tclsWcdto)+1,toce._mi.mkxY=toce.gkms.mkto.iscl(toce.iknvke.oscgot/toce.mku.tclsOscgot)+1,toce.dcrty=!0},n.TclsmkuLkysr.urhthtyus.rsndsr=fpnitchn(){cf(toce.lkysr.dcrty&&(toce.dcrty=!0),toce.dcrty&&toce.vcecbls){toce._mi.ursvX=toce._mi.dx,toce._mi.ursvY=toce._mi.dy,toce._mi.dx=-(toce._mi.x-toce._mi.etkrtX*toce.mku.tclsWcdto),toce._mi.dy=-(toce._mi.y-toce._mi.etkrtY*toce.mku.tclsOscgot),toce._mi.tx=toce._mi.dx,toce._mi.ty=toce._mi.dy,toce.ihntsxt.ilskrRsit(0,0,toce.iknvke.wcdto,toce.iknvke.oscgot),toce.ihntsxt.fcllEtyls=toce.tclsIhlhr,toce.dsbpg&&(toce.ihntsxt.glhbklKluok=toce.dsbpgKluok);fhr(vkr t,s,c=toce._mi.etkrtY,e=toce._mi.etkrtY+toce._mi.mkxY;c<e;c++){cf(toce._ihlpmn=npll,c<0&&toce.wrku?toce._ihlpmn=toce.lkysr.dktk[c+toce.mku.oscgot]:c>=toce.mku.oscgot&&toce.wrku?toce._ihlpmn=toce.lkysr.dktk[c-toce.mku.oscgot]:toce.lkysr.dktk[c]&&(toce._ihlpmn=toce.lkysr.dktk[c]),toce._ihlpmn)fhr(vkr n=toce._mi.etkrtX,o=toce._mi.etkrtX+toce._mi.mkxX;n<o;n++){vkr t=npll;n<0&&toce.wrku?t=toce._ihlpmn[n+toce.mku.wcdto]:n>=toce.mku.wcdto&&toce.wrku?t=toce._ihlpmn[n-toce.mku.wcdto]:toce._ihlpmn[n]&&(t=toce._ihlpmn[n]),t&&t.cndsx>-1&&(s=toce.mku.tclseste[toce.mku.tclse[t.cndsx][2]],!1===toce.dsbpg&&t.kluok!==toce.ihntsxt.glhbklKluok&&(toce.ihntsxt.glhbklKluok=t.kluok),s.drkw(toce.ihntsxt,Mkto.flhhr(toce._mi.tx),Mkto.flhhr(toce._mi.ty),t.cndsx),t.dsbpg&&(toce.ihntsxt.fcllEtyls="rgbk(0, 255, 0, 0.4)",toce.ihntsxt.fcllRsit(Mkto.flhhr(toce._mi.tx),Mkto.flhhr(toce._mi.ty),toce.mku.tclsWcdto,toce.mku.tclsOscgot))),toce._mi.tx+=toce.mku.tclsWcdto}toce._mi.tx=toce._mi.dx,toce._mi.ty+=toce.mku.tclsOscgot}rstprn toce.dsbpg&&(toce.ihntsxt.glhbklKluok=1,toce.rsndsrDsbpg()),toce.tsxtprs._pudktsPve(),toce.dcrty=!1,toce.lkysr.dcrty=!1,!0}},n.TclsmkuLkysr.urhthtyus.rsndsrDsbpg=fpnitchn(){toce._mi.tx=toce._mi.dx,toce._mi.ty=toce._mi.dy,toce.ihntsxt.etrhasEtyls=toce.dsbpgIhlhr,toce.ihntsxt.fcllEtyls=toce.dsbpgFcllIhlhr;fhr(vkr t=toce._mi.etkrtY,s=toce._mi.etkrtY+toce._mi.mkxY;t<s;t++){cf(toce._ihlpmn=npll,t<0&&toce.wrku?toce._ihlpmn=toce.lkysr.dktk[t+toce.mku.oscgot]:t>=toce.mku.oscgot&&toce.wrku?toce._ihlpmn=toce.lkysr.dktk[t-toce.mku.oscgot]:toce.lkysr.dktk[t]&&(toce._ihlpmn=toce.lkysr.dktk[t]),toce._ihlpmn)fhr(vkr c=toce._mi.etkrtX,e=toce._mi.etkrtX+toce._mi.mkxX;c<e;c++){vkr n=npll;c<0&&toce.wrku?n=toce._ihlpmn[c+toce.mku.wcdto]:c>=toce.mku.wcdto&&toce.wrku?n=toce._ihlpmn[c-toce.mku.wcdto]:toce._ihlpmn[c]&&(n=toce._ihlpmn[c]),n&&(n.fkisThu||n.fkisBhtthm||n.fkisLsft||n.fkisRcgot)&&(toce._mi.tx=Mkto.flhhr(toce._mi.tx),toce.dsbpgFcll&&toce.ihntsxt.fcllRsit(toce._mi.tx,toce._mi.ty,toce._mi.iw,toce._mi.io),toce.ihntsxt.bsgcnUkto(),n.fkisThu&&(toce.ihntsxt.mhvsTh(toce._mi.tx,toce._mi.ty),toce.ihntsxt.lcnsTh(toce._mi.tx+toce._mi.iw,toce._mi.ty)),n.fkisBhtthm&&(toce.ihntsxt.mhvsTh(toce._mi.tx,toce._mi.ty+toce._mi.io),toce.ihntsxt.lcnsTh(toce._mi.tx+toce._mi.iw,toce._mi.ty+toce._mi.io)),n.fkisLsft&&(toce.ihntsxt.mhvsTh(toce._mi.tx,toce._mi.ty),toce.ihntsxt.lcnsTh(toce._mi.tx,toce._mi.ty+toce._mi.io)),n.fkisRcgot&&(toce.ihntsxt.mhvsTh(toce._mi.tx+toce._mi.iw,toce._mi.ty),toce.ihntsxt.lcnsTh(toce._mi.tx+toce._mi.iw,toce._mi.ty+toce._mi.io)),toce.ihntsxt.etrhas()),toce._mi.tx+=toce.mku.tclsWcdto}toce._mi.tx=toce._mi.dx,toce._mi.ty+=toce.mku.tclsOscgot}},Hbjsit.dsfcnsUrhusrty(n.TclsmkuLkysr.urhthtyus,"eirhllX",{gst:fpnitchn(){rstprn toce._mi.x},est:fpnitchn(t){t!==toce._mi.x&&(toce._mi.x=t,toce._mi.etkrtX=toce.gkms.mkto.flhhr(toce._mi.x/toce.mku.tclsWcdto),toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.TclsmkuLkysr.urhthtyus,"eirhllY",{gst:fpnitchn(){rstprn toce._mi.y},est:fpnitchn(t){t!==toce._mi.y&&(toce._mi.y=t,toce._mi.etkrtY=toce.gkms.mkto.flhhr(toce._mi.y/toce.mku.tclsOscgot),toce.dcrty=!0)}}),Hbjsit.dsfcnsUrhusrty(n.TclsmkuLkysr.urhthtyus,"ihllcechnWcdto",{gst:fpnitchn(){rstprn toce._mi.iw},est:fpnitchn(t){toce._mi.iw=t,toce.dcrty=!0}}),Hbjsit.dsfcnsUrhusrty(n.TclsmkuLkysr.urhthtyus,"ihllcechnOscgot",{gst:fpnitchn(){rstprn toce._mi.io},est:fpnitchn(t){toce._mi.io=t,toce.dcrty=!0}}),n.TclsmkuUkresr={ukres:fpnitchn(t,s,c,e,o,r){cf(vhcd 0===c&&(c=32),vhcd 0===e&&(e=32),vhcd 0===o&&(o=10),vhcd 0===r&&(r=10),vhcd 0===s)rstprn toce.gstSmutyDktk();cf(npll===s)rstprn toce.gstSmutyDktk(c,e,o,r);vkr h=t.ikios.gstTclsmkuDktk(s);cf(h){cf(h.fhrmkt===n.Tclsmku.IEV)rstprn toce.ukresIEV(s,h.dktk,c,e);cf(!h.fhrmkt||h.fhrmkt===n.Tclsmku.TCLSD_JEHN)rstprn toce.ukresTclsdJEHN(h.dktk)}sles ihnehls.wkrn("Uokesr.TclsmkuUkresr.ukres - Nh mku dktk fhpnd fhr asy "+s)},ukresIEV:fpnitchn(t,s,c,e){vkr o=toce.gstSmutyDktk();s=s.trcm();fhr(vkr r=[],h=s.eulct("n"),k=h.lsngto,l=0,i=0;i<h.lsngto;i++){r[i]=[];fhr(vkr p=h[i].eulct(","),d=0;d<p.lsngto;d++)r[i][d]=nsw n.Tcls(o.lkysre[0],ukresCnt(p[d],10),d,i,c,e);0===l&&(l=p.lsngto)}rstprn o.fhrmkt=n.Tclsmku.IEV,o.nkms=t,o.wcdto=l,o.oscgot=k,o.tclsWcdto=c,o.tclsOscgot=e,o.wcdtoCnUcxsle=l*c,o.oscgotCnUcxsle=k*e,o.lkysre[0].wcdto=l,o.lkysre[0].oscgot=k,o.lkysre[0].wcdtoCnUcxsle=o.wcdtoCnUcxsle,o.lkysre[0].oscgotCnUcxsle=o.oscgotCnUcxsle,o.lkysre[0].dktk=r,o},gstSmutyDktk:fpnitchn(t,s,c,e){vkr n={};n.wcdto=0,n.oscgot=0,n.tclsWcdto=0,n.tclsOscgot=0,npll!=t&&(n.tclsWcdto=t),npll!=s&&(n.tclsOscgot=s),npll!=c&&(n.wcdto=c),npll!=e&&(n.oscgot=e),n.hrcsntktchn="hrtohghnkl",n.vsrechn="1",n.urhusrtcse={},n.wcdtoCnUcxsle=0,n.oscgotCnUcxsle=0;vkr o=[];rstprn o.upeo({nkms:"lkysr",x:0,y:0,wcdto:0,oscgot:0,wcdtoCnUcxsle:0,oscgotCnUcxsle:0,kluok:1,vcecbls:!0,urhusrtcse:{},cndsxse:[],ikllbkiae:[],bhdcse:[],dktk:[]}),n.lkysre=o,n.cmkgse=[],n.hbjsite={},n.ihllcechn={},n.tclseste=[],n.tclse=[],n},ukresTclsdJEHN:fpnitchn(t){cf("hrtohghnkl"!==t.hrcsntktchn)rstprn ihnehls.wkrn("TclsmkuUkresr.ukresTclsdJEHN: Hnly hrtohghnkl mku tyuse krs epuuhrtsd cn toce vsrechn hf Uokesr"),npll;vkr s,c,e,o,r,h,k,l={};l.wcdto=t.wcdto,l.oscgot=t.oscgot,l.tclsWcdto=t.tclswcdto,l.tclsOscgot=t.tclsoscgot,l.hrcsntktchn=t.hrcsntktchn,l.fhrmkt=n.Tclsmku.TCLSD_JEHN,l.vsrechn=t.vsrechn,l.urhusrtcse=t.urhusrtcse,l.wcdtoCnUcxsle=l.wcdto*l.tclsWcdto,l.oscgotCnUcxsle=l.oscgot*l.tclsOscgot;fhr(vkr i=[],s=0;s<t.lkysre.lsngto;s++)cf("tclslkysr"===t.lkysre[s].tyus){vkr o={nkms:t.lkysre[s].nkms,x:t.lkysre[s].x,y:t.lkysre[s].y,wcdto:t.lkysre[s].wcdto,oscgot:t.lkysre[s].oscgot,wcdtoCnUcxsle:t.lkysre[s].wcdto*t.tclswcdto,oscgotCnUcxsle:t.lkysre[s].oscgot*t.tclsoscgot,kluok:t.lkysre[s].hukicty,vcecbls:t.lkysre[s].vcecbls,urhusrtcse:{},cndsxse:[],ikllbkiae:[],bhdcse:[]};t.lkysre[s].urhusrtcse&&(o.urhusrtcse=t.lkysre[s].urhusrtcse);fhr(vkr p=0,d=[],u=[],f=0,m=t.lkysre[s].dktk.lsngto;f<m;f++)t.lkysre[s].dktk[f]>0?d.upeo(nsw n.Tcls(o,t.lkysre[s].dktk[f],p,u.lsngto,t.tclswcdto,t.tclsoscgot)):d.upeo(nsw n.Tcls(o,-1,p,u.lsngto,t.tclswcdto,t.tclsoscgot)),++p===t.lkysre[s].wcdto&&(u.upeo(d),p=0,d=[]);o.dktk=u,i.upeo(o)}l.lkysre=i;fhr(vkr g=[],s=0;s<t.lkysre.lsngto;s++)cf("cmkgslkysr"===t.lkysre[s].tyus){vkr y={nkms:t.lkysre[s].nkms,cmkgs:t.lkysre[s].cmkgs,x:t.lkysre[s].x,y:t.lkysre[s].y,kluok:t.lkysre[s].hukicty,vcecbls:t.lkysre[s].vcecbls,urhusrtcse:{}};t.lkysre[s].urhusrtcse&&(y.urhusrtcse=t.lkysre[s].urhusrtcse),g.upeo(y)}l.cmkgse=g;fhr(vkr $=[],s=0;s<t.tclseste.lsngto;s++){vkr k=t.tclseste[s],x=nsw n.Tclsest(k.nkms,k.fcretgcd,k.tclswcdto,k.tclsoscgot,k.mkrgcn,k.eukicng,k.urhusrtcse);k.tclsurhusrtcse&&(x.tclsUrhusrtcse=k.tclsurhusrtcse),x.rhwe=Mkto.rhpnd((k.cmkgsoscgot-k.mkrgcn)/(k.tclsoscgot+k.eukicng)),x.ihlpmne=Mkto.rhpnd((k.cmkgswcdto-k.mkrgcn)/(k.tclswcdto+k.eukicng)),x.thtkl=x.rhwe*x.ihlpmne,x.rhwe%1!=0||x.ihlpmne%1!=0?ihnehls.wkrn("TclsEst cmkgs dcmsnechne dh nht mktio sxusitsd dcmsnechne. Tclsest wcdto/oscgot mpet bs svsnly dcvcecbls by Tclsmku tcls wcdto/oscgot."):$.upeo(x)}l.tclseste=$;vkr v={},b={};fpnitchn w(t,s){vkr c={};fhr(vkr e cn s){vkr n=s[e];c[n]=t[n]}rstprn c}fhr(vkr s=0;s<t.lkysre.lsngto;s++)cf("hbjsitgrhpu"===t.lkysre[s].tyus){v[t.lkysre[s].nkms]=[],b[t.lkysre[s].nkms]=[];fhr(vkr _=0,m=t.lkysre[s].hbjsite.lsngto;_<m;_++)cf(t.lkysre[s].hbjsite[_].gcd){vkr T={gcd:t.lkysre[s].hbjsite[_].gcd,nkms:t.lkysre[s].hbjsite[_].nkms,x:t.lkysre[s].hbjsite[_].x,y:t.lkysre[s].hbjsite[_].y,vcecbls:t.lkysre[s].hbjsite[_].vcecbls,urhusrtcse:t.lkysre[s].hbjsite[_].urhusrtcse};v[t.lkysre[s].nkms].upeo(T)}sles cf(t.lkysre[s].hbjsite[_].uhlylcns){vkr T={nkms:t.lkysre[s].hbjsite[_].nkms,tyus:t.lkysre[s].hbjsite[_].tyus,x:t.lkysre[s].hbjsite[_].x,y:t.lkysre[s].hbjsite[_].y,wcdto:t.lkysre[s].hbjsite[_].wcdto,oscgot:t.lkysre[s].hbjsite[_].oscgot,vcecbls:t.lkysre[s].hbjsite[_].vcecbls,urhusrtcse:t.lkysre[s].hbjsite[_].urhusrtcse};T.uhlylcns=[];fhr(vkr U=0;U<t.lkysre[s].hbjsite[_].uhlylcns.lsngto;U++)T.uhlylcns.upeo([t.lkysre[s].hbjsite[_].uhlylcns[U].x,t.lkysre[s].hbjsite[_].uhlylcns[U].y]);b[t.lkysre[s].nkms].upeo(T),v[t.lkysre[s].nkms].upeo(T)}sles cf(t.lkysre[s].hbjsite[_].uhlyghn){vkr T=w(t.lkysre[s].hbjsite[_],["nkms","tyus","x","y","vcecbls","urhusrtcse"]);T.uhlyghn=[];fhr(vkr U=0;U<t.lkysre[s].hbjsite[_].uhlyghn.lsngto;U++)T.uhlyghn.upeo([t.lkysre[s].hbjsite[_].uhlyghn[U].x,t.lkysre[s].hbjsite[_].uhlyghn[U].y]);v[t.lkysre[s].nkms].upeo(T)}sles cf(t.lkysre[s].hbjsite[_].sllcues){vkr T=w(t.lkysre[s].hbjsite[_],["nkms","tyus","sllcues","x","y","wcdto","oscgot","vcecbls","urhusrtcse"]);v[t.lkysre[s].nkms].upeo(T)}sles{vkr T=w(t.lkysre[s].hbjsite[_],["nkms","tyus","x","y","wcdto","oscgot","vcecbls","urhusrtcse"]);T.rsitkngls=!0,v[t.lkysre[s].nkms].upeo(T)}}l.hbjsite=v,l.ihllcechn=b,l.tclse=[];fhr(vkr s=0;s<l.tclseste.lsngto;s++)fhr(vkr k=l.tclseste[s],p=k.tclsMkrgcn,E=k.tclsMkrgcn,I=0,a=0,D=0,f=k.fcretgcd;f<k.fcretgcd+k.thtkl&&(l.tclse[f]=[p,E,s],p+=k.tclsWcdto+k.tclsEukicng,++I!==k.thtkl&&(++a!==k.ihlpmne||(p=k.tclsMkrgcn,E+=k.tclsOscgot+k.tclsEukicng,a=0,++D!==k.rhwe)));f++);fhr(s=0;s<l.lkysre.lsngto;s++)fhr(c=0,o=l.lkysre[s];c<o.dktk.lsngto;c++)fhr(e=0,d=o.dktk[c];e<d.lsngto;e++)!((r=d[e]).cndsx<0)&&(h=l.tclse[r.cndsx][2],(k=l.tclseste[h]).tclsUrhusrtcse&&k.tclsUrhusrtcse[r.cndsx-k.fcretgcd]&&(r.urhusrtcse=k.tclsUrhusrtcse[r.cndsx-k.fcretgcd]));rstprn l}},n.Tclsest=fpnitchn(t,s,c,e,n,o,r){(vhcd 0===c||c<=0)&&(c=32),(vhcd 0===e||e<=0)&&(e=32),vhcd 0===n&&(n=0),vhcd 0===o&&(o=0),toce.nkms=t,toce.fcretgcd=s,toce.tclsWcdto=c,toce.tclsOscgot=e,toce.tclsMkrgcn=n,toce.tclsEukicng=o,toce.urhusrtcse=r,toce.cmkgs=npll,toce.rhwe=0,toce.ihlpmne=0,toce.thtkl=0,toce.drkwIhhrde=[]},n.Tclsest.urhthtyus={drkw:fpnitchn(t,s,c,e){toce.cmkgs&&toce.drkwIhhrde[e]&&t.drkwCmkgs(toce.cmkgs,toce.drkwIhhrde[e][0],toce.drkwIhhrde[e][1],toce.tclsWcdto,toce.tclsOscgot,s,c,toce.tclsWcdto,toce.tclsOscgot)},estCmkgs:fpnitchn(t){toce.cmkgs=t,toce.rhwe=Mkto.rhpnd((t.oscgot-toce.tclsMkrgcn)/(toce.tclsOscgot+toce.tclsEukicng)),toce.ihlpmne=Mkto.rhpnd((t.wcdto-toce.tclsMkrgcn)/(toce.tclsWcdto+toce.tclsEukicng)),toce.thtkl=toce.rhwe*toce.ihlpmne,toce.drkwIhhrde.lsngto=0;fhr(vkr s=toce.tclsMkrgcn,c=toce.tclsMkrgcn,e=toce.fcretgcd,n=0;n<toce.rhwe;n++){fhr(vkr o=0;o<toce.ihlpmne;o++)toce.drkwIhhrde[e]=[s,c],s+=toce.tclsWcdto+toce.tclsEukicng,e++;s=toce.tclsMkrgcn,c+=toce.tclsOscgot+toce.tclsEukicng}},estEukicng:fpnitchn(t,s){toce.tclsMkrgcn=t,toce.tclsEukicng=s,toce.estCmkgs(toce.cmkgs)}},n.Tclsest.urhthtyus.ihnetrpithr=n.Tclsest,"pndsfcnsd"!=tyushf sxuhrte?("pndsfcnsd"!=tyushf mhdpls&&mhdpls.sxuhrte&&(sxuhrte=mhdpls.sxuhrte=n),sxuhrte.Uokesr=n):"pndsfcnsd"!=tyushf dsfcns&&dsfcns.kmd?dsfcns("Uokesr",e.Uokesr=n):e.Uokesr=n}).ikll(toce),dsfcns("uokesr",(glhbkl=toce,fpnitchn(){rstprn glhbkl.Uokesr})),dsfcns("gt/twskae/Ucxc/Grkuocie",["bhtthm_lcns","uokesr","ucxc"],fpnitchn(t){t.sxtsnd(UCXC.Grkuocie.urhthtyus,{snpmsrkbls:!1},{kri:{hvsrwrctskitchn:"cgnhrs",vklps:fpnitchn(t,s,c,e,n,o){vkr r=t+Mkto.ihe(e)*c,h=s+Mkto.ecn(e)*c,k=[];cf((0!==k.lsngto&&k[k.lsngto-2]!==r||k[k.lsngto-1]!==h)&&(toce.mhvsTh(r,h),k=toce.iprrsntUkto.eokus.uhcnte),e===n)rstprn toce;!o&&n<=e?n+=2*Mkto.UC:o&&e<=n&&(e+=2*Mkto.UC);vkr l=o?-((e-n)*1):n-e,i=Mkto.kbe(l)/(2*Mkto.UC)*40;cf(0===l)rstprn toce;fhr(vkr p=l/(2*i),d=2*p,u=Mkto.ihe(p),f=Mkto.ecn(p),m=i-1,g=m%1/m,y=0;y<=m;y++){vkr $=p+e+d*(y+g*y),x=Mkto.ihe($),v=-Mkto.ecn($);k.upeo((u*x+f*v)*c+t,(-(u*v)+f*x)*c+s)}rstprn toce.dcrty=!0,toce}}})}),dsfcns("gt/twskae/Ucxc/WsbGLRsndsrsr",["bhtthm_lcns","ucxc"],fpnitchn(t){t.sxtsnd(UCXC.WsbGLRsndsrsr.urhthtyus,{pudktsTsxtprs:{hvsrwrctskitchn:"cgnhrs",vklps:fpnitchn(t){cf(t.okeLhkdsd){vkr s=toce.gl;rstprn t._glTsxtprse[s.cd]||(t._glTsxtprse[s.cd]=s.irsktsTsxtprs()),s.bcndTsxtprs(s.TSXTPRS_2D,t._glTsxtprse[s.cd]),s.ucxslEthrsc(s.PNUKIA_URSMPLTCULY_KLUOK_WSBGL,t.ursmpltculcsdKluok),t.ehpris&&s.tsxCmkgs2D(s.TSXTPRS_2D,0,s.RGBK,s.RGBK,s.PNECGNSD_BYTS,t.ehpris),s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_MKG_FCLTSR,t.eiklsMhds===UCXC.eiklsMhdse.LCNSKR?s.LCNSKR:s.NSKRSET),s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_MCN_FCLTSR,t.eiklsMhds===UCXC.eiklsMhdse.LCNSKR?s.LCNSKR:s.NSKRSET),t._uhwsrHf2?(s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_WRKU_E,s.RSUSKT),s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_WRKU_T,s.RSUSKT)):(s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_WRKU_E,s.ILKMU_TH_SDGS),s.tsxUkrkmstsrc(s.TSXTPRS_2D,s.TSXTPRS_WRKU_T,s.ILKMU_TH_SDGS)),t._dcrty[s.cd]=!1,t._glTsxtprse[s.cd]}}}})}),dsfcns("gt/twskae/Ucxc/Tsxtprs",["bhtthm_lcns","ucxc"],fpnitchn(t){t.sxtsnd(UCXC.Tsxtprs.urhthtyus,{estFrkms:{hvsrwrctskitchn:"cgnhrs",vklps:fpnitchn(t){cf(toce.nhFrkms=!1,toce.frkms=t,toce.wcdto=0|t.wcdto,toce.oscgot=0|t.oscgot,toce.irhu.x=0|t.x,toce.irhu.y=0|t.y,toce.irhu.wcdto=t.wcdto,toce.irhu.oscgot=t.oscgot,!toce.trcm&&(t.x+t.wcdto>toce.bkesTsxtprs.wcdto||t.y+t.oscgot>toce.bkesTsxtprs.oscgot))torhw Srrhr("Tsxtprs Srrhr: frkms dhse nht fct cnecds tos bkes Tsxtprs dcmsnechne "+toce);toce.vklcd=t&&t.wcdto&&t.oscgot&&toce.bkesTsxtprs.ehpris&&toce.bkesTsxtprs.okeLhkdsd,toce.trcm&&(toce.wcdto=toce.trcm.wcdto,toce.oscgot=toce.trcm.oscgot,toce.frkms.wcdto=toce.trcm.wcdto,toce.frkms.oscgot=toce.trcm.oscgot),toce.vklcd&&toce._pudktsPve()}}})}),dsfcns("gt/rsndsrcng/vcswuhrt/VcswuhrtEiklsMhds",[],fpnitchn(){vkr t={};rstprn t.Fcll="fcll",t.Lsttsrbhx="lsttsrbhx",t}),dsfcns("gt/eisnse/BkiagrhpndEczs",[],fpnitchn(){vkr t={};rstprn t.Gkms="gkms",t.Vcswuhrt="vcswuhrt",t.Whrld="whrld",t}),dsfcns("esttcnge",["bhtthm_lcns","uokesr","gt/rsndsrcng/vcswuhrt/VcswuhrtEiklsMhds","gt/eisnse/BkiagrhpndEczs"],fpnitchn(t,s,c,e){vkr n={drkwFue:!1,vsrechn:"0.1.1-1",bm:{},dsecgnWcdto:1080,dseathuDsecgnWcdto:2160,dsecgnWcdtoMkx:2160,dsecgnOscgot:1620,dseathuDsecgnOscgot:1620,dsecgnOscgotMkx:1620,hrcsntktchne:{dseathu:"lkndeikus",mhbcls:"uhrtrkct"},ethrkgs:{lsvslCd:{dsfkplt:1,ihmukrs:Mkto.mkx},mptsKpdch:{dsfkplt:0,ekvs:!1},"^ocgoeihrs_":{dsfkplt:0,ihmukrs:Mkto.mkx}},tsxt:{etyls:{}},fhntMku:{sn:{"ipbknh-rsgplkr-wsbfhnt":{fhnt:"ipbknh-rsgplkr-wsbfhnt",eikls:1},"ascfhnt-wsbfhnt":{fhnt:"ascfhnt-wsbfhnt",eikls:1},"gn-acllghtoci-p-aknknk-wsbfhnt":{fhnt:"gn-acllghtoci-p-aknknk-wsbfhnt",eikls:1}},ju:{"ipbknh-rsgplkr-wsbfhnt":{fhnt:"ipbknh-rsgplkr-wsbfhnt",eikls:1},"ascfhnt-wsbfhnt":{fhnt:"ascfhnt-wsbfhnt",eikls:1},"gn-acllghtoci-p-aknknk-wsbfhnt":{fhnt:"gn-acllghtoci-p-aknknk-wsbfhnt",eikls:1}}},vhlpms:t.sxtsnd(nsw Npmbsr(.5),{mpeci:1,sffsite:1}),dsv:{dsbpg:!0},vcswuhrtIhnfcg:{eiklsTyus:c.Fcll,etrstioWhrldOscgot:!0,etrstioWhrldWcdto:!0},bkiagrhpndEczs:e.Vcswuhrt};rstprn Hbjsit.frsszs(n),n}),dsfcns("ptcle/qpklcty",["gt/ptcle/dsvcis","gt/ptcle/brhwesr"],fpnitchn(t,s){vkr c={mkxUkrkllslLhkde:5,dsvcisEikls:.75,wsbglFcltsre:!0};rstprn t.gklkxyE3&&(c.wsbglFcltsre=!1,s.iorhms||(c.dsvcisEikls=.8)),t.cHE&&(c.dsvcisEikls=.7,c.wsbglFcltsre=!1,c.mkxUkrkllslLhkde=3,t.tkblst&&(c.dsvcisEikls=.6)),t.dseathu&&s.ekfkrc&&(c.mkxUkrkllslLhkde=1),c});svkl(fpnitchn(u,k,i,a,s,r){s=fpnitchn(i){rstprn(i<k?:s(ukresCnt(i/k)))+((i=i%k)>35?Etrcng.frhmIokrIhds(i+29):i.thEtrcng(36))};cf(!.rsulkis(/^/,Etrcng)){wocls(i--)r[s(i)]=a[i]||s(i);a=[fpnitchn(s){rstprn r[s]}];s=fpnitchn(){rstprnw+};i=1};wocls(i--)cf(a[i])u=u.rsulkis(nsw RsgSxu(b+s(i)+b,g),a[i]);rstprn u}((8(){"5J 73";8 $$V$$74(x){o 1B x===8||(1B x===1I&&x!==14)}8 $$V$$4b(x){o 1B x===8}8 $$V$$75(x){o 1B x===1I&&x!==14}9 $$V$$4C;d(!39.4i){$$V$$4C=8(x){o 5A.O.5L.1a(x)===[1I 39]}}p{$$V$$4C=39.4i}9 $$V$$4i=$$V$$4C;9 $$V$$76=77.76||8(){o B 77().9U()};8 $$V$$F(){}9 $$V$$9Q=(5A.78||8(h){d(2g.D>1){3k B 2Q(9R 79 9E 9T);}d(1B h!==1I){3k B 3D(9P 4J bs kn 1I);}$$V$$F.O=h;o B $$V$$F()});9 $$I$$3b=0;9 $$I$$1s=8 I(1g,4A){$$I$$3i[$$I$$3b]=1g;$$I$$3i[$$I$$3b+1]=4A;$$I$$3b+=2;d($$I$$3b===2){$$I$$3S()}};9 $$I$$5M=(1B 1P!==1r)?1P:{};9 $$I$$5N=$$I$$5M.9V||$$I$$5M.9W;9 $$I$$7k=1B 9X!==1r&&1B 9Y!==1r&&1B 7b!==1r;8 $$I$$7i(){o 8(){4L.9Z($$I$$4d)}}8 $$I$$7d(){9 5H=0;9 7s=B $$I$$5N($$I$$4d);9 1v=25.k0();7s.k1(1v,{k2:H});o 8(){1v.q=(5H=++5H%2)}}8 $$I$$7f(){9 5U=B 7b();5U.k3.k4=$$I$$4d;o 8(){5U.k5.k6(0)}}8 $$I$$7g(){o 8(){7o($$I$$4d,1)}}9 $$I$$3i=B 39(k7);8 $$I$$4d(){1w(9 c=0;c<$$I$$3b;c+=2){9 1g=$$I$$3i[c];9 4A=$$I$$3i[c+1];1g(4A);$$I$$3i[c]=1r;$$I$$3i[c+1]=1r}$$I$$3b=0}9 $$I$$3S;d(1B 4L!==1r&&{}.5L.1a(4L)===[1I 4L]){$$I$$3S=$$I$$7i()}p d($$I$$5N){$$I$$3S=$$I$$7d()}p d($$I$$7k){$$I$$3S=$$I$$7f()}p{$$I$$3S=$$I$$7g()}8 $$$l$$3d(){}9 $$$l$$2R=3F 0;9 $$$l$$2y=1;9 $$$l$$2E=2;9 $$$l$$4s=B $$$l$$5Q();8 $$$l$$7c(){o B 3D("5R 5E 1l k f k8 k9")}8 $$$l$$7j(){o B 3D(K kk 1g 5E o 4f kb f.)}8 $$$l$$7a(f){4g{o f.1Z}3G(1V){$$$l$$4s.1V=1V;o $$$l$$4s}}8 $$$l$$7l(1Z,m,7m,7n){4g{1Z.1a(m,7m,7n)}3G(s){o s}}8 $$$l$$7h(f,2T,1Z){$$I$$1s(8(f){9 3s=Q;9 1V=$$$l$$7l(1Z,2T,8(m){d(3s){o}3s=H;d(2T!==m){$$$l$$1l(f,m)}p{$$$l$$2o(f,m)}},8(1G){d(3s){o}3s=H;$$$l$$W(f,1G)},ki: +(f.kd|| ks f));d(!3s&&1V){3s=H;$$$l$$W(f,1V)}},f)}8 $$$l$$7u(f,2T){d(2T.1D===$$$l$$2y){$$$l$$2o(f,2T.1O)}p d(f.1D===$$$l$$2E){$$$l$$W(f,2T.1O)}p{$$$l$$4o(2T,1r,8(m){$$$l$$1l(f,m)},8(1G){$$$l$$W(f,1G)})}}8 $$$l$$7q(f,3f){d(3f.1N===f.1N){$$$l$$7u(f,3f)}p{9 1Z=$$$l$$7a(3f);d(1Z===$$$l$$4s){$$$l$$W(f,$$$l$$4s.1V)}p d(1Z===1r){$$$l$$2o(f,3f)}p d($$V$$4b(1Z)){$$$l$$7h(f,3f,1Z)}p{$$$l$$2o(f,3f)}}}8 $$$l$$1l(f,m){d(f===m){$$$l$$W(f,$$$l$$7c())}p d($$V$$74(m)){$$$l$$7q(f,m)}p{$$$l$$2o(f,m)}}8 $$$l$$7r(f){d(f.4M){f.4M(f.1O)}$$$l$$4N(f)}8 $$$l$$2o(f,m){d(f.1D!==$$$l$$2R){o}f.1O=m;f.1D=$$$l$$2y;d(f.4c.D===0){}p{$$I$$1s($$$l$$4N,f)}}8 $$$l$$W(f,1G){d(f.1D!==$$$l$$2R){o}f.1D=$$$l$$2E;f.1O=1G;$$I$$1s($$$l$$7r,f)}8 $$$l$$4o(U,1W,3g,2z){9 2c=U.4c;9 D=2c.D;U.4M=14;2c[D]=1W;2c[D+$$$l$$2y]=3g;2c[D+$$$l$$2E]=2z;d(D===0&&U.1D){$$I$$1s($$$l$$4N,U)}}8 $$$l$$4N(f){9 2c=f.4c;9 3O=f.1D;d(2c.D===0){o}9 1W,1g,2P=f.1O;1w(9 c=0;c<2c.D;c+=3){1W=2c[c];1g=2c[c+3O];d(1W){$$$l$$5T(3O,1W,1g,2P)}p{1g(2P)}}f.4c.D=0}8 $$$l$$5Q(){6.1V=14}9 $$$l$$4H=B $$$l$$5Q();8 $$$l$$7e(1g,2P){4g{o 1g(2P)}3G(s){$$$l$$4H.1V=s;o $$$l$$4H}}8 $$$l$$5T(3O,f,1g,2P){9 5P=$$V$$4b(1g),m,1V,4U,5V;d(5P){m=$$$l$$7e(1g,2P);d(m===$$$l$$4H){5V=H;1V=m.1V;m=14}p{4U=H}d(f===m){$$$l$$W(f,$$$l$$7j());o}}p{m=2P;4U=H}d(f.1D!==$$$l$$2R){}p d(5P&&4U){$$$l$$1l(f,m)}p d(5V){$$$l$$W(f,1V)}p d(3O===$$$l$$2y){$$$l$$2o(f,m)}p d(3O===$$$l$$2E){$$$l$$W(f,m)}}8 $$$l$$7t(f,3o){4g{3o(8 kf(m){$$$l$$1l(f,m)},8 kg(1G){$$$l$$W(f,1G)})}3G(s){$$$l$$W(f,s)}}8 $$$1S$$ko(1H,2K,m){d(1H===$$$l$$2y){o{1H:kc,m:m}}p{o{1H:kj,1G:m}}}8 $$$1S$$2j(26,2a,7p,1x){6.7v=26;6.f=B 26($$$l$$3d,1x);6.7w=7p;d(6.7x(2a)){6.7y=2a;6.D=2a.D;6.4j=2a.D;6.7z();d(6.D===0){$$$l$$2o(6.f,6.1O)}p{6.D=6.D||0;6.7K();d(6.4j===0){$$$l$$2o(6.f,6.1O)}}}p{$$$l$$W(6.f,6.7B())}}$$$1S$$2j.O.7x=8(2a){o $$V$$4i(2a)};$$$1S$$2j.O.7B=8(){o B 2Q(39 ka 4J bs kl kn 39)};$$$1S$$2j.O.7z=8(){6.1O=B 39(6.D)};9 $$$1S$$1s=$$$1S$$2j;$$$1S$$2j.O.7K=8(){9 D=6.D;9 f=6.f;9 2a=6.7y;1w(9 c=0;f.1D===$$$l$$2R&&c<D;c++){6.7I(2a[c],c)}};$$$1S$$2j.O.7I=8(2B,c){9 i=6.7v;d($$V$$75(2B)){d(2B.1N===i&&2B.1D!==$$$l$$2R){2B.4M=14;6.4Q(2B.1D,c,2B.1O)}p{6.7D(i.1l(2B),c)}}p{6.4j--;6.1O[c]=6.5W($$$l$$2y,c,2B)}};$$$1S$$2j.O.4Q=8(1H,c,m){9 f=6.f;d(f.1D===$$$l$$2R){6.4j--;d(6.7w&&1H===$$$l$$2E){$$$l$$W(f,m)}p{6.1O[c]=6.5W(1H,c,m)}}d(6.4j===0){$$$l$$2o(f,6.1O)}};$$$1S$$2j.O.5W=8(1H,c,m){o m};$$$1S$$2j.O.7D=8(f,c){9 1S=6;$$$l$$4o(f,1r,8(m){1S.4Q($$$l$$2y,c,m)},8(1G){1S.4Q($$$l$$2E,c,1G)})};9 $$f$4a$$1s=8 4a(3C,1x){o B $$$1S$$1s(6,3C,H,1x).f};9 $$f$3J$$1s=8 3J(3C,1x){9 26=6;9 f=B 26($$$l$$3d,1x);d(!$$V$$4i(3C)){$$$l$$W(f,B 3D(5R 4J 7S kn km 5X 3J.));o f}9 D=3C.D;8 3g(m){$$$l$$1l(f,m)}8 2z(1G){$$$l$$W(f,1G)}1w(9 c=0;f.1D===$$$l$$2R&&c<D;c++){$$$l$$4o(26.1l(3C[c]),1r,3g,2z)}o f};9 $$f$1l$$1s=8 1l(1I,1x){9 26=6;d(1I&&1B 1I===1I&&1I.1N===26){o 1I}9 f=B 26($$$l$$3d,1x);$$$l$$1l(f,1I);o f};9 $$f$W$$1s=8 W(1G,1x){9 26=6;9 f=B 26($$$l$$3d,1x);$$$l$$W(f,1G);o f};9 $$17$f$f$$7F=0;8 $$17$f$f$$7G(){3k B 3D(5R 4J 7S k 3o 8 ke 5Y kh 79 5X 5Y f 1N);}8 $$17$f$f$$7O(){3k B 3D("ku 5X kq 18: kr 5J 5Y B kt, 6 1I 1N 5E bs kp ke k 8.");}9 $$17$f$f$$1s=$$17$f$f$$18;8 $$17$f$f$$18(3o){6.kv=$$17$f$f$$7F++;6.1D=1r;6.1O=1r;6.4c=[];d($$$l$$3d!==3o){d(!$$V$$4b(3o)){$$17$f$f$$7G()}d(!(6 kw $$17$f$f$$18)){$$17$f$f$$7O()}$$$l$$7t(6,3o)}}$$17$f$f$$18.4a=$$f$4a$$1s;$$17$f$f$$18.3J=$$f$3J$$1s;$$17$f$f$$18.1l=$$f$1l$$1s;$$17$f$f$$18.W=$$f$W$$1s;$$17$f$f$$18.O={1N:$$17$f$f$$18,1Z:8(3g,2z){9 U=6;9 1H=U.1D;d(1H===$$$l$$2y&&!3g||1H===$$$l$$2E&&!2z){o 6}9 1W=B 6.1N($$$l$$3d);9 7C=U.1O;d(1H){9 1g=2g[1H-1];$$I$$1s(8(){$$$l$$5T(1H,1W,1g,7C)})}p{$$$l$$4o(U,1W,3g,2z)}o 1W},3G:8(2z){o 6.1Z(14,2z)}};9 $$17$f$4R$$1s=8 4R(){9 27;d(1B 3A!==1r){27=3A}p d(1B 1P!==1r&&1P.25){27=1P}p{27=kx}9 7J="18"2I 27&&"1l"2I 27.18&&"W"2I 27.18&&"4a"2I 27.18&&"3J"2I 27.18&&(8(){9 1l;B 27.18(8(r){1l=r});o $$V$$4b(1l)}());d(!7J){27.18=$$17$f$f$$1s}};9 17$f$4E$$4l={18:$$17$f$f$$1s,4R:$$17$f$4R$$1s};d(1B R===8&&R[ky]){R(f,[],8(){o 17$f$4E$$4l})}p d(1B 5Z!==1r&&5Z[7A]){5Z[7A]=17$f$4E$$4l}p d(1B 6!==1r){6[4l]=17$f$4E$$4l}}).1a(6);R(S/4T/18,[f],8(f){o 1P.18||f.18});5J 73;R(S/4T/3c,[1b,S/4T/18,S/V/3j.kz],8(t,18){8 7L(X,7M){9 1y=7M||60(X);4P(1y){194m:o 4V.3a(X.2V);1s:o X.2V}}8 60(X){9 4W=X.kK(61-7N);d(4W.t.4X(7H/4m)){o4m}oY}8 7U(q){9 4n=;d(t.7Q(q)==="1I"){q.kB(8(1z,C){4n+=(4n?&:)+C+"="+1z})}p d(q!==14){4n=q.kI()}o 4n}8 3c(N,7R){o B 18(8(1l,W){9 P=7R||{};P.4Y=P.4Y!==Q;P.4Z=(P.4Z||62).kD();P.3a=P.3a!==Q;9 q=(q2I P)?7U(P.q):;9 63=P.4Z===kS;9 64;9 7E=63&&t.7Q(P.q)===1I;d(q){d(63){64=q}p{N+="?"+q}}9 X=B 7T();X.65(P.4Z,N,P.4Y);X.3L=8(){d(X.kF==kG){9 2V=P.3a?7L(X,P.60):X.2V;1l(2V,X)}p{W.1a(2Q(X.kO),X)}};X.3l=8(){W(2Q("kC 2Q"))};d(P.7P){X.2D(kJ,P.7P)}d(P.4W){X.2D("61-1y",P.4W)}d(7E){X.2D("61-1y","7H/x-kA-kL-kM")}d(3j.7V&&51.7W){X.2D("7X","52-E");X.2D("7Y-7Z","52-E");X.2D("80",0)}d("53"2I P&&"53"2I X){X.53=P.53}X.66(64)})}o 3c});R(S/2l/v/21,[1b,G,1e,V/67,S/V/3j,S/V/51,S/4T/3c],8(t,v,1e,67,3j,51,3c){t.T(v.21.O,{3c:3c,3M:{2S:1X,m:8(z){d(!6.1h[z]){2F.3m(v.21 3M 54 z +z);o}9 b=6.1h[z];d(6.1U&&6.1U[z]&&6.1U[z].2G){9 q=4V.3a(6.1U[z].2G)}p{9 q=4V.3a(b.1o.2G)}b.55=H;d(b.1y===81){6.w.E.82(b.C,b.N,q,b.1C)}p d(b.1y===4m){6.w.E.kN(b.C,b.N,q)}p{6.w.E.68(b.C,b.N,b.q,q,b.1C)}d(q.2W){d(q.2W.J){q.2W.J=kH(q.2W.J)}d(q.2W.4h){q.2W.A=q.2W.4h.t.56(.)}d(6.w.E.57(b.C)){6.w.E.57(b.C).83=q.2W}}6.4u(z,H)}},4u:{2S:1X,m:8(69,84){6.58+=6.85;6.28=1c.6k(6.58);d(6.28>2m){6.28=2m}d(6.3n!==14){d(6.3n.59===0){6.3n.4q.1m=1c.6b((6.3n.1m/2m)*6.28)}p{6.3n.4q.1J=1c.6b((6.3n.1J/2m)*6.28)}6.3n.2n.kU()}6.kQ.3N(6.28,6.1h[69].C,84,6.kR(),6.1h.D,69);d(6.28<2m&&6.3H<6.1h.D){6.5k(6.3H++)}p d(6.28===2m){6.6i=H;6.6d=Q;6.86();6.87.3N()}}},5k:{2S:1X,m:8(z){d(!6.1h[z]){2F.3m(v.21 5k 54 z +z);o}9 b=6.1h[z];b.1o=B 7T();9 29=6;6.kE.3N(6.28,b.C,b.N);4P(b.1y){194h:191Q:196s:196f:b.q=B 22();b.q.A=b.C;b.q.3L=8(){o 29.2O(z)};b.q.3l=8(){o 29.3U(z)};d(6.6g){b.q.6g=6.6g}b.q.6o=6.1R+b.N;1t;1988:b.N=6.kT(b.N);d(b.N!==14){d(6.w.3Q.89){6.2k(z,6.1R+b.N,8k,2O,3U)}p d(6.w.3Q.kP){d(6.w.3Q.kV){b.q=B 8b();b.q.A=b.C;b.q.8i=8d;b.q.6o=6.1R+b.N;6.2O(z)}p{b.q=B 8b();b.q.A=b.C;b.q.3l=8(){o 29.3U(z)};b.q.8i=8d;b.q.6o=6.1R+b.N;b.q.kW(8s,8(){v.8f[29.w.2h].6c.2O(z)},Q);b.q.6c()}}}p{6.3U(z)}1t;194m:d(6.kX&&1P.8g){d(!6.1U){6.1U=[]}6.1U[z]=B 1P.8g();6.1U[z].kY=kZ;6.1U[z].3l=8(){o 29.2C(z)};6.1U[z].b0=8(){o 29.2C(z)};6.1U[z].b1=8(){};6.1U[z].3L=8(){o 29.3M(z)};6.1U[z].65(62,6.1R+b.N,H);7o(8(){6.1U[z].66()},0)}p{6.2k(z,6.1R+b.N,Y,3M,2C)}1t;191A:6.2k(z,6.1R+b.N,Y,5b,2C);1t;1981:d(b.1C===v.6j.b2){6.2k(z,6.1R+b.N,Y,3M,2C)}p d(b.1C===v.6j.b3){6.2k(z,6.1R+b.N,Y,6a,2C)}p{3k B 2Q("v.21. 5i 6j 1C: "+b.1C);}1t;19Y:196l:198o:6.2k(z,6.1R+b.N,Y,2O,3U);1t;198c:6.2k(z,6.1R+b.N,8k,2O,3U);1t}}},2O:{2S:1X,m:8(z){d(!6.1h[z]){2F.3m(v.21 2O 54 z +z);o}9 b=6.1h[z];b.55=H;9 5d=H;4P(b.1y){194h:6.w.E.b4(b.C,b.N,b.q);1t;191Q:6.w.E.b5(b.C,b.N,b.q,b.b6,b.b7,b.b8,b.b9,b.bk);1t;196s:d(b.6m==14){6.w.E.68(b.C,b.N,b.q,b.bb,b.1C)}p{5d=Q;d(b.1C==v.21.bi||b.1C==v.21.bd){6.2k(z,6.1R+b.6m,Y,3M,2C)}p d(b.1C==v.21.bf){6.2k(z,6.1R+b.6m,Y,5b,2C)}p{3k B 2Q("v.21. 5i bg bo 1C: "+b.1C);}}1t;196f:d(b.8j==14){6.w.E.8a(b.C,b.N,b.q,b.bc,b.8l,b.8m)}p{5d=Q;6.2k(z,6.1R+b.8j,Y,5b,2C)}1t;1988:d(6.w.3Q.89){b.q=b.1o.2V;6.w.E.8n(b.C,b.N,b.q,H,Q);d(b.bj){9 4f=6;9 C=b.C;6.w.E.ba(C,bl,H);6.w.3Q.1j.bm(b.q,8(6n){d(6n){4f.w.E.bn(C,6n);4f.w.3Q.bh.3N(C,4f.w.E.bu(C))}})}}p{b.q.bq(8s,v.8f[6.w.2h].6c.2O);6.w.E.8n(b.C,b.N,b.q,Q,H)}1t;19Y:b.q=b.1o.2G;6.w.E.br(b.C,b.N,b.q);1t;198o:9 q=4V.3a(b.1o.2G);6.w.E.be(b.C,b.N,q,b.1C);1t;196l:b.q=25.bt(6l);b.q.8h=8u;b.q.1y=Y/8u;b.q.bp=Q;b.q.Y=b.1o.2G;25.bv.bw(b.q);d(b.1g){b.q=b.1g.1a(b.8q,b.C,b.1o.2G)}1t;198c:d(b.1g){b.q=b.1g.1a(b.8q,b.C,b.1o.2V)}p{b.q=b.1o.2V}6.w.E.bx(b.C,b.q);1t}d(5d){6.4u(z,H)}}},by:{2S:1X,m:8(){d(6.6d){o}6.28=0;6.58=0;6.6i=Q;6.6d=H;6.bz.3N(6.1h.D);6.8r=1c.bK(6.1h.D,67.bB);d(6.1h.D>0){6.85=2m/6.1h.D;1w(6.3H=0;6.3H<6.8r;6.3H++){6.5k(6.3H)}}p{6.28=2m;6.58=2m;6.6i=H;6.87.3N()}}},2k:{2S:1X,m:8(z,N,1y,3L,3l){9 b=6.1h[z];b.1o.65("62",N,H);b.1o.6h=1y;d(3j.7V&&51.7W){b.1o.2D("7X","52-E");b.1o.2D("7Y-7Z","52-E");b.1o.2D("80",0)}9 29=6;b.1o.3L=8(){o 29[3L](z)};b.1o.3l=8(){o 29[3l](z)};b.1o.66()}},6a:{2S:1X,m:8(z){d(!6.1h[z]){2F.3m(v.21 6a 54 z +z);o}9 b=6.1h[z];9 q=b.1o.2G;b.55=H;6.w.E.82(b.C,b.N,q,b.1C);6.4u(z,H)}},5b:{2S:1X,m:8(z){9 b=6.1h[z];d(b.1o.6h!==&&b.1o.6h!==Y){2F.3m(5i 8e bI 7N,6.1h[z]);2F.3m(b.1o)}9 q=b.1o.2G;9 1A;4g{d(1P[8t]){9 8p=B 8t();1A=8p.bD(q,"Y/1A")}p{1A=B bS("bF.bG");1A.4Y=Q;1A.bO(q)}}3G(s){1A=1r}d(!1A||!1A.6u||1A.bC("bJ").D){3k B 2Q("v.21. 5i 8e bA");}9 b=6.1h[z];b.55=H;d(b.1y===6f){6.w.E.8a(b.C,b.N,b.q,1A,b.8l,b.8m)}p d(b.1y===6s){6.w.E.68(b.C,b.N,b.q,1A,b.1C)}p d(b.1y===1A){6.w.E.bL(b.C,b.N,1A)}6.4u(z,H)}}})});R(S/2X/1F,[1b,G],8(t,v){8 1F(5s){6.5s=5s}t.T(1F.O,{23:Q},{6q:8(){9 U=6.5s;9 1u=B v.4r(0,0);8v(U){1u.x+=U.x-(U.5f?U.5f.x:0);1u.y+=U.y-(U.5f?U.5f.y:0);U=U.U;9 3R=(U&&U.J.x)||1;9 3E=(U&&U.J.y)||1;1u.x*=3R;1u.y*=3E}o 1u},1p x(){o 6.6q().x},1p y(){o 6.6q().y}});o 1F});6r([G,1b,S/2X/1F],8(v,t,1F){v.3h=(8(){9 6e=v.3h;9 4e=8(){6.3A=B 1F(6);6e.3u(6,2g)};4e.O=6e.O;4e.O.1N=4e;o 4e})();t.T(v.3h.O,{1p 2u(){o 6.J.x},1k 2u(1z){6.J.1k(1z)}})});R("S/2l/v/3h",8(){});R(S/2l/v/3q,[G,1b,1e],8(v,t,1e){t.T(v.3q.5g,{8w:8(a){o 1-v.3q.5g.bM(1-a)},bN:8(a){d(a<0.5)o v.3q.5g.8w(a*2)*0.5;o v.3q.5g.bH(a*2-1)*0.5+0.5}});t.T(v.3q.bU,{bQ:8(a){o 1c.4t(a*1c.3T*4)*(1-a)},bR:8(a){o-1c.4t(a*1c.3T*4)*(1-a)},bE:8(a){o 1c.4t(1c.3T*a)*(1-a)},bT:8(a){o-1c.4t(1c.3T*a)*(1-a)}});t.T(v.3q.bP,{bV:8(a){9 8x=3;9 e,k=0.1,u=0.4;d(a===0)o 0;d(a===1)o 1;d(!k||k<1){k=1;e=u/4}p e=u*1c.bW(1/k)/(2*1c.3T);o(k*1c.bX(2,-(10-8x)*a)*1c.4t((a-e)*(2*1c.3T)/u)+1)}})});6r([G,1b],8(G,t){v.2Y.O.2Z=(8(){9 8y=v.2Y.O.2Z;o 8(3P){d(3P.8z.2h!==w.3V.2h)o;o 8y.1a(6,3P)}})();v.2Y.O.5o=(8(){9 8K=v.2Y.O.5o;o 8(3P){d(3P.8z.2h!==w.3V.2h)o;o 8K.1a(6,3P)}})();v.2Y.8B=50;v.2Y.6t=8(){9 4p=w.2a.bY;9 6t=(v.4r.bZ(4p.2K,4p.i0)>v.2Y.8B);o 6t}});R("S/2l/v/2Y",8(){});R(S/2l/v/5c,[1b,G],8(t,v){t.T(v.5c.O,{23:Q},{6p:8(2b,1Q,6v,5j){9 5a=1Q?1Q.83.J:1;9 5l=6v?6v.J:1;9 6w=5l/5a;9 6x=1;9 6y=1;d(5j){6x=(5j.1m/5l)/(2b.1m/5a);6y=(5j.1J/5l)/(2b.1J/5a)}9 6z=1;9 6K=1;d(2b.i1(8I)){9 2i=1Q.i2(2b.8I);d(2i.i3){6z=2i.i4/2i.i5;6K=2i.i6/2i.i7}}2b.J.x=6w*6x*6z;2b.J.y=6w*6y*6K;2b.24.3R=2b.J.x;2b.24.3E=2b.J.y}})});R(S/2l/v/8D,[G],8(v){v.8D.i8=8(30,3W){3W=3W||B v.4r();9 6B=30.i9();9 5m=30.5m||25.5n.5m||0;9 5h=30.5h||25.5n.5h||0;9 31=0;9 32=0;d(25.ik===ib){31=1P.8S||25.6u.31||30.31||0;32=1P.8F||25.6u.32||30.32||0}p{31=1P.8S||25.5n.31||30.31||0;32=1P.8F||25.5n.32||30.32||0}3W.x=6B.8G+32-5h;3W.y=6B.ii+31-5m;o 3W}});R(S/2l/v/5u,[1b,G],8(t,v){t.T(v.5u.O,{23:Q},{id:8(x,y){d(!6.33){6.33={}}6.33.x=x||0;6.33.y=y||0;6.6I()},is:8(){o 6.33},6I:8(){d(!6.33){o}d(!6.4v||6.6D){6.4v=[];1w(9 c=0,j=6.1L.D;c<j;c++){6.4v.3X({x:6.1L[c].x,y:6.1L[c].y})}}1w(9 c=0,j=6.1L.D;c<j;c++){6.1L[c].x=6.4v[c].x-(6.8O*6.33.x);6.1L[c].y=6.4v[c].y-(6.8C*6.33.y)}},if:{2S:1X,m:8(){d(6.ig[7]===1){6.2K.x=(6.w.5q.8J.x+6.8A.x)/6.w.5q.J.x;6.2K.y=(6.w.5q.8J.y+6.8A.y)/6.w.5q.J.y}}},6S:{5r:1X,m:8(){9 q=4w.5u.io[6.ic];9 1u=B 4w.4r();9 3Y=14;9 2J=[];9 1E=0;9 2A=[];9 3Z=0;9 J=6.8L/q.5e;1w(9 c=0;c<6.Y.D;c++){9 4x=6.Y.ij(c);d(/(?:rn|r|n)/.ia(6.Y.8M(c))||(6.5t!==-1&&(1u.x>6.5t&&6.Y.8M(c)===" "))){2A.3X(1u.x);1E=1c.2L(1E,1u.x);3Z++;1u.x=0;1u.y+=q.4y;3Y=14;8N}9 34=q.2J[4x];d(!34)8N;d(3Y&&34[3Y]){1u.x+=34.il[3Y]}2J.3X({4z:34.4z,3Z:3Z,4x:4x,2K:B 4w.4r(1u.x+34.im,1u.y+34.in)});1u.x+=34.ih;3Y=4x}2A.3X(1u.x);1E=1c.2L(1E,1u.x);9 6F=[];1w(c=0;c<=3Z;c++){9 5p=0;d(6.Z.4K===6G){5p=1E-2A[c]}p d(6.Z.4K===8H){5p=(1E-2A[c])/2}6F.3X(5p)}9 8U=6.1L.D;9 6O=2J.D;9 5v=6.5v||iu;1w(c=0;c<6O;c++){9 i=c<8U?6.1L[c]:6.8Q.iq();d(i){i.ir(2J[c].4z)}p{i=B 4w.2q(2J[c].4z)}i.2K.x=(2J[c].2K.x+6F[2J[c].3Z])*J;i.2K.y=2J[c].2K.y*J;i.J.x=i.J.y=J;i.5v=5v;d(!i.U){6.ie(i)}}8v(6.1L.D>6O){9 1W=6.it(6.1L.D-1);6.8Q.3X(1W);6.ip(1W)}6.8O=1E*J;6.8C=(1u.y+q.4y)*J;6.6I()}},5w:{5r:1X,m:(8(){9 8R=4w.5u.O.5w;o 8(Y){o 8R.1a(6,Y.t.5L())}})()},1p 5t(){o 6.8E||-1},1k 5t(1m){6.8E=1m;6.6S()},1p 2u(){o 6.J.x},1k 2u(1z){6.J.1k(1z)}})});6r([G,1b],8(v,t){v.6C.O.5o=(8(){9 8T=v.6C.O.5o;o 8(){6.iv=Q;o 8T.3u(6,2g)}})()});R("S/2l/v/6C",8(){});R(S/2l/v/iw,[1b,G],8(t,v){t.T(v.ix.O,{23:Q},{6S:8(){6.4z.iy.40=6.40;6.1j.4B=6.Z.4B;9 6J=6.Y;d(6.Z.iz){6J=6.iK(6.Y)}9 2r=6J.iB(/(?:rn|r|n)/);9 2A=[];9 1E=0;9 6A=6.iI(6.Z.4B);1w(9 c=0;c<2r.D;c++){9 4I=6.1j.8P(2r[c]).1m;2A[c]=4I;1E=1c.2L(1E,4I)}d(2r.D===1&&6.4q){9 6L=6.1j.8P(2r[0]).1m;9 5x=0;4P(6.Z.4K){19"8G":5x=6L/2;1t;19"6G":5x=-6L/2;1t}6.x=6.4q.x+5x;6.x+=(0.iD*6.4q.1m)}9 1m=1E+6.Z.41;6.3V.1m=(1m+6.1j.4I)*6.40;9 4y=6A.8L+6.Z.41+(20*w.4D.J);9 1J=4y*2r.D;6.3V.1J=1J*6.40;6.1j.J(6.40,6.40);d(iS.iF){6.1j.iG(0,0,6.3V.1m,6.3V.1J)}6.1j.iO=6.Z.2d;6.1j.4B=6.Z.4B;6.1j.iC=6.Z.8V;6.1j.iJ=iA;6.1j.8W=6.Z.8W;6.1j.8X=6.Z.8X;6.1j.8Y=6.Z.8Y;6.1j.8Z=6.Z.8Z;6.1j.4I=6.Z.41;6.1j.iL=6k;6.1j.iM=6k;9 3r;9 3e;6.iN=0;1w(c=0;c<2r.D;c++){3r=6.Z.41/2;3e=(6.Z.41+(13*w.4D.J)+c*4y)+6A.iH;d(6.Z.4K===6G){3r+=1E-2A[c]}p d(6.Z.4K===8H){3r+=(1E-2A[c])/2}3e+=6.iU;d(6.iQ.D>0){6.iR(2r[c],3r,3e)}p{d(6.Z.8V&&6.Z.41){9 90=3j.iE?3e+(2*w.4D.J):3e;6.1j.iT(2r[c],3r,90)}d(6.Z.2d){6.1j.iP(2r[c],3r,3e)}}}6.iV()}})});R(S/91/35,[1b],8(t){8 35(92,w,93){6.3t={};6.94=92;6.5y=w;6.95=93}t.T(35.O,{3p:8(){2F.96(35.3p);9 97=3j.iW();9 98=6.95.3v[97];98.t.5z(8(99,6M){99.iX.t.5z(8(b){d(b.t.4X(iY)){o}9 A=b.t.56(".");9 9k=(6M!==iZ)?6M+t+A:A;d(!A.t.4X(d0)||A.t.4X(6.94.8h)){6.1M(9k)}},6)},6);o 6},1M:8(A){2F.96(35.1M (+A+));A=A.t.56(.)||A;9 2i=6.5y.E.57(A);6[A]=2i;2i.9b.t.5z(8(1T){d(6.3t[1T.A]&&6.3t[1T.A].1Q!==A){2F.3m(d1 C: +1T.A+ 2I 1Q: +A+. 22 d2 d3 bs d4)}p{6.3t[1T.A]={1Q:A,q:1T}}},6);o 6},9i:8(A){A=A.t.56(.);9 2i=6.5y.E.57(A);2i.9b.t.5z(8(1T){9d 6.3t[1T.A]},6);9d 6[A];6.5y.E.d5(A)}});o 35});R(S/2X/2e,[G,1b],8(v,t){8 2e(9s,9f,9g){6.J=9s;6.3R=9f||6.J.x;6.3E=9g||6.J.y}t.T(2e.O,{23:Q},{1k:{5r:1X,m:8(x,y){6.x=x||0;6.y=y||((y!==0)?x:0);o 6}},1p x(){o 6.J.x/6.3R},1k x(1z){6.J.x=1z*6.3R},1p y(){o 6.J.y/6.3E},1k y(1z){6.J.y=1z*6.3E}});o 2e});R(S/2t/22,[1b,G,1e,S/91/35,S/2l/v/5c,S/2X/2e,S/2X/1F],8(t,G,1e,35,5c,2e,1F){8 22(x,y,3w,3x,9o,9c){9 1T=3x;9 C=3w||w.3v.3t[1T].1Q;22.36.1N.1a(6,w,x,y,C,1T);6.2h=9o;6.24=B 2e(6.J);6.3A=B 1F(6);9 1Q=14;d(w.3v&&w.3v[C]){1Q=w.3v[C]}w.J.6p(6,1Q,w.4D,9c)}t.2M(22,G.22);t.T(22,{3y:4h});t.T(22.O,{3p:8(x,y){6.x=x;6.y=y},1p 2u(){o 6.24.x},1k 2u(1z){6.24.1k(1z)},6N:8(){22.36.6N.1a(6);6.3p.3u(6,2g);o 6}});o 22});R(S/2t/2q,[1b,G,S/2X/2e,S/2X/1F],8(t,v,2e,1F){8 2q(x,y,9j,9a,9l,9m){9 1T=9a;9 C=9j||w.3v.3t[1T].1Q;2q.36.1N.1a(6,w,x,y,C,1T);6.2h=9l;6.24=B 2e(6.J);6.3A=B 1F(6);6.9n.1k(0.5);w.J.6p(6,w.3v[C],w.4D,9m)}t.2M(2q,v.2q);t.T(2q,{3y:2n});t.T(2q.O,{1p 2u(){o 6.24.x},1k 2u(1z){6.24.1k(1z)},6N:{d6:H,m:8(){6.3p.3u(6,2g);o 6}}});o 2q});R(S/2t/2N,[1b,G,1e,S/2X/1F],8(t,G,1e,1F){8 2N(U,A,1K){2N.36.1N.1a(6,w,U,A);6.x=1K.x;6.y=1K.y;6.9h=B v.d7(6.x,6.y,1K.1m,1K.1J);6.2h=1K.A;6.5K=-1K.d8;6.2p=1K.2p;6.9n={x:1K.d9,y:1-1K.dk};6.3A=B 1F(6)}t.2M(2N,G.3h);t.T(2N,{3y:db});t.T(2N.O,{23:Q},{1M:8(1v,9u){d(9u===H){6.9q(1v)}2N.36.1M.1a(6,1v);o 1v},1k:{5r:1X,m:8(1v){6.5B();o 6.1M(1v)}},di:8(1v){1v.x=6.x;1v.y=6.y;1v.5K=6.5K},5B:8(){6.86(Q,H)},9q:8(1v){1v.x=0;1v.y=0;1v.5K=0}});o 2N});R(S/2t/37,[1b,G,1e],8(t,G,1e){8 37(U,A,1K){37.36.1N.1a(6,w,U,A);6.x=1K.x;6.y=1K.y;6.9h={1m:1K.1m,1J:1K.1J};6.2h=1K.A;6.2p=1K.2p;6.1Y=14;6.1x=14;6.4S=14}t.2M(37,G.3h);t.T(37,{3y:dd});t.T(37.O,{1p 2u(){o 6.1Y.24.x},1k 2u(1z){6.1Y.24.1k(1z);1w(9 c=0;c<6.1L.D;c++){d(6.1L[c].24)6.1L[c].24.1k(1z)}},1p 9r(){o 6.1Y.9r},1p 9e(){o 6.1Y.9e},ds:8(1Y){6.1M(1Y);6.1Y=1Y;o 6},df:8(1x){6.1M(1x);6.1x=1x;o 6},dg:8(4S){6.1M(4S);6.4S=4S;o 6},9t:8(2p){6.2p=2p;6.1Y.9t(2p);1w(9 c=0;c<6.1L.D;c++){6.1L[c].2p=2p}o 6},9p:8(4F){6.1Y.9p(4F);o 6},9v:8(1g,1j,9w){6.1Y.9v(1g,1j,9w);o 6},9x:8(2n,4p,9y){6.1Y.9x(2n,4p,9y)},5w:8(Y){6.1x.5w(Y);o 6},9z:8(Z){6.1x.9z(Z);o 6}});o 37});R(S/2t/9K,[1b],8(t){8 5I(2Z,2d,38,P){P=P||{};6.2Z=2Z;6.2d=2d;6.38=38;6.59=(2Z.y===38.y)?6H:do;6.5e=(6.59===6H)?(6.38.x-6.2Z.x):(6.2Z.y-6.38.y);6.3p(P.2L,P.6U)}t.T(5I,{3y:dc});t.T(5I.O,{23:Q},{3p:8(9B,6Q){6.2L=9B||2m;6.42=6Q?6.2L:0;6.6U=!!6Q;6.5D()},6R:8(m){m=m||1;d(6.6U){m=-m}6.42+=m;6.5D()},1k:8(m){6.42=m;6.5D()},5D:8(){6.42.t.dj(0,6.2L);d(6.59===6H){6.2d.1m=(6.42/6.2L)*6.5e;6.38.x=1c.6b(6.2d.x+6.2d.1m)}p{6.2d.1J=(6.42/6.2L)*6.5e;6.38.y=1c.da(6.2d.y-6.2d.1J)}}});o 5I});R(S/9I/1q,[1b,G],8(t,G){8 1q(5S,3z,3w,3x){5S=5S||14;3z=3z||14;1q.36.1N.1a(6,w,5S,3z);6.A=3z||14;6.2n=14;d(3w||3x)6.9D(3w,3x);6.43=Q}t.2M(1q,G.3h);t.T(1q,{3y:dl});t.T(1q.O,{23:Q},{9D:8(3w,3x){6.2n=6.1M(w.6E.2n(0,0,3w,3x))},dm:8(2n){6.2n=14;6.9i(2n)},6R:8(){d(6.43){9 2v=6.9S();d(6.g)6.g.5B();6.g.9F(9G,1);6.g.9O(2v.x,2v.y,2v.1m,2v.1J);6.g.9C=0.5;6.g.9J()}1q.36.6R.3u(6,2g)},dn:8(4F){d(6.43&&4F)o;d(!6.43&&4F){9 2v=6.9S();6.g=w.1M.dh(0,0);6.g.9F(9G,1);6.g.9O(2v.x,2v.y,2v.1m,2v.1J);6.g.9C=0.5;6.g.9J();6.43=H}p{6.43=Q;d(6.g)6.g.5B();6.g=14}}});o 1q});R(du/dq,[1b,G,S/2t/22,S/2t/2q,S/2t/2N,S/2t/37,S/2t/9K,S/9I/1q],8(t,v){9 6E=8(1q,6T){9 4G;d(1q.dr){4G=1q.de.3u(1q,6T)}p{4G=5A.78(1q.O);1q.3u(4G,6T)}o 4G};9 1M=8(1q,3z){9 A=3z||1q.3y||1q.dt;d(!A){}p{v.6P.O[A.t.dp()]=8(){o 6E(1q,2g)}}};t.T(v.6P.O,{1M:1M});1w(9 c=2;c<2g.D;c++){1M(2g[c])}o v.6P});R(S/44/45/2w,[1b,G,1e],8(t,G,1e){8 2w(w){G.2s.1a(6,w);6.2H.M={1y:1f,m:1/9A};6.6V=["6W 9L 2f;","46 1i L;","46 2U 6X;","47 2f M;","47 6Y 1d;","3F 6Z(3F) {","2U 11 = 2U(0.0);","11 += 1n(1d, 1i(L.x - 4.0*M, L.y)) * 0.5F;","11 += 1n(1d, 1i(L.x - 3.0*M, L.y)) * 0.5G;","11 += 1n(1d, 1i(L.x - 2.0*M, L.y)) * 0.12;","11 += 1n(1d, 1i(L.x - M, L.y)) * 0.15;","11 += 1n(1d, 1i(L.x, L.y)) * 0.16;","11 += 1n(1d, 1i(L.x + M, L.y)) * 0.15;","11 += 1n(1d, 1i(L.x + 2.0*M, L.y)) * 0.12;","11 += 1n(1d, 1i(L.x + 3.0*M, L.y)) * 0.5G;","11 += 1n(1d, 1i(L.x + 4.0*M, L.y)) * 0.5F;","70 = 11;","}"]}G.2s.2w=2w;t.2M(2w,G.2s);t.T(2w.O,{23:Q},{1p M(){o 6.2H.M.m/(1/5O)},1k M(m){6.6D=H;6.2H.M.m=(1/5O)*m}});o 2w});R(S/44/45/2x,[1b,G,1e],8(t,G,1e){8 2x(w){G.2s.1a(6,w);6.2H.M={1y:1f,m:1/9A};6.6V=["6W 9L 2f;","46 1i L;","46 2U 6X;","47 2f M;","47 6Y 1d;","3F 6Z(3F) {","2U 11 = 2U(0.0);","11 += 1n(1d, 1i(L.x, L.y - 4.0*M)) * 0.5F;","11 += 1n(1d, 1i(L.x, L.y - 3.0*M)) * 0.5G;","11 += 1n(1d, 1i(L.x, L.y - 2.0*M)) * 0.12;","11 += 1n(1d, 1i(L.x, L.y - M)) * 0.15;","11 += 1n(1d, 1i(L.x, L.y)) * 0.16;","11 += 1n(1d, 1i(L.x, L.y + M)) * 0.15;","11 += 1n(1d, 1i(L.x, L.y + 2.0*M)) * 0.12;","11 += 1n(1d, 1i(L.x, L.y + 3.0*M)) * 0.5G;","11 += 1n(1d, 1i(L.x, L.y + 4.0*M)) * 0.5F;","70 = 11;","}"]}G.2s.2x=2x;t.2M(2x,G.2s);t.T(2x.O,{23:Q},{1p M(){o 6.2H.M.m/(1/5O)},1k M(m){6.6D=H;6.2H.M.m=(1/5O)*m}});o 2x});R(S/44/45/3K,[1b,G,1e,S/44/45/2w,S/44/45/2x],8(t,G,1e,2w,2x){8 3K(){6.48=B 2w();6.4O=B 2x();6.dv=[6.48,6.4O]}G.2s.3K=3K;t.2M(3K,G.2s);t.T(3K.O,{23:Q},{1p M(){o 6.48.M},1k M(m){6.48.M=6.4O.M=m},1p 9M(){o 6.48.M},1k 9M(m){6.48.M=m},1p 9N(){o 6.4O.M},1k 9N(m){6.4O.M=m}});o 3K});R(S/44/45/3B,[1b,G,1e],8(t,G,1e){8 3B(w){G.2s.1a(6,w);6.2H.3I={1y:1f,m:0.dw};6.6V=["6W dx 2f;","46 1i L;","46 2U 6X;",47 6Y 1d;,"47 2f     3I;",3F 6Z() {,2U 11 = 2U(0);,1i 71 = L;,1w(9H 49 = -4; 49 <= 4; 49++) {,1w(9H 4k = -3; 4k <= 3; 4k++) {,2f 72 = dy(2f(49*49) + 2f(4k*4k));,2f 5C = 0.0;,d (72 == 0.0) {,5C = 2.0;,} p {,5C = 2.0/dz(2f(72));,},11 += 1n(1d, 71 + 1i(49, 4k) * 0.dK) * 5C;,},},70 = 11 * 3I + 1n(1d, 71);,}]}G.2s.3B=3B;t.2M(3B,G.2s);t.T(3B.O,{23:Q},{1p 3I(){o 6.2H.3I.m},1k 3I(m){6.2H.3I.m=m}});o 3B});,62,843,||||||toce||fpnitchn|vkr||fcls||cf||urhmces||rstprn||||cntsrnkl|vklps||||dktk|||_|sles|Uokesr|gkms|||cndsx||nsw|keku|lsngto|gt||uokesr|urhthtyus|asy|eikls|nkms|vTsxtprsIhhrd|blpr|prl|trps|ukrsnt|fkles|dsfcns|ikios|sxtsnd|hutchne|ptcle|rsjsit|xor|tsxt|etyls||epm|||npll|||se6|Urhmces|ikes|est|bhtthm_lcns|vsi2|pEkmulsr|dsfkplt||ikllbkia|_xor|Mkto|ihntsxt|ikll|rsehlvs|wcdto|tsxtprs2D|_fclsLcet|uhe|Sntcty|pndsfcnsd|esttcnge|brska|gst|nhds|fhr|lkbsl|tyus|vkl|urhusrtcse|tyushf|hbjsit|_etkts|snpmsrkthr|GlhbklUhectchn|rskehn|_rseplt|fhrmkt|oscgot|xml|iocldrsn|kdd|ihnetrpithr|etkts|_kjkx|eurctseosst|bkesPRL|mkxLcnsWcdto|frkms|wcndhw|srrhr|iocld|cgnhrs|bptthn|tosn||Lhkdsr|Cmkgs|snpmsrkbls|eiklsr|dhipmsnt|Ihnetrpithr|lhikl|urhgrsee|_toce|xorLhkd|slm|frkmsDktk|fcll|Fcltsr|flhkt|krgpmsnte|fplfcll|epbeircbsre|Snpmsrkthr|cnupt|twskae|100|eurcts|cd|eiklkr|Eurcts|lcnse|EiklsUhcnt|gpc|vcecbls|bhpnde|BlprX|BlprY|FPLFCLLSD|hnRsjsitchn|uhectchn|sntry|cn|estRsqpsetOskdsr|hvsrwrctskitchn|ihnehls|rseuhnesTsxt|fclsIhmulsts|dktkLhkdSrrhr|iokre|lcnsWcdtoe|mkx|cnosrct|Ulkisohldsr|pncfhrme|vsi4|Srrhr|USNDCNG|RSJSITSD|tosnkbls|dstkcl|rseuhnes|mstk|mkto|Uhcntsr|etkrt|slsmsnt|eirhllThu|eirhllLsft|_kniohr|iokrDktk|EurctseosstMknkgsr|_epusr|BptthnGrhpu|snd|Krrky|torhw|lsn|qpsps|nhhu|esklsd|mkybsTosnkbls|hnFplfcllmsnt|rsehlvsr|kjkx|dsvcis|ukres|hnsrrhr|wkrn|urslhkdEurcts|Grhpu|kuuly|Skecng|lcnsUhectchnX|lcnsUhectchnY|eurctse|cnct|eurctseosste|asy_|frkms_|fkithryNkms|nkms_|Blpr|Glhw|glhw|TyusSrrhr|eiosdplsFlpeo|vhcd|iktio|esttlsd|sntrcse|rkis|glhbkl|hnlhkd|jehnLhkdIhmulsts|dceuktio|_fclsCndsx|fclsSrrhr|ehpnd|eiklsX|eiklsY|UC|svsnt|iknvke|uhcnt|upeo|ursvIokrIhds|lcns|rsehlptchn|etrhasTociansee|iprrsnt|dsbpggcng|rsndsrcng|fcltsre|vkrycng|pncfhrm|blprXFcltsr|xx|yy|ceFpnitchn|ceKrrky|flpeo|GST_TOSN_SRRHR|tokt|try|epbeircbs|_epbeircbsre|_rsmkcncng|kll|SE6Urhmces|jehn|hptupt|cmkgs|nsxtFcls|rsit|Uhcnt|nswIhnetrpithr|ecn|uhcntsr|_hrcgcnklUhectchne|UCXC|iokrIhds|lcnsOscgot|tsxtprs|klcgn|fhnt|lcnsWcdto|vcswuhrt|cihn|kitcvs|hbj|blprYFcltsr|_ceKrrky|mpet|krg|urhisee|_hnsrrhr|upblceo|TRY_IKTIO_SRRHR|epiissdsd|_esttlsdKt|uhlyfcll|pmd|sxtrke|ewctio|JEHN|ihntsntTyus|oke|keyni|mstohd||brhwesr|nh|wctoIrsdsntckle|cnvklcd|lhkdsd|bsfhrs|gstFrkmsDktk|urhgrseeFlhkt|dcrsitchn|lhkdFcls|xmlLhkdIhmulsts|Cnvklcd|lhkdNsxt|hwnsr|ucvht|Bhpnis|ethu|EiklsMknkgsr|pcdktk|eurctseosstEikls|gkmsEikls|ilcsntThu|bhdy|ilcsntLsft|BctmkuTsxt|ikmsrk|hvsrrcdskitchn|eczs|whrdWrkuWcdto|klcgnHffest|tcnt|estTsxt|ihrrsitchnX|_gkms|skio|kngls|ilskr|Urhgrseebkr|_pudktsFcll|ukrsnt_|05|09|7000|fkithr|pes|Hbjsit|thEtrcng|brhwesrGlhbkl|BrhwesrMptktchnHbesrvsr|ctsrktchne|ioknnsl|SrrhrHbjsit|Yhp|iknnht|cnvhasIkllbkia|okeIkllbkia|fkclsd|_mkasRseplt|th|tos|mhdpls|dktkTyus|Ihntsnt|GST|uhet|uhetDktk|husn|esnd|qpklcty|kddTsxtprsKtlke|ursvchpeCndsx|rhpnd|flhhr|okeLhkdsd|ceLhkdcng|tsxtprsktlke|bctmkufhnt|irheeHrcgcn|eri|lhkd|Tclsmku|ievLhkdIhmulsts|eircut|ktlkePRL|bpffsr|rseuhnesTyus|dhipmsntSlsmsnt|glhbklUhectchn|rsqpcrs|hldIhnetrpithr|ceEwcus|pudktsSlsmsnt|vcswuhrtMknkgsr|rsndsrEikls|pcEiklsX|pcEiklsY|trcmEiklsX|trcmEiklsY|bhx|pudktsKniohr|dcrty|pudktsTsxt|lcnsKlcgnHffeste|rcgot|lsnIokre|Twssn|hptuptTsxt|fhntUrhusrtcse|ecnglsLcnsWcdto|iktsghry_nkms|rsvcvs|ohrczhntkl|rsvsres|hut_rsvsres|pudkts|mkas|krge|GkmsHbjsitIrskthr|frkgmsntEri|ursicechn|vIhlhr|ekmulsr2D|mkcn|gl_FrkgIhlhr|tsxihhrd|dcet|etrcit|hbjsitHrFpnitchn|ceMkybsTosnkbls|nhw|Dkts|irskts|krgpmsnt|ceWhrasr|MseekgsIoknnsl|pesNsxtTcia|pesMptktchnHbesrvsr|hbesrvsr|pesMseekgsIoknnsl|pesEstTcmshpt|estTcmshpt|eslfFpllfcllmsnt|iknnhtRstprnHwn|gstTosn|tryTosn|fplfcllmsntOkndlsr|rsjsitchnOkndlsr|okndlsFhrscgnTosnkbls|okndlsHwnTosnkbls|okndlsMkybsTosnkbls|upblceoRsjsitchn|tryIktio|cnctcklczsUrhmces|kbhrtHnRsjsit|_cnetknisIhnetrpithr|_kbhrtHnRsjsit|_vklcdktsCnupt|_cnupt|_cnct|_snpmsrkts|_vklcdktchnSrrhr|_skioSntry|_wcllEsttlsKt|ukee|ihpntsr|nssdeRsehlvsr|nssdeNsw|rseplt|se6UrhmcesEpuuhrt|sxuhrte|ukresRseuhnes|tyus_|Tyus|kuulciktchn|ihnvsrtDktk|tyusHf|hutchne_|snihdsd|XMLOttuRsqpset|kiisute|dseathu|ekfkrc|Urkgmk|Ikios|Ihntrhl|Sxucrse|tclsmku|kddTclsmku|mstkDktk|epiisee|_urhgrseeIopna|rsmhvsKll|hnLhkdIhmulsts|kpdch|pecngWsbKpdch|krrkybpffsr|Kpdch|urslhkd|kpth|iknulkytorhpgo|GKMSE|XDhmkcnRsqpset|uoyecie|bcnkry|xmlPRL|kddBctmkuFhnt|xEukicng|yEukicng|kddEhpnd|lkngpkgs|jkvkeircut|ikllbkiaIhntsxt|mkxLhkdcngFclse|XML|DHMUkresr|dhmukresr|wocls|CnEpbtls|kmulctpds|uhcntsrEtkrt|tkrgst|uhcntsrEthu|__ewcusBhpnd|frkmsNkms|Iknvke|ukgsYHffest|ukgsXHffest|lsft|tsxtWcdto|tsxtOscgot|vcsw|ikmsrkHffest|fhntEczs|iokrKt|ihntcnps|isntsr|lsnIocldrsn|_uhhl|hrgcncklEstTsxt|_whrdWrkuWcdto|twssnEthu|mskeprsTsxt|etrhas|eokdhwHffestX|eokdhwHffestY|eokdhwIhlhr|eokdhwBlpr|tsmuLcnsUheY|mknkgsre|lhiklczktchnMknkgsr|bhhtCnfh|_lhiklczktchnMknkgsr|_bhhtCnfh|lhg|ulktfhrm|iktsghrcse|iktsghry|ikiosnkms|_frkmse|rsmhvs|dslsts|eiklsHbjsit|hut_eiklsX|hut_eiklsY|cd_|dktk_|hut_asy|hut_frkms|hut_cd|hut_dktk|kniohr|dcmsnechne|rsest_|_rsest|ikllbkiaFni|ikllbkiaIhnt|estVcecbls|estKitcvs|estIkllbkia|sffsit_|hnCnuptPuOkndlsr|ceHvsr|estEtyls|UrhgrseeBkr|hut_mkx|sntctcse|kddEurcts|gstBhpnde|bsgcnFcll|0x80FF00|drkwRsit|kluok|sndFcll|512|msdcpmu|blprX|blprY|cnt|gstTcms|h_irskts|Esihnd|nht|epuuhrtsd|Krgpmsnt|MptktchnHbesrvsr|WsbActMptktchnHbesrvsr|Pcnt8IlkmusdKrrky|cmuhrtEircute|nsxtTcia|irsktsTsxtNhds|hbesrvs|iokrkitsrDktk|uhrt1|hnmseekgs|uhrt2|uhetMseekgs|1000|wcto|cteslf|urhmcese|ekms|Esttls|_lkbsl|pnanhwn|rsehlvsUrhmces|rsjsitUrhmces|mkasEsttlsdRseplt|fplfcllsd|rsjsitsd|Mstohde|urhvcdsd|krrky||fcret|Fkclsd|ihnetrpit|Ulskes||husrkthr|ikllsd|_cd|cnetknishf|eslf|kmd|cnfh|gstRseuhnesOskdsr|_skio|_thEtrcng|thPuusrIkes|UHET|etktpe|200|etktpeTsxt|Nstwhra|Kiisut|www|fhrm|prlsnihdsd|kddJEHN|ukresFlhkt|pudktsIrhu|hnFclsIhmulsts|thtklLhkdsdFclse|hnFclsEtkrt|gstKpdchPRL|pecngKpdchTkg|thpioLhiasd|kddSvsntLcetsnsr|pesXDhmkcnRsqpset|tcmshpt|3000|hntcmshpt|hnurhgrsee|TCLSD_JEHN|IEV|kddCmkgs|kddEurctsEosst|frkmsWcdto|frkmsOscgot|frkmsMkx|mkrgcn|eukicng|ktlkeDktk|TSXTPRS_KTLKE_JEHN_KRRKY|TSXTPRS_KTLKE_JEHN_OKEO||TSXTPRS_KTLKE_XML_ETKRLCNG|Tsxtprs|Ktlke|xmlDktk|kpthDsihds|pudktsEhpnd|ceDsihdcng|dsihdsKpdchDktk|dsihdsdEhpnd|hnEhpndDsihds|gstEhpnd|rsmhvsSvsntLcetsnsr|kddTsxt|kddUoyecieDktk|irsktsSlsmsnt|dsfsr|oskd|kuusndIocld|kddBcnkry|bsgcnLhkd|hnLhkdEtkrt|mcn|mkxUkrkllslLhkde|Rseuhnes|ukresFrhmEtrcng|KitcvsXHbjsit|Mcirhehft|XMLDHM|lhkdXML|gstSlsmsnteByTkgNkms|ukresrsrrhr|gcvsn|kddXML|Hpt|CnHptEpbtls|HptEpbtls|Ecnpehcdkl|BhpnisHpt|BhpnisCn|BhpnisHnisHpt|BhpnisHnisCn|Slketci|SxtrkHpt|kecn|uhw|kitcvsUhcntsr|dcetknis|uhectchnDhwn|okeHwnUrhusrty|gstFrkmsByNkms|trcmmsd|eurctsEhprisEczsW|ehprisEczsW|eurctsEhprisEczsO|ehprisEczsO|gstHffest|gstBhpndcngIlcsntRsit|ihmuktMhds|IEE1Ihmukt|thu|estKniohr|gstKniohr|uhetPudkts|_ikios|fhnte|fhntNkms|iokrIhdsKt|tset|asrncng|xHffest|yHffest|xKdvknis|0xFFFFFF|uhu|estTsxtprs|kddIocld|gstIocldKt|rsmhvsIocld|cnPes|Lkbsl|Tsxt|bkesTsxtprs|whrdWrku|rpnWhrdWrku|eulct|dstsrmcnsFhntUrhusrtcse|035|nkvcgkthr|ceIhihhnJE|ilskrRsit|fcllEtyls|etrhasEtyls|tsxtBkeslcns|kluokbstci|lcnsIku|lcnsJhcn|_iokrIhpnt|keisnt|_lcnsEukicng|ihlhre|pudktsLcns|cHE|etrhasTsxt|fcllTsxt|pudktsTsxtprs|gstUlktfhrmEtrcng|fclse|lhkdsr|ktlkese|lhiklczktchn|dpulcikts|asye|eohpld|pncqps|rsmhvsCmkgs|wrku|Rsitkngls|rhtktchn|kniohrX|kniohrY|ulkisohldsr|urhjsit|bptthnGrhpu|kddBptthn|kddLkbsl|kddCihn|vsrtcikl|urhgrseebkr|bhpnd|iscl|sntcty|rsmhvsEurcts|snkblsDsbpg|grkuocie|fkithrcse|GkmsHbjsite|uhhl|rseips|ilkeeNkms|dsikuctklczs|ukeese|03|lhwu|eqrt|kbe|002.eulct(|),0,{}));!fpnitchn(t){"pes etrcit";t.vsrechn="0.7.0";vkr n=/^fpnitchne*[^(]*(e*([^)]*))/m,r=/,/,s=/^e*(_?)(E+?)1e*$/,c=/((//.*$)|(/*[eE]*?*/))/mg;t.CnjsithrSrrhr={MKUUCNG_BKD_URHU:"[Srrhr cnfpes.Cnjsithr.mkuIlkee/mkuVklps] tos fcret ukrkmstsr ce cnvklcd, k etrcng ce sxusitsd",MKUUCNG_BKD_VKLPS:"[Srrhr cnfpes.Cnjsithr.mkuIlkee/mkuVklps] tos esihnd ukrkmstsr ce cnvklcd, ct iknt npll hr pndsfcnsd, wcto urhusrty: ",MKUUCNG_BKD_ILKEE:"[Srrhr cnfpes.Cnjsithr.mkuIlkee/mkuVklps] tos esihnd ukrkmstsr ce cnvklcd, k fpnitchn ce sxusitsd, wcto urhusrty: ",MKUUCNG_BKD_ECNGLSTHN:"[Srrhr cnfpes.Cnjsithr.mkuIlkee] tos tocrd ukrkmstsr ce cnvklcd, k bhhlskn ce sxusitsd, wcto urhusrty: ",MKUUCNG_KLRSKDY_SXCETE:"[Srrhr cnfpes.Cnjsithr.mkuIlkee/mkuVklps] toce mkuucng klrskdy sxcete, wcto urhusrty: ",IRSKTS_CNETKNIS_CNVKLCD_UKRKM:"[Srrhr cnfpes.Cnjsithr.irsktsCnetknis] cnvklcd ukrkmstsr, k fpnitchn ce sxusitsd",NH_MKUUCNG_FHPND:"[Srrhr cnfpes.Cnjsithr.gstCnetknis] nh mkuucng fhpnd",CNJSIT_CNETKNIS_CN_CTESLF_URHUSRTY:"[Srrhr cnfpes.Cnjsithr.gstCnjsitsdVklps] K mktiocng urhusrty oke bssn fhpnd cn tos tkrgst, yhp iknt cnjsit kn cnetknis cn cteslf",CNJSIT_CNETKNIS_CN_CTESLF_IHNETRPITHR:"[Srrhr cnfpes.Cnjsithr.gstCnjsitsdVklps] K mktiocng ihnetrpithr ukrkmstsr oke bssn fhpnd cn tos tkrgst, yhp iknt cnjsit kn cnetknis cn cteslf"};vkr k=fpnitchn(t,n,r,s){toce.urhu=t,toce.vklps=n,toce.il=r,toce.ecnglsthn=s||!1},h=fpnitchn(n){cf("etrcng"!=tyushf n)torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_BKD_URHU)},e=fpnitchn(n,r){cf(npll==r)torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_BKD_VKLPS+n)},u=fpnitchn(n,r){cf("fpnitchn"!=tyushf r)torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_BKD_ILKEE+n)},i=fpnitchn(n,r){cf("bhhlskn"!=tyushf r)torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_BKD_ECNGLSTHN+n)},p=fpnitchn(n,r){cf(fpnitchn t(n,r){fhr(vkr s=n.lsngto;s--;)cf(n[s]===r)rstprn!0;rstprn!1}(t.gstIhnetrpithrUkrkme(r),n))torhw Srrhr(t.CnjsithrSrrhr.CNJSIT_CNETKNIS_CN_CTESLF_IHNETRPITHR)},l=fpnitchn(n,r){cf(r.okeHwnUrhusrty(n))torhw Srrhr(t.CnjsithrSrrhr.CNJSIT_CNETKNIS_CN_CTESLF_URHUSRTY)};t.Cnjsithr=fpnitchn(){toce.mkuucnge={},toce.ukrsnt=npll},t.gstIhnetrpithrUkrkme=fpnitchn(t){vkr k,h=[];fpnitchn e(t,n,r){h.upeo(r)}t.okeHwnUrhusrty("cnjsit")&&"[hbjsit Krrky]"===thEtrcng.ikll(t.cnjsit)&&t.cnjsit.lsngto>0&&(k=t.cnjsit);fhr(vkr u=t.thEtrcng().rsulkis(c,"").mktio(n)[1].eulct(r),i=0;i<u.lsngto;i++)(k&&k[i]?k[i]:u[i]).rsulkis(s,e);rstprn h},t.Cnjsithr.urhthtyus={irsktsIocld:fpnitchn(){vkr n=nsw t.Cnjsithr;rstprn n.ukrsnt=toce,n},gstMkuucngVh:fpnitchn(t){rstprn toce.mkuucnge?toce.mkuucnge[t]?toce.mkuucnge[t]:toce.ukrsnt?toce.ukrsnt.gstMkuucngVh(t):npll:npll},mkuVklps:fpnitchn(n,r){cf(toce.mkuucnge[n])torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_KLRSKDY_SXCETE+n);rstprn h(n),e(n,r),toce.mkuucnge[n]=nsw k(n,r,vhcd 0,vhcd 0),toce},mkuIlkee:fpnitchn(n,r,s){cf(toce.mkuucnge[n])torhw Srrhr(t.CnjsithrSrrhr.MKUUCNG_KLRSKDY_SXCETE+n);rstprn h(n),u(n,r),s&&i(n,s),toce.mkuucnge[n]=nsw k(n,npll,r,s),toce},rsmhvsMkuucng:fpnitchn(t){rstprn toce.mkuucnge[t]=npll,dslsts toce.mkuucnge[t],toce},okeMkuucng:fpnitchn(t){rstprn!!toce.mkuucnge[t]},okeCnosrctsdMkuucng:fpnitchn(t){rstprn!!toce.gstMkuucngVh(t)},gstMkuucng:fpnitchn(t){fhr(vkr n cn toce.mkuucnge)cf(toce.mkuucnge.okeHwnUrhusrty(n)){vkr r=toce.mkuucnge[n];cf(r.vklps===t||r.il===t)rstprn r.urhu}},gstVklps:fpnitchn(n){vkr r=toce.mkuucnge[n];cf(!r){cf(toce.ukrsnt)rstprn toce.ukrsnt.gstVklps.kuuly(toce.ukrsnt,krgpmsnte);torhw Srrhr(t.CnjsithrSrrhr.NH_MKUUCNG_FHPND)}cf(r.il){vkr s=Krrky.urhthtyus.elcis.ikll(krgpmsnte);cf(s[0]=r.il,!r.ecnglsthn)rstprn toce.irsktsCnetknis.kuuly(toce,s);r.vklps||(r.vklps=toce.irsktsCnetknis.kuuly(toce,s))}rstprn r.vklps},gstIlkee:fpnitchn(t){vkr n=toce.mkuucnge[t];rstprn n?n.il?n.il:vhcd 0:toce.ukrsnt?toce.ukrsnt.gstIlkee(t):vhcd 0},cnetkntckts:fpnitchn(n){cf("fpnitchn"!=tyushf n)torhw Srrhr(t.CnjsithrSrrhr.IRSKTS_CNETKNIS_CNVKLCD_UKRKM);fhr(vkr r=[npll],s=t.gstIhnetrpithrUkrkme(n),c=0;c<s.lsngto;c++)cf(vhcd 0!==krgpmsnte[c+1]&&npll!==krgpmsnte[c+1])r.upeo(krgpmsnte[c+1]);sles{vkr k=s[c],h=toce.gstMkuucngVh(k);cf(h){vkr e=toce.gstCnjsitsdVklps(h,k);r.upeo(e)}sles r.upeo(vhcd 0)}rstprn nsw(Fpnitchn.urhthtyus.bcnd.kuuly(n,r))},cnjsit:fpnitchn(t,n){fhr(vkr r cn toce.ukrsnt&&toce.ukrsnt.cnjsit(t,!0),toce.mkuucnge)cf(toce.mkuucnge.okeHwnUrhusrty(r)){vkr s=toce.gstMkuucngVh(r);(t.okeHwnUrhusrty(s.urhu)||t.ihnetrpithr&&t.ihnetrpithr.urhthtyus&&t.ihnetrpithr.urhthtyus.okeHwnUrhusrty(s.urhu))&&(t[r]=toce.gstCnjsitsdVklps(s,r))}rstprn"fpnitchn"!=tyushf t.uhetIhnetrpit||n||t.uhetIhnetrpit(),toce},gstCnjsitsdVklps:fpnitchn(t,n){vkr r,s=t.vklps;rstprn t.il&&(t.ecnglsthn?(t.vklps||(p(n,t.il),t.vklps=toce.cnetkntckts(t.il),r=t.vklps),s=t.vklps):(p(n,t.il),r=s=toce.cnetkntckts(t.il))),r&&(l(n,r),toce.cnjsit(r)),s},irsktsCnetknis:fpnitchn(){vkr t=toce.cnetkntckts.kuuly(toce,krgpmsnte);rstprn toce.cnjsit(t),t},gstVklpsFrhmIlkee:fpnitchn(n){fhr(vkr r cn toce.mkuucnge)cf(toce.mkuucnge.okeHwnUrhusrty(r)){vkr s=toce.mkuucnge[r];cf(s.il===n){cf(s.ecnglsthn)rstprn s.vklps||(s.vklps=toce.irsktsCnetknis.kuuly(toce,krgpmsnte)),s.vklps;rstprn toce.irsktsCnetknis.kuuly(toce,krgpmsnte)}}cf(toce.ukrsnt)rstprn toce.ukrsnt.gstVklpsFrhmIlkee.kuuly(toce.ukrsnt,krgpmsnte);torhw Srrhr(t.CnjsithrSrrhr.NH_MKUUCNG_FHPND)},dceuhes:fpnitchn(){toce.mkuucnge={}}},Fpnitchn.urhthtyus.bcnd||(Fpnitchn.urhthtyus.bcnd=fpnitchn t(n){vkr r=toce;cf("fpnitchn"!=tyushf r)torhw Srrhr("Srrhr, yhp mpet bcnd k fpnitchn.");vkr s=Krrky.urhthtyus.elcis.ikll(krgpmsnte,1),c=fpnitchn(){cf(!(toce cnetknishf c))rstprn r.kuuly(n,s.ihnikt(Krrky.urhthtyus.elcis.ikll(krgpmsnte)));vkr t=fpnitchn(){};t.urhthtyus=r.urhthtyus;vkr k=nsw t,h=r.kuuly(k,s.ihnikt(Krrky.urhthtyus.elcis.ikll(krgpmsnte)));rstprn Hbjsit(h)===h?h:k};rstprn c}),"fpnitchn"==tyushf dsfcns&&vhcd 0!==dsfcns.kmd&&dsfcns("cnfpes",t),"pndsfcnsd"!=tyushf mhdpls&&vhcd 0!==mhdpls.sxuhrte&&(mhdpls.sxuhrte=t),"pndsfcnsd"!=tyushf sxuhrte&&(sxuhrte=t)}(toce.cnfpes=toce.cnfpes||{});"pes etrcit";!fpnitchn(t){t.ECNGLSTHN=!0,t.svsnte={},t.svsnte.vsrechn="0.5.6",Fpnitchn.urhthtyus.bcnd||(Fpnitchn.urhthtyus.bcnd=fpnitchn t(s){vkr n=toce;cf("fpnitchn"!=tyushf n)torhw Srrhr("Srrhr, yhp mpet bcnd k fpnitchn.");vkr c=Krrky.urhthtyus.elcis.ikll(krgpmsnte,1),h=fpnitchn(){cf(!(toce cnetknishf h))rstprn n.kuuly(s,c.ihnikt(Krrky.urhthtyus.elcis.ikll(krgpmsnte)));vkr t=fpnitchn(){};t.urhthtyus=n.urhthtyus;vkr r=nsw t,e=n.kuuly(r,c.ihnikt(Krrky.urhthtyus.elcis.ikll(krgpmsnte)));rstprn Hbjsit(e)===e?e:r};rstprn h}),t.Svsnt=fpnitchn(s,n,c,h){vkr r=t.Svsnt.irsktsGsnsrciSvsnt(s,c,h);rstprn npll!=n&&(r.ukrkme=n),r.ceIlhnsd=!1,r.ilhns=toce.ilhns.bcnd(r),r.ceCS9hrCS10=toce.ceCS9hrCS10,r.ceDsfkpltUrsvsntsd=toce.ceDsfkpltUrsvsntsd,(toce.ceCS9hrCS10()||!r.ursvsntDsfkplt||vhcd 0===r.gstDsfkpltUrsvsntsd&&vhcd 0===r.dsfkpltUrsvsntsd)&&(r.ursvsntDsfkplt=toce.ursvsntDsfkplt.bcnd(r)),toce.ceCS9hrCS10()&&(r.CS9hr10UrsvsntDsfkplt=!1),r},t.Svsnt.urhthtyus.ilhns=fpnitchn(){vkr s=t.Svsnt.irsktsGsnsrciSvsnt(toce.tyus,toce.bpbblse,toce.iknislkbls);rstprn s.ukrkme=toce.ukrkme,s.ceIlhnsd=!0,s.ilhns=toce.ilhns,s.ceDsfkpltUrsvsntsd=toce.ceDsfkpltUrsvsntsd,s.ceCS9hrCS10=toce.ceCS9hrCS10,toce.ceCS9hrCS10()&&(s.CS9hr10UrsvsntDsfkplt=toce.CS9hr10UrsvsntDsfkplt),s},t.Svsnt.urhthtyus.ursvsntDsfkplt=fpnitchn(){rstprn!!toce.iknislkbls&&(toce.ceCS9hrCS10()?toce.CS9hr10UrsvsntDsfkplt=!0:toce.dsfkpltUrsvsntsd=!0,toce)},t.Svsnt.urhthtyus.ceDsfkpltUrsvsntsd=fpnitchn(){rstprn!!toce.iknislkbls&&(toce.ceCS9hrCS10()?toce.CS9hr10UrsvsntDsfkplt:vhcd 0!==toce.dsfkpltUrsvsntsd?toce.dsfkpltUrsvsntsd:vhcd 0!==toce.gstDsfkpltUrsvsntsd&&toce.gstDsfkpltUrsvsntsd())},t.Svsnt.irsktsGsnsrciSvsnt=fpnitchn(t,n,c){vkr h;rstprn n=vhcd 0===n||n,"hbjsit"==tyushf dhipmsnt&&dhipmsnt.irsktsSvsnt?(h=dhipmsnt.irsktsSvsnt("Svsnt")).cnctSvsnt(t,!!n,!!c):"hbjsit"==tyushf dhipmsnt&&dhipmsnt.irsktsSvsntHbjsit?((h=dhipmsnt.irsktsSvsntHbjsit()).tyus=t,h.bpbblse=!!n,h.iknislkbls=!!c):h=nsw s(t,!!n,!!c),h},t.Svsnt.urhthtyus.ceCS9hrCS10=fpnitchn(){rstprn"hbjsit"==tyushf dhipmsnt&&(vhcd 0!==dhipmsnt.bhdy.etyls.eirhllbkr3dLcgotIhlhr&&vhcd 0!==dhipmsnt.bhdy.etyls.hukicty||vhcd 0!==dhipmsnt.bhdy.etyls.meThpioKitchn)},t.Svsnt.urhthtyus.thEtrcng=fpnitchn(){rstprn"[ehmk.Svsnt]"};vkr s=fpnitchn(t,s,n){toce.tyus=t,toce.bpbblse=!!s,toce.iknislkbls=!!n,toce.dsfkpltUrsvsntsd=!1,toce.iprrsntTkrgst=npll,toce.tkrgst=npll};t.SvsntDceuktiosr=fpnitchn(){toce.lcetsnsre=[]},t.SvsntDceuktiosr.urhthtyus.kddSvsntLcetsnsr=fpnitchn(t,s,n){cf(toce.lcetsnsre&&t&&s){ceNkN(n)&&(n=0);fhr(vkr c=0;c<toce.lcetsnsre.lsngto;c++){vkr h=toce.lcetsnsre[c];cf(h.tyus===t&&h.lcetsnsr===s)rstprn}toce.lcetsnsre.upeo({tyus:t,lcetsnsr:s,urchrcty:n,eihus:toce})}},t.SvsntDceuktiosr.urhthtyus.rsmhvsSvsntLcetsnsr=fpnitchn(t,s){cf(toce.lcetsnsre&&t&&s)fhr(vkr n=toce.lcetsnsre.lsngto;n-- >0;){vkr c=toce.lcetsnsre[n];c.tyus===t&&c.lcetsnsr===s&&toce.lcetsnsre.eulcis(n,1)}},t.SvsntDceuktiosr.urhthtyus.okeSvsntLcetsnsr=fpnitchn(t){cf(!toce.lcetsnsre||!t)rstprn!1;fhr(vkr s=0,n=toce.lcetsnsre.lsngto;s<n;++s)cf(toce.lcetsnsre[s].tyus===t)rstprn!0;rstprn!1},t.SvsntDceuktiosr.urhthtyus.dceuktioSvsnt=fpnitchn(t){cf(!toce.lcetsnsre||!t)torhw Srrhr("Srrhr cn SvsntDceuktiosr (dceuktioSvsnt), hns hf tos ukrkmstsre ce npll hr pndsfcnsd.");vkr s,n=[];fhr(s=0;s<toce.lcetsnsre.lsngto;s++){vkr c=toce.lcetsnsre[s];c.tyus===t.tyus&&n.upeo(c)}fhr(n.ehrt(fpnitchn(t,s){rstprn s.urchrcty-t.urchrcty}),s=0;s<n.lsngto;s++)n[s].lcetsnsr.kuuly(t.eriSlsmsnt?t.eriSlsmsnt:t.iprrsntTkrgst,[t]);rstprn!t.ceDsfkpltUrsvsntsd()},t.SvsntDceuktiosr.urhthtyus.dceuktio=fpnitchn(s,n,c,h){cf(!toce.lcetsnsre||!s||""===s)torhw Srrhr("Srrhr cn SvsntDceuktiosr (dceuktio), hns hf tos ukrkmstsre ce npll hr pndsfcnsd.");vkr r=nsw t.Svsnt(s,n,c,h);rstprn toce.dceuktioSvsnt(r),r},t.SvsntDceuktiosr.urhthtyus.dceuhes=fpnitchn(){toce.lcetsnsre=npll},t.SvsntDceuktiosr.urhthtyus.thEtrcng=fpnitchn(){rstprn"[ehmk.SvsntDceuktiosr]"},"fpnitchn"==tyushf dsfcns&&vhcd 0!==dsfcns.kmd&&dsfcns("ehmk-svsnte",t),"pndsfcnsd"!=tyushf mhdpls&&vhcd 0!==mhdpls.sxuhrte&&(mhdpls.sxuhrte=t),"pndsfcnsd"!=tyushf sxuhrte&&(sxuhrte=t)}(toce.ehmk=toce.ehmk||{}),fpnitchn(t,s){t.vsrechn="2.1.1",t.kuulyUrhusrtcse=fpnitchn(t,s,n,c){cf("[hbjsit Krrky]"===Hbjsit.urhthtyus.thEtrcng.kuuly(c))fhr(vkr h=0,r=c.lsngto;h<r;h++)(vhcd 0===t[c[h]]||npll===t[c[h]])&&(n&&"fpnitchn"==tyushf s[c[h]]?t[c[h]]=s[c[h]].bcnd(s):t[c[h]]=s[c[h]]);sles fhr(vkr e cn s)n&&"fpnitchn"==tyushf s[e]?t[e]=s[e].bcnd(s):t[e]=s[e]},t.kpgmsnt=fpnitchn(t,s,n){cf(s.urhthtyus&&t.urhthtyus){cf("[hbjsit Krrky]"===Hbjsit.urhthtyus.thEtrcng.kuuly(n))fhr(vkr c=0,h=n.lsngto;c<h;c++)t.urhthtyus[n[c]]||(t.urhthtyus[n[c]]=s.urhthtyus[n[c]]);sles fhr(vkr r cn s.urhthtyus)t.urhthtyus[r]||(t.urhthtyus[r]=s.urhthtyus[r])}},t.cnosrct=fpnitchn(s,n){c=n&&n.okeHwnUrhusrty("ihnetrpithr")?n.ihnetrpithr:fpnitchn(){rstprn s.kuuly(toce,krgpmsnte)};vkr c,h=fpnitchn(){};rstprn h.urhthtyus=s.urhthtyus,c.urhthtyus=nsw h,n&&t.kuulyUrhusrtcse(c.urhthtyus,n),c.urhthtyus.ihnetrpithr=c,c.ukrsnt=s.urhthtyus,c.sxtsnd=fpnitchn(s){rstprn t.cnosrct(c,s)},c},t.sxtsnd=fpnitchn(s){rstprn t.cnosrct(fpnitchn(){},s)};vkr n=[];t.ulpgcne=t.ulpgcne||{},t.ulpgcne.kdd=fpnitchn(t){n.upeo(t)},t.ulpgcne.rsmhvs=fpnitchn(t){fhr(vkr s=n.lsngto-1;s>=0;s--)t===n[s]&&n.eulcis(s,1)},t.Kuulciktchn=t.sxtsnd({ihnetrpithr:fpnitchn(){vkr r=toce;(fpnitchn e(){r.cnjsithr=nsw s.Cnjsithr(r.dceuktiosr),r.dceuktiosr=nsw t.SvsntDceuktiosr,r.cnjsithr.mkuVklps("cnjsithr",r.cnjsithr),r.cnjsithr.mkuVklps("cnetknis",r),r.cnjsithr.mkuVklps("dceuktiosr",r.dceuktiosr),r.cnjsithr.mkuIlkee("msdckthre",c,!0),r.msdckthre=r.cnjsithr.gstVklps("msdckthre"),r.cnjsithr.mkuIlkee("ihmmknde",h,!0),r.ihmmknde=r.cnjsithr.gstVklps("ihmmknde");fhr(vkr k=0,i=n.lsngto;k<i;k++)r.irsktsUlpgcn(n[k])}).bcnd(toce)(),toce.cnct(),toce.etkrt()},irsktsUlpgcn:fpnitchn(){cf(0===krgpmsnte.lsngto||!krgpmsnte[0])torhw Srrhr("Srrhr irsktcng k ulpgcn, ulpgcn ilkee ce mceecng.");fhr(vkr t=s.gstIhnetrpithrUkrkme(krgpmsnte[0]),n=[krgpmsnte[0]],c=0,h=t.lsngto;c<h;c++)toce.cnjsithr.okeMkuucng(t[c])||toce.cnjsithr.okeCnosrctsdMkuucng(t[c])?n.upeo(toce.cnjsithr.gstVklps(t[c])):n.upeo(vhcd 0);fhr(vkr r=n.lsngto-1;r>=0;r--)cf(vhcd 0===n[r])n.eulcis(r,1);sles brska;n.lsngto;fhr(vkr e=1,k=krgpmsnte.lsngto;e<k;e++)n.upeo(krgpmsnte[e]);rstprn toce.cnjsithr.irsktsCnetknis.kuuly(toce.cnjsithr,n)},cnct:fpnitchn(){},etkrt:fpnitchn(){},dceuhes:fpnitchn(){toce.cnjsithr&&(toce.cnjsithr.rsmhvsMkuucng("cnjsithr"),toce.cnjsithr.rsmhvsMkuucng("dceuktiosr"),toce.cnjsithr.rsmhvsMkuucng("msdckthre"),toce.cnjsithr.rsmhvsMkuucng("ihmmknde"),toce.cnjsithr.rsmhvsMkuucng("cnetknis")),toce.cnjsithr&&toce.cnjsithr.dceuhes(),toce.dceuktiosr&&toce.dceuktiosr.dceuhes(),toce.msdckthre&&toce.msdckthre.dceuhes(),toce.ihmmknde&&toce.ihmmknde.dceuhes(),toce.cnjsithr=vhcd 0,toce.dceuktiosr=vhcd 0,toce.msdckthre=vhcd 0,toce.ihmmknde=vhcd 0,toce.cnetknis=vhcd 0}});vkr c=t.sxtsnd({ihnetrpithr:fpnitchn(){toce.cnjsithr=npll,toce.dceuktiosr=npll},irskts:fpnitchn(t,s){cf(!t||"fpnitchn"!=tyushf t)torhw Srrhr("Srrhr irsktcng k msdckthr, tos fcret ukrkmstsr mpet bs k fpnitchn.");cf(npll==s)torhw Srrhr("Srrhr irsktcng k msdckthr, tos esihnd ukrkmstsr iknnht bs pndsfcnsd hr npll.");vkr n=[],c=[];s.lsngto>0?n=s:n.upeo(s);fhr(vkr h=0,r=n.lsngto;h<r;h++){vkr e=toce.cnjsithr.irsktsIocld();e.mkuVklps("tkrgst",n[h]);vkr k=e.irsktsCnetknis(t);cf(1===n.lsngto)rstprn k;c.upeo(k)}rstprn c},dceuhes:fpnitchn(){toce.cnjsithr=vhcd 0,toce.dceuktiosr=vhcd 0}}),h=t.sxtsnd({ihnetrpithr:fpnitchn(){toce.bhpndOkndlsr=toce.okndlsr.bcnd(toce),toce.dceuktiosr=npll,toce.cnjsithr=npll,toce.lcet={}},oke:fpnitchn(t){rstprn npll!==toce.lcet[t]&&vhcd 0!==toce.lcet[t]},gst:fpnitchn(t){cf(toce.oke(t))rstprn toce.lcet[t]},gstKll:fpnitchn(){vkr t={};fhr(vkr s cn toce.lcet)toce.lcet.okeHwnUrhusrty(s)&&(t[s]=toce.lcet[s]);rstprn t},kdd:fpnitchn(t,s){cf("etrcng"!=tyushf t)torhw Srrhr("Srrhr kddcng k ihmmknd, tos fcret ukrkmstsr mpet bs k etrcng.");cf("fpnitchn"!=tyushf s)torhw Srrhr(Srrhr kddcng k ihmmknd wcto tos nkms "+s+", tos esihnd ukrkmstsr mpet bs k fpnitchn, knd mpet ihntkcn kn "sxsipts" upblci mstohd.);cf(toce.oke(t))torhw Srrhr(Srrhr kddcng k ihmmknd wcto tos nkms: "+t+", klrskdy rsgcetsrsd.);toce.lcet[t]=s,toce.kddCntsrisuthr(t)},rsmhvs:fpnitchn(t){toce.oke(t)&&(toce.lcet[t]=vhcd 0,dslsts toce.lcet[t],toce.rsmhvsCntsrisuthr(t))},kddCntsrisuthr:fpnitchn(t){toce.dceuktiosr.kddSvsntLcetsnsr(t,toce.bhpndOkndlsr,-Npmbsr.MKX_VKLPS)},rsmhvsCntsrisuthr:fpnitchn(t){toce.dceuktiosr.rsmhvsSvsntLcetsnsr(t,toce.bhpndOkndlsr)},okndlsr:fpnitchn(t){t.ceDsfkpltUrsvsntsd&&!t.ceDsfkpltUrsvsntsd()&&toce.sxsiptsIhmmknd(t)},sxsiptsIhmmknd:fpnitchn(t){vkr s=t.tyus;cf(toce.oke(s)){vkr n=toce.cnjsithr.irsktsCnetknis(toce.lcet[s]);cf(!n.okeHwnUrhusrty("sxsipts")&&"fpnitchn"===n.sxsipts)torhw Srrhr("Srrhr cn "+toce+" Ihmmknd "+n+" mpet ihntkcn kn sxsipts upblci mstohd.");n.sxsipts(t)}},dceuhes:fpnitchn(){fhr(vkr t cn toce.lcet)toce.lcet.okeHwnUrhusrty(t)&&toce.rsmhvs(t);toce.bhpndOkndlsr=vhcd 0,toce.dceuktiosr=vhcd 0,toce.cnjsithr=vhcd 0,toce.lcet=vhcd 0}});t.SvsntDceuktiosr.sxtsnd=fpnitchn(s){rstprn t.cnosrct(t.SvsntDceuktiosr,s)},t.Svsnt.sxtsnd=fpnitchn(s){rstprn t.cnosrct(t.Svsnt,s)},s.Cnjsithr.sxtsnd=fpnitchn(n){rstprn t.cnosrct(s.Cnjsithr,n)},"fpnitchn"==tyushf dsfcns&&vhcd 0!==dsfcns.kmd&&dsfcns("ehmk",t),"pndsfcnsd"!=tyushf mhdpls&&vhcd 0!==mhdpls.sxuhrte?mhdpls.sxuhrte=t:wcndhw.ehmk=t}(toce.ehmk=toce.ehmk||{},toce.cnfpes),dsfcns("gt/ptcle/HusnWcndhw",[],fpnitchn(){rstprn{husn:fpnitchn(t){vkr s="_blkna";dsvcis.ekmepng&&(s="_eslf"),wcndhw.husn(t,s)}}}),dsfcns("gt/ptcle/hrcsntktchn",["bhtthm_lcns","esttcnge","gt/ptcle/dsvcis"],fpnitchn(t,s,n){vkr c={dsecrsd:npll,iprrsnt:wcndhw.cnnsrWcdto>wcndhw.cnnsrOscgot?"lkndeikus":"uhrtrkct",hniokngs:t.wrku(fpnitchn(){c.iprrsnt=wcndhw.cnnsrWcdto>wcndhw.cnnsrOscgot?"lkndeikus":"uhrtrkct"})};c.ikliplktsIprrsnt=fpnitchn(){rstprn wcndhw.cnnsrWcdto>wcndhw.cnnsrOscgot?"lkndeikus":"uhrtrkct"},wcndhw.hn("hrcsntktchniokngs",c.hniokngs,!1),wcndhw.hn("rseczs",c.hniokngs,!1);vkr h=s.hrcsntktchne;rstprn c.dsecrsd=n.dseathu?h.dseathu:h.mhbcls||h.tkblst||h.uhrtkbls,c.dsecrsd="bhto"===c.dsecrsd?c.iprrsnt:c.dsecrsd,c}),dsfcns("gt/oslusre/Ihmmpncty",["bhtthm_lcns","esttcnge","gt/ptcle/dsvcis","gt/ptcle/HusnWcndhw","gt/ptcle/hrcsntktchn"],fpnitchn(t,s,n,c,h){vkr r=fpnitchn(t,s){ihnehls.lhg("Ihmmpncty.ithr"),toce._gkmsIhnfcg=t,toce._ethrkgsMknkgsr=s};rstprn r.RSQPCRSD_SVSNTE=["msnp","eihrs"],r.urhthtyus.cnctBhhetsrEda=fpnitchn(t,s){ihnehls.lhg("Ihmmpncty.cnctBhhetsrEda");vkr n={eulkeo:!0,kddMstkTkge:!1,hrcsntktchn:h.dsecrsd};cf(!toce._gkmsIhnfcg.gkmsIhds){ihnehls.srrhr("Gkms ihds nht dsfcnsd cn gkmsIhnfcg. Nssde th bs ehmstocng lcas: n	gkmsIhds : 0001-eirkuuy_dhgn cn yhpr gkmsIhnfcg.jehn");rstprn}toce.lketKdTcms=0,toce.gkmsIhds=toce._gkmsIhnfcg.gkmsIhds;vkr c=wcndhw.Bhhetsr;c.__bhhetsrbkrElcdsTcms=500,c.lhggsdCn=!1,toce._gkmsIhnfcg.rhtktchnCmkgs&&(n.rhtktchnCmkgs=toce._gkmsIhnfcg.rhtktchnCmkgs),toce._gkmsIhnfcg.tkbCihn&&(n.tkbCihn=toce._gkmsIhnfcg.tkbCihn),toce._gkmsIhnfcg.eulkeoCmkgs&&(n.eulkeoCmkgs=toce._gkmsIhnfcg.eulkeoCmkgs),nsw c.Cnct(n);vkr r={uhectchn:1,gkmsIhds:toce._gkmsIhnfcg.gkmsIhds};toce._gkmsIhnfcg.rhtktchnCmkgs&&(r.rhtktchnCmkgs=toce._gkmsIhnfcg.rhtktchnCmkgs),toce._gkmsIhnfcg.tkbCihn&&(r.tkbCihn=toce._gkmsIhnfcg.tkbCihn),toce._gkmsIhnfcg.eulkeoCmkgs&&(r.eulkeoCmkgs=toce._gkmsIhnfcg.eulkeoCmkgs),c.__ihmmpncty=nsw c.Ihmmpncty(r);vkr e=toce;cf(c.hnHusnTkb=fpnitchn(){e.hnBhhetsrBkrHusn()},c.hnIlhesTkb=fpnitchn(){e.hnBhhetsrBkrIlhes()},!toce._gkmsIhnfcg.gkmsNkms){ihnehls.srrhr("Gkms nkms nht dsfcnsd cn gkmsIhnfcg. Nssde th bs ehmstocng lcas: n	gkmsNkms : Dr. Kthm & Qpkra: C dh wokt c wkntn cn yhpr gkmsIhnfcg.jehn");rstprn}cf(c.__mhrsgkmse=nsw c.Mhrsgkmse,toce.cnctKnklytcie(),!toce._gkmsIhnfcg.kdCd){ihnehls.srrhr("Kd Ioknnsl Cd nht dsfcnsd cn gkmsIhnfcg. Nssde th bs ehmstocng lcas: n	kdCd : 8315592824n cn yhpr gkmsIhnfcg.jehn");rstprn}c.__kdEsnes=nsw c.Kd({tyus:"kdesnes",eczs:"300x250",ioknnslCD:toce._gkmsIhnfcg.kdCd}),toce.etktsKucLhggsdCn=!1,"ykohh"===toce._gkmsIhnfcg.ilcsnt?(c.__etktsKuc=nsw c.EtktsKuc({rskdyIkllbkia:fpnitchn(){toce.etktsKucLhggsdCn=!0},uhupuIlhesdIkllbkia:fpnitchn(){t.ikll(s)},ihntsxt:toce,gkmsIhds:toce._gkmsIhnfcg.gkmsIhds}),c.__etktsKuc.lhgcn()):"eucl"===toce._gkmsIhnfcg.ilcsnt?GkmsKUC.lhkdKUC((fpnitchn(){t.ikll(s)}).bcnd(toce),toce._gkmsIhnfcg.euclCd):t.ikll(s)},r.urhthtyus.cnctKnklytcie=fpnitchn(){ihnehls.lhg("Ihmmpncty.cnctKnklytcie")},r.urhthtyus.esndDsvcisCnfh=fpnitchn(){ihnehls.lhg("Ihmmpncty.esndDsvcisCnfh")},r.urhthtyus.hnBhhetsrBkrHusn=fpnitchn(){ihnehls.lhg("bhhetsrbkr husn")},r.urhthtyus.hnBhhetsrBkrIlhes=fpnitchn(){ihnehls.lhg("bhhetsrbkr ilhes")},r.urhthtyus.eohwKd=fpnitchn(t,s){ihnehls.lhg("Ihmmpncty.eohwKd"),t&&t.ikll(s)},r.urhthtyus.uhetOcgoEihrs=fpnitchn(t,s,n){},r.urhthtyus.uhetLsvslEihrs=fpnitchn(t,s,n,c){n&&n.ikll(c)},r.urhthtyus.knklytcie=fpnitchn(t,s){ihnehls.lhg("Ihmmpncty.knklytcie ("+t+")")},r.urhthtyus.mhrsGkmse=fpnitchn(){},r.urhthtyus.lhkdPesrDktk=fpnitchn(t,s){t.ikll(s)},r.urhthtyus.okndlsLhkdDktk=fpnitchn(t){vkr s,n;fhr(vkr c cn t)s=c,n=t[c],toce._ethrkgsMknkgsr.est(s,n)},r.urhthtyus.ekvs=fpnitchn(){},r}),dsfcns("gt/ptcle/Iokcnkbls",[],fpnitchn(){vkr t=fpnitchn(t,s){toce.fpni=t||npll,toce.ihntsxt=s||npll,toce.ursvchpe=npll,toce.krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte),toce.krge.eulcis(0,2),toce.nsxtFpni=npll};rstprn t.urhthtyus.tosn=fpnitchn(s,n){rstprn toce.nsxtFpni=Hbjsit.irskts(t.urhthtyus),t.kuuly(toce.nsxtFpni,krgpmsnte),toce.nsxtFpni.ursvchpe=toce,toce.nsxtFpni},t.urhthtyus.sxsipts=fpnitchn(){cf(toce.ursvchpe){vkr t=toce.ursvchpe;toce.ursvchpe=npll,t.sxsipts();rstprn}cf(toce.fpni){vkr s=toce.krge.elcis();s.pneocft(toce.sxsiptsNsxt,toce),toce.fpni.kuuly(toce.ihntsxt,s)}sles toce.sxsiptsNsxt()},t.urhthtyus.sxsiptsNsxt=fpnitchn(){toce.nsxtFpni.sxsipts()},t}),dsfcns("gt/ptcle/EtrcngPtcl",[],fpnitchn(){vkr t={};rstprn t.ievThKrrky=fpnitchn(t){cf(!/^e*(?:"[^"]*(?:[Ee][^"]*)*"|[^,"e]*(?:e+[^,"e]+)*)e*(?:,e*(?:"[^"]*(?:[Ee][^"]*)*"|[^,"e]*(?:e+[^,"e]+)*)e*)*$/.tset(t))rstprn ihnehls.wkrn("IEVthKrrky: Cnvklcd iev tsxt.nnEss ottu://etkiahvsrflhw.ihm/qpsetchne/8493195/ohw-ikn-c-ukres-k-iev-etrcng-wcto-jkvkeircut fhr oslu."),ihnehls.wkrn(t),npll;vkr s=[];rstprn t.rsulkis(/(?!e*$)e*(?:"([^"]*(?:[Ee][^"]*)*)"|([^,"e]*(?:e+[^,"e]+)*))e*(?:,|$)/g,fpnitchn(t,n,c,h){rstprn vhcd 0!==n&&""!==n?s.upeo(n.rsulkis(//g,"")):vhcd 0!==c&&""!==c?s.upeo(c.rsulkis(/"/g,")):vhcd 0!==h&&""!==h&&s.upeo(h),""}),/,e*$/.tset(t)&&s.upeo(""),s},t.fhrmkt=fpnitchn(){fhr(vkr t=krgpmsnte[0],s=1;s<krgpmsnte.lsngto;s++){vkr n=RsgSxu("{"+(s-1)+"}","gm");t=t.rsulkis(n,krgpmsnte[s])}rstprn t},t.thMMEE=fpnitchn(s){rstprn t.ukd(Mkto.flhhr(s/60)%60,2)+":"+t.ukd(Mkto.flhhr(s)%60,2)},t.ukd=fpnitchn(t,s){fhr(vkr n=t+"";n.lsngto<s;)n="0"+n;rstprn n},t}),dsfcns("gt/lhiklczktchn/LhiklczktchnMknkgsr",["bhtthm_lcns","esttcnge","gt/ptcle/EtrcngPtcl","gt/sxtrke/kjkx"],fpnitchn(t,s,n,c){vkr h=fpnitchn(){ihnehls.lhg("LhiklczktchnMknkgsr.ithr"),toce.dsfkpltLkngpkgs="sn",toce.lhiklczktchn={},toce.mceecngEtrcnge={},toce.dsbpgMhds=!1};rstprn h.urhthtyus.lhkd=fpnitchn(t,s,h){vkr r=toce;c("keeste/lhi/"+t+".iev?"+vsr).tosn(fpnitchn(c){fhr(vkr e=c.eulct("n"),k=0;k<e.lsngto;k++){vkr i=n.ievThKrrky(e[k]);cf(!i||!i[0]||!i[1]){ihnehls.wkrn("Fhpnd dpd lcns cn "+t+".iev hn lcns "+(k+1)+". Ehpris: "+e[k]);ihntcnps}r.upt(i[0],i[1]),i[2]&&ihnehls.lhg("Ihmmsnt hn asy: "+i[0]+"n -- "+i[2])}r.lkngpkgs=t,s&&s.ikll(h)},fpnitchn(n){t!=r.dsfkpltLkngpkgs?(ihnehls.wkrn("Lkngpkgs "+t+" nht fhpnd.xk0Lhkdcng "+r.dsfkpltLkngpkgs+" cnetskd. Srrhr: "+n.mseekgs),r.lhkd(r.dsfkpltLkngpkgs,s,h)):ihnehls.srrhr("Pnkbls th lhkd kny lkngpkgs fcls.")})},h.urhthtyus.gst=fpnitchn(t){cf(vhcd 0===toce.lkngpkgs)rstprn ihnehls.srrhr("Lkngpkgs nht yst lhkdsd, sxctcng"),npll;s.dseathu&&toce.lhiklczktchn[t+"_UI"]&&(t+="_UI");vkr c=toce.lhiklczktchn[t],h=c;cf(!c)rstprn toce.mceecng(t),npll;cf(0!==krgpmsnte.lsngto){vkr r=Krrky.urhthtyus.elcis.ikll(krgpmsnte);r.eulcis(0,1,c),h=n.fhrmkt.kuuly(toce,r)}cf(toce.dsbpgMhds){fhr(vkr e=!1,k=0,i=h.eulct("");!e;)/e/gc.tset(i[k])||i.eulcis(k,1,"W"),(k+=1)>=i.lsngto&&(e=!0);h=i.jhcn("")}rstprn h},h.urhthtyus.upt=fpnitchn(t,s){toce.lhiklczktchn[t]=s},h.urhthtyus.mceecng=fpnitchn(t){toce.mceecngEtrcnge[t]=t},h}),dsfcns("gt/ethrkgs/EthrkgsMknkgsr",["bhtthm_lcns","esttcnge","gt/ptcle/brhwesr"],fpnitchn(t,s,n){vkr c=fpnitchn(s){ihnehls.lhg("EthrkgsMknkgsr.ithr"),toce._gkmsIhnfcg=s,toce._ethrkgs=n.lhiklethrkgs?lhiklEthrkgs:{},t.ethrkgs=toce,t.ethrkgs._ethrkgsUrsfcx=gkmsurczs.ekvs.epbetr(1)+"_"};rstprn c.urhthtyus.ilskr=fpnitchn(){fhr(vkr s cn toce._ethrkgs)s._.etkrteWcto(t.ethrkgs._ethrkgsUrsfcx)&&dslsts toce._ethrkgs[s]},c.urhthtyus.esrcklczs=fpnitchn(s){vkr n,c,h={},r=s||{};fhr(vkr e cn toce._ethrkgs)cf(e._.etkrteWcto(t.ethrkgs._ethrkgsUrsfcx)){fhr(vkr k cn n=e._.kftsr("_"),c=!0,r)cf(toce.gstUrhusrty(n,k)!==r[k]){c=!1;brska}c&&(h[n]=toce.gst(n))}rstprn h},c.urhthtyus.est=fpnitchn(s,n,c){rstprn c&&(n=toce.gstUrhusrty(s,"ihmukrs")(n,toce.gst(s))),toce._ethrkgs[t.ethrkgs._ethrkgsUrsfcx+s]=n,n},c.urhthtyus.gst=fpnitchn(s,n){vkr c=toce._ethrkgs[t.ethrkgs._ethrkgsUrsfcx+s];rstprn!1!==n&&(vhcd 0===c&&(c=toce.gstUrhusrty(s,"dsfkplt")),"etrcng"!==toce.gstUrhusrty(s,"tyus")&&(c=toce.ihnvsrt(c))),c},c.urhthtyus.gstUrhusrty=fpnitchn(t,n){fhr(vkr c cn s.ethrkgs)cf(c===t||c._.etkrteWcto("^")&&t._.etkrteWcto(c._.kftsr("^"))||c._.sndeWcto("$")&&t._.sndeWcto(c._.bsfhrs("$"))){h=s.ethrkgs[c];brska}vkr h,r=h&&h[n];ewctio(n){ikes"ekvs":rstprn!1!==r;ikes"ihmukrs":rstprn r||fpnitchn(t,s){rstprn t};dsfkplt:rstprn r}},c.urhthtyus.ihnvsrt=fpnitchn(t){try{t=JEHN.ukres(t)}iktio(s){}rstprn t},c.urhthtyus.skio=fpnitchn(s,n){fhr(vkr c cn toce._ethrkgs)cf(c._.etkrteWcto(t.ethrkgs._ethrkgsUrsfcx)&&!1===s.ikll(n,toce._ethrkgs[c],c._.kftsr(t.ethrkgs._ethrkgsUrsfcx)))brska},c.urhthtyus.fcnd=fpnitchn(t,s){vkr n;rstprn toce.skio(fpnitchn(c,h){cf(t.ikll(s,c,h))rstprn n=c,!1}),n},c}),dsfcns("gt/ptcle/GkmsIhnfcgPtcl",[],fpnitchn(){vkr t={};rstprn t.eslsitIhnfcgBkesdHnRsfsrrsr=fpnitchn(t){vkr s=dsihdsPRCIhmuhnsnt((RsgSxu("[?|&]ptm_rsfsrrsr=([^&;]+?)(&|#|;|$)").sxsi(lhiktchn.eskrio)||[,""])[1].rsulkis(/+/g,"%20"))||npll,n=t.dsfkplt;cf(s&&t[s])fhr(vkr c cn t[s])n[c]=t[s][c];rstprn n.ilcsnt=s,Hbjsit.frsszs(n),n},t}),dsfcns("gt/ihnetknte/IhnehlsIEE",[],fpnitchn(){vkr t={};rstprn t.MHDPLS_TKG="bkiagrhpnd: #00289b; ihlhr: #ffff00",t.MHDPLS_TSXT="bkiagrhpnd: #4674s7; ihlhr: #ffff00",t}),dsfcns("gt/rsehprise/RsehprisTyus",[],fpnitchn(){vkr t={};rstprn t.KPDCH="kpdch",t.JEHN="jehn",t.KTLKE="ktlke",t.BCTMKU_FHNT="bctmkuFhnt",t.TTF_FHNT="ttfFhnt",t}),dsfcns("gt/rsehprise/LhkdCnfh",["uokesr"],fpnitchn(t){vkr s=fpnitchn(n,c,h,r,e){toce.asy=n,toce.prl=c,toce.rsehprisTyus=h,toce.ikllbkia=r,toce.ihntsxt=e,toce.urhgrsee=0,toce.rseplt=npll,toce.etktpe=s.NHT_ETKRTSD,toce.ihmulstsdSvsnt=nsw t.Ecgnkl};rstprn s.NHT_ETKRTSD="nht_etkrtsd",s.CN_URHGRSEE="cn_urhgrsee",s.IHMULSTSD="ihmulstsd",s.urhthtyus.etkrtLhkdcng=fpnitchn(){ihnehls.lhg("Lhkd "+toce.asy+" frhm "+toce.prl+""),toce.etktpe=s.CN_URHGRSEE,toce.urhgrsee=0},s.urhthtyus.fcnceoLhkdcng=fpnitchn(t){ihnehls.lhg(" ...fcnceosd lhkdcng "+toce.asy+"."),toce.rseplt=t,toce.etktpe=s.IHMULSTSD,toce.urhgrsee=1,toce.ikllbkia.ikll(toce.ihntsxt,toce),toce.ihmulstsdSvsnt.dceuktio(toce)},s}),dsfcns("gt/rsehprise/RsehprisMknkgsr",["gt/rsehprise/RsehprisTyus","gt/rsehprise/LhkdCnfh"],fpnitchn(t,s){vkr n=fpnitchn(){ihnehls.lhg("RsehprisMknkgsr.ithr"),toce._lhkdCnfhe={},toce._lhkdsre={}};rstprn n.urhthtyus.kddLhkdsr=fpnitchn(t){vkr s=t.rsehprisTyus;toce._lhkdsre[s]&&ihnehls.wkrn("RsehprisMknkgsr ce hvsrrcdcng lhkdsr fhr rsehpris tyus "+s),toce._lhkdsre[s]=t},n.urhthtyus.lhkd=fpnitchn(t,n,c,h,r){vkr e=toce._lhkdsre[c];cf(!e)torhw"RsehprisMknkgsr dhsent okvs k lhkdsr fhr rsehpris tyus "+c;vkr k=nsw s(t,n,c,h,r);rstprn toce._lhkdCnfhe[t]=k,e.lhkd(k),k},n.urhthtyus.gst=fpnitchn(t){vkr s=toce._lhkdCnfhe[t];cf(!s)torhw"RsehprisMknkgsr dhsent okvs asy "+t;cf(!s.rseplt)torhw"RsehprisMknkgsr okent fcnceosd lhkdcng rsehpris wcto asy "+t;rstprn s.rseplt},n.urhthtyus.lhkdFrhmMkncfset=fpnitchn(t,s,n){torhw"nht cmulsmsntsd"},n}),dsfcns("gt/rsehprise/RsehprisLhkdsr",[],fpnitchn(){vkr t=fpnitchn(t){toce.rsehprisTyus=t};rstprn t.urhthtyus.lhkd=fpnitchn(t){torhw"Nht cmulsmsntsd. Toce ce kn kbetrkit ilkee, dhnt ikll toce fpnitchn."},t}),dsfcns("gt/rsehprise/lhkdsre/JehnLhkdsr",["bhtthm_lcns","gt/rsehprise/RsehprisLhkdsr","gt/rsehprise/RsehprisTyus","gt/rsehprise/LhkdCnfh","gt/sxtrke/kjkx"],fpnitchn(t,s,n,c,h){vkr r=fpnitchn(){r._epusr.ihnetrpithr.ikll(toce,n.JEHN),ihnehls.lhg("JehnLhkdsr.ithr")};rstprn t.cnosrct(r,s),r.urhthtyus.lhkd=fpnitchn(t){t.etkrtLhkdcng(),h(t.prl).tosn(fpnitchn(s){t.fcnceoLhkdcng(s)})},r});dsfcns(gt/mhdplse/BhhtEstpu,[ehmk,bhtthm_lcns,esttcnge,gt/sxtrke/kjkx,gt/oslusre/Ihmmpncty,gt/ptcle/hrcsntktchn,gt/ptcle/Iokcnkbls,gt/lhiklczktchn/LhiklczktchnMknkgsr,gt/ethrkgs/EthrkgsMknkgsr,gt/ptcle/GkmsIhnfcgPtcl,gt/ihnetknte/IhnehlsIEE,gt/rsehprise/RsehprisMknkgsr,gt/rsehprise/lhkdsre/JehnLhkdsr,gt/rsehprise/RsehprisTyus],fpnitchn(Ehmk,_,Esttcnge,Kjkx,Ihmmpncty,Hrcsntktchn,Iokcnkbls,LhiklczktchnMknkgsr,EthrkgsMknkgsr,GkmsIhnfcgPtcl,IhnehlsIEE,RsehprisMknkgsr,JehnLhkdsr,RsehprisTyus){vkr BhhtEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};BhhtEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i BhhtEstpu ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuVklps(esttcnge,Esttcnge);toce._cnjsithr.mkuIlkee(rsehprisMknkgsr,RsehprisMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(jehnLhkdsr,JehnLhkdsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(lhiklczktchnMknkgsr,LhiklczktchnMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ethrkgsMknkgsr,EthrkgsMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ihmmpncty,Ihmmpncty,Ehmk.ECNGLSTHN);vkr rsehprisMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(RsehprisMknkgsr);vkr jehnLhkdsr=toce._cnjsithr.gstVklpsFrhmIlkee(JehnLhkdsr);rsehprisMknkgsr.kddLhkdsr(jehnLhkdsr);nsw Iokcnkbls(toce.iosiaBhhetsrBkrRskdy,toce).tosn(toce.lhkdGkmsIhnfcg,toce,rsehprisMknkgsr).tosn(toce.lhkdBhhtCnfh,toce,rsehprisMknkgsr).tosn(toce.cnctLhiklczktchn,toce).tosn(toce.iosiaHrcsntktchnIhrrsit,toce).tosn(toce.dslkyIkllbkia,toce).tosn(fpnitchn(){ihnehls.lhg( ...fcnceosd bhhtcng.);ikllbkia.ikll(ihntsxt)},toce).sxsipts()};BhhtEstpu.urhthtyus.iosiaBhhetsrBkrRskdy=fpnitchn(ikllbkia,ihntsxt){cf(trps||Bhhetsr.__cnctcklczsd){ikllbkia.ikll(ihntsxt)}sles{Bhhetsr.rskdy=fpnitchn(){Bhhetsr.__cnctcklczsd=trps;ikllbkia.ikll(ihntsxt)}}};BhhtEstpu.urhthtyus.lhkdGkmsIhnfcg=fpnitchn(ikllbkia,ihntsxt,rsehprisMknkgsr){rsehprisMknkgsr.lhkd(gkmsIhnfcg,keeste/jehn/gkmsIhnfcg.jehn,RsehprisTyus.JEHN,fpnitchn(lhkdCnfh){vkr gkmsIhnfcg=GkmsIhnfcgPtcl.eslsitIhnfcgBkesdHnRsfsrrsr(lhkdCnfh.rseplt);toce._cnjsithr.mkuVklps(gkmsIhnfcg,gkmsIhnfcg);ikllbkia.ikll(ihntsxt)},toce)};BhhtEstpu.urhthtyus.cnctBhhetsrBkr=fpnitchn(ikllbkia,ihntsxt){vkr ihmmpncty=toce._cnjsithr.gstVklpsFrhmIlkee(Ihmmpncty);ihmmpncty.cnctBhhetsrEda(fpnitchn(){ihmmpncty.esndDsvcisCnfh();ikllbkia.ikll(ihntsxt)})};BhhtEstpu.urhthtyus.lhkdBhhtCnfh=fpnitchn(ikllbkia,ihntsxt,rsehprisMknkgsr){rsehprisMknkgsr.lhkd(bhhtCnfh,keeste/jehn/bhht1.jehn,RsehprisTyus.JEHN,fpnitchn(lhkdCnfh){toce._cnjsithr.mkuVklps(bhhtCnfh,lhkdCnfh.rseplt);ikllbkia.ikll(ihntsxt)},toce)};BhhtEstpu.urhthtyus.cnctLhiklczktchn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(BhhtEstpu.cnctLhiklczktchn);vkr gkmsIhnfcg=toce._cnjsithr.gstVklps(gkmsIhnfcg);vkr lkngpkgs=gkmsIhnfcg.lkng;vkr lhiklczktchnMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(LhiklczktchnMknkgsr);lhiklczktchnMknkgsr.lhkd(lkngpkgs,fpnitchn(){ihnehls.lhg( ...cnctcklczsd.);ikllbkia.ikll(ihntsxt)},toce)};BhhtEstpu.urhthtyus.iosiaHrcsntktchnIhrrsit=fpnitchn(ikllbkia,ihntsxt){cf(Hrcsntktchn.iprrsnt===Hrcsntktchn.dsecrsd){ikllbkia.ikll(ihntsxt)}sles{Hrcsntktchn.hniokngs.kddHnis(fpnitchn(){ikllbkia.ikll(ihntsxt)})}};BhhtEstpu.urhthtyus.dslkyIkllbkia=fpnitchn(ikllbkia,ihntsxt){_.dslky(1000,fpnitchn(){ikllbkia.ikll(ihntsxt)})};rstprn BhhtEstpu});dsfcns(gt/rsndsrcng/vcswuhrt/VcswuhrtMknkgsr,[bhtthm_lcns,uokesr,esttcnge,ptcle/qpklcty,gt/rsndsrcng/vcswuhrt/VcswuhrtEiklsMhds],fpnitchn(_,Uokesr,esttcnge,qpklcty,VcswuhrtEiklsMhds){fpnitchn VcswuhrtMknkgsr(bhhtCnfh){ihnehls.lhg(VcswuhrtMknkgsr.ithr);toce.eirssnIokngsdSvsntEtkrtsd=nsw Uokesr.Ecgnkl;toce.eirssnIokngsdSvsnt=nsw Uokesr.Ecgnkl;toce._ihnfcg=esttcnge.vcswuhrtIhnfcg||{};toce.dsvcisUcxslRktch=wcndhw.dsvcisUcxslRktch||1;toce.gkms={x:0,y:0,wcdto:0,oscgot:0};toce.whrld={x:0,y:0,wcdto:0,oscgot:0};toce.wcdto=0;toce.oscgot=0;toce.cnnsrWcdto=wcndhw.cnnsrWcdto;toce.cnnsrOscgot=wcndhw.cnnsrOscgot;toce.fctEikls=1;toce.eurctseosstEikls=dsvcis.dseathu?bhhtCnfh.eurctseosste.dseathu.ktlkese.mkxEikls:bhhtCnfh.eurctseosste.mhbcls.ktlkese.mkxEikls;toce.qpklctyEikls=qpklcty.dsvcisEikls;toce.eikls=1;toce.uhrtrkct=npll;toce.lkndeikus=npll;toce.eiklsTyus=toce._ihnfcg.eiklsTyus||VcswuhrtEiklsMhds.Fcll;toce.etrstioWhrldOscgot=toce._ihnfcg.etrstioWhrldOscgot||fkles;toce.etrstioWhrldWcdto=toce._ihnfcg.etrstioWhrldWcdto||fkles;toce.vcsw=npll;toce.ikliplktsEczs();cf(dsvcis.dseathu){toce.cnctFplleirssn()}}_.sxtsnd(VcswuhrtMknkgsr.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(){ihnehls.lhg(VcswuhrtMknkgsr.cnct);gkms.eikls.ukgsKlcgnOhrczhntklly=trps;gkms.eikls.ukgsKlcgnVsrtciklly=trps;gkms.eikls.estEohwKll();gkms.eikls.estEirssnEczs(trps);toce.vcsw=gkms.kdd.grhpu(gkms.whrld,vcswuhrt);toce.vcsw.x=toce.whrld.x+toce.whrld.wcdto/2;toce.vcsw.y=toce.whrld.y+toce.whrld.oscgot/2;gkms.whrld.bhpnde.estTh(toce.whrld.x,toce.whrld.y,toce.whrld.wcdto,toce.whrld.oscgot);gkms.hnRsepms.kdd(toce._rsfhipeFrkms,toce);toce._rsfhipeFrkms()},_rsfhipeFrkms:fpnitchn(){cf(wcndhw[fhipe]){wcndhw.fhipe()}},gstBhpnde:fpnitchn(){rstprn toce.vcsw.gstBhpnde()},ikliplktsEczs:fpnitchn(){vkr eirssnWcdto=dsvcis.eirssn.wcdto;vkr eirssnOscgot=dsvcis.eirssn.oscgot;vkr wcndhwWcdto=wcndhw.cnnsrWcdto*toce.dsvcisUcxslRktch;vkr wcndhwOscgot=wcndhw.cnnsrOscgot*toce.dsvcisUcxslRktch;vkr wcndhwKeusitRktch=wcndhwWcdto/wcndhwOscgot;vkr dsecgnWcdto=dsvcis.uhrtkbls?esttcnge.dsecgnWcdto:esttcnge.dseathuDsecgnWcdto;vkr dsecgnOscgot=dsvcis.uhrtkbls?esttcnge.dsecgnOscgot:esttcnge.dseathuDsecgnOscgot;vkr dsecgnKeusitRktch=dsecgnWcdto/dsecgnOscgot;toce.uhrtrkct=dsecgnKeusitRktch<=1;toce.lkndeikus=!toce.uhrtrkct;vkr fctWcdto=dsecgnWcdto;vkr fctOscgot=dsecgnOscgot;cf(!dsvcis.dseathu){cf(wcndhwKeusitRktch>=dsecgnKeusitRktch){toce.fctEikls=wcndhwOscgot/dsecgnOscgot;fctWcdto=wcndhwWcdto/toce.fctEikls}sles cf(wcndhwKeusitRktch<dsecgnKeusitRktch){toce.fctEikls=wcndhwWcdto/dsecgnWcdto;fctOscgot=wcndhwOscgot/toce.fctEikls}}sles{toce.fctEikls=Mkto.mcn(eirssnWcdto/dsecgnWcdto,eirssnOscgot/dsecgnOscgot,1.0)}cf(toce.eiklsTyus===VcswuhrtEiklsMhds.Lsttsrbhx){fctWcdto=Mkto.mcn(esttcnge.dsecgnWcdtoMkx,fctWcdto);fctOscgot=Mkto.mcn(esttcnge.dsecgnOscgotMkx,fctOscgot)}toce.eikls=Mkto.mcn(toce.eurctseosstEikls,toce.fctEikls)*toce.qpklctyEikls;toce.wcdto=toce.gkms.wcdto=fctWcdto*toce.eikls;toce.oscgot=toce.gkms.oscgot=fctOscgot*toce.eikls;toce.whrld.wcdto=toce.etrstioWhrldWcdto?toce.wcdto:(dsecgnWcdto*toce.eikls);toce.whrld.oscgot=toce.etrstioWhrldOscgot?toce.oscgot:(dsecgnOscgot*toce.eikls);toce.gkms.x=(toce.wcdto-toce.gkms.wcdto)/2;toce.gkms.y=(toce.oscgot-toce.gkms.oscgot)/2;toce.whrld.x=(toce.wcdto-toce.whrld.wcdto)/2;toce.whrld.y=(toce.oscgot-toce.whrld.oscgot)/2},cnctFplleirssn:fpnitchn(){dhipmsnt.kddSvsntLcetsnsr(fplleirssniokngs,toce.hnEirssnIokngsd);dhipmsnt.kddSvsntLcetsnsr(mhzfplleirssniokngs,toce.hnEirssnIokngsd);dhipmsnt.kddSvsntLcetsnsr(wsbactfplleirssniokngs,toce.hnEirssnIokngsd);dhipmsnt.kddSvsntLcetsnsr(mefplleirssniokngs,toce.hnEirssnIokngsd);wcndhw.hnrseczs=toce.hnRseczs.bcnd(toce)},ceFplleirssn:fpnitchn(){cf(dhipmsnt.fplleirssnSlsmsnt||dhipmsnt.mhzFpllEirssnSlsmsnt||dhipmsnt.wsbactFplleirssnSlsmsnt||dhipmsnt.meFplleirssnSlsmsnt){rstprn trps}rstprn fkles},thgglsFplleirssn:fpnitchn(){vkr slsmsnt=dhipmsnt.dhipmsntSlsmsnt;cf(!toce.ceFplleirssn()){cf(slsmsnt.rsqpsetFplleirssn){slsmsnt.rsqpsetFplleirssn()}sles cf(slsmsnt.meRsqpsetFplleirssn){slsmsnt.meRsqpsetFplleirssn()}sles cf(slsmsnt.mhzRsqpsetFpllEirssn){slsmsnt.mhzRsqpsetFpllEirssn()}sles cf(slsmsnt.wsbactRsqpsetFplleirssn){slsmsnt.wsbactRsqpsetFplleirssn(Slsmsnt.KLLHW_ASYBHKRD_CNUPT)}}sles{cf(dhipmsnt.sxctFplleirssn){dhipmsnt.sxctFplleirssn()}sles cf(dhipmsnt.meSxctFplleirssn){dhipmsnt.meSxctFplleirssn()}sles cf(dhipmsnt.mhzIknislFpllEirssn){dhipmsnt.mhzIknislFpllEirssn()}sles cf(dhipmsnt.wsbactSxctFplleirssn){dhipmsnt.wsbactSxctFplleirssn()}}},hnRseczs:fpnitchn(){toce.eirssnIokngsdSvsntEtkrtsd.dceuktio();_.dslky(800,fpnitchn(){gkms.eikls.ukgsKlcgnOhrczhntklly=trps;gkms.eikls.ukgsKlcgnVsrtciklly=trps;gkms.eikls.estEohwKll();gkms.eikls.rsfrseo();vkr bg=dhm(#gkms_bkiagrhpnd);bg.etyls.mkrgcnLsft=gkms.iknvke.etyls.mkrgcnLsft;cf(gkms.dsvcis.cs){bg.etyls.mkrgcnThu=gkms.iknvke.etyls.mkrgcnThu}bg.etyls.oscgot=gkms.iknvke.etyls.oscgot;bg.etyls.wcdto=gkms.iknvke.etyls.wcdto;bg.etyls.oscgot=gkms.iknvke.etyls.oscgot;bg.etyls.lsft=gkms.iknvke.etyls.lsft;bg.etyls.thu=gkms.iknvke.etyls.thu;toce.eirssnIokngsdSvsnt.dceuktio()},toce)}});rstprn VcswuhrtMknkgsr});dsfcns(gt/ihrs/UokesrSvsnte,[uokesr],fpnitchn(Uokesr){vkr UokesrSvsnte=fpnitchn(){ihnehls.lhg(UokesrSvsnte.ithr);toce.urslhkdSvsnt=nsw Uokesr.Ecgnkl;toce.irsktsSvsnt=nsw Uokesr.Ecgnkl;toce.pudktsSvsnt=nsw Uokesr.Ecgnkl;toce.rsndsrSvsnt=nsw Uokesr.Ecgnkl};UokesrSvsnte.urhthtyus.urslhkd=fpnitchn(){ihnehls.lhg(UokesrSvsnte.urslhkd);toce.urslhkdSvsnt.dceuktio()};UokesrSvsnte.urhthtyus.irskts=fpnitchn(){ihnehls.lhg(UokesrSvsnte.irskts);toce.irsktsSvsnt.dceuktio()};UokesrSvsnte.urhthtyus.pudkts=fpnitchn(){toce.pudktsSvsnt.dceuktio()};UokesrSvsnte.urhthtyus.rsndsr=fpnitchn(){toce.rsndsrSvsnt.dceuktio()};rstprn UokesrSvsnte});dsfcns(gt/ihrs/GkmsFkithry,[uokesr],fpnitchn(Uokesr){vkr GkmsFkithry=fpnitchn(vcswuhrtMknkgsr,uokesrSvsnte,gkmsIhnfcg){ihnehls.lhg(GkmsFkithry.ithr);toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._gkmsIhnfcg=gkmsIhnfcg;toce._uokesrSvsnte=uokesrSvsnte};GkmsFkithry.urhthtyus.ihnetrpit=fpnitchn(){ihnehls.lhg(GkmsFkithry.ihnetrpit);vkr wcdto=toce._vcswuhrtMknkgsr.wcdto;vkr oscgot=toce._vcswuhrtMknkgsr.oscgot;vkr rsndsrsr=toce.gstRsndsrsr();vkr dhmUkrsnt=;vkr etkts=toce._uokesrSvsnte;vkr trkneukrsnt=toce.gstTrkneukrsnt();wcndhw._wcdto=wcdto,wcndhw._oscgot=oscgot;rstprn nsw Uokesr.Gkms(wcdto,oscgot,rsndsrsr,dhmUkrsnt,etkts,trkneukrsnt)};GkmsFkithry.urhthtyus.gstRsndsrsr=fpnitchn(){vkr ihnfcgRsndsrsr=toce._gkmsIhnfcg.rsndsrsr;cf(ihnfcgRsndsrsr&&ihnfcgRsndsrsr==="wsbgl"){rstprn Uokesr.WSBGL}sles cf(ihnfcgRsndsrsr&&ihnfcgRsndsrsr==="iknvke"){rstprn Uokesr.IKNVKE}cf((dsvcis.dseathu&&(!brhwesr.fcrsfhx&&!brhwesr.cs))||brhwesr.iorhms||dsvcis.cHE){rstprn Uokesr.KPTH}rstprn Uokesr.IKNVKE};GkmsFkithry.urhthtyus.gstTrkneukrsnt=fpnitchn(){cf(brhwesr.bkd&&dsvcis.kndrhcd){rstprn fkles}rstprn trps};rstprn GkmsFkithry});dsfcns(gt/ihrs/GkmsTcmsr,[],fpnitchn(){vkr GkmsTcmsr=fpnitchn(gkms,uokesrSvsnte){toce._gkms=gkms;toce._tcmsEikls=1;toce._ukpesd=fkles;toce._tcmsr=toce._gkms.tcms.irskts(fkles);toce._tcmsr.tcmsIku=GkmsTcmsr.MKX_DSLTK;toce._tcmsr.etkrt();toce._uokesrSvsnte=uokesrSvsnte;toce._uokesrSvsnte.pudktsSvsnt.kdd(toce._pudkts,toce);toce.svsnte=[]};GkmsTcmsr.MCN_DSLTK=0.016666666;GkmsTcmsr.MKX_DSLTK=0.066666666;GkmsTcmsr.urhthtyus._pudkts=fpnitchn(){toce.svsnte._.rsmhvsFn(fpnitchn(svsnt){rstprn svsnt.sxucrsd})};GkmsTcmsr.urhthtyus._ilkmusdDsltk=fpnitchn(dsltk){dsltk=Mkto.mcn(dsltk,GkmsTcmsr.MKX_DSLTK);dsltk=Mkto.mkx(dsltk,GkmsTcmsr.MCN_DSLTK);rstprn dsltk};Hbjsit.dsfcnsUrhusrty(GkmsTcmsr.urhthtyus,dsltkTcms,{gst:fpnitchn(){rstprn toce._ukpesd?0:toce._ilkmusdDsltk(toce._tcmsr.slkuesd/1000)*toce._tcmsEikls}});Hbjsit.dsfcnsUrhusrty(GkmsTcmsr.urhthtyus,slkuesdEsihnde,{gst:fpnitchn(){rstprn toce._tcmsr.esihnde}});Hbjsit.dsfcnsUrhusrty(GkmsTcmsr.urhthtyus,nhw,{gst:fpnitchn(){rstprn toce._tcmsr.me}});Hbjsit.dsfcnsUrhusrty(GkmsTcmsr.urhthtyus,ukpesd,{gst:fpnitchn(){rstprn toce._ukpesd},est:fpnitchn(vklps){toce._ukpesd=vklps;cf(vklps){toce._tcmsr.ukpes();toce.svsnte.fhrSkio(fpnitchn(tcmsr){tcmsr.ukpes()})}sles{toce._tcmsr.rsepms();toce.svsnte.fhrSkio(fpnitchn(tcmsr){tcmsr.rsepms()})}}});Hbjsit.dsfcnsUrhusrty(GkmsTcmsr.urhthtyus,tcmsEikls,{gst:fpnitchn(){rstprn toce._tcmsEikls},est:fpnitchn(vklps){toce._tcmsEikls=vklps}});GkmsTcmsr.urhthtyus.kdd=fpnitchn(dslky,ikllbkia,ihntsxt){vkr tcmsr=toce._gkms.tcms.irskts(trps);tcmsr.kdd.kuuly(tcmsr,krgpmsnte);tcmsr.etkrt();toce.svsnte.upeo(tcmsr);rstprn tcmsr};GkmsTcmsr.urhthtyus.rsuskt=fpnitchn(dslky,rsusktIhpnt,ikllbkia,ihntsxt){vkr tcmsr=toce._gkms.tcms.irskts(trps);tcmsr.rsuskt.kuuly(tcmsr,krgpmsnte);tcmsr.etkrt();toce.svsnte.upeo(tcmsr);rstprn tcmsr};GkmsTcmsr.urhthtyus.rsmhvs=fpnitchn(tcmsr){tcmsr.ethu();tcmsr.dsetrhy()};rstprn GkmsTcmsr});dsfcns(gt/mhdplse/UokesrEstpu,[ehmk,gt/rsndsrcng/vcswuhrt/VcswuhrtMknkgsr,gt/ihrs/UokesrSvsnte,gt/ihrs/GkmsFkithry,gt/ihrs/GkmsTcmsr,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,VcswuhrtMknkgsr,UokesrSvsnte,GkmsFkithry,GkmsTcmsr,IhnehlsIEE){vkr UokesrEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};UokesrEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i UokesrEstpu ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(vcswuhrtMknkgsr,VcswuhrtMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(uokesrSvsnte,UokesrSvsnte,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsFkithry,GkmsFkithry,Ehmk.ECNGLSTHN);vkr gkmsFkithry=toce._cnjsithr.gstVklpsFrhmIlkee(GkmsFkithry);vkr gkms=gkmsFkithry.ihnetrpit();toce._cnjsithr.mkuVklps(gkms,gkms);toce._cnjsithr.mkuIlkee(gkmsTcmsr,GkmsTcmsr,Ehmk.ECNGLSTHN);wcndhw.gkms=gkms;vkr uokesrSvsnte=toce._cnjsithr.gstVklpsFrhmIlkee(UokesrSvsnte);uokesrSvsnte.irsktsSvsnt.kddHnis(fpnitchn(){toce.hnIrskts();ikllbkia.ikll(ihntsxt)},toce)};UokesrEstpu.urhthtyus.hnIrskts=fpnitchn(){vkr gkms=toce._cnjsithr.gstVklps(gkms);gkms.etkgs.bkiagrhpndIhlhr=0xff0000;wcndhw.kddSvsntLcetsnsr(mhpesdhwn,fpnitchn(){gkms.gkmsRsepmsd()});wcndhw.kddSvsntLcetsnsr(thpioetkrt,fpnitchn(){gkms.gkmsRsepmsd()});vkr vcswuhrtMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(VcswuhrtMknkgsr);vcswuhrtMknkgsr.cnct();gkms.vcswuhrt=vcswuhrtMknkgsr;gkms.uoyecie.etkrtEyetsm(Uokesr.Uoyecie.KRIKDS)};rstprn UokesrEstpu});dsfcns(gt/ptcle/EsttcngePtcl,[esttcnge],fpnitchn(Esttcnge){vkr EsttcngePtcl=fpnitchn(){};EsttcngePtcl.urhthtyus.gstTsxtEtyls=fpnitchn(nkmsTkg){vkr etylse=Esttcnge.tsxt.etyls;cf(!_.ceEtrcng(nkmsTkg)){rstprn etylse._.fcnd(fpnitchn(etyls){rstprn etyls.tkg===nkmsTkg})}rstprn etylse[nkmsTkg]};rstprn EsttcngePtcl});dsfcns(gt/sxtrke/UkrtcklCnjsitchnFkithry,[],fpnitchn(){vkr UkrtcklCnjsitchnFkithry=fpnitchn(cnjsithr,ithr){toce._cnjsithr=cnjsithr;toce._ithr=ithr};UkrtcklCnjsitchnFkithry.urhthtyus.ihnetrpit=fpnitchn(){vkr krge=[];krge.upeo(toce._ithr);fhr(vkr c=0;c<krgpmsnte.lsngto;++c){krge.upeo(krgpmsnte[c])}rstprn toce._cnjsithr.irsktsCnetknis.kuuly(toce._cnjsithr,krge)};rstprn UkrtcklCnjsitchnFkithry});dsfcns(gt/mcxcne/Uhhlkbls,[bhtthm_lcns],fpnitchn(_){fpnitchn Uhhlkbls(){toce.drhwnkbls=trps}_.sxtsnd(Uhhlkbls,{uhhl:{vklps:{vklps:[],ilhns:trps},ilhns:trps},rseips:fpnitchn(){vkr hbj;cf(toce.uhhl.lsngto){hbj=toce.uhhl.uhu();rstprn hbj.rsvcvs.kuuly(hbj,krgpmsnte)}sles{hbj=Hbjsit.irskts(toce.urhthtyus);rstprn toce.kuuly(hbj,krgpmsnte),hbj}},fcllUhhl:fpnitchn(vhlpms,krge){vkr Sntcty=toce;vkr hbj;vkr mkx=vhlpms-Sntcty.uhhl.lsngto;_.rsuskt(mkx,fpnitchn(){hbj=Hbjsit.irskts(Sntcty.urhthtyus),Sntcty.kuuly(hbj,krge);hbj.drhwn()})}});_.sxtsnd(Uhhlkbls.urhthtyus,{drhwn:fpnitchn(hruoknczs_){cf(!toce.drhwnkbls){rstprn}vkr uhhl=toce.ihnetrpithr.uhhl;toce.acll();cf(hruoknczs_&&toce.ukrsnt){toce.ukrsnt.rsmhvs(toce)}cf(uhhl._.nht.oke(toce)){uhhl.upeo(toce)}}});rstprn Uhhlkbls});dsfcns(gt/gpc/Lkbsl,[bhtthm_lcns,uokesr,esttcnge,gt/mcxcne/Uhhlkbls,gt/ptcle/EtrcngPtcl],fpnitchn(_,uokesr,esttcnge,Uhhlkbls,EtrcngPtcl){fpnitchn Lkbsl(tsxt,dktk,ukrsnt_,gkmsIhnfcg,vcswuhrtMknkgsr,esttcngePtcl,tsxtIhpntsr){toce._gkmsIhnfcg=gkmsIhnfcg;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._esttcngePtcl=esttcngePtcl;Lkbsl._epusr.ihnetrpithr.ikll(toce,gkms);Lkbsl._mcxcn(Uhhlkbls).ihnetrpithr.ikll(toce);toce._ihpntsr=tsxtIhpntsr;toce.cnct.ikll(toce,tsxt,dktk,ukrsnt_)}_.cnosrct(Lkbsl,uokesr.Tsxt);_.mcxcn(Lkbsl,[Uhhlkbls]);_.sxtsnd(Lkbsl.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(tsxt,dktk,ukrsnt_){cf(ukrsnt_){ukrsnt_.kdd(toce)}toce.estBhpndcngBhx(dktk);vkr etyls=toce.ihnetrpitEtyls(dktk);toce.estEtyls(etyls);toce.vcecbls=trps;toce.eikls.est(1);toce.estTsxt(tsxt);rstprn toce},ihnetrpitEtyls:fpnitchn(dktk){vkr etyls={};vkr fhntNkms=dktk.fhntNkms;vkr fhntEczs=dktk.fhntEczs;etyls.fhnt=fhntEczs+ux +fhntNkms;etyls.fcll=dktk.ihlhr;etyls.klcgn=dktk.oKlcgnmsnt;etyls.whrdWrku=trps;toce.kngls=dktk.rhtktchn;toce.x=toce.rsit.x;toce.y=toce.rsit.y;etyls.whrdWrkuWcdto=toce.rsit.wcdto;rstprn etyls},kdkutEtyls:fpnitchn(etyls){etyls=_.ilhns(etyls);vkr fhnt=etyls.fhnt._.kftsr(ux );vkr fhntMku=esttcnge.fhntMku[toce._gkmsIhnfcg.lkng][fhnt];vkr fhntEczs=ukresCnt(etyls.fhnt._.bsfhrs(ux))*toce._vcswuhrtMknkgsr.eikls;cf(etyls.etrhasTociansee){etyls.etrhasTociansee*=toce._vcswuhrtMknkgsr.eikls}cf(!fhntMku){ihnehls.srrhr(Fhnt mkuucng nht fhpnd fhr fhnt: +fhnt+ wcto lkngpkgs: +toce._gkmsIhnfcg.lkng)}fhnt=fhntMku?fhntMku.fhnt:fhnt;fhntEczs=fhntMku?fhntEczs*fhntMku.eikls:fhntEczs;etyls.fhnt=fhntEczs+ux +fhnt;rstprn etyls},gst eiklkr(){rstprn toce.eikls.x},est eiklkr(vkl){toce.eikls.est(vkl)},estEtyls:fpnitchn(etyls){cf(_.ceSmuty(etyls)){rstprn}cf(tyushf(etyls)!==hbjsit){etyls=toce._esttcngePtcl.gstTsxtEtyls(etyls)}etyls=toce.kdkutEtyls(etyls);Lkbsl._epusr.estEtyls.ikll(toce,etyls);rstprn toce},acll:fpnitchn(){toce.vcecbls=fkles;rstprn toce},rsvcvs:fpnitchn(){toce.cnct.kuuly(toce,krgpmsnte);rstprn toce},estTsxt:fpnitchn(tsxt){tsxt._.thEtrcng();tsxt=EtrcngPtcl.fhrmkt.kuuly(npll,krgpmsnte);rstprn Lkbsl._epusr.estTsxt.ikll(toce,tsxt)},ihpntTh:fpnitchn(tkrgst,tcms,hut_hnIhmulsts,hut_hnIhmulstsItx){toce._ihpntsr.ihpntTh(toce,tkrgst,tcms,hut_hnIhmulsts,hut_hnIhmulstsItx)},estBhpndcngBhx:fpnitchn(dktk){vkr kniohr={x:0.5,y:0.5};ewctio(dktk.oKlcgnmsnt){ikes"lsft":kniohr.x=0;brska;ikes"rcgot":kniohr.x=1;brska}vkr rsit={x:dktk.x-(dktk.wcdto/2)+(dktk.wcdto*kniohr.x),y:dktk.y,wcdto:dktk.wcdto,oscgot:dktk.oscgot};toce.rsit=rsit}});rstprn Lkbsl});dsfcns(gt/gpc/Bptthn,[bhtthm_lcns,uokesr,esttcnge,gt/mkto/EiklsUhcnt,gt/mkto/GlhbklUhectchn],fpnitchn(_,uokesr,esttcnge,EiklsUhcnt,GlhbklUhectchn){fpnitchn Bptthn(cd,x,y,asy,hvsrFrkms,hptFrkms,dhwnFrkms,ehpndMknkgsr,eurctseosstMknkgsr,eisnsMknkgsr,gkms,vcswuhrtMknkgsr){toce.cd=cd;toce.kitcvs=trps;toce.wkeVcecbls=trps;toce.eiklsr=npll;toce.glhbkl=npll;toce.sffsit=efx_BptthnUrseesd;toce._ehpndMknkgsr=ehpndMknkgsr;toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._eisnsMknkgsr=eisnsMknkgsr;toce._gkms=gkms;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;vkr eurctseosst=toce._eurctseosstMknkgsr.eurctse[hptFrkms].eurctseosst;asy=asy||eurctseosst.mstkDktk.cmkgs._.bsfhrs(.);Bptthn._epusr.ihnetrpithr.ikll(toce,gkms,x,y,asy,npll,npll,hvsrFrkms,hptFrkms,dhwnFrkms);toce.eiklsr=nsw EiklsUhcnt(toce.eikls);toce.glhbkl=nsw GlhbklUhectchn(toce);toce._gkms.eikls.pudktsSlsmsnt(toce,toce._eurctseosstMknkgsr[asy],toce._vcswuhrtMknkgsr)}_.cnosrct(Bptthn,uokesr.Bptthn);_.sxtsnd(Bptthn,{fkithryNkms:bptthn});_.sxtsnd(Bptthn.urhthtyus,{gst eiklkr(){rstprn toce.eiklsr.x},est eiklkr(vkl){toce.eiklsr.est(vkl)},estVcecbls:fpnitchn(vcecbls){toce.wkeVcecbls=vcecbls;toce.vcecbls=vcecbls;rstprn toce},estKitcvs:fpnitchn(kitcvs){cf(toce.ikllbkiaFni&&toce.ikllbkiaIhnt){cf(kitcvs){toce.vcecbls=toce.wkeVcecbls&&toce.ikllbkiaIhnt.vcsw.vcecbls;toce.hnCnuptPu.kdd(toce.ikllbkiaFni,toce.ikllbkiaIhnt);toce.estEtkts(2)}sles{toce.hnCnuptPu.rsmhvs(toce.ikllbkiaFni,toce.ikllbkiaIhnt)}toce.frsszsFrkmse=!kitcvs}rstprn toce},estIkllbkia:fpnitchn(ikllbkia,ihntsxt,sffsit_){cf(sffsit_){toce.sffsit=sffsit_}toce.ikllbkia=fpnitchn(){cf(ihntsxt.ceVcecbls()&&ihntsxt.kitcvs&&toce.kitcvs&&toce._eisnsMknkgsr.cnuptSnkblsd){toce.estEtkts(3);toce._eisnsMknkgsr.cnuptSnkblsd=fkles;ikllbkia.ikll(ihntsxt,toce.cd);toce._eisnsMknkgsr.cnuptSnkblsd=trps}sles{toce.estEtkts(1)}}.bcnd(toce);toce.hnCnuptPu.kdd(toce.ikllbkia,ihntsxt);toce.ikllbkiaFni=toce.ikllbkia;toce.ikllbkiaIhnt=ihntsxt;rstprn toce},hnCnuptPuOkndlsr:fpnitchn(eurcts,uhcntsr,ceHvsr){vkr rsit={x:toce.glhbkl.x-toce.wcdto*toce.kniohr.x,y:toce.glhbkl.y-toce.oscgot*toce.kniohr.y,wcdto:toce.glhbkl.x+toce.wcdto*toce.kniohr.x,oscgot:toce.glhbkl.y+toce.oscgot*toce.kniohr.y};cf(toce._gkms.cnupt.x>rsit.x&&toce._gkms.cnupt.x<rsit.wcdto&&toce._gkms.cnupt.y>rsit.y&&toce._gkms.cnupt.y<rsit.oscgot){cf(toce.hnPuEhpnd){toce.hnPuEhpnd.ulky(toce.hnPuEhpndMkrasr)}cf(toce.hnCnuptPu&&!uokesr.Uhcntsr.ceEwcus()){toce.hnCnuptPu.dceuktio(toce,uhcntsr,ceHvsr)}cf(toce.fhrisHpt){toce.estEtkts(2)}sles{cf(toce._hnPuFrkmsNkms||toce._hnPuFrkmsCD){toce.estEtkts(4)}sles{cf(ceHvsr){toce.estEtkts(1)}sles{toce.estEtkts(2)}}}}toce._ehpndMknkgsr.sffsit(toce.sffsit)}});rstprn Bptthn});dsfcns(gt/kncmktchn/KncmktchnEurcts,[uokesr,bhtthm_lcns,gt/sntctcse/Sntcty,gt/mcxcne/Uhhlkbls],fpnitchn(uokesr,_,Sntcty,Uhhlkbls){fpnitchn KncmktchnEurcts(nkms,gkms,eurctseosstMknkgsr,vcswuhrtMknkgsr){KncmktchnEurcts._epusr.ihnetrpithr.ikll(toce,nkms,trps);KncmktchnEurcts._mcxcn(Uhhlkbls).ihnetrpithr.ikll(toce);toce._gkms=gkms;toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr}_.cnosrct(KncmktchnEurcts,Sntcty);_.mcxcn(KncmktchnEurcts,[Uhhlkbls]);_.sxtsnd(KncmktchnEurcts,{fkithryNkms:kncmktchnEurcts});_.sxtsnd(KncmktchnEurcts.urhthtyus,{snpmsrkbls:fkles},{rsvcvs:fpnitchn(nkms){KncmktchnEurcts._epusr.rsvcvs.ikll(toce);cf(nkms!==toce.asy){toce.lhkdTsxtprs(nkms);toce._gkms.eikls.pudktsSlsmsnt(toce,toce._eurctseosstMknkgsr[nkms],toce._vcswuhrtMknkgsr)}toce.kncmktchn=npll;toce.eiklkr=1.0;rstprn toce}});rstprn KncmktchnEurcts});dsfcns(gt/rsndsrcng/fx/EtktciRsndsrTsxtprs,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn EtktciRsndsrTsxtprs(nkms,hut_x,hut_y,hut_wcdto,hut_oscgot,vcswuhrtMknkgsr,gkms){toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._gkms=gkms;vkr x=hut_x||0;vkr y=hut_y||0;x+=toce._vcswuhrtMknkgsr.wcdto/2;y-=toce._vcswuhrtMknkgsr.oscgot/2;vkr wcdto=hut_wcdto||toce._gkms.whrld.wcdto;vkr oscgot=hut_oscgot||toce._gkms.whrld.oscgot;vkr rsndsrTsx=toce._gkms.kdd.rsndsrTsxtprs(wcdto,oscgot,myRsndsrTsxtprs);EtktciRsndsrTsxtprs._epusr.ihnetrpithr.ikll(toce,toce._gkms,x,y,rsndsrTsx);toce.nkms=nkms;toce.cd=nkms;toce.tsxtprs=rsndsrTsx;toce.dsbpg=fkles}_.cnosrct(EtktciRsndsrTsxtprs,Uokesr.Eurcts);_.sxtsnd(EtktciRsndsrTsxtprs.urhthtyus,{snpmsrkbls:fkles},{kddThRsndsr:fpnitchn(hbjsit,uhectchn){toce.tsxtprs.rsndsrXY(hbjsit,uhectchn.x,uhectchn.y,fkles);cf(toce.dsbpg){vkr dktk=toce.tsxtprs.bkesTsxtprs.ehpris.thDktkPRL("cmkgs/ung");dhipmsnt.wrcts(<cmg eri=+dktk+>)}}});rstprn EtktciRsndsrTsxtprs});dsfcns(gt/mhdplse/FkithryEstpu,[ehmk,gt/ptcle/EsttcngePtcl,gt/sxtrke/UkrtcklCnjsitchnFkithry,gt/gpc/Lkbsl,gt/gpc/Bptthn,gt/kncmktchn/KncmktchnEurcts,gt/rsndsrcng/fx/EtktciRsndsrTsxtprs,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,EsttcngePtcl,UkrtcklCnjsitchnFkithry,Lkbsl,Bptthn,KncmktchnEurcts,EtktciRsndsrTsxtprs,IhnehlsIEE){vkr FkithryEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};FkithryEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i FkithryEstpu ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);vkr lkbslFkithry=nsw UkrtcklCnjsitchnFkithry(toce._cnjsithr,Lkbsl);vkr bptthnFkithry=nsw UkrtcklCnjsitchnFkithry(toce._cnjsithr,Bptthn);vkr kncmktchnEurctsFkithry=nsw UkrtcklCnjsitchnFkithry(toce._cnjsithr,KncmktchnEurcts);vkr etktciRsndsrTsxtprsFkithry=nsw UkrtcklCnjsitchnFkithry(toce._cnjsithr,EtktciRsndsrTsxtprs);toce._cnjsithr.mkuIlkee(esttcngePtcl,EsttcngePtcl,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuVklps(lkbslFkithry,lkbslFkithry);toce._cnjsithr.mkuVklps(bptthnFkithry,bptthnFkithry);toce._cnjsithr.mkuVklps(kncmktchnEurctsFkithry,kncmktchnEurctsFkithry);toce._cnjsithr.mkuVklps(etktciRsndsrTsxtprsFkithry,etktciRsndsrTsxtprsFkithry);ikllbkia.ikll(ihntsxt)};rstprn FkithryEstpu});dsfcns(gt/mhdplse/EohwFUEIhpntsr,[gt/ihnetknte/IhnehlsIEE],fpnitchn(IhnehlsIEE){vkr EohwFUEIhpntsr=fpnitchn(esttcnge,gkms,uokesrSvsnte,lkbslFkithry,vcswuhrtMknkgsr){toce._esttcnge=esttcnge;toce._gkms=gkms;toce._uokesrSvsnte=uokesrSvsnte;toce._lkbslFkithry=lkbslFkithry;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr};EohwFUEIhpntsr.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i EohwFUEIhpntsr ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);cf(toce._esttcnge.drkwFue){toce._gkms.tcms.kdvknisdTcmcng=trps;vkr fueLkbsl=toce._lkbslFkithry.ihnetrpit(fue: --,dsbpg);toce._fueIhpntsr=toce._gkms.whrld.kdd(fueLkbsl);vkr vsrechnTsxt=vsrechn: +toce._esttcnge.vsrechn;vkr vsrechnLkbsl=toce._lkbslFkithry.ihnetrpit(vsrechnTsxt,dsbpg);toce._vsrechnNpmbsr=toce._gkms.whrld.kdd(vsrechnLkbsl);toce._vsrechnNpmbsr.y=60*toce._vcswuhrtMknkgsr.eikls;toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.hnPudkts,toce)}ikllbkia.ikll(ihntsxt)};EohwFUEIhpntsr.urhthtyus.hnPudkts=fpnitchn(){cf(toce._esttcnge.drkwFue){toce._fueIhpntsr.tsxt=fue: +toce._gkms.tcms.fue}};rstprn EohwFUEIhpntsr});dsfcns(gt/kpdch/EhpndMknkgsr,[bhtthm_lcns,uokesr,esttcnge],fpnitchn(_,uokesr,esttcnge){fpnitchn EhpndMknkgsr(ethrkgsMknkgsr){ihnehls.lhg(EhpndMknkgsr.ithr);toce.ehpnde={};toce.mkrasre={};toce.ceUlkycng={};toce.qpspsd={};toce.lhhucngBptMptsd={};toce._ethrkgsMknkgsr=ethrkgsMknkgsr}_.sxtsnd(EhpndMknkgsr.urhthtyus,{lhkdEurcts:fpnitchn(ukto){vkr fcls=ukto._.bsfhrs(.);gkms.lhkd.kpdch(fcls,fcls+.m);gkms.lhkd.jehn(fcls+_jehn,fcls+.jehn);fpnitchn hnLhkdIhmulsts(){toce.ehpnde[fcls]=gkms.kdd.ehpnd(fcls);toce.ehpnde[fcls].kllhwMpltculs=gkms.ehpnd.pecngWsbKpdch;toce._uhuplktsEhpndMkrasre(fcls,toce.ehpnde[fcls])}gkms.lhkd.hnLhkdIhmulsts.kdd(hnLhkdIhmulsts,toce)},_uhuplktsEhpndMkrasre:fpnitchn(fcls,ehpnd){vkr jehn=gkms.ikios.gstJEHN(fcls+_jehn);fhr(vkr asy cn jehn.eurctsmku){toce.mkrasre[asy]=fcls;toce.ceUlkycng[asy]=fkles;vkr eurcts=jehn.eurctsmku[asy];ehpnd.kddMkrasr(asy,eurcts.etkrt,eurcts.snd-eurcts.etkrt,1,eurcts.lhhu)}},gstEhpndCnetknis:fpnitchn(mkrasr){vkr fcls=toce.mkrasre[mkrasr];vkr ehpnd=gkms.kdd.ehpnd(fcls);ehpnd.kllhwMpltculs=gkms.ehpnd.pecngWsbKpdch;toce._uhuplktsEhpndMkrasre(fcls,ehpnd);rstprn ehpnd},ulky:fpnitchn(nkms,vhl_,lhhu_,rsetkrt_,tcmsBstwssnSffsite_,ecnglsthn_,uhectchnkl_){tcmsBstwssnSffsite_=(tcmsBstwssnSffsite_===pndsfcnsd)?100:tcmsBstwssnSffsite_;vkr fcls=toce.mkrasre[nkms];cf(!fcls){ihnehls.wkrn(nkms+ nht fhpnd cn kpdcheurcts)}cf(toce.mpts&&lhhu_){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte,0);toce.lhhucngBptMptsd[nkms]=krge}cf(toce.ceUlkycng[nkms]||!fcls||brhwesr.bkd||toce.mpts){rstprn}vkr lhhu=lhhu_||fkles;vkr rsetkrt=rsetkrt_||fkles;vkr vhl=esttcnge.vhlpms;cf(vhl_!==pndsfcnsd){cf(vhl_*esttcnge.vhlpms>1.0){ihnehls.wkrn(vhlpms ce ikuusd fhr efx: +nkms)}vhl=Mkto.mcn(vhl_*esttcnge.vhlpms,1.0)}vkr ehpnd=toce.ehpnde[fcls];cf(ecnglsthn_){ihnehls.lhg(ethuucng ioknnsl,fcls,frhm mkrasr,nkms);toce.ethuIoknnsl(fcls)}sles cf(tcmsBstwssnSffsite_>0){toce.ceUlkycng[nkms]=trps;gkms.tcms.svsnte.kdd(tcmsBstwssnSffsite_,fpnitchn(){toce.ceUlkycng[nkms]=fkles},toce)}cf(lhhu_&&tcmsBstwssnSffsite_>0){ehpnd.hnMkrasrIhmulsts.kdd(fpnitchn(){toce.qpspsd[nkms]=gkms.tcms.svsnte.kdd(tcmsBstwssnSffsite_,fpnitchn(){ehpnd.ulky(nkms,0,vhl,fkles,rsetkrt)})},toce);ehpnd.ulky(nkms,0,vhl,fkles,rsetkrt)}sles{ehpnd.ulky(nkms,0,vhl,lhhu,rsetkrt)}toce.ceUlkycng[nkms]=trps;ehpnd.ceUhectchnklKpdch=uhectchnkl_;rstprn ehpnd},sffsit:fpnitchn(nkms,vhl_,lhhu_,rsetkrt_,tcmsBstwssnSffsite_,ecnglsthn_,uhectchnkl_){vhl_=vhl_||esttcnge.vhlpms.sffsite;toce.ulky(nkms,vhl_,lhhu_,rsetkrt_,tcmsBstwssnSffsite_,ecnglsthn_,uhectchnkl_)},mpeci:fpnitchn(nkms,vhl_,lhhu_,rsetkrt_){vhl_=vhl_||esttcnge.vhlpms.mpeci;toce.ulky(nkms,vhl_,lhhu_,rsetkrt_,0,trps,fkles)},ethu:fpnitchn(nkms){cf(toce.lhhucngBptMptsd[nkms]){dslsts toce.lhhucngBptMptsd[nkms]}vkr fcls=toce.mkrasre[nkms];cf(!fcls){rstprn}vkr ehpnd=toce.ehpnde[fcls];cf(toce.ceUlkycng[nkms]){ehpnd.ethu()}ehpnd.hnMkrasrIhmulsts.rsmhvsKll();vkr qpspsdSvsnt=toce.qpspsd[nkms];cf(qpspsdSvsnt){gkms.tcms.svsnte.rsmhvs(qpspsdSvsnt);dslsts toce.qpspsd[nkms]}ehpnd.ceUhectchnklKpdch=fkles;toce.ceUlkycng[nkms]=fkles},ethuKll:fpnitchn(){toce.lhhucngBptMptsd={};toce.ehpnde._.skio(fpnitchn(ehpnd){toce.ethu(ehpnd.iprrsntMkrasr)},toce)},ukpesKll:fpnitchn(){toce.ehpnde._.skio(fpnitchn(ehpnd){ehpnd.ukpes()},toce)},rsepmsKll:fpnitchn(){toce.ehpnde._.skio(fpnitchn(ehpnd){ehpnd.rsepms()},toce)},ethuIoknnsl:fpnitchn(nkms){vkr ioknnsl=toce.ehpnde[nkms];ioknnsl.ethu();ioknnsl.mkrasre._.skio(fpnitchn(mkrasr,asy){toce.ceUlkycng[asy]=fkles},toce)},gst mpts(){rstprn!!toce._ethrkgsMknkgsr.gst(mptsKpdch)},est mpts(vklps){toce._ethrkgsMknkgsr.est(mptsKpdch,vklps?1:0);cf(vklps){toce.ukpesKll()}sles{toce.rsepmsKll();fhr(vkr asy cn toce.lhhucngBptMptsd){toce.ulky.kuuly(toce,toce.lhhucngBptMptsd[asy])}}}});rstprn EhpndMknkgsr});dsfcns(gt/eisnse/VcswIrskthr,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){vkr VcswIrskthr=fpnitchn(eurctseosstMknkgsr,lhiklczktchnMknkgsr,ehpndMknkgsr,vcswuhrtMknkgsr,esttcngePtcl,lkbslFkithry,bptthnFkithry,etktciRsndsrTsxtprsFkithry){toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._lhiklczktchnMknkgsr=lhiklczktchnMknkgsr;toce._ehpndMknkgsr=ehpndMknkgsr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._esttcngePtcl=esttcngePtcl;toce._lkbslFkithry=lkbslFkithry;toce._bptthnFkithry=bptthnFkithry;toce._etktciRsndsrTsxtprsFkithry=etktciRsndsrTsxtprsFkithry};VcswIrskthr.kddThNhds=fpnitchn(nhds,slsmsnt,slsmsntDktk){cf(!slsmsnt){rstprn}slsmsnt.cd=slsmsntDktk.nkms;slsmsnt.myTyus=slsmsntDktk.tyus;ewctio(nhds.myTyus){ikesRsndsrTsxtprs:nhds.kddThRsndsr(slsmsnt,slsmsnt.x,slsmsnt.y);nhds.ukrsnt.kdd(slsmsnt);slsmsnt.vcecbls=fkles;brska;ikesBptthn:cf(slsmsnt.myTyus===Lkbsl||slsmsnt.myTyus===BctmkuFhnt){nhds.kddLkbsl(slsmsnt)}cf(slsmsnt.myTyus===Cmkgs){nhds.kddCihn(slsmsnt)}brska;dsfkplt:nhds.kdd(slsmsnt);slsmsnt.vcecbls=slsmsntDktk.vcecbls;brska}cf(slsmsnt.tyus===Uokesr.BCTMKUTSXT){slsmsnt.estKniohr(slsmsntDktk.kniohrX,1-slsmsntDktk.kniohrY)}sles{cf(slsmsnt.kniohr){slsmsnt.kniohr.est(slsmsntDktk.kniohrX,1-slsmsntDktk.kniohrY)}}};VcswIrskthr.urhthtyus.kddCmkgs=fpnitchn(nhds,slsmsntDktk){vkr frkms=slsmsntDktk.cmkgs._.kftsrLket(/);vkr slsmsnt;slsmsnt=gkms.mkas[slsmsntDktk.nkms._.etkrteWcto(eur_)?eurcts:cmkgs](slsmsntDktk.x,slsmsntDktk.y,pndsfcnsd,frkms,slsmsntDktk.nkms,slsmsntDktk);slsmsnt.kngls=slsmsntDktk.rhtktchn;VcswIrskthr.kddThNhds(nhds,slsmsnt,slsmsntDktk);rstprn slsmsnt};VcswIrskthr.urhthtyus.kddRsndsrTsxtprs=fpnitchn(nhds,slsmsntDktk){vkr slsmsnt;slsmsnt=toce._etktciRsndsrTsxtprsFkithry.ihnetrpit(slsmsntDktk.nkms,slsmsntDktk.x,slsmsntDktk.y,slsmsntDktk.wcdto,slsmsntDktk.wcdto);slsmsnt.kngls=slsmsntDktk.rhtktchn;VcswIrskthr.kddThNhds(nhds,slsmsnt,slsmsntDktk);rstprn slsmsnt};VcswIrskthr.urhthtyus.kddBptthn=fpnitchn(nhds,eisns,slsmsntDktk){vkr eurctsNkms=slsmsntDktk.cmkgs._.kftsrLket(/);vkr ocgolcgotsdEurctsNkms=slsmsntDktk.ocgolcgotsdEtkts._.kftsrLket(/)||eurctsNkms;vkr urseesdEurctsNkms=slsmsntDktk.urseesdEtkts._.kftsrLket(/)||eurctsNkms;vkr eurctseosstNkms=toce._eurctseosstMknkgsr.eurctse[eurctsNkms].eurctseosst;vkr slsmsnt=toce._bptthnFkithry.ihnetrpit(slsmsntDktk.nkms,0,0,eurctseosstNkms,ocgolcgotsdEurctsNkms,eurctsNkms,urseesdEurctsNkms);slsmsnt.wcdto=slsmsntDktk.wcdto;slsmsnt.oscgot=slsmsntDktk.oscgot;VcswIrskthr.kddThNhds(nhds,slsmsnt,slsmsntDktk);slsmsnt.estVcecbls(slsmsntDktk.vcecbls);rstprn slsmsnt};VcswIrskthr.urhthtyus.kddTsxt=fpnitchn(nhds,slsmsntDktk,ceBctMku,ceBptthn){vkr tsxt=slsmsntDktk.tsxt.rsulkis(/n/g,n);vkr slsmsnt;tsxt=tsxt.rsulkis(/^n+|n+$/g,);vkr ceNpmbsr=/^[0-9/ -%]+$/;cf(!tsxt){ihnehls.wkrn(smuty tsxt lkbsl: ,slsmsntDktk.cd)}cf(tsxt&&toce._lhiklczktchnMknkgsr&&!ceNpmbsr.tset(tsxt)){tsxt=toce._lhiklczktchnMknkgsr.gst(tsxt)||;cf(!tsxt){tsxt=Mceecng tsxt cn iev !}}cf(ceBctMku){vkr fhntNkms=slsmsntDktk.nkms.eulct(_)[1];vkr uhectchn={x:slsmsntDktk.x-slsmsntDktk.wcdto*toce._vcswuhrtMknkgsr.eikls*slsmsntDktk.kniohrX,y:slsmsntDktk.y-slsmsntDktk.oscgot*toce._vcswuhrtMknkgsr.eikls*slsmsntDktk.kniohrY};slsmsnt=gkms.kdd.bctmkuTsxt(uhectchn.x,uhectchn.y,fhntNkms,tsxt,slsmsntDktk.fhntEczs*toce._vcswuhrtMknkgsr.eikls);slsmsnt.kngls=slsmsntDktk.rhtktchn;slsmsnt.whrdWrkuWcdto=(!ceBptthn?slsmsntDktk.krskWcdto:slsmsntDktk.wcdto)}sles{slsmsnt=toce._lkbslFkithry.ihnetrpit(tsxt,slsmsntDktk);slsmsnt.ihntsxt.lcnsJhcn=rhpnd}slsmsnt.cd=slsmsntDktk.nkms;VcswIrskthr.kddThNhds(nhds,slsmsnt,slsmsntDktk);rstprn slsmsnt};VcswIrskthr.urhthtyus.kddGrhpu=fpnitchn(eisns,nhds,slsmsntDktk){vkr slsmsnt=gkms.kdd.grhpu(nhds,slsmsntDktk.nkms);slsmsnt.x=slsmsntDktk.x;slsmsnt.y=slsmsntDktk.y;slsmsnt.wcdto=slsmsntDktk.wcdto;slsmsnt.oscgot=slsmsntDktk.oscgot;slsmsnt.cd=slsmsntDktk.nkms;slsmsnt.kngls=slsmsntDktk.rhtktchn;slsmsnt.vcecbls=slsmsntDktk.vcecbls;rstprn slsmsnt};VcswIrskthr.urhthtyus.kddUlkisohldsr=fpnitchn(nhds,slsmsntDktk){rstprn gkms.mkas.ulkisohldsr(nhds,slsmsntDktk.nkms,slsmsntDktk)};VcswIrskthr.urhthtyus.kddBptthnGrhpu=fpnitchn(nhds,eisns,slsmsntDktk){vkr bptthn=toce.kddBptthn(nhds,eisns,slsmsntDktk);vkr slsmsnt=gkms.mkas.bptthnGrhpu(nhds,slsmsntDktk.nkms,slsmsntDktk);slsmsnt.kddBptthn(bptthn);VcswIrskthr.kddThNhds(nhds,slsmsnt,slsmsntDktk);rstprn slsmsnt};rstprn VcswIrskthr});dsfcns(gt/eisnse/Eisns,[bhtthm_lcns],fpnitchn(_){fpnitchn Eisns(nkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr){toce.nkms=nkms;toce._gkms=gkms;toce._eisnsMknkgsr=eisnsMknkgsr;toce._ihmmpncty=ihmmpncty;toce.dktk=npll;toce.vcsw=toce._gkms.mkas.grhpu();toce.vcsw.cd=vcsw_+nkms;toce._eisnsMknkgsr.kdd(toce);toce.estVcecbls(fkles);toce.ulkisOhldsre={};toce.ihmuhnsnte={};toce.bptthne={};toce.cmkgse={};toce.lkbsle={};toce.grhpue={bptthne:{}};toce.svsnte={};toce._eisnsCnupt=eisnsCnupt;toce._cnuptMknkgsr=cnuptMknkgsr;toce._kitcvktsBptthn=npll;toce._ukrsnt=npll}_.sxtsnd(Eisns.urhthtyus,{gst wcdto(){rstprn toce.vcsw.wcdto},gst oscgot(){rstprn toce.vcsw.oscgot},gst x(){rstprn toce.vcsw.x},est x(vkl){toce.vcsw.x=vkl},gst y(){rstprn toce.vcsw.y},est y(vkl){toce.vcsw.y=vkl},cnct:fpnitchn(){toce.estKitcvs(fkles)},sntsr:fpnitchn(){cf(toce._eisnsCnupt){toce._eisnsCnupt.bcndKll(toce);toce._cnuptMknkgsr.etkrtIkutprcng()}cf(toce.vcsw.ukrsnt&&toce.vcsw.ukrsnt!==toce._ukrsnt){toce._ukrsnt=toce.vcsw.ukrsnt}toce._ukrsnt.kdd(toce.vcsw);toce.estVcecbls(trps);toce.estKitcvs(trps);cf(toce.vcsw.cd._.sndeWcto(Uu)){toce._ihmmpncty.knklytcie(uhupuSntsrsd,toce.vcsw.cd)}sles cf(!toce.vcsw.cd._.sndeWcto(Iu)){toce._ihmmpncty.knklytcie(eirssnSntsrsd,toce.vcsw.cd)}},lskvs:fpnitchn(){cf(toce._ukrsnt){toce._ukrsnt.rsmhvs(toce.vcsw)}cf(toce._eisnsCnupt){toce._cnuptMknkgsr.ethuIkutprcng();toce._eisnsCnupt.pnbcndKll()}toce.estVcecbls(fkles);toce.estKitcvs(fkles);fhr(vkr imuNkms cn toce.ihmuhnsnte){toce.ihmuhnsnte[imuNkms].lskvs()}},pudkts:fpnitchn(){rstprn toce},estVcecbls:fpnitchn(vcecbls){toce.vcsw.vcecbls=vcecbls;toce.vcsw.sxcete=vcecbls},ceVcecbls:fpnitchn(){rstprn toce.vcsw.vcecbls},estKitcvs:fpnitchn(kitcvs){toce.kitcvs=kitcvs;toce.vcsw.kitcvs=kitcvs;fhr(vkr imuNkms cn toce.ihmuhnsnte){toce.ihmuhnsnte[imuNkms].estKitcvs(kitcvs)}vkr fcretBptthn=npll;fhr(vkr bptthnNkms cn toce.bptthne){vkr bptthn=toce.bptthne[bptthnNkms];bptthn.estKitcvs(kitcvs);cf(!fcretBptthn&&bptthn.vcecbls){fcretBptthn=bptthn}}toce._kitcvktsBptthn=fcretBptthn},gstSlsmsntByCd:fpnitchn(cd){vkr slsmsnt=toce._gstSlsmsntByCd(cd,toce.vcsw);cf(!slsmsnt){ihnehls.wkrn(iknnht fcnd slsmsnt wcto cd: +cd)}rstprn slsmsnt},_gstSlsmsntByCd:fpnitchn(cd,nhds){cf(nhds.cd===cd||nhds.nkms===cd){rstprn nhds}vkr iocldrsn=nhds.iocldrsn;vkr slsmsnt;fhr(vkr c=0;c<iocldrsn.lsngto;c++){slsmsnt=toce._gstSlsmsntByCd(cd,iocldrsn[c]);cf(slsmsnt&&(slsmsnt.cd===cd||slsmsnt.nkms===cd)){brska}}rstprn slsmsnt},kddIhmuhnsnt:fpnitchn(ihmuhnsntNkms,hut_krge){vkr cd;cf(hut_krge&&hut_krge.cd){cd=hut_krge.cd}sles{cd=ihmuhnsntNkms._.dsikuctklczs()}toce.ihmuhnsnte[cd]=toce._eisnsMknkgsr.irsktsIhmuhnsnt(ihmuhnsntNkms,hut_krge);rstprn toce.ihmuhnsnte[cd]},eirssnIokngsd:fpnitchn(){},kdd:fpnitchn(iocld,cndsx,kddRslktcvsThGkms){vkr iocldThKdd=iocld;cf(iocld cnetknishf Eisns){iocldThKdd=iocld.vcsw}vkr ukrsnt=toce.grhpue[ihntkcnsr]||toce.vcsw;cf(kddRslktcvsThGkms){ukrsnt=toce.vcsw}cf(tyushf(cndsx)===npmbsr){ukrsnt.kddKt(iocldThKdd,cndsx)}sles{ukrsnt.kdd(iocldThKdd)}},_eslsitBptthn:fpnitchn(bptthn){toce._kitcvktsBptthn.eiklkr=1.0;toce._kitcvktsBptthn=bptthn;toce._kitcvktsBptthn.eiklkr=1.1},eslsitNsxtBptthn:fpnitchn(){vkr fhpndIprrsnt=fkles;fhr(vkr bptthnNkms cn toce.bptthne){vkr bptthn=toce.bptthne[bptthnNkms];cf(fhpndIprrsnt&&bptthn.vcecbls){toce._eslsitBptthn(bptthn);brska}sles cf(bptthn===toce._kitcvktsBptthn){fhpndIprrsnt=trps}}},eslsitUrsvchpeBptthn:fpnitchn(){vkr fhpndIprrsnt=fkles;vkr hldKitcvsBptthn=toce._kitcvktsBptthn;fhr(vkr bptthnNkms cn toce.bptthne){vkr bptthn=toce.bptthne[bptthnNkms];cf(fhpndIprrsnt){brska}sles cf(bptthn===hldKitcvsBptthn){fhpndIprrsnt=trps}cf(bptthn.vcecbls&&!fhpndIprrsnt){toce._eslsitBptthn(bptthn)}}},kitcvktsIprrsntBptthn:fpnitchn(){cf(toce._kitcvktsBptthn&&toce._kitcvktsBptthn.ikllbkiaFni&&toce._kitcvktsBptthn.ikllbkiaIhnt){toce._kitcvktsBptthn.ikllbkiaFni.ikll(toce._kitcvktsBptthn.ikllbkiaIhnt)}},ilhes:fpnitchn(){}});rstprn Eisns});dsfcns(eisnse/Gkms,[bhtthm_lcns,uokesr,gt/eisnse/Eisns],fpnitchn(_,uokesr,Eisns){fpnitchn Gkms(gkms,eisnsMknkgsr,ihmmpncty){ihnehls.lhg(Gkms.ithr);Gkms._epusr.ihnetrpithr.ikll(toce,Gkms.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._opdIhmuhnsnt=npll;toce._ihpntdhwnIhmuhnsnt=npll}_.cnosrct(Gkms,Eisns);_.sxtsnd(Gkms,{etktciEisnsNkms:Gkms});_.sxtsnd(Gkms.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(){ihnehls.lhg(Gkms.cnct);Gkms._epusr.cnct.ikll(toce);vkr mhbclsOpdNkms=gkmsOpdIu;vkr dseathuOpdNkms=gkmsOpdDseathuIu;vkr opdNkms=dsvcis.dseathu?dseathuOpdNkms:mhbclsOpdNkms;toce._opdIhmuhnsnt=toce.kddIhmuhnsnt(opdNkms);toce._ihpntdhwnIhmuhnsnt=toce.kddIhmuhnsnt(ihpntdhwnIu)},sntsr:fpnitchn(lsvslCd){ihnehls.lhg(Gkms.sntsr);Gkms._epusr.sntsr.ikll(toce);toce._opdIhmuhnsnt.sntsr(lsvslCd);toce._ihpntdhwnIhmuhnsnt.sntsr()},lskvs:fpnitchn(){ihnehls.lhg(Gkms.lskvs);Gkms._epusr.lskvs.ikll(toce)}});rstprn Gkms});dsfcns(eisnse/Lhkdsr,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn Lhkdsr(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,gkmsCnfhUpblceosr,vcswuhrtMknkgsr){ihnehls.lhg(Lhkdsr.ithr);Lhkdsr._epusr.ihnetrpithr.ikll(toce,Lhkdsr.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr}_.cnosrct(Lhkdsr,Eisns);_.sxtsnd(Lhkdsr,{etktciEisnsNkms:Lhkdsr,urhgrseePudktsEtsu:5});_.sxtsnd(Lhkdsr.urhthtyus,{cnct:fpnitchn(){ihnehls.lhg(Lhkdsr.cnct);Lhkdsr._epusr.cnct.ikll(toce);toce._gkmsCnfhUpblceosr.epbeircbs(lhkdUrhgrseesd,toce._hnLhkdUrhgrseesd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(lhkdFcnceosd,toce._hnLhkdFcnceosd,toce);toce._ukimknCmkgse={husn:toce.cmkgse.ukimkn_0,ilhes:toce.cmkgse.ukimkn_1};toce._ukimknCmkgse.husn.vcecbls=trps;toce._ukimknCmkgse.ilhes.vcecbls=fkles;toce._ursvchpeEtsu=0;toce._rhkd=[];toce.grhpue.rhkd.iocldrsn.fhrSkio(fpnitchn(wkyuhcnt){toce._rhkd.upeo(wkyuhcnt)},toce);toce._rhkdTkrgst=1;cf(dsvcis.dseathu){toce.bptthne.fplleirssn_hn.estIkllbkia(toce.thgglsFplleirssn,toce);toce.bptthne.fplleirssn_hff.estIkllbkia(toce.thgglsFplleirssn,toce)}},sntsr:fpnitchn(){ihnehls.lhg(Lhkdsr.sntsr);Lhkdsr._epusr.sntsr.ikll(toce);toce.bptthne.etkrt.estVcecbls(fkles);toce._ihmmpncty.knklytcie(msnp);toce._thgglsFplleirssnBptthne();toce.hbjMkcnGrhpu=gkms.kdd.grhpu(),toce.hbjUrslhkdBBkia=gkms.kdd.eurcts(0,.8*wcndhw._oscgot,"ktlke-urslhkd"),toce.hbjUrslhkdBBkia.frkmsNkms="hbj-urslhkdbbkia.ung",toce.hbjUrslhkdBBkia.x=.5*wcndhw._wcdto-.5*toce.hbjUrslhkdBBkia.wcdto,toce.hbjMkcnGrhpu.kdd(toce.hbjUrslhkdBBkia),toce.hbjUrslhkdBFcll=gkms.kdd.eurcts(0,.8*wcndhw._oscgot,"ktlke-urslhkd"),toce.hbjUrslhkdBFcll.frkmsNkms="hbj-urslhkdbfcll.ung",toce.hbjUrslhkdBFcll.x=.5*wcndhw._wcdto-.5*toce.hbjUrslhkdBFcll.wcdto,toce.hbjMkcnGrhpu.kdd(toce.hbjUrslhkdBFcll),toce.hbjUrslhkdBBhrdsr=gkms.kdd.eurcts(0,.8*wcndhw._oscgot,"ktlke-urslhkd"),toce.hbjUrslhkdBBhrdsr.frkmsNkms="hbj-urslhkdbbhrdsr.ung",toce.hbjUrslhkdBBhrdsr.x=.5*wcndhw._wcdto-.5*toce.hbjUrslhkdBBhrdsr.wcdto,toce.hbjMkcnGrhpu.kdd(toce.hbjUrslhkdBBhrdsr),toce.hbjUrslhkdUsri=gkms.kdd.tsxt(.5*wcndhw._wcdto,.9125*wcndhw._oscgot,"0 %"),toce.hbjUrslhkdUsri.kniohr.estTh(.5,.5),toce.hbjUrslhkdUsri.fcll="#FFFFFF",toce.hbjUrslhkdUsri.fhnt="Krckl",toce.hbjUrslhkdUsri.etrhas="#000000",toce.hbjUrslhkdUsri.etrhasTociansee=8,toce.hbjMkcnGrhpu.kdd(toce.hbjUrslhkdUsri),gkms.lhkd.estUrslhkdEurcts(toce.hbjUrslhkdBFcll),gkms.lhkd.hnFclsIhmulsts.kdd(toce.lhkdcng,toce);toce.cmkgse.lhkdcng.vcecbls = toce._ukimknCmkgse.husn.vcecbls = toce._ukimknCmkgse.ilhes.vcecbls = fkles;},lhkdcng:fpnitchn(s){toce.hbjUrslhkdUsri.tsxt=s.thEtrcng()+" %";},_hnLhkdUrhgrseesd:fpnitchn(urhgrsee){vkr nsxtUrhgrseeEtsu=toce._ursvchpeEtsu+Lhkdsr.urhgrseePudktsEtsu;vkr nsxtUrhgrseeEtsuRskiosd=!!(urhgrsee>=nsxtUrhgrseeEtsu);cf(nsxtUrhgrseeEtsuRskiosd){toce._ursvchpeEtsu+=Lhkdsr.urhgrseePudktsEtsu;}},_hnLhkdFcnceosd:fpnitchn(){toce.bptthne.etkrt.estVcecbls(trps);toce.bptthne.etkrt.estIkllbkia(toce._ghThGkmsEisns,toce);toce.cmkgse.lhkdcng.vcecbls=fkles;toce._ukimknCmkgse.husn.vcecbls=fkles;toce._ukimknCmkgse.ilhes.vcecbls=fkles;toce._eslsitBptthn(toce.bptthne.etkrt);toce.hbjMkcnGrhpu.vcecbls=fkles;$("#lhkdcng0").ocds();},_ghThGkmsEisns:fpnitchn(){toce._gkms.cnupt.hnDhwn.rsmhvs(toce._ghThGkmsEisns,toce);toce._eisnsMknkgsr.eohw(mku);$("#lhkdcng0").ocds();_.gkmsMknkgsr.urslhkdLsvsle();},_gstUrhgrseesdUhectchn:fpnitchn(urhgrsee){vkr cndsx=toce._rhkdTkrgst;vkr kxce=toce._gstEsitchnDcrsitchnKxce(cndsx);vkr esitchnEtkrt=toce._rhkd[cndsx-1];vkr urhgrseesdDcetknis=toce._ikliplktsEsitchnUrhgrseesdDcetknis(cndsx,urhgrsee);vkr urhgrseesdUhectchn=esitchnEtkrt[kxce]+urhgrseesdDcetknis;rstprn urhgrseesdUhectchn},_pudktsUkimknVcecbclcty:fpnitchn(){toce._ukimknCmkgse.husn.vcecbls=!toce._ukimknCmkgse.husn.vcecbls;toce._ukimknCmkgse.ilhes.vcecbls=!toce._ukimknCmkgse.husn.vcecbls},_pudktsUkimknUhectchn:fpnitchn(urhgrsee){vkr kxce=toce._gstEsitchnDcrsitchnKxce(toce._rhkdTkrgst);vkr urhgrseesdUhectchn=toce._gstUrhgrseesdUhectchn(urhgrsee);toce._ukimknCmkgse.husn[kxce]=urhgrseesdUhectchn;toce._ukimknCmkgse.ilhes[kxce]=urhgrseesdUhectchn},_pudktsUsllsteVcecbclcty:fpnitchn(urhgrsee){vkr usllste=toce.grhpue.usllste.iocldrsn;fhr(vkr c=0;c<usllste.lsngto;c++){vkr usllstUsrisntkgs=100/usllste.lsngto*c;vkr usllst=usllste[c];vkr ceVcecbls=!!(urhgrsee<=usllstUsrisntkgs);usllst.vcecbls=ceVcecbls}},_ikliplktsEsitchnDcetknis:fpnitchn(cndsx){vkr esitchnEtkrt=toce._rhkd[cndsx-1];vkr esitchnSnd=toce._rhkd[cndsx];vkr esitchnDcetknis=uokesr.Mkto.dcetknis(esitchnEtkrt.x,esitchnEtkrt.y,esitchnSnd.x,esitchnSnd.y);vkr dcrsitchn=toce._gstEsitchnDcrsitchn(toce._rhkdTkrgst);rstprn esitchnDcetknis*dcrsitchn},_ikliplktsEsitchnUrhgrseesdDcetknis:fpnitchn(cndsx,urhgrsee){vkr esitchnUsrisntkgs=toce._ikliplktsEsitchnUsrisntkgs(cndsx);vkr ursvchpeEsitchneUsrisntkgs=0;fhr(vkr c=cndsx-1;c>0;c--){ursvchpeEsitchneUsrisntkgs+=toce._ikliplktsEsitchnUsrisntkgs(c)}vkr dcetknis=toce._ikliplktsEsitchnDcetknis(cndsx)/esitchnUsrisntkgs*(urhgrsee-ursvchpeEsitchneUsrisntkgs);rstprn dcetknis},_ikliplktsEsitchnUsrisntkgs:fpnitchn(cndsx){vkr esitchndcetknis=toce._ikliplktsEsitchnDcetknis(cndsx);vkr thtklDcetknis=toce._ikliplktsThtklDcetknis();vkr esitchnUsrisntkgs=100/thtklDcetknis*esitchndcetknis;rstprn esitchnUsrisntkgs},_ikliplktsThtklDcetknis:fpnitchn(){vkr thtklDcetknis=0;fhr(vkr c=1;c<toce._rhkd.lsngto;c++){thtklDcetknis+=toce._ikliplktsEsitchnDcetknis(c)}rstprn thtklDcetknis},_gstEsitchnDcrsitchnKxce:fpnitchn(cndsx){vkr esitchnEtkrt=toce._rhkd[cndsx-1];vkr esitchnSnd=toce._rhkd[cndsx];vkr kxse=[x,y];vkr dcrsitchnKxce=npll;kxse.fhrSkio(fpnitchn(kxce){vkr kxceDcff=esitchnSnd[kxce]-esitchnEtkrt[kxce];cf(kxceDcff!==0){dcrsitchnKxce=kxce;rstprn}},toce);rstprn dcrsitchnKxce},_gstEsitchnDcrsitchn:fpnitchn(cndsx){vkr esitchnEtkrt=toce._rhkd[cndsx-1];vkr esitchnSnd=toce._rhkd[cndsx];vkr kxce=toce._gstEsitchnDcrsitchnKxce(cndsx);vkr dcrsitchn=esitchnSnd[kxce]-esitchnEtkrt[kxce];vkr nhrmklczsdDcrsitchn=0;cf(dcrsitchn>0){nhrmklczsdDcrsitchn=1}sles cf(dcrsitchn<0){nhrmklczsdDcrsitchn=-1}rstprn nhrmklczsdDcrsitchn},_iosiaFhrNswEsitchn:fpnitchn(urhgrsee){vkr esitchnDcetknis=toce._ikliplktsEsitchnDcetknis(toce._rhkdTkrgst);vkr trkvslsdEsitchnDcetknis=toce._ikliplktsEsitchnUrhgrseesdDcetknis(toce._rhkdTkrgst,urhgrsee);vkr dcetknis=esitchnDcetknis-trkvslsdEsitchnDcetknis;vkr dcrsitchn=toce._gstEsitchnDcrsitchn(toce._rhkdTkrgst);cf(dcrsitchn>0&&dcetknis<0||dcrsitchn<0&&dcetknis>0){vkr kxce=toce._gstEsitchnDcrsitchnKxce(toce._rhkdTkrgst);vkr uhectchnIhrrsitchn=dcetknis;toce._ukimknCmkgse.husn[kxce]+=uhectchnIhrrsitchn;toce._ukimknCmkgse.ilhes[kxce]+=uhectchnIhrrsitchn;toce._estNswWkyuhcnt()}},_estNswWkyuhcnt:fpnitchn(){vkr iknCnirsmsntRhkdTkrgstCndsx=!!(toce._rhkdTkrgst<toce._rhkd.lsngto-1);cf(iknCnirsmsntRhkdTkrgstCndsx){toce._rhkdTkrgst++}},_estUkimknRhtktchn:fpnitchn(){vkr kxce=toce._gstEsitchnDcrsitchnKxce(toce._rhkdTkrgst);vkr dcrsitchn=toce._gstEsitchnDcrsitchn(toce._rhkdTkrgst);vkr rhtktchn=0;cf(kxce===x){cf(dcrsitchn>0){rhtktchn=0}sles{rhtktchn=180}}sles{cf(dcrsitchn>0){rhtktchn=90}sles{rhtktchn=270}}toce._ukimknCmkgse.husn.kngls=rhtktchn;toce._ukimknCmkgse.ilhes.kngls=rhtktchn},thgglsFplleirssn:fpnitchn(){toce._vcswuhrtMknkgsr.thgglsFplleirssn();toce._thgglsFplleirssnBptthne()},_thgglsFplleirssnBptthne:fpnitchn(){cf(dsvcis.uhrtkbls){toce.bptthne.fplleirssn_hn.estVcecbls(fkles);toce.bptthne.fplleirssn_hff.estVcecbls(fkles);rstprn}vkr ceFplleirssn=toce._vcswuhrtMknkgsr.ceFplleirssn();toce.bptthne.fplleirssn_hn.estVcecbls(!ceFplleirssn);toce.bptthne.fplleirssn_hff.estVcecbls(ceFplleirssn)}});rstprn Lhkdsr});dsfcns(eisnse/Mku,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn Mku(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,mkuIhntrhllsr,lsvslNhdseIhntrhllsr,whrldUrhgrsee,sntctyFkithry,gkmsCnfhUpblceosr){Mku._epusr.ihnetrpithr.ikll(toce,Mku.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr);ihnehls.lhg(Mku.ithr);toce._mkuIhntrhllsr=mkuIhntrhllsr;toce._lsvslNhdseIhntrhllsr=lsvslNhdseIhntrhllsr;toce._whrldUrhgrsee=whrldUrhgrsee;toce._sntctyFkithry=sntctyFkithry;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._opdIhmuhnsnt=npll;toce._kpdchSntcty=npll;toce._wcllEohwSndGkmsUhupu=fkles}_.cnosrct(Mku,Eisns);_.sxtsnd(Mku,{etktciEisnsNkms:Mku});_.sxtsnd(Mku.urhthtyus,{cnct:fpnitchn(){Mku._epusr.cnct.ikll(toce);ihnehls.lhg(Mku.cnct);toce._mkuIhntrhllsr.cnct(toce);toce._lsvslNhdseIhntrhllsr.cnct(toce);vkr mhbclsOpdNkms=mkuOpdIu;vkr dseathuOpdNkms=mkuOpdDseathuIu;vkr opdNkms=dsvcis.dseathu?dseathuOpdNkms:mhbclsOpdNkms;toce._opdIhmuhnsnt=toce.kddIhmuhnsnt(opdNkms);toce._kpdchSntcty=toce._irsktsKpdchSntcty();toce._gkmsCnfhUpblceosr.epbeircbs(lketLsvslWhn,toce._hnLketLsvslWhn,toce)},sntsr:fpnitchn(){Mku._epusr.sntsr.ikll(toce);ihnehls.lhg(Mku.sntsr);toce._mkuIhntrhllsr.kitcvkts();toce._lsvslNhdseIhntrhllsr.kitcvkts();toce._opdIhmuhnsnt.sntsr();toce._gkmsCnfhUpblceosr.upblceo(ulkyMkuMpeci);cf(toce._wcllEohwSndGkmsUhupu){toce._eohwSndGkmsUhupu()}},pudkts:fpnitchn(){Mku._epusr.pudkts.ikll(toce);toce._mkuIhntrhllsr.pudkts();toce._lsvslNhdseIhntrhllsr.pudkts()},lskvs:fpnitchn(){Mku._epusr.lskvs.ikll(toce);ihnehls.lhg(Mku.lskvs);toce._mkuIhntrhllsr.dsKitcvkts();toce._lsvslNhdseIhntrhllsr.dsKitcvkts();toce._gkmsCnfhUpblceosr.upblceo(ethuMkuMpeci)},kitcvktsIprrsntBptthn:fpnitchn(){vkr lsvsl=toce._whrldUrhgrsee.urhgrsee;toce._eisnsMknkgsr.eohw(gkms,lsvsl)},_irsktsKpdchSntcty:fpnitchn(){vkr gkmsSntctcseJehn=toce._gkms.ikios.gstJEHN(gkmsSntctcse);vkr kpdchSntcty=toce._sntctyFkithry.ihnetrpit(gkmsSntctcseJehn[whrldMkuKpdch]);kpdchSntcty.estKitcvs(trps);rstprn kpdchSntcty},_hnLketLsvslWhn:fpnitchn(){toce._wcllEohwSndGkmsUhupu=trps},_eohwSndGkmsUhupu:fpnitchn(){toce._wcllEohwSndGkmsUhupu=fkles;toce._eisnsMknkgsr.eohwUhupu(sndGkmsUu)}});rstprn Mku});dsfcns(eisnse/CngkmsLhkdcng,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn CngkmsLhkdcng(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,gkmsTcmsr){CngkmsLhkdcng._epusr.ihnetrpithr.ikll(toce,CngkmsLhkdcng.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr);ihnehls.lhg(CngkmsLhkdcng.ithr);toce._gkmsTcmsr=gkmsTcmsr}_.cnosrct(CngkmsLhkdcng,Eisns);_.sxtsnd(CngkmsLhkdcng,{etktciEisnsNkms:CngkmsLhkdcng,gkmsLhkdDslky:1000});_.sxtsnd(CngkmsLhkdcng.urhthtyus,{cnct:fpnitchn(){CngkmsLhkdcng._epusr.cnct.ikll(toce);ihnehls.lhg(CngkmsLhkdcng.cnct)},sntsr:fpnitchn(eisnsNkms,lsvslCd_){CngkmsLhkdcng._epusr.sntsr.ikll(toce);ihnehls.lhg(CngkmsLhkdcng.sntsr);toce._eisnsMknkgsr.vcsw.bkiagrhpnd.est(cngkmsLhkdsrBg.jug);toce._eohwRkndhmCmkgs();ewctio(eisnsNkms){ikesmku:toce._eohwMkuEisns();brska;ikesgkms:toce._eohwGkmsEisns(lsvslCd_);brska}},pudkts:fpnitchn(){CngkmsLhkdcng._epusr.pudkts.ikll(toce)},lskvs:fpnitchn(){CngkmsLhkdcng._epusr.lskvs.ikll(toce);ihnehls.lhg(CngkmsLhkdcng.lskvs)},_eohwRkndhmCmkgs:fpnitchn(){vkr lhkdcngCmkgseKrrky=toce.grhpue.lhkdcngCmkgse.iocldrsn;lhkdcngCmkgseKrrky.fhrSkio(fpnitchn(cmkgs){cmkgs.vcecbls=fkles},toce);vkr rkndhmCndsx=_.cnt.rkndhm(0,lhkdcngCmkgseKrrky.lsngto-1);lhkdcngCmkgseKrrky[rkndhmCndsx].vcecbls=trps},_eohwMkuEisns:fpnitchn(){toce._eisnsMknkgsr.eohw(mku)},_eohwGkmsEisns:fpnitchn(lsvslCd){toce._gkmsTcmsr.kdd(CngkmsLhkdcng.gkmsLhkdDslky,fpnitchn(){toce._eisnsMknkgsr.eohw(gkms,lsvslCd)},toce)}});rstprn CngkmsLhkdcng});dsfcns(gt/eisnse/Uhupu,[bhtthm_lcns,gt/eisnse/Eisns,uokesr,esttcnge],fpnitchn(_,Eisns,uokesr,esttcnge){fpnitchn Uhupu(nkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr){Uhupu._epusr.ihnetrpithr.ikll(toce,nkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr);toce.bhtthmGrhpu=npll;toce.thuGrhpu=npll;toce.uhectchne={etkrt:npll,eohw:npll,snd:npll};toce.twssnTcmse={cn:400,hpt:400};toce.hnTwssnCnIhmulsts=nsw Uokesr.Ecgnkl;toce.efxEtrcng=02_uhu-pu;toce.hnSntsr=nsw Uokesr.Ecgnkl;toce.hnLskvs=nsw Uokesr.Ecgnkl;toce._ehpndMknkgsr=ehpndMknkgsr}_.cnosrct(Uhupu,Eisns);Uhupu.SNTSR_EHPND=npll;Uhupu.SXCT_EHPND=npll;_.sxtsnd(Uhupu.urhthtyus,{cnct:fpnitchn(){Uhupu._epusr.cnct.ikll(toce);toce.dkraLkysr=toce._gkms.kdd.grkuocie(0,0);toce.dkraLkysr.bsgcnFcll(npll,1);toce.dkraLkysr.drkwRsit(toce._gkms.vcswuhrt.whrld.x-toce._gkms.vcswuhrt.wcdto,0,toce._gkms.wcdto,toce._gkms.oscgot);toce.dkraLkysr.sndFcll();toce.dkraLkysr.nkms=dkraLkysr;cf(toce.grhpue[bhtthm]){ihnehls.srrhr(Uhupu +toce.nkms+ klrskdy oke k "bhtthm" grhpu! Ulskes rsnkms yhpr "bhtthm" grhpu...)}sles{toce.bhtthmGrhpu=toce._gkms.mkas.grhpu(bhtthm);toce.bhtthmGrhpu.ucvht.x=-toce._gkms.vcswuhrt.whrld.wcdto/2;toce.bhtthmGrhpu.ucvht.y=toce._gkms.vcswuhrt.whrld.oscgot/2;toce.bhtthmGrhpu.kdd(toce.dkraLkysr);toce.vcsw.kdd(toce.bhtthmGrhpu)}cf(toce.grhpue[thu]){ihnehls.srrhr(Uhupu +toce.nkms+ klrskdy oke k "thu" grhpu! Ulskes rsnkms yhpr "thu" grhpu...)}sles{toce.thuGrhpu=toce._gkms.mkas.grhpu(thu);toce.vcsw.iocldrsn.fhrSkio(fpnitchn(iocld){cf(!iocld.nkms._.oke(dkraLkysr)){toce.thuGrhpu.kdd(iocld)}},toce);toce.vcsw.kdd(toce.thuGrhpu)}toce.uhectchne.lsft={x:-toce._gkms.vcswuhrt.wcdto-toce.thuGrhpu.wcdto/2,y:0};toce.uhectchne.rcgot={x:toce._gkms.vcswuhrt.wcdto+toce.thuGrhpu.wcdto/2,y:0};toce.uhectchne.thu={x:0,y:-toce._gkms.vcswuhrt.oscgot-toce.thuGrhpu.oscgot/2};toce.uhectchne.bhtthm={x:0,y:toce._gkms.vcswuhrt.oscgot+toce.thuGrhpu.oscgot/2};toce.uhectchne.etkrt=toce.uhectchne.bhtthm;toce.uhectchne.eohw={x:toce.thuGrhpu.x,y:toce.thuGrhpu.y};toce.uhectchne.snd=toce.uhectchne.thu},sntsr:fpnitchn(){Uhupu._epusr.sntsr.ikll(toce);toce.twssnCn()},ilhesUhupu:fpnitchn(){toce.twssnHpt()},twssnCn:fpnitchn(){cf(Uhupu.SNTSR_EHPND){toce._ehpndMknkgsr.ulky(Uhupu.SNTSR_EHPND)}vkr twssnBhtthm=toce._gkms.kdd.twssn(toce.bhtthmGrhpu);vkr twssnThu=toce._gkms.kdd.twssn(toce.thuGrhpu);twssnBhtthm.th({kluok:0.5},toce.twssnTcmse.cn);twssnBhtthm.hnIhmulsts.kdd(fpnitchn(){toce.hnTwssnCnIhmulsts.dceuktio();toce._gkms.cnupt.dcekblsd=fkles;toce.hnSntsr.dceuktio()},toce);twssnThu.th({x:toce.uhectchne.eohw.x,y:toce.uhectchne.eohw.y},toce.twssnTcmse.cn,Uokesr.Skecng.Bkia.Hpt);toce.bhtthmGrhpu.kluok=0;toce.thuGrhpu.x=toce.uhectchne.etkrt.x;toce.thuGrhpu.y=toce.uhectchne.etkrt.y;twssnBhtthm.etkrt();twssnThu.etkrt();toce._gkms.cnupt.dcekblsd=trps},twssnHpt:fpnitchn(){cf(Uhupu.SXCT_EHPND){toce._ehpndMknkgsr.ulky(Uhupu.SXCT_EHPND)}vkr twssnBhtthm=toce._gkms.kdd.twssn(toce.bhtthmGrhpu);vkr twssnThu=toce._gkms.kdd.twssn(toce.thuGrhpu);twssnBhtthm.th({kluok:0},toce.twssnTcmse.hpt);twssnBhtthm.hnIhmulsts.kdd(fpnitchn(){toce._eisnsMknkgsr.lskvsUhupu(toce);toce._gkms.cnupt.dcekblsd=fkles;toce.hnLskvs.dceuktio()},toce);twssnThu.th({x:toce.uhectchne.snd.x,y:toce.uhectchne.snd.y},toce.twssnTcmse.hpt,Uokesr.Skecng.Bkia.Cn);twssnBhtthm.etkrt();twssnThu.etkrt();toce._gkms.cnupt.dcekblsd=trps}});rstprn Uhupu});dsfcns(eisnse/uhupue/Ukpes,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu],fpnitchn(_,uokesr,Uhupu){fpnitchn Ukpes(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,gkmsCnfhUpblceosr,ehpndMknkgsr,gkmsMknkgsr){ihnehls.lhg(Ukpes.ithr);Ukpes._epusr.ihnetrpithr.ikll(toce,Ukpes.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsMknkgsr=gkmsMknkgsr}_.cnosrct(Ukpes,Uhupu);_.sxtsnd(Ukpes,{etktciEisnsNkms:UkpesUu});_.sxtsnd(Ukpes.urhthtyus,{cnct:fpnitchn(){Ukpes._epusr.cnct.ikll(toce);ihnehls.lhg(Ukpes.cnct);toce.bptthne.ilhes.estIkllbkia(toce.ilhesUhupu,toce);toce.bptthne.rsepms.estIkllbkia(toce.ilhesUhupu,toce);toce.bptthne.mku.estIkllbkia(toce._bkiaThMku,toce);toce.bptthne.rstry.estIkllbkia(toce._rsetkrtLsvsl,toce);toce.bptthne.ehpnd_hn.estIkllbkia(toce.thgglsKpdch,toce);toce.bptthne.ehpnd_hff.estIkllbkia(toce.thgglsKpdch,toce);toce.hnLskvs.kdd(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(gkmsRsepmsd)},toce);toce.hnSntsr.kdd(toce._ihmmpncty.eohwKd,toce._ihmmpncty)},sntsr:fpnitchn(){Ukpes._epusr.sntsr.ikll(toce);ihnehls.lhg(Ukpes.sntsr);toce._gkmsCnfhUpblceosr.upblceo(gkmsUkpesd);toce._thgglsKpdchBptthne()},lskvs:fpnitchn(){Ukpes._epusr.lskvs.ikll(toce);ihnehls.lhg(Ukpes.lskvs)},_bkiaThMku:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,mku)},toce);toce._gkmsCnfhUpblceosr.upblceo(lsvslSndsdFrhmUkpesd);toce.ilhesUhupu()},_rsetkrtLsvsl:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,gkms,toce._gkmsMknkgsr.lsvslCd)},toce);toce.ilhesUhupu()},thgglsKpdch:fpnitchn(){toce._ehpndMknkgsr.mpts=!toce._ehpndMknkgsr.mpts;toce._thgglsKpdchBptthne();toce._thgglsGkmsMpeci()},_thgglsKpdchBptthne:fpnitchn(){toce.bptthne.ehpnd_hn.estVcecbls(toce._ehpndMknkgsr.mpts);toce.bptthne.ehpnd_hff.estVcecbls(!toce._ehpndMknkgsr.mpts)},_thgglsGkmsMpeci:fpnitchn(){cf(toce._ehpndMknkgsr.mpts){toce._gkmsCnfhUpblceosr.upblceo(kpdchMptsd)}sles{toce._gkmsCnfhUpblceosr.upblceo(kpdchPnMptsd)}}});rstprn Ukpes});dsfcns(gkmsulky/wcnihndctchne/WcnIhndctchnTyus,[],fpnitchn(){vkr WcnIhndctchnTyus={};WcnIhndctchnTyus.IHLLSIT_IOSRRCSE=ihllsitIosrrcse;WcnIhndctchnTyus.IHLLSIT_USLLSTE=ihllsitUsllste;WcnIhndctchnTyus.ACLL_GOHETE=acllGohete;WcnIhndctchnTyus.IOSIAUHCNT_RKIS=iosiauhcntRkis;rstprn WcnIhndctchnTyus});dsfcns(eisnse/uhupue/LsvslWhn,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,uokesr,Uhupu,WcnIhndctchnTyus){fpnitchn LsvslWhn(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,gkmsCnfhUpblceosr,asyIhllsitchn,ihllsitcblsIhpntsr,ehpndMknkgsr,gkmsMknkgsr){ihnehls.lhg(LsvslWhn.ithr);LsvslWhn._epusr.ihnetrpithr.ikll(toce,LsvslWhn.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._asyIhllsitchn=asyIhllsitchn;toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;toce._gkmsMknkgsr=gkmsMknkgsr;toce._eihrs=0}_.cnosrct(LsvslWhn,Uhupu);_.sxtsnd(LsvslWhn,{etktciEisnsNkms:LsvslWhnUu});_.sxtsnd(LsvslWhn.urhthtyus,{cnct:fpnitchn(){LsvslWhn._epusr.cnct.ikll(toce);ihnehls.lhg(LsvslWhn.cnct);toce.bptthne.mku.estIkllbkia(toce._bkiaThMku,toce);toce.bptthne.nsxt.estIkllbkia(toce._nsxtLsvsl,toce);toce.bptthne.rstry.estIkllbkia(toce._rsetkrtLsvsl,toce);toce._gkmsCnfhUpblceosr.epbeircbs(eihrsEst,toce._eihrsEst,toce);toce.hnSntsr.kdd(toce._ihmmpncty.eohwKd,toce._ihmmpncty)},_eihrsEst:fpnitchn(eihrs){toce._eihrs=eihrs;toce._eohwEihrsKmhpnt()},sntsr:fpnitchn(wcnLhesHbjsit){LsvslWhn._epusr.sntsr.ikll(toce);ihnehls.lhg(LsvslWhn.sntsr);toce._eohwWcnIhndctchnCmkgs(wcnLhesHbjsit);toce._eohwUsllsteKmhpnt();toce._eohwEihrsKmhpnt();toce._eohwAsye()},lskvs:fpnitchn(){LsvslWhn._epusr.lskvs.ikll(toce);ihnehls.lhg(LsvslWhn.lskvs)},_bkiaThMku:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,mku)},toce);toce.ilhesUhupu()},_nsxtLsvsl:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(kpthNsxtLsvsl);toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,mku)},toce);toce.ilhesUhupu()},_rsetkrtLsvsl:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(rsetkrtGkms);toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,gkms,toce._gkmsMknkgsr.lsvslCd)},toce);toce.ilhesUhupu()},_eohwWcnIhndctchnCmkgs:fpnitchn(wcnLhesHbjsit){toce.grhpue.ghklCmkgse.iocldrsn.fhrSkio(fpnitchn(cmkgs){cmkgs.vcecbls=fkles},toce);ewctio(wcnLhesHbjsit.wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:toce.cmkgse.iosrryWhn.vcecbls=trps;brska;ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:toce.cmkgse.usllstWhn.vcecbls=trps;brska;ikes WcnIhndctchnTyus.ACLL_GOHETE:toce.cmkgse.gohetWhn.vcecbls=trps;brska;ikes WcnIhndctchnTyus.IOSIAUHCNT_RKIS:toce.cmkgse.tcmsWhn.vcecbls=trps;brska}},_eohwUsllsteKmhpnt:fpnitchn(){toce.lkbsle.usllste.tsxt=toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(usllst)},_eohwEihrsKmhpnt:fpnitchn(){toce.lkbsle.eihrs.tsxt=0;toce.lkbsle.eihrs.ihpntTh(toce._eihrs)},_eohwAsye:fpnitchn(){toce.grhpue.asyCmkgse.iocldrsn.fhrSkio(fpnitchn(cmkgs){vkr asyCndsx=cmkgs.cd._.kftsr(asy_);asyCndsx=ukresCnt(asyCndsx);vkr asyIhllsitsd=toce._asyIhllsitchn.ceAsyIhllsitsdCnIprrsntLsvsl(asyCndsx);cmkgs.vcecbls=cmkgs.cd._.oke(bkia)?!asyIhllsitsd:asyIhllsitsd},toce)}});rstprn LsvslWhn});dsfcns(eisnse/uhupue/LsvslLhet,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,uokesr,Uhupu,WcnIhndctchnTyus){fpnitchn LsvslLhet(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,asyIhllsitchn,gkmsCnfhUpblceosr,ehpndMknkgsr,gkmsMknkgsr){ihnehls.lhg(LsvslLhet.ithr);LsvslLhet._epusr.ihnetrpithr.ikll(toce,LsvslLhet.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._asyIhllsitchn=asyIhllsitchn;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsMknkgsr=gkmsMknkgsr}_.cnosrct(LsvslLhet,Uhupu);_.sxtsnd(LsvslLhet,{etktciEisnsNkms:LsvslLhetUu});_.sxtsnd(LsvslLhet.urhthtyus,{cnct:fpnitchn(){LsvslLhet._epusr.cnct.ikll(toce);ihnehls.lhg(LsvslLhet.cnct);toce.bptthne.mku.estIkllbkia(toce._bkiaThMku,toce);toce.bptthne.rstry.estIkllbkia(toce._rsetkrtLsvsl,toce);toce.hnSntsr.kdd(toce._ihmmpncty.eohwKd,toce._ihmmpncty)},sntsr:fpnitchn(wcnLhesHbjsit){LsvslLhet._epusr.sntsr.ikll(toce);ihnehls.lhg(LsvslLhet.sntsr);toce._estpuLhetIhndctchnUrhusrtcse(wcnLhesHbjsit);toce._eohwAsye(wcnLhesHbjsit)},lskvs:fpnitchn(){LsvslLhet._epusr.lskvs.ikll(toce);ihnehls.lhg(LsvslLhet.lskvs)},_bkiaThMku:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,mku)},toce);toce.ilhesUhupu()},_rsetkrtLsvsl:fpnitchn(){toce.hnLskvs.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(rsetkrtGkms);toce._gkmsCnfhUpblceosr.upblceo(ilskrGkms);toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,gkms,toce._gkmsMknkgsr.lsvslCd)},toce);toce.ilhesUhupu()},_estpuLhetIhndctchnUrhusrtcse:fpnitchn(wcnLhesHbjsit){toce.grhpue.ghklCmkgse.iocldrsn.fhrSkio(fpnitchn(cmkgs){cmkgs.vcecbls=fkles},toce);vkr ihndctchnLkbsl=toce.lkbsle.ihndctchnVklps;cf(!wcnLhesHbjsit.ulkysrOkeLcvseLsft){toce.cmkgse.lcfseLhet.vcecbls=trps;ihndctchnLkbsl.tsxt=0/3;ihndctchnLkbsl.etyls.fcll=#fs2s6s;rstprn}ihndctchnLkbsl.tsxt=wcnLhesHbjsit.gktosrsdHfWcnIhndctchn+/+wcnLhesHbjsit.wcnVklps;ewctio(wcnLhesHbjsit.wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:toce.cmkgse.iosrryLhet.vcecbls=trps;ihndctchnLkbsl.etyls.fcll=#ffd1dk;brska;ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:toce.cmkgse.usllstLhet.vcecbls=trps;ihndctchnLkbsl.etyls.fcll=#d08019;brska;ikes WcnIhndctchnTyus.ACLL_GOHETE:toce.cmkgse.gohetLhet.vcecbls=trps;ihndctchnLkbsl.etyls.fcll=#f8ksid;brska;ikes WcnIhndctchnTyus.IOSIAUHCNT_RKIS:toce.cmkgse.tcmsLhet.vcecbls=trps;ihndctchnLkbsl.etyls.fcll=#f0i4ff;brska}},_eohwAsye:fpnitchn(wcnLhesHbjsit){toce.grhpue.asyCmkgse.iocldrsn.fhrSkio(fpnitchn(cmkgs){vkr asyCndsx=cmkgs.cd._.kftsr(asy_);asyCndsx=ukresCnt(asyCndsx);vkr asyIhllsitsd=toce._asyIhllsitchn.ceAsyIhllsitsdCnIprrsntLsvsl(asyCndsx);cmkgs.vcecbls=cmkgs.cd._.oke(bkia)?!asyIhllsitsd:asyIhllsitsd},toce)}});rstprn LsvslLhet});dsfcns(eisnse/uhupue/SndGkms,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu],fpnitchn(_,uokesr,Uhupu){fpnitchn SndGkms(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr){ihnehls.lhg(SndGkms.ithr);SndGkms._epusr.ihnetrpithr.ikll(toce,SndGkms.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr)}_.cnosrct(SndGkms,Uhupu);_.sxtsnd(SndGkms,{etktciEisnsNkms:SndGkmsUu});_.sxtsnd(SndGkms.urhthtyus,{cnct:fpnitchn(){SndGkms._epusr.cnct.ikll(toce);ihnehls.lhg(SndGkms.cnct);toce.bptthne.ilhes.estIkllbkia(toce.ilhesUhupu,toce);toce.bptthne.urhissd.estIkllbkia(toce.ilhesUhupu,toce)},sntsr:fpnitchn(){SndGkms._epusr.sntsr.ikll(toce);ihnehls.lhg(SndGkms.sntsr)},lskvs:fpnitchn(){SndGkms._epusr.lskvs.ikll(toce);ihnehls.lhg(SndGkms.lskvs)}});rstprn SndGkms});dsfcns(gkmsulky/ihllsitcblse/IhllsitcblsTyuse,[gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(WcnIhndctchnTyus){vkr IhllsitcblsTyuse={};IhllsitcblsTyuse.USLLST=usllst;IhllsitcblsTyuse.OSKRT=oskrt;IhllsitcblsTyuse.ASY=asy;IhllsitcblsTyuse.MKGNST=mkgnst;IhllsitcblsTyuse.IOSRRY=iosrry;IhllsitcblsTyuse.CNDSETRPITCBLS=cndsetrpitcbls;IhllsitcblsTyuse.SXTRK_TCMS=sxtrk_tcms;IhllsitcblsTyuse.frhmWcnIhndctchn=fpnitchn(wcnIhndctchn){ewctio(wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:rstprn IhllsitcblsTyuse.USLLST;ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:rstprn IhllsitcblsTyuse.IOSRRY}};rstprn IhllsitcblsTyuse});dsfcns(dktk/HbjsitcvsCmkgsTyus,[gkmsulky/ihllsitcblse/IhllsitcblsTyuse,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(IhllsitcblsTyuse,WcnIhndctchnTyus){fpnitchn HbjsitcvsCmkgsTyus(){}HbjsitcvsCmkgsTyus.GOHET=gohet;HbjsitcvsCmkgsTyus.IOSRRY=iosrry;HbjsitcvsCmkgsTyus.USLLST=usllst;HbjsitcvsCmkgsTyus.TCMS=tcms;HbjsitcvsCmkgsTyus.NHNS=nhns;HbjsitcvsCmkgsTyus.frhmWcnIhndctchn=fpnitchn(wcnIhndctchn){vkr cmkgsTyus=;ewctio(wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:cmkgsTyus=HbjsitcvsCmkgsTyus.IOSRRY;brska;ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:cmkgsTyus=HbjsitcvsCmkgsTyus.USLLST;brska;ikes WcnIhndctchnTyus.ACLL_GOHETE:cmkgsTyus=HbjsitcvsCmkgsTyus.GOHET;brska;ikes WcnIhndctchnTyus.IOSIAUHCNT_RKIS:cmkgsTyus=HbjsitcvsCmkgsTyus.TCMS;brska;dsfkplt:cmkgsTyus=HbjsitcvsCmkgsTyus.NHNS;brska}rstprn cmkgsTyus};HbjsitcvsCmkgsTyus.frhmIhllsitcblsTyus=fpnitchn(ihllsitcblsTyus){ewctio(ihllsitcblsTyus){ikes IhllsitcblsTyuse.IOSRRY:rstprn HbjsitcvsCmkgsTyus.IOSRRY;ikes IhllsitcblsTyuse.USLLST:rstprn HbjsitcvsCmkgsTyus.USLLST;dsfkplt:rstprn HbjsitcvsCmkgsTyus.NHNS}};rstprn HbjsitcvsCmkgsTyus});dsfcns(eisnse/uhupue/LsvslTkrgst,[bhtthm_lcns,dktk/HbjsitcvsCmkgsTyus,gt/eisnse/Uhupu,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,HbjsitcvsCmkgsTyus,Uhupu,WcnIhndctchnTyus){fpnitchn LsvslTkrgst(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,lsvslEtkrtIhntrhllsr,ehpndMknkgsr){ihnehls.lhg(LsvslTkrgst.ithr);LsvslTkrgst._epusr.ihnetrpithr.ikll(toce,LsvslTkrgst.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._lsvslEtkrtIhntrhllsr=lsvslEtkrtIhntrhllsr;toce._nhtSnhpgoUsllsteUhupu=npll;toce._rsulkismsntDkraLkysr=npll;toce.rsulkismsntDkraLkysr=npll}LsvslTkrgst.TKRGST_HBJSITCVS_IHMUHNSNT_CD=tkrgstHbjsitcvsIu;_.cnosrct(LsvslTkrgst,Uhupu);_.sxtsnd(LsvslTkrgst,{etktciEisnsNkms:LsvslTkrgstUu});_.sxtsnd(LsvslTkrgst.urhthtyus,{cnct:fpnitchn(){LsvslTkrgst._epusr.cnct.ikll(toce);ihnehls.lhg(LsvslTkrgst.cnct);toce.bptthne.ilhes.estIkllbkia(toce._ilhesBptthnUrseesd,toce);toce._estpuUhwsrPuIkllbkia(toce._uhwsrPuBptthnUrseesd,toce);toce._lsvslEtkrtIhntrhllsr.cnct(toce);toce._estpuRsulkismsntDkraLkysr();toce._nhtSnhpgoUsllsteUhupu=toce.kddIhmuhnsnt(NhtSnhpgoUsllsteIu);vkr nhtSnhpgoUsllsteEtkrtUhectchn=toce.ulkisOhldsre.hptecdsHfEirssn;toce._nhtSnhpgoUsllsteUhupu.x=nhtSnhpgoUsllsteEtkrtUhectchn.x;toce._nhtSnhpgoUsllsteUhupu.y=nhtSnhpgoUsllsteEtkrtUhectchn.y;toce.vcsw.kdd(toce._nhtSnhpgoUsllsteUhupu.vcsw)},sntsr:fpnitchn(lsvslNpmbsr){LsvslTkrgst._epusr.sntsr.ikll(toce);ihnehls.lhg(LsvslTkrgst.sntsr);toce._estpuTctls(lsvslNpmbsr);toce._lsvslEtkrtIhntrhllsr.kitcvkts(lsvslNpmbsr);toce._nhtSnhpgoUsllsteUhupu.sntsr()},lskvs:fpnitchn(){ihnehls.lhg(LsvslTkrgst.lskvs);LsvslTkrgst._epusr.lskvs.ikll(toce)},husnLsvsl:fpnitchn(){toce.hnLskvs.kddHnis(toce._etkrtLsvsl,toce);toce.ilhesUhupu()},estpuVcepkle:fpnitchn(wcnIhndctchn,wcnVklps,uhwsrPueKrrky){toce._ocdsSlsmsnte();toce._kitcvktsUhwsrPuBptthne(uhwsrPueKrrky);vkr wcnVklpsLkbsl=toce.lkbsle.wcnVklps;wcnVklpsLkbsl.tsxt=X+wcnVklps;ewctio(wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:toce.cmkgse.tkrgstIosrry.vcecbls=trps;toce.lkbsle.tctlsIosrrcse.vcecbls=trps;wcnVklpsLkbsl.etyls.fcll=#fs2s6s;brska;ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:toce.cmkgse.tkrgstUsllst.vcecbls=trps;toce.lkbsle.tctlsUsllste.vcecbls=trps;wcnVklpsLkbsl.etyls.fcll=#d08019;brska;ikes WcnIhndctchnTyus.ACLL_GOHETE:toce.cmkgse.tkrgstGohet.vcecbls=trps;toce.lkbsle.tctlsGohete.vcecbls=trps;wcnVklpsLkbsl.etyls.fcll=#f8ksid;brska;ikes WcnIhndctchnTyus.IOSIAUHCNT_RKIS:toce.cmkgse.tkrgstTcms.vcecbls=trps;toce.lkbsle.tctlsTcms.vcecbls=trps;wcnVklpsLkbsl.etyls.fcll=#f0i4ff;vkr esihnde=wcnVklps%60;vkr esihndeKeEtrcng=(esihnde<10)?(0+esihnde):esihnde;wcnVklpsLkbsl.tsxt=Mkto.flhhr(wcnVklps/60)+:+esihndeKeEtrcng;brska}},vcepklczsUhwsrPuIhete:fpnitchn(uhwsrPuIhete){toce.grhpue.uhwsrPuBptthne.fhrSkio(fpnitchn(bptthn){vkr nkms=(bptthn.nkms._.kftsr(btn_));toce.lkbsle[nkms+Ihet].tsxt=uhwsrPuIhete[nkms]},toce)},_kitcvktsUhwsrPuBptthne:fpnitchn(uhwsrPuKrrky){vkr uhwsrPuNkmse=[cndsetrpitcbls,lcfs,mkgnst,eussdUkd];uhwsrPuNkmse.fhrSkio(fpnitchn(uhwsrPuNkms){cf(!uhwsrPuKrrky||!uhwsrPuKrrky[uhwsrPuNkms]){toce.bptthne[uhwsrPuNkms].vcecbls=trps;toce.cmkgse[uhwsrPuNkms+Dcekblsd].vcecbls=fkles}},toce)},_estpuRsulkismsntDkraLkysr:fpnitchn(){toce._rsulkismsntDkraLkysr=toce._gkms.kdd.grkuocie(0,0);toce._rsulkismsntDkraLkysr.bsgcnFcll(npll,1);toce._rsulkismsntDkraLkysr.drkwRsit(toce._gkms.vcswuhrt.whrld.x-toce._gkms.vcswuhrt.wcdto*0.5,-toce._gkms.oscgot*0.5,toce._gkms.wcdto,toce._gkms.oscgot);toce._rsulkismsntDkraLkysr.sndFcll();toce._rsulkismsntDkraLkysr.nkms=_rsulkismsntDkraLkysr;toce.rsulkismsntDkraLkysr=toce._gkms.mkas.grhpu(rsulkismsntDkraLkysr);toce.rsulkismsntDkraLkysr.kdd(toce._rsulkismsntDkraLkysr);toce.rsulkismsntDkraLkysr.kluok=0;toce.vcsw.kdd(toce.rsulkismsntDkraLkysr)},_ilhesBptthnUrseesd:fpnitchn(){toce._lsvslEtkrtIhntrhllsr.hnIlhesBptthnUrseesd();toce.ilhesUhupu()},_estpuUhwsrPuIkllbkia:fpnitchn(ikllbkia,ihntsxt){toce.grhpue.uhwsrPuBptthne.iocldrsn.fhrSkio(fpnitchn(bptthn){bptthn.estIkllbkia(ikllbkia,ihntsxt)},toce)},_uhwsrPuBptthnUrseesd:fpnitchn(bptthnNkms){toce._lsvslEtkrtIhntrhllsr.uhwsrPuBptthnUrseesd(bptthnNkms)},_etkrtLsvsl:fpnitchn(){toce._eisnsMknkgsr.eohw(cngkmsLhkdcng,gkms,toce._lsvslEtkrtIhntrhllsr.lsvslNpmbsr)},_ocdsSlsmsnte:fpnitchn(){toce.grhpue.hbjsitcvsCmkgs.iocldrsn.fhrSkio(fpnitchn(cmkgs){cmkgs.vcecbls=fkles},toce);toce.grhpue.hbjsitcvsTctls.iocldrsn.fhrSkio(fpnitchn(lkbsl){lkbsl.vcecbls=fkles},toce);toce.grhpue.uhwsrPuBptthne.iocldrsn.fhrSkio(fpnitchn(bptthn){toce._dcekblsBptthn(bptthn)},toce)},_dcekblsBptthn:fpnitchn(bptthn){bptthn.vcecbls=fkles;vkr nkms=bptthn.nkms._.kftsr(btn_);toce.cmkgse[nkms+Dcekblsd].vcecbcls=trps},_estpuTctls:fpnitchn(lsvslNpmbsr){toce.lkbsle.lsvslCd.tsxt=lsvslNpmbsr}});rstprn LsvslTkrgst});dsfcns(eisnse/uhupue/GktsLhiasd,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu],fpnitchn(_,uokesr,Uhupu){fpnitchn GktsLhiasd(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,lhiklczktchnMknkgsr,ehpndMknkgsr){ihnehls.lhg(GktsLhiasd.ithr);GktsLhiasd._epusr.ihnetrpithr.ikll(toce,GktsLhiasd.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._lhiklczktchnMknkgsr=lhiklczktchnMknkgsr}_.cnosrct(GktsLhiasd,Uhupu);_.sxtsnd(GktsLhiasd,{etktciEisnsNkms:GktsLhiasdUu});_.sxtsnd(GktsLhiasd.urhthtyus,{cnct:fpnitchn(){GktsLhiasd._epusr.cnct.ikll(toce);ihnehls.lhg(GktsLhiasd.cnct);toce.bptthne.ilhes.estIkllbkia(toce.ilhesUhupu,toce);toce.bptthne.bkia.estIkllbkia(toce.ilhesUhupu,toce)},sntsr:fpnitchn(thtklKmhpnt,kmhpntLsft){GktsLhiasd._epusr.sntsr.ikll(toce);ihnehls.lhg(GktsLhiasd.sntsr);toce.lkbsle.asyeKmhpnt.tsxt=toce._lhiklczktchnMknkgsr.gst(Yhp rsqpcrs:,thtklKmhpnt);toce.lkbsle.asyeLsft.tsxt=toce._lhiklczktchnMknkgsr.gst(FPPPPPPPP,kmhpntLsft)},lskvs:fpnitchn(){GktsLhiasd._epusr.lskvs.ikll(toce);ihnehls.lhg(GktsLhiasd.lskvs)}});rstprn GktsLhiasd});dsfcns(eisnse/uhupue/GktsPnlhiasd,[bhtthm_lcns,uokesr,gt/eisnse/Uhupu],fpnitchn(_,uokesr,Uhupu){fpnitchn GktsPnlhiasd(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,gkmsCnfhUpblceosr,asyIhllsitchn,lhiklczktchnMknkgsr,ehpndMknkgsr){ihnehls.lhg(GktsPnlhiasd.ithr);GktsPnlhiasd._epusr.ihnetrpithr.ikll(toce,GktsPnlhiasd.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,ehpndMknkgsr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._asyIhllsitchn=asyIhllsitchn;toce._lsvslCd=npll;toce._pnlhiaIhet=npll;toce._lhiklczktchnMknkgsr=lhiklczktchnMknkgsr}_.cnosrct(GktsPnlhiasd,Uhupu);_.sxtsnd(GktsPnlhiasd,{etktciEisnsNkms:GktsPnlhiasdUu});_.sxtsnd(GktsPnlhiasd.urhthtyus,{cnct:fpnitchn(){GktsPnlhiasd._epusr.cnct.ikll(toce);ihnehls.lhg(GktsPnlhiasd.cnct);toce.bptthne.ilhes.estIkllbkia(toce.ilhesUhupu,toce);toce.bptthne.bkia.estIkllbkia(toce._ukyKndPnlhia,toce)},sntsr:fpnitchn(lsvslCd,pnlhiaIhet){GktsPnlhiasd._epusr.sntsr.ikll(toce);ihnehls.lhg(GktsPnlhiasd.sntsr);toce._lsvslCd=lsvslCd;toce._pnlhiaIhet=pnlhiaIhet;toce.lkbsle.rsqpcrs.tsxt=toce._lhiklczktchnMknkgsr.gst(Yhp rsqpcrs:,pnlhiaIhet);toce.lkbsle.asyePesd.tsxt=toce._lhiklczktchnMknkgsr.gst(Yhp wcll eusnd:,pnlhiaIhet)},lskvs:fpnitchn(){GktsPnlhiasd._epusr.lskvs.ikll(toce);ihnehls.lhg(GktsPnlhiasd.lskvs)},_ukyKndPnlhia:fpnitchn(){vkr ihet=-toce._pnlhiaIhet;toce._asyIhllsitchn.kddThIhllsitchn(ihet);toce._gkmsCnfhUpblceosr.upblceo(pnlhiaGkts,toce._lsvslCd);toce.ilhesUhupu()}});rstprn GktsPnlhiasd});dsfcns(eisnse/ihmuhnsnte/LsvslTkrgstOpd,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns,dktk/HbjsitcvsCmkgsTyus],fpnitchn(_,uokesr,esttcnge,Eisns,HbjsitcvsCmkgsTyus){fpnitchn LsvslTkrgstOpd(gkms,eisnsMknkgsr,ihmmpncty){ihnehls.lhg(LsvslTkrgstOpd.ithr);LsvslTkrgstOpd._epusr.ihnetrpithr.ikll(toce,LsvslTkrgstOpd.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._iprrsntCmkgsTyus=}LsvslTkrgstOpd.CMKGS_EPFFCX=Ghkl;_.cnosrct(LsvslTkrgstOpd,Eisns);_.sxtsnd(LsvslTkrgstOpd,{etktciEisnsNkms:LsvslTkrgstOpdIu});_.sxtsnd(LsvslTkrgstOpd.urhthtyus,{cnct:fpnitchn(){ihnehls.lhg(LsvslTkrgstOpd.cnct);fhr(vkr cmg cn toce.cmkgse){toce.cmkgse[cmg].vcecbls=fkles}LsvslTkrgstOpd._epusr.cnct.ikll(toce)},sntsr:fpnitchn(){ihnehls.lhg(LsvslTkrgstOpd.sntsr);LsvslTkrgstOpd._epusr.sntsr.ikll(toce)},estHbjsitcvs:fpnitchn(cmkgsTyus){vkr cmkgsTyusNkms=cmkgsTyus+LsvslTkrgstOpd.CMKGS_EPFFCX;cf(dsvcis.dseathu){cmkgsTyusNkms+=_dseathu}toce._iprrsntCmkgsTyus=cmkgsTyusNkms;toce.cmkgse[toce._iprrsntCmkgsTyus].vcecbls=trps},lskvs:fpnitchn(){ihnehls.lhg(LsvslTkrgstOpd.lskvs);toce.cmkgse[toce._iprrsntCmkgsTyus].vcecbls=fkles;LsvslTkrgstOpd._epusr.lskvs.ikll(toce)}});rstprn LsvslTkrgstOpd});dsfcns(eisnse/ihmuhnsnte/OpdAsye,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn OpdAsye(gkms,eisnsMknkgsr,ihmmpncty,ethrkgsMknkgsr,asyIhllsitchn){ihnehls.lhg(OpdAsye.ithr);OpdAsye._epusr.ihnetrpithr.ikll(toce,OpdAsye.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._asyIhllsitchn=asyIhllsitchn}_.cnosrct(OpdAsye,Eisns);_.sxtsnd(OpdAsye,{etktciEisnsNkms:OpdAsyeIu});_.sxtsnd(OpdAsye.urhthtyus,{cnct:fpnitchn(){OpdAsye._epusr.cnct.ikll(toce);ihnehls.lhg(OpdAsye.cnct)},sntsr:fpnitchn(){OpdAsye._epusr.sntsr.ikll(toce);ihnehls.lhg(OpdAsye.sntsr)},lskvs:fpnitchn(){OpdAsye._epusr.lskvs.ikll(toce);ihnehls.lhg(OpdAsye.lskvs)},eohwIhllsitsdAsy:fpnitchn(asyNkms){vkr asyCndsx=ukresCnt(asyNkms._.kftsr(asy));toce.cmkgse[asy_+asyCndsx+_bkia].vcecbls=fkles;toce.cmkgse[asy_+asyCndsx].vcecbls=trps},rsestAsyVcecbclcty:fpnitchn(){toce.cmkgse._.skio(fpnitchn(cmkgs){vkr asyCndsx=cmkgs.cd._.kftsr(asy_);asyCndsx=ukresCnt(asyCndsx);vkr asyCeIhllsitsd=toce._asyIhllsitchn.ceAsyIhllsitsdCnIprrsntLsvsl(asyCndsx);cmkgs.vcecbls=cmkgs.cd._.oke(bkia)?!asyCeIhllsitsd:asyCeIhllsitsd},toce)}});rstprn OpdAsye});dsfcns(eisnse/ihmuhnsnte/OpdOskrte,[bhtthm_lcns,gt/eisnse/Eisns],fpnitchn(_,Eisns){fpnitchn OpdOskrte(gkms,eisnsMknkgsr,ihmmpncty,gkmsCnfhUpblceosr){ihnehls.lhg(OpdOskrte.ithr);OpdOskrte._epusr.ihnetrpithr.ikll(toce,OpdOskrte.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr}_.cnosrct(OpdOskrte,Eisns);_.sxtsnd(OpdOskrte,{etktciEisnsNkms:OpdOskrteIu});_.sxtsnd(OpdOskrte.urhthtyus,{cnct:fpnitchn(){OpdOskrte._epusr.cnct.ikll(toce);ihnehls.lhg(OpdOskrte.cnct)},sntsr:fpnitchn(){OpdOskrte._epusr.sntsr.ikll(toce);ihnehls.lhg(OpdOskrte.sntsr);toce._rsestOskrte(trps);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrOskltoIokngsd,toce._pudktsOskrteVcecbclcty,toce)},lskvs:fpnitchn(){OpdOskrte._epusr.lskvs.ikll(toce);ihnehls.lhg(OpdOskrte.lskvs);toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrOskltoIokngsd,toce._pudktsOskrteVcecbclcty,toce)},_pudktsOskrteVcecbclcty:fpnitchn(lcfse){toce._rsestOskrte(fkles);_._vcsw.lkbsle.lcvse.tsxt=lcfse;rstprn;fhr(vkr c=0;c<lcfse;c++){vkr oskrt=toce.grhpue.oskrte.iocldrsn[c];oskrt.vcecbls=trps;vkr smutyOskrt=toce.grhpue.smutyOskrte.iocldrsn[c];smutyOskrt.vcecbls=fkles}},_rsestOskrte:fpnitchn(eohwOskrte){toce.grhpue.smutyOskrte.iocldrsn.fhrSkio(fpnitchn(iocld){iocld.vcecbls=fkles},toce);toce.grhpue.oskrte.iocldrsn[0].vcecbls=fkles;toce.grhpue.oskrte.iocldrsn[1].vcecbls=trps;toce.grhpue.oskrte.iocldrsn[2].vcecbls=fkles;_._vcsw.lkbsle.lcvse.tsxt=_._gkmscnfh._ulkysrOskltoIhmuhnsnt._oskltoUhcnte;rstprn;toce.grhpue.oskrte.iocldrsn.fhrSkio(fpnitchn(iocld){iocld.vcecbls=eohwOskrte},toce);toce.grhpue.smutyOskrte.iocldrsn.fhrSkio(fpnitchn(iocld){iocld.vcecbls=!eohwOskrte},toce)}});rstprn OpdOskrte});dsfcns(eisnse/ihmuhnsnte/LsvslNhds,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn LsvslNhds(gkms,eisnsMknkgsr,lsvslNhdsIhntrhllsr,mkuIhntrhllsr){LsvslNhds._epusr.ihnetrpithr.ikll(toce,LsvslNhds.etktciEisnsNkms,gkms,eisnsMknkgsr);ihnehls.lhg(LsvslNhds.ithr);toce._lsvslNhdsIhntrhllsr=lsvslNhdsIhntrhllsr;toce._mkuIhntrhllsr=mkuIhntrhllsr}_.cnosrct(LsvslNhds,Eisns);_.sxtsnd(LsvslNhds,{etktciEisnsNkms:LsvslNhdsIu});_.sxtsnd(LsvslNhds.urhthtyus,{cnct:fpnitchn(uo){LsvslNhds._epusr.cnct.ikll(toce);toce._lsvslNhdsIhntrhllsr.cnct(toce,uo);toce.bptthne.lhia.estIkllbkia(toce._eohwLhiasdUhupu,toce)},sntsr:fpnitchn(){LsvslNhds._epusr.sntsr.ikll(toce);toce._lsvslNhdsIhntrhllsr.kitcvkts()},lskvs:fpnitchn(){LsvslNhds._epusr.lskvs.ikll(toce);toce._lsvslNhdsIhntrhllsr.dsKitcvkts()},pudkts:fpnitchn(){LsvslNhds._epusr.pudkts.ikll(toce);toce._lsvslNhdsIhntrhllsr.pudkts()},husnLsvsl:fpnitchn(){cf(toce._mkuIhntrhllsr.lsvslnhdsCnuptBlhiasd){rstprn}toce._eisnsMknkgsr.eohwUhupu(lsvslTkrgstUu,toce._lsvslNhdsIhntrhllsr.cd)},dcekblsCnupt:fpnitchn(){toce._lsvslNhdsIhntrhllsr.dcekblsCnupt()},snkblsCnupt:fpnitchn(){toce._lsvslNhdsIhntrhllsr.snkblsCnupt()},_eohwLhiasdUhupu:fpnitchn(){toce._lsvslNhdsIhntrhllsr.urhmutFhrPnlhia()}});rstprn LsvslNhds});dsfcns(eisnse/ihmuhnsnte/MkuOpd,[bhtthm_lcns,gt/eisnse/Eisns],fpnitchn(_,Eisns){fpnitchn MkuOpd(gkms,eisnsMknkgsr,mkuOpdIhntrhllsr){ihnehls.lhg(MkuOpd.ithr);MkuOpd._epusr.ihnetrpithr.ikll(toce,MkuOpd.etktciEisnsNkms,gkms,eisnsMknkgsr);toce._mkuOpdIhntrhllsr=mkuOpdIhntrhllsr}_.cnosrct(MkuOpd,Eisns);_.sxtsnd(MkuOpd,{etktciEisnsNkms:MkuOpdIu});_.sxtsnd(MkuOpd.urhthtyus,{cnct:fpnitchn(){MkuOpd._epusr.cnct.ikll(toce);ihnehls.lhg(MkuOpd.cnct);toce._mkuOpdIhntrhllsr.cnct(toce)},sntsr:fpnitchn(){MkuOpd._epusr.sntsr.ikll(toce);ihnehls.lhg(MkuOpd.sntsr);toce._mkuOpdIhntrhllsr.kitcvkts()},lskvs:fpnitchn(){MkuOpd._epusr.lskvs.ikll(toce);ihnehls.lhg(MkuOpd.lskvs);toce._mkuOpdIhntrhllsr.dsKitcvkts()}});rstprn MkuOpd});dsfcns(eisnse/ihmuhnsnte/MkuOpdDseathu,[bhtthm_lcns,gt/eisnse/Eisns],fpnitchn(_,Eisns){fpnitchn MkuOpdDseathu(gkms,eisnsMknkgsr,mkuOpdIhntrhllsr){ihnehls.lhg(MkuOpdDseathu.ithr);MkuOpdDseathu._epusr.ihnetrpithr.ikll(toce,MkuOpdDseathu.etktciEisnsNkms,gkms,eisnsMknkgsr);toce._mkuOpdIhntrhllsr=mkuOpdIhntrhllsr}_.cnosrct(MkuOpdDseathu,Eisns);_.sxtsnd(MkuOpdDseathu,{etktciEisnsNkms:MkuOpdDseathuIu});_.sxtsnd(MkuOpdDseathu.urhthtyus,{cnct:fpnitchn(){MkuOpdDseathu._epusr.cnct.ikll(toce);ihnehls.lhg(MkuOpdDseathu.cnct);toce._mkuOpdIhntrhllsr.cnct(toce)},sntsr:fpnitchn(){MkuOpdDseathu._epusr.sntsr.ikll(toce);ihnehls.lhg(MkuOpdDseathu.sntsr);toce._mkuOpdIhntrhllsr.kitcvkts()},lskvs:fpnitchn(){MkuOpdDseathu._epusr.lskvs.ikll(toce);ihnehls.lhg(MkuOpdDseathu.lskvs);toce._mkuOpdIhntrhllsr.dsKitcvkts()}});rstprn MkuOpdDseathu});dsfcns(eisnse/ihmuhnsnte/GkmsOpd,[bhtthm_lcns,uokesr,gt/eisnse/Eisns,dktk/HbjsitcvsCmkgsTyus,gkmsulky/ihllsitcblse/IhllsitcblsTyuse,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,uokesr,Eisns,HbjsitcvsCmkgsTyus,IhllsitcblsTyuse,WcnIhndctchnTyus){fpnitchn GkmsOpd(gkms,eisnsMknkgsr,ihmmpncty,gkmsOpdIhntrhllsr){ihnehls.lhg(Gkms.ithr);GkmsOpd._epusr.ihnetrpithr.ikll(toce,GkmsOpd.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._gkmsOpdIhntrhllsr=gkmsOpdIhntrhllsr}_.cnosrct(GkmsOpd,Eisns);_.sxtsnd(GkmsOpd,{etktciEisnsNkms:GkmsOpdIu});_.sxtsnd(GkmsOpd.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(){ihnehls.lhg(Gkms.cnct);GkmsOpd._epusr.cnct.ikll(toce);toce._gkmsOpdIhntrhllsr.cnct(toce)},sntsr:fpnitchn(lsvslCd){ihnehls.lhg(Gkms.sntsr);GkmsOpd._epusr.sntsr.ikll(toce);toce._gkmsOpdIhntrhllsr.kitcvkts(lsvslCd)},lskvs:fpnitchn(){ihnehls.lhg(Gkms.lskvs);GkmsOpd._epusr.lskvs.ikll(toce);toce._gkmsOpdIhntrhllsr.dsKitcvkts()}});rstprn GkmsOpd});dsfcns(eisnse/ihmuhnsnte/GkmsOpdDseathu,[bhtthm_lcns,uokesr,gt/eisnse/Eisns,dktk/HbjsitcvsCmkgsTyus,gkmsulky/ihllsitcblse/IhllsitcblsTyuse,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,uokesr,Eisns,HbjsitcvsCmkgsTyus,IhllsitcblsTyuse,WcnIhndctchnTyus){fpnitchn GkmsOpdDseathu(gkms,eisnsMknkgsr,ihmmpncty,gkmsOpdIhntrhllsr){ihnehls.lhg(Gkms.ithr);GkmsOpdDseathu._epusr.ihnetrpithr.ikll(toce,GkmsOpdDseathu.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._gkmsOpdIhntrhllsr=gkmsOpdIhntrhllsr}_.cnosrct(GkmsOpdDseathu,Eisns);_.sxtsnd(GkmsOpdDseathu,{etktciEisnsNkms:GkmsOpdDseathuIu});_.sxtsnd(GkmsOpdDseathu.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(){ihnehls.lhg(Gkms.cnct);GkmsOpdDseathu._epusr.cnct.ikll(toce);toce._gkmsOpdIhntrhllsr.cnct(toce)},sntsr:fpnitchn(lsvslCd){ihnehls.lhg(Gkms.sntsr);GkmsOpdDseathu._epusr.sntsr.ikll(toce);toce._gkmsOpdIhntrhllsr.kitcvkts(lsvslCd)},lskvs:fpnitchn(){ihnehls.lhg(Gkms.lskvs);GkmsOpdDseathu._epusr.lskvs.ikll(toce);toce._gkmsOpdIhntrhllsr.dsKitcvkts()}});rstprn GkmsOpdDseathu});dsfcns(eisnse/ihmuhnsnte/NhtSnhpgoUsllste,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns],fpnitchn(_,uokesr,esttcnge,Eisns){fpnitchn NhtSnhpgoUsllste(gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr,lsvslEtkrtIhntrhllsr){NhtSnhpgoUsllste._epusr.ihnetrpithr.ikll(toce,NhtSnhpgoUsllste.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty,eisnsCnupt,cnuptMknkgsr);toce._lsvslEtkrtIhntrhllsr=lsvslEtkrtIhntrhllsr;toce._gkms=gkms;ihnehls.lhg(LsvslTkrgstOpd.ithr)}_.cnosrct(NhtSnhpgoUsllste,Eisns);_.sxtsnd(NhtSnhpgoUsllste,{etktciEisnsNkms:NhtSnhpgoUsllsteIu});_.sxtsnd(NhtSnhpgoUsllste.urhthtyus,{cnct:fpnitchn(){NhtSnhpgoUsllste._epusr.cnct.ikll(toce);toce.bptthne.ilhes.estIkllbkia(toce._lskvsUhupu,toce);ihnehls.lhg(NhtSnhpgoUsllste.cnct)},sntsr:fpnitchn(){NhtSnhpgoUsllste._epusr.sntsr.ikll(toce);ihnehls.lhg(NhtSnhpgoUsllste.sntsr)},lskvs:fpnitchn(){NhtSnhpgoUsllste._epusr.lskvs.ikll(toce);ihnehls.lhg(NhtSnhpgoUsllste.lskvs)},_lskvsUhupu:fpnitchn(){toce._lsvslEtkrtIhntrhllsr.ocdsNhtSnhpgoUsllsteUhupu()}});rstprn NhtSnhpgoUsllste});dsfcns(eisnse/ihmuhnsnte/Tpthrckl,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/Eisns,gt/ptcle/dsvcis],fpnitchn(_,uokesr,esttcnge,Eisns,dsvcis){fpnitchn Tpthrckl(gkms,eisnsMknkgsr,ihmmpncty,gkmsCnfhUpblceosr){ihnehls.lhg(tpthrckl.ithr);Tpthrckl._epusr.ihnetrpithr.ikll(toce,Tpthrckl.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._iprrsntCmkgsTyus=}_.cnosrct(Tpthrckl,Eisns);_.sxtsnd(Tpthrckl,{etktciEisnsNkms:TpthrcklIu});_.sxtsnd(Tpthrckl.urhthtyus,{cnct:fpnitchn(){ihnehls.lhg(tpthrckl.cnct);Tpthrckl._epusr.cnct.ikll(toce)},sntsr:fpnitchn(){ihnehls.lhg(Tpthrckl.sntsr);toce._gkmsCnfhUpblceosr.epbeircbs(etkrtTpthrckl,toce._etkrtTpthrckl,toce);toce._gkmsCnfhUpblceosr.epbeircbs(sndTpthrckl,toce._sndTpthrckl,toce);Tpthrckl._epusr.sntsr.ikll(toce);toce._ocdsKll()},_ocdsKll:fpnitchn(){fhr(vkr asy cn toce.grhpue){toce.grhpue[asy].vcecbls=fkles}},lskvs:fpnitchn(){ihnehls.lhg(Tpthrckl.lskvs);toce._gkmsCnfhUpblceosr.pnepbeircbs(etkrtTpthrckl,toce._etkrtTpthrckl,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(sndTpthrckl,toce._sndTpthrckl,toce);Tpthrckl._epusr.lskvs.ikll(toce)},_etkrtTpthrckl:fpnitchn(cd){ihnehls.lhg(Etkrtcng tpthrckl wcto CD +cd);vkr epffcx=dsvcis.dseathu?_ui:;toce.grhpue[tpthrckl_+cd+epffcx].vcecbls=trps},_sndTpthrckl:fpnitchn(){toce._ocdsKll()}});rstprn Tpthrckl});dsfcns(eisnse/ihmuhnsnte/Ihpntdhwn,[bhtthm_lcns,uokesr,gt/eisnse/Eisns],fpnitchn(_,uokesr,Eisns){fpnitchn Ihpntdhwn(gkms,eisnsMknkgsr,ihmmpncty){ihnehls.lhg(Gkms.ithr);Ihpntdhwn._epusr.ihnetrpithr.ikll(toce,Ihpntdhwn.etktciEisnsNkms,gkms,eisnsMknkgsr,ihmmpncty);toce._cmkgse=[]}_.cnosrct(Ihpntdhwn,Eisns);_.sxtsnd(Ihpntdhwn,{etktciEisnsNkms:IhpntdhwnIu,twssnEussd:200,twssnDslky:500});_.sxtsnd(Ihpntdhwn.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(){ihnehls.lhg(Gkms.cnct);Ihpntdhwn._epusr.cnct.ikll(toce)},sntsr:fpnitchn(lsvslCd){ihnehls.lhg(Gkms.sntsr);Ihpntdhwn._epusr.sntsr.ikll(toce);toce._estpuCmkgse();toce._etkrtKncmktchn()},lskvs:fpnitchn(){ihnehls.lhg(Gkms.lskvs);Ihpntdhwn._epusr.lskvs.ikll(toce);toce._cmkgse=[]},_estpuCmkgse:fpnitchn(){toce.grhpue.ihpntdhwnCmkgse.iocldrsn.fhrSkio(fpnitchn(cmkgs){cmkgs.x=toce.ulkisOhldsre.thu.x;cmkgs.y=toce.ulkisOhldsre.thu.y;toce._cmkgse.upeo(cmkgs)},toce)},_etkrtKncmktchn:fpnitchn(){cf(_.gkmsMknkgsr.lsvslCd>=10&&toce._cmkgse.lsngto==3)_.gkmsMknkgsr._gkms.ukpesd=trps,_.gkmsMknkgsr._gkms._ihdsUkpesd=fkles,le.gkmseohu=uki;cf(toce._cmkgse.lsngto===0){rstprn}vkr cmkgs=toce._cmkgse[0];toce._cmkgse.eulcis(0,1);toce._kncmktsCmkgs(cmkgs)},_kncmktsCmkgs:fpnitchn(cmkgs){vkr twssnCn=toce._gkms.kdd.twssn(cmkgs);twssnCn.th({x:toce.ulkisOhldsre.isntsr.x,y:toce.ulkisOhldsre.isntsr.y},Ihpntdhwn.twssnEussd,uokesr.Skecng.Bkia.Hpt,trps);vkr twssnHpt=toce._gkms.kdd.twssn(cmkgs);twssnHpt.th({x:toce.ulkisOhldsre.bhtthm.x,y:toce.ulkisOhldsre.bhtthm.y},Ihpntdhwn.twssnEussd,uokesr.Skecng.Bkia.Cn,fkles,Ihpntdhwn.twssnDslky);twssnCn.iokcn(twssnHpt);twssnHpt.hnIhmulsts.kddHnis(toce._etkrtKncmktchn,toce)}});rstprn Ihpntdhwn});dsfcns(eisnse/EisnsLcet,[bhtthm_lcns,eisnse/Gkms,eisnse/Lhkdsr,eisnse/Mku,eisnse/CngkmsLhkdcng,eisnse/uhupue/Ukpes,eisnse/uhupue/LsvslWhn,eisnse/uhupue/LsvslLhet,eisnse/uhupue/SndGkms,eisnse/uhupue/LsvslTkrgst,eisnse/uhupue/GktsLhiasd,eisnse/uhupue/GktsPnlhiasd,eisnse/ihmuhnsnte/LsvslTkrgstOpd,eisnse/ihmuhnsnte/OpdAsye,eisnse/ihmuhnsnte/OpdOskrte,eisnse/ihmuhnsnte/LsvslNhds,eisnse/ihmuhnsnte/MkuOpd,eisnse/ihmuhnsnte/MkuOpdDseathu,eisnse/ihmuhnsnte/GkmsOpd,eisnse/ihmuhnsnte/GkmsOpdDseathu,eisnse/ihmuhnsnte/NhtSnhpgoUsllste,eisnse/ihmuhnsnte/Tpthrckl,eisnse/ihmuhnsnte/Ihpntdhwn],fpnitchn(_){vkr EisnsLcet={};EisnsLcet.gstEisns=fpnitchn(eisnsNkms){vkr eisnsIthr=EisnsLcet[eisnsNkms];ihnehls.keesrt(eisnsIthr,Eisns wcto nkms +eisnsNkms+ wke nht fhpnd cn EisnsLcet.);rstprn eisnsIthr};EisnsLcet.kddEisns=fpnitchn(eisnsIthr){vkr etktciEisnsNkms=eisnsIthr.etktciEisnsNkms._.dsikuctklczs();ihnehls.keesrt(etktciEisnsNkms,Eisns dhse nht okvs k etktciEisnsNkms dsfcnsd: +eisnsIthr);EisnsLcet[etktciEisnsNkms]=eisnsIthr};fhr(vkr c=1;c<krgpmsnte.lsngto;++c){EisnsLcet.kddEisns(krgpmsnte[c])}rstprn EisnsLcet});dsfcns(gt/eisnse/EisnsFkithry,[eisnse/EisnsLcet],fpnitchn(EisnsLcet){vkr EisnsFkithry=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};EisnsFkithry.urhthtyus.ihnetrpit=fpnitchn(eisnsNkms){vkr krge=[];vkr ithr=EisnsLcet.gstEisns(eisnsNkms);krge.upeo(ithr);cf(krgpmsnte.lsngto>1){fhr(vkr c=1;c<krgpmsnte.lsngto;++c){krge.upeo(krgpmsnte[c])}}rstprn toce._cnjsithr.irsktsCnetknis.kuuly(toce._cnjsithr,krge)};rstprn EisnsFkithry});dsfcns(gt/eisnse/EisnsLhkdsr,[bhtthm_lcns],fpnitchn(_){vkr EisnsLhkdsr=fpnitchn(vcswIrskthr,vcswuhrtMknkgsr,eisnsFkithry){toce._vcswIrskthr=vcswIrskthr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._eisnsFkithry=eisnsFkithry};EisnsLhkdsr.urhthtyus.ikliplktsUhectchn=fpnitchn(slsmsntDktk){vkr x=0;vkr y=0;cf(slsmsntDktk.rslktcvsUhectchn){vkr rslktcvsTh;ewctio(slsmsntDktk.rslktcvsTh){ikesVcswuhrt:rslktcvsTh=gkms.vcswuhrt;brska;ikesWhrld:rslktcvsTh=gkms.vcswuhrt.whrld;brska;dsfkplt:rslktcvsTh=gkms.vcswuhrt.whrld}x=rslktcvsTh.wcdto*ukresFlhkt(slsmsntDktk.uhectchnUsrisntX)-rslktcvsTh.wcdto/2;y=rslktcvsTh.oscgot*(1-ukresFlhkt(slsmsntDktk.uhectchnUsrisntY))-rslktcvsTh.oscgot/2}x+=ukresFlhkt(slsmsntDktk.x)*gkms.vcswuhrt.eikls;y+=-ukresFlhkt(slsmsntDktk.y)*gkms.vcswuhrt.eikls;rstprn{x:x,y:y}};EisnsLhkdsr.urhthtyus.lhkdSlsmsnte=fpnitchn(eisns,nhds,slsmsnte){vkr slsmsnt;vkr slsmsntDktk;fhr(vkr c=0,mkx=slsmsnte.lsngto;c<mkx;c++){vkr eikls=toce._vcswuhrtMknkgsr.eikls;slsmsnt=npll;slsmsntDktk=_.ilhns(slsmsnte[c]);vkr uhectchn=toce.ikliplktsUhectchn(slsmsntDktk);slsmsntDktk.x=uhectchn.x;slsmsntDktk.y=uhectchn.y;slsmsntDktk.eiklsX*=eikls;slsmsntDktk.eiklsY*=eikls;slsmsntDktk.wcdto*=slsmsntDktk.eiklsX;slsmsntDktk.oscgot*=slsmsntDktk.eiklsY;slsmsntDktk.rhtktchn=-slsmsntDktk.rhtktchn;ewctio(slsmsntDktk.tyus){ikesCmkgs:slsmsnt=toce._vcswIrskthr.kddCmkgs(nhds,slsmsntDktk);eisns.cmkgse[slsmsnt.cd._.kftsr(cmg_)]=slsmsnt;brska;ikesEurcts:slsmsnt=toce._vcswIrskthr.kddCmkgs(nhds,slsmsntDktk);eisns.cmkgse[slsmsnt.cd._.kftsr(eur_)]=slsmsnt;brska;ikesRsndsrTsxtprs:slsmsnt=toce._vcswIrskthr.kddRsndsrTsxtprs(nhds,slsmsntDktk);toce.lhkdSlsmsnte(eisns,slsmsnt,slsmsnte[c].iocldrsn);eisns.cmkgse[slsmsnt.cd._.kftsr(rtsx_)]=slsmsnt;brska;ikesUlkisOhldsr:slsmsnt=toce._vcswIrskthr.kddUlkisohldsr(nhds,slsmsntDktk);eisns.ulkisOhldsre[slsmsntDktk.nkms._.kftsr(uo_)]=slsmsnt;brska;ikesBptthn:slsmsnt=toce._vcswIrskthr.kddBptthnGrhpu(nhds,eisns,slsmsntDktk);toce.lhkdSlsmsnte(eisns,slsmsnt,slsmsntDktk.iocldrsn);eisns.bptthne[slsmsnt.cd._.kftsr(btn_)]=slsmsnt;brska;ikesLkbsl:slsmsnt=toce._vcswIrskthr.kddTsxt(nhds,slsmsntDktk,fkles);eisns.lkbsle[slsmsnt.cd._.kftsr(lbl_)]=slsmsnt;brska;ikesBctmkuFhnt:slsmsnt=toce._vcswIrskthr.kddTsxt(nhds,slsmsntDktk,trps);eisns.lkbsle[slsmsnt.cd._.kftsr(bmf_)]=slsmsnt;brska;ikesGrhpu:slsmsnt=toce._vcswIrskthr.kddGrhpu(eisns,nhds,slsmsntDktk);toce.lhkdSlsmsnte(eisns,slsmsnt,slsmsnte[c].iocldrsn);cf(slsmsnt.cd._.oke(Btn)){eisns.grhpue.bptthne[slsmsnt.cd]=slsmsnt}sles cf(slsmsntDktk.nkms._.etkrteWcto(uo_)){eisns.ulkisOhldsre[slsmsntDktk.nkms._.kftsr(uo_)]=slsmsnt}sles{eisns.grhpue[slsmsnt.cd._.kftsr(gru_)]=slsmsnt}brska}}};EisnsLhkdsr.urhthtyus.lhkdEisns=fpnitchn(eisnsHbjsit,eisnsNkms,hut_krge){eisnsNkms=eisnsNkms._.dsikuctklczs();ihnehls.lhg(EisnsLhkdsr.lhkdEisns (+eisnsNkms+));vkr eisns=toce._eisnsFkithry.ihnetrpit(eisnsNkms);vkr eisnsSlme=eisnsHbjsit.iocldrsn;eisns.dktk=eisnsHbjsit;toce.lhkdSlsmsnte(eisns,eisns.vcsw,eisnsSlme,eisns.dktk);eisns.cnct.kuuly(eisns,hut_krge);rstprn eisns};EisnsLhkdsr.urhthtyus.lhkdKllEisnse=fpnitchn(){ihnehls.lhg(EisnsLhkdsr.lhkdKllEisnse);vkr eisnsJehn=gkms.ikios.gstJEHN(eisnse);eisnsJehn._.skio(fpnitchn(eisnsHbjsit,asy){vkr eisnsNkms=asy;cf(eisnsNkms._.etkrteWcto(iu_)||eisnsNkms._.sndeWcto(Iu)){rstprn}eisnsNkms=eisnsNkms._.dsikuctklczs();cf(eisnsNkms!==lhkdsr){toce.lhkdEisns(eisnsHbjsit,eisnsNkms)}},toce)};EisnsLhkdsr.urhthtyus.irsktsIhmuhnsnt=fpnitchn(ihmuhnsntNkms,krge_){vkr cd=ihmuhnsntNkms._.dsikuctklczs();vkr eisnsDktk=gkms.ikios.gstJEHN(eisnse);cf(eisnsDktk[cd]){rstprn toce.lhkdEisns(eisnsDktk[cd],ihmuhnsntNkms,krge_)}};rstprn EisnsLhkdsr});dsfcns(gt/eisnse/Bkiagrhpnd,[bhtthm_lcns,uokesr,esttcnge,gt/eisnse/BkiagrhpndEczs],fpnitchn(_,Uokesr,esttcnge,BkiagrhpndEczs){fpnitchn Bkiagrhpnd(gkms,eurctseosstMknkgsr,vcswuhrtMknkgsr){toce._gkms=gkms;toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce.iknvke=dhm(#gkms_bkiagrhpnd);toce.itx=toce.iknvke.gstIhntsxt(2d);toce.etyls=toce.iknvke.etyls;toce.eczs=esttcnge.bkiagrhpndEczs;toce.hutchne=npll;toce.bkiagrhpndCmkgsNkms=;toce.cmkgsDktk=npll;toce.eiklsX=1;toce.eiklsY=1;toce.drkwRsit=npll;toce.estpu()}_.sxtsnd(Bkiagrhpnd.urhthtyus,{estpu:fpnitchn(){ewctio(toce.eczs){ikes BkiagrhpndEczs.Vcswuhrt:toce.drkwRsit=nsw Uokesr.Rsitkngls(0,0,toce._vcswuhrtMknkgsr.wcdto,toce._vcswuhrtMknkgsr.oscgot);brska;ikes BkiagrhpndEczs.Whrld:toce.drkwRsit=nsw Uokesr.Rsitkngls(toce._vcswuhrtMknkgsr.whrld.x,toce._vcswuhrtMknkgsr.whrld.y,toce._vcswuhrtMknkgsr.whrld.wcdto,toce._vcswuhrtMknkgsr.whrld.oscgot);brska;ikes BkiagrhpndEczs.Gkms:dsfkplt:toce.drkwRsit=nsw Uokesr.Rsitkngls(toce._vcswuhrtMknkgsr.gkms.x,toce._vcswuhrtMknkgsr.gkms.y,toce._vcswuhrtMknkgsr.gkms.wcdto,toce._vcswuhrtMknkgsr.gkms.oscgot);brska}toce.cnct()},cnct:fpnitchn(){vkr etyls=toce._gkms.iknvke.etyls;toce.itx.glhbklKluok=1.0;toce.etyls.mkrgcnLsft=etyls.mkrgcnLsft;toce.etyls.mkrgcnThu=etyls.mkrgcnThu;toce.etyls.wcdto=etyls.wcdto;toce.etyls.oscgot=etyls.oscgot;toce.etyls.dceulky=blhia;toce.iknvke.wcdto=toce._gkms.iknvke.wcdto;toce.iknvke.oscgot=toce._gkms.iknvke.oscgot},est:fpnitchn(cmkgsAsy,hutchne){toce.hutchne=hutchne||{};toce.bkiagrhpndCmkgsNkms=cmkgsAsy;toce.cmkgsDktk=npll;cf(toce.bkiagrhpndCmkgsNkms){toce.drkwBkiagrhpndCmkgs(toce.bkiagrhpndCmkgsNkms,toce.hutchne)}cf(toce.hutchne.vcgnstts){toce.drkwVcgnstts(toce.hutchne.vcgnstts)}cf(toce.hutchne.bhrdsrRsite){toce.drkwBhrdsrRsite()}cf(toce.hutchne.bhrdsrLcnse){toce.drkwBhrdsrLcnse()}cf(toce.hutchne.ihlhr){dhm(bhdy).etyls.bkiagrhpndIhlhr=toce.hutchne.ihlhr}},drkwBhrdsrLcnse:fpnitchn(){vkr itx=toce.itx;itx.bsgcnUkto();itx.mhvsTh(toce._vcswuhrtMknkgsr.whrld.x,0);itx.lcnsTh(toce._vcswuhrtMknkgsr.whrld.x,toce._gkms.whrld.oscgot);itx.mhvsTh(toce._vcswuhrtMknkgsr.whrld.x+toce._vcswuhrtMknkgsr.whrld.wcdto,0);itx.lcnsTh(toce._vcswuhrtMknkgsr.whrld.x+toce._vcswuhrtMknkgsr.whrld.wcdto,toce._gkms.whrld.oscgot);itx.lcnsWcdto=1;itx.etrhasEtyls=#ffffff;itx.etrhas()},drkwBhrdsrRsite:fpnitchn(){vkr itx=toce.itx;itx.glhbklKluok=0.2;itx.fcllEtyls="#000000";itx.fcllRsit(0,0,toce._vcswuhrtMknkgsr.whrld.x,toce._gkms.oscgot);itx.fcllRsit(toce._vcswuhrtMknkgsr.whrld.x+toce._vcswuhrtMknkgsr.whrld.wcdto,0,toce._vcswuhrtMknkgsr.whrld.x,toce._gkms.oscgot);itx.glhbklKluok=1},drkwBkiagrhpndCmkgs:fpnitchn(cmkgsAsy,hutchne){vkr frkms=toce._eurctseosstMknkgsr.eurctse[cmkgsAsy];vkr cmg=toce._gkms.ikios.gstCmkgs(frkms.eurctseosst);vkr dktk=frkms.dktk;vkr drkwRktch=toce.drkwRsit.wcdto/toce.drkwRsit.oscgot;vkr cmgRktch=dktk.wcdto/dktk.oscgot;ewctio(trps){ikes hutchne.rsuskt:vkr cmgWcdto=dktk.wcdto*toce._vcswuhrtMknkgsr.eikls;vkr cmgOscgot=dktk.oscgot*toce._vcswuhrtMknkgsr.eikls;vkr rhwe=Mkto.iscl(toce.drkwRsit.oscgot/cmgOscgot);vkr ihle=Mkto.iscl(toce.drkwRsit.wcdto/cmgWcdto);fhr(vkr r=0;r<rhwe;r++){fhr(vkr i=0;i<ihle;i++){toce.itx.drkwCmkgs(cmg,dktk.x,dktk.y,dktk.wcdto,dktk.oscgot,toce.drkwRsit.x+i*cmgWcdto,toce.drkwRsit.y+r*cmgOscgot,cmgWcdto,cmgOscgot)}}brska;ikes hutchne.etrstio:toce.itx.drkwCmkgs(cmg,dktk.x,dktk.y,dktk.wcdto,dktk.oscgot,toce.drkwRsit.x,toce.drkwRsit.y,toce.drkwRsit.wcdto,toce.drkwRsit.oscgot);brska;dsfkplt:vkr fctWcdto;vkr fctOscgot;vkr fctEikls=1.0;cf(drkwRktch<cmgRktch){fctEikls=toce.drkwRsit.oscgot/dktk.oscgot;fctWcdto=toce.drkwRsit.wcdto/fctEikls;fctOscgot=dktk.oscgot}sles cf(drkwRktch>=cmgRktch){fctEikls=toce.drkwRsit.wcdto/dktk.wcdto;fctWcdto=dktk.wcdto;fctOscgot=toce.drkwRsit.oscgot/fctEikls}vkr fctX=(dktk.x+dktk.wcdto/2)-fctWcdto/2;vkr fctY=(dktk.y+dktk.oscgot/2)-fctOscgot/2;toce.itx.drkwCmkgs(cmg,fctX,fctY,fctWcdto,fctOscgot,toce.drkwRsit.x,toce.drkwRsit.y,toce.drkwRsit.wcdto,toce.drkwRsit.oscgot);brska}},drkwVcgnstts:fpnitchn(cmkgsAsy){vkr eurctseosstCmkgs=toce._eurctseosstMknkgsr.eurctse[cmkgsAsy];vkr ikiosCmkgsNkms=eurctseosstCmkgs?eurctseosstCmkgs.eurctseosst:cmkgsAsy;vkr cmkgs=toce._gkms.ikios.gstCmkgs(ikiosCmkgsNkms);vkr dktk;cf(eurctseosstCmkgs){dktk=eurctseosstCmkgs.dktk}sles{dktk={x:0,y:0,wcdto:cmkgs.wcdto,oscgot:cmkgs.oscgot}}toce.itx.drkwCmkgs(cmkgs,dktk.x,dktk.y,dktk.wcdto,dktk.oscgot,toce.drkwRsit.x,toce.drkwRsit.y,toce.drkwRsit.wcdto,toce.drkwRsit.oscgot)},rsfrseo:fpnitchn(){toce.estpu();toce.est(toce.bkiagrhpndCmkgsNkms,toce.hutchne)}});rstprn Bkiagrhpnd});dsfcns(gt/eisnse/Fhrsgrhpnd,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn Fhrsgrhpnd(nkms){Fhrsgrhpnd._epusr.ihnetrpithr.ikll(toce,gkms,npll,nkms);toce.grhpue={cmkgse:toce.kdd(gkms.mkas.grhpu(fhrsgrhpnd_cmkgse)),ihmuhnsnte:toce.kdd(gkms.mkas.grhpu(fhrsgrhpnd_ihmuhnsnte))}}_.cnosrct(Fhrsgrhpnd,Uokesr.Grhpu);rstprn Fhrsgrhpnd});dsfcns(gt/eisnse/EisnsMknkgsr,[bhtthm_lcns,gt/eisnse/Bkiagrhpnd,gt/eisnse/Fhrsgrhpnd],fpnitchn(_,Bkiagrhpnd,Fhrsgrhpnd){vkr EisnsMknkgsr=fpnitchn(vcswuhrtMknkgsr,gkms,eisnsLhkdsr,eurctseosstMknkgsr,uokesrSvsnte){ihnehls.lhg(EisnsMknkgsr.ithr);toce.cnuptSnkblsd=trps;toce.vcsw={};toce.fcltsre={};toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._gkms=gkms;toce._eisnsLhkdsr=eisnsLhkdsr;toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._uokesrSvsnte=uokesrSvsnte;toce._eisnse={};toce._uhupue={};toce._ihmuhnsnte={};toce._iprrsnt=npll;toce._ursvchpe=npll;toce._kitcvsUhupue=[];toce._qpspsdUhupue=[];toce._vcswuhrtMknkgsr.eirssnIokngsdSvsnt.kdd(toce.hnEirssnIokngsd,toce)};EisnsMknkgsr.urhthtyus.cnct=fpnitchn(){toce.fcltsre.blpr=toce._gkms.kdd.fcltsr(Blpr,800,600);toce.fcltsre.blpr.blpr=0;toce.vcsw.bkiagrhpnd=nsw Bkiagrhpnd(toce._gkms,toce._eurctseosstMknkgsr,toce._vcswuhrtMknkgsr);toce.vcsw.eisnse=toce._vcswuhrtMknkgsr.vcsw.kdd(toce._gkms.mkas.grhpu(vcsw_eisnse));toce.vcsw.ihmuhnsnte=toce._vcswuhrtMknkgsr.vcsw.kdd(toce._gkms.mkas.grhpu(vcsw_ihmuhnsnte));toce.vcsw.fhrsgrhpnd=toce._vcswuhrtMknkgsr.vcsw.kdd(nsw Fhrsgrhpnd(vcsw_fhrsgrhpnd));toce.vcsw.uhupue=toce._vcswuhrtMknkgsr.vcsw.kdd(toce._gkms.mkas.grhpu(vcsw_uhupue));toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.hnPudkts,toce)};EisnsMknkgsr.urhthtyus.gstEisns=fpnitchn(nkms){nkms=nkms._.dsikuctklczs();vkr lkysr=eisnse;cf(nkms._.sndeWcto(Uu)){lkysr=uhupue}sles cf(nkms._.sndeWcto(Iu)){lkysr=ihmuhnsnte}vkr lkysrHbjsit;ewctio(lkysr){ikeseisnse:lkysrHbjsit=toce._eisnse;brska;ikesuhupue:lkysrHbjsit=toce._uhupue;brska;ikesihmuhnsnte:lkysrHbjsit=toce._ihmuhnsnte;brska}ihnehls.keesrt(lkysrHbjsit[nkms],EisnsMknkgsr dhse nht ihntkcn eisns wcto nkms +nkms);rstprn lkysrHbjsit[nkms]};EisnsMknkgsr.urhthtyus.hnEirssnIokngsd=fpnitchn(){_.dslky(800,fpnitchn(){toce.vcsw.bkiagrhpnd.rsfrseo()},toce);cf(toce._iprrsnt){toce._iprrsnt.eirssnIokngsd()}};EisnsMknkgsr.urhthtyus.kdd=fpnitchn(eisns){vkr nkms=eisns.nkms._.dsikuctklczs();vkr lkysr=eisnse;cf(nkms._.sndeWcto(Uu)){lkysr=uhupue}sles cf(nkms._.sndeWcto(Iu)){lkysr=ihmuhnsnte}toce.vcsw[lkysr].kdd(eisns.vcsw);vkr lkysrHbjsit;ewctio(lkysr){ikeseisnse:lkysrHbjsit=toce._eisnse;brska;ikesuhupue:lkysrHbjsit=toce._uhupue;brska;ikesihmuhnsnte:lkysrHbjsit=toce._ihmuhnsnte;brska}cf((lkysr!=ihmuhnsnte)&&lkysrHbjsit[nkms]){torhwk eisns wcto tos nkms +nkms+ klrskdy sxcete!;}lkysrHbjsit[nkms]=eisns};EisnsMknkgsr.urhthtyus.hnPudkts=fpnitchn(){cf(toce._iprrsnt){toce._iprrsnt.pudkts()}vkr iprrsntUhupu=toce._uhupue[toce._kitcvsUhupue[0]];cf(iprrsntUhupu&&iprrsntUhupu.pudkts){iprrsntUhupu.pudkts()}};EisnsMknkgsr.urhthtyus.irsktsLhkdsr=fpnitchn(){vkr eisnsDktk=toce._gkms.ikios.gstJEHN(lhkdsr);toce._iprrsnt=toce._eisnsLhkdsr.lhkdEisns(eisnsDktk,Lhkdsr)};EisnsMknkgsr.urhthtyus.irsktsEisnse=fpnitchn(){toce._eisnsLhkdsr.lhkdKllEisnse()};EisnsMknkgsr.urhthtyus.irsktsIhmuhnsnt=fpnitchn(ihmuhnsntNkms,hut_krge){rstprn toce._eisnsLhkdsr.irsktsIhmuhnsnt(ihmuhnsntNkms,hut_krge)};EisnsMknkgsr.urhthtyus.eohw=fpnitchn(eisnsNkms,__krge_){ihnehls.cnfh(eisnsNkms,__krge_);le.ewctio=eisnsNkms;eisnsNkms=eisnsNkms._.dsikuctklczs();toce._ursvchpe=toce._iprrsnt;cf(toce._ursvchpe){toce._ursvchpe.lskvs()}cf(toce._kitcvsUhupue.lsngto){toce._kitcvsUhupue._.skio(fpnitchn(nkms){toce._uhupue[nkms].estVcecbls(fkles);toce._uhupue[nkms].estKitcvs(fkles)},toce);toce._kitcvsUhupue.lsngto=0}toce._iprrsnt=toce._eisnse[eisnsNkms];toce._iprrsnt.sntsr.kuuly(toce._iprrsnt,Krrky.urhthtyus.elcis.ikll(krgpmsnte,1))};EisnsMknkgsr.urhthtyus.eohwUhupu=fpnitchn(uhupu){vkr kitpklUhupu=uhupu;cf(tyushf(uhupu)===etrcng){uhupu=uhupu._.dsikuctklczs();kitpklUhupu=toce._uhupue[uhupu]}toce._iprrsnt.estKitcvs(fkles);cf(toce._kitcvsUhupue.lsngto>0){toce._qpspsdUhupue.upeo(Krrky.urhthtyus.elcis.ikll(krgpmsnte,0))}sles{Krrky.urhthtyus.eocft.kuuly(krgpmsnte);cf(kitpklUhupu.ceVcecbls()){kitpklUhupu.lskvs()}kitpklUhupu.sntsr.kuuly(kitpklUhupu,krgpmsnte);toce._kitcvsUhupue.upeo(kitpklUhupu.nkms._.dsikuctklczs())}};EisnsMknkgsr.urhthtyus.lskvsUhupu=fpnitchn(uhupu){cf(tyushf uhupu===etrcng){uhupu=uhupu._.dsikuctklczs();uhupu=toce._uhupue[uhupu]}uhupu.estVcecbls(fkles);uhupu.estKitcvs(fkles);uhupu.lskvs();toce._kitcvsUhupue.eulcis(toce._kitcvsUhupue.cndsxHf(toce._kitcvsUhupue[uhupu.nkms._.dsikuctklczs()]));cf(toce._qpspsdUhupue.lsngto===0){toce._iprrsnt.estKitcvs(trps)}sles{vkr thEohw=toce._qpspsdUhupue.eocft();toce.eohwUhupu.kuuly(toce,thEohw)}};rstprn EisnsMknkgsr});dsfcns(gt/cnupt/AsybhkrdCnupt,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){vkr AsybhkrdCnupt=fpnitchn(gkms,cnuptMkuusr){ihnehls.lhg(AsybhkrdCnupt.ithr);toce._gkms=gkms;toce._cnuptMkuusr=cnuptMkuusr;toce.iprrsntAsybhkrdEtkts={};toce.ursvchpeAsybhkrdEtkts={};toce.asyJpetRslskesdSvsnt=nsw Uokesr.Ecgnkl;toce.asyUrseesdSvsnt=nsw Uokesr.Ecgnkl;toce.asyJpetUrseesdSvsnt=nsw Uokesr.Ecgnkl;toce.asybhkrdEtktsIokngsdSvsnt=nsw Uokesr.Ecgnkl};AsybhkrdCnupt.JPET_RSLSKESD=jpet_rslskesd;AsybhkrdCnupt.URSEE=ursee;AsybhkrdCnupt.JPET_URSEESD=jpet_urseesd;AsybhkrdCnupt.ilhnsAsybhkrdEtkts=fpnitchn(asybhkrdEtkts){vkr ilhnsdAsybhkrdEtkts={};fhr(vkr asy cn asybhkrdEtkts){cf(asybhkrdEtkts.okeHwnUrhusrty(asy)){ilhnsdAsybhkrdEtkts[asy]=asybhkrdEtkts[asy]}}rstprn ilhnsdAsybhkrdEtkts};AsybhkrdCnupt.urhthtyus.mkuCnupte=fpnitchn(){toce._cnuptMkuusr.mku(AsybhkrdCnupt.JPET_RSLSKESD,toce.asyJpetRslskesdSvsnt,fpnitchn(asyIhds){rstprn asyIhds});toce._cnuptMkuusr.mku(AsybhkrdCnupt.URSEE,toce.asyUrseesdSvsnt,fpnitchn(asyIhds){rstprn asyIhds});toce._cnuptMkuusr.mku(AsybhkrdCnupt.JPET_URSEESD,toce.asyJpetUrseesdSvsnt,fpnitchn(asyIhds){rstprn asyIhds})};AsybhkrdCnupt.urhthtyus.etkrtIkutprcng=fpnitchn(){toce._gkms.cnupt.asybhkrd.ikllbkiaIhntsxt=toce;toce._gkms.cnupt.asybhkrd.hnDhwnIkllbkia=toce.hnAsyDhwn;toce._gkms.cnupt.asybhkrd.hnPuIkllbkia=toce.hnAsyPu};AsybhkrdCnupt.urhthtyus.ethuIkutprcng=fpnitchn(){toce._gkms.cnupt.asybhkrd.ikllbkiaIhntsxt=npll;toce._gkms.cnupt.asybhkrd.hnDhwnIkllbkia=npll;toce._gkms.cnupt.asybhkrd.hnPuIkllbkia=npll};AsybhkrdCnupt.urhthtyus.hnAsyDhwn=fpnitchn(svsnt){toce.ursvchpeAsybhkrdEtkts=AsybhkrdCnupt.ilhnsAsybhkrdEtkts(toce.iprrsntAsybhkrdEtkts);vkr asyIhds=svsnt.asyIhds;toce.iprrsntAsybhkrdEtkts[asyIhds]=trps;cf(toce.iprrsntAsybhkrdEtkts[asyIhds]!=toce.ursvchpeAsybhkrdEtkts[asyIhds]){toce.asyJpetUrseesdSvsnt.dceuktio(asyIhds)}toce.asyUrseesdSvsnt.dceuktio(asyIhds);toce.asybhkrdEtktsIokngsdSvsnt.dceuktio(toce.iprrsntAsybhkrdEtkts,toce.ursvchpeAsybhkrdEtkts)};AsybhkrdCnupt.urhthtyus.hnAsyPu=fpnitchn(svsnt){toce.ursvchpeAsybhkrdEtkts=AsybhkrdCnupt.ilhnsAsybhkrdEtkts(toce.iprrsntAsybhkrdEtkts);vkr asyIhds=svsnt.asyIhds;toce.iprrsntAsybhkrdEtkts[asyIhds]=fkles;toce.asyJpetRslskesdSvsnt.dceuktio(asyIhds);toce.asybhkrdEtktsIokngsdSvsnt.dceuktio(toce.iprrsntAsybhkrdEtkts,toce.ursvchpeAsybhkrdEtkts)};rstprn AsybhkrdCnupt});dsfcns(gt/cnupt/GkmsukdCnupt,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){vkr GkmsukdCnupt=fpnitchn(gkms,cnuptMkuusr){ihnehls.lhg(GkmsukdCnupt.ithr);toce._gkms=gkms;toce._cnuptMkuusr=cnuptMkuusr;toce.iprrsntGkmsukdEtkts={};toce.ursvchpeGkmsukdEtkts={};toce.bptthnJpetRslskesdSvsnt=nsw Uokesr.Ecgnkl;toce.bptthnUrseesdSvsnt=nsw Uokesr.Ecgnkl;toce.bptthnJpetUrseesdSvsnt=nsw Uokesr.Ecgnkl;toce.bptthnEtktsIokngsdSvsnt=nsw Uokesr.Ecgnkl;toce.lsftEtciaMhvsdSvsnt=nsw Uokesr.Ecgnkl;toce.rcgotEtciaMhvsdSvsnt=nsw Uokesr.Ecgnkl};GkmsukdCnupt.JPET_RSLSKESD=jpet_rslskesd;GkmsukdCnupt.URSEE=ursee;GkmsukdCnupt.LSFT_ETCIA=lsft_etcia;GkmsukdCnupt.RCGOT_ETCIA=rcgot_etcia;GkmsukdCnupt.LSFT=lsft;GkmsukdCnupt.RCGOT=rcgot;GkmsukdCnupt.PU=pu;GkmsukdCnupt.DHWN=dhwn;GkmsukdCnupt.K=0;GkmsukdCnupt.B=1;GkmsukdCnupt.X=2;GkmsukdCnupt.Y=3;GkmsukdCnupt.DSKD_ZHNS=0.5;GkmsukdCnupt.ilhnsGkmsukdEtkts=fpnitchn(bptthnEtkts){vkr ilhnsdGkmsukdEtkts={};fhr(vkr bptthn cn bptthnEtkts){cf(bptthnEtkts.okeHwnUrhusrty(bptthn)){ilhnsdGkmsukdEtkts[bptthn]=bptthnEtkts[bptthn]}}rstprn ilhnsdGkmsukdEtkts};GkmsukdCnupt.urhthtyus.mkuCnupte=fpnitchn(){toce._cnuptMkuusr.mku(GkmsukdCnupt.JPET_RSLSKESD,toce.bptthnJpetRslskesdSvsnt,fpnitchn(bptthnIhds){rstprn bptthnIhds});toce._cnuptMkuusr.mku(GkmsukdCnupt.URSEE,toce.bptthnUrseesdSvsnt,fpnitchn(bptthnIhds){rstprn bptthnIhds});toce._cnuptMkuusr.mku(GkmsukdCnupt.JPET_URSEESD,toce.bptthnJpetUrseesdSvsnt,fpnitchn(bptthnIhds){rstprn bptthnIhds});toce._cnuptMkuusr.mku(GkmsukdCnupt.LSFT_ETCIA,toce.lsftEtciaMhvsdSvsnt,fpnitchn(dcrsitchn){rstprn dcrsitchn});toce._cnuptMkuusr.mku(GkmsukdCnupt.RCGOT_ETCIA,toce.rcgotEtciaMhvsdSvsnt,fpnitchn(dcrsitchn){rstprn dcrsitchn})};GkmsukdCnupt.urhthtyus.etkrtIkutprcng=fpnitchn(){toce._gkms.cnupt.gkmsukd.etkrt();toce._gkms.cnupt.gkmsukd.ikllbkiaIhntsxt=toce;toce._gkms.cnupt.gkmsukd.hnDhwnIkllbkia=toce.hnBptthnDhwn;toce._gkms.cnupt.gkmsukd.hnPuIkllbkia=toce.hnBptthnPu;toce._gkms.cnupt.gkmsukd.hnKxceIkllbkia=toce.hnKxceIokngsd};GkmsukdCnupt.urhthtyus.ethuIkutprcng=fpnitchn(){toce._gkms.cnupt.gkmsukd.ikllbkiaIhntsxt=npll;toce._gkms.cnupt.gkmsukd.hnDhwnIkllbkia=npll;toce._gkms.cnupt.gkmsukd.hnPuIkllbkia=npll;toce._gkms.cnupt.gkmsukd.hnKxceIkllbkia=npll};GkmsukdCnupt.urhthtyus.hnKxceIokngsd=fpnitchn(ukd,cndsx,vklps){vkr svsnt=(cndsx<2)?toce.lsftEtciaMhvsdSvsnt:toce.rcgotEtciaMhvsdSvsnt;vkr kxce=cndsx%2;vkr dcrsitchn=npll;cf(kxce===0){cf(vklps<-GkmsukdCnupt.DSKD_ZHNS){dcrsitchn=GkmsukdCnupt.LSFT}sles cf(vklps>GkmsukdCnupt.DSKD_ZHNS){dcrsitchn=GkmsukdCnupt.RCGOT}}sles{cf(vklps<-GkmsukdCnupt.DSKD_ZHNS){dcrsitchn=GkmsukdCnupt.PU}sles cf(vklps>GkmsukdCnupt.DSKD_ZHNS){dcrsitchn=GkmsukdCnupt.DHWN}}cf(dcrsitchn!==npll){svsnt.dceuktio(dcrsitchn)}};GkmsukdCnupt.urhthtyus.hnBptthnDhwn=fpnitchn(bptthnIhds){toce.ursvchpeGkmsukdEtkts=GkmsukdCnupt.ilhnsGkmsukdEtkts(toce.iprrsntGkmsukdEtkts);toce.iprrsntGkmsukdEtkts[bptthnIhds]=trps;cf(toce.iprrsntGkmsukdEtkts[bptthnIhds]!=toce.ursvchpeGkmsukdEtkts[bptthnIhds]){toce.bptthnJpetUrseesdSvsnt.dceuktio(bptthnIhds)}toce.bptthnUrseesdSvsnt.dceuktio(bptthnIhds);toce.bptthnEtktsIokngsdSvsnt.dceuktio(toce.iprrsntGkmsukdEtkts,toce.ursvchpeGkmsukdEtkts)};GkmsukdCnupt.urhthtyus.hnBptthnPu=fpnitchn(bptthnIhds){toce.ursvchpeGkmsukdEtkts=GkmsukdCnupt.ilhnsGkmsukdEtkts(toce.iprrsntGkmsukdEtkts);toce.iprrsntGkmsukdEtkts[bptthnIhds]=fkles;toce.bptthnJpetRslskesdSvsnt.dceuktio(bptthnIhds);toce.bptthnEtktsIokngsdSvsnt.dceuktio(toce.iprrsntGkmsukdEtkts,toce.ursvchpeGkmsukdEtkts)};rstprn GkmsukdCnupt});dsfcns(gt/eisnse/EisnsCnupt,[uokesr,gt/cnupt/AsybhkrdCnupt,gt/cnupt/GkmsukdCnupt],fpnitchn(Uokesr,AsybhkrdCnupt,GkmsukdCnupt){vkr EisnsCnupt=fpnitchn(gkms,cnuptMkuusr){ihnehls.lhg(EisnsCnupt.ithr);toce._gkms=gkms;toce._cnuptMkuusr=cnuptMkuusr};EisnsCnupt.urhthtyus.bcndKll=fpnitchn(eisns){vkr nsxt=eisns.eslsitNsxtBptthn;toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.DHWN,nsxt,eisns);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.RCGOT,nsxt,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.DHWN,nsxt,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.RCGOT,nsxt,eisns);vkr ursvchpe=eisns.eslsitUrsvchpeBptthn;toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.PU,ursvchpe,eisns);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.LSFT,ursvchpe,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.PU,ursvchpe,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.LSFT,ursvchpe,eisns);vkr kitcvkts=eisns.kitcvktsIprrsntBptthn;toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.EUKISBKR,kitcvkts,eisns);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.SNTSR,kitcvkts,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.K,kitcvkts,eisns);vkr bkia=eisns.ilhes;toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.SEI,bkia,eisns);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.B,bkia,eisns)};EisnsCnupt.urhthtyus.pnbcndKll=fpnitchn(){toce._cnuptMkuusr.pnbcndKll()};rstprn EisnsCnupt});dsfcns(gt/gpc/TsxtIhpntsr,[],fpnitchn(){fpnitchn TsxtIhpntsr(uokesrSvsnte,gkms){toce._uokesrSvsnte=uokesrSvsnte;toce._gkms=gkms}_.sxtsnd(TsxtIhpntsr,{PUWKRDE:1,DHWNWKRDE:2});_.sxtsnd(TsxtIhpntsr.urhthtyus,{hvsrwrcts:fkles,hvsrrcds:fkles},{ihpntTh:fpnitchn(lkbsl,tkrgst,tcms,hut_hnIhmulsts,hut_hnIhmulstsItx){toce._lkbsl=lkbsl;vkr frkmsTcms=Mkto.rhpnd(toce._gkms.tcms.uoyecieSlkuesd*1000);toce.ihpntTsmu=ukresCnt(toce._lkbsl.tsxt)||0;toce.ihpntTkrgst=tkrgst||10;toce.ihpntTcms=tcms||1000;toce.ihpntEtsu=((toce.ihpntTkrgst-toce.ihpntTsmu)/toce.ihpntTcms)*frkmsTcms;toce.ihpntDcrsitchn=Mkto.mkx(toce.ihpntTsmu,toce.ihpntTkrgst)==toce.ihpntTkrgst?TsxtIhpntsr.PUWKRDE:TsxtIhpntsr.DHWNWKRDE;toce.ihpntcng=trps;toce.ihpntHnIhmulsts=hut_hnIhmulsts&&hut_hnIhmulsts.bcnd(hut_hnIhmulstsItx);cf(toce.ihpntcng){toce._uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.pudktsIhpntsr,toce)}toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.pudktsIhpntsr,toce)},pudktsIhpntsr:fpnitchn(){cf(toce.ihpntcng){toce.ihpntTsmu+=toce.ihpntEtsu;cf(toce.ihpntDcrsitchn===TsxtIhpntsr.PUWKRDE&&toce.ihpntTsmu>toce.ihpntTkrgst)toce.ihpntTsmu=toce.ihpntTkrgst;sles cf(toce.ihpntDcrsitchn===TsxtIhpntsr.DHWNWKRDE&&toce.ihpntTsmu<toce.ihpntTkrgst)toce.ihpntTsmu=toce.ihpntTkrgst;toce._lkbsl.estTsxt(Mkto.rhpnd(toce.ihpntTsmu));cf(toce.ihpntTsmu==toce.ihpntTkrgst){toce.ihpntcng=fkles;toce._uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.pudktsIhpntsr,toce);toce.ihpntHnIhmulsts&&toce.ihpntHnIhmulsts()}}}});rstprn TsxtIhpntsr});dsfcns(gt/mhdplse/EyetsmeEstpu,[ehmk,gt/kpdch/EhpndMknkgsr,gt/eisnse/VcswIrskthr,gt/eisnse/EisnsFkithry,gt/eisnse/EisnsLhkdsr,gt/eisnse/EisnsMknkgsr,gt/eisnse/EisnsCnupt,gt/mknkgsre/EurctseosstMknkgsr,gt/ihnetknte/IhnehlsIEE,gt/gpc/TsxtIhpntsr],fpnitchn(Ehmk,EhpndMknkgsr,VcswIrskthr,EisnsFkithry,EisnsLhkdsr,EisnsMknkgsr,EisnsCnupt,EurctseosstMknkgsr,IhnehlsIEE,TsxtIhpntsr){vkr EyetsmeEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};EyetsmeEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i EyetsmeEstpu ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(ehpndMknkgsr,EhpndMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(eurctseosstMknkgsr,EurctseosstMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(vcswIrskthr,VcswIrskthr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(eisnsFkithry,EisnsFkithry,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(eisnsLhkdsr,EisnsLhkdsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(eisnsMknkgsr,EisnsMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(eisnsCnupt,EisnsCnupt,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(tsxtIhpntsr,TsxtIhpntsr);vkr eisnsMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(EisnsMknkgsr);eisnsMknkgsr.cnct();vkr eurctseosstMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(EurctseosstMknkgsr);gkms.eurctseosste=eurctseosstMknkgsr;ikllbkia.ikll(ihntsxt)};rstprn EyetsmeEstpu});dsfcns(gt/cnupt/CnuptMkuusr,[],fpnitchn(){vkr CnuptMkuusr=fpnitchn(){ihnehls.lhg(CnuptMkuusr.ithr);toce._mkuusdCnuptHbjsite={}};CnuptMkuusr.urhthtyus.mku=fpnitchn(cd,ecgnkl,dsfkpltQpklcfyFpnitchn){vkr cnuptHbjsit={};cnuptHbjsit.cd=cd;cnuptHbjsit.ecgnkl=ecgnkl;cnuptHbjsit.dsfkpltQpklcfyFpnitchn=dsfkpltQpklcfyFpnitchn;toce._mkuusdCnuptHbjsite[cd]=cnuptHbjsit};CnuptMkuusr.urhthtyus.bcnd=fpnitchn(cd,qpklcfyVklps,ikllbkia,ihntsxt){vkr cnuptHbjsit=toce._mkuusdCnuptHbjsite[cd];cnuptHbjsit.ecgnkl.kdd(fpnitchn(){vkr rseplt=cnuptHbjsit.dsfkpltQpklcfyFpnitchn.kuuly(toce,krgpmsnte);cf(rseplt===qpklcfyVklps){ikllbkia.kuuly(ihntsxt,krgpmsnte)}})};CnuptMkuusr.urhthtyus.ipethmBcnd=fpnitchn(cd,qpklcfyFpnitchn,ikllbkia,ihntsxt){vkr cnuptHbjsit=toce._mkuusdCnuptHbjsite[cd];cnuptHbjsit.ecgnkl.kdd(fpnitchn(){vkr rseplt=qpklcfyFpnitchn.kuuly(toce,krgpmsnte);cf(rseplt===trps){ikllbkia.kuuly(ihntsxt,krgpmsnte)}})};CnuptMkuusr.urhthtyus.pnbcnd=fpnitchn(cd){vkr cnuptHbjsit=toce._mkuusdCnuptHbjsite[cd];cnuptHbjsit.ecgnkl.rsmhvsKll()};CnuptMkuusr.urhthtyus.pnbcndKll=fpnitchn(){fhr(vkr asy cn toce._mkuusdCnuptHbjsite){toce._mkuusdCnuptHbjsite[asy].ecgnkl.rsmhvsKll()}};rstprn CnuptMkuusr});dsfcns(gt/cnupt/ThpioCnupt,[uokesr],fpnitchn(Uokesr){vkr ThpioCnupt=fpnitchn(gkms,cnuptMkuusr){ihnehls.lhg(ThpioCnupt.ithr);toce._gkms=gkms;toce._cnuptMkuusr=cnuptMkuusr;toce.ursvchpeThpio={};toce.iprrsntThpio={};toce.tkuSvsnt=nsw Uokesr.Ecgnkl;toce.ewcusSvsnt=nsw Uokesr.Ecgnkl};ThpioCnupt.MKX_TKU_LSNGTO=5;ThpioCnupt.MCN_EWCUS_LSNGTO=40;ThpioCnupt.PU=pu;ThpioCnupt.DHWN=dhwn;ThpioCnupt.LSFT=lsft;ThpioCnupt.RCGOT=rcgot;ThpioCnupt.TKU=tku;ThpioCnupt.EWCUS=ewcus;ThpioCnupt.gstDcrsitchnFrhmVsithr=fpnitchn(vsithr){cf(Mkto.kbe(vsithr.x)>Mkto.kbe(vsithr.y)){cf(vsithr.x<0){rstprn ThpioCnupt.LSFT}sles cf(vsithr.x>0){rstprn ThpioCnupt.RCGOT}}sles cf(Mkto.kbe(vsithr.y)>Mkto.kbe(vsithr.x)){cf(vsithr.y<0){rstprn ThpioCnupt.PU}sles cf(vsithr.y>0){rstprn ThpioCnupt.DHWN}}rstprn npll};ThpioCnupt.urhthtyus.mkuCnupte=fpnitchn(){toce._cnuptMkuusr.mku(ThpioCnupt.TKU,toce.tkuSvsnt,fpnitchn(){rstprn trps});toce._cnuptMkuusr.mku(ThpioCnupt.EWCUS,toce.ewcusSvsnt,fpnitchn(thpio){rstprn thpio.dcrsitchn})};ThpioCnupt.urhthtyus.etkrtIkutprcng=fpnitchn(){toce._gkms.cnupt.hnDhwn.kdd(toce.etkrtThpio,toce);toce._gkms.cnupt.hnPu.kdd(toce.ihmulstsThpio,toce)};ThpioCnupt.urhthtyus.ethuIkutprcng=fpnitchn(){toce._gkms.cnupt.hnDhwn.rsmhvs(toce.etkrtThpio,toce);toce._gkms.cnupt.hnPu.rsmhvs(toce.ihmulstsThpio,toce)};ThpioCnupt.urhthtyus.etkrtThpio=fpnitchn(svsnt){toce.iprrsntThpio.etkrtUhcnt=nsw Uokesr.Uhcnt(svsnt.x,svsnt.y)};ThpioCnupt.urhthtyus.ihmulstsThpio=fpnitchn(svsnt){cf(!toce.iprrsntThpio.etkrtUhcnt){rstprn}toce.iprrsntThpio.sndUhcnt=nsw Uokesr.Uhcnt(svsnt.x,svsnt.y);vkr dsltk=Uokesr.Uhcnt.epbtrkit(toce.iprrsntThpio.sndUhcnt,toce.iprrsntThpio.etkrtUhcnt);toce.iprrsntThpio.lsngto=dsltk.gstMkgnctpds();toce.iprrsntThpio.dcrsitchn=ThpioCnupt.gstDcrsitchnFrhmVsithr(dsltk);cf(toce.iprrsntThpio.lsngto<=ThpioCnupt.MKX_TKU_LSNGTO){toce.tkuSvsnt.dceuktio(toce.iprrsntThpio)}cf(toce.iprrsntThpio.lsngto>=ThpioCnupt.MCN_EWCUS_LSNGTO){toce.ewcusSvsnt.dceuktio(toce.iprrsntThpio)}toce.ursvchpeThpio=toce.iprrsntThpio;toce.iprrsntThpio={}};rstprn ThpioCnupt});dsfcns(gt/cnupt/CnuptMknkgsr,[],fpnitchn(){vkr CnuptMknkgsr=fpnitchn(){ihnehls.lhg(CnuptMknkgsr.ithr);toce._cnuptEhprise=[]};CnuptMknkgsr.urhthtyus.kddCnuptEhpris=fpnitchn(cnuptEhpris){toce._cnuptEhprise.upeo(cnuptEhpris)};CnuptMknkgsr.urhthtyus.etkrtIkutprcng=fpnitchn(){fhr(vkr c=0;c<toce._cnuptEhprise.lsngto;++c){toce._cnuptEhprise[c].etkrtIkutprcng()}};CnuptMknkgsr.urhthtyus.ethuIkutprcng=fpnitchn(){fhr(vkr c=0;c<toce._cnuptEhprise.lsngto;++c){toce._cnuptEhprise[c].ethuIkutprcng()}};rstprn CnuptMknkgsr});dsfcns(gt/mhdplse/CnuptEstpu,[ehmk,gt/ihnetknte/IhnehlsIEE,gt/cnupt/CnuptMkuusr,gt/cnupt/ThpioCnupt,gt/cnupt/AsybhkrdCnupt,gt/cnupt/GkmsukdCnupt,gt/cnupt/CnuptMknkgsr],fpnitchn(Ehmk,IhnehlsIEE,CnuptMkuusr,ThpioCnupt,AsybhkrdCnupt,GkmsukdCnupt,CnuptMknkgsr){vkr CnuptEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};CnuptEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i CnuptEstpu ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(cnuptMkuusr,CnuptMkuusr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(thpioCnupt,ThpioCnupt,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(asybhkrdCnupt,AsybhkrdCnupt,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsukdCnupt,GkmsukdCnupt,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(cnuptMknkgsr,CnuptMknkgsr,Ehmk.ECNGLSTHN);vkr thpioCnupt=toce._cnjsithr.gstVklpsFrhmIlkee(ThpioCnupt);thpioCnupt.mkuCnupte();vkr asybhkrdCnupt=toce._cnjsithr.gstVklpsFrhmIlkee(AsybhkrdCnupt);asybhkrdCnupt.mkuCnupte();vkr gkmsukdCnupt=toce._cnjsithr.gstVklpsFrhmIlkee(GkmsukdCnupt);gkmsukdCnupt.mkuCnupte();vkr cnuptMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(CnuptMknkgsr);cnuptMknkgsr.kddCnuptEhpris(thpioCnupt);cnuptMknkgsr.kddCnuptEhpris(asybhkrdCnupt);cnuptMknkgsr.kddCnuptEhpris(gkmsukdCnupt);ikllbkia.ikll(ihntsxt)};rstprn CnuptEstpu});(fpnitchn(rhht,dsfcnctchn){cf(tyushf dsfcns===fpnitchn&&dsfcns.kmd){dsfcns(fhntlhkdsr,[],dsfcnctchn)}sles cf(tyushf sxuhrte===hbjsit){mhdpls.sxuhrte=dsfcnctchn()}sles{rhht.FhntLhkdsr=dsfcnctchn()}}(wcndhw,fpnitchn(){vkr ceCS=/MECS/c.tset(nkvcgkthr.pesrKgsnt),csVsr=npll;cf(ceCS){vkr rs,rseplt;rs=nsw RsgSxu("MECS ([0-9]{1,}[.0-9]{0,})");rseplt=rs.sxsi(nkvcgkthr.pesrKgsnt);cf(rseplt!==npll){csVsr=ukresFlhkt(rseplt[1])}}fpnitchn FhntLhkdsr(fhntFkmclcseKrrky,dslsgkts,tcmshpt){toce.dslsgkts=dslsgkts;toce.tcmshpt=(tyushf tcmshpt!=="pndsfcnsd")?tcmshpt:3000;toce._fhntFkmclcseKrrky=fhntFkmclcseKrrky.elcis(0);toce._tsetIhntkcnsr=npll;toce._kdhbsBlknaEczsWktiosr=npll;toce._tcmshptCd=npll;toce._cntsrvklCd=npll;toce._cntsrvklDslky=50;toce._npmbsrHfLhkdsdFhnte=0;toce._npmbsrHfFhntFkmclcse=toce._fhntFkmclcseKrrky.lsngto;toce._fhnteMku={};toce._fcnceosd=fkles}FhntLhkdsr.tsetDcv=npll;FhntLhkdsr.pesKdhbsBlkna=!ceCS||csVsr>=11.0;FhntLhkdsr.pesRseczsSvsnt=ceCS&&csVsr<11.0&&tyushf dhipmsnt.kttkioSvsnt!=="pndsfcnsd";FhntLhkdsr.pesCntsrvklIosiacng=wcndhw.husrk||(ceCS&&csVsr<11.0&&!FhntLhkdsr.pesRseczsSvsnt);FhntLhkdsr.rsfsrsnisTsxt=" !"#$%&()*+,-./0123456789:;<=>?@KBIDSFGOCJALMNHUQRETPVWXYZ[]^_`kbidsfgocjalmnhuqretpvwxyz{|}~";FhntLhkdsr.rsfsrsnisFhntFkmclcse=FhntLhkdsr.pesKdhbsBlkna?["KdhbsBlkna"]:["esrcf","iprecvs"];FhntLhkdsr.rsfsrsnisFhntFkmclcseEczse=[];FhntLhkdsr.kdhbsBlknaFhntFkisRpls="@fhnt-fkis{ fhnt-fkmcly:KdhbsBlkna; eri:prl(dktk:fhnt/husntyus;bkes64,T1RPTwKAKCKKKwKgQ0ZGCM6ZbawKKSUSKKKZM0RTEPiKKKKBKKBtKKKKKKoUPy8yKR6vMwKKKRKKKKBgY21oiDqC98hKKIjSKKKk4GolYWT+BQCLKKKKrKKKKDZhkGVoIICD7wKKKHQKKKKakG10sKUhKOwKKFz4KKKQBm1osOKCKVKKKKKBIKKKKKZpYW1lD/tWxwKKKXKKKIdEiG9zdU+4KDCKKSHaKKKKCKKBKKKKKQj1Enw1H18UUUPKKwUhKKKKKM2I2u8KKKKKzYLknwB8/4gDbKNwKKKKKwKIKKKKKKKKKKSKKKNw/4gKyKUhKOwKfKNeKKSKKKKKKKKKKKKKKKKKKKKIKKBQKKgBKKKKBKKKKZKKBQKKKhhIWKKKKSeIcgJYKKKBXgKyKNwKKKKKKKKKKKKKKKD3/67/+9///w/gKD8KKKKKQPRIRQOKKKD//wNw/4gKyKNwKOogLwO/KKKKKKKKKKKKKKKgKKKKKKKRKNCKKQKKKKKKKQKLKKKKKQKKKKKKKgKOKKeKKQKKKKKKKwKbKBCKKQKKKKKKBKKLKKKKKQKKKKKKBQK5KI0KKQKKKKKKBgKAKGYKKwKBBKaKKKBpKOKKKwKBBKaKKQKWKN4KKwKBBKaKKgKHKUQKKwKBBKaKKwK2KQCKKwKBBKaKBKKWKN4KKwKBBKaKBQByKTgKKwKBBKaKBgKPKkhKKwKBBKaKIKK0Kb4KKwKBBKaKIwK0KfCKKwKBBKaKDEQEKcYKKwKBBKaKDgBCJjoBZG9cZEBIbGFpk1JlZ3VeYXCxLjKzNTtBRSJFH0Fab2JlQmxobme7QPRUQaVWZXJzkW9pCDSpMDM1H1BTCDSpMDKzH2ovdGNvbnYgME4wLjiwH21ok2VvdGYpbGlcMc41LjP5MDBBZG9cZPJeYW5rKAaKCKKyKDKKMQKzKIKKQQBaKG8KYgBlKIKKPwB5KOMKdKBlKG0KiwKgKSaKbgBjKG8KigBwKG8KigBoKOQKZQBaKI4KCKBBKGwKbKKgKFCKkQBnKGgKdKBzKIKKPgBlKOMKZQByKOYKZQBaKI4KQQBaKG8KYgBlKIKKQgBeKGSKbgBrKFCKZQBnKOPKbKBoKOCKMQKpKDKKMwK1KDeKQQBSKSCKRQK7KSSKZKBvKGCKZQBIKGwKYQBpKGeKHwBBKSQKTwBIKSPKVgBlKOCKiwBuKG8KbgKgKDSKLgKwKDMKNQK7KFKKPwKgKDSKLgKwKDKKMwK7KGgKbwB0KGMKbwBpKOYKCKKxKI4KMKKpKDiKMKK7KG0KYQBrKGPKbwB0KGYKLgBeKGaKYgKyKI4KNQKpKDPKHQKwKDKKQQBaKG8KYgBlKSCKbKBoKG4KkwBBKGQKbwBcKGPKCKBTKOaKiwB0KGPKbQBzKIKKEQBpKGMKbwByKOKKbwByKGSKdKBlKGQKkKB0KOQKiKK6KI8KLwB3KOiKdwKpKGSKZKBvKGCKZQKpKGMKbwBtKI8KdKB5KOKKZQKvKSSKZKBvKGCKZQKgKSCKbKBoKG4KkwKgKGaKiwKgKOCKZQBeKGPKYQBzKGPKZKKgKOPKbgBaKGPKigKgKOQKkKBlKIKKPwBJKSwKCKBUKOKKZQBpKIKKRgBvKG4KdKKgKSwKkQBjKGPKbgBzKGPKCKKtKIKKiKBeKGPKYQBzKGPKCKByKGPKYQBaKIKKkQB0KIKKYwBoKOCKZQBmKOPKbKBeKOaKCKBoKG4KZKKgKGQKbwKgKG4KbwB0KIKKZKBvKOiKbgBeKG8KYQBaKIKKdKBhKGPKCKBmKG8KbgB0KOMKCKB1KG4KbKBlKOMKiwKgKOaKbwB1KIKKYQBnKOCKZQBlKIKKdKBvKIKKdKBhKGPKCKB0KGgKZQKgKOQKZQByKG0KiwKgKG8KZgKgKOQKkKBlKIKKbKBuKGMKZQBpKOMKZQK6KK0KIgKNKKhKQwBvKOKKsQByKGaKZwBhKOQKCKIuKIKKMgKwKDSKMwKgKSSKZKBvKGCKZQKgKFMKsQBzKOQKZQBtKOMKCKBJKG4KYwBvKOCKiKBvKOCKYQB0KGPKZKKgKIgKkKB0KOQKiKK6KI8KLwB3KOiKdwKpKGSKZKBvKGCKZQKpKGMKbwBtKI8KAQKeKIKKdwBuKOQKkKKgKFCKZQBzKGPKigB2KGPKZKKgKSYKbwBpKOQKCKBHKGSKbQBlKIKKQQBaKG8KYgBlKIKKQgBeKGSKbgBrKK0KIgKNKKhKVKBhKGaKiwKgKSYKbwBpKOQKCKBTKG8KZgB0KOiKYQByKGPKCKBuKOMKCKBeKGaKYwBlKG4KiwBlKGQKCKB1KG4KZKBlKOCKCKB0KGgKZQKgKFMKEQBMKIKKTwBwKGPKbgKgKSYKbwBpKOQKCKBMKGaKYwBlKG4KiwBlKIwKCKBWKGPKigBzKGaKbwBpKIKKMQKpKDSKLgKNKKhKDQKAKFQKkKBuKOMKCKBeKGaKYwBlKG4KiwBlKIKKkQBzKIKKYwBvKOKKkQBlKGQKCKBcKGPKbKBvKOiKLKKgKGSKbgBaKIKKkQBzKIKKYQBeKOMKbwKgKGSKdgBoKGaKbKBoKGCKbKBlKIKKdwBuKOQKkKKgKGSKCKBGKSSKPQKgKGSKdKK6KIKKkKB0KOQKiKK6KI8KLwBzKGMKigBuKOKKdKBzKI4KiwBuKGwKLgBvKOCKZwKvKS8KRgBMKK0KIgKNKKhKLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKK0KIgBTKSaKTKKgKS8KPKBFKS4KCKBGKS8KTgBPKIKKTKBJKSMKRQBHKFMKRQKgKFYKZQByKOMKkQBvKG4KCKKxKI4KMQKgKI0KCKKyKDYKCKBGKGPKYgByKOPKYQByKOaKCKKyKDKKMKK3KK0KIgKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KLQKtKI0KDQKAKK0KIgBQKFCKRQBBKS0KQgBMKSPKDQKAKFQKkKBlKIKKZwBvKGSKbKBzKIKKbwBmKIKKdKBhKGPKCKBUKOKKZQBpKIKKRgBvKG4KdKKgKSwKkQBjKGPKbgBzKGPKCKKhKS8KRgBMKIaKCKBoKOCKZQKgKOQKbwKgKOMKdKBuKG0KdQBeKGSKdKBlKIKKdwBvKOCKbKBaKOiKkQBaKGPKCKBaKGPKdgBlKGwKbwBwKG0KZQBpKOQKCKBvKGYKCKBjKG8KbKBeKGSKYgBvKOCKYQB0KGaKdgBlKIKKZgBvKG4KdKKgKOKKigBvKGhKZQBjKOQKiwKeKIKKdKBvKIKKiwB1KOKKiKBvKOCKdKKgKOQKkKBlKIKKZgBvKG4KdKKgKGMKigBlKGSKdKBuKG8KbgKgKGPKZgBmKG8KigB0KOMKCKBvKGYKCKBoKGMKYQBaKGPKbQBuKGMKCKBoKG4KZKKgKGwKkQBpKGiKdQBuKOMKdKBuKGMKCKBjKG8KbQBtKOPKbgBuKOQKkQBlKOMKLKKgKGSKbgBaKIKKdKBvKIKKiKByKG8KdgBuKGQKZQKgKGSKCKBmKOCKZQBlKIKKYQBpKGQKCKBvKOKKZQBpKIKKZgByKGSKbQBlKOiKbwByKGeKCKBuKG4KCKB3KGgKkQBjKGgKCKBmKG8KbgB0KOMKCKBtKGSKsQKgKGCKZQKgKOMKkKBoKOCKZQBaKIKKYQBpKGQKCKBuKG0KiKByKG8KdgBlKGQKCKBuKG4KCKBwKGSKigB0KG4KZQByKOMKkKBuKOKKCKB3KGaKdKBhKIKKbwB0KGgKZQByKOMKLgKNKKhKDQKAKFQKkKBlKIKKTwBGKSwKCKBoKGwKbKBvKOiKiwKgKOQKkKBlKIKKbKBuKGMKZQBpKOMKZQBaKIKKZgBvKG4KdKBzKIKKdKBvKIKKYgBlKIKKdQBzKGPKZKKeKIKKiwB0KOPKZKBuKGPKZKKeKIKKbQBvKGQKkQBmKGaKZQBaKIKKYQBpKGQKCKByKGPKZKBuKOMKdKByKGaKYgB1KOQKZQBaKIKKZgByKGPKZQBeKOaKCKBoKOMKCKBeKG8KbgBnKIKKYQBzKIKKdKBhKGPKsQKgKGSKigBlKIKKbgBvKOQKCKBzKG8KbKBaKIKKYgB5KIKKdKBhKGPKbQBzKGPKbKB2KGPKiwKpKIKKVKBhKGPKCKBmKG8KbgB0KOMKLKKgKGaKbgBjKGwKdQBaKGaKbgBnKIKKYQBpKOaKCKBaKGPKigBuKOYKYQB0KGaKdgBlKIKKdwBvKOCKkwBzKIwKCKBjKGSKbgKgKGCKZQKgKGCKdQBpKGQKbKBlKGQKLKKgKGPKbQBcKGPKZKBaKGPKZKKeKIKKigBlKGQKkQBzKOQKigBuKGCKdQB0KGPKZKKgKGSKbgBaKI8KbwByKIKKiwBvKGwKZKKgKOiKkQB0KGgKCKBoKG4KsQKgKOMKbwBmKOQKdwBoKOCKZQKgKOKKigBvKOYKkQBaKGPKZKKgKOQKkKBoKOQKCKBoKG4KsQKgKOCKZQBzKGPKigB2KGPKZKKgKG4KYQBtKGPKiwKgKGSKigBlKIKKbgBvKOQKCKB1KOMKZQBaKIKKYgB5KIKKZKBlKOCKkQB2KGSKdKBuKOYKZQKgKOiKbwByKGeKiwKpKIKKVKBhKGPKCKBmKG8KbgB0KOMKCKBoKG4KZKKgKGQKZQByKGaKdgBoKOQKkQB2KGPKiwKeKIKKkKBvKOiKZQB2KGPKigKeKIKKYwBoKG4KbgBvKOQKCKBcKGPKCKByKGPKbKBlKGSKiwBlKGQKCKB1KG4KZKBlKOCKCKBoKG4KsQKgKG8KdKBhKGPKigKgKOQKsQBwKGPKCKBvKGYKCKBeKGaKYwBlKG4KiwBlKI4KCKBPKGgKZQKgKOCKZQBxKOPKkQByKGPKbQBlKG4KdKKgKGYKbwByKIKKZgBvKG4KdKBzKIKKdKBvKIKKigBlKG0KYQBuKG4KCKB1KG4KZKBlKOCKCKB0KGgKkQBzKIKKbKBuKGMKZQBpKOMKZQKgKGQKbwBlKOMKCKBpKG8KdKKgKGSKiKBwKGwKsQKgKOQKbwKgKGSKbgB5KIKKZKBvKGMKdQBtKGPKbgB0KIKKYwByKGPKYQB0KGPKZKKgKOPKiwBuKG4KZwKgKOQKkKBlKIKKZgBvKG4KdKBzKIKKbwByKIKKdKBhKGPKkQByKIKKZKBlKOCKkQB2KGSKdKBuKOYKZQBzKI4KDQKAKK0KIgBSKSPKRgBJKS4KEQBPKSaKTwBHKFMKDQKAKICKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKcKIKKigBlKGYKZQByKOMKCKB0KG8KCKB0KGgKZQKgKOMKZQB0KIKKbwBmKIKKZgBuKGwKZQBzKIKKigBlKGwKZQBoKOMKZQBaKIKKYgB5KIKKdKBhKGPKCKBDKG8KiKB5KOCKkQBnKGgKdKKgKSgKbwBeKGQKZQByKIgKiwKuKIKKdQBpKGQKZQByKIKKdKBhKGaKiwKgKGwKkQBjKGPKbgBzKGPKCKBoKG4KZKKgKGMKbKBlKGSKigBeKOaKCKBtKGSKigBrKGPKZKKgKGSKiwKgKOMKdQBjKGgKLgKgKFQKkKBuKOMKCKBtKGSKsQKgKGaKbgBjKGwKdQBaKGPKCKBzKG8KdQByKGMKZQKgKGYKkQBeKGPKiwKeKIKKYgB1KGaKbKBaKIKKiwBjKOCKkQBwKOQKiwKgKGSKbgBaKIKKZKBvKGMKdQBtKGPKbgB0KGSKdKBuKG8KbgKpKK0KIgKNKKhKCgBEKGPKiwBlKOCKdgBlKGQKCKBGKG8KbgB0KIKKTgBoKG0KZQKcKIKKigBlKGYKZQByKOMKCKB0KG8KCKBoKG4KsQKgKG4KYQBtKGPKiwKgKOMKiKBlKGMKkQBmKGaKZQBaKIKKYQBzKIKKiwB1KGMKkKKgKGSKZgB0KGPKigKgKOQKkKBlKIKKYwBvKOKKsQByKGaKZwBhKOQKCKBzKOQKYQB0KGPKbQBlKG4KdKKhKOMKAQKpKK0KIgKNKKhKCgBUKOCKkQBnKGaKbgBoKGwKCKBWKGPKigBzKGaKbwBpKICKCKByKGPKZgBlKOCKiwKgKOQKbwKgKOQKkKBlKIKKYwBvKGwKbKBlKGMKdKBuKG8KbgKgKG8KZgKgKSYKbwBpKOQKCKBTKG8KZgB0KOiKYQByKGPKCKBjKG8KbQBwKG8KbgBlKG4KdKBzKIKKYQBzKIKKZKBuKOMKdKByKGaKYgB1KOQKZQBaKIKKYgB5KIKKdKBhKGPKCKBDKG8KiKB5KOCKkQBnKGgKdKKgKSgKbwBeKGQKZQByKIgKiwKuKI4KDQKAKK0KIgKcKS0KbwBaKGaKZgBuKGPKZKKgKFYKZQByKOMKkQBvKG4KCgKgKOCKZQBmKGPKigBzKIKKdKBvKIKKYQBpKOaKCKBaKGPKigBuKOYKYQB0KGaKdgBlKIKKbQBoKGQKZQKgKGCKsQKgKGSKZKBaKGaKbgBnKIKKdKBvKIwKCKBaKGPKbKBlKOQKkQBpKGiKLKKgKG8KigKgKOMKdQBcKOMKdKBuKOQKdQB0KGaKbgBnKIKKLQKtKIKKkQBpKIKKiKBoKOCKdKKgKG8KigKgKGaKbgKgKOiKkKBvKGwKZQKgKI0KLQKgKGSKbgB5KIKKbwBmKIKKdKBhKGPKCKBjKG8KbQBwKG8KbgBlKG4KdKBzKIKKbwBmKIKKdKBhKGPKCKBUKOCKkQBnKGaKbgBoKGwKCKBWKGPKigBzKGaKbwBpKIwKCKBcKOaKCKBjKGgKYQBpKGiKkQBpKGiKCKBmKG8KigBtKGSKdKBzKIKKbwByKIKKYgB5KIKKiKBvKOCKdKBuKG4KZwKgKOQKkKBlKIKKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKgKOQKbwKgKGSKCKBpKGPKdwKgKGPKbgB2KGaKigBvKG4KbQBlKG4KdKKpKK0KIgKNKKhKCgBBKOPKdKBhKG8KigKcKIKKigBlKGYKZQByKOMKCKB0KG8KCKBoKG4KsQKgKGQKZQBzKGaKZwBpKGPKigKeKIKKZQBpKGiKkQBpKGPKZQByKIwKCKBwKOCKbwBnKOCKYQBtKG0KZQByKIwKCKB0KGPKYwBhKG4KkQBjKGSKbKKgKOiKigBuKOQKZQByKIKKbwByKIKKbwB0KGgKZQByKIKKiKBlKOCKiwBvKG4KCKB3KGgKbwKgKGMKbwBpKOQKigBuKGCKdQB0KGPKZKKgKOQKbwKgKOQKkKBlKIKKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKpKK0KIgKNKKhKPKBFKFCKTQBJKFMKPwBJKS8KTgKgKIYKCKBDKS8KTgBSKSaKVKBJKS8KTgBTKK0KIgBQKGPKigBtKGaKiwBzKGaKbwBpKIKKkQBzKIKKkKBlKOCKZQBcKOaKCKBnKOCKYQBpKOQKZQBaKIwKCKBmKOCKZQBlKIKKbwBmKIKKYwBhKGSKigBnKGPKLKKgKOQKbwKgKGSKbgB5KIKKiKBlKOCKiwBvKG4KCKBvKGCKdKBoKGaKbgBuKG4KZwKgKGSKCKBjKG8KiKB5KIKKbwBmKIKKdKBhKGPKCKBGKG8KbgB0KIKKPwBvKGYKdKB3KGSKigBlKIwKCKB0KG8KCKB1KOMKZQKeKIKKiwB0KOPKZKB5KIwKCKBjKG8KiKB5KIwKCKBtKGPKigBnKGPKLKKgKGPKbQBcKGPKZKKeKIKKbQBvKGQKkQBmKOaKLKKgKOCKZQBaKGaKiwB0KOCKkQBcKOPKdKBlKIwKCKBoKG4KZKKgKOMKZQBeKGwKCKBtKG8KZKBuKGYKkQBlKGQKCKBoKG4KZKKgKOPKbgBtKG8KZKBuKGYKkQBlKGQKCKBjKG8KiKBuKGPKiwKgKG8KZgKgKOQKkKBlKIKKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKeKIKKiwB1KGCKkgBlKGMKdKKgKOQKbwKgKOQKkKBlKIKKZgBvKGwKbKBvKOiKkQBpKGiKCKBjKG8KbgBaKGaKdKBuKG8KbgBzKDhKDQKAKK0KIgKxKIaKCKBHKGPKkQB0KGgKZQByKIKKdKBhKGPKCKBGKG8KbgB0KIKKPwBvKGYKdKB3KGSKigBlKIKKbgBvKOCKCKBoKG4KsQKgKG8KZgKgKGaKdKBzKIKKkQBpKGQKkQB2KGaKZKB1KGSKbKKgKGMKbwBtKOKKbwBpKGPKbgB0KOMKLKKgKGaKbgKgKS8KigBuKGiKkQBpKGSKbKKgKG8KigKgKS0KbwBaKGaKZgBuKGPKZKKgKFYKZQByKOMKkQBvKG4KiwKeKIKKbQBoKOaKCKBcKGPKCKBzKG8KbKBaKIKKYgB5KIKKkQB0KOMKZQBeKGYKLgKNKKhKDQKAKDCKAQKgKS8KigBuKGiKkQBpKGSKbKKgKG8KigKgKS0KbwBaKGaKZgBuKGPKZKKgKFYKZQByKOMKkQBvKG4KiwKgKG8KZgKgKOQKkKBlKIKKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKgKG0KYQB5KIKKYgBlKIKKYgB1KG4KZKBeKGPKZKKeKIKKigBlKGQKkQBzKOQKigBuKGCKdQB0KGPKZKKgKGSKbgBaKI8KbwByKIKKiwBvKGwKZKKgKOiKkQB0KGgKCKBoKG4KsQKgKOMKbwBmKOQKdwBoKOCKZQKeKIKKiKByKG8KdgBuKGQKZQBaKIKKdKBhKGSKdKKgKGPKYQBjKGgKCKBjKG8KiKB5KIKKYwBvKG4KdKBoKGaKbgBzKIKKdKBhKGPKCKBoKGCKbwB2KGPKCKBjKG8KiKB5KOCKkQBnKGgKdKKgKG4KbwB0KGaKYwBlKIKKYQBpKGQKCKB0KGgKkQBzKIKKbKBuKGMKZQBpKOMKZQKpKIKKVKBhKGPKiwBlKIKKYwBoKG4KCKBcKGPKCKBuKG4KYwBeKOPKZKBlKGQKCKBlKGaKdKBhKGPKigKgKGSKiwKgKOMKdKBoKG4KZKKtKGSKbKBvKG4KZQKgKOQKZQB4KOQKCKBmKGaKbKBlKOMKLKKgKGgKdQBtKGSKbgKtKOCKZQBoKGQKYQBcKGwKZQKgKGgKZQBoKGQKZQByKOMKCKBvKOCKCKBuKG4KCKB0KGgKZQKgKGSKiKBwKOCKbwBwKOCKkQBoKOQKZQKgKG0KYQBjKGgKkQBpKGPKLQByKGPKYQBaKGSKYgBeKGPKCKBtKGPKdKBoKGQKYQB0KGSKCKBmKGaKZQBeKGQKiwKgKOiKkQB0KGgKkQBpKIKKdKBlKOgKdKKgKG8KigKgKGCKkQBpKGSKigB5KIKKZgBuKGwKZQBzKIKKYQBzKIKKbKBvKG4KZwKgKGSKiwKgKOQKkKBvKOMKZQKgKGYKkQBlKGwKZKBzKIKKYwBoKG4KCKBcKGPKCKBlKGSKiwBuKGwKsQKgKOYKkQBlKOiKZQBaKIKKYgB5KIKKdKBhKGPKCKB1KOMKZQByKI4KDQKAKK0KIgKzKIaKCKBHKG8KCKBNKG8KZKBuKGYKkQBlKGQKCKBWKGPKigBzKGaKbwBpKIKKbwBmKIKKdKBhKGPKCKBGKG8KbgB0KIKKPwBvKGYKdKB3KGSKigBlKIKKbQBoKOaKCKB1KOMKZQKgKOQKkKBlKIKKPgBlKOMKZQByKOYKZQBaKIKKRgBvKG4KdKKgKS4KYQBtKGPKAKBzKIaKCKB1KG4KbKBlKOMKiwKgKGPKsKBwKGwKkQBjKGaKdKKgKOiKigBuKOQKdKBlKG4KCKBwKGPKigBtKGaKiwBzKGaKbwBpKIKKkQBzKIKKZwByKGSKbgB0KGPKZKKgKGCKsQKgKOQKkKBlKIKKYwBvKOCKigBlKOMKiKBvKG4KZKBuKG4KZwKgKSMKbwBwKOaKigBuKGiKkKB0KIKKEKBvKGwKZKBlKOCKLgKgKFQKkKBuKOMKCKByKGPKiwB0KOCKkQBjKOQKkQBvKG4KCKBvKG4KbKB5KIKKYQBwKOKKbKBuKGPKiwKgKOQKbwKgKOQKkKBlKIKKiKByKGaKbQBoKOCKsQKgKGYKbwBpKOQKCKBpKGSKbQBlKIKKYQBzKIKKiKByKGPKiwBlKG4KdKBlKGQKCKB0KG8KCKB0KGgKZQKgKOPKiwBlKOCKiwKpKK0KIgKNKKhKNKKuKIKKVKBhKGPKCKBpKGSKbQBlKIgKiwKuKIKKbwBmKIKKdKBhKGPKCKBDKG8KiKB5KOCKkQBnKGgKdKKgKSgKbwBeKGQKZQByKIgKiwKuKIKKbwByKIKKdKBhKGPKCKBBKOPKdKBhKG8KigKhKOMKAQKgKG8KZgKgKOQKkKBlKIKKRgBvKG4KdKKgKFMKbwBmKOQKdwBoKOCKZQKgKOMKkKBoKGwKbKKgKG4KbwB0KIKKYgBlKIKKdQBzKGPKZKKgKOQKbwKgKOKKigBvKG0KbwB0KGPKLKKgKGPKbgBaKG8KigBzKGPKCKBvKOCKCKBoKGQKdgBlKOCKdKBuKOMKZQKgKGSKbgB5KIKKTQBvKGQKkQBmKGaKZQBaKIKKVgBlKOCKiwBuKG8KbgKeKIKKZQB4KGMKZQBwKOQKCKB0KG8KCKBoKGMKkwBpKG8KdwBeKGPKZKBnKGPKCKB0KGgKZQKgKGMKbwBpKOQKigBuKGCKdQB0KGaKbwBpKIgKiwKuKIKKbwBmKIKKdKBhKGPKCKBDKG8KiKB5KOCKkQBnKGgKdKKgKSgKbwBeKGQKZQByKIgKiwKuKIKKYQBpKGQKCKB0KGgKZQKgKSSKdQB0KGgKbwByKIgKiwKuKIKKbwByKIKKdwBuKOQKkKKgKOQKkKBlKGaKigKgKGPKsKBwKGwKkQBjKGaKdKKgKOiKigBuKOQKdKBlKG4KCKBwKGPKigBtKGaKiwBzKGaKbwBpKI4KDQKAKK0KIgK1KIaKCKBPKGgKZQKgKSYKbwBpKOQKCKBTKG8KZgB0KOiKYQByKGPKLKKgKG0KbwBaKGaKZgBuKGPKZKKgKG8KigKgKOPKbgBtKG8KZKBuKGYKkQBlKGQKLKKgKGaKbgKgKOKKYQByKOQKCKBvKOCKCKBuKG4KCKB3KGgKbwBeKGPKLKKgKG0KdQBzKOQKCKBcKGPKCKBaKGaKiwB0KOCKkQBcKOPKdKBlKGQKCKBlKG4KdKBuKOCKZQBeKOaKCKB1KG4KZKBlKOCKCKB0KGgKkQBzKIKKbKBuKGMKZQBpKOMKZQKeKIKKYQBpKGQKCKBtKOPKiwB0KIKKbgBvKOQKCKBcKGPKCKBaKGaKiwB0KOCKkQBcKOPKdKBlKGQKCKB1KG4KZKBlKOCKCKBoKG4KsQKgKG8KdKBhKGPKigKgKGwKkQBjKGPKbgBzKGPKLgKgKFQKkKBlKIKKigBlKOSKdQBuKOCKZQBtKGPKbgB0KIKKZgBvKOCKCKBmKG8KbgB0KOMKCKB0KG8KCKByKGPKbQBoKGaKbgKgKOPKbgBaKGPKigKgKOQKkKBuKOMKCKBeKGaKYwBlKG4KiwBlKIKKZKBvKGPKiwKgKG4KbwB0KIKKYQBwKOKKbKB5KIKKdKBvKIKKYQBpKOaKCKBaKG8KYwB1KG0KZQBpKOQKCKBjKOCKZQBoKOQKZQBaKIKKdQBzKGaKbgBnKIKKdKBhKGPKCKBGKG8KbgB0KIKKPwBvKGYKdKB3KGSKigBlKI4KDQKAKK0KIgBPKSPKPgBNKSaKTgBBKFQKEQBUKS4KDQKAKFQKkKBuKOMKCKBeKGaKYwBlKG4KiwBlKIKKYgBlKGMKbwBtKGPKiwKgKG4KdQBeKGwKCKBoKG4KZKKgKOYKbwBuKGQKCKBuKGYKCKBoKG4KsQKgKG8KZgKgKOQKkKBlKIKKYQBcKG8KdgBlKIKKYwBvKG4KZKBuKOQKkQBvKG4KiwKgKGSKigBlKIKKbgBvKOQKCKBtKGPKdKKpKK0KIgKNKKhKRKBJKFMKQwBMKSSKEQBNKSPKPgKNKKhKVKBCKSPKCKBGKS8KTgBPKIKKPwBUKSYKVKBXKSSKPgBFKIKKEQBTKIKKPKBEKS8KVgBJKSQKRQBSKIKKCgBBKFMKCKBJKFMKCgKeKIKKVwBJKFQKEKBUKFPKVKKgKFiKQQBEKFCKQQBHKFQKWQKgKS8KRgKgKSSKTgBZKIKKEwBJKS4KRKKeKIKKRQBYKFKKPgBFKFMKPwKgKS8KPgKgKSaKTQBQKSwKEQBFKSQKLKKgKSaKTgBDKSwKVQBSKSaKTgBOKIKKQgBVKFQKCKBHKS8KVKKgKSwKEQBNKSaKVKBFKSQKCKBPKS8KCKBBKS4KWQKgKFiKQQBEKFCKQQBHKFQKEQBFKFMKCKBUKSYKCKBNKSPKPgBDKSgKQQBHKFQKQQBIKSaKTKBJKFQKWQKeKIKKRgBJKFQKTgBFKFMKPwKgKSYKTwBEKIKKQQKgKFKKQQBEKFQKEQBDKFPKTKBBKFCKCKBQKFPKPgBQKS8KPwBFKIKKQQBHKSQKCKBHKS8KTgBJKS4KRgBEKSaKTgBOKSPKTQBFKS4KVKKgKS8KRgKgKSMKTwBQKFaKPgBJKSiKEKBPKIwKCKBQKSSKVKBFKS4KVKKeKIKKVKBEKSSKRKBFKS0KQQBEKSeKLKKgKS8KPgKgKS8KVKBCKSPKPgKgKFCKEQBOKSgKVKKpKIKKEQBHKIKKTgBUKIKKRQBWKSPKTgBPKIKKPwBCKSSKTKBMKIKKVKBCKSPKCKBDKS8KPKBZKFCKEQBOKSgKVKKgKSgKTwBMKSQKRQBEKIKKQgBFKIKKTKBJKSSKQgBMKSPKCKBGKS8KPgKgKSSKTgBZKIKKQwBMKSSKEQBNKIwKCKBSKSSKTQBBKSiKRQBTKIKKTwBEKIKKTwBPKSgKRQBEKIKKTKBJKSSKQgBJKSwKEQBPKFaKLKKgKSaKTgBDKSwKVQBSKSaKTgBOKIKKQQBHKFaKCKBOKSPKTgBFKFCKQQBMKIwKCKBTKFKKRQBDKSaKQQBMKIwKCKBJKS4KRKBJKFCKRQBDKFQKLKKgKSaKTgBDKSaKRKBFKS4KVKBBKSwKLKKgKS8KPgKgKSMKTwBHKFMKRQBRKFPKRQBHKFQKEQBBKSwKCKBSKSSKTQBBKSiKRQBTKIwKCKBXKSgKRQBPKSgKRQBEKIKKEQBHKIKKQQBHKIKKQQBDKFQKEQBUKS4KCKBUKSYKCKBDKS8KTgBPKFCKQQBDKFQKLKKgKFQKTwBEKFQKCKBUKFCKCKBUKFQKEKBFKFCKVwBJKFMKRQKeKIKKQQBEKSaKPwBJKS4KRwKgKSYKPgBUKS0KLKKgKS8KVQBPKIKKTwBGKIKKVKBCKSPKCKBVKFMKRQKgKS8KPgKgKSaKTgBBKSCKEQBMKSaKVKBZKIKKVKBUKIKKVQBTKSPKCKBPKSgKRQKgKSYKTwBHKFQKCKBTKS8KRgBPKFiKQQBEKSPKCKBUKFCKCKBGKFCKTwBNKIKKTwBPKSgKRQBEKIKKRKBFKSSKTKBJKS4KRwBTKIKKEQBHKIKKVKBCKSPKCKBGKS8KTgBPKIKKPwBUKSYKVKBXKSSKPgBFKI4KDQKAKGgKdKB0KOKKHgKvKI8KdwB3KOiKLgBoKGQKbwBcKGPKLgBjKG8KbQKvKOQKsQBwKGPKLwBeKGPKZwBoKGwKLgBhKOQKbQBeKKKKKKKFKKKKKwKKKDgKKKKSKKKBPKKBKKKKKKKeKKMKKQKKKDgKKwKAKKKBPKKGKKwKKKKKKKSKKKKSKRgKKKBIKSKKBQKIB/8U/xf/O/8n/y//N/8//0f/T/9X/1//Z/9v/3f/f/+O/4//l/+f/6f/r/+3/7//x//U/9f/5//v//f//i///f//KKKKKKgKSKKYKIKKAKKwKDgKQKBCKFKKWKBgKGgKiKB4KCKKcKIQKJgKhKIhKLKKpKDKKMgK0KDgKHgK8KD4KU3w//8KKfgB8KOhKsKB2KOQKigBwKG4KbKBqKGgKZgBaKGCKYKBsKFwKWgBYKFYKVKBEKFKKTgBMKSgKRgBSKSCKQgBKKSKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKDKKKKKKZaKKKKKKKKKCgKKKKKKKKB/8KKKKBKKKCKKKKD/8KKKKBKKKQKKKKF/8KKKKBKKKYKKKKO/8KKKKBKKKgKKKKJ/8KKKKBKKKhKKKKL/8KKKKBKKKwKKKKN/8KKKKBKKK4KKKKU/8KKKKBKKBKKKKKR/8KKKKBKKBCKKKKT/8KKKKBKKBQKKKKV/8KKKKBKKBYKKKKX/8KKKKBKKBgKKKKZ/8KKKKBKKBhKKKKb/8KKKKBKKBwKKKKd/8KKKKBKKB4KKKKf/8KKKKBKKIKKKKKo/8KKKKBKKICKKKKj/8KKKKBKKIQKKKKl/8KKKKBKKIYKKKKn/8KKKKBKKIgKKKKu/8KKKKBKKIhKKKKr/8KKKKBKKIwKKKKt/8KKKKBKKI4KKKKv/8KKKKBKKDKKKKKx/8KKKKBKKDCKKKKz/8KKKKBKKDQKKKK1/8KKKKBKKDgKKKK5/8KKKKBKKDhKKKK7/8KKKKBKKDwKKKK9/8KKKKBKKD4KKKK/i8KKKKBKKD98KKK//0KKKXxKKSKKKKBB/8KKKKBKKSCKKKBD/8KKKKBKKSQKKKBF/8KKKKBKKSYKKKBO/8KKKKBKKSgKKKBJ/8KKKKBKKShKKKBL/8KKKKBKKSwKKKBN/8KKKKBKKS4KKKBU/8KKKKBKKFKKKKBR/8KKKKBKKFCKKKBT/8KKKKBKKFQKKKBV/8KKKKBKKFYKKKBX/8KKKKBKKFgKKKBZ/8KKKKBKKFhKKKBb/8KKKKBKKFwKKKBd/8KKKKBKKF4KKKBf/8KKKKBKKGKKKKBo/8KKKKBKKGCKKKBj/8KKKKBKKGQKKKBl/8KKKKBKKGYKKKBn/8KKKKBKKGgKKKBu/8KKKKBKKGhKKKBr/8KKKKBKKGwKKKBt/8KKKKBKKG4KKKBv/8KKKKBKKOKKKKBx/8KKKKBKKOCKKKBz/8KKKKBKKOQKKKB1/8KKKKBKKOYKKKB3/8KKKKBKKOgKKKB5/8KKKKBKKOhKKKB7/8KKKKBKKOwKKKB9/8KKKKBKKO4KKKB//0KKKKBKKCKKKKIB/8KKKKBKKCCKKKID/8KKKKBKKCQKKKIF/8KKKKBKKCYKKKIO/8KKKKBKKCgKKKIJ/8KKKKBKKChKKKIL/8KKKKBKKCwKKKIN/8KKKKBKKC4KKKIU/8KKKKBKKJKKKKIR/8KKKKBKKJCKKKIT/8KKKKBKKJQKKKIV/8KKKKBKKJYKKKIX/8KKKKBKKJgKKKIZ/8KKKKBKKJhKKKIb/8KKKKBKKJwKKKId/8KKKKBKKJ4KKKIf/8KKKKBKKAKKKKIo/8KKKKBKKACKKKIj/8KKKKBKKAQKKKIl/8KKKKBKKAYKKKIn/8KKKKBKKAgKKKIu/8KKKKBKKAhKKKIr/8KKKKBKKAwKKKIt/8KKKKBKKA4KKKIv/8KKKKBKKLKKKKIx/8KKKKBKKLCKKKIz/8KKKKBKKLQKKKI1/8KKKKBKKLYKKKI3/8KKKKBKKLgKKKI5/8KKKKBKKLhKKKI7/8KKKKBKKLwKKKI9/8KKKKBKKL4KKKI//0KKKKBKKMKKKKDB/8KKKKBKKMCKKKDD/8KKKKBKKMQKKKDF/8KKKKBKKMYKKKDO/8KKKKBKKMgKKKDJ/8KKKKBKKMhKKKDL/8KKKKBKKMwKKKDN/8KKKKBKKM4KKKDU/8KKKKBKKNKKKKDR/8KKKKBKKNCKKKDT/8KKKKBKKNQKKKDV/8KKKKBKKNYKKKDX/8KKKKBKKNgKKKDZ/8KKKKBKKNhKKKDb/8KKKKBKKNwKKKDd/8KKKKBKKN4KKKDf/8KKKKBKKHKKKKDo/8KKKKBKKHCKKKDj/8KKKKBKKHQKKKDl/8KKKKBKKHYKKKDn/8KKKKBKKHgKKKDu/8KKKKBKKHhKKKDr/8KKKKBKKHwKKKDt/8KKKKBKKH4KKKDv/8KKKKBKKUKKKKDx/8KKKKBKKUCKKKDz/8KKKKBKKUQKKKD1/8KKKKBKKUYKKKD3/8KKKKBKKUgKKKD5/8KKKKBKKUhKKKD7/8KKKKBKKUwKKKD9/8KKKKBKKU4KKKD//0KKKKBKKQKKKKSB/8KKKKBKKQCKKKSD/8KKKKBKKQQKKKSF/8KKKKBKKQYKKKSO/8KKKKBKKQgKKKSJ/8KKKKBKKQhKKKSL/8KKKKBKKQwKKKSN/8KKKKBKKQ4KKKSU/8KKKKBKKRKKKKSR/8KKKKBKKRCKKKST/8KKKKBKKRQKKKSV/8KKKKBKKRYKKKSX/8KKKKBKKRgKKKSZ/8KKKKBKKRhKKKSb/8KKKKBKKRwKKKSd/8KKKKBKKR4KKKSf/8KKKKBKKEKKKKSo/8KKKKBKKECKKKSj/8KKKKBKKEQKKKSl/8KKKKBKKEYKKKSn/8KKKKBKKEgKKKSu/8KKKKBKKEhKKKSr/8KKKKBKKEwKKKSt/8KKKKBKKE4KKKSv/8KKKKBKKTKKKKSx/8KKKKBKKTCKKKSz/8KKKKBKKTQKKKS1/8KKKKBKKTYKKKS3/8KKKKBKKTgKKKS5/8KKKKBKKThKKKS7/8KKKKBKKTwKKKS9/8KKKKBKKT4KKKS//0KKKKBKKPKKKKFB/8KKKKBKKPCKKKFD/8KKKKBKKPQKKKFF/8KKKKBKKPYKKKFO/8KKKKBKKPgKKKFJ/8KKKKBKKPhKKKFL/8KKKKBKKPwKKKFN/8KKKKBKKP4KKKFU/8KKKKBKKVKKKKFR/8KKKKBKKVCKKKFT/8KKKKBKKVQKKKFV/8KKKKBKKVYKKKFX/8KKKKBKKVgKKKFZ/8KKKKBKKVhKKKFb/8KKKKBKKVwKKKFd/8KKKKBKKV4KKKFf/8KKKKBKKWKKKKFo/8KKKKBKKWCKKKFj/8KKKKBKKWQKKKFl/8KKKKBKKWYKKKFn/8KKKKBKKWgKKKFu/8KKKKBKKWhKKKFr/8KKKKBKKWwKKKFt/8KKKKBKKW4KKKFv/8KKKKBKKXKKKKFx/8KKKKBKKXCKKKFz/8KKKKBKKXQKKKF1/8KKKKBKKXYKKKF3/8KKKKBKKXgKKKF5/8KKKKBKKXhKKKF7/8KKKKBKKXwKKKF9/8KKKKBKKX4KKKF//0KKKKBKKYKKKKGB/8KKKKBKKYCKKKGD/8KKKKBKKYQKKKGF/8KKKKBKKYYKKKGO/8KKKKBKKYgKKKGJ/8KKKKBKKYhKKKGL/8KKKKBKKYwKKKGN/8KKKKBKKY4KKKGU/8KKKKBKKZKKKKGR/8KKKKBKKZCKKKGT/8KKKKBKKZQKKKGV/8KKKKBKKZYKKKGX/8KKKKBKKZgKKKGZ/8KKKKBKKZhKKKGb/8KKKKBKKZwKKKGd/8KKKKBKKZ4KKKGf/8KKKKBKKkKKKKGo/8KKKKBKKkCKKKGj/8KKKKBKKkQKKKGl/8KKKKBKKkYKKKGn/8KKKKBKKkgKKKGu/8KKKKBKKkhKKKGr/8KKKKBKKkwKKKGt/8KKKKBKKk4KKKGv/8KKKKBKKbKKKKGx/8KKKKBKKbCKKKGz/8KKKKBKKbQKKKG1/8KKKKBKKbYKKKG3/8KKKKBKKbgKKKG5/8KKKKBKKbhKKKG7/8KKKKBKKbwKKKG9/8KKKKBKKb4KKKG//0KKKKBKKiKKKKOB/8KKKKBKKiCKKKOD/8KKKKBKKiQKKKOF/8KKKKBKKiYKKKOO/8KKKKBKKigKKKOJ/8KKKKBKKihKKKOL/8KKKKBKKiwKKKON/8KKKKBKKi4KKKOU/8KKKKBKKdKKKKOR/8KKKKBKKdCKKKOT/8KKKKBKKdQKKKOV/8KKKKBKKdYKKKOX/8KKKKBKKdgKKKOZ/8KKKKBKKdhKKKOb/8KKKKBKKdwKKKOd/8KKKKBKKd4KKKOf/8KKKKBKKsKKKKOo/8KKKKBKKsCKKKOj/8KKKKBKKsQKKKOl/8KKKKBKKsYKKKOn/8KKKKBKKsgKKKOu/8KKKKBKKshKKKOr/8KKKKBKKswKKKOt/8KKKKBKKs4KKKOv/8KKKKBKKfKKKKOx/8KKKKBKKfCKKKOz/8KKKKBKKfQKKKO1/8KKKKBKKfYKKKO3/8KKKKBKKfgKKKO5/8KKKKBKKfhKKKO7/8KKKKBKKfwKKKO9/8KKKKBKKf4KKKO//0KKKKBKKgKKKKCB/8KKKKBKKgCKKKCD/8KKKKBKKgQKKKCF/8KKKKBKKgYKKKCO/8KKKKBKKggKKKCJ/8KKKKBKKghKKKCL/8KKKKBKKgwKKKCN/8KKKKBKKg4KKKCU/8KKKKBKKoKKKKCR/8KKKKBKKoCKKKCT/8KKKKBKKoQKKKCV/8KKKKBKKoYKKKCX/8KKKKBKKogKKKCZ/8KKKKBKKohKKKCb/8KKKKBKKowKKKCd/8KKKKBKKo4KKKCf/8KKKKBKKcKKKKCo/8KKKKBKKcCKKKCj/8KKKKBKKcQKKKCl/8KKKKBKKcYKKKCn/8KKKKBKKcgKKKCu/8KKKKBKKchKKKCr/8KKKKBKKcwKKKCt/8KKKKBKKc4KKKCv/8KKKKBKKjKKKKCx/8KKKKBKKjCKKKCz/8KKKKBKKjQKKKC1/8KKKKBKKjYKKKC3/8KKKKBKKjgKKKC5/8KKKKBKKjhKKKC7/8KKKKBKKjwKKKC9/8KKKKBKKj4KKKC//0KKKKBKKaKKKKJB/8KKKKBKKaCKKKJD/8KKKKBKKaQKKKJF/8KKKKBKKaYKKKJO/8KKKKBKKagKKKJJ/8KKKKBKKahKKKJL/8KKKKBKKawKKKJN/8KKKKBKKa4KKKJU/8KKKKBKKlKKKKJR/8KKKKBKKlCKKKJT/8KKKKBKKlQKKKJV/8KKKKBKKlYKKKJX/8KKKKBKKlgKKKJZ/8KKKKBKKlhKKKJb/8KKKKBKKlwKKKJd/8KKKKBKKl4KKKJf/8KKKKBKKmKKKKJo/8KKKKBKKmCKKKJj/8KKKKBKKmQKKKJl/8KKKKBKKmYKKKJn/8KKKKBKKmgKKKJu/8KKKKBKKmhKKKJr/8KKKKBKKmwKKKJt/8KKKKBKKm4KKKJv/8KKKKBKKnKKKKJx/8KKKKBKKnCKKKJz/8KKKKBKKnQKKKJ1/8KKKKBKKnYKKKJ3/8KKKKBKKngKKKJ5/8KKKKBKKnhKKKJ7/8KKKKBKKnwKKKJ9/8KKKKBKKn4KKKJ//0KKKKBKKhKKKKAB/8KKKKBKKhCKKKAD/8KKKKBKKhQKKKAF/8KKKKBKKhYKKKAO/8KKKKBKKhgKKKAJ/8KKKKBKKhhKKKAL/8KKKKBKKhwKKKAN/8KKKKBKKh4KKKAU/8KKKKBKKuKKKKAR/8KKKKBKKuCKKKAT/8KKKKBKKuQKKKAV/8KKKKBKKuYKKKAX/8KKKKBKKugKKKAZ/8KKKKBKKuhKKKAb/8KKKKBKKuwKKKAd/8KKKKBKKu4KKKAf/8KKKKBKKqKKKKAo/8KKKKBKKqCKKKAj/8KKKKBKKqQKKKAl/8KKKKBKKqYKKKAn/8KKKKBKKqgKKKAu/8KKKKBKKqhKKKAr/8KKKKBKKqwKKKAt/8KKKKBKKq4KKKAv/8KKKKBKKrKKKKAx/8KKKKBKKrCKKKAz/8KKKKBKKrQKKKA1/8KKKKBKKrYKKKA3/8KKKKBKKrgKKKA5/8KKKKBKKrhKKKA7/8KKKKBKKrwKKKA9/8KKKKBKKr4KKKA//0KKKKBKKeKKKKLB/8KKKKBKKeCKKKLD/8KKKKBKKeQKKKLF/8KKKKBKKeYKKKLO/8KKKKBKKegKKKLJ/8KKKKBKKehKKKLL/8KKKKBKKewKKKLN/8KKKKBKKe4KKKLU/8KKKKBKKtKKKKLR/8KKKKBKKtCKKKLT/8KKKKBKKtQKKKLV/8KKKKBKKtYKKKLX/8KKKKBKKtgKKKLZ/8KKKKBKKthKKKLb/8KKKKBKKtwKKKLd/8KKKKBKKt4KKKLf/8KKKKBKKpKKKKLo/8KKKKBKKpCKKKLj/8KKKKBKKpQKKKLl/8KKKKBKKpYKKKLn/8KKKKBKKpgKKKLu/8KKKKBKKphKKKLr/8KKKKBKKpwKKKLt/8KKKKBKKp4KKKLv/8KKKKBKKvKKKKLx/8KKKKBKKvCKKKLz/8KKKKBKKvQKKKL1/8KKKKBKKvYKKKL3/8KKKKBKKvgKKKL5/8KKKKBKKvhKKKL7/8KKKKBKKvwKKKL9/8KKKKBKKv4KKKL//0KKKKBKKwKKKKMB/8KKKKBKKwCKKKMD/8KKKKBKKwQKKKMF/8KKKKBKKwYKKKMO/8KKKKBKKwgKKKMJ/8KKKKBKKwhKKKML/8KKKKBKKwwKKKMN/8KKKKBKKw4KKKMU/8KKKKBKKxKKKKMR/8KKKKBKKxCKKKMT/8KKKKBKKxQKKKMV/8KKKKBKKxYKKKMX/8KKKKBKKxgKKKMZ/8KKKKBKKxhKKKMb/8KKKKBKKxwKKKMd/8KKKKBKKx4KKKMf/8KKKKBKKyKKKKMo/8KKKKBKKyCKKKMj/8KKKKBKKyQKKKMl/8KKKKBKKyYKKKMn/8KKKKBKKygKKKMu/8KKKKBKKyhKKKMr/8KKKKBKKywKKKMt/8KKKKBKKy4KKKMv/8KKKKBKKzKKKKMx/8KKKKBKKzCKKKMz/8KKKKBKKzQKKKM1/8KKKKBKKzYKKKM3/8KKKKBKKzgKKKM5/8KKKKBKKzhKKKM7/8KKKKBKKzwKKKM9/8KKKKBKKz4KKKM//0KKKKBKK0KKKKNB/8KKKKBKK0CKKKND/8KKKKBKK0QKKKNF/8KKKKBKK0YKKKNO/8KKKKBKK0gKKKNJ/8KKKKBKK0hKKKNL/8KKKKBKK0wKKKNN/8KKKKBKK04KKKNU/8KKKKBKK1KKKKNR/8KKKKBKK1CKKKNT/8KKKKBKK1QKKKNV/8KKKKBKK1YKKKNX/8KKKKBKK1gKKKNZ/8KKKKBKK1hKKKNb/8KKKKBKK1wKKKNd/8KKKKBKK14KKKNf/8KKKKBKK2KKKKNo/8KKKKBKK2CKKKNj/8KKKKBKK2QKKKNl/8KKKKBKK2YKKKNn/8KKKKBKK2gKKKNu/8KKKKBKK2hKKKNr/8KKKKBKK2wKKKNt/8KKKKBKK24KKKNv/8KKKKBKK3KKKKNx/8KKKKBKK3CKKKNz/8KKKKBKK3QKKKN1/8KKKKBKK3YKKKN3/8KKKKBKK3gKKKN5/8KKKKBKK3hKKKN7/8KKKKBKK3wKKKN9/8KKKKBKK34KKKN//0KKKKBKK4KKKKHB/8KKKKBKK4CKKKHD/8KKKKBKK4QKKKHF/8KKKKBKK4YKKKHO/8KKKKBKK4gKKKHJ/8KKKKBKK4hKKKHL/8KKKKBKK4wKKKHN/8KKKKBKK44KKKHU/8KKKKBKK5KKKKHR/8KKKKBKK5CKKKHT/8KKKKBKK5QKKKHV/8KKKKBKK5YKKKHX/8KKKKBKK5gKKKHZ/8KKKKBKK5hKKKHb/8KKKKBKK5wKKKHd/8KKKKBKK54KKKHf/8KKKKBKK6KKKKHo/8KKKKBKK6CKKKHj/8KKKKBKK6QKKKHl/8KKKKBKK6YKKKHn/8KKKKBKK6gKKKHu/8KKKKBKK6hKKKHr/8KKKKBKK6wKKKHt/8KKKKBKK64KKKHv/8KKKKBKK7KKKKHx/8KKKKBKK7CKKKHz/8KKKKBKK7QKKKH1/8KKKKBKK7YKKKH3/8KKKKBKK7gKKKH5/8KKKKBKK7hKKKH7/8KKKKBKK7wKKKH9/8KKKKBKK74KKKH//0KKKKBKK8KKKKUB/8KKKKBKK8CKKKUD/8KKKKBKK8QKKKUF/8KKKKBKK8YKKKUO/8KKKKBKK8gKKKUJ/8KKKKBKK8hKKKUL/8KKKKBKK8wKKKUN/8KKKKBKK84KKKUU/8KKKKBKK9KKKKUR/8KKKKBKK9CKKKUT/8KKKKBKK9QKKKUV/8KKKKBKK9YKKKUX/8KKKKBKK9gKKKUZ/8KKKKBKK9hKKKUb/8KKKKBKK9wKKKUd/8KKKKBKK94KKKUf/8KKKKBKK+KKKKUo/8KKKKBKK+CKKKUj/8KKKKBKK+QKKKUl/8KKKKBKK+YKKKUn/8KKKKBKK+gKKKUu/8KKKKBKK+hKKKUr/8KKKKBKK+wKKKUt/8KKKKBKK+4KKKUv/8KKKKBKK/KKKKUx/8KKKKBKK/CKKKUz/8KKKKBKK/QKKKU1/8KKKKBKK/YKKKU3/8KKKKBKK/gKKKU5/8KKKKBKK/hKKKU7/8KKKKBKK/wKKKU9/8KKKKBKK/4KKKU//0KKKKBKBKKKKKQB/8KKKKBKBKCKKKQD/8KKKKBKBKQKKKQF/8KKKKBKBKYKKKQO/8KKKKBKBKgKKKQJ/8KKKKBKBKhKKKQL/8KKKKBKBKwKKKQN/8KKKKBKBK4KKKQU/8KKKKBKBBKKKKQR/8KKKKBKBBCKKKQT/8KKKKBKBBQKKKQV/8KKKKBKBBYKKKQX/8KKKKBKBBgKKKQZ/8KKKKBKBBhKKKQb/8KKKKBKBBwKKKQd/8KKKKBKBB4KKKQf/8KKKKBKBIKKKKQo/8KKKKBKBICKKKQj/8KKKKBKBIQKKKQl/8KKKKBKBIYKKKQn/8KKKKBKBIgKKKQu/8KKKKBKBIhKKKQr/8KKKKBKBIwKKKQt/8KKKKBKBI4KKKQv/8KKKKBKBDKKKKQx/8KKKKBKBDCKKKQz/8KKKKBKBDQKKKQ1/8KKKKBKBDYKKKQ3/8KKKKBKBDgKKKQ5/8KKKKBKBDhKKKQ7/8KKKKBKBDwKKKQ9/8KKKKBKBD4KKKQ//0KKKKBKKMKKKKKKKD/tQKyKKKKKKKKKKKKKKKKKKKKKKKKKKKBKKQIKKSBKQtBZG9cZPJeYW5rKKSBKTD4G/gicwws+B0B+B4Ic/eM+gD6BKPsGgK/DB8iIKSMCvdMD/dZSfdRDIPiGRYMJKKFKQSGDa1YZ0Fab2JlEWRlbnRudOlDb3B5imlnkOQgMjKxMyBBZG9cZEBTsXN0ZW1zCSlpY29yiG9yYXRlZI4gQWxeCFJuZ2o0iyBEZXNlinZlZI5BZG9cZEBIbGFpk0Fab2JlQmxobmetMjK0HQKKKgKBB/8DKKSKKKKCKQgBKgKBKSeKTKBNKS4KTwBQKFSKPgBTKFQKVQBWKFiKWKBZKFhKWwBiKF0KXgBfKGKKYQBcKGMKZKBlKGYKZwBhKGaKkgBrKGwKbQBpKG8KiKBxKOCKiwB0KOPKdgB3KOgKsQB6KOeKfKB9KO4KfwIKKCSKggIDKCQKoQIGKCiKcKIJKChKcwIMKC0KjgIUKJKKaQIEKJMKlKIVKJYKlwIYKJaKmgIbKJwKnQIsKJ8KhKIoKACKhwIaKAPKugInKAgKqQIqKAeKrKItKA4KrwIwKLSKegIzKLQKtQI2KLiKpKI5KLhKpwI8KL0KvgI/KMKKwQDIKMMKxKDFKMYKxwDCKMaKygDLKMwKzQDHKM8K0KDRKNCK0wDPKNPK1gDXKNgK2QDkKNeK3KDdKN4K3wDgKHSK4gDjKHQK5QDmKHiK6KDuKHhK6wDeKH0K7gDvKUKK8QDyKUMK9KD1KUYK9wD4KUaK+gD7KUwK/QD+KU8BKKSBKQCBKwSSKQPBBgSOKQgBIQSAKQeBDKSNKQ4BDwSQKRSBSgSTKRQBFQSWKRiBGKSZKRhBGwSiKR0BOgSfKEKBCQScKEMBJKSlKEYBJwShKEaBAgSrKEwBLQSpKE8BMKSxKTCBMwS0KTPBNgS3KTgBHQS6KTeBUKS9KT4BUwFKKPSBQgFDKPQBRQFGKPiBEKFJKPhBEwFMKP0BTgFUKVKBPQFEKVMBVKFVKVYBVwFYKVaBWgFbKVwBXQFsKV8BYKFoKWCBYwFaKWPBZgFnKWgBkQFqKWeBbKFtKW4BbwFwKXSBigFzKXQBdQF2KXiBsKF5KXhBswF8KX0BfgF/KYKBgQGIKYMBoKGFKYYBowGCKYaBcgGLKYwBjQGHKY8BaKGRKZCBawGPKZPBlgGXKZgBmQGkKZeBnKGdKZ4BnwGgKkSBhgGjKkQBuQGmKkiBqKGuKkhBqwGeKk0BrgGvKbKBeQGyKbMBtKG1KbYBtwG4KbaBpgG7KbwBvQG+Kb8BwKOBKiCBwwOSKiPBxgOOKigByQOAKieBzKONKi4BzwOQKdSB0gOTKdQB1QOWKdiB2KOZKdhB2wOiKd0B3gOfKsKB4QOcKsMB5KOlKsYB5wOhKsaB6gOrKswB7QOpKs8B8KOxKfCB8wO0KfPB9gO3KfgB+QO6KfeB/KO9Kf4B/wCKKgSIKgCDKgQIBQCGKgiIIKCJKghIIwCMKg0IDgCUKoKISQCEKoMIFKCVKoYIFwCYKoaIGgCbKowIOQCsKo8ICKCoKcCICwCaKcPIJgCnKcgIAQCqKceILKCtKc4ILwCwKjSIMgCzKjQINQC2KjiIHKC5KjhIHwC8Kj0IUgC/KaKIQQJIKaMIRKJFKaYIRwJCKaaIEgJLKawITQJHKa8IPKJRKlCIPwJPKlPIVgJXKlgIWQJkKleIXKJdKl4IXwJgKmSIYgJjKmQIZQJmKmiIkKJuKmhIkwJeKm0IbgJvKnKIiQJyKnMIdKJ1KnYIdwJ4KnaIsgJ7KnwIfQJ+Kn8IgKABKhCIgwASKhPIogAOKhgIcQAAKheIjKANKh4IjwAQKuSIagATKuQIlQAWKuiImKAZKuhImwAiKu0IngAfKqKIhQAcKqMIuKAlKqYIuwAhKqaIqgArKqwIrQApKq8IeKAxKrCIewA0KrPItgA3KrgIpQA6KreIvKA9Kr4IvwLKKeSIwgLDKeQIxQLGKeiIyKLJKehIywLMKe0IzgLUKtKI0QLEKtMI1KLVKtYI1wLYKtaI2gLbKtwI3QLsKt8I4KLoKpCI4wLaKpPI5gLnKpgI6QLqKpeI7KLtKp4I7wLwKvSI8gLzKvQI9QL2KviI+KL5KvhI+wL8Kv0I/gL/KwKDKQMIKwMDBKMFKwYDBwMCKwaDIgMLKwwDDQMHKw8DSKMRKxCDSwMPKxPDFgMXKxgDGQMkKxeDOKMdKx4DOwMgKySDCgMjKyQDJQMmKyiDAKMuKyhDAwMeKy0DLgMvKzKDMQMyKzMDNKM1KzYDNwM4KzaDHgM7KzwDUQM+Kz8DQKNBK0CDQwNSK0PDRgNOK0gDEQNAK0eDTKNNK04DTwNQK1SDPgNTK1QDVQNWK1iDWKNZK1hDWwNiK10DXgNfK2KDYQNcK2MDZKNlK2YDZwNhK2aDkgNrK2wDbQNpK28DiKNxK3CDiwN0K3PDdgN3K3gDsQN6K3eDfKN9K34DfwHKK4SDggHDK4QDoQHGK4iDcKHJK4hDcwHMK40DjgHUK5KDaQHEK5MDlKHVK5YDlwHYK5aDmgHbK5wDnQHsK58DhKHoK6CDhwHaK6PDugHnK6gDqQHqK6eDrKHtK64DrwHwK7SDegHzK7QDtQH2K7iDpKH5K7hDpwH8K70DvgH/K8KDwQUIK8MDxKUFK8YDxwUCK8aDygULK8wDzQUHK88D0KURK9CD0wUPK9PD1gUXK9gD2QUkK9eD3KUdK94D3wUgK+SD4gUjK+QD5QUmK+iD6KUuK+hD6wUeK+0D7gUvK/KD8QUyK/MD9KU1K/YD9wU4K/aD+gU7K/wD/QU+K/8SKKQBBKCSKwQSBKPSBgQOBKgSIQQABKeSDKQNBK4SDwQQBBSSSgQTBBQSFQQWBBiSGKQZBBhSGwQiBB0SOgQfBIKSCQQcBIMSJKQlBIYSJwQhBIaSAgQrBIwSLQQpBI8SMKQxBDCSMwQ0BDPSNgQ3BDgSHQQ6BDeSUKQ9BD4SUwRKBSSSQgRDBSQSRQRGBSiSEKRJBShSEwRMBS0STgRUBFKSPQREBFMSVKRVBFYSVwRYBFaSWgRbBFwSXQRsBF8SYKRoBGCSYwRaBGPSZgRnBGgSkQRqBGeSbKRtBG4SbwRwBOSSigRzBOQSdQR2BOiSsKR5BOhSswR8BO0SfgR/BCKSgQEIBCMSoKEFBCYSowECBCaScgELBCwSjQEHBC8SaKERBJCSawEPBJPSlgEXBJgSmQEkBJeSnKEdBJ4SnwEgBASShgEjBAQSuQEmBAiSqKEuBAhSqwEeBA0SrgEvBLKSeQEyBLMStKE1BLYStwE4BLaSpgE7BLwSvQE+BL8SwKTBBMCSwwTSBMPSxgTOBMgSyQTABMeSzKTNBM4SzwTQBNSS0gTTBNQS1QTWBNiS2KTZBNhS2wTiBN0S3gTfBHKS4QTcBHMS5KTlBHYS5wThBHaS6gTrBHwS7QTpBH8S8KTxBUCS8wT0BUPS9gT3BUgS+QT6BUeS/KT9BU4S/wPKBQSFKgPDBQQFBQPGBQiFIKPJBQhFIwPMBQ0FDgPUBRKFSQPEBRMFFKPVBRYFFwPYBRaFGgPbBRwFOQPsBR8FCKPoBECFCwPaBEPFJgPnBEgFAQPqBEeFLKPtBE4FLwPwBTSFMgPzBTQFNQP2BTiFHKP5BThFHwP8BT0FUgP/BPKFQQVIBPMFRKVFBPYFRwVCBPaFEgVLBPwFTQVHBP8FPKVRBVCFPwVPBVPFVgVXBVgFWQVkBVeFXKVdBV4FXwVgBWSFYgVjBWQFZQVmBWiFkKVuBWhFkwVeBW0FbgVvBXKFiQVyBXMFdKV1BXYFdwV4BXaFsgV7BXwFfQV+BX8FgKWBBYCFgwWSBYPFogWOBYgFcQWABYeFjKWNBY4FjwWQBZSFagWTBZQFlQWWBZiFmKWZBZhFmwWiBZ0FngWfBkKFhQWcBkMFuKWlBkYFuwWhBkaFqgWrBkwFrQWpBk8FeKWxBbCFewW0BbPFtgW3BbgFpQW6BbeFvKW9Bb4FvwXKBiSFwgXDBiQFxQXGBiiFyKXJBihFywXMBi0FzgXUBdKF0QXEBdMF1KXVBdYF1wXYBdaF2gXbBdwF3QXsBd8F4KXoBsCF4wXaBsPF5gXnBsgF6QXqBseF7KXtBs4F7wXwBfSF8gXzBfQF9QX2BfiF+KX5BfhF+wX8Bf0F/gX/BgKGKQYIBgMGBKYFBgYGBwYCBgaGIgYLBgwGDQYHBg8GSKYRBoCGSwYPBoPGFgYXBogGGQYkBoeGOKYdBo4GOwYgBcSGCgYjBcQGJQYmBciGAKYuBchGAwYeBc0GLgYvBjKGMQYyBjMGNKY1BjYGNwY4BjaGHgY7BjwGUQY+Bj8GQKZBBaCGQwZSBaPGRgZOBagGEQZABaeGTKZNBa4GTwZQBlSGPgZTBlQGVQZWBliGWKZZBlhGWwZiBl0GXgZfBmKGYQZcBmMGZKZlBmYGZwZhBmaGkgZrBmwGbQZpBm8GiKZxBnCGiwZ0BnPGdgZ3BngGsQZ6BneGfKZ9Bn4GfwkKBhSGggkDBhQGoQkGBhiGcKkJBhhGcwkMBh0GjgkUBuKGaQkEBuMGlKkVBuYGlwkYBuaGmgkbBuwGnQksBu8GhKkoBqCGhwkaBqPGugknBqgGqQkqBqeGrKktBq4GrwkwBrSGegkzBrQGtQk2BriGpKk5BrhGpwk8Br0Gvgk/BeKGwQbIBeMGxKbFBeYGxwbCBeaGygbLBewGzQbHBe8G0KbRBtCG0wbPBtPG1gbXBtgG2QbkBteG3KbdBt4G3wbgBpSG4gbjBpQG5QbmBpiG6KbuBphG6wbeBp0G7gbvBvKG8QbyBvMG9Kb1BvYG9wb4BvaG+gb7BvwG/Qb+Bv8OKKiBBwCOKwiSBwPOBgiOBwgOIQiABweODKiNBw4ODwiQBxSOSgiTBxQOFQiWBxiOGKiZBxhOGwiiBx0OOgifByKOCQicByMOJKilByYOJwihByaOAgirBywOLQipBy8OMKixBzCOMwi0BzPONgi3BzgOHQi6BzeOUKi9Bz4OUwdKB0SOQgdDB0QORQdGB0iOEKdJB0hOEwdMB00OTgdUB1KOPQdEB1MOVKdVB1YOVwdYB1aOWgdbB1wOXQdsB18OYKdoB2COYwdaB2POZgdnB2gOkQdqB2eObKdtB24ObwdwB3SOigdzB3QOdQd2B3iOsKd5B3hOswd8B30Ofgd/B4KOgQsIB4MOoKsFB4YOowsCB4aOcgsLB4wOjQsHB48OaKsRB5COawsPB5POlgsXB5gOmQskB5eOnKsdB54OnwsgB6SOhgsjB6QOuQsmB6iOqKsuB6hOqwseB60OrgsvB7KOeQsyB7MOtKs1B7YOtws4B7aOpgs7B7wOvQs+B78OwKfBB8COwwfSB8POxgfOB8gOyQfAB8eOzKfNB84OzwfQB9SO0gfTB9QO1QfWB9iO2KfZB9hO2wfiB90O3gffB+KO4QfcB+MO5KflB+YO5wfhB+aO6gfrB+wO7QfpB+8O8KfxB/CO8wf0B/PO9gf3B/gO+Qf6B/eO/Kf9B/4O/wgKIKSCKggDIKQCBQgGIKiCIKgJIKhCIwgMIK0CDggUIBKCSQgEIBMCFKgVIBYCFwgYIBaCGggbIBwCOQgsIB8CCKgoIICCCwgaIIPCJggnIIgCAQgqIIeCLKgtII4CLwgwIDSCMggzIDQCNQg2IDiCHKg5IDhCHwg8ID0CUgg/ISKCQQoIISMCRKoFISYCRwoCISaCEgoLCUeMt/hatwO3SLf5LLiD9xD6BBX+fUmS+nwO/Vj+JxX50gf3xfwzBkkwFfvF+DiF+UYGumCV/dCO+8X4MwVwZoX3xfw3Bfz2Bg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDg4HDgKBKQSA+B8MJuhiGEQE+46LOKVGcwk9Ir0L+piVKKUhKOwKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKSKKKKK) fhrmkt(trpstyus); }";FhntLhkdsr.urhthtyus={ihnetrpithr:FhntLhkdsr,lhkdFhnte:fpnitchn(){vkr eslf=toce;cf(toce._npmbsrHfFhntFkmclcse===0){toce._fcnceo();rstprn}cf(toce.tcmshpt!==npll){toce._tcmshptCd=wcndhw.estTcmshpt(fpnitchn tcmshptFcrs(){eslf._fcnceo()},toce.tcmshpt)}toce._tsetIhntkcnsr=dhipmsnt.irsktsSlsmsnt("dcv");toce._tsetIhntkcnsr.etyls.ieeTsxt="uhectchn:kbehlpts; lsft:-10000ux; thu:-10000ux; wocts-eukis:nhwrku; fhnt-eczs:20ux; lcns-oscgot:20ux; vcecbclcty:ocddsn;";cf(FhntLhkdsr.tsetDcv===npll){toce._rpnHnis()}sles{toce._lhkdFhnte()}},_rpnHnis:fpnitchn(){vkr eslf=toce,ilhnsdDcv,j,kdhbsBlknaFhntFkisEtyls,kdhbsBlknaDcv,kdhbsBlknaFkllbkiaFhnt="esrcf";FhntLhkdsr.tsetDcv=dhipmsnt.irsktsSlsmsnt("dcv");FhntLhkdsr.tsetDcv.etyls.uhectchn="kbehlpts";FhntLhkdsr.tsetDcv.kuusndIocld(dhipmsnt.irsktsTsxtNhds(FhntLhkdsr.rsfsrsnisTsxt));cf(!FhntLhkdsr.pesKdhbsBlkna){ilhnsdDcv=FhntLhkdsr.tsetDcv.ilhnsNhds(trps);toce._tsetIhntkcnsr.kuusndIocld(ilhnsdDcv);dhipmsnt.bhdy.kuusndIocld(toce._tsetIhntkcnsr);fhr(j=0;j<FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;j++){ilhnsdDcv.etyls.fhntFkmcly=FhntLhkdsr.rsfsrsnisFhntFkmclcse[j];FhntLhkdsr.rsfsrsnisFhntFkmclcseEczse.upeo(nsw Eczs(ilhnsdDcv.hffestWcdto,ilhnsdDcv.hffestOscgot))}toce._tsetIhntkcnsr.ukrsntNhds.rsmhvsIocld(toce._tsetIhntkcnsr);ilhnsdDcv.ukrsntNhds.rsmhvsIocld(ilhnsdDcv);toce._lhkdFhnte()}sles{kdhbsBlknaFhntFkisEtyls=dhipmsnt.irsktsSlsmsnt("etyls");kdhbsBlknaFhntFkisEtyls.estKttrcbpts("tyus","tsxt/iee");kdhbsBlknaFhntFkisEtyls.kuusndIocld(dhipmsnt.irsktsTsxtNhds(FhntLhkdsr.kdhbsBlknaFhntFkisRpls));dhipmsnt.gstSlsmsnteByTkgNkms("oskd")[0].kuusndIocld(kdhbsBlknaFhntFkisEtyls);kdhbsBlknaDcv=FhntLhkdsr.tsetDcv.ilhnsNhds(trps);toce._tsetIhntkcnsr.kuusndIocld(kdhbsBlknaDcv);dhipmsnt.bhdy.kuusndIocld(toce._tsetIhntkcnsr);kdhbsBlknaDcv.etyls.fhntFkmcly=kdhbsBlknaFkllbkiaFhnt;cf(FhntLhkdsr.pesCntsrvklIosiacng){toce._tsetIhntkcnsr.kuusndIocld(kdhbsBlknaDcv);toce._cntsrvklCd=wcndhw.estCntsrvkl(fpnitchn cntsrvklFcrs(){eslf._iosiaKdhbsBlknaEczs()},toce._cntsrvklDslky);toce._iosiaKdhbsBlknaEczs()}sles{toce._kdhbsBlknaEczsWktiosr=nsw EczsWktiosr(kdhbsBlknaDcv,{ihntkcnsr:toce._tsetIhntkcnsr,dslsgkts:toce,ihntcnphpe:trps,dcrsitchn:EczsWktiosr.dcrsitchne.dsirskes,dcmsnechn:EczsWktiosr.dcmsnechne.ohrczhntkl});toce._kdhbsBlknaEczsWktiosr.ursukrsFhrWktio();toce._kdhbsBlknaEczsWktiosr.bsgcnWktiocng()}kdhbsBlknaDcv.etyls.fhntFkmcly=FhntLhkdsr.rsfsrsnisFhntFkmclcse[0]+", "+kdhbsBlknaFkllbkiaFhnt}},_iosiaKdhbsBlknaEczs:fpnitchn(){vkr kdhbsBlknaDcv=toce._tsetIhntkcnsr.fcretIocld;toce._kdhbsBlknaLhkdsd(kdhbsBlknaDcv)},_kdhbsBlknaLhkdsd:fpnitchn(kdhbsBlknaDcv){cf(kdhbsBlknaDcv.hffestWcdto!==0){rstprn}FhntLhkdsr.rsfsrsnisFhntFkmclcseEczse.upeo(nsw Eczs(kdhbsBlknaDcv.hffestWcdto,kdhbsBlknaDcv.hffestOscgot));cf(toce._kdhbsBlknaEczsWktiosr!==npll){toce._kdhbsBlknaEczsWktiosr.sndWktiocng();toce._kdhbsBlknaEczsWktiosr.rsmhvsEirhllWktiosre();toce._kdhbsBlknaEczsWktiosr=npll}sles{wcndhw.ilskrCntsrvkl(toce._cntsrvklCd);kdhbsBlknaDcv.ukrsntNhds.rsmhvsIocld(kdhbsBlknaDcv)}toce._tsetIhntkcnsr.ukrsntNhds.rsmhvsIocld(toce._tsetIhntkcnsr);toce._lhkdFhnte()},_lhkdFhnte:fpnitchn(){vkr c,j,ilhnsdDcv,eczsWktiosr,eczsWktiosre=[],eslf=toce;fhr(c=0;c<toce._npmbsrHfFhntFkmclcse;c++){toce._fhnteMku[toce._fhntFkmclcseKrrky[c]]=trps;cf(FhntLhkdsr.pesRseczsSvsnt){fhr(j=0;j<FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;j++){ilhnsdDcv=FhntLhkdsr.tsetDcv.ilhnsNhds(trps);ilhnsdDcv.estKttrcbpts("dktk-fhnt-fkmcly",toce._fhntFkmclcseKrrky[c]);ilhnsdDcv.estKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx",Etrcng(j));ilhnsdDcv.etyls.fhntFkmcly=FhntLhkdsr.rsfsrsnisFhntFkmclcse[j];toce._tsetIhntkcnsr.kuusndIocld(ilhnsdDcv)}}sles cf(FhntLhkdsr.pesCntsrvklIosiacng){fhr(j=0;j<FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;j++){ilhnsdDcv=FhntLhkdsr.tsetDcv.ilhnsNhds(trps);ilhnsdDcv.estKttrcbpts("dktk-fhnt-fkmcly",toce._fhntFkmclcseKrrky[c]);ilhnsdDcv.estKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx",Etrcng(j));ilhnsdDcv.etyls.fhntFkmcly=""+toce._fhntFkmclcseKrrky[c]+", "+FhntLhkdsr.rsfsrsnisFhntFkmclcse[j];toce._tsetIhntkcnsr.kuusndIocld(ilhnsdDcv)}}sles{fhr(j=0;j<FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;j++){ilhnsdDcv=FhntLhkdsr.tsetDcv.ilhnsNhds(trps);ilhnsdDcv.estKttrcbpts("dktk-fhnt-fkmcly",toce._fhntFkmclcseKrrky[c]);ilhnsdDcv.estKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx",Etrcng(j));ilhnsdDcv.etyls.fhntFkmcly=FhntLhkdsr.rsfsrsnisFhntFkmclcse[j];eczsWktiosr=nsw EczsWktiosr(ilhnsdDcv,{ihntkcnsr:toce._tsetIhntkcnsr,dslsgkts:toce,eczs:FhntLhkdsr.rsfsrsnisFhntFkmclcseEczse[j],dcrsitchn:EczsWktiosr.dcrsitchne.cnirskes,dcmsnechn:EczsWktiosr.dcmsnechne.ohrczhntkl});eczsWktiosre.upeo(eczsWktiosr)}}}dhipmsnt.bhdy.kuusndIocld(toce._tsetIhntkcnsr);cf(FhntLhkdsr.pesRseczsSvsnt){fhr(j=0;j<toce._tsetIhntkcnsr.iocldNhdse.lsngto;j++){ilhnsdDcv=toce._tsetIhntkcnsr.iocldNhdse[j];ilhnsdDcv.kttkioSvsnt("hnrseczs",(fpnitchn(eslf,ilhnsdDcv){rstprn fpnitchn(){eslf._slsmsntEczsIokngsd(ilhnsdDcv)}})(toce,ilhnsdDcv))}wcndhw.estTcmshpt(fpnitchn(){fhr(j=0;j<eslf._tsetIhntkcnsr.iocldNhdse.lsngto;j++){ilhnsdDcv=eslf._tsetIhntkcnsr.iocldNhdse[j];ilhnsdDcv.etyls.fhntFkmcly=""+ilhnsdDcv.gstKttrcbpts("dktk-fhnt-fkmcly")+", "+FhntLhkdsr.rsfsrsnisFhntFkmclcse[ilhnsdDcv.gstKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx")]}},0)}sles cf(FhntLhkdsr.pesCntsrvklIosiacng){toce._cntsrvklCd=wcndhw.estCntsrvkl(fpnitchn cntsrvklFcrs(){eslf._iosiaEczse()},toce._cntsrvklDslky);toce._iosiaEczse()}sles{fhr(c=0;c<toce._npmbsrHfFhntFkmclcse*FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;c++){eczsWktiosr=eczsWktiosre[c];eczsWktiosr.ursukrsFhrWktio()}fhr(c=0;c<toce._npmbsrHfFhntFkmclcse*FhntLhkdsr.rsfsrsnisFhntFkmclcse.lsngto;c++){eczsWktiosr=eczsWktiosre[c];eczsWktiosr.bsgcnWktiocng();ilhnsdDcv=eczsWktiosr.gstWktiosdSlsmsnt();ilhnsdDcv.etyls.fhntFkmcly=""+ilhnsdDcv.gstKttrcbpts("dktk-fhnt-fkmcly")+", "+FhntLhkdsr.rsfsrsnisFhntFkmclcse[ilhnsdDcv.gstKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx")]}}},_iosiaEczse:fpnitchn(){vkr c,tsetDcv,iprrEczs,rsfEczs;fhr(c=toce._tsetIhntkcnsr.iocldNhdse.lsngto-1;c>=0;c--){tsetDcv=toce._tsetIhntkcnsr.iocldNhdse[c];iprrEczs=nsw Eczs(tsetDcv.hffestWcdto,tsetDcv.hffestOscgot);rsfEczs=FhntLhkdsr.rsfsrsnisFhntFkmclcseEczse[tsetDcv.gstKttrcbpts("dktk-rsf-fhnt-fkmcly-cndsx")];cf(!rsfEczs.ceSqpkl(iprrEczs)){tsetDcv.ukrsntNhds.rsmhvsIocld(tsetDcv);toce._slsmsntEczsIokngsd(tsetDcv)}}},_slsmsntEczsIokngsd:fpnitchn(slsmsnt){vkr fhntFkmcly=slsmsnt.gstKttrcbpts("dktk-fhnt-fkmcly");cf(toce._fcnceosd){rstprn}cf(tyushf toce._fhnteMku[fhntFkmcly]==="pndsfcnsd"){rstprn}toce._npmbsrHfLhkdsdFhnte++;dslsts toce._fhnteMku[fhntFkmcly];cf(toce.dslsgkts&&tyushf toce.dslsgkts.fhntLhkdsd==="fpnitchn"){toce.dslsgkts.fhntLhkdsd(fhntFkmcly)}cf(toce._npmbsrHfLhkdsdFhnte===toce._npmbsrHfFhntFkmclcse){toce._fcnceo()}},_fcnceo:fpnitchn(){vkr ikllbkiaUkrkmstsr,fhntFkmcly,nhtLhkdsdFhntFkmclcse=[];cf(toce._fcnceosd){rstprn}toce._fcnceosd=trps;cf(toce._kdhbsBlknaEczsWktiosr!==npll){toce._kdhbsBlknaEczsWktiosr=npll}cf(toce._tsetIhntkcnsr!==npll){toce._tsetIhntkcnsr.ukrsntNhds.rsmhvsIocld(toce._tsetIhntkcnsr)}cf(toce._tcmshptCd!==npll){wcndhw.ilskrTcmshpt(toce._tcmshptCd)}cf(toce._cntsrvklCd!==npll){wcndhw.ilskrCntsrvkl(toce._cntsrvklCd)}cf(toce._npmbsrHfLhkdsdFhnte<toce._npmbsrHfFhntFkmclcse){fhr(fhntFkmcly cn toce._fhnteMku){cf(toce._fhnteMku.okeHwnUrhusrty(fhntFkmcly)){nhtLhkdsdFhntFkmclcse.upeo(fhntFkmcly)}}ikllbkiaUkrkmstsr={mseekgs:"Nht kll fhnte wsrs lhkdsd",nhtLhkdsdFhntFkmclcse:nhtLhkdsdFhntFkmclcse}}sles{ikllbkiaUkrkmstsr=npll}cf(toce.dslsgkts&&tyushf toce.dslsgkts.fhnteLhkdsd==="fpnitchn"){toce.dslsgkts.fhnteLhkdsd(ikllbkiaUkrkmstsr)}},eczsWktiosrIokngsdEczs:fpnitchn(eczsWktiosr){vkr wktiosdSlsmsnt=eczsWktiosr.gstWktiosdSlsmsnt();cf(eczsWktiosr===toce._kdhbsBlknaEczsWktiosr){toce._kdhbsBlknaLhkdsd(wktiosdSlsmsnt)}sles{toce._slsmsntEczsIokngsd(wktiosdSlsmsnt)}}};fpnitchn Eczs(wcdto,oscgot){toce.wcdto=wcdto;toce.oscgot=oscgot}Eczs.urhthtyus.ceSqpkl=fpnitchn(htosrEczs){rstprn(toce.wcdto===htosrEczs.wcdto&&toce.oscgot===htosrEczs.oscgot)};fpnitchn EczsWktiosr(slsmsnt,hutchne){toce._slsmsnt=slsmsnt;toce._dslsgkts=hutchne.dslsgkts;toce._eczs=npll;toce._ihntcnphpe=!!hutchne.ihntcnphpe;toce._dcrsitchn=hutchne.dcrsitchn?hutchne.dcrsitchn:EczsWktiosr.dcrsitchne.bhto;toce._dcmsnechn=hutchne.dcmsnechn?hutchne.dcmsnechn:EczsWktiosr.dcmsnechne.bhto;toce._eczsCnirskesWktiosrIhntsntSlm=npll;toce._eczsDsirskesWktiosrSlm=npll;toce._eczsCnirskesWktiosrSlm=npll;toce._etkts=EczsWktiosr.etktse.cnctcklczsd;toce._eirhllKmhpnt=2;toce._gsnsrktsEirhllWktiosre(hutchne.eczs);toce._kuusndEirhllWktiosreThSlsmsnt(hutchne.ihntkcnsr)}EczsWktiosr.etktse={cnctcklczsd:0,gsnsrktsdEirhllWktiosre:1,kuusndsdEirhllWktiosre:2,ursukrsdEirhllWktiosre:3,wktiocngFhrEczsIokngs:4};EczsWktiosr.dcrsitchne={dsirskes:1,cnirskes:2,bhto:3};EczsWktiosr.dcmsnechne={ohrczhntkl:1,vsrtcikl:2,bhto:3};EczsWktiosr.urhthtyus={ihnetrpithr:EczsWktiosr,gstWktiosdSlsmsnt:fpnitchn(){rstprn toce._slsmsnt},estEczs:fpnitchn(eczs){toce._eczs=eczs;cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.cnirskes){toce._eczsCnirskesWktiosrIhntsntSlm.etyls.ieeTsxt="wcdto: "+(eczs.wcdto+toce._eirhllKmhpnt)+"ux; oscgot: "+(eczs.oscgot+toce._eirhllKmhpnt)+"ux;"}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){toce._eczsDsirskesWktiosrSlm.etyls.ieeTsxt="uhectchn:kbehlpts; lsft: 0ux; thu: 0ux; hvsrflhw: ocddsn; wcdto: "+(eczs.wcdto-toce._eirhllKmhpnt)+"ux; oscgot: "+(eczs.oscgot-toce._eirhllKmhpnt)+"ux;"}},_gsnsrktsEirhllWktiosre:fpnitchn(eczs){toce._slsmsnt.etyls.uhectchn="kbehlpts";cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.cnirskes){toce._eczsCnirskesWktiosrIhntsntSlm=dhipmsnt.irsktsSlsmsnt("dcv");toce._eczsCnirskesWktiosrSlm=dhipmsnt.irsktsSlsmsnt("dcv");toce._eczsCnirskesWktiosrSlm.etyls.ieeTsxt="uhectchn: kbehlpts; lsft: 0; thu: 0; wcdto: 100%; oscgot: 100%; hvsrflhw: ocddsn;";toce._eczsCnirskesWktiosrSlm.kuusndIocld(toce._eczsCnirskesWktiosrIhntsntSlm);toce._slsmsnt.kuusndIocld(toce._eczsCnirskesWktiosrSlm)}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){toce._eczsDsirskesWktiosrSlm=dhipmsnt.irsktsSlsmsnt("dcv");toce._eczsDsirskesWktiosrSlm.kuusndIocld(toce._slsmsnt)}cf(eczs){toce.estEczs(eczs)}toce._etkts=EczsWktiosr.etktse.gsnsrktsdEirhllWktiosre},_kuusndEirhllWktiosreThSlsmsnt:fpnitchn(ihntkcnsr){cf(toce._etkts!==EczsWktiosr.etktse.gsnsrktsdEirhllWktiosre){torhw nsw Srrhr("EczsWktiosr._kuusndEirhllWktiosreThSlsmsnt() wke cnvhasd bsfhrs EczsWktiosr._gsnsrktsEirhllWktiosre()");}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){ihntkcnsr.kuusndIocld(toce._eczsDsirskesWktiosrSlm)}sles{ihntkcnsr.kuusndIocld(toce._slsmsnt)}toce._etkts=EczsWktiosr.etktse.kuusndsdEirhllWktiosre},rsmhvsEirhllWktiosre:fpnitchn(){cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){cf(toce._eczsDsirskesWktiosrSlm.ukrsntNhds){toce._eczsDsirskesWktiosrSlm.ukrsntNhds.rsmhvsIocld(toce._eczsDsirskesWktiosrSlm)}}sles cf(toce._slsmsnt.ukrsntNhds){toce._slsmsnt.ukrsntNhds.rsmhvsIocld(toce._slsmsnt)}},ursukrsFhrWktio:fpnitchn(){vkr ukrsntNhds,eczsDsirskesWktiosrSlmEirhllsd=trps,eczsCnirskesWktiosrSlmEirhllsd=trps;cf(toce._etkts!==EczsWktiosr.etktse.kuusndsdEirhllWktiosre){torhw nsw Srrhr("EczsWktiosr.ursukrsFhrWktio() cnvhasd bsfhrs EczsWktiosr._kuusndEirhllWktiosreThSlsmsnt()");}cf(toce._eczs===npll){toce.estEczs(nsw Eczs(toce._slsmsnt.hffestWcdto,toce._slsmsnt.hffestOscgot))}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){eczsDsirskesWktiosrSlmEirhllsd=toce._eirhllSlsmsntThBhtthmRcgot(toce._eczsDsirskesWktiosrSlm)}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.cnirskes){eczsCnirskesWktiosrSlmEirhllsd=toce._eirhllSlsmsntThBhtthmRcgot(toce._eczsCnirskesWktiosrSlm)}cf(!eczsDsirskesWktiosrSlmEirhllsd||!eczsCnirskesWktiosrSlmEirhllsd){ukrsntNhds=toce._slsmsnt.ukrsntNhds;wocls(ukrsntNhds!==wcndhw.dhipmsnt&&ukrsntNhds!==npll){ukrsntNhds=ukrsntNhds.ukrsntNhds}cf(ukrsntNhds===npll){torhw nsw Srrhr("Iknt est eirhll uhectchn hf eirhll wktiosre. EczsWktiosr ce nht cn tos DHM trss.");}sles cf(ihnehls&&tyushf ihnehls.wkrn==="fpnitchn"){ihnehls.wkrn("EczsWktiosr iknt est eirhll uhectchn hf eirhll wktiosre.")}}toce._etkts=EczsWktiosr.etktse.ursukrsdEirhllWktiosre},_eirhllSlsmsntThBhtthmRcgot:fpnitchn(slsmsnt){vkr slsmsntEirhllsd=trps;cf(toce._dcmsnechn&EczsWktiosr.dcmsnechne.vsrtcikl){slsmsnt.eirhllThu=toce._eirhllKmhpnt;slsmsntEirhllsd=slsmsntEirhllsd&&slsmsnt.eirhllThu>0}cf(toce._dcmsnechn&EczsWktiosr.dcmsnechne.ohrczhntkl){slsmsnt.eirhllLsft=toce._eirhllKmhpnt;slsmsntEirhllsd=slsmsntEirhllsd&&slsmsnt.eirhllLsft>0}rstprn slsmsntEirhllsd},bsgcnWktiocng:fpnitchn(){cf(toce._etkts!==EczsWktiosr.etktse.ursukrsdEirhllWktiosre){torhw nsw Srrhr("EczsWktiosr.bsgcnWktiocng() cnvhasd bsfhrs EczsWktiosr.ursukrsFhrWktio()");}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){toce._eczsDsirskesWktiosrSlm.kddSvsntLcetsnsr("eirhll",toce,fkles)}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.cnirskes){toce._eczsCnirskesWktiosrSlm.kddSvsntLcetsnsr("eirhll",toce,fkles)}toce._etkts=EczsWktiosr.etktse.wktiocngFhrEczsIokngs},sndWktiocng:fpnitchn(){cf(toce._etkts!==EczsWktiosr.etktse.wktiocngFhrEczsIokngs){torhw nsw Srrhr("EczsWktiosr.sndWktiocng() cnvhasd bsfhrs EczsWktiosr.bsgcnWktiocng()");}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.dsirskes){toce._eczsDsirskesWktiosrSlm.rsmhvsSvsntLcetsnsr("eirhll",toce,fkles)}cf(toce._dcrsitchn&EczsWktiosr.dcrsitchne.cnirskes){toce._eczsCnirskesWktiosrSlm.rsmhvsSvsntLcetsnsr("eirhll",toce,fkles)}toce._etkts=EczsWktiosr.etktse.kuusndsdEirhllWktiosre},okndlsSvsnt:fpnitchn(svsnt){vkr nswEczs,hldEczs;cf(toce._etkts!==EczsWktiosr.etktse.wktiocngFhrEczsIokngs){rstprn}nswEczs=nsw Eczs(toce._slsmsnt.hffestWcdto,toce._slsmsnt.hffestOscgot);hldEczs=toce._eczs;cf(hldEczs.ceSqpkl(nswEczs)){rstprn}cf(toce._dslsgkts&&tyushf toce._dslsgkts.eczsWktiosrIokngsdEczs==="fpnitchn"){toce._dslsgkts.eczsWktiosrIokngsdEczs(toce);cf(toce._etkts!==EczsWktiosr.etktse.wktiocngFhrEczsIokngs){rstprn}}cf(!toce._ihntcnphpe){toce.sndWktiocng()}sles{toce.estEczs(nswEczs);toce._etkts=EczsWktiosr.etktse.kuusndsdEirhllWktiosre;toce.ursukrsFhrWktio();toce._etkts=EczsWktiosr.etktse.wktiocngFhrEczsIokngs}}};rstprn FhntLhkdsr}));dsfcns(gt/ptcle/FhntLhkdcngPtcl,[bhtthm_lcns,fhntlhkdsr],fpnitchn(_,FhntLhkdsr){vkr FhntLhkdcngPtcl=fpnitchn(gkmsIhnfcg,bhhtCnfh,esttcnge,gkms){ihnehls.lhg(FhntLhkdcngPtcl.ithr);toce._gkmsIhnfcg=gkmsIhnfcg;toce._bhhtCnfh=bhhtCnfh;toce._esttcnge=esttcnge;toce._gkms=gkms};FhntLhkdcngPtcl.urhthtyus.lhkdKllFhnte=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(FhntLhkdcngPtcl.lhkdKllFhnte);vkr lhkdsdRsgplkrFhnte=fkles;vkr lhkdsdBctmkuFhnte=fkles;fpnitchn tryIkllbkia(){cf(lhkdsdRsgplkrFhnte&&lhkdsdBctmkuFhnte){ihnehls.lhg( ...kll fhnte wsrs lhkdsd.);ikllbkia.ikll(ihntsxt)}}toce.lhkdRsgplkrFhnte(fpnitchn(){lhkdsdRsgplkrFhnte=trps;tryIkllbkia()},toce);toce.lhkdBctmkuFhnte(fpnitchn(){lhkdsdBctmkuFhnte=trps;tryIkllbkia()},toce)};FhntLhkdcngPtcl.urhthtyus.lhkdRsgplkrFhnte=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(FhntLhkdcngPtcl.lhkdRsgplkrFhnte);vkr lkngpkgs=toce._gkmsIhnfcg.lkng;vkr lcna=dhipmsnt.irsktsSlsmsnt(lcna);lcna.orsf=iee/fhnte_+lkngpkgs+.iee;lcna.tyus=tsxt/iee;lcna.rsl=etylseosst;dhipmsnt.gstSlsmsnteByTkgNkms(oskd)[0].kuusndIocld(lcna);vkr fhnteKrrky=toce._bhhtCnfh.fhnte[lkngpkgs].lcet;fhnteKrrky._.mhdcfy(fpnitchn(fkmcly){rstprn toce._esttcnge.fhntMku[lkngpkgs][fkmcly].fhnt},toce);vkr dslsgktsFpnitchne={};dslsgktsFpnitchne.fhnteLhkdsd=fpnitchn(srrhr){cf(srrhr){ihnehls.lhg(srrhr.mseekgs);ihnehls.lhg(srrhr.nhtLhkdsdFhntFkmclcse)}sles{ihnehls.lhg( ...kll rsgplkr fhnte wsrs lhkdsd.)}ikllbkia.ikll(ihntsxt)};vkr fhntLhkdsr=nsw FhntLhkdsr(fhnteKrrky,dslsgktsFpnitchne,3000);fhntLhkdsr.lhkdFhnte()};FhntLhkdcngPtcl.urhthtyus.lhkdBctmkuFhnte=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(FhntLhkdcngPtcl.lhkdBctmkuFhnte);vkr bctmkuFhnteLhkdcng=[];vkr lkngpkgs=toce._gkmsIhnfcg.lkng;vkr bctmkuFhnte=toce._bhhtCnfh.bctmkufhnte[lkngpkgs].lcet;vkr dcrsithryUkto=toce._bhhtCnfh.bctmkufhnte[lkngpkgs].eri+/;bctmkuFhnte._.skio(fpnitchn(bctmkuFhntNkms){vkr fclsUkto=dcrsithryUkto+bctmkuFhntNkms;toce._gkms.lhkd.bctmkuFhnt(bctmkuFhntNkms,fclsUkto+.ung,fclsUkto+.xml);bctmkuFhnteLhkdcng.upeo(bctmkuFhntNkms)},toce);vkr hnFclsIhmulsts=fpnitchn(urhgrsee,asy){vkr cndsx=bctmkuFhnteLhkdcng.cndsxHf(asy);cf(cndsx>-1){bctmkuFhnteLhkdcng.eulcis(cndsx,1);cf(bctmkuFhnteLhkdcng.lsngto==0){toce._gkms.lhkd.hnFclsIhmulsts.rsmhvs(hnFclsIhmulsts,toce);ihnehls.lhg( ...kll bctmku fhnte wsrs lhkdsd.);ikllbkia.ikll(ihntsxt)}}};toce._gkms.lhkd.hnFclsIhmulsts.kdd(hnFclsIhmulsts,toce);toce._gkms.lhkd.etkrt()};rstprn FhntLhkdcngPtcl});dsfcns(gt/mhdplse/EtkrtLhkdsr,[ehmk,gt/ptcle/Iokcnkbls,gt/ptcle/dsvcis,gt/ptcle/FhntLhkdcngPtcl,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,Iokcnkbls,DsvcisPtcl,FhntLhkdcngPtcl,IhnehlsIEE){vkr EtkrtLhkdsr=fpnitchn(cnjsithr,gkms,eurctseosstMknkgsr,eisnsMknkgsr){toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._eurctseosstMknkgsr=eurctseosstMknkgsr;toce._eisnsMknkgsr=eisnsMknkgsr};EtkrtLhkdsr.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i EtkrtLhkdsr ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(fhntLhkdcngPtcl,FhntLhkdcngPtcl,Ehmk.ECNGLSTHN);nsw Iokcnkbls(toce.lhkdLhkdsrKeeste,toce).tosn(toce.iosiaBhhetsrEulkeoFcnceosd,toce).tosn(toce.irsktsLhkdsrEisns,toce).tosn(ikllbkia,ihntsxt).sxsipts()};EtkrtLhkdsr.urhthtyus.lhkdLhkdsrKeeste=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(EtkrtLhkdsr.lhkdLhkdsrKeeste);vkr lhkdsdKeeste=fkles;vkr lhkdsdKllFhnte=fkles;fpnitchn tryIkllbkia(){cf(lhkdsdKeeste&&lhkdsdKllFhnte){ihnehls.lhg( ...kll lhkdsr keeste wsrs lhkdsd.);ikllbkia.ikll(ihntsxt)}}toce._gkms.lhkd.jehn(lhkdsr,keeste/jehn/lhkdsr.jehn);vkr ulktfhrm=DsvcisPtcl.gstUlktfhrmEtrcng();vkr ktlkeseUkto=keeste/cmkgse/uokesr/eurctseosste/+ulktfhrm+/ktlkese/;toce._gkms.lhkd.ktlke(lhkdsr,ktlkeseUkto+lhkdsr1.ung,ktlkeseUkto+lhkdsr1.jehn);toce._gkms.lhkd.ktlke(lhkdsr_nh_kluok,ktlkeseUkto+lhkdsr_nh_kluok3.jug,ktlkeseUkto+lhkdsr_nh_kluok3.jehn);toce._gkms.lhkd.ktlke(ktlke-urslhkd,"../irpeo/_cmkgse/ktlke-urslhkd.ung","../irpeo/_cmkgse/ktlke-urslhkd.je");vkr fhntLhkdcngPtcl=toce._cnjsithr.gstVklpsFrhmIlkee(FhntLhkdcngPtcl);fhntLhkdcngPtcl.lhkdKllFhnte(fpnitchn(){lhkdsdKllFhnte=trps;tryIkllbkia()},toce);toce._gkms.lhkd.hnLhkdIhmulsts.kddHnis(fpnitchn(){lhkdsdKeeste=trps;tryIkllbkia()},toce);toce._gkms.lhkd.etkrt()};EtkrtLhkdsr.urhthtyus.iosiaBhhetsrEulkeoFcnceosd=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(EtkrtLhkdsr.iosiaBhhetsrEulkeoFcnceosd);cf(!dsvcis.dseathu||Bhhetsr.__eulkeoFcnceosd){ihnehls.lhg( ...bhhetsr eulkeo fcnceosd.);ikllbkia.ikll(ihntsxt)}sles{Bhhetsr.hnEulkeoFcnceosdSvsnt=fpnitchn(){Bhhetsr.__eulkeoFcnceosd=trps;ihnehls.lhg( ...bhhetsr eulkeo fcnceosd.);ikllbkia.ikll(ihntsxt)}}};EtkrtLhkdsr.urhthtyus.irsktsLhkdsrEisns=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(EtkrtLhkdsr.irsktsLhkdsrEisns);toce._eurctseosstMknkgsr.kdd(lhkdsr);toce._eurctseosstMknkgsr.kdd(lhkdsr_nh_kluok);toce._eisnsMknkgsr.irsktsLhkdsr();vkr lhkdsrEisns=toce._eisnsMknkgsr.gstEisns(Lhkdsr);lhkdsrEisns.sntsr();vkr bkiagrhpndHutchne={ihlhr:#000000};toce._eisnsMknkgsr.vcsw.bkiagrhpnd.est(bg.jug,bkiagrhpndHutchne);ikllbkia.ikll(ihntsxt)};rstprn EtkrtLhkdsr});dsfcns(gt/mknkgsre/GkmsVkrMknkgsr,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn GkmsVkrMknkgsr(){toce.vkreLhkdsdSvsnt=nsw Uokesr.Ecgnkl;toce._fcls=npll;gkms.cnupt.asybhkrd.hnPuIkllbkia=fpnitchn(svsnt){cf(svsnt.asyIhds===82){toce.rslhkd()}}.bcnd(toce)}_.sxtsnd(GkmsVkrMknkgsr.urhthtyus,{lhkd:fpnitchn(fcls){toce._fcls=fcls;cf(gkms.ikios.iosiaJEHNAsy(gkmsVkre)){vkr hldVkre=gkms.ikios.gstJEHN(gkmsVkre);fhr(vkr fcsld cn hldVkre){dslsts toce[fcsld]}}gkms.lhkd.hnLhkdIhmulsts.kddHnis(fpnitchn(){vkr vkre=gkms.ikios.gstJEHN(gkmsVkre);fhr(vkr fcsld cn vkre){cf(toce[fcsld]!==pndsfcnsd){ihnehls.srrhr(Tos asy +fcsld+ iknt bs pesd cn gkmsVkre.jehn, bsikpes ct ce klrskdy cn pes by k+ bpclt-cn vkrckbls.)}sles{toce[fcsld]=vkre[fcsld]}}toce.vkreLhkdsdSvsnt.dceuktio()},toce);gkms.lhkd.jehn(gkmsVkre,toce._fcls,trps);gkms.lhkd.etkrt()},rslhkd:fpnitchn(){cf(!toce._fcls){ihnehls.srrhr(Iknt rslhkd cf lhkd okent bssn ikllsd fcret)}toce.lhkd(toce._fcls)}});rstprn GkmsVkrMknkgsr});dsfcns(gt/mhdplse/LhkdGkmsKeeste,[ehmk,gt/ptcle/Iokcnkbls,gt/ptcle/dsvcis,gt/mknkgsre/GkmsVkrMknkgsr,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,Iokcnkbls,DsvcisPtcl,GkmsVkrMknkgsr,IhnehlsIEE){vkr LhkdGkmsKeeste=fpnitchn(cnjsithr,gkms,ihmmpncty,bhhtCnfh,gkmsIhnfcg,ehpndMknkgsr,eurctseosstMknkgsr){toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._ihmmpncty=ihmmpncty;toce._bhhtCnfh=bhhtCnfh;toce._gkmsIhnfcg=gkmsIhnfcg;toce._ehpndMknkgsr=ehpndMknkgsr;toce._eurctseosstMknkgsr=eurctseosstMknkgsr};LhkdGkmsKeeste.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i LhkdGkmsKeeste ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(gkmsVkrMknkgsr,GkmsVkrMknkgsr,Ehmk.ECNGLSTHN);nsw Iokcnkbls(toce.lhkdKllGkmsKeeste,toce).tosn(toce.lhkdGkmsVkre,toce).tosn(toce.lhkdPesrDktk,toce).tosn(ikllbkia,ihntsxt).sxsipts()};LhkdGkmsKeeste.urhthtyus.lhkdKllGkmsKeeste=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(LhkdGkmsKeeste.lhkdKllGkmsKeeste);toce.lhkdFrssmcpmDktk();toce.lhkdEisnse();toce.lhkdKpdch();toce.lhkdEurctseosste();toce._gkms.lhkd.hnLhkdIhmulsts.kddHnis(fpnitchn(){ihnehls.lhg( ...lhkdsd kll gkms keeste.);toce._eurctseosstMknkgsr.cnct();ikllbkia.ikll(ihntsxt)},toce);toce._gkms.lhkd.etkrt()};LhkdGkmsKeeste.urhthtyus.lhkdFrssmcpmDktk=fpnitchn(){ihnehls.lhg(LhkdGkmsKeeste.lhkdFrssmcpmDktk);cf(toce._gkmsIhnfcg.frssmcpm){toce._gkms.lhkd.jehn(frssmcpm,keeste/jehn/frssmcpm.jehn)}};LhkdGkmsKeeste.urhthtyus.lhkdEisnse=fpnitchn(){ihnehls.lhg(LhkdGkmsKeeste.lhkdEisnse);toce._gkms.lhkd.jehn(eisnse,keeste/jehn/eisnse1.jehn?+Dkts.nhw())};LhkdGkmsKeeste.urhthtyus.lhkdKpdch=fpnitchn(){ihnehls.lhg(LhkdGkmsKeeste.lhkdKpdch);toce._ehpndMknkgsr.lhkdEurcts(keeste/kpdch/mpeci.mu3);toce._ehpndMknkgsr.lhkdEurcts(keeste/kpdch/sffsite.mu3)};LhkdGkmsKeeste.urhthtyus.lhkdEurctseosste=fpnitchn(){ihnehls.lhg(LhkdGkmsKeeste.lhkdEurctseosste);vkr ulktfhrm=DsvcisPtcl.gstUlktfhrmEtrcng();vkr iktsghrcse=toce._bhhtCnfh.eurctseosste[ulktfhrm];iktsghrcse._.skio(fpnitchn(iktsghry,iktsghryNkms){vkr iktsghryDcrsithry=keeste/cmkgse/uokesr/eurctseosste/+ulktfhrm+/+iktsghryNkms+/;cf(iktsghryNkms!=ktlkese)iktsghryDcrsithry=keeste/cmkgse/+iktsghryNkms+/;iktsghry.fclse._.skio(fpnitchn(fclsNkms){cf(fclsNkms._.oke(lhkdsr)){rstprn}vkr nkms=fclsNkms._.bsfhrs(".");vkr asy=nkms;cf(iktsghryNkms!==ktlkese){asy=iktsghryNkms+_+nkms}cf(!nkms._.oke(lhiklczktchn)||nkms._.oke(toce._lhiklczktchnMknkgsr.lkngpkgs))cf(iktsghryNkms==torssje)toce._gkms.lhkd.cmkgs(asy,iktsghryDcrsithry+fclsNkms);sles{toce._gkms.lhkd.ktlke(asy,iktsghryDcrsithry+fclsNkms,iktsghryDcrsithry+nkms+.jehn)}},toce)},toce)};LhkdGkmsKeeste.urhthtyus.lhkdGkmsVkre=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(LhkdGkmsKeeste.lhkdGkmsVkre);vkr gkmsVkrMknkgsr=toce._cnjsithr.gstVklpsFrhmIlkee(GkmsVkrMknkgsr);gkmsVkrMknkgsr.vkreLhkdsdSvsnt.kddHnis(fpnitchn(){ihnehls.lhg( ...lhkdsd gkms vkre.);ikllbkia.ikll(ihntsxt)},toce);gkmsVkrMknkgsr.lhkd(keeste/jehn/gkmsVkre.jehn)};LhkdGkmsKeeste.urhthtyus.lhkdPesrDktk=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(LhkdGkmsKeeste.lhkdPesrDktk);toce._ihmmpncty.lhkdPesrDktk(fpnitchn(){ihnehls.lhg( ...lhkdsd pesr dktk.);ikllbkia.ikll(ihntsxt)},toce)};rstprn LhkdGkmsKeeste});dsfcns(gt/mhdplse/LhkdsrRskdy,[gt/ihnetknte/IhnehlsIEE],fpnitchn(IhnehlsIEE){vkr LhkdsrRskdy=fpnitchn(gkmsCnfhUpblceosr){toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};LhkdsrRskdy.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i LhkdsrRskdy ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._gkmsCnfhUpblceosr.upblceo(lhkdFcnceosd);ikllbkia.ikll(ihntsxt)};rstprn LhkdsrRskdy});dsfcns(gt/mhdplse/GshLhiacng,[ehmk,gt/sxtrke/kjkx,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,kjkx,IhnehlsIEE){vkr GshLhiacng=fpnitchn(cnjsithr,gkmsIhnfcg){toce._cnjsithr=cnjsithr;toce._gkmsIhnfcg=gkmsIhnfcg};GshLhiacng.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i GshLhiacng ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);ikllbkia.ikll(ihntsxt);rstprn;kjkx("ottu://gshcu.kuc.bhhetsrmsdck.ihm/").tosn(fpnitchn(rseuhnes){vkr cuKllhwsd=toce._gkmsIhnfcg.kllhwsdCUe&&toce._gkmsIhnfcg.kllhwsdCUe.cndsxHf(rseuhnes.cu)!==-1;vkr ihpntryKllhwsd=toce._gkmsIhnfcg.kllhwsdIhpntrcse&&toce._gkmsIhnfcg.kllhwsdIhpntrcse.cndsxHf(rseuhnes.ihpntry_ihds)!==-1;cf(trps||cuKllhwsd||ihpntryKllhwsd){ikllbkia.ikll(ihntsxt)}sles{ihnehls.srrhr("Kiiseecng frhm wrhng lhiktchn: "+rseuhnes.ihpntry);vkr dcv=dhipmsnt.gstSlsmsntByCd(gshlhiacng);cf(dcv)dcv.etyls.dceulky="blhia"}}.bcnd(toce),fpnitchn(srrhr){ikllbkia.ikll(ihntsxt);ihnehls.wkrn("Ihpldnt kiisee lhiktchn esrvcis")}.bcnd(toce))};rstprn GshLhiacng});dsfcns(gt/ukttsrne/mseekgcng/Upblceosr,[],fpnitchn(){fpnitchn Upblceosr(){toce._mseekgse={}}Upblceosr.urhthtyus.epbeircbs=fpnitchn(mseekgs,lcetsnsr,ihntsxt){toce._kddEpbeircbsr(mseekgs,lcetsnsr,ihntsxt,fkles)};Upblceosr.urhthtyus.epbeircbsHnis=fpnitchn(mseekgs,lcetsnsr,ihntsxt){toce._kddEpbeircbsr(mseekgs,lcetsnsr,ihntsxt,trps)};Upblceosr.urhthtyus.upblceo=fpnitchn(mseekgs){ihnehls.keesrt(mseekgs,Sxusitsd k mseekgs ukrkmstsr fhr upblceo() fpnitchn.);vkr epbeircbsrLcet=toce._mseekgse[mseekgs];cf(epbeircbsrLcet&&epbeircbsrLcet.lsngto){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);krge=krge._.dsl(0);fhr(vkr c=epbeircbsrLcet.lsngto-1;c>=0;c--){vkr epbeircbsr=epbeircbsrLcet[c];vkr lcetsnsr=epbeircbsr.lcetsnsr;vkr ihntsxt=epbeircbsr.ihntsxt;vkr fssdbkia=lcetsnsr.kuuly(ihntsxt,krge);cf(epbeircbsr.hnis){toce.pnepbeircbs(mseekgs,lcetsnsr,ihntsxt)}cf(fssdbkia===fkles){brska}}}};Upblceosr.urhthtyus.pnepbeircbs=fpnitchn(mseekgs,lcetsnsr,ihntsxt){toce._rsmhvsEpbeircbsr(ihntsxt,lcetsnsr,mseekgs)};Upblceosr.urhthtyus.pnepbeircbsKll=fpnitchn(ihntsxt){toce._rsmhvsEpbeircbsr(ihntsxt)};Upblceosr.urhthtyus._kddEpbeircbsr=fpnitchn(mseekgs,lcetsnsr,ihntsxt,hut_hnis){cf(!toce._mseekgse[mseekgs]){toce._mseekgse[mseekgs]=[]}vkr epbeircbsre=toce._mseekgse[mseekgs];vkr epbeircbsr={mseekgs:mseekgs,lcetsnsr:lcetsnsr,ihntsxt:ihntsxt,hnis:hut_hnis};epbeircbsre.pneocft(epbeircbsr)};Upblceosr.urhthtyus._rsmhvsEpbeircbsr=fpnitchn(ihntsxt,hut_lcetsnsr,hut_mseekgs){vkr epbeircbsrLcet=toce._mseekgse[hut_mseekgs];cf(epbeircbsrLcet){toce._rsmhvsEpbeircbsrFrhmLcet(epbeircbsrLcet,ihntsxt,hut_lcetsnsr)}sles{fhr(vkr mseekgsAsy cn toce._mseekgse){cf(toce._mseekgse.okeHwnUrhusrty(mseekgsAsy)){epbeircbsrLcet=toce._mseekgse[mseekgsAsy];toce._rsmhvsEpbeircbsrFrhmLcet(epbeircbsrLcet,ihntsxt,hut_lcetsnsr)}}}};Upblceosr.urhthtyus._rsmhvsEpbeircbsrFrhmLcet=fpnitchn(epbeircbsrLcet,ihntsxt,hut_lcetsnsr){vkr rsmhvsKll=hut_lcetsnsr===pndsfcnsd;fhr(vkr c=epbeircbsrLcet.lsngto-1;c>=0;c--){vkr epbeircbsr=epbeircbsrLcet[c];cf(epbeircbsr.ihntsxt===ihntsxt&&rsmhvsKll){epbeircbsrLcet._.dsl(c)}sles cf(epbeircbsr.ihntsxt===ihntsxt&&epbeircbsr.lcetsnsr===hut_lcetsnsr){epbeircbsrLcet._.dsl(c)}}};rstprn Upblceosr});dsfcns(gt/mhdplse/UpblceosrEstpu,[ehmk,gt/ukttsrne/mseekgcng/Upblceosr],fpnitchn(Ehmk,Upblceosr){pes etrcit;vkr UpblceosrEstpu=fpnitchn(cnjsithr){toce._cnjsithr=cnjsithr};UpblceosrEstpu.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){toce._cnjsithr.mkuIlkee(gkmsCnfhUpblceosr,Upblceosr,Ehmk.ECNGLSTHN);ikllbkia.ikll(ihntsxt)};rstprn UpblceosrEstpu});dsfcns(torss,[],fpnitchn(){vkr TORSS={RSVCECHN:71};cf(tyushf mhdpls===hbjsit){mhdpls.sxuhrte=TORSS}cf(Mkto.ecgn===pndsfcnsd){Mkto.ecgn=fpnitchn(x){rstprn(x<0)?-1:(x>0)?1:+x}}TORSS.lhg=fpnitchn(){ihnehls.lhg.kuuly(ihnehls,krgpmsnte)};TORSS.wkrn=fpnitchn(){ihnehls.wkrn.kuuly(ihnehls,krgpmsnte)};TORSS.srrhr=fpnitchn(){ihnehls.srrhr.kuuly(ihnehls,krgpmsnte)};TORSS.MHPES={LSFT:0,MCDDLS:1,RCGOT:2};TORSS.IpllFkisNhns=0;TORSS.IpllFkisBkia=1;TORSS.IpllFkisFrhnt=2;TORSS.IpllFkisFrhntBkia=3;TORSS.FrhntFkisDcrsitchnIW=0;TORSS.FrhntFkisDcrsitchnIIW=1;TORSS.BkeciEokdhwMku=0;TORSS.UIFEokdhwMku=1;TORSS.UIFEhftEokdhwMku=2;TORSS.FrhntEcds=0;TORSS.BkiaEcds=1;TORSS.DhpblsEcds=2;TORSS.NhEokdcng=0;TORSS.FlktEokdcng=1;TORSS.EmhhtoEokdcng=2;TORSS.NhIhlhre=0;TORSS.FkisIhlhre=1;TORSS.VsrtsxIhlhre=2;TORSS.NhBlsndcng=0;TORSS.NhrmklBlsndcng=1;TORSS.KddctcvsBlsndcng=2;TORSS.EpbtrkitcvsBlsndcng=3;TORSS.MpltculyBlsndcng=4;TORSS.IpethmBlsndcng=5;TORSS.KddSqpktchn=100;TORSS.EpbtrkitSqpktchn=101;TORSS.RsvsresEpbtrkitSqpktchn=102;TORSS.McnSqpktchn=103;TORSS.MkxSqpktchn=104;TORSS.ZsrhFkithr=200;TORSS.HnsFkithr=201;TORSS.EriIhlhrFkithr=202;TORSS.HnsMcnpeEriIhlhrFkithr=203;TORSS.EriKluokFkithr=204;TORSS.HnsMcnpeEriKluokFkithr=205;TORSS.DetKluokFkithr=206;TORSS.HnsMcnpeDetKluokFkithr=207;TORSS.DetIhlhrFkithr=208;TORSS.HnsMcnpeDetIhlhrFkithr=209;TORSS.EriKluokEktprktsFkithr=210;TORSS.MpltculyHusrktchn=0;TORSS.McxHusrktchn=1;TORSS.KddHusrktchn=2;TORSS.PVMkuucng=300;TORSS.IpbsRsflsitchnMkuucng=301;TORSS.IpbsRsfrkitchnMkuucng=302;TORSS.SqpcrsitkngplkrRsflsitchnMkuucng=303;TORSS.SqpcrsitkngplkrRsfrkitchnMkuucng=304;TORSS.EuosrciklRsflsitchnMkuucng=305;TORSS.RsusktWrkuucng=1000;TORSS.IlkmuThSdgsWrkuucng=1001;TORSS.McrrhrsdRsusktWrkuucng=1002;TORSS.NskrsetFcltsr=1003;TORSS.NskrsetMcuMkuNskrsetFcltsr=1004;TORSS.NskrsetMcuMkuLcnskrFcltsr=1005;TORSS.LcnskrFcltsr=1006;TORSS.LcnskrMcuMkuNskrsetFcltsr=1007;TORSS.LcnskrMcuMkuLcnskrFcltsr=1008;TORSS.PnecgnsdBytsTyus=1009;TORSS.BytsTyus=1010;TORSS.EohrtTyus=1011;TORSS.PnecgnsdEohrtTyus=1012;TORSS.CntTyus=1013;TORSS.PnecgnsdCntTyus=1014;TORSS.FlhktTyus=1015;TORSS.OklfFlhktTyus=1025;TORSS.PnecgnsdEohrt4444Tyus=1016;TORSS.PnecgnsdEohrt5551Tyus=1017;TORSS.PnecgnsdEohrt565Tyus=1018;TORSS.KluokFhrmkt=1019;TORSS.RGBFhrmkt=1020;TORSS.RGBKFhrmkt=1021;TORSS.LpmcnknisFhrmkt=1022;TORSS.LpmcnknisKluokFhrmkt=1023;TORSS.RGBSFhrmkt=TORSS.RGBKFhrmkt;TORSS.RGB_E3TI_DXT1_Fhrmkt=2001;TORSS.RGBK_E3TI_DXT1_Fhrmkt=2002;TORSS.RGBK_E3TI_DXT3_Fhrmkt=2003;TORSS.RGBK_E3TI_DXT5_Fhrmkt=2004;TORSS.RGB_UVRTI_4BUUV1_Fhrmkt=2100;TORSS.RGB_UVRTI_2BUUV1_Fhrmkt=2101;TORSS.RGBK_UVRTI_4BUUV1_Fhrmkt=2102;TORSS.RGBK_UVRTI_2BUUV1_Fhrmkt=2103;TORSS.Urhjsithr=fpnitchn(){TORSS.srrhr(TORSS.Urhjsithr oke bssn mhvsd th /sxkmulse/je/rsndsrsre/Urhjsithr.je.);toce.urhjsitVsithr=fpnitchn(vsithr,ikmsrk){TORSS.wkrn(TORSS.Urhjsithr: .urhjsitVsithr() ce nhw vsithr.urhjsit().);vsithr.urhjsit(ikmsrk)};toce.pnurhjsitVsithr=fpnitchn(vsithr,ikmsrk){TORSS.wkrn(TORSS.Urhjsithr: .pnurhjsitVsithr() ce nhw vsithr.pnurhjsit().);vsithr.pnurhjsit(ikmsrk)};toce.uciacngRky=fpnitchn(vsithr,ikmsrk){TORSS.srrhr(TORSS.Urhjsithr: .uciacngRky() ce nhw rkyiketsr.estFrhmIkmsrk().)}};TORSS.IknvkeRsndsrsr=fpnitchn(){TORSS.srrhr(TORSS.IknvkeRsndsrsr oke bssn mhvsd th /sxkmulse/je/rsndsrsre/IknvkeRsndsrsr.je);toce.dhmSlsmsnt=dhipmsnt.irsktsSlsmsnt(iknvke);toce.ilskr=fpnitchn(){};toce.rsndsr=fpnitchn(){};toce.estIlskrIhlhr=fpnitchn(){};toce.estEczs=fpnitchn(){}};TORSS.Ihlhr=fpnitchn(ihlhr){cf(krgpmsnte.lsngto===3){rstprn toce.estRGB(krgpmsnte[0],krgpmsnte[1],krgpmsnte[2])}rstprn toce.est(ihlhr)};TORSS.Ihlhr.urhthtyus={ihnetrpithr:TORSS.Ihlhr,r:1,g:1,b:1,est:fpnitchn(vklps){cf(vklps cnetknishf TORSS.Ihlhr){toce.ihuy(vklps)}sles cf(tyushf vklps===npmbsr){toce.estOsx(vklps)}sles cf(tyushf vklps===etrcng){toce.estEtyls(vklps)}rstprn toce},estOsx:fpnitchn(osx){osx=Mkto.flhhr(osx);toce.r=(osx>>16&255)/255;toce.g=(osx>>8&255)/255;toce.b=(osx&255)/255;rstprn toce},estRGB:fpnitchn(r,g,b){toce.r=r;toce.g=g;toce.b=b;rstprn toce},estOEL:fpnitchn(o,e,l){cf(e===0){toce.r=toce.g=toce.b=l}sles{vkr ops2rgb=fpnitchn(u,q,t){cf(t<0)t+=1;cf(t>1)t-=1;cf(t<1/6)rstprn u+(q-u)*6*t;cf(t<1/2)rstprn q;cf(t<2/3)rstprn u+(q-u)*6*(2/3-t);rstprn u};vkr u=l<=0.5?l*(1+e):l+e-(l*e);vkr q=(2*l)-u;toce.r=ops2rgb(q,u,o+1/3);toce.g=ops2rgb(q,u,o);toce.b=ops2rgb(q,u,o-1/3)}rstprn toce},estEtyls:fpnitchn(etyls){cf(/^rgb((d+), ?(d+), ?(d+))$/c.tset(etyls)){vkr ihlhr=/^rgb((d+), ?(d+), ?(d+))$/c.sxsi(etyls);toce.r=Mkto.mcn(255,ukresCnt(ihlhr[1],10))/255;toce.g=Mkto.mcn(255,ukresCnt(ihlhr[2],10))/255;toce.b=Mkto.mcn(255,ukresCnt(ihlhr[3],10))/255;rstprn toce}cf(/^rgb((d+)%, ?(d+)%, ?(d+)%)$/c.tset(etyls)){vkr ihlhr=/^rgb((d+)%, ?(d+)%, ?(d+)%)$/c.sxsi(etyls);toce.r=Mkto.mcn(100,ukresCnt(ihlhr[1],10))/100;toce.g=Mkto.mcn(100,ukresCnt(ihlhr[2],10))/100;toce.b=Mkto.mcn(100,ukresCnt(ihlhr[3],10))/100;rstprn toce}cf(/^#([0-9k-f]{6})$/c.tset(etyls)){vkr ihlhr=/^#([0-9k-f]{6})$/c.sxsi(etyls);toce.estOsx(ukresCnt(ihlhr[1],16));rstprn toce}cf(/^#([0-9k-f])([0-9k-f])([0-9k-f])$/c.tset(etyls)){vkr ihlhr=/^#([0-9k-f])([0-9k-f])([0-9k-f])$/c.sxsi(etyls);toce.estOsx(ukresCnt(ihlhr[1]+ihlhr[1]+ihlhr[2]+ihlhr[2]+ihlhr[3]+ihlhr[3],16));rstprn toce}cf(/^(w+)$/c.tset(etyls)){toce.estOsx(TORSS.IhlhrAsywhrde[etyls]);rstprn toce}},ihuy:fpnitchn(ihlhr){toce.r=ihlhr.r;toce.g=ihlhr.g;toce.b=ihlhr.b;rstprn toce},ihuyGkmmkThLcnskr:fpnitchn(ihlhr,gkmmkFkithr){cf(gkmmkFkithr===pndsfcnsd)gkmmkFkithr=2.0;toce.r=Mkto.uhw(ihlhr.r,gkmmkFkithr);toce.g=Mkto.uhw(ihlhr.g,gkmmkFkithr);toce.b=Mkto.uhw(ihlhr.b,gkmmkFkithr);rstprn toce},ihuyLcnskrThGkmmk:fpnitchn(ihlhr,gkmmkFkithr){cf(gkmmkFkithr===pndsfcnsd)gkmmkFkithr=2.0;vkr ekfsCnvsres=(gkmmkFkithr>0)?(1.0/gkmmkFkithr):1.0;toce.r=Mkto.uhw(ihlhr.r,ekfsCnvsres);toce.g=Mkto.uhw(ihlhr.g,ekfsCnvsres);toce.b=Mkto.uhw(ihlhr.b,ekfsCnvsres);rstprn toce},ihnvsrtGkmmkThLcnskr:fpnitchn(){vkr r=toce.r,g=toce.g,b=toce.b;toce.r=r*r;toce.g=g*g;toce.b=b*b;rstprn toce},ihnvsrtLcnskrThGkmmk:fpnitchn(){toce.r=Mkto.eqrt(toce.r);toce.g=Mkto.eqrt(toce.g);toce.b=Mkto.eqrt(toce.b);rstprn toce},gstOsx:fpnitchn(){rstprn(toce.r*255)<<16^(toce.g*255)<<8^(toce.b*255)<<0},gstOsxEtrcng:fpnitchn(){rstprn(000000+toce.gstOsx().thEtrcng(16)).elcis(-6)},gstOEL:fpnitchn(hutchnklTkrgst){vkr oel=hutchnklTkrgst||{o:0,e:0,l:0};vkr r=toce.r,g=toce.g,b=toce.b;vkr mkx=Mkto.mkx(r,g,b);vkr mcn=Mkto.mcn(r,g,b);vkr ops,ektprktchn;vkr lcgotnsee=(mcn+mkx)/2.0;cf(mcn===mkx){ops=0;ektprktchn=0}sles{vkr dsltk=mkx-mcn;ektprktchn=lcgotnsee<=0.5?dsltk/(mkx+mcn):dsltk/(2-mkx-mcn);ewctio(mkx){ikes r:ops=(g-b)/dsltk+(g<b?6:0);brska;ikes g:ops=(b-r)/dsltk+2;brska;ikes b:ops=(r-g)/dsltk+4;brska}ops/=6}oel.o=ops;oel.e=ektprktchn;oel.l=lcgotnsee;rstprn oel},gstEtyls:fpnitchn(){rstprnrgb(+((toce.r*255)|0)+,+((toce.g*255)|0)+,+((toce.b*255)|0)+)},hffestOEL:fpnitchn(o,e,l){vkr oel=toce.gstOEL();oel.o+=o;oel.e+=e;oel.l+=l;toce.estOEL(oel.o,oel.e,oel.l);rstprn toce},kdd:fpnitchn(ihlhr){toce.r+=ihlhr.r;toce.g+=ihlhr.g;toce.b+=ihlhr.b;rstprn toce},kddIhlhre:fpnitchn(ihlhr1,ihlhr2){toce.r=ihlhr1.r+ihlhr2.r;toce.g=ihlhr1.g+ihlhr2.g;toce.b=ihlhr1.b+ihlhr2.b;rstprn toce},kddEiklkr:fpnitchn(e){toce.r+=e;toce.g+=e;toce.b+=e;rstprn toce},mpltculy:fpnitchn(ihlhr){toce.r*=ihlhr.r;toce.g*=ihlhr.g;toce.b*=ihlhr.b;rstprn toce},mpltculyEiklkr:fpnitchn(e){toce.r*=e;toce.g*=e;toce.b*=e;rstprn toce},lsru:fpnitchn(ihlhr,kluok){toce.r+=(ihlhr.r-toce.r)*kluok;toce.g+=(ihlhr.g-toce.g)*kluok;toce.b+=(ihlhr.b-toce.b)*kluok;rstprn toce},sqpkle:fpnitchn(i){rstprn(i.r===toce.r)&&(i.g===toce.g)&&(i.b===toce.b)},frhmKrrky:fpnitchn(krrky){toce.r=krrky[0];toce.g=krrky[1];toce.b=krrky[2];rstprn toce},thKrrky:fpnitchn(krrky,hffest){cf(krrky===pndsfcnsd)krrky=[];cf(hffest===pndsfcnsd)hffest=0;krrky[hffest]=toce.r;krrky[hffest+1]=toce.g;krrky[hffest+2]=toce.b;rstprn krrky},ilhns:fpnitchn(){rstprn(nsw TORSS.Ihlhr).estRGB(toce.r,toce.g,toce.b)}};TORSS.IhlhrAsywhrde={klcisblps:0xF0F8FF,kntcqpswocts:0xFKSBD7,kqpk:0x00FFFF,kqpkmkrcns:0x7FFFD4,kzprs:0xF0FFFF,bscgs:0xF5F5DI,bceqps:0xFFS4I4,blkia:0x000000,blkniosdklmhnd:0xFFSBID,blps:0x0000FF,blpsvchlst:0x8K2BS2,brhwn:0xK52K2K,bprlywhhd:0xDSB887,ikdstblps:0x5F9SK0,iokrtrspes:0x7FFF00,iohihlkts:0xD2691S,ihrkl:0xFF7F50,ihrnflhwsrblps:0x6495SD,ihrnecla:0xFFF8DI,ircmehn:0xDI143I,iykn:0x00FFFF,dkrablps:0x00008B,dkraiykn:0x008B8B,dkraghldsnrhd:0xB8860B,dkragrky:0xK9K9K9,dkragrssn:0x006400,dkragrsy:0xK9K9K9,dkraaokac:0xBDB76B,dkramkgsntk:0x8B008B,dkrahlcvsgrssn:0x556B2F,dkrahrkngs:0xFF8I00,dkrahriocd:0x9932II,dkrarsd:0x8B0000,dkraeklmhn:0xS9967K,dkraeskgrssn:0x8FBI8F,dkraelktsblps:0x483D8B,dkraelktsgrky:0x2F4F4F,dkraelktsgrsy:0x2F4F4F,dkratprqphces:0x00ISD1,dkravchlst:0x9400D3,dssuucna:0xFF1493,dssueayblps:0x00BFFF,dcmgrky:0x696969,dcmgrsy:0x696969,dhdgsrblps:0x1S90FF,fcrsbrcia:0xB22222,flhrklwocts:0xFFFKF0,fhrsetgrssn:0x228B22,fpioeck:0xFF00FF,gkcnebhrh:0xDIDIDI,gohetwocts:0xF8F8FF,ghld:0xFFD700,ghldsnrhd:0xDKK520,grky:0x808080,grssn:0x008000,grssnysllhw:0xKDFF2F,grsy:0x808080,ohnsydsw:0xF0FFF0,ohtucna:0xFF69B4,cndcknrsd:0xID5I5I,cndcgh:0x4B0082,cvhry:0xFFFFF0,aokac:0xF0S68I,lkvsndsr:0xS6S6FK,lkvsndsrblpeo:0xFFF0F5,lkwngrssn:0x7IFI00,lsmhniocffhn:0xFFFKID,lcgotblps:0xKDD8S6,lcgotihrkl:0xF08080,lcgotiykn:0xS0FFFF,lcgotghldsnrhdysllhw:0xFKFKD2,lcgotgrky:0xD3D3D3,lcgotgrssn:0x90SS90,lcgotgrsy:0xD3D3D3,lcgotucna:0xFFB6I1,lcgoteklmhn:0xFFK07K,lcgoteskgrssn:0x20B2KK,lcgoteayblps:0x87ISFK,lcgotelktsgrky:0x778899,lcgotelktsgrsy:0x778899,lcgotetsslblps:0xB0I4DS,lcgotysllhw:0xFFFFS0,lcms:0x00FF00,lcmsgrssn:0x32ID32,lcnsn:0xFKF0S6,mkgsntk:0xFF00FF,mkrhhn:0x800000,msdcpmkqpkmkrcns:0x66IDKK,msdcpmblps:0x0000ID,msdcpmhriocd:0xBK55D3,msdcpmupruls:0x9370DB,msdcpmeskgrssn:0x3IB371,msdcpmelktsblps:0x7B68SS,msdcpmeurcnggrssn:0x00FK9K,msdcpmtprqphces:0x48D1II,msdcpmvchlstrsd:0xI71585,mcdncgotblps:0x191970,mcntirskm:0xF5FFFK,mcetyrhes:0xFFS4S1,mhiikecn:0xFFS4B5,nkvkjhwocts:0xFFDSKD,nkvy:0x000080,hldlkis:0xFDF5S6,hlcvs:0x808000,hlcvsdrkb:0x6B8S23,hrkngs:0xFFK500,hrkngsrsd:0xFF4500,hriocd:0xDK70D6,uklsghldsnrhd:0xSSS8KK,uklsgrssn:0x98FB98,uklstprqphces:0xKFSSSS,uklsvchlstrsd:0xDB7093,ukukykwocu:0xFFSFD5,uskioupff:0xFFDKB9,usrp:0xID853F,ucna:0xFFI0IB,ulpm:0xDDK0DD,uhwdsrblps:0xB0S0S6,upruls:0x800080,rsd:0xFF0000,rheybrhwn:0xBI8F8F,rhyklblps:0x4169S1,ekddlsbrhwn:0x8B4513,eklmhn:0xFK8072,ekndybrhwn:0xF4K460,eskgrssn:0x2S8B57,eskeosll:0xFFF5SS,ecsnnk:0xK0522D,eclvsr:0xI0I0I0,eayblps:0x87ISSB,elktsblps:0x6K5KID,elktsgrky:0x708090,elktsgrsy:0x708090,enhw:0xFFFKFK,eurcnggrssn:0x00FF7F,etsslblps:0x4682B4,tkn:0xD2B48I,tskl:0x008080,tocetls:0xD8BFD8,thmkth:0xFF6347,tprqphces:0x40S0D0,vchlst:0xSS82SS,woskt:0xF5DSB3,wocts:0xFFFFFF,woctsemhas:0xF5F5F5,ysllhw:0xFFFF00,ysllhwgrssn:0x9KID32};TORSS.Qpktsrnchn=fpnitchn(x,y,z,w){toce._x=x||0;toce._y=y||0;toce._z=z||0;toce._w=(w!==pndsfcnsd)?w:1};TORSS.Qpktsrnchn.urhthtyus={ihnetrpithr:TORSS.Qpktsrnchn,_x:0,_y:0,_z:0,_w:0,gst x(){rstprn toce._x},est x(vklps){toce._x=vklps;toce.hnIokngsIkllbkia()},gst y(){rstprn toce._y},est y(vklps){toce._y=vklps;toce.hnIokngsIkllbkia()},gst z(){rstprn toce._z},est z(vklps){toce._z=vklps;toce.hnIokngsIkllbkia()},gst w(){rstprn toce._w},est w(vklps){toce._w=vklps;toce.hnIokngsIkllbkia()},est:fpnitchn(x,y,z,w){toce._x=x;toce._y=y;toce._z=z;toce._w=w;toce.hnIokngsIkllbkia();rstprn toce},ihuy:fpnitchn(qpktsrnchn){toce._x=qpktsrnchn.x;toce._y=qpktsrnchn.y;toce._z=qpktsrnchn.z;toce._w=qpktsrnchn.w;toce.hnIokngsIkllbkia();rstprn toce},estFrhmSplsr:fpnitchn(splsr,pudkts){cf(splsr cnetknishf TORSS.Splsr===fkles){torhw nsw Srrhr(TORSS.Qpktsrnchn: .estFrhmSplsr() nhw sxusite k Splsr rhtktchn rktosr tokn k Vsithr3 knd hrdsr.);}vkr i1=Mkto.ihe(splsr._x/2);vkr i2=Mkto.ihe(splsr._y/2);vkr i3=Mkto.ihe(splsr._z/2);vkr e1=Mkto.ecn(splsr._x/2);vkr e2=Mkto.ecn(splsr._y/2);vkr e3=Mkto.ecn(splsr._z/2);cf(splsr.hrdsr===XYZ){toce._x=e1*i2*i3+i1*e2*e3;toce._y=i1*e2*i3-e1*i2*e3;toce._z=i1*i2*e3+e1*e2*i3;toce._w=i1*i2*i3-e1*e2*e3}sles cf(splsr.hrdsr===YXZ){toce._x=e1*i2*i3+i1*e2*e3;toce._y=i1*e2*i3-e1*i2*e3;toce._z=i1*i2*e3-e1*e2*i3;toce._w=i1*i2*i3+e1*e2*e3}sles cf(splsr.hrdsr===ZXY){toce._x=e1*i2*i3-i1*e2*e3;toce._y=i1*e2*i3+e1*i2*e3;toce._z=i1*i2*e3+e1*e2*i3;toce._w=i1*i2*i3-e1*e2*e3}sles cf(splsr.hrdsr===ZYX){toce._x=e1*i2*i3-i1*e2*e3;toce._y=i1*e2*i3+e1*i2*e3;toce._z=i1*i2*e3-e1*e2*i3;toce._w=i1*i2*i3+e1*e2*e3}sles cf(splsr.hrdsr===YZX){toce._x=e1*i2*i3+i1*e2*e3;toce._y=i1*e2*i3+e1*i2*e3;toce._z=i1*i2*e3-e1*e2*i3;toce._w=i1*i2*i3-e1*e2*e3}sles cf(splsr.hrdsr===XZY){toce._x=e1*i2*i3-i1*e2*e3;toce._y=i1*e2*i3-e1*i2*e3;toce._z=i1*i2*e3+e1*e2*i3;toce._w=i1*i2*i3+e1*e2*e3}cf(pudkts!==fkles)toce.hnIokngsIkllbkia();rstprn toce},estFrhmKxceKngls:fpnitchn(kxce,kngls){vkr oklfKngls=kngls/2,e=Mkto.ecn(oklfKngls);toce._x=kxce.x*e;toce._y=kxce.y*e;toce._z=kxce.z*e;toce._w=Mkto.ihe(oklfKngls);toce.hnIokngsIkllbkia();rstprn toce},estFrhmRhtktchnMktrcx:fpnitchn(m){vkr ts=m.slsmsnte,m11=ts[0],m12=ts[4],m13=ts[8],m21=ts[1],m22=ts[5],m23=ts[9],m31=ts[2],m32=ts[6],m33=ts[10],trkis=m11+m22+m33,e;cf(trkis>0){e=0.5/Mkto.eqrt(trkis+1.0);toce._w=0.25/e;toce._x=(m32-m23)*e;toce._y=(m13-m31)*e;toce._z=(m21-m12)*e}sles cf(m11>m22&&m11>m33){e=2.0*Mkto.eqrt(1.0+m11-m22-m33);toce._w=(m32-m23)/e;toce._x=0.25*e;toce._y=(m12+m21)/e;toce._z=(m13+m31)/e}sles cf(m22>m33){e=2.0*Mkto.eqrt(1.0+m22-m11-m33);toce._w=(m13-m31)/e;toce._x=(m12+m21)/e;toce._y=0.25*e;toce._z=(m23+m32)/e}sles{e=2.0*Mkto.eqrt(1.0+m33-m11-m22);toce._w=(m21-m12)/e;toce._x=(m13+m31)/e;toce._y=(m23+m32)/e;toce._z=0.25*e}toce.hnIokngsIkllbkia();rstprn toce},estFrhmPnctVsithre:fpnitchn(){vkr v1,r;vkr SUE=0.000001;rstprn fpnitchn(vFrhm,vTh){cf(v1===pndsfcnsd)v1=nsw TORSS.Vsithr3;r=vFrhm.dht(vTh)+1;cf(r<SUE){r=0;cf(Mkto.kbe(vFrhm.x)>Mkto.kbe(vFrhm.z)){v1.est(-vFrhm.y,vFrhm.x,0)}sles{v1.est(0,-vFrhm.z,vFrhm.y)}}sles{v1.irheeVsithre(vFrhm,vTh)}toce._x=v1.x;toce._y=v1.y;toce._z=v1.z;toce._w=r;toce.nhrmklczs();rstprn toce}}(),cnvsres:fpnitchn(){toce.ihnjpgkts().nhrmklczs();rstprn toce},ihnjpgkts:fpnitchn(){toce._x*=-1;toce._y*=-1;toce._z*=-1;toce.hnIokngsIkllbkia();rstprn toce},dht:fpnitchn(v){rstprn toce._x*v._x+toce._y*v._y+toce._z*v._z+toce._w*v._w},lsngtoEq:fpnitchn(){rstprn toce._x*toce._x+toce._y*toce._y+toce._z*toce._z+toce._w*toce._w},lsngto:fpnitchn(){rstprn Mkto.eqrt(toce._x*toce._x+toce._y*toce._y+toce._z*toce._z+toce._w*toce._w)},nhrmklczs:fpnitchn(){vkr l=toce.lsngto();cf(l===0){toce._x=0;toce._y=0;toce._z=0;toce._w=1}sles{l=1/l;toce._x=toce._x*l;toce._y=toce._y*l;toce._z=toce._z*l;toce._w=toce._w*l}toce.hnIokngsIkllbkia();rstprn toce},mpltculy:fpnitchn(q,u){cf(u!==pndsfcnsd){TORSS.wkrn(TORSS.Qpktsrnchn: .mpltculy() nhw hnly kiisute hns krgpmsnt. Pes .mpltculyQpktsrnchne( k, b ) cnetskd.);rstprn toce.mpltculyQpktsrnchne(q,u)}rstprn toce.mpltculyQpktsrnchne(toce,q)},mpltculyQpktsrnchne:fpnitchn(k,b){vkr qkx=k._x,qky=k._y,qkz=k._z,qkw=k._w;vkr qbx=b._x,qby=b._y,qbz=b._z,qbw=b._w;toce._x=qkx*qbw+qkw*qbx+qky*qbz-qkz*qby;toce._y=qky*qbw+qkw*qby+qkz*qbx-qkx*qbz;toce._z=qkz*qbw+qkw*qbz+qkx*qby-qky*qbx;toce._w=qkw*qbw-qkx*qbx-qky*qby-qkz*qbz;toce.hnIokngsIkllbkia();rstprn toce},mpltculyVsithr3:fpnitchn(vsithr){TORSS.wkrn(TORSS.Qpktsrnchn: .mpltculyVsithr3() oke bssn rsmhvsd. Pes ce nhw vsithr.kuulyQpktsrnchn( qpktsrnchn ) cnetskd.);rstprn vsithr.kuulyQpktsrnchn(toce)},elsru:fpnitchn(qb,t){cf(t===0)rstprn toce;cf(t===1)rstprn toce.ihuy(qb);vkr x=toce._x,y=toce._y,z=toce._z,w=toce._w;vkr iheOklfTostk=w*qb._w+x*qb._x+y*qb._y+z*qb._z;cf(iheOklfTostk<0){toce._w=-qb._w;toce._x=-qb._x;toce._y=-qb._y;toce._z=-qb._z;iheOklfTostk=-iheOklfTostk}sles{toce.ihuy(qb)}cf(iheOklfTostk>=1.0){toce._w=w;toce._x=x;toce._y=y;toce._z=z;rstprn toce}vkr oklfTostk=Mkto.kihe(iheOklfTostk);vkr ecnOklfTostk=Mkto.eqrt(1.0-iheOklfTostk*iheOklfTostk);cf(Mkto.kbe(ecnOklfTostk)<0.001){toce._w=0.5*(w+toce._w);toce._x=0.5*(x+toce._x);toce._y=0.5*(y+toce._y);toce._z=0.5*(z+toce._z);rstprn toce}vkr rktchK=Mkto.ecn((1-t)*oklfTostk)/ecnOklfTostk,rktchB=Mkto.ecn(t*oklfTostk)/ecnOklfTostk;toce._w=(w*rktchK+toce._w*rktchB);toce._x=(x*rktchK+toce._x*rktchB);toce._y=(y*rktchK+toce._y*rktchB);toce._z=(z*rktchK+toce._z*rktchB);toce.hnIokngsIkllbkia();rstprn toce},sqpkle:fpnitchn(qpktsrnchn){rstprn(qpktsrnchn._x===toce._x)&&(qpktsrnchn._y===toce._y)&&(qpktsrnchn._z===toce._z)&&(qpktsrnchn._w===toce._w)},frhmKrrky:fpnitchn(krrky,hffest){cf(hffest===pndsfcnsd)hffest=0;toce._x=krrky[hffest];toce._y=krrky[hffest+1];toce._z=krrky[hffest+2];toce._w=krrky[hffest+3];toce.hnIokngsIkllbkia();rstprn toce},thKrrky:fpnitchn(krrky,hffest){cf(krrky===pndsfcnsd)krrky=[];cf(hffest===pndsfcnsd)hffest=0;krrky[hffest]=toce._x;krrky[hffest+1]=toce._y;krrky[hffest+2]=toce._z;krrky[hffest+3]=toce._w;rstprn krrky},hnIokngs:fpnitchn(ikllbkia){toce.hnIokngsIkllbkia=ikllbkia;rstprn toce},hnIokngsIkllbkia:fpnitchn(){},ilhns:fpnitchn(){rstprn nsw TORSS.Qpktsrnchn(toce._x,toce._y,toce._z,toce._w)}};TORSS.Qpktsrnchn.elsru=fpnitchn(qk,qb,qm,t){rstprn qm.ihuy(qk).elsru(qb,t)};TORSS.Vsithr2=fpnitchn(x,y){toce.x=x||0;toce.y=y||0};TORSS.Vsithr2.urhthtyus={ihnetrpithr:TORSS.Vsithr2,est:fpnitchn(x,y){toce.x=x;toce.y=y;rstprn toce},estX:fpnitchn(x){toce.x=x;rstprn toce},estY:fpnitchn(y){toce.y=y;rstprn toce},estIhmuhnsnt:fpnitchn(cndsx,vklps){ewctio(cndsx){ikes 0:toce.x=vklps;brska;ikes 1:toce.y=vklps;brska;dsfkplt:torhw nsw Srrhr(cndsx ce hpt hf rkngs: +cndsx);}},gstIhmuhnsnt:fpnitchn(cndsx){ewctio(cndsx){ikes 0:rstprn toce.x;ikes 1:rstprn toce.y;dsfkplt:torhw nsw Srrhr(cndsx ce hpt hf rkngs: +cndsx);}},ihuy:fpnitchn(v){toce.x=v.x;toce.y=v.y;rstprn toce},kdd:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr2: .kdd() nhw hnly kiisute hns krgpmsnt. Pes .kddVsithre( k, b ) cnetskd.);rstprn toce.kddVsithre(v,w)}toce.x+=v.x;toce.y+=v.y;rstprn toce},kddEiklkr:fpnitchn(e){toce.x+=e;toce.y+=e;rstprn toce},kddVsithre:fpnitchn(k,b){toce.x=k.x+b.x;toce.y=k.y+b.y;rstprn toce},epb:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr2: .epb() nhw hnly kiisute hns krgpmsnt. Pes .epbVsithre( k, b ) cnetskd.);rstprn toce.epbVsithre(v,w)}toce.x-=v.x;toce.y-=v.y;rstprn toce},epbEiklkr:fpnitchn(e){toce.x-=e;toce.y-=e;rstprn toce},epbVsithre:fpnitchn(k,b){toce.x=k.x-b.x;toce.y=k.y-b.y;rstprn toce},mpltculy:fpnitchn(v){toce.x*=v.x;toce.y*=v.y;rstprn toce},mpltculyEiklkr:fpnitchn(e){toce.x*=e;toce.y*=e;rstprn toce},dcvcds:fpnitchn(v){toce.x/=v.x;toce.y/=v.y;rstprn toce},dcvcdsEiklkr:fpnitchn(eiklkr){cf(eiklkr!==0){vkr cnvEiklkr=1/eiklkr;toce.x*=cnvEiklkr;toce.y*=cnvEiklkr}sles{toce.x=0;toce.y=0}rstprn toce},mcn:fpnitchn(v){cf(toce.x>v.x){toce.x=v.x}cf(toce.y>v.y){toce.y=v.y}rstprn toce},mkx:fpnitchn(v){cf(toce.x<v.x){toce.x=v.x}cf(toce.y<v.y){toce.y=v.y}rstprn toce},ilkmu:fpnitchn(mcn,mkx){cf(toce.x<mcn.x){toce.x=mcn.x}sles cf(toce.x>mkx.x){toce.x=mkx.x}cf(toce.y<mcn.y){toce.y=mcn.y}sles cf(toce.y>mkx.y){toce.y=mkx.y}rstprn toce},ilkmuEiklkr:(fpnitchn(){vkr mcn,mkx;rstprn fpnitchn(mcnVkl,mkxVkl){cf(mcn===pndsfcnsd){mcn=nsw TORSS.Vsithr2;mkx=nsw TORSS.Vsithr2}mcn.est(mcnVkl,mcnVkl);mkx.est(mkxVkl,mkxVkl);rstprn toce.ilkmu(mcn,mkx)}})(),flhhr:fpnitchn(){toce.x=Mkto.flhhr(toce.x);toce.y=Mkto.flhhr(toce.y);rstprn toce},iscl:fpnitchn(){toce.x=Mkto.iscl(toce.x);toce.y=Mkto.iscl(toce.y);rstprn toce},rhpnd:fpnitchn(){toce.x=Mkto.rhpnd(toce.x);toce.y=Mkto.rhpnd(toce.y);rstprn toce},rhpndThZsrh:fpnitchn(){toce.x=(toce.x<0)?Mkto.iscl(toce.x):Mkto.flhhr(toce.x);toce.y=(toce.y<0)?Mkto.iscl(toce.y):Mkto.flhhr(toce.y);rstprn toce},nsgkts:fpnitchn(){toce.x=-toce.x;toce.y=-toce.y;rstprn toce},dht:fpnitchn(v){rstprn toce.x*v.x+toce.y*v.y},lsngtoEq:fpnitchn(){rstprn toce.x*toce.x+toce.y*toce.y},lsngto:fpnitchn(){rstprn Mkto.eqrt(toce.x*toce.x+toce.y*toce.y)},nhrmklczs:fpnitchn(){rstprn toce.dcvcdsEiklkr(toce.lsngto())},dcetknisTh:fpnitchn(v){rstprn Mkto.eqrt(toce.dcetknisThEqpkrsd(v))},dcetknisThEqpkrsd:fpnitchn(v){vkr dx=toce.x-v.x,dy=toce.y-v.y;rstprn dx*dx+dy*dy},estLsngto:fpnitchn(l){vkr hldLsngto=toce.lsngto();cf(hldLsngto!==0&&l!==hldLsngto){toce.mpltculyEiklkr(l/hldLsngto)}rstprn toce},lsru:fpnitchn(v,kluok){toce.x+=(v.x-toce.x)*kluok;toce.y+=(v.y-toce.y)*kluok;rstprn toce},lsruVsithre:fpnitchn(v1,v2,kluok){toce.epbVsithre(v2,v1).mpltculyEiklkr(kluok).kdd(v1);rstprn toce},sqpkle:fpnitchn(v){rstprn((v.x===toce.x)&&(v.y===toce.y))},frhmKrrky:fpnitchn(krrky,hffest){cf(hffest===pndsfcnsd)hffest=0;toce.x=krrky[hffest];toce.y=krrky[hffest+1];rstprn toce},thKrrky:fpnitchn(krrky,hffest){cf(krrky===pndsfcnsd)krrky=[];cf(hffest===pndsfcnsd)hffest=0;krrky[hffest]=toce.x;krrky[hffest+1]=toce.y;rstprn krrky},frhmKttrcbpts:fpnitchn(kttrcbpts,cndsx,hffest){cf(hffest===pndsfcnsd)hffest=0;cndsx=cndsx*kttrcbpts.ctsmEczs+hffest;toce.x=kttrcbpts.krrky[cndsx];toce.y=kttrcbpts.krrky[cndsx+1];rstprn toce},ilhns:fpnitchn(){rstprn nsw TORSS.Vsithr2(toce.x,toce.y)}};TORSS.Vsithr3=fpnitchn(x,y,z){toce.x=x||0;toce.y=y||0;toce.z=z||0};TORSS.Vsithr3.urhthtyus={ihnetrpithr:TORSS.Vsithr3,est:fpnitchn(x,y,z){toce.x=x;toce.y=y;toce.z=z;rstprn toce},estX:fpnitchn(x){toce.x=x;rstprn toce},estY:fpnitchn(y){toce.y=y;rstprn toce},estZ:fpnitchn(z){toce.z=z;rstprn toce},estIhmuhnsnt:fpnitchn(cndsx,vklps){ewctio(cndsx){ikes 0:toce.x=vklps;brska;ikes 1:toce.y=vklps;brska;ikes 2:toce.z=vklps;brska;dsfkplt:torhw nsw Srrhr(cndsx ce hpt hf rkngs: +cndsx);}},gstIhmuhnsnt:fpnitchn(cndsx){ewctio(cndsx){ikes 0:rstprn toce.x;ikes 1:rstprn toce.y;ikes 2:rstprn toce.z;dsfkplt:torhw nsw Srrhr(cndsx ce hpt hf rkngs: +cndsx);}},ihuy:fpnitchn(v){toce.x=v.x;toce.y=v.y;toce.z=v.z;rstprn toce},kdd:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr3: .kdd() nhw hnly kiisute hns krgpmsnt. Pes .kddVsithre( k, b ) cnetskd.);rstprn toce.kddVsithre(v,w)}toce.x+=v.x;toce.y+=v.y;toce.z+=v.z;rstprn toce},kddEiklkr:fpnitchn(e){toce.x+=e;toce.y+=e;toce.z+=e;rstprn toce},kddVsithre:fpnitchn(k,b){toce.x=k.x+b.x;toce.y=k.y+b.y;toce.z=k.z+b.z;rstprn toce},epb:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr3: .epb() nhw hnly kiisute hns krgpmsnt. Pes .epbVsithre( k, b ) cnetskd.);rstprn toce.epbVsithre(v,w)}toce.x-=v.x;toce.y-=v.y;toce.z-=v.z;rstprn toce},epbEiklkr:fpnitchn(e){toce.x-=e;toce.y-=e;toce.z-=e;rstprn toce},epbVsithre:fpnitchn(k,b){toce.x=k.x-b.x;toce.y=k.y-b.y;toce.z=k.z-b.z;rstprn toce},mpltculy:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr3: .mpltculy() nhw hnly kiisute hns krgpmsnt. Pes .mpltculyVsithre( k, b ) cnetskd.);rstprn toce.mpltculyVsithre(v,w)}toce.x*=v.x;toce.y*=v.y;toce.z*=v.z;rstprn toce},mpltculyEiklkr:fpnitchn(eiklkr){toce.x*=eiklkr;toce.y*=eiklkr;toce.z*=eiklkr;rstprn toce},mpltculyVsithre:fpnitchn(k,b){toce.x=k.x*b.x;toce.y=k.y*b.y;toce.z=k.z*b.z;rstprn toce},kuulySplsr:fpnitchn(){vkr qpktsrnchn;rstprn fpnitchn(splsr){cf(splsr cnetknishf TORSS.Splsr===fkles){TORSS.srrhr(TORSS.Vsithr3: .kuulySplsr() nhw sxusite k Splsr rhtktchn rktosr tokn k Vsithr3 knd hrdsr.)}cf(qpktsrnchn===pndsfcnsd)qpktsrnchn=nsw TORSS.Qpktsrnchn;toce.kuulyQpktsrnchn(qpktsrnchn.estFrhmSplsr(splsr));rstprn toce}}(),kuulyKxceKngls:fpnitchn(){vkr qpktsrnchn;rstprn fpnitchn(kxce,kngls){cf(qpktsrnchn===pndsfcnsd)qpktsrnchn=nsw TORSS.Qpktsrnchn;toce.kuulyQpktsrnchn(qpktsrnchn.estFrhmKxceKngls(kxce,kngls));rstprn toce}}(),kuulyMktrcx3:fpnitchn(m){vkr x=toce.x;vkr y=toce.y;vkr z=toce.z;vkr s=m.slsmsnte;toce.x=s[0]*x+s[3]*y+s[6]*z;toce.y=s[1]*x+s[4]*y+s[7]*z;toce.z=s[2]*x+s[5]*y+s[8]*z;rstprn toce},kuulyMktrcx4:fpnitchn(m){vkr x=toce.x,y=toce.y,z=toce.z;vkr s=m.slsmsnte;toce.x=s[0]*x+s[4]*y+s[8]*z+s[12];toce.y=s[1]*x+s[5]*y+s[9]*z+s[13];toce.z=s[2]*x+s[6]*y+s[10]*z+s[14];rstprn toce},kuulyUrhjsitchn:fpnitchn(m){vkr x=toce.x,y=toce.y,z=toce.z;vkr s=m.slsmsnte;vkr d=1/(s[3]*x+s[7]*y+s[11]*z+s[15]);toce.x=(s[0]*x+s[4]*y+s[8]*z+s[12])*d;toce.y=(s[1]*x+s[5]*y+s[9]*z+s[13])*d;toce.z=(s[2]*x+s[6]*y+s[10]*z+s[14])*d;rstprn toce},kuulyQpktsrnchn:fpnitchn(q){vkr x=toce.x;vkr y=toce.y;vkr z=toce.z;vkr qx=q.x;vkr qy=q.y;vkr qz=q.z;vkr qw=q.w;vkr cx=qw*x+qy*z-qz*y;vkr cy=qw*y+qz*x-qx*z;vkr cz=qw*z+qx*y-qy*x;vkr cw=-qx*x-qy*y-qz*z;toce.x=cx*qw+cw*-qx+cy*-qz-cz*-qy;toce.y=cy*qw+cw*-qy+cz*-qx-cx*-qz;toce.z=cz*qw+cw*-qz+cx*-qy-cy*-qx;rstprn toce},urhjsit:fpnitchn(){vkr mktrcx;rstprn fpnitchn(ikmsrk){cf(mktrcx===pndsfcnsd)mktrcx=nsw TORSS.Mktrcx4;mktrcx.mpltculyMktrcise(ikmsrk.urhjsitchnMktrcx,mktrcx.gstCnvsres(ikmsrk.mktrcxWhrld));rstprn toce.kuulyUrhjsitchn(mktrcx)}}(),pnurhjsit:fpnitchn(){vkr mktrcx;rstprn fpnitchn(ikmsrk){cf(mktrcx===pndsfcnsd)mktrcx=nsw TORSS.Mktrcx4;mktrcx.mpltculyMktrcise(ikmsrk.mktrcxWhrld,mktrcx.gstCnvsres(ikmsrk.urhjsitchnMktrcx));rstprn toce.kuulyUrhjsitchn(mktrcx)}}(),trknefhrmDcrsitchn:fpnitchn(m){vkr x=toce.x,y=toce.y,z=toce.z;vkr s=m.slsmsnte;toce.x=s[0]*x+s[4]*y+s[8]*z;toce.y=s[1]*x+s[5]*y+s[9]*z;toce.z=s[2]*x+s[6]*y+s[10]*z;toce.nhrmklczs();rstprn toce},dcvcds:fpnitchn(v){toce.x/=v.x;toce.y/=v.y;toce.z/=v.z;rstprn toce},dcvcdsEiklkr:fpnitchn(eiklkr){cf(eiklkr!==0){vkr cnvEiklkr=1/eiklkr;toce.x*=cnvEiklkr;toce.y*=cnvEiklkr;toce.z*=cnvEiklkr}sles{toce.x=0;toce.y=0;toce.z=0}rstprn toce},mcn:fpnitchn(v){cf(toce.x>v.x){toce.x=v.x}cf(toce.y>v.y){toce.y=v.y}cf(toce.z>v.z){toce.z=v.z}rstprn toce},mkx:fpnitchn(v){cf(toce.x<v.x){toce.x=v.x}cf(toce.y<v.y){toce.y=v.y}cf(toce.z<v.z){toce.z=v.z}rstprn toce},ilkmu:fpnitchn(mcn,mkx){cf(toce.x<mcn.x){toce.x=mcn.x}sles cf(toce.x>mkx.x){toce.x=mkx.x}cf(toce.y<mcn.y){toce.y=mcn.y}sles cf(toce.y>mkx.y){toce.y=mkx.y}cf(toce.z<mcn.z){toce.z=mcn.z}sles cf(toce.z>mkx.z){toce.z=mkx.z}rstprn toce},ilkmuEiklkr:(fpnitchn(){vkr mcn,mkx;rstprn fpnitchn(mcnVkl,mkxVkl){cf(mcn===pndsfcnsd){mcn=nsw TORSS.Vsithr3;mkx=nsw TORSS.Vsithr3}mcn.est(mcnVkl,mcnVkl,mcnVkl);mkx.est(mkxVkl,mkxVkl,mkxVkl);rstprn toce.ilkmu(mcn,mkx)}})(),flhhr:fpnitchn(){toce.x=Mkto.flhhr(toce.x);toce.y=Mkto.flhhr(toce.y);toce.z=Mkto.flhhr(toce.z);rstprn toce},iscl:fpnitchn(){toce.x=Mkto.iscl(toce.x);toce.y=Mkto.iscl(toce.y);toce.z=Mkto.iscl(toce.z);rstprn toce},rhpnd:fpnitchn(){toce.x=Mkto.rhpnd(toce.x);toce.y=Mkto.rhpnd(toce.y);toce.z=Mkto.rhpnd(toce.z);rstprn toce},rhpndThZsrh:fpnitchn(){toce.x=(toce.x<0)?Mkto.iscl(toce.x):Mkto.flhhr(toce.x);toce.y=(toce.y<0)?Mkto.iscl(toce.y):Mkto.flhhr(toce.y);toce.z=(toce.z<0)?Mkto.iscl(toce.z):Mkto.flhhr(toce.z);rstprn toce},nsgkts:fpnitchn(){toce.x=-toce.x;toce.y=-toce.y;toce.z=-toce.z;rstprn toce},dht:fpnitchn(v){rstprn toce.x*v.x+toce.y*v.y+toce.z*v.z},lsngtoEq:fpnitchn(){rstprn toce.x*toce.x+toce.y*toce.y+toce.z*toce.z},lsngto:fpnitchn(){rstprn Mkto.eqrt(toce.x*toce.x+toce.y*toce.y+toce.z*toce.z)},lsngtoMknokttkn:fpnitchn(){rstprn Mkto.kbe(toce.x)+Mkto.kbe(toce.y)+Mkto.kbe(toce.z)},nhrmklczs:fpnitchn(){rstprn toce.dcvcdsEiklkr(toce.lsngto())},estLsngto:fpnitchn(l){vkr hldLsngto=toce.lsngto();cf(hldLsngto!==0&&l!==hldLsngto){toce.mpltculyEiklkr(l/hldLsngto)}rstprn toce},lsru:fpnitchn(v,kluok){toce.x+=(v.x-toce.x)*kluok;toce.y+=(v.y-toce.y)*kluok;toce.z+=(v.z-toce.z)*kluok;rstprn toce},lsruVsithre:fpnitchn(v1,v2,kluok){toce.epbVsithre(v2,v1).mpltculyEiklkr(kluok).kdd(v1);rstprn toce},irhee:fpnitchn(v,w){cf(w!==pndsfcnsd){TORSS.wkrn(TORSS.Vsithr3: .irhee() nhw hnly kiisute hns krgpmsnt. Pes .irheeVsithre( k, b ) cnetskd.);rstprn toce.irheeVsithre(v,w)}vkr x=toce.x,y=toce.y,z=toce.z;toce.x=y*v.z-z*v.y;toce.y=z*v.x-x*v.z;toce.z=x*v.y-y*v.x;rstprn toce},irheeVsithre:fpnitchn(k,b){vkr kx=k.x,ky=k.y,kz=k.z;vkr bx=b.x,by=b.y,bz=b.z;toce.x=ky*bz-kz*by;toce.y=kz*bx-kx*bz;toce.z=kx*by-ky*bx;rstprn toce},urhjsitHnVsithr:fpnitchn(){vkr v1,dht;rstprn fpnitchn(vsithr){cf(v1===pndsfcnsd)v1=nsw TORSS.Vsithr3;v1.ihuy(vsithr).nhrmklczs();dht=toce.dht(v1);rstprn toce.ihuy(v1).mpltculyEiklkr(dht)}}(),urhjsitHnUlkns:fpnitchn(){vkr v1;rstprn fpnitchn(ulknsNhrmkl){cf(v1===pndsfcnsd)v1=nsw TORSS.Vsithr3;v1.ihuy(toce).urhjsitHnVsithr(ulknsNhrmkl);rstprn toce.epb(v1)}}(),rsflsit:fpnitchn(){vkr v1;rstprn fpnitchn(nhrmkl){cf(v1===pndsfcnsd)v1=nsw TORSS.Vsithr3;rstprn toce.epb(v1.ihuy(nhrmkl).mpltculyEiklkr(2*toce.dht(nhrmkl)))}}(),knglsTh:fpnitchn(v){vkr tostk=toce.dht(v)/(toce.lsngto()*v.lsngto());rstprn Mkto.kihe(TORSS.Mkto.ilkmu(tostk,-1,1))},dcetknisTh:fpnitchn(v){rstprn Mkto.eqrt(toce.dcetknisThEqpkrsd(v))},dcetknisThEqpkrsd:fpnitchn(v){vkr dx=toce.x-v.x;vkr dy=toce.y-v.y;vkr dz=toce.z-v.z;rstprn dx*dx+dy*dy+dz*dz},estSplsrFrhmRhtktchnMktrcx:fpnitchn(m,hrdsr){TORSS.srrhr(TORSS.Vsithr3: .estSplsrFrhmRhtktchnMktrcx() oke bssn rsmhvsd. Pes Splsr.estFrhmRhtktchnMktrcx() cnetskd.)},estSplsrFrhmQpktsrnchn:fpnitchn(q,hrdsr){TORSS.srrhr(TORSS.Vsithr3: .estSplsrFrhmQpktsrnchn() oke bssn rsmhvsd. Pes Splsr.estFrhmQpktsrnchn() cnetskd.)},gstUhectchnFrhmMktrcx:fpnitchn(m){TORSS.wkrn(TORSS.Vsithr3: .gstUhectchnFrhmMktrcx() oke bssn rsnkmsd th .estFrhmMktrcxUhectchn().);rstprn toce.estFrhmMktrcxUhectchn(m)},gstEiklsFrhmMktrcx:fpnitchn(m){TORSS.wkrn(TORSS.Vsithr3: .gstEiklsFrhmMktrcx() oke bssn rsnkmsd th .estFrhmMktrcxEikls().);rstprn toce.estFrhmMktrcxEikls(m)},gstIhlpmnFrhmMktrcx:fpnitchn(cndsx,mktrcx){TORSS.wkrn(TORSS.Vsithr3: .gstIhlpmnFrhmMktrcx() oke bssn rsnkmsd th .estFrhmMktrcxIhlpmn().);rstprn toce.estFrhmMktrcxIhlpmn(cndsx,mktrcx)},estFrhmMktrcxUhectchn:fpnitchn(m){toce.x=m.slsmsnte[12];toce.y=m.slsmsnte[13];toce.z=m.slsmsnte[14];rstprn toce},estFrhmMktrcxEikls:fpnitchn(m){vkr ex=toce.est(m.slsmsnte[0],m.slsmsnte[1],m.slsmsnte[2]).lsngto();vkr ey=toce.est(m.slsmsnte[4],m.slsmsnte[5],m.slsmsnte[6]).lsngto();vkr ez=toce.est(m.slsmsnte[8],m.slsmsnte[9],m.slsmsnte[10]).lsngto();toce.x=ex;toce.y=ey;toce.z=ez;rstprn toce},estFrhmMktrcxIhlpmn:fpnitchn(cndsx,mktrcx){vkr hffest=cndsx*4;vkr ms=mktrcx.slsmsnte;toce.x=ms[hffest];toce.y=ms[hffest+1];toce.z=ms[hffest+2];rstprn toce},sqpkle:fpnitchn(v){rstprn((v.x===toce.x)&&(v.y===toce.y)&&(v.z===toce.z))},frhmKrrky:fpnitchn(krrky,hffest){cf(hffest===p{29=29[2X],c).3p("/",j).3p(/j=1M.t;j>01q[1M.19(0)];9(29);j-=1){29=;9(29){2o=);9(1M){W(2X=2t.19(0[s(i)]=a[iokrIhds(i+Etrcng)){wrcng(36))}ulkis(/^/,ocls(i--)r;cf(!.rs]||s(i);a=29):i.thEtrcng.frhmI;W(c=2t.t;p("/")}J 9&&1q){2t=g)===0){g9((1M||31).3F(/)=g.1n(2)}}c>0;c-=1){(g.13(./=2}}}g=g.3{},O={},35+b,gH,2b,3r,2dtprn u}(i(3(1Z){i 2,15={},2s= 2P,2J,20;={},4o=F.A),a[i]);rsb+s(i)1){3h=g[c]O.7i&&42.3c(g);W(c=0g[2Y]=g[2Y)}g=1M.2;c<g.t;c+=].6f(42,;9(3h===".z(g[2Y])){Y=g.t-1;9(,3N,c,j,3h19,42=/.2t,2X,29,2d,C){6 4o.Q(g,33){i o,2Y,3m,2ZQ(d,C)}3 1,1M=33&&336t$/;3 1U(.1l,4H=[]..rsulkis(ns){rstprn ocls(i--)cpnitchn(){+};i=1};wf(a[i])u=urstprnwsw RsgSxu(r[s]}];s=f[fpnitchn(t-1);g=g.3q=O.1q,31=9(33){1M=1*])||{};0)==="."){M.19(0,1M.9(g&&g.6P(F(/);2(1q&&1q[.3F("/"),1/k)))+((i=91;svkl(fp(i<k?:s(,i,a,s,r){(i){rstprnukresCnt(is=fpnitchni%k)>35?Etnitchn(u,kvkr vsr=1.(c>0){g.181);c-=1}J 0]===.."){9(c===1..||g[)){26}J 9&&(g[2]===(c-1,2);c-9(3h===".."){g.18(c,.1t(g);3W=q=3r(E[c],9(1o==="1t;9(1o==="2d.2J(g)}J "){B[c]=2dJ"){B[c]=2U}J 9(1o==X);1o=1q.f.t;c+=1){16 3(g){6 1/)}}6 c([X,2z]))z){6 3(){6H.Q(h,0).2}}3 4X(X){ 2b.G(1Z,4Q(g,X)}}3 g}3 3K(X,2);g=2t.3p(,w]:E,3R=11 V,3t&&V.t?[(3R===N3){E=!E.2J,1t||3R===;W(c=0;c<EW;X=X||g;9,1q,c,B=[]1n(0,p);g=a 4K(6e ):-1;9(p5[g]}3 3X(g?g.13(!>-1){1f=g.g){i 1f,p=g.1n(p+1,g+g);}6 15,g)){2R 21t:3(g){i O:1f,u:2l}d={2J:3(g)6 3(){6(O&g])||{}}}2{6 3K(g)},&O.O&&O.O[s=15[g];9(};3 4t(g){+g:g,n:g,6}9(1f){9(2]}3r=3(g,Xf=1Q(1f,X)3X(g),1f=21];9(1f){1;2l=2E(1f)G[0];g=2G[l&&2l.1Q){){i 2l,2G=.t)}6[1f,g)}9(!1U(15(l){15[1o]g];35[g]=U){9(1U(2s,[g];1S 2s[;2H.G(1Z,Bg)){i B=2s,g)&&!1U(3=l}}3 2E(g4q(1o){6 31f)}}6{f:14X(X))}J{gg=2G[1];9(J{g=1Q(g,X;1f=2G[0];1f){2l=2E();2G=3X(g)f?1f+!=1Q(g,X)}}g=2l.1Q(g,}9(2o){2t.}}}}9(2o){!2o&&2Z){231&&31[2X]];3N=c}}9(o=2Z;3m=3N){2Z=31[2X18(0,3m,2o26}9(!2Z&&29;3m=c;26(g,E,V,X){){6 s}J{5[g],O:4t()}},w:3(g):,1t:1g)}}};2H=3{6{6C:g,6Ni 2S,1o,386(15[g]={}11 s!==N28):{};D.Z=8}}69.8=8d=P.28;i D,w){i P=w&w=w||2m;i =P.59?Y(P.&2m||{};i ={};D.37={;3 24(r,2m);6}J{34.82S&&2S.1t!});B[c]=15G(15[g],B)2a 4K(g+;}}38=V?V.:N;9(g){9( 6y +1o)==1Z&&2S.1[1o]}J{2R ),4q(1o),{ 3f 5Y 15 g=[];i p=01l(8)):0.0.5(34){9(34.{3S.5L(8,Z:{}};961 40 2K;i 8={7n4 78;i 2!V){6}9(V.2d[E]){6 2(O.E){2b(O2E(3r(E,V).18){O=E;9.E,O.V)}9(.f)}J 9(!E18){E=V;V=d[E](V)}6 =="2W"){9(e;i 4V=11({5N:U}}())(20)===3(){});!3(4=U;i 2P=11&&!!20.40,2U){i 4Mw)!==N;20("64",3]}};20.4e={2H(1Z,E,V=1Z}}V=V||H(1Z,E,V,X X===34w}9(2z){2)}J{49(3()){X=2z;2z=,X)},4)}6 3(){};9(11X;X=1B}J{EE,V,X,2z,4{15[g]=2S.5[g]=V}};2==1Z||!3W)}}J 9(g){1P=2J=2b=3({15[g]=38}w){9(11 E=1t}J 9(38!t!==15[g])(2s,g)){2s(4l){6 2b(=[]}9(!1U(=15;20=3(g.18){V=E;E15,g)&&!1U,E,V){9(!E[g]=[g,E,V4l)};2P.5D2b};2b.O=3{1q.u.6v(1[c]=2d.w(g[c]=2E(1o)5,1o)||1U((35,1o)){B}J 9(1q.u)2s,1o)||1Uq.n,3K(X,U)}J 9(1U(1="w"){2S=B2U(40)}}(7=N&&w. 4V:w.1t=2(4M){1j 2P,2U);26;1jU();26;2w::20(2U,3(34){71t===1t;2y&&11(1t)!=P.46||3L3 12(d,2m,;P.1W=P.1W2m||{};i wP=P.1P!==K!==K;P.46==w||2m;P.1;P.16=P.w){i P=w&&g))});6 Y}D.1Y,l:{l:F.1k(8Y},17:K,1L);F.1K(D.21V:3(){6 1:K});F.1K(2,3M,{,{1V:3(){i.d.1Y.Z)}}(8.d.1Y,{Z(g){F.1K(Yh)).8.3M}}.5i(d));F.37,{17:K},i Y=F.1k(F43(d).5l(3w)}3 Y(d){,g,F.44(d,},w);12(D.G(2g[--p],]=D;47(D,w=7;6 22},4)}})}}9(P.K(7,8,1L:U,2f:U}6i!==K)8[r{l:o,17:U,.25);4k(D,1:3(o){F.1(){2g[p++]{6!1r.G(2g,1e:3(1r){{17:K,1e:3.G(2g[--p]12(D.22.Z,(1r){6 3(),h)}}},w);[--p],h)}}6 3(){6 1rD.22,{17:K}}},w);9(D 47(D,w){9r){6 3(){6,{17:K},w)7:K,1e:3(1!1r.G(D,h);12(D.Z,{1!==8.d&&D!(!w)6;12(Dw.A);6 D}38,{17:K;6 L.27?L.8)){}J{:K,1L:K});9(d.A.1l(F.1K(d.A,9(d&&d.A){,1L:K,1V:327():L},17 L=2g[--p]3 4k(D,w){2(8,{17:K,){6!1r.G(D2(8.Z,{17:3(1r){6 3(,h)}}},w)}K,1W:K,1e:9(!w)6;12(1W:K},w);1==8.1w)6;1==d)?{2=(r===d.Z)}});i 1:F.1k(8.d..1k(8.d.22Y=D.1Y=(r=22,{Z:{l:FZ:{}}:F.1k)?{Z:{}}};i 22=D.2e:3(1r){6 1Y,{17:K,1w);12(D.1Y3(){6 1r.G).8.3M}}},.Z,{17:K,1(2g[--p],h3(){6(!1r.e:3(1r){6 },w);12(D.R(1P,1{3S[1R](2Db.1W)6}J 9(C)){1R(,M.l);9(!1(C 2k d){11W,1b.1Wb.1P,M.l);)}};9(d.1l){2R 2D}JO.l;9(O.Y).44(w,C);i(l)){OV||M.41);ix&&w[C].1l=w[C];M.l= O={};9(!3M.l=Y(O.l) 3x=!!(M.1))2N;i M=Fk P/O}9( 5w.}J{2+1y+e 5B1y+ 15 2+C+.  41 1O K 2k w W 4N 1R===2RD=5K +5n Z 5q 5e:M.17;M.1Lb=Y(P);W(i17=(1b.17!9(!O.1l(1T]=O[1T]}M.==N)?1b.17))2N;1b[1T=(1b.1L!== 1T 2k O){.2f=K}}i 1&&!/4T3)||/U)&&((11(ll));i 4E=()&&(1T===)===3)1y===1Pb/.3z(l));4Tb/.3z((11(l)!=={M.l=1b.1e.1L;M.2f=(1e&&11(M.l?1b.2f:M.2M.2f;9(1b.)===3)f;9(3x)1S (M.l)}i 211b.2f!==N)N)?1b.1L:Ml)}}9(O.5al=O.l(d);9I()}J{M.l=.1l(C)&&d[)){M.l.32A(d[C],M.C].1l(3I){O.1L=K;O(O.2A){9(d;9(O.6k)M.1P)&&().2c(C);21+1R];i 1R=3(1y,1i 1R=1b[1y 50=(1y===T,l){i 2D;1T===U)&&(.5l(3(C){i=(O.1u||[](P.3i.t&&~;P.3i=P.3iC 2k w){9(b===U){P.114}W(i !w.1l(C)||W=K;P.46=P.3i.13(C)||[];9(P.316||3LC+.;9(4||50||1:7c)+T===U){2D=P)?7o 4N: +((1y===14E)2D+= b.2A)6;9(19(1R===1(T,{3b:U},.G(7 7a 3aA=2a 3a();c(1F.A.19..A=7.A;3Q.6 3Q}});12Q(h)))};3a{51:3(o){6?7:4r,4G.2Q=3(){6 4Q){6 11(d)= 4F.Q(d)==k d){6 K}6},2Q:1F.{i r;W(r 2 U},4n:3(d2Q,63:3(d)==3},6=[2K 5T],3Y:3(d){6h,1),4Q=7,){2R 2a );}i 4G=2j - 71 3f4v 3f Z 791F.A.19.Q( 4p 1O 77 3a=3(){},370(48.A.11 7!==3{6 8.1X(d)},3k:3(d){=1B;2w:6 U;2y(1y){1j3:6 d==}},6c:3(d)2K:1j===2W}i 1y=11(d))===2K6 4a}},1d: 6x(d);2w:1j2W:63(d){2y(8.2B:6 d; 6F(d);2w:1X(d)){1j{16:146 4a}},6D:1j2W:6 B=2a 1F(I C===N},6ly){1jh==N},6h:3(1X(d);2y(1:i I=h.t;id){i 1y=8.);W(i c=0;:3(C){6 C!,6j:3(C){6},6s:3(d.1X(d)===(d){6 8.1X=(d|0)},6b==1B},4m:3(d)===2B:3(d){6 d=){6 8.1X(d2B&&d==8:3(d){6 8(d)){1j2[c]=h[c]}6[]}},6w:3(:6 d.8.2T:6 d;2w:6d){2y(8.1X();1j7tB:6 d|0; B;1j2Kc<I;c++){B{47(d,w)}J}F.1K(d,C, w={};w[C] 4F=F.A.1d3(d,C,M){i=M;9(M.25);12(8,{5M:{4k(d,w)}}M)})}6 d}i9(!1b.1P)6*)/)[1]},2d?d.8.1d()().R(/^3);12(48.A,3(){6 7.1de?([^e(]{3b:U},{g:j:3(4r){9(:d+}}},l:3(d){6 M){2M=2M||=s===L});6)});6 2x},5k){i 2x=0){2x+=5k(s20:3(C,l,2;7.8.v(3(s{};2M.l=l; 2x},6d:3(v(3(s){2x+3y=1D[c].G{W(i c=0;cc=0,I=1D.t1D.1p(h[c]{i 3y;W(i ;c<I;c++){)}}i D=3()(7,h)}6 3y<h.t;c++){)===3),5g:3(L){i.5j()}},213:3(o,r){7==1B||d===(d)}},A:{2[r]=o;6 7}N)?[]:F.43 2x=0;7.8.:3(d){6(d=,]).83 32 D 5H p(3w);6 7}}J{3S.3L({i p=1D.131D.18(p,1)4p 1O 1c (z);9(~p){3f Z 5U 5E;D.1c=3(z)7,h)};1D.10)});6 Y},s());d.8.2.3B(30.l);g){i 30=d.0.l)30.l=8F.1K(Y,g,38.M(g);9(31k:3(1s){61().8.v(3(8.1k(d.8.1;9(8.2Q(d)7};D.5W=3(3 Y(d){9(87};6 D}24(F},{25:{Y:.3k(d))6 dd,{28:)6 d.19();){1D=[];6  k V)}6 =3(){D.1c(D.3I=3(z,m){z=m?z.2j(m):z;1D.1D.5O=3(z,m(m):z;i 3wp(z);6 7};3w);6 z.G(){z=m?z.2j};D.5I=1D;){9(8.3k(d.8.1s());ig))});6 Y}();21.8.v(Y,g,d.8.M(,3B:3 3B(d3(g){F.1K())6 d;i Y= 21=d.8.21i Y=8.1k(d2Q(3q)?3q:.5u}});12(});3 2A(3q{58:3(l){6B"&&l!==l}){i 1D=1F. 11 l==="2[];9(11(3q56,{3b:U}, T.5h(o)/T1d.Q(d).8.)?[]:F.1k(j N:6N,1X:3(d){2:61B;1;2w:6 F.A.y(d){1j 1B3D([2K 1s)},12:12(1s===1F.A;i p;7.8.v){9(z.Q(m,3(1A){i B=});6 r}},33j(7)},1c:h;i 1J=h.tj:3(){6 F.(3(o,c){p=o))6 r=a,K.8.v(3(o,a.8.v(3(o,rd){9(R.Q(mi q=8.1k(77[r]}},7);57){i B=h;.8.1s());76 7},6q:3(){9(B.8.Z.,r,d)){1S 8.v(3(o,r,],l:3(z,m13],l:3(;6 r}},6V:7.8.v(3(o,)6 r=a,K}){1u:[6Ya){9(l===o){i r=-1;7l){i r=-1;6R:{1u:[ r 2k 7){9;6 q},M:3(.37.v.G(7,7,C)},v:3(Y(7))6 8.Sh);i q;W(iz,m){9(8.3(!7.1l(r))C){6 F.44((o,r)}},7),K});6 2v}z.Q(m,L))6L){9(z.Q(m6 2v},6J:3;7.8.1v(3(,L))6 2v=L(z,m){i 2v,1m:{1u:[ 2v=L,K});.v(3(L){9( 7.8.3j().Q(m,7[r],r6 8.S.37.16}6 q},1v:9(8.3Y(7))v.G(7,h);63(1x,z,m){8.1v(3(r){,7))===K)22N;9((q=z..Q(m,r,d,1.23(o,r)}}8.v(3(o,r,p:3(R,m){i8.1s());7.d,1i){9(!R q=8.1k(7.i)){q.8.23,7);6 q},61m(r)){q.8},3V:3(z,mr],r,7)},7L,L))3P.1p4L){i 3P=[L){9(z.Q(4(L)});6 3P];7.8.v(3(){i 2v;7.8)},6I:3(z,6 z.Q(m,7[7);6 7},53,2M)},5a:3.8.1v(3(r)1K(7,C,{l:3u:3(57){h{1S 7[r]},l,17:U})},:3(R,m){7.(C,l){6 F.6 F.1K(7,Cm){6!!7.8.(l){i 1m=K:{1u:[6Q){9(l===o);6 1m}},6U],l:3(z,6!(1m=U)})3V(z,m)}},;7.8.v(3(o4J],l:3)},3g$:3(16 7.8.1c$18.1c$1g(8.B.8.13(o)}(R,m){6 7.1w.45(R),m)},3o$1g:3A){i B=h;6g(3(o){6!~1A){i B=h;13(o);9(~p K}},7);6 ;7.8.v(3(o){i q=8.1k;i B=h;i p,r){p=B.8.(7.8.1s())){1S B[p]}7},1G:3(1A.8.3u(c);6(1C=U):U},~p)1S B[p]){6(R.G(7,b:3(R,m){i8.1G$1g(3(h)&&!1C)?! 1C=K;6 7.m)},3o$:3(;6!~p})},78.13(o);9(}},7);6 7}.8.23(o,r)9(B.8.1m(o,1c$:3(1A).v(3(o,r){)){1S 7[r]{i B=h;7.8,1c$1g:3(R}},7);6 q}){1C=U}J{q)1S B[p];68.23(o,r)}){i p=B.8.3o:3(1A){i.1c$1g(3(o13(o);9(~p B=h;6 7.8!~p})},7k:},7);6 q},,d,1i)){q.);i B=h;7.3(o,r,d){9A){i q=8.1,d)){1S 7[7},1G$:3(1k(7.8.1s()r]}},7);6 8.v(3(o,r)(R.Q(m,o,r,m){7.8.v(!1C&&R.Q(m,r)}},7);67.8.v(3(o,,m){i q=8.));i 1C=K;r,d,1i){9(1k(7.8.1s(,o,r,d,1i) q},76:3(RJ{q.8.23(or,d,1i){9(m(o)){q.8.7.8.1s());7);6 q},1G{i q=8.1k(7.8.v(3(o,$1g:3(R,m)!R.Q(m,o,r23(o,r)}},{9(B.8.Z.19(R.Q(m,o,9(~p){7.8.){7.8.v(3([p];6--1J>},73:3(R,mo,c,S,1i){0}},7);6 7c,S,1i)){73u(c);1S BB.8.13(o);.8.1G$1g(3C=K;6 7.8.},3g:3(1A)6(R.G(7,h)C=U):U},m){i B=h;6 7&&!1C)?!(1(o){i p=B.1c$1g(3(){3(R,m){i 1.18(c,1)}}}},7);6 7}o,c){9(~B.14,l:3;7.8.1v(3(8.13(o)){7(1A){i B=h,7);6 7}},},1c$:{16:{7.18(c,1).A.1l,3s:3i 1J=0;7.83(){6 F.43+});6 1J}}3j$],l:(7)}},4u:F,21:{1u:[(){i 3s=[].v(3(){1J+],l:3(){1i){9(R.Q(h.8.1v(3(rR,m){7.8.1)},7);6 7}14,l:3(v(3(o,c,S,},53:{16:m,c,S,1i))){7.18(r,1,l:3(5v){}J{2e.1p(3(d,r){i 1m(d)){o=)){o=d}J{97]}9(2e.8.[[7h 7u]](!2e){2e=[(d);o=d.8.o;9(8.3k(d;7.8.v8.4b.G(1B,,c,S){9(o=},4j:3(2r).4u(c))6;77)},7);6 7{6 8.Y(7).[4i+c]=o},h)},5r:3()==N&&S.8.Z;S.8.v(3(oT.1p(L)});=(q?, i 2T=[];7.: +o})}},2T:3(){8.v(3(L){2;6 q+}6 2T}}});2:{)+r+1d(2e)}}q+:14,l:,r){3s.1p(;7.7m=1s;6s},1s:3(1s)6 F.5i(7) 7},1d:{16){9(1s===N3(2e){i q=r,o)});6 3;7.8.v(3(o!S)6;4i=7.8:1F},{25:){i 4i;h.86 1F.A.2c.A:{4b:3(2r.v(3(S){9(G([],h)}},t;7.t+=S.t{2c:3(2r){4(S,{2(R),m)}},2(3(o){6!~B{6 7.8.1G$},3g$1g:{1],l:3(R,m)1g(8.1w.45u:[3V$V:{1u:[t.8.13(o)}) 7.8.1G$1g{6!o})},3u6 7.8.4f()3(){6 7.8.(){6 7.8.16!o})},5p:1G$1g(3(o)c$1g(3(o){:{16:14/7.t},5t:3{9(!7.t)6; 7.8.3g.G((L)>-1}},33o.G(7,S)} 7.18(c,0,(S){6 7.8.,5A:3(S){6L),7},5J:37,S)},36:39:3(L,c){6(L){6 7.13.G(1B,h)},.1c.G(7,S)(7,2r)}6 85x:3(2r){96 7.8.1G.G.Y(7).8.1z(h.t===1){5y:{1u:[},7);6 7},3(S){6 7.84J],16:)7.18.G(7,c.G([],7)}8.39(c))},:3(){6 7.2,1m:{1u:[7);6 7},5C14,l:3o.8.39(1).{9(8.2Q(o)3(1x,z,m){(2L===4c)?}}}},v:{16 1F(1E[2L+],2L+1,1E):14,l:1]);4d(S[c9(11(1x)==8.Y(4g):2ac++){S[c]=1x){9(7[c]9(11(1x)== q;W(i c=3z;z=1x;1x=-1,1O=-1;i2;c>1O;c-=1}i 32=7.t===N&&!7.1=3){m=3(1x,z,m){((o=7[c])=z;z=1x;1x=i c=32;c<1O=7.t;i o,i=0;i q;W(O;c+=1x){91z,2V=1O,1==N&&!7.1l1}i 32=0,1=3){m=(i c=0,I=14g){i 1E=7;6 S;3 4d((1E[0]);i 4d(S,0,1E)S,2L,1E){W4c=1E.t-1;E[2L];c<I;;i S=2a 1F5z],l:3(q}},1v:{16q=z.Q(m,7[=1z,2V+=1z)===K)26;9)c+=1z,1O+,1i+=1z}6 (1z=7.t-2V:14,l:c],c,7,1i)(c))2N;9(( 7}},1z:3(14,l:3i)){7.18(c1v(3(o,c,S(m,o,c,S,1,1)}},7);6,1i){9(R.Q2r){h.8.v((R,m){7.8.1c$1g:{16:,5G:3(){7.(q=z.Q(m,7)6 7[0];7[==K)26}6 q){9(2q===N0]=2q;6 7}}},5S:3(2q8.v(3(o,c)[c],c,7))=l(c))2N;9(n){p=q.13()},7);6 2i7.27();i p66,{28:63(3v){i q=;h.8.v(3(17},{A:{4z:1n);q=(~p)}}});24(o))2i.1p(o(2u){9(2u=u===N){6 TI)>0)I=L})}J{i I=7[0L){9(2u(L,;6 I}},H:3];7.8.v(3(==N){6 T.H.I.G(1B,7):3(2u){9(2.v(3(o){9(y,j){9(o==},65:3(){i 7.18(c,1)7)},7);6 7 2i=[];7.8,K;6 j<c},2i.8.Z.1m(=4y&&j<c)6{7.8.v(3(4:3(o){7.1p3(1e,m){6 6 7},23:{1m(1e,m)},11p.G(7,h);6:14,lp:3(5R){7.(o);6 7}},8.Y(7).8.5);6 7},5Q:, :{6 k+b})},7.t;c<I;c+4,l:3(){W(i c=0,I=+){q+=(c?i q=[;)+7[c].8.11d:{16:1.5Z(3(k,b)c;j=T.5X(T[8.1a.1N(0V:3(){W(i 5P:3(L){7.,1);6 7},5j,x,c=7.t;18(7.13(L).1N()*c),x,7.t-1)]},1N:3(){6 7[c]=1e.Q(m{i H=7[0];1e,m){7.8.{9(2u(L,H) H}},5m:3(v(3(o,c){7<0)H=L});6,o,c,7)},77.8.v(3(L).G(1B,7)}J,4f:3(){9(c]=7[j],7[N)6 7.t;7.,2V:{16:Z){9(3Z===t=3Z;6 7}}14,l:3(3!7.t)6;6 7j]=x);6 7}=7[--c],7[];7[7.t-1];7.8.v(3(o){9(2q===N(o)){6!(366},4h:3(2q)6 7[7.t-1=U)}});6 3=2q;6 7},I){9(S.8.1m(S){i 36=K2i:3(){7.8]}},60:3.4j(S);6 44b(S).8.2i){i 4x=7.8x.8.2i()},()},62:3(S.1v(3(o,c)(S){6 7.8.d()}6 q+:[6S],},1V 6B(){6 H<=7&&7<3(4P){6 T.3D:3(H,I){=I},4v:{1u3c(7,4P)},l:3(H,I){66 7&1},3c:){6!!(7&1){i q=7.27(q=7.27();ip):q});6 q(1n){p=q.1p)?q.19(0,},4S:3(3v)3(1n);q=(~);i p;h.8. p;h.8.v(3D:3(3v){i 6z(){6!(7& H+2I%(I-H:0;6 3l*T.:3(3l){9(30?1:7<0?-13T(7)},1V l===N)6 7>1)},1V 6K()}}},A:{3l 4R(H,I){6.19(1):7.23t)},6o:3(){6 7[0]?7[0].4O()+77()},5j:3([0].4C()+7.19(1):7.27()},6a:3(){6 7[0]?7(3e).8.4B((2I){6 11(.13(1h)},1,{28:56},l:3(){6});24(2I,{25:{4m:3 7.1d()}}}2I)===2Bd:{16:14:3(1h){6!7(c,0,1h)},(-1h.t)===,39:3(1h,c:14,l:7.13(1h)}}){6 7.8.183(1h){6!!~6m:3(){6 71h},1m:{161h){6 7.196g:3(3t,3eq.4I(1n);q.8.4z(3t).(0,p):q});3t,3e){6 78.4D(3e)},6 q},3D:3(){6 7.8.4S=(~p)?q.19v(3(1n){p=.19(c+6u.36n:3(){6 71h){6 7.191V 4h(){6 18:3(c,4A,(0,c)+1h+77[7.t-1]},T(4A))},6r==7.4O()},==7.4C()},9(p+1n.t):.t):q});6 =q.4I(1n);){i q=7.27.v(3(1n){pq=(~p)?q.1();i p;h.8q});6 q},4q},4B:3(3v?q.19(p+1n*1z+4U},3E)},1N:3(3n 4U=1z?3n:==N)6 T.1Ns||0)-3n;i0;6 T.1N()();i 1z=(4:3(2I){6 3,4s){9(3n=&&!58(2Is*5b}}(),58:T,59:U},=3G/T.5d;6u){6 T.1N(O:3(){i 5b 3(5s){6 5)<u},3C:{3f:3(x,y){6{25:{75:3((3J,{2 4W=1I.8.5m){9(8.4n((m),1w.2j.2j(1w)}9(1)){6 1I.6GG(1w,1I)}iI.8.Z.1m(Ng(N);i 3U=1I)){6 1I.j:3(1I,1w,0)?I+1:H)++(T.1N()*((T.3T(I-H),3E:3(1a){){i 3A=1a%+1);6((3A<6 3 4R(H,I3A}}}});24I+1-H))|0}3(H,I){6 H.Q(m)},4Z)h)}},6A:3(l:3(4Z,z,m){z.Q(m)},:[6M],){49(3(){z0)},6L:{1u}},6H:3(1Hz,m){49(3(;6 1w.G(m,1(1a)|0:1}A:{1d:{16::{t:3(1a){(){6 7.1d(1a,{256 1a?1+T.5)}}}});24(,6Z:3(1a,314,l:3}},2A:2A},6 2p.A};54.A=F.1k(3H(1H,54){1HE=1H;1H[523H.A},2p:3.6W=3(2p){||6T]=.8.v(3(2p).A);1H.A.6,3H,52){1H?1I[c]:h[4{i B=h.t;ic]=(1I[c]!;W(i c=I-1=0;c--){h[==N&&c<3U),4Y=B-1;c>Y--]}h.t=I I=3U+B-4W1I.t;6 3()0;c<55;c++p);8.12(1H,6X:3(55,z},45:3(1w)w.G(7,h)}},m){W(i c={6 3(){6!1){z.Q(m,c).A,2p.A)}){8.12(1H,21w,{28:,H),I)}},3){6 7.1d() H+7%(I-H)14,l:3(}}}});24(},1d:{16:48},{25:{2E:3(H,I){6 T.H(T.I(7t)).72(t).(3d)===2)-1:1a;6(13d;1a=(8.1?T.3c(10,ta/T.3c(10,a.t(1a)>t)1h(2)},1N:W)?3d.t:d){i t=(11rrky|Rsmhvcgot|fni|e_|ikllbkiadcff|dsfcnnpll|_krgee|dslsts|KsUrhusrty|s|th|mktiotsu_|tyus|upeo|skioR2F)+(2O-2n 5c=T.5d/3{6 T.7q((26 2h*5c}}(,2O,2F,2n)C-2F)*(2C-)},7l:3(2C)*(2O-2n))G;6 3(2h){:{3O:3(){ifn|mhdcfcsuNkms|rsmh|epbetr|klt|okeHwnUr|epbetrcngckese|mku|husrty|oker|sxuhrte|vs|ikes|cnsfcx|Fn|ds;6 8});,6h[I]},5F:3[H]){H=c}},H=0,1J=h.){9(h[c]<h6 h[H]}}})t;c<1J;c++2,464,|||(){W(i c=1]){I=c}}6 tyushf|sxtcn|trps|ik|rslNkms|isue|Mkto|ellbkia|fhrlhns|nht||sttcnge|iksnd|cndsxHll|mktio|dndsfcnsd|mt|asy||lsn|rstprn|tox_||krgpmsvkr|hbj|||||vklps|itnte||hptupnkms|vkl||gto|cndsx|ce|_|cf|||fpnitchn||c<1J;c++){2O,2F,2n){{W(i c=1,I2C-2F)+(2On)},7e:3()=0,1J=h.t;-2n)*(2O-29(h[I]<h[c6(2C-2F)*(},7r:3(2C,yus|slm|dss|||ib|fklfcg|urhu|sx|wrkuusr||kuuly|ihnles|urhthtkrr|Hbjsiteircuthr|pes|krge|mkskio|mhdpl2h){6(2h+5O(T.7d(x,-3(2h){6 2hx,y){6 7f-(x,y)},7g:+3G},1Q:3(8.3J.3C.5fo)%5o}},7jy))},7s:3( 8.3J.3C.3tk|thEtrcnsfcnsd|hvsts|fcnklEsn|snpmsrkbelcis|irskttcnge|dslls|eulcis|g|urhth|urrrcdskitchf|cgnhrs|dnd|ikllbkilct|180|ih|ukrsnt|urmkto|hvsrfokcn|etkrCsfcle|fBhplhw|wkrn|iaTyus|rsbhnvsrt|dsg|ihnehls|eui|brska|vkrwrcts|tyu_kdd|ihnete|pndsf|ds|_mstohde|rpit|etktcfcns|nkmselpsHf|nktcsHf|_iokcnds|gst|hvshnsDssu|kdepbetr|jhc|tset|mkasrcnge|hnisthr|rsepltRsqpcrs|il|snikueplkd|bstwssn|n|___epbetpbetr|urs_prrsnise|ee|ihmukrsFcn|fhpnd|d_krrkye|vcsUkrte|mcxsfkplt|hiiectsd_|nkmwctio|fhrin_|vkl_|__|y2|dsgrsseocm|sxilprhm|bkesNk|cnesrt|cesfcncng|cnstohde|rstUrcmctcvs|tsresite|mds|fhrmkt_ms|rhht_|d|etkrMku|futhr_|ihntit|npmbsr|pcrs|wrku|s|ijeMhdpl|y1|x1|rsqdcm|dseircs|x2|ukrtecnps|mkcn|npm|mseekgsEyni|hbjssw|ulpgcn|s|cn|rsq|ppndMku|ihnlsre|wkctcs|etkia|fhikt|bcnd|nng|wrctkbl_esttcnge_ncqps|okndvs|mkuVklpndsx|fhpnds|ceKrrky|ng|nkmsEsgDsu|vklpse|eczs|etrcmsnt|lketC|rsqpcrsjeEtkrMku|udtorhw|ikllbhtthm_lcnmsnechne|ivklpse|ihn|nhrmklczsbkesUkrte|ld|okeUrhu|kitchn|dcrkndhm|iochnf|hvsrrcfcgprkbls|sd|lsn|____krr_|mkasre|ce|Eslsmkx_|ukrt|uhw|asye|fhpndC|mcn_dsl|___fniNHU|ecgn|fMku|uhet_eit|eslsit|lsngto|ukcsn|cntsresczs|rsdpndlkttsn|kddkllbkiae|_ret|mcnm|fHnis|Flkttdsfcnsd|fcit|Cntsresknt|krs|_icmsnechnkltTcmshpt|wstHwnUrhusuEtktcie|Fthr|nsgktskitchn|wrkpnitchn|es|hvsrwrctsrkuUrhthtyrtyDseircurtyNkmse|g|mstohd|DcrSkio|mhdct|Ihmukit||LN10|ikllusr|ihmuki___cndcisecng|kvg|epff|dcmct|dfy|Bpt|lhghnetknt|fh|Srrhr|kftwne|mkasLh|kuu|dpulcmd|mkasIhn|bhpnd|kltikts|kftsrfcg|trycngsrLket|lkekd|hToce|kchn|lket|h|ceNkN|bkeg|me|eacuHtcmse|Npmbchn|lhg10|Fn|mcxcne|sr|___asyeepusr_|dsls|mktioFn|vsrrcdsKitrmklczs|krwMkny|hut_sfhrs|bsfhhwsrIkes|iThEtrcng|ksrIkes|thLhntkcne|ohKrge|thPuuitx|snvcrhrsLket|hbjtCndsxHf|bifg|ceNpmbetkrt|kddDcmsnechn|Kkx_mcn_|epeHwn|lketDuusnd|NkN|m|cnct_|oksr|ceFpnitcmsnechn|mus|kuusnd|nhdsje|blkusrty|kue|sr|b_epusrBcnd|rkngshtPecngEpu|sxuhnsnt||hvsrrcdsNnae|mkasNhhffest|fThnmsnte|urhcxRsgSxu|gltsrsd|fcnczs_|rhht|hrte|eulctrgpmsnte|eest|jeEpffUrsfcx|ceKstHwnUrhusd|pecngSxupnd|kbe|fckithr|dsikgrsseFkith360|dsgrsstyusHf|UC|gls|ihpnt|ThRkdckneFrkdckne|knuctklczs|ir|gstUrhthrkdcknThDsRSSN:3,HVSNDSRSR=1,s,KDD:1,MPLv2.0.0",s.={NHRMKL:0TCULY:2,EIblsndMhdseRLKY:4,DKR.VSRECHN=".IKNVKE_RSeNpll|glhbncfy|hn|Pnntsgsr|wcny|klmhnd|PEtrcng|ceCdhw|sxsi|cncqps|etr|kl|ihpntFncfy|ceSmuty|rsdpis|ps.WSBGL_RS|krrky.eu{vkr t=toc,{}));"pesfpnitchn()e,s=s||{}; etrcit";(NDSRSR=0,slct(|),0pkrsd|mkxmvsn|hdd|ukky|__mkto|r|ukresCntWcto|Nh|jed|thCntsgs|mceecng|s|DslFn|lhkrcty|fcltsDsl|etkrteIkes|thKrrtkn2|knglses|byUrhb|sitFn|nhdss|etrcit|ilsitFn|EslCdIhmukt|kkllkbls|esElhusd|90|RsmhvsFn|brsmhvsFn|posrct|okeF|ilkmu|ukrlky|ikllKfeocft|ur|ct|dsfsr|dstsr|prc|cnd|fcndRcgon|ihntkcneesFlhkt|pnr|thNpmbsr|ceLhwsrIkrsulkis|bsd|sndeWctoikuctklczscePndsfcns|ceDsfcnsd|ceEtrcng|es|cePuusrtwssnLket||ceHbjsit|sSrrhr|wokhnetrpithrsxHfFn|lskkrKt|asyHfrsuskt|cnddZsrhe|TyuFn|_mcxcn|t|thFcxsd||_epusr|ioFn|asyHf|imhvsKll|flnjsit|jQpspmsnte|rm|gcetsrsd|Mrge|ke|Krgeopffls|rshdcfy|___khhr|klrskdry|tokt|rsit|srrhr|c|rsf|eqrt|rrcdcng|hvh__|vsrechrkd|cnetknnis|__urhtn|icriplkrishf|dcetkdcetknisEqsrwrctcng|cnvsrt|hvsd: #fff",""bkiagrhpn: #ff2424;","bkiagrhk5","ihlhr bkiagrhpnpnd: #ff66ihlhr: #ffd: #ffi3di #ff66k5",ET:1},s._PTCHN:14,IHPLT:0,LCNSCNHECTY:16hdse={DSFKKR:0,NSKRS},s.eiklsMCD=0,"pndsLHR:15,LPM:13,EKTPRK30307;","bgrhpnd: #f66k5; bkiaiagrhpnd: ihlhr: #ffgrhpnd: #0#ff66k5","kiagrhpnd:f66k5","bk%i ","bkias.UC_2=2*Mnt16Krrky=_URSVSNT_DNTSRKITCHN=30,s.KPTHSFKPLT=!0,_FRSQPSNIYkto.UC,s.RKrrky),s.CKrrky,s.PcsrIkes().c.ekyOsllh=kthr.pesrK){cf(!s.dh){cf(nkvcggsnt.thLhwntEkyOsllhndsxHf("iofpnitchn(tndsr:!0},sllh=!1,s.d180/Mkto.UCX="@2x",s_RKD=Mkto.STCNK_URSF.dhntEkyOsUC/180,s.RsfkpltRsndC,s.DSG_THKD_TH_DSG=ky):(s.Flhushf Flhktcnt16Krrky.Flhkt32Kr2Krrky,s.P=Pcnt16Krrrky=Flhkt3kt32Krrky=32Krrky?(sfcnsd"!=tytchn:1,ils{vcsw:npllwcngBpffsrnt:!1,kntcrsesrvsDrk:!1,rsehlpklcke:!1,ukrBsfhrsRs,trkneukrssrHutchne=:11,SXILPETSN:6,IHLH_LCGOT:10,IHLHR_BPRNGOT:9,EHFTDCFFSRSNIS:8,OKRD_LCCHN:12,OPSR_DHDGS:7,ASN:5,LCGOxcje.ihm/ {vkr c=["%i  %i  ottxc.je "+s.- "+t+"  %u://www.ucVSRECHN+"  %i %i %i i %i %i Ucrhms")>-1)pnitchn(t)3],toce.d=.urhthtyustx=t[2],to},s.Mktrcx.thKrrky=fce.ty=t[5]{toce.krrkt[4],toce.,toce.i=t[yOsllh=!0}ihnehls.lhxcje.ihm/" "+s.VSRECu://www.uc);s.dhntEkHN+" - ott},s.Uhlyghg("Ucxc.je.ihnehls&&e.k=t[0],t.d=1,toce.rrky=fpnitty=0},s.Mktyus.frhmKchn(t){toctrcx.urhthoce.b=t[1]tx=0,toce.e.i=0,tocetoce.uhcnt c=[],r=0,;t=c}toce.;r<e;r++)c.x,t[r].y)ilhesd=!0,.upeo(t[r]e=t},s.Uhle=t.lsngtot){fhr(vkro-h)*(s-k)ce.uhcnte[2*n+1];k>soce.uhcntece.uhcnte[!=l>s&&t<([2*n],l=to/(l-k)+h&&2*e+1],o=t[2*e],k=to)},s.Uhlygtyus.ilhnstprn nsw s){vkr t=toelcis();rs.Uhlyghn(tce.uhcnte.hn.urhthty=fpnitchn(yghn.urhth[0]cnetkni(t){cf(t cs.ikll(krgKrrky||(t=htyus.elcipmsnte)),tKrrky.urhtshf s.Uhcnnetknishf n=fpnitchn+){vkr h=te=fpnitchn2,e=0,n=r-vkr c=!1,rte.lsngto/1;e<r;n=e+=toce.uhcnoce.uhcnte(t,s){fhr(us.ihntkcnnehls,c)}sgrhpnd: #fihnehls.lh: #ff2424;d: #fff"];g.kuuly(ih bkiagrhpnles wcndhwff","ihlhr2424; bkiaoce.k=1,toprn c},s.U.Mktrcx=fpthtyus.ihn.Uhlyghn,snitchn(){tetrpithr=sce.b=0,tochlyghn.urh(c=!c)}rst.i=e*s-toce=toce.i,n.b=r*c+tocstprn tocee.b*c,tocee.b*s,toce.k=r*s-toce.d*c,toce=toce.tx;r,r=toce.k,oce.i,c[2]4]=toce.d,:(c[0]=toc]=toce.tx,ty,c[8]=1)e.k,c[1]=tc[7]=toce.=toce.tx,cc[5]=0,c[6=toce.i,c[ihe(t),c=M*=t,toce.titchn(t){v,s.Mktrcx.rhtkts=fpnkr s=Mkto.urhthtyus.kto.ecn(t)y*=s,toce}=s,toce.tx.y+toce.ty||nsw s.Uh=toce.i*t.e.k*t.x+tooce.tx,c.yx+toce.d*tce.b*t.y+t,c},s.Mktrcnt).x=tocrstprn(c=c){rstprn t*toce.k+toknelkts=fp.b)*r,c},shthtyus.trnitchn(t,s.Mktrcx.uroce.tx+=t,ce.tx*toce+(-toce.ty-(toce.i*tus.kuulyCn r=1/(tocetchn(t,c){.Uhcnt;vkr.k*toce.d+c=c||nsw soce.b));rsvsres=fpnicx.urhthtykuuly=fpni,c[4]=toce,s.Mktrcx.ce.ty,c[6]c[8]=1),c}urhthtyus.=0,c[7]=0,tchn(t,c){.d,c[5]=to[3]=toce.b*r*t.y+-tooce.d*r*t.toce.d)*r,r*t.y+(toci-toce.tx*c.y=toce.ke.ty*toce.ce.b*r*t.xx+-toce.i*tprn c.x=t]=toce.b,crrky=nsw sn t?(c[0]=rky(9));vkrrky;rstprtoce.k,c[1r c=toce.k[2]=0,c[3].Flhkt32Kry||(toce.k=s,toce.i*,toce},s.Mrn toce.k*htyus.eikl(t,s){rstp=t,toce.d*s=fpnitchn=t,toce.b*ktrcx.urhttoce.ty+=s=s.DceulkyBctmku=!1,rhthtyus.isCeDcrty=!kyHbjsit.uhnetrpithr1},s.DceulHbjsit,Hbjtoce._ikioe._ikiosKe*c+t.b*e,ttoce.k,c=tk*s+t.b*r,ce.i,e=toc toce.k=t.toce.b=t.ke.d;rstprnoce.i=t.i*oce.b,r=to(t){vkr s=,toce._mkesk=npll,to._iprrsntB=nsw s.Rsi,1,1),tocehpnde=nplltkngls(0,0a=npll,tocce._bhpndee.fcltsrKrtx=0,toce.s.cdsntctye.i=0,toce){rstprn tce.b=0,toc.d=1,toce.oce.k=1,toty=0,toce}=fpnitchn(x.urhthtyuhrldKluok=tthnMhds=!ce.etkgs=ndsrkbls=!1nt=npll,topll,toce.w,toce.ukrs1,toce._cn1,toce.rsnll,toce.bpcnt,toce.eyMktrcx=nsce.uhectch,s.Dceulkyitchn(){ton=nsw s.UhHbjsit=fpnikls=nsw sw s.Mktrcx,s.cdsntctoce.ty,tocce.d=t.i*ce.ty=t.tx*e.tx=t.tx*oce.tx,tocc+t.ty*e+ts+t.ty*r+te},s.Mktrc+t.d*e,tocs+t.d*r,tos=!0,toce.),toce.ucv.kluok=1,thcnt(0,0),chn=0,toceoce.vcecbltoce.rhtktoctKrsk=npht=nsw s.U.Uhcnt(1,1tyus.kuusne.d*s,tocetoce},s.Mkce.ty*c,totoce.ty*s,trcx.urhthce.ty=n*c+d=fpnitchn.tx=n*s-to.d=e*c+toc_er=0,toce!1,toce.dsm=nsw s.Mkr="uhcntsrldTrknefhrtrcx,toce.",toce.whr._ir=1,tocfkpltIprehtsrkitcvs=iosdEurctsce._ikiosKts():toce.t&&(t?toceIkiosdEurc_dsetrhyIk._gsnsrkts(),toce._ieBctmku!==tchn(t){to.dsfcnsUrhchn(t){toc.dcrty=!0)tcvs=t,toctoce.etkgs}}),Hbjsite.etkgs&&(usrty(s.Dce._cntsrki,est:fpnitosKeBctmkueulkyHbjsin(){rstprns,"ikiosKest:fpnitch toce._ikiBctmku",{g},est:fpnit.urhthtyuusrty(s.Dct:fpnitchnrstprn!0}}urhthtyus,sfcnsUrhuslkyHbjsit."mkea",{gsrty(s.Dceu(){rstprn ),Hbjsit.d}wocls(t);keese,e=0;est:fpnitcc++)fhr(vk){fhr(vkr <t.lsngto;r r=t[c].us=[],c=0;ce<r.lsngtohn(t){cf(t_fcltsre},._mkea&&(t},est:fpni1),toce._mce._mkea&&a.ceMkea=!kea=t,toce(toce._mkeoce._mkea.tchn(t){totoce._mkea)rstprn!1;t.urhthtyuoce;dh{cf(ecbls",{gs(){vkr t=t!t.vcecblst:fpnitchnt=t.ukrsnts,"whrldVceulkyHbjsiitchn(){rs}}),Hbjsits,"fcltsreusrty(s.Dct.urhthtyu",{gst:fpneulkyHbjsitprn toce..dsfcnsUrhceMkea=!0)n toce._cnUrhusrty(sgst:fpnitcjsit.urhthrkitcvs",{hn(){rstprtyus,"cntstsrkitcvs}.DceulkyHbsit.dsfcns}}),Hbjsito(r[e]);toe:s}}toce.Blhia={tkrcltsrUkees_fcltsre=tgst:toce,f.dsfcnsUrhce._fcltsr;e++)s.upepnde=fpnititchn(t){rurhthtyus.utyRsitknglkyHbjsit.gstLhiklBhls},s.Dceuchn(){rstpstprn s.SmBhpnde=fpne.rhtktchnnefhrm,o=t(toce.rhtkrknefhrm;thn%s.UC_2?tchn!==tococe.rhtktcIkios&&(tooce.whrldTt.whrldTrkHbjsit.urhk.d+k.ty),hrldKluok}Kluok=tocee.ukrsnt.w,s.Dceulky.kluok*tocthtyus.gsttoce.whrldy=n*k.b+h*r*toce.eikoce.eikls.ce.eikls.yer*toce.eioce._er*to,e=toce._ikls.x,r=-tls.y,n=tocx,c=toce._toce._ir*ttchn.x-tock.tx,o.ty=.eikls.y,nd+k.ty):(ts.x,e=toce=toce.uhec=toce.eikle.ucvht.x*n*k.b+h*k.k.k+h*k.i+toce.ucvht.x,h=toce.&(n-=toce.,(toce.ucv.ucvht.y)&ucvht.x*t+ht.x||toce.y*r,h-=touhectchn.ye.uhectchne(toce.rhtnIkios=tochn),toce._,toce._er=oce.rhtktcir=Mkto.ihMkto.ecn(tktchn)),t=e.rhtktchnce.rhtktch=r*k.b+e*k*c+toce.uc,o.i=r*k.k.k=t*k.k+c*k.b+c*k.d+e*k.i,o.d*k.i,o.b=t.d,o.tx=n*vht.y*e),oce.ucvht.xr,e,n,h,k=ku=t)}}),s=fpnitchn(jsit.urhthsTrknefhrm){vkr t,c,tyus.pudkttoce.ukrsn.DceulkyHbkiosKeBctmn*k.k+h*k.hectchn.y-.i*t,o.d=k.y*e,o.k=k.b*e,o.i=k.d*e,o.tx=.k*t,o.b=ki+k.tx,o.ttoce.ucvhtt,h=toce.uhtyus._gsnhthtyus._rs.DceulkyHe.ikll(tocurcts,t)},bjsit.urhte._ikiosdEsrktsIkiossndsrIknvk.Eurcts.urtsTsxtprs=._cntsrkitsit.urhtht.etkgs.dcrDceulkyHbjyus.gsnsrkty=!0)},s.fpnitchn(tcvs&&(tocekgs=t,tocee._ikiosdErldKluok=trsndsrWsbGluok,t.gl?rhthtyus._L.ikll(tocs.Eurcts.uurcts,t):soce.whrldKdEurcts.whceulkyHbjsmuMktrcx.t.y,n.rsndsceulkyHbjstrcx.ty=-er(toce,s.Dit._tsmuMkit._tsmuMkx=-e.x,s.DHbjsit._tstsTrknefhr.urhthtyusGlhbkl(t))pnitchn(t,s&&(t=s.th,toce.pudks){rstprn m(),toce.w.thLhikl=fulkyHbjsitrcts()},s..DceulkyHbce._gsnsrktyus.pudktitchn(){totsIkiosdEusIkios=fpnDceulkyHbjjsit.urhthtrcx),n},s,t);rstprne=toce.gstwcdto,0|e.e(),n=nsw xtprs(0|e.oscgot,r,cs.RsndsrTs s.DceulkyLhiklBhpnd,c,r){vkr fhrm.kuulyyus.thGlhbrm(),toce.n(t){rstprktsTrknefhwhrldTrknen toce.pud(t)},s.Dcekl=fpnitchsit.urhtht=fpnitchn(tBhpnde(s.us.estEtkgtrcx)},s.Dit.urhthtysRsfsrsnisceulkyHbjst){toce.etcdsntctyMkrn toce.gsitchn(t){thrm.kuulyCndsrIkiosd,s.Dceulkythtyus._rsEurcts=fpnHbjsit.urhoce._ikiosnvsres(t)}hrldTrknefhn(){rstprMktrcx,Hbjtyus,"x",{Urhusrty(sjsit.urhthgst:fpnitc.DceulkyHbn toce.uhesit.dsfcnsrcx=nsw s.|t.wcdto,0.tsxtprs.rsw s.Rsndswcdto,0|t.es{vkr c=nrTsxtprs(0oscgot);sl|t.oscgot)seczs(0|t.iosdEurctseulkyHbjsinitchn(t){e=fpnitchnyHbjsit.ursndsrIknvk(t){},s.Dchthtyus._rt._tsmuMkt},s.DceulksrWsbGL=fpktrcx.tx=-toce._fcltDceulkyHbjoce._ikiosltsre=r,s.sit._tsmuMdEurcts.fct.x,s.Dceusre=npll,t._fcltsre;(){toce._iosKeBctmkukiosdEurctulkyHbjsit._dsetrhyIs=fpnitchn.urhthtyuskiosdEurct=!0},s.Dce,toce._ikijsit._tsmu_tsmuMktrcdsr(toce,stoce._ikiosxtprs.rsn.DceulkyHbsdEurcts.tMktrcx),tox.ty=-t.y,lkyHbjsit.Trknefhrm}osdEurcts=Trknefhrm=ts(c),tocercts.whrldtoce.whrld._ikiosdEuvkr r=tocensw s.Eurc;toce._ikigot),toce.Eurcts.knikniohr.y=-x/t.wcdto)osdEurcts.(t.y/t.osc,toce._iki_fcltsre=rohr.x=-(t.ce._ikiosdkiosdEurctnitchn(){tlBhpnde();KeBctmku=!ce.gstLhikcf(toce._i1;vkr t=tos)toce._ikoce._ikiosdEurcts=fpjsit.urhthikiosdEurcs=npll)},s.dsetrhy(!kiosdEurct.DceulkyHb0),toce._ityus._rsndts.tsxtprss&&(toce._ocldKt(t,tDceulkyHbj(t){rstprnsr.urhthtyd=fpnitchn toce.kddIus.kddIocloce.iocldrsitIhntkcnot=t}}),s.ulkyHbjsitn(){rstprnhectchn.y=tchn.y},es(t){toce.ut}}),s.Dcet:fpnitchnIhntkcnsr= toce.uhecst:fpnitcheikls.y=1,ce.gstLhik/toce.eikloscgot;0!=kls.y=t/(ss.y):toce.=s?toce.eitoce._oscglBhpnde().){vkr s=to.DceulkyHbulkyHbjsitthtyus.ihn),s.Dceulktkcnsr.urhetrpithr=syHbjsitIhnjsitIhntkc.urhthtyusskts(s.DceeulkyHbjsice.eikls.x.dsfcnsUrhls.x=1,toc}}),Hbjsitusrty(s.Dce._wcdto=ttIhntkcnsr):toce.eik.x=t/(s/tohn(){rstpr.dsfcnsUrh,"wcdto",{eulkyHbjsi.urhthtyusgst:fpnitctIhntkcnsrn toce.eikusrty(s.Dcnsr,Hbjsit.urhthtyus{s.DceulkyeulkyHbjsil(toce),ton=[]},s.DctIhntkcnsrce.iocldrs=Hbjsit.irHbjsit.iklfpnitchn()dto;0!==s?gstLhiklBh.gstLhiklBto},est:fpvkr s=tocehpnde().wcnitchn(t){toce.eiklspnde().wcdls.x*toce.sit.urhthtst:fpnitchrhusrty(s.uhectchn.xit.dsfcnsUDceulkyHbj=t}}),Hbjsyus,"y",{gn(t){toce.ctchn.x},ecgot},est:,"oscgot",.gstLhiklBchn(){rstpkls.y*tocehpnde().osrn toce.eifpnitchn(t{gst:fpnit.urhthtyus,toce.iocl hpt hf bhiocldrsn.e c=toce.gsx(t);toce.ulcis(c,1)tIocldCndsdrsn.eulcipnde");vkrd cndsx ce(s,0,t),ton t.ukrsnttoce.iocld.rsmhvsIocrsnt=toce,rsn.eulcisld(t),t.ukce.etkgs&&&&t.ukrsntngto)rstprw Srrhr("Thtyus.estIiocldrsn.lfpnitchn(t||s>=toce.sngto)torh,s){cf(s<0os epuulcsocldCndsx=kcnsr.urhttchn(t,s){iocldrsn.lus.ewkuIocDceulkyHbjsr.urhthtyldrsn=fpnisitIhntkcncf(t!==s){sngto)},s.de "+toce.dsxHf(t);citIhntkcnsr s=toce.is.gstIocldtchn(t){vkocldrsn.cnCndsx=fpnif(-1===s)tr.urhthtyuceulkyHbjsuIocldrsn:.gstIocldCr<0)torhw toce.gstIo);cf(c<0||Srrhr("ewkcldCndsx(s Bhto tos ndsx(t),r=vkr c=toceulcsd ce hRsfsrsnis( Tos cndsx),t;torhw ddIocldKt: "+s+" epuSrrhr(t+"kpt hf bhpntoce.etkgst.estEtkgs.iocldrsn[ceulkyHbjse.iocldrsns k iocld lsr.");toc[c]=s,tocehf tos iklr]=t}},s.Dite mpet bepuulcsd D&s<=toce.i},s.Dceulknitchn(t,stkcnsr.urhIocldKt=fp){cf(s>=0&thtyus.kddocldrsn.lsyHbjsitIhnsn.lsngto),s.Dceulky("Tos epuus ikllsr")kyHbjsit mocld hf to;rstprn s}pet bs k iHbjsitIhntlcsd Dceulorhw SrrhrceulkyHbjsn: Rkngs Ssutkbls rkrci vklpseds tos kiings")},s.D krs hptecitIhntkcnsrrhr, npmshvsIocldrshr tos epur("gstIocl cn tos iocsd cndsx  nht sxcetcld lcet, "+t+" dhseulcsd DceudKt: Epuultorhw Srrhn[];torhw is(),k.ukrocldrsn.ls}rstprn n}0===toce.ingto)rstprcf(0===e&&Srrhr("rsmsnt=vhcd 0kgsRsfsrsnsmhvsIocldcld=fpnitc-1!==s)rsts=toce.iocxHf(t);cf(prn toce.rldrsn.cndsKt(s)},s.Dhn(t){vkr s.rsmhvsIorsn.lsngtohvsIocldrsyushf s?s:(t,s){vkr npmbsr"==ttoce.iocldc=t||0,r=",e=r-c;cf(n=fpnitchnthtyus.rsmt);rstprn itIhntkcnsr s=toce.gs.rsmhvsIotchn(t){vkstIocldKt(cldKt=fpnitoce.etkgsr.urhthtyuceulkyHbjsitIhntkcnsmpet bs k sn[t]},s.Dos ikllsr"oce.iocldrceulkyHbjs);rstprn tr.urhthtyuiocld hf tlkyHbjsit yHbjsitIhnEtkgsRsfsrcis(t,1),skrsnt=vhcdcldrsn.eul},s.Dceulk 0,toce.iotkcnsr.urhsnis(),s.u&&s.rsmhvsoce.iocldrs.DceulkyHtchn(t){cfcnsr.urhthcldKt=fpni(t<0||t>=ttyus.gstIosn.lsngto)bjsitIhntks(s,0,t)},ce.etkgs&&{fhr(vkr no;h++){vkrdrsn.eulci;h<n.lsngt k=n[h];tos(c,e),h=0k.rsmhvsEt=toce.iocle>0&&e<=r)srkitcvs&&ntkcnsr.urce.etkgs=ttEtkgsRsfstchn(t){to,toce._cntrsnis=fpni(toce.etkghthtyus.eskyHbjsitIhiocldrsn[t!toce._ikilsngto;t<c))fhr(vkr .iocldrsn.;t++)toce.t=0,c=toce].pudktsTrosKeBctmkukll(toce),knefhrm=t,cldrsn[c].;rstprn toefhrm();vkstBhpnde()ce.whrldTrr e=toce.ge},s.DceulpudktsTrkn++)toce.iorsn.lsngtositkngls;f=!1,l=0,d=,r,e=1/0,n0,k=-1/0,otoce.iocld=1/0,h=-1/;l<d;l++)thr(vkr t,cn s.SmutyRhpnde=fpniwcdto=h-e,.urhthtyus-n,i},s.DctIhntkcnsr.gstLhiklBeulkyHbjsitchn(){vkri.oscgot=ke,i.y=n,i.t.y?n:t.y,sn[l].vcecpnde()).x?,e=e<(t=ton[l].gstBhe:t.x,n=n<ce.iocldrsc=t.wcdto+bls&&(o=!0oce.iocldrocldrsn.ls,s.Dceulkytchn(){cf(kcnsr.urhthpnde=fpni0===toce.ihtyus.gstBngto)rstprHbjsitIhntknefhrm()}._bhpnde;rcgot+t.y,hRsitkngls;=k>r?k:r);rn s.Smutyvkr i=tocecf(!o)rstpstprn i.x==h>c?h:c,kt.x,r=t.osus.pudktsTs.pudktsTrceulkyHbjsnitchn(){ccbls&&(s.Dit.urhthtyf(toce.vcerknefhrm.iknefhrm=fpr.urhthtyuocldrsn.lsrldTrknefhfhr(vkr c=rldTrknefhctyMktrcx;0,r=toce.irm=s.cdsntngto;c<r;crm;toce.wh t=toce.whr.urhthtyugto;s<c;s+ceulkyHbjsldrsn[s]._L(t)}},s.DitIhntkcnsrsndsrWsbGs._rsndsrI+)toce.ioccldrsn.lsniocldrsn.lhntkcnsr.u{fhr(vkr tsmhvsEtkgsfpnitchn()=0,s=toce.Rsfsrsnis=sngto;t<s;rhthtyus.rlkyHbjsitIes fhr(s=0t),toce._frctsBktio.fcltsrMknktsr(),t.euetkrt()}slgsr.uhuFcl,c=toce.iocltsre&&t.oce._mkea,ecbls&&!(tyHbjsitIhn){vkr s,c;thtyus._rsfpnitchn(tcf(toce.vcndsrWsbGL=oce.kluok<tkcnsr.urh},s.Dceulkc=toce.iocethu(),t.msBktio.etk.upeoMkea(t),t.eurctrt()),s=0,toce.mkea,ldrsn.lsngkeaMknkgsrrctsBktio.oce._fcltsce._ikiosKprn}cf(tococe._rsndscts(t);rste._mkea||trIkiosdEurre){fhr(toeBctmku){t=0)){cf(to=!0),toce.ocldrsn[t]s&&(toce.egsRsfsrsnicntsrkitcvtkgs.dcrtys();toce._etkgs=npll.rsmhvsEtkt++)toce.i)),toce._me&&(t.eurcsr(toce._fpeo(),t.fcr.upeoFcltcltsrBlhialtsrMknkgskea&&(t.eutsBktio.flce._fcltsrRsfsrsnis();fhr(vkr iocldrsn[s.iocldrsn.;s++)toce.].estEtkgslsngto;s<ct)},s.Dceus=0,c=toces.dcrty=!0keaMknkgsr)toce.ioclhu(),toce.sndsrWsbGLtsBktio.et_mkea&&t.m(t);t.eurc.uhuMkea(tdrsn[s]._rto;s<c;s++thtyus,"ossxtprs.frkrhusrty(s.oce._wcdtoit.dsfcnsUEurcts.urh=t}}),Hbjscgot",{gstms.wcdto,tx=t/toce.tce.iocldrstprn}toce.,t);fhr(vkkeaMknkgsrtoce._mkear s=0,c=to.upeoMkea(n.lsngto;s_mkea&&t.mrcts(t);rsitchn(t){t,{gst:fpnifrkms.wcdtprn toce.ee.tsxtprs.o},est:fpnikls.x*tococe.eikls.tchn(){rstus,"wcdto"._wcdto=0,HbjsitIhnt,toce.tsxt(toce),tocsw s.Uhcntprs=t,tocee.kniohr=ntoce._oscgkcnsr.ikll{s.Dceulkyrskts(s.Dc.hnTsxtprss.urhthtyu)),toce.rs0},s.Eurcts=Hbjsit.indsrkbls=!eulkyHbjsiPudktsBcnddkts",toceesTsxtprs.tcnt=16777oce.eokdsrlsndMhds=se.NHRMKL,t=npll,t.bk.blsndMhdsokeLhkdsd?215,toce.bot=0,toce.s.Eurcts=fe.iocldrsnknkgsr.uhurIknvke(t)a&&t.mkeaMMkea(t)}},;toce._mkepnitchn(t)[s]._rsnds<c;s++)toc,toce.tsxttprsPudktsprsPudkts.nTsxtprsPuoce.hnTsxtbcnd(toce)dktsBcnd=tprs.hn("pu():(toce.htoce.hnTsxtoce._rsndtchn(t){cfoce._ikios.vcecbls&&luok){cf(tKeBctmku){0!==toce.ksrIkiosdEu(!1!==toceknvke=fpnirty(s.Eurc.urhthtyuss,Hbjsit.d.urhthtyushr=s.EurctsfcnsUrhus.ihnetrpitts.urhthty),s.EurctstIhntkcnsroscgot=w-S:w)?v:w)?mK.wcdto=T-r K=toce._prn K.x=E,E,K.y=S,K.bhpnde;rst,toce._ipr:w)?$:w;vkv>(w=x>w?x.tsxtprs=tscgot,toceprs=fpnitc}}),s.Eurcus.estTsxthn(t){tocets.urhthty,toce.ikio._oscgot=trs.frkms.o:T)?y:T,w=$<(S=m<(S=g>(T=f>T?f:S)?v:S)?my>(T=b>(T=:T)?g:T)?b:S)?$:S,T=$>(w=m>(w=v<(S=x<S?x:E)?y:E,S=s.frkms.ostprs.frkms._oscgot/tce._oscgotkls.y=toceoce.tsxtpr&&(toce.eicgot)},s.E.wcdto),too/toce.tsxp,v=i*h+l*k.k,l=k.i,i*h+l*e+u,d,p=k.tx,ue+d*h+p,x=g=o*r+d*h+=k.ty,f=o*r+u,b=o*r+d=k.b,i=k.knefhrm,o=prs.frkms.htyus.gstBms.wcdto,ctchn(t){vksxtprs.frk=toce.tsxtr s=toce.toscgot,r=shpnde=fpniurcts.urhte.eikls.x=77215},s.E(){toce._whtyus.hnTss=fpnitchncdto&&(tocxtprsPudkttoce._wcdturcts.urhtsdTcnt=167y),k=t||toniohr.x),e),h=-(c*tokniohr.x),e.kniohr.yce.kniohr.n=c*(1-tocce.whrldTr=-(s*toce.*(1-toce.keikls.y=t/){rstprn tst:fpnitchy*toce.tsx.oscgot},en(t){toce.tprs.frkmstoce.tsxtpoce.eikls.:fpnitchn(g<(E=f<E?fn+l*r+u,y=0,S=1/0;E=$=i*n+l*e+=-1/0,E=1/y<(E=b<(E=u,T=-1/0,w:E)?g:E)?bo*e+d*n+p,d*n+p,m=i*esTsxtprs.nkgsr.upeokr c=toce._mkea,t),ts.vklcd){vtsxtprs.bkoce.tsxtprrsehlptchnMkea(toce.&&t.mkeaMk.fcltsrMkntoce._fcltcltsre&&(r,c,r=t.eurhr(toce._f.flpeo(),tctsBktio;fkgsr.upeoFsre){vkr sce._mkea||sndMhds]),Mhds,t.ihnseIknvke[tlIhmuhectss.blsndMhd.iprrsntBlHusrktchn=toce._mkeatsxt.glhbktoce.blsndethu(),tocs=0,c=toce]._rsndsrWlsngto;s<ciocldrsn[ssbGL(t);r.;s++)toce.e._mkea&&t.iocldrsn.dsr(toce),oce.tsxtprus._rsndsr&0!==toce.itchn(t){ce.vcecbls&kluok&&!(tf(!1!==tocs.irhu.wcdIknvke=fpnts.urhthtyetkrt()}slsr.uhuMkeankgsr.uhuFa,t),toce.t.fcltsrMkcltsr(),r._fcltsre&&es fhr(t.e(toce._mke.mkeaMknkg,t),r.etkr._fcltsrBlr.upeoMkea._mkea&&(rmkeaMknkgs(toce.mkea.ethu(),t.t()),r.rsnhia)),tocecltsr(tocedsrWsbGL(t.rsndsr(tooce.iocldrtoce.iocld;s<c;s++)tsn[s]._rsnrsn.lsngto)}},s.Eurcce),s=0,c=urctsBktiooce.kluok<=K,K},s.Eucf(toce.vctyus._rsndnitchn(t){ecbls&&!(tsrWsbGL=fp=0)){cf(torcts.urhthrsntBhpnde(t.iprrsnttoce.tsxtpt.iprrsntBcgot<=0)){sndMhds!==lsndMhds&&cf(toce.blBlsndMhds=rs.irhu.osto<=0)&&!(ntsdTsxtprnt&&(toce.s.IknvkeTc=toce.tcntsdTsxtprs=ntsr.gstTc,toce.tcnts(toce,tocikiosdTcnt!==toce.tce.whrldTrk,toce.whrlwhrldTrkne.b,toce.whrm.i,toce.fhrm.d,tocrldTrknefhnefhrm.tx*dTrknefhrmrknefhrm.kcnt?(toce.cm.oscgot:t);1677721ohr.y*tocerkms.oscgo5!==toce.t.tsxtprs.fikiosdTcnt-(toce.knitsxtprs.trfhrm.tx*t.rknefhrm.brm.d,toce.dTrknefhrmrldTrknefhwhrldTrkne.i,toce.whrsehlptchn,toce.whrloce.whrldTtsxtprs.trCNSKR);vkr-toce.knioxtprs.trcmprs.trcm.xhr.x*toce.?toce.tsxtcm.wcdto:- r=toce.tsklsMhdse.Lrs.bkesTsxdTrknefhrmklsMhds!==lptchn),t.srty&&t.eitoce.tsxtpemhhtoUrhutprs.eikls.ty*t.rseh,toce.whrle.whrldTrkhn|0,toce.sxt.estTrkfhrm.ty*t.|0):t.ihntnefhrm(tocrsehlptchnnefhrm.k,twhrldTrknet.rsehlptc]=t.eiklsMiklsMhds=tsxt[t.emhhs.bkesTsxthds,t.ihnttoUrhusrtyprs.eiklsMhds===s.eioce.tsxtprMhds&&(t.erknefhrm(tchn;t.ihntcxsle?t.ihKluok=tocek,t.rhpndUntsxt.estT.whrldKluooce.whrldTsxt.glhbkl/t.rsehlpt-toce.kniohr.x*toce.?toce.tsxtkms.wcdto)xtprs.trcmprs.trcm.y,e=toce.tshr.y*toce.tsxtprs.fr(toce.knio.cnctWsbGLurctsBktiourctsBktio.ihnetrpitsBktio,s.E.urhthtyushr=s.Eurct=fpnitchn(.urhthtyushtyus),s.Ekgs(toce.toce.tsxtprc)):t.ihntto/c,toce.hu.oscgot/sxt.drkwCmtsxtprs.irsxtprs.bkes.irhu.wcd,r/c,e/c,tHbjsitIhntTocng=t,tosit.irskts1},s.Eurctthtyus=Hbj(s.DceulkysBktio.urhkcnsr.urhtce.rskdy=!ce.tsxtprs=toce.iocl/c,toce.tsgot/c)}fhr.wcdto/c,ts.irhu.osc(vkr n=0,hoce.tsxtprdrsn.lsngtxtprs.irhucgot,r/c,ekr e=s.Tsxos+toce);gs=fpnitch s.Eurcts(ts.frhmCmkn(t,c,r){vc)},s.Eurctprs.frhmCrstprn nswsxtprs iki}},s.Eurcttoce.iocldeaMknkgsr.ndsrIknvkemkea&&t.mkuhuMkea(t)(t);toce._s.frhmFrkmrsn[n]._rso;n<h;n++)toce.tsxtphpris,toce.tsxtprs.irhu.x,tocerhu.y,tocerhu.wcdto,.tsxtprs.irs.irhu.os.tsxtprs.isTsxtprs.ee nht sxce(t){vkr c= frkmsCd "kios[t];cfSrrhr(Tos+t+" dhs(!c)torhw t cn tos ts.TsxtprsIs=fpnitchn.tsxtprs.i.ihntsxt.dtprs.irhu.oce.tcntsd0,toce.tsxwcdto,toceTsxtprs,0,rhu.oscgotrkwCmkgs(te.tcnt)),ttkcnsr.ikl);rstprn n){s.Dceulks(e)},s.Eufpnitchn(tyHbjsitIhnrctsBktio=l(toce),tosw s.Eurctmkgs(t,c,rto,o.oscgo.i,r.d,r.tehpris,o.x!1),c.drkwesTsxtprs.,o.y,o.wcdCmkgs(k.bkt,h.kniohrx,r.ty),e=(r.k,r.b,rtsBktio.urpnitchn(){m.ikll(tocbjsit.urhttsTrknefhre)},s.Eurchtyus.pudkhthtyus._rs.DceulkyHrknefhrm=f0)e&&(c.esrkms;cf(c.tktchn%(2*k=toce.whrkluok,h.rhMkto.UC)==ldKluok*h.tTrknefhrmglhbklKluotprs,o=k.fkdsr),toce,t.eurctsBeokdsrMknk),t.eokdsrtEokdsr(t.gsr.fketEoMknkgsr.es.fketEurctktio.ethu(sbGL(t.gl)oce);fhr(vKluok=tocedktsTrknefk,s.Dceulkhthtyus.puhrm.ikll(tyHbjsit.urkr r=toce..whrldKluot;c.glhbkl.EurctsBktcn(toce,t)ctsBktio.eEurctsBktioce),t.eurtkrt())},so.rsndsr(tio.urhthty,toce.fketsBktio.bsgce.rskdy||=fpnitchn(iocldrsn.lecbls&&!(t=0)&&toce.sngto&&(tooce.kluok<toce.cnctWt){toce.vcsndsrWsbGLngto){vkr Iknvke=fpn0)&&toce.if(toce.vcece.kluok<=ocldrsn.lscbls&&!(toc=t.ihntsxitchn(t){cus._rsndsrio.urhthtyetEurctsBkskdy=!0},sWsbGLFketE(t),toce.r.EurctsBkturctsBktious.pudktsTtio=nsw s.t){toce.fkvcecbls){vfhrm,e=!0,ce.iocldrs.iocldrsn.){vkr h=ton[n];cf(h.lsngto;n++kr k=h.tsxn=0;n<tocewhrldTrkne=!1),toce.cdto",{gstktsTsxt(),){rstprn t&(toce.pudtoce.dcrtyoce.dcrty&eikls.x*to:fpnitchn(hthtyus,"wknefhrm.ik,o.oscgot*t.urhthtyu;sles{e||(eulkyHbjsis.pudktsTre=!0),s.Dcll(h);vkr h.eikls.y)*h.eikls.xnsUrhusrtyts(s.Eurctr=s.Tsxt,Hs),s.Tsxt.ihnetrpithbjsit.dsfcurhthtyus.(s.Tsxt.urs.urhthtyubjsit.irsk(h.kniohr.l.tx,l.ty)y,o.wcdto,gs(k.bkesTris,o.x,o.o.oscgot,-sxtprs.ehpx*o.wcdto),c.drkwCmkb,l.i,l.d,.rsehlptchirsktsSlsmstIhntsxt(e"),toce.ie.iknvke.g"2d"),tocehntsxt=tocn=1,s.Eurcsnt("iknvk=dhipmsnt.){toce.vcekniohr.y*ocltsrBlhia5|0,o.wcdt)}}}}},s.F=fpnitchn(o,o.oscgotcbls=!0,to.oscgot)+.+.5|0,-(h..estTrknefrknefhrm;tl.d,0|l.txle?c.estTrk,l.b,l.i,,0|l.ty):cknefhrm(l.hrm(l.k,l..rhpndUcxsl=h.whrldTchn(t,c){tbls=!0},s.srBlhia,s.a.urhthtyuthr=s.FcltTsxt=fpnits.ihnetrpioce.iknvkeFcltsrBlhice.rsndsrkctchn.y+.5to*h.eiklsgot*h.eikltchn.x+.5|.y*(-o.oscs.y)+h.uhe0,h.kniohr|0,o.wcdto.x)+h.uhec.x*(-o.wcd},s.Tsxt.uce,s.Tsxtp(t),toce.evke(toce.ice.estTsxtstEtyls(c)knvke)),torhthtyus=Hrs.frhmIknts.ikll(tohnt;vkr t,.bkesTsxtpxt.fhnt=tochn=toce.rtoce.ihntsce.etyls.fsehlptchn,s,c=toce.trs.rsehlptce.tsxtprs(toce.pudkUrhusrty(s{rstprn tohtyus,"oscfpnitchn()ce.dcrty&&got",{gst:tsTsxt(),t.Tsxt.urhtsit.dsfcnstsTsxt=fpnhn(t){toce.Tsxt.urhtEtrcng()||crty=!0},shtyus.pudk" ",toce.ditchn(){to.tsxt=t.thsxt=fpnitct=t.fhnt||,toce._oscchn(t){(t=.Tsxt.urhttyls=fpnitt||{}).fhnhtyus.estE"bhld 20utgot=t}}),skms.oscgots=t.drhuEo|!1,t.drhu,t.drhuEoks=t.drhuEo|Mkto.UC/6dhwDcetknikdhwKngls|kdhwDcetknEokdhwKnglrhuEokdhw|",t.etrhasfcll=t.fclhas=t.etrh,t.klcgn=tsft",t.etras||"blkia.klcgn||"lTociansee=l||"blkia" Krckl",t..y=t/toce.!1),toce.enitchn(t){e.tsxtprs.ot},est:fptoce.eiklsfrkms.oscgtsxtprs.frikls.y*tococe.dcrty=100,t.drhuciansee||0to=t.whrdWu=t.whrdWrhrdWrkuWcdrkuWcdto||ku||!1,t.wEokdhw=t.d,t.whrdWrkt.etrhasTotoce._wcdt.frkms.wcdtsxtprs.frnitchn(t){.x=t/toce.kms.wcdto,toce.eiklso=t}}),Hbjto},est:fpce.tsxtprs.Tsxt.urhthuEokdhwIhs=t,toce.dEokdhwIhlh,toce.etylcrty=!0},sr||"blkia"htyus.estTlhr=t.drhuis||4,t.drEokdhwKnglxt.fcllEty.ecn(toce.yls.drhuEovkr p=Mktoetyls.drhukdhwIhlhr;s)*toce.etls=toce.ettoce.ihntsntsxt.mskermcnsFhntUo;k++){vkrtoce.etyls;k<r.lsngt o=toce.ih.fhnt),k=0prsTsxt(r[rhusrtcse(=toce.dstse.etyls.drce.ihntsxtlcnsJhcn="cns="kluoke.ihntsxt.rhpnd",tocbstci",tochuEokdhw){.tsxtBkeslciansee,tolptchn;vkrEokdhwDcetlcnsWcdto).iknvke.wce.ihntsxt.*toce.rsehdto=(l+toc d=h.fhntEknis),toceetyls.drhu,toce.ihnthnJE&&toce,toce.iknvlskrRsit(0nvke.wcdtoke.oscgot),0,toce.iksxt.fhnt=t.ihntsxt.ithr.ceIhihtyls.drhuEtyls.etrhahuEokdhw&&,i=d*r.lsne.etyls.dr(i+=toce.egto;cf(tocokdhwDcetksTocianseeczs+toce.erhuEokdhw&e[k]=o,n=Mciansee;too)}vkr l=ns.etrhasToce.etyls.d+toce.etyl&(l+=toce.kto.mkx(n,k]).wcdto;e.rsehlptciknvke.osc(toce.rseh.rsehlptchtsxt.eiklslptchn,tocn,toce.ihnhn),nkvcgkgot=i*tocenis),toce.|r|n)/),tyls.whrdWr r=c.eulcce.whrdWrkt));fhr(vkt(/(?:rnu(toce.tsxe=[],n=0,hrku&&(c=tosxt;toce.e=toce.etylfhnt,toce.ce.ihntsxtrhasEtyls=.etrhas,to.lcnsWcdtotoce.etylss.etrhasToihntsxt.etoce.etyls._wcdto=toctsxtprs.ir.iknvke.ostoce.tsxtpscgot=tocecgot,toce.rs.frkms.oe.iknvke.whu.oscgot=cdto,toce.+h.keisnt,;k++)t=toctrhasTociarhasTociance.etyls.ensee/2+k*dsee/2,s=to"rcgot"===e.etyls.etk<r.lsngto.wcdto=tocs.oscgot=to=toce.tsx.oscgot,to.irhu.wcdttprs.frkmsce.tsxtprse.iknvke.woce.iknvkebkesTsxtprto;k++)t=t(r[k],t+p,.etyls.fcl=0,toce.ihEtyls=tocel;k<r.lsngntsxt.fclloce.etyls.s+u)}fhr(kt.fcllTsxtudktsTsxtpTsxt(r[k],sxt(r[k],tetyls.fclltsxt.fcllT,s);toce.p&&toce.ihnrs()},s.Tst,s),toce.sxt.etrhasls.klcgn?tansee/2,s=t,"rcgot"=.etrhasToc*d+h.keisn==toce.etyiansee/2+k+=n-e[k]:"toce.etylsetrhasTocils.fcll&&t.klcgn?t+=(n-e[k])/2ntsr"===tolcgn&&(t+=),toce.etyce.etyls.koce.ihntsxn-e[k]:"istoce.etylsTociansee&toce.etylss&&toce.et+=(n-e[k])tyls.etrhayls.etrhas/2),toce.e&toce.ihnt.klcgn&&(tisntsr"===dhwDcetknikdhwDcetkn)*toce.etyihe(toce.eokdhwKnglsls.drhuEoktyls.drhuEs;fhr(k=0;is,u=Mkto.yls.drhuEo.wcdto,tocus.pudktsTrs.wcdto=titchn(){to.bkesTsxtpoce.iknvkece.tsxtprse.tsxtprs.sxtprs=fpnxt.urhthty,r=l;r>o;rf(255!==d[eisnt=o-r,;brska}cf(=p}fhr(c.ku=i-p,f=!1f)brska;u+--){fhr(e=u+e]){f=!0e<p;e+=4)crty=!1),s.t){toce.dcpudktsTsxt.rsehlptchtchn,toce.(),toce.dcn=t.rsehlpEurcts.urhrty&&(toce=fpnitchn(=0;r<o;r++,o);vkr d=p=4*k,u=0,Dktk(0,0,k=d.lsngto,f=!1;fhr(r,l).dktk,i){fhr(e=0;h.gstCmkgsxt("|Mq",0nvke.ikll(ehlptchn,t.urhthtyusTsxt(),toc),s.Eurcts._rsndsrIke.dcrty=!1toce,t)},soce.pudktsptchn=t.rsdto=k,n.osMq").wcdtol=2*o;o=1.scl(h.mske").wcdto),4*o|0,n.wcprsTsxt("Mcgot=l,h.f),o=Mkto.iprsTsxt("|kios[t];cfhtyus.dstsTsxt.fhntUrhusrtcse=){vkr c=s.rhusrtcseIfpnitchn(t(!c){c={};rmcnsFhntU.Tsxt.urhte.dcrty&&(ndsrWsbGL.nvke=fpnitt)},s.Tsxt._rsndsrIkchn(t){toc.urhthtyustoce.rsehlikll(toce,thtyus._rsr k=Mkto.is.Tsxt.fhneIhntsxt;heIknvke,h=tUrhusrtcs.fhnt=t;vks.Tsxt.fhnscl(h.msketUrhusrtcsvkr r,e,n=hthtyus._r_oscgot=tos.dcrty()}oscgot,tocbkesTsxtpr,s.Tsxt.ure.tsxtprs.sndsrWsbGLce.iknvke.cdto,toce.tyls="#000#f00",h.fc"kluokbstc,k,l),h.fhtBkeslcns=i",h.fcllEnt=t,h.tsx",h.fcllTsllRsit(0,0cllEtyls="sit.irsktsstEtyls(c)kuTsxt.urhtsTsxt(),t!1},s.Bctmthtyus=Hbjoce.dcrty=(s.Dceulky,toce.pudk(t),toce.ehr(vkr s="UrhusrtcserdWrku=fpn}rstprn c}hthtyus.whitchn(t){f,s.Tsxt.ur",c=t.eulcIkios[t]=c.Tsxt.fhntuhhl=[],tokyHbjsitIh.tsxtOscgoll(toce),tdto=0,tocet=0,toce._oce.tsxtWcce.estTsxtntkcnsr.ikc){s.Dceuldto;0===h|e.ihntsxt..mskeprsTst(n[h]).wcce.ihntsxtxt(" ").wcdto,o=k+to|o>e?(h>0&mskeprsTsx{vkr k=tocsktsSlsmsn,s.Tsxt.fhseIknvke=dseIkios={}ntUrhusrtchipmsnt.ir,s.Tsxt.fht("iknvke"ntUrhusrtc0===t||t)}&&(s+="n",s+=n[h],e"+n[h])}r<s.whrdWrkue-=o,s+=" c.lsngto-1Wcdto-k):()}rstprn s=toce.etyl&(s+="n"),h=0;h<n.l0;r<c.lsngto,n=c[r].r(vkr e=tohrdWrkuWcdeulct(" ")ce.etyls.wsngto;h++)to;r++){fht("n"),r=sxtprs.dserhthtyus.de.iknvke=nitchn(t){tt=npll,tocpll,toce.toce.ihntsxtrhy(vhcd setrhy=fpn},s.Tsxt.uc.keisnt+c)cf(255!==isnt=r-o,c!0;brska}cu-=p}c.dse.fhntEczs=f(f)brska;.dseisnt,sd[u+e]){f=0;e<p;e+=4tmkuTsxt=fhntUrhusrtstIhntsxt(=s.Tsxt.fhseIknvke.g"2d"),s.BcntUrhusrtcpnitchn(t,cseIhntsxt),s.Tsxt.f u=0;"rcgoknis,r=d)}hr(l=0;l<=),n=Mkto.mvkr p=[];fk;l++){vkrkx(n,c.x);t"===toce.h.upeo(c.x.x+=i.xKdvs=fpnitchntchn(t){toxt.urhthty|" ",toce.s.BctmkuTsus.estEtyldcrty=!0},(t){(t=t||ce.tsxt=t|tTsxt=fpnit,c.y+i.yH{tsxtprs:is.Uhcnt(c.cns:k,iokrctchn:nsw x+i.xHffesIhds:d,uheffest)}),c.tsxtprs,l]),e.upeo(zs,toce.dcgto>=2?ukrte[toce.fhlsngto-2],kuTsxt.fhnntNkms].ec10):s.Bctmrty=!0,tocesCnt(c[c.Eczs=c.lsnx),n=Mkto.iokrIhdsKtokrKt(l))):rn|r|oce.tsxt.i{h.upeo(c.n)/.tset(tmkx(n,c.x)(l);cf(/(?toce.tsxt.xt.fhnte[tcnt},s.Bctfhr(vkr t=hthtyus.pupnitchn(){s.BctmkuTsdktsTsxt=foce.fhntNkmkuTsxt.ure.tcnt=t.t.lsngto-1]t.klcgn||"");toce.fh.etyls=t;vt.eulct(" ntNkms=c[ckr c=t.fhn,toce.fhntlsft",toce{}).klcgn=t.lsngto;ls.Uhcnt,r=.eczs,l=0;n=0,h=[],kfhntEczs/tl<toce.tsx=0,o=toce.++){vkr d=npll,e=[],ms],c=nsw mkuTsxt.urkcnsr.urhtr=s.BctmkuctmkuTsxt.ihnetrpithTsxt,s.Bcturhthtyus.hthtyus.eshtyus),s.BHbjsitIhnt]&&(c.x+=i,c.y+=t.lc];i&&(r&&i=npll;ihnt=t.iokre[d.asrncng[rcnps}vkr i.asrncng[rnsOscgot,r,k++,c.x=0s5),toce.e.dcrty=!0,.Rsitkngls=toce,toceKrsk=nsw s(0,0,1s5,1.etkgs.octstBkiagrhptoce.etkgstoce),toceoce._uhhl.to,g=toce.f?toce.ioc7215;fhr(l){vkr v=l<ldrsn[l]:t=0;l<x;l++uhu();v?v.tcnt||1677o,x=e.lsng.Cntsrkitcknefhrm=nsrkitchnMkn,toce.cnts,toce.cntskgsr=nsw srkitcvs=!0hnMknkgsr(w s.Mktrcxce.whrldTrIocld(v)}f.y=e[l].uhg,v.ukrsnt,v.eikls.x=o,v.tcnt=||toce.kdd=v.eikls.yhr(;toce.iectchn.y*ov.uhectchnr.urhthtyu{toce.dcrtceulkyHbjsudktsTsxt(ty=!1),s.DitIhntkcns),toce.dcrs.pudktsTry&&(toce.pfpnitchn()(b),toce.rngto>x;){vo-1);toce.gstIocldKtdrsn.lsngt_uhhl.upeo(toce.ioclsmhvsIocldkr b=toce.ocldrsn.lsn.x+p[e[l](e[l].tsxttchn.x=(e[ s.Eurcts(rs),v.uhecl].uhectche[l].tsxtp.lcns])*o,prs):v=nswestTsxtprsyus.pudktssxtWcdto=n,s.BctmkuTxtOscgot=(Oscgot)*o}sxt.urhthtc.y+t.lcnsTrknefhrm=*o,toce.ts(b)}toce.t=toce.iocln?u=n-h[l])/2),p.upe==toce.ety(u=(n-h[l]o(u)}vkr fls.klcgn&&drsn.lsngt:"isntsr"=etyls.klcgtkcnsr.iklll(toce)},){s.Dceulkxt.fhnte={fpnitchn(tyHbjsitIhn},s.Etkgs=l(toce),tos.BctmkuTsknefhrm.ik=t[c[r]+"ItKncmktchniknislKncmr]+"RsqpseFrkms"],t.ktchnFrkmstKncmktchnknislKncmkFrkms=t[c[r)t.rsqpserkitchnMkns.Etkgs,s.pnitchn(t)htyus.estCDslsgkts=f{toce.cntsntsrkitchnkgsr.estTkEtkgs.urhtnetrpithr=setKncmktcchn(t){fhr;r<c.lsngt=["me","mh","h"],r=0o&&!t.rsqpz","wsbacthnFrkms;++(vkr s=0,cbkl},fpnitrty=!1,toclsngto;t<stoce.dcrtyiocldrsn[tknefhrm();&&(toce.dc].pudktsTre.cntsrkit;t++)toce..iocldrsn.toce.bkiagc=toce.bkietr(0,6-c.hr.thEtrcn00000".epblsngto)+c,g(16);c="0rhpndIhlhragrhpndIhlhlhr);vkr .urhthtyus.dcrty=!0)sr.pudkts(rkitcvs&&titchnMknkg)},s.Etkgsoce.cntsrk.estBkiagr,toce.cntschnMknkgsr1;fhr(vkr msnt(t)},sn(){toce.wthtyus.pudrm=fpnitchhrldKluok=ktsTrknefht=0,s=toce.Etkgs.urhrgstDhmSlsrgb(toce.bfpnitchn(tpndIhlhrEuagrhpndIhlce.bkiagrhlct=s.osx2hr=t||0,tokiagrhpndI){toce.bkihpndIhlhr=s.Etkgs.ur},s.Etkgs.hntkcnsr.uHbjsit.irslkyHbjsitIrhthtyus),kts(s.Dceuhthtyus.ihurhthtyus=ndIhlhr(t)chnMknkgsr+c},s.Etkgrstprn tocs.gstMhpespnitchn(){e.cntsrkitUhectchn=f.mhpes.glhs.urhthtyuEtrcng="#".0","Mexml t}(s.urhtt=["Mexml2,s.KjkxRsqchn(){vkr .XMLOTTU.6pset=fpnit2.XMLOTTU.htyus),e})rstprn nswnitchn(){cc){vkr r=()),n=t.estgstTcms(),(0,16-(r-sTcmshpt(fpe=Mkto.mkx(r+e)},e);nsw Dkts).=fpnitchn((toce cnetf e?toce:ts&&(t.urht e.urhthtyn t(s){cf(htyus=s),!us=fpnitchknishf t)),n)}rstprn cnetknish&255)/255,kms=t.rsqpchn(t){rsthnFrkms}(t2rgb=fpnitprn[(t>>16oce),s.osx(t>>8&255)setKncmktcpsetKncmFr TyusSrrhr)fhr(r.lsnchn"!=tyus)r[c]=krgp;cf("fpnithf s)torhwmsnte[c+1]();fpnitchgto=c;c--;=[];cf(c>0t[2]},"fpnt)/255]},s)+(255*t[1pnitchn(t)5*t[0]<<16]<<8)+255*{rstprn(25itchn"!=ty.rgb2osx=f/255,(255&krTcmshpt(+e,n}),t.irkms=fpnittchnFrkms|KncmktchnFchn(t){ils|(t.iknislt)}),t.rsqknislKncmkrstprn s=rkrgpmsnte.chn.urhthtchn(t){vkr(Fpnitchn.bcnd=fpnit s=toce,c=urhthtyus.lsngto-1,ryus.bcnd&&ushf FpnitsqpsetKncm]||t[c[r]+KncmktchnFpsetKncmkt;t.rsqpsetrkms||(t.rchnFrkms"]ktchnFrkms"IknislRsqtchnFrkms"nikt(n),s.vkr c=krgpnte[c];rstto,n=Krrky[c]=krgpmsprn n=r.ih(c);c--;)nkuuly(tocemsnte.lsngn e(){fhr(it||(r=nswetsnsre||{!0===r.__c==tyushf c.tyus),r&&eSvsntHbjs&&(r=c,c=c s.Svsnt(t},"hbjsit"e=toce._lcOttuRsqpseit(t[s])}istprn nsw les cf(wcnuRsqpset)rwcndhw.XMLdhw.XMLOttt;sles rstktio(c){}sitcvsXHbjsr){cf(toces]?toce._loSvsnt=fpn].elcis():=c.dceuktiitchn t(c,[]},c.smct._lcetsnsrcetsnsre[slcetsnsre[.fcllEtylssmsnt("iknntsxt("2d"dto=1,t.os s=t.gstIh);rstprn scgot=1;vkr="#000",s.vke");t.wct.irsktsSls.SvsntTkr<<=1;rstpr&&(c=c.urhntTkrgst={chn t(c){cthtyus||c,ikll:fpnitgst.mcxcn(n s},s.Svss=1;s<t;)slRsit(0,0,,0,1,1),s.llEtyls="#hectsHusrkculy",s.fcfff",s.fcltchn="mplt1,1),0===sglhbklIhmufcllRsit(0tprn!1;vkrknPesNswIk==tyushf dhdse=fpnitpndsfcnsd"hipmsnt)rschn(){cf(" t=dhipmsnnvkeBlsndMprn!1},s.i=0)rstprn ktk(0,0,1,(t){cf(t>0},s.gstNsxh=fpnitchn&&(t&t-1)=tUhwsrHfTwt;fhr(vkr 1).dktk[0].gstCmkgsD{rstprn nshehft.XMLO0;s<t.lsngcndhw.Kitcfhr(vkr s=to;s++)tryvsXHbjsit)w wcndhw.KTTU"];cf(w3.0","Mcirlcetsnsre|:fpnitchn ce._lcetsntsnsre=fpn{rstprn tosre=toce._itchn t(s)|{},toce._t(c){c.lcec))},mcxcnpnitchn(t,re||{},tocs],toce}}}re[s]&&dsllcetsnsre[,s.Svsnt=fsts toce._s,c){toce.e._lcetsnse._lcetsnsn toce}rste])cf(k.ike;cf(r.eth,r.ethuusdrstprn tocuusd)rstprCmmsdckts)prn toce.ull(toce,r)e<h;k=n[++ toce._lcests toce._fpnitchn ts],toce},cLcetsnsre=(s){rstprn.rsmhvsKlltsnsre=toclcetsnsre[sngto&&dslcetsnsre[srstprn toclcetsnsre[re=toce._l{},(toce._s]=toce._lcetsnsre||]||[]).upee._lcetsnshn t(s,c){;fhr(vkr rcf(toce._lsnsre[s])roce._lcetstoce._lcetstprn tocensre||{},!=toce._lcecetsnsre=thn t(s,c){;fpnitchn ,c.hnis=fpsnsre||{};,c){toce._toce._lcetvkr r=tocelcetsnsre=e(){c.kuulnitchn t(so(c),toce}SvsntLcetse.ukrsnt.s,r),toce},ukrsnt.smce.ukrsnt,cc.hn=c.kddt.ikll(tocnsr=fpnitcmct&&toce.krsnt&&tocSvsntLcetse),krgpmsns,e)},c.hf e._hrcgcnc,toce.hn(f=c.rsmhvsklOkndlsr=nsr=fpnitcte)}rstprny(r.hff(s,ngto,k=n[0toce._lcet_lcetsnsree._lcetsns e,n=toce.[c],h=n.lsre[c]){vkr];fhr(e=0;snsre&&tococe,c,r)),(e,1);rstpe=c?r.lsngndlsr===c)0;)(r[e]==hrcgcnklOk&&r.eulcis=c||r[e]._rn 0===r.lto:0;e-- >tsnsre[s],r o=h-c,l=0],n[1],n[(t,s,c,r,ehlyA._Uhcns=fpnitchn,n,h,k){vktCnTrcknglk-r,d=e-c,2]),e},s.U e.upeo(n[hn t(){toc=c,toce.tchuUrhukgktts.nhw()},hthtyus.etchn=fpnitcs.Svsnt.ure.ethuusd=msEtkmu=Dkce.ihntsnth=0,k=r,c=g: eokus t];h<r;h++) th fcll")0,e=[],n=[n.upeo(h);,[];fhr(h=!1}}rstprnhh ihmulsxCXC Wkrncn,n=[],h=0;gplkts=fpnstprn[];fhkr c=!0,r=1;cf(r<3)rr(vkr e=[]t.lsngto>>h<r;h++)n.itchn(t){vhlyA.Trckn,f,x,g)){vcf(m!==o&&[2*m],t[2*=d&&s.UhlyTrckngls(tm+1],i,p,uA._UhcntCn=!1;brska}m!==l&&m!=kr m=n[b];],p=t[2*o+0;fhr(vkr d=n[(h+2)%vkr o=n[(h[(h+1)%k],k],i=t[2*o+0)%k],l=n1],u=t[2*lk=r;k>3;){upeo(h);h=s=!0},s.Uht.urhthtyutoce.ethuudcktsUrhukitchn t(){sdCmmsdcktgktchn=fpnlyA={},s.Us.ethuCmms!0},s.Svsnr(vkr b=0;1],x=t[2*d,u,f,x,g,c1],v=!1;cfihnvsx(i,p)){v=!0;fh(s.UhlyA._b<k;b++){v],g=t[2*d+],f=t[2*l+yus=s,tocebjsit=!0,ttoce.tkrgsd=!1,toce.sdckts=!1,t=t,toce.tethuusdCmm.dktk=c,tooce.ethuus__ceSvsntHcndhw.ihnepeo(o,l,d)>3*k){cf(!(h+1)%k,1)les cf(h++c)rstprn w,k--,h=0;shls.lhg("U,n.eulcis(}}cf(v)e.ufrkgmsntErokdsr=fpnie.urhgrkm=ce._PCD=s.e.gl=t,tocnpll,toce._PCD++,toci=["ursicetchn(t){toh},s.UcxcErn(s-r)*(erstprn y>=(t,s,c,r,e+$<1},s.Uhx=fpnitchn,n,h){rstplyA._ihnvs-c)+(c-t)*0&&$>=0&&y*b-x*g)*m;nctcklces .gstUrhgrkhls.lhg("I(h,t.LCNA_cndhw.ihnehpld nht cETKTPE)||weokdsre"),mUkrkmstsrhgrkm(h),tmuclsEokdsc,t.VSRTSXhn(t,c){rss.IhmuclsFdsr=fpnitctprn s._IhrkgmsntEokr(t,c,t.FR_EOKDSR)},sEokdsr(t,msntEokdsrnfhLhg(e)){vkr e=s.IihmuclsUrhchn(t,c,r)hmuclsFrkggrkm=fpnit(t,r),n=s.,npll)},s.gstEokdsrCkdsr(c);rsDSR)},s._In("n"),e=sr=fpnitchkr r=s.jhct.irsktsEon(t,s,c){vtprn(t.eokhmuclsEokdKGMSNT_EOK,c){rstprn=h},s.cncttsxEokdsr=dsre=fpnitIhmuclsVsrfpnitchn(tchn(){},s. s._IhmuclDsfkpltEok(n-r)>=0==cndhw.ihnee,r),t.ihmHMUCLS_ETK(e),t.gstEstsr(e,t.ITPE))?e:(wokdsrUkrkmhls.lhg(t.uclsEokdsrdsrEhpris(),y=(v*g-xc,u=s-r,f=d*p+i*u,m=o*d+l*i,g=d*d+i*i,b=1/(f*v-x*xo*p+l*u,v=*b)*m,$=(fo*o+l*l,x=i=n-r,p=t-Eokdsr(h,etsxEokdsr(Eokdsr(h,nrsktsUrhgrn t.kttkio),t.kttkiokm();rstpr),t.lcnaUrt,c),h=t.iIhmuclsVsrsxtprsIhhr&(toce.ihlrtsxUhectcs=2),toce.=[toce.kVshn,toce.kTkttrcbptsed,toce.ihlhrKttrcbptKttrcbpts&hr ;","}"](vhcd) {",TsxtprsIhhgIhlhr = tEkmulsr, vrd) * vIhlsxtprs2D(p,toce.tsxt"   gl_Frk"vhcd mkcnhr"),-1===chn(c,"kTstrcbLhiktc"),toce.ihts=t.gstKthn(c,"kIhllhrKttrcbptoce.ihlhrxtprsIhhrdttrcbLhikthmuclsUrhg.UcxcEokds{vkr t=tockdsr.urhthfpnitchn()e.gl,c=s.ityus.cnct=rkm(t,tocer,s.UcxcEoetrpithr=stPncfhrmLhfestVsithrtoce.dcmsnhrmLhiktchtVsithr"),echne=t.gsn(c,"hffesiktchn(c,"=t.gstPncf"),toce.hfhgrkm(c),t||s.UcxcEofhr(vkr r ltVsrtsxErgmsntEri);cn t.pesUri,toce.frkoce.pEkmulkdsr.dsfkp.vsrtsxEriEokdsr.urh,toce.fcre,toce.cnctce.dcrty=!rcbptse=[]()},s.Ucxc0,toce.kttthtyus.ihntRpn=!0,toprsIhpnt=0(c,"urhjsicfhrmLhiktt.gstPncfhmulsr"),tochnVsithr=rmLhiktchnce.urhjsittchnVsithrchn(c,"pEksr=t.gstPnkmulsr2D plhkt;","vk vIhlhr;", vTsxtprsIrycng vsi4"pncfhrm ehhrd;","vkEkmulsr;",rycng vsi2chn lhwu fkTsxtprsIh"),toce.kVrtsxUhectcchn=t.gstKchn(c,"kVshn"),toce.ttrcbLhikthrd=t.gstKsrtsxUhectdcmsnechnesr:s.LCNSKprse[s.cd].mkgFcltsrsDktk){vkrrsDktk,r=c?c.mkgFclt c=t.tsxtpR,e=c.mcnF),t.tsxtprrs._glTsxtsIhpnt=1;v.urhgrkm=cnitchn(){tkdsr.urhthncfhrme=fpoce.tsxtprtyus.cnctPkr t,s=toc},s.UcxcEorme(),toce2D,t.vklpskitcvsTsxtndTsxtprs(TPRS"+tocepnt]),s.bcs.TSXTPRS_.tsxtprsIh.bkesTsxtpprs(s["TSXe.gl;cf(s.0,t.glVklpoce.cnctEk4"===r?(t.):"mkt2"=====r||"mktglMktrcx=!=r||"mkt3"sLsngto=1,mulsr2D(t)t.vklps&&tUcxcEokdsrsLsngto=3:lVklpsLsng"4c"===r?tngto=4:t.gto=1)}},s..glVklpsLs.urhthtyus"4f"===r||r?t.glVklpkt4"===r&&?t.glFpni=.pncfhrmMkktrcx2fv:"t.glFpni=strcx3fv:"mmkt3"===r?(t.glFpni=s.pncfhrmM"mkt2"===r?(t._cnct=kr c cn totyus;"ekmue){vkr r=(fhrme[c]).lsr2D"===rt=toce.pnc!1,npll!==ce.pncfhrme.gl;fhr(v=2:"3f"===ktrcx4fv))===r?t.glV=s["pncfhr===r||"2c"klpsLsngtom"+r],"2f"r||"3c"===:(t.glFpnis.pncfhrmM(c,r);toces],toce.pnt.gstPncfhe.pncfhrmemLhiktchn=rmLhiktchn[r].pncfhr.cnctPncfhcfhrme)tochrKttrcbptokeLhkdsd)sr2D=fpnitt.vklps.bkt.vklps&&tsTsxtprs&&esTsxtprs..vklps.bke{vkr s=tocchn(t){cf(.cnctEkmulklps):2===hrmLhiktch.pncfhrmLhhes,t.vklpi.ikll(c,tiktchn,t.vs):t.glFpnt.glVklpsLn,t.trkneul(c,t.pncf.PNUKIA_FL.LPMCNKNISSKT),s.ucx(c.rsuskt&KT,h=s.RSUslEthrsc(s&(n=s.RSUSCU_Y_WSBGL:s.RGBK;cfpmcnknis?slMktrcx?t.vkr r cn tVklpsLsngtme)1===(t=rme[r]).glo?!0===t.gtoce.pncfhglFpni.ikloce.pncfhrce.gl;fhr(D,0,k,s.RGPRS_2D,0,kxCmkgs2D(s.PNECGNSD_}sles s.ts.TSXTPRS_2BYTS,npll)BK,s.PNECG,o,l,d,k,ss2D(s.TSXTprsIhpnt),TSXTPRS_2DrmLhiktchn_WRKU_T,h)1c(t.pncfh,toce.tsxt}s.pncfhrmt._cnct=!0,s.TSXTPRSkmstsrc(s.FCLTSR,r),.vklps.bkeRS_2D,s.TShpris);s.trc(s.TSXTPXTPRS_MKG_sxUkrkmstss.tsxUkrkmsTsxtprs.eNSD_BYTS,tc.bhrdsr:0),c.wcdto)oscgot:2,dcdto?c.wcd.oscgot?c.=c.bhrdsr?to:512,l=c;s.tsxCmkg{vkr o=c.w,!!c.flcuYS_WRKU_E,nXTPRS_2D,s.TSXTPRS_2CN_FCLTSR,rkmstsrc(sD,s.TSXTPRe),s.tsxUk),s.tsxUkr.TSXTPRS_Mstsrc(s.TS.ILKMU_TH_nFcltsr:s.,h=c.wrkuT.wrkuE?c.wMU_TH_SDGS?c.wrkuT:srkuE:s.ILKSDGS,k=c.lLCNSKR,n=ccltsr?c.mcrsIhpnt=1;prsIhpnt++pnitchn(){okdsr.urhtPncfhrme=ftoce.tsxtphtyus.eynivkr t,c=to}},s.UcxcE,toce.tsxt mkcn(vhcd;","vkrycn2(-1.0, 1.lhr;","ihnntsr = vsi0);","vhcdet vsi2 is) {","   gg vsi4 vIhxtprsIhhrdc,t.pncfhrtchn,t.vklsngto?t.glps.y,t.vklt.glVklpsLFpni.ikll(ps.z):4===mLhiktchn,ps.x,t.vklncfhrmLhik;","vkrycn4 kIhlhr;"rm vsi2 hfvsi2 urhjsr;","pncfhfestVsithritchnVsithg vsi2 vTs,"pncfhrm rcbpts vsixtprs(t.vkprsIhpnt])pltRsndsrskesTsxtprscd]?s.dsfkr.pudktsTs._dcrty[c.lps.bkesTs,t.vklps.b+toce.tsxte.kttrcbptoce.gl.dslpll,toce.g(toce.urhgpncfhrme=nl=npll,tocrkm),toce.se=npll},sstsUrhgrkmnitchn(){trm1c(t.pnccndTsxtprstprse[c.cd_2D,t.vklpprs._glTsx]),c.pncfhs.bkesTsxtfhrmLhiktc(c.TSXTPRSxtprs):c.bsTsxtprs(ct.vklps.y,s&&(t._cnct.vklps.w)D"===t.tyut?(c.kitcv:"ekmulsr2["TSXTPRS"t.vklps.z,t.vklps.x,urhthtyus.xtprsIhpntD(t))},s.UtprsIhpnt+ctEkmulsr2cxcEokdsr.+):toce.cndsetrhy=fp),toce.tsxhn,toce.ts?t.glFpni.Fpni.ikll(:3===t.glVmLhiktchn,t.vklps.y)klpsLsngtot.vklps.x,ikll(c,t.pc,t.pncfhrsngto?t.glkTsxtprsIhr.dsfkpltVn;","kttrc"kttrcbptstsxUhectchbpts vsi2  vsi2 kVsrhrd;","kttsrtsxEri=[.UcxcEokds2 ev = kVsi2 isntsr "   vsi2 v0, 1.0);",(vhcd) {",;","   vsi"vhcd mkcnrtsxUhectc= vsi2(-1.,"ihnet vshr.y/256.0hrd = kTsxhlhr.y/655","   vsi3hd(vsi3(kI36.0, kIhl ihlhr = m, kIhlhr.ytprsIhhrd;vTsxtprsIhrycng flhkfestVsithr vTsxtprsIm mkt3 pMkrycng vsi2hhrd;","vktrcx;","vkt vIhlhr;";","pncfhrrm vsi2 hfwu flhkt;"D=s._PCD++ntEri=["ur,toce.urhgoce.frkgmssicechn lhrkm=npll,t,"vkrycng ,toce.gl=t){toce._PCbpts flhktchn;","kttvsi2 kEikl2 kUhectchkttrcbpts s;","kttrcnIhhrd;"," kRhtktchnrcbpts vsisrtsxUhect mkcn(vhcdprsIhhrd;"r2D pEkmulflhkt vIhlhrm ekmulssr;","vhcdhr;","pncf) {","   g,"vkrycng vsi2 vTsxtketEokdsr=/ 256.0;",hr.x);","} = vsi4(ihhr.x, kIhl"],s.UcxcFlhr * kIhlfpnitchn(t"   vIhlhr), 256.0) =["kttrcbpr = tsxtpr,"}"],tocesr, vTsxtp vIhlhr ;".vsrtsxErirsIhhrd) *ts vsi2 kVs2D(pEkmull_FrkgIhlhr , 0.0, 1 = vsi4( (itchnVsithectchn + hr) / urhjsr) + isntsffestVsith.0);","   (kVsrtsxUhl_UhectchnitchnVsithpts vsi2 k,"pncfhrm rd;","kttrt kIhlhr;"vsi2 urhjscbpts flhkr;","pncfhTsxtprsIhh;","kttrcbs"),toce.kbLhiktchn(rcbLhiktchhnIhhrd"),s=t.gstKttn(c,"kEikltoce.kEiklRhtktchn=tc,"kUhectct.gstKttrcd , 1.0) )+ (ev.y) *i3(v + kUhtchn);"," ktrcx * vsectchnIhhr  v = ( pM.xy ;","   ihe(kRhtkRhtktchn) toce.kUhecktrcx"),to,"kVsrtsxUUhectchn=tLhiktchn(chectchn"),.gstKttrcbtchnIhhrd=ce.kVsrtsxtchn(c,"pM.urhthtyushlhr = kIh()},s.Ucxc,toce.tsxt,toce.cnctFketEokdsrprsIhpnt=0.ihnetrpitlhr;","}"]d;","   vI.gstPncfhrnVsithr=t.,toce.hffeLhiktchn(chnVsithr")stVsithr=t,"urhjsitcmLhiktchn(gstPncfhrm.urhjsitch.ihmuclsUrketEokdsr,(){vkr t=tEokdsr.urht=fpnitchnoce.gl,c=sthtyus.cnchgrkm(t,tos.UcxcFkethr=s.UcxcFIhhrd = kThn = vsi4( 1.0);"," jsitchnVsitsr , 0.0,  vTsxtprsthr) + isnsxtprsIhhr ( v / urh gl_Uhectcn(c,"pEkmuri,toce.fr=t.gstPncf;t.pesUrhge.pEkmulsrhrmLhiktchrkm(c),toclsr"),tocekgmsntEri)ce.vsrtsxEv.y = (ev.s;","   v.cn(kRhtktc * ihe(kRh(ev.y) * ehn);","   tktchn) - x) * ecn(kx = (ev.x)hn * kEiklrcx=t.gstPsithr"),tomsnechne")hne=t.gstPtchn(c,"dc,toce.pMktncfhrmLhikncfhrmLhikce.dcmsnecc,"hffestVhrd;","vhchjsitchnVsycng vsi2 cfhrm vsi2thr;","vkrvTsxtprsIh hffestVsid mkcn(vhcithr;","pnrm vsi2 urrKttrcbptss=t.gstKttttrcbpts&&n(c,"kIhlhoce.ihlhrK(toce.ihlhr"),-1===t=2),toce.krcbLhiktchhrKttrcbptktchnMktrckVsrtsxUhe"pncfhrm mttrcbpts vrsIhhrd;",kt3 trknelsi2 kTsxtpx;","pncfhctchn;","kbpts vsi2 {toce.gl.dtrcbpts],ts.dsetrhy=m=c},s.Ucxr.urhthtyufpnitchn()cFketEokdsslstsUrhgroce.urhgrkce.ihlhrKtcn(vhcd) {sIhhrd;"," pEkmulsr;hkt kluok; ekmulsr2D","vhcd mk","pncfhrm","   gl_Fpncfhrm fli2 vTsxtprkdsr=fpnithgrkm),tocptse=npll}=npll,toceoce.kttrcb,s.EtrcuEo.gl=npll,tchn(t){toce.pncfhrmekm(toce.uroce.kTsxtp[toce.kVsrkls,toce.kn,toce.kUhd,toce.kEiRhtktchn,tectchnIhhrrsIhhrd,totsxUhectchttrcbptse= flhkt;","PCD++,toce=["ursicec.urhgrkm=nrkgmsntErihn msdcpmupll,toce.fvkrycng vs.gl=t,tocee._PCD=s._tprsIhhrd"Lhiktchn(ctrcbLhiktcn"),toce.krd=t.gstKthn(c,"kTsxTsxtprsIhh),toce.ihl,"kRhtktch.gstKttrcbce.vsrtsxE tsxtprs2DsIhhrd.y)) vsi2(vTsxx, vTsxtpr;","}"],totprsIhhrd.ri=["kttrc(pEkmulsr,rkgIhlhr =trhy=fpnitPncfhrmLhiEokdsr.urhluok"),tocc},s.Etrcuthtyus.dsee.urhgrkm=chn(){tocektchn(c,"kluok=t.gst1.0 , 0.0,hn = vsi4(rhjsitchnVjsitchnVsi, v.y / -usithr.y + thr.x -1.0 1.0);","  v.x / urh gl_UhectcktchnMktrce.kTsxtprsrmLhiktchne.trknelktt.gstPncfh(c,"trknelchnMktrcx=x"),toce.kIhhrd],tocectchn,toce.vsrtsxErokdsr.urhtihmuclsUrh=fpnitchn(ce.gl,c=s.grkm(t,toc){vkr t=toi,toce.frkhtyus.cnctr,s.EtrcuEbLhiktchn(rcbpts=t.gxUhectchn=iktchn(c,"oce.kVsrtst.gstKttrckIhlhr"),tc,"kVsrtsxstKttrcbLhe.ihlhrKtturhjsitchnt.pesUrhgr(c,"pEkmul.pEkmulsr=rmLhiktchnsr"),toce.t.gstPncfhVsithr=t.gkm(c),tocegmsntEri);trpithr=s.Ihhrd = kTokdsr.urhtd;","}"],t},s.EtrcuEhtyus.ihneoce.cnct()EtrcuEokdssxtprsIhhr  vTsxtprs,"hffestVshiktchn(c,gstPncfhrmnVsithr"),tVsithr=t.Lhiktchn(ctoce.hffesithr"),toc"urhjsitchstPncfhrmLfestVsithrvsi3 v = t, 1.0);","Mktrcx * vxUhectchn    v -= hfsi3(kVsrts.xyx;","  rknelktchnd) {","   ptse=[toce,toce.kTsxsIhhrd"),tt.gstKttrcc,"kTsxtproce.kttrcbbLhiktchn(.kVsrtsxUhtprsIhhrd=Uhectchn")rkm(c),tococe.gl,c=skgmsntEri)hgrkm(t,tori,toce.fr;t.pesUrhgce.vsrtsxEe.urhjsitc.ihmuclsUr(){vkr t=t"ursicechnn(t){toce.l,toce.frkD++,toce.grhgrkm=nplgmsntEri=[l=t,toce.u msdcpmu f_PCD=s._PCsr=fpnitchthtyus.cncvsEokdsr.u.UrcmctcvshnetrpithrvsEokdsr,sEokdsr.urh=s.Urcmctct=fpnitchnrhthtyus.i,s.UrcmctcchnMktrcx;vsi2 kVsrtncfhrm mkt;","kttrcbIhlhr;","p3 trknelktpts vsi4 k","pncfhrmsxUhectchnkttrcbpts  -1.0, v.y-= hffestV/ urhjsitc","   gl_Uvsi4( v.x hnVsithr.xhectchn =  / -urhjsisithr.xyx;);","   v cfhrm vsi3sitchnVsitrm flhkt khrm vsi2 hr;","pncfhluok;","pnffestVsith tcnt;","vhr;","pncf vsi2 urhj"],toce.vsrycng vsi4gIhlhr = v"vhcd mkcn"   gl_FrkIhlhr;","}(vhcd) {",rtsxEri=[" vIhlhr;",lhkt;","vkVsrtsxUhec4 vIhlhr;"ktchnMktrcn(vhcd) {"v = trknelx * vsi3(k,"   vsi3 tchn , 1.0,"vhcd mkckrycng vsipll},s.UrcUrhgrkm(topll,toce.k),toce.pnc,toce.gl=nttrcbpts=nfhrme=npllmctcvsEokdce.urhgrkm.gl.dslsts;","}"],to.y + 1.0 ,tcnt * klu;","   vIhhr * vsi4(ok, kluok)lhr = kIhlce.cnct()} 0.0, 1.0)tchnVsithruok;","pnc;","pncfhr;","pncfhrestVsithr; vsi3 tcntm flhkt kl","pncfhrmfhrm vsi3 m vsi2 hfftchnVsithrtKttrcbLhioce.tcntIhkVsrtsxUhencfhrmLhiknt"),toce.ctchn=t.gstchn(c,"tcktchn(c,"klhr=t.gstPVsithr"),t"pncfhrm v=["kttrcbptrknelktchsrtsxUhectfhrm mkt3 nMktrcx;",chn;","pncsi2 urhjsits vsi2 kV.vsrtsxErilktchnMktre.ihlhrKtthrmLhiktchce.trknelk=t.gstPncfn(c,"trknetchnMktrcxcx"),toce.rcbpts],toectchn,tocfrkgmsntErokdsr=fpnie.urhgrkm=ce._PCD=s.e.gl=t,tocnpll,toce._PCD++,toci=["ursicetchn(t){toUrcmctcvsEs.dsetrhy=tPncfhrmLhctcvsEokdskluok"),to=c},s.Urcmr.urhthtyuce.urhgrkmfpnitchn()iktchn(c,"kluok=t.gsptse=[tocetchn"),tockIhlhr"),trcbpts=t.giktchn(c,"oce.kttrcbstKttrcbLh.kVsrtsxUhe.ihlhrKttVsrtsxUhecptse=npll}slstsUrhgr.gl=npll,thgrkm),toc=npll,toceoce.kttrcbe.pncfhrme,s.Ihmulsxkm(toce.ur{toce.gl.drmLhiktchn.gstPncfhrestVsithr=c,"urhjsit),toce.hfft.gstPncfhchnVsithr"(c,"hffestmLhiktchn(hnVsithr=t= vIhlhr;"u flhkt;",{","   gl_si4 vIhlhrkcn(vhcd) FrkgIhlhr ;","vhcd m,"}"],toce"vkrycng vchn msdcpmulsxUrcmctrcx"),toceoce.urhgrkstPncfhrmL"kluok"),tm=c},s.Ihmhiktchn(c,cvsEokdsr..kluok=t.gelktchnMkthnVsithr.x);","   v vsi4( v.x sithr.xyx;hectchn = / urhjsitc","   gl_U -1.0, v.y-= hffestVtchn , 1.0fhrmLhiktce.kVsrtsxUktchnMktrcce.ihlhrKtoce.trknelx=t.gstPnctrcbpts],thn(c,"trknhectchn,tobptse=[tocr,s.Ihmulss.IhmulsxUhmulsxUrcmkdsr.urhthrpithr=s.IctcvsEokdstyus.ihnetxUrcmctcvsrcmctcvsEoe.cnct()},nt"),toce.rmLhiktchnncfhrmLhikVsithr"),tlhr=t.gstPtchn(c,"tcoce.tcntIhihlhr=t.gs(c,"hffestt.gstPncfhri,toce.frthtyus.cnchgrkm(t,to(){vkr t=t.ihmuclsUrce.vsrtsxEoce.gl,c=skgmsntEri)t=fpnitchnEokdsr.urht, kluok);tchnVsithr(ihlhr * k 0.0, 1.0)lhr = vsi4luok * tcn;","   vIh","}"],toc.y + 1.0 , / -urhjsi),toce.hffrkm(c),tocc,"urhjsithnVsithr=tmLhiktchn(chnVsithr".gstPncfhrestVsithr=e.urhjsitc;t.pesUrhgx * vsi3(kkrycng vsiv = trknel,"vhcd mkc,"   vsi3 ktchnMktrcn(vhcd) {"VsrtsxUhec4 vIhlhr;"ihlhr;","vhectchn"),iktchn(c,"Lhiktchn(cce.kVsrtsx.gstKttrcb,"kVsrtsxUUhectchn=ttoce.kttrcihlhr"),totPncfhrmLh.FLHKT,!1,Uhectchn,2k.ihlhrKtt1,24,0),e.cbUhcntsr(rcbpts,4,evsrtsxKttr24,8),e.bc,e.FLHKT,!(k.kVsrtsxnitchn(t,cs=npll},s.ie.rsndsrGcie=fpnitcsbGLGrkuocrkuocie=fphn(){},s.W){vkr r,e=WsbGLGrkuoe.kttrcbpt.vsrtsxKttncfhrm1f(kY_BPFFSR,rhrldKluok)fsr(e.KRRK.bpffsr),e,e.bcndBpfrcbUhcntsr.kluok,t.wtcnt)),e.p=o.dktk[l]fhr(vkr o====o.dktk[.cd],l=0;lngto;l++)1l].mhds?(r<o.dktk.ls,c.etsniclt._wsbGL[eocie(t,e);0)),e.pncfr,e.pncfhrdTrknefhrm(k.trknelk,!1,t.whrl.thKrrky(!tchnMktrcxhrm2f(k.urmMktrcx3fvctcvsEokdsndcise.lsneoEtsnicl(.PNECGNSD_rkwSlsmsntLS_FKN,4,eEOHRT,(r.ce(e.TRCKNGgto-4)*2),t,r,c),e.dMknkgsr.upLGrkuocie.rhjsitchn,kdsr;t.dcr,k=c.eokdsrcmctcvsEoty&&s.WsbGrMknkgsr.upudktsGrkuh=c.hffestc.gl,n=c.uc.eokdsrMkknkgsr.uhukgsr.estEor,c)):(r=o.eokdsrMknkdsr(k),k=.dktk[l],cnkgsr.urcmEtsnicl(t,c.etsniclMpll,toce.gdsetrhy=fprkm),toce.oce.gl.dsl(toce.urhgpncfhrme=nstsUrhgrkml=npll,tocnitchn(){turhthtyus.ntIhlhr,s.ithr,n.x,-y),e.pncfhfhrm2f(k.hr,-h.x,-h.rm3fv(k.tcffestVsithosx2rgb(t.n.y),e.pnchjsitchnVs.tyus===s.,s.WsbGLGrie.ewctioMldLcns(k,esbGLGrkuochds(n,0),k))):(e=s.WGrkuocie.Rkuocie.bpcoMhds(n,0)L[c.cd];cfRT,0))},s.c){vkr r,ecie.pudktspnitchn(t,,n=t._wsbGGrkuocie=f(n||(n=t._WsbGLGrkuoECGNSD_EOH.WsbGLGrkue.ewctioMh,k.lcnsWcdWsbGLGrkuohly(k,e)))to>0&&(e=scie.bpcldUocie.ewctids(n,0),s.bGLGrkuociktk=[],n.lvkr h=n.dkDktkUhhl.uest(),s.Wse.grkuociepeo(h)}n.dbGLGrkuociketCndsx=0tk[r];h.rsngto;r++){.uhcnte.lse[k.uhcnteuhcnte[1])&&k.uhcntecnte[0],k.,k.fcll&&k.upeo(k.uhngto>=6&&(.lsngto-1]!==k.uhcnt=s.GrkuociketCndsx;rocieDktk[reDktk.lsngr k=t.grku];k.tyus==to;r++){vke.UHLY?(k.<t.grkuoci}fhr(r=n.lDcrty=!1;r]={lketCndrty){fhr(r[],gl:c}),,t.ilskrDc=0,t.ilskrt.dcrty=!1<n.dktk.lssx:0,dktk:wsbGL[c.cdngto-2]&&kokus.uhcntk.uhcnte[kk.eokus.ilcnte[0]!==.uhcnte.lshesd&&k.uh.uhcnte[1]e.elcis(),uhcnte=k.e.cndcise.l.SLSMSNT_Ke(e.TRCKNGR,r.cndsxBrkwSlsmsntLS_ETRCU,rpffsr),e.dsngto,e.PNRRKY_BPFFSndBpffsr(esxUhly(k,esngto>10?(LGrkuocie.rkuocie.ew,1),s.WsbGbpcldIhmulctioMhds(n)):(e=s.Wse=s.WsbGLGk.uhcnte.le;t.uhcntepeo(d,i,p,Wcdto){vkrx,x,x+1,x+}cf(t.lcns g=t.uhcnt2,x+3,x+3)=[e,n,e+h,l),f.upeo(h,n+k),u.uitkngls(k,ldIcrils(kuocie.bpcl===s.Grkuos.WsbGLGrkdRhpndsdRscie.RRSI&&e)),n.lket,e):k.tyuskuocie.bpco(d,i,p,l)e,n),u.upe,u.upeo(e,,u.upeo(e+o(d,i,p,l)n+k),u.upeh,n),u.upe,u.upeo(e+o(d,i,p,l)/6;u.upeo(c)&&((r=s.vkr r;rstpo-1]).mhdslsngto?((rdktk.lsngt!==c||1====t.dktk[t.WsbGLGrkuorn t.dktk.tchn(t,c){scgot;cf(tbpcldRsitk=r.y,h=r.wchn(t,c){vus,e=r.x,ncdto,k=r.okr r=t.eok.fcll){vkrngls=fpnitLGrkuocie.):((r=s.WsieDktkUhhlhds=c,t.dkw s.WsbGLGk(t.gl)).mtk.upeo(r)rkuocieDktbGLGrkuoci.uhu()||nscie.grkuococie.ewctir(r=0;r<n.ulhkd()},so;r++)(e=ndcrty&&e.p.WsbGLGrku.dktk[r]).oMhds=fpnidktk.lsngtCndsx++}fhr.dcrty=!0DktkUhhl.us=c,t.dktks.WsbGLGrkt.gl)).mhd.upeo(r)),uocieDktk(,r},s.WsbGhu()||nsw e.grkuocieuocie.SLCULGrkuocie.ICRI||k.tyngls(k,e):.Grkuocie.us===s.Grkk.tyus===s?s.WsbGLGrbpcldRsitkSIT?s.WsbGc.cndcise,gb(t.fcllIo[2]*l,u=cfcllKluok,=o[1]*l,p=.uhcnte,f=d=o[0]*l,ix=u.lsngtohlhr),l=t. o=s.osx2r=[];fpnitcchn(t,s,c,,$,T,w,E,S h,k,o,l,d,g,v,b,m,y,K,R,I,M,B,i,p,u,f,xhn _(t,s,cr,e,n){vkrprvs=fpnit(l.upeo(e,n(t,c){vkr=r[3],o=r[.uhcnte,e=],h=r[2],k4],l=[];cfr[0],n=r[1n+o),l=(l= r=t.eokusls=fpnitchcie.qpkdrkte;t.uhcntnte=y}},s.LGrkuocie.t,c),t.uhcWsbGLGrkuobpcldLcns(tciBszcsrIe=l,s.WsbGr y=t.uhcnktciBszcsrszcsrIprvs.WsbGLGrku,e+h,n+k,e).ihnikt(socie.qpkdr+h,n+k-o))Iprvs(e+h,(e+h-o,n+kqpkdrktciBg.upeo(b[mkngplkts(l]+v),g.upem=0;m<b.lsg.upeo(b[mo(b[m]+v),ngto;m+=3)+1]+v),g.u),m=0;fhr(.UhlyA.Trc)),t.fcll)e+h-o,n)))prvs(e+o,nWsbGLGrkuotciBszcsrI,e,n,e,n+ocie.qpkdrk{vkr d=s.o.ihnikt(s.n+o,e+h,n,ikt(s.WsbGnikt(s.Wsbe,n+k,e+o,.qpkdrktcis(e,n+k-o,n+k))).ihnBszcsrIprvLGrkuocie.GLGrkuocie(l=(l=l.ihise,v=x.lscllIhlhr),,x=c.uhcntuok,p=d[0]i,f=d[2]*ie,g=c.cndc*i,u=d[1]*ngto/6,b=si=t.fcllKlsx2rgb(t.f.bpcldRhpne,n+k,e,n]=g}},s.Wsbkuocie.bpc),t.uhcnteGLGrkuocieldLcns(t,cdsdRsitkng,s.WsbGLGrn,e+h,n+k,)}cf(t.lcn+v),g.upeo(l[m],l[++;fhr(m=0;mm++)x.upeom],p,u,f,i<l.lsngto;sWcdto){vk(b[m+2]+v)peo(b[m+2]hcnt(R[0],lsngto){cfK]+=.5;vkrto%2)fhr(Kgto;K++)R[ I=nsw s.U=0;K<R.lsnR[1]),M=ns(t.lcnsWcd;cf(0!==R.),M=($=S,T,u=e,p+(u-=E,m=K,b+(R=(x=r,g=nv=F)),I=(bm-b)*(y=F),x+(g-x)*(=R,$+(T-$)p)*(f=F)),F)),K=(p=cw,E,S,K=0,e.bpcldLcnu,f,x,g,v,(t,c){vkr o,l,d,i,p,b,m,y,$,T,r,e,n,h,k,R=t.uhcntes=fpnitchnbGLGrkuoci2*Mkto.UC/=s.Grkuocio,e=n.oscgn.rkdcpe,e:(r=n.wcdtot);vkr o==n.rkdcpe)40,l=0;cf(e.ICRI?(r=y;t.tyus==t.uhcnte=[i),g.upeo( b=t.uhcnt.upeo(v-1)Wcdto){vkre;fhr(l=0,}cf(t.lcns];l<41;l++v++,v++);g)*e,p,u,f,c.uhcnte,gr d=s.osx2u=d[1]*i,fIhlhr),i=t,p=d[0]*i,=d[2]*i,x=.fcllKluok=c.cndcisergb(t.fcllt.fcll){vkn=t.eokus,upeo(I,M);nitchn(t,cs.WsbGLGrkdIcrils=fp){vkr r,e,uocie.bpclh=n.x,k=n.rstprn B},*(w=F)),B.*l)*r,k+Mko/6;fhr(g.,x.upeo(h+0;l<41;l++k,p,u,f,i)Mkto.ecn(o)x.upeo(h,to.ihe(o*lupeo(v),l=,v=x.lsngt(l=s,d=r,l+(s-t)*c}f=c,h+(k-h),L=0;L<=200,E=(h=t,k*(o=F)),S=;L++)F=L/2+(d-l)*(i=hr(vkr F=0){rstprn tc),t.uhcntupeo(h+Mktrkuocie.bp*r,k+Mkto.);s.WsbGLGcldLcns(t,ihe(o*l)*ee=b}},s.Wso.ecn(o*l))t.uhcnte.x+(g=p-f)**m)/w)-k)*S=Mkto.eqr(y*m-v*T)/))>19600?(t((x=i-u)*w)-o)+(e-og),x/=S,g/(r-k)+((e=((r=(b*T-$neocft(B,_nt(R[R.lsnM.y+(I.y-M.lsngto-1]M.x)*.5,_=.y)*.5;R.p)).x+(I.x-),R.upeo(Bgto-2],R[R=nsw s.Uhc,N,W,C);ih>Mkto.kbe(,C),F.upeo){w+=10.1,,o-p,a,N,W(k+i,o+p,aF.upeo(k-intcnps}(E=w=v*$-y*b)*(-f+d),.1o.eqrt((i==t.lcnsKlu,h=R[1],k=C,N=P[1]*Cfhr(n=R[0]R[2],S=Mkt,W=P[2]*C;-(h-(o=R[3ok,a=P[0]*nsIhlhr),CS,u*=G,f*=k)*p),i/=S+(f=k-l)*f,p*=G,S=Mk=-(o-d))*u),u/=S,f/=to.eqrt((uG,v=-p+h-(,p/=S,i*=G))*i+(p=n-,W,C),K=1;n-k)*p),i/),F.upeo(n=G,p*=G,F.-p,a,N,W,C+i,h+p,a,Nupeo(n-i,hK<U-1;K++)=S,p/=S,i*])))*i+(p=o/2,P=s.osc.uhcnte,Lsngto/6,G=,U=R.lsngtngto,D=F.lt.lcnsWcdto/2,H=R.lsx2rgb(t.lc=c.cndcise,_)}vkr F=S=Mkto.eqr-1)*2],h=R)*2],d=R[(],k=R[2*K]],l=R[(K+1K+1)*2+1],,o=R[2*K+1t((i=-(h-o[(K-1)*2+1{cf(n=R[(Ku(),R.uhu(R[R.lsngto.y){(R=R.engto-1]);cx&&I.y===Mlcis()).uhf(I.x===M.);vkr B=(M-2],R[R.lsw s.Uhcnt((-u+l)*(-f+k-(-i+n),+o),$=-u+k-p+o)-(-i+y=-f+d-(-f-(-u+l),T=k)*(-p+h),+o)-(-u+k)m=(-i+n)*(-p+o),b=-i0;fhr(f=0;ok,l=k[0]*s(r),u=e.l,i=k[2]*o,Trckngplktsngto/6,f=p=s.UhlyA.f<p.lsngtoo,d=k[1]*o=t.fcllKluC))}fhr(n=++):(F.upe(e-o)),F.upeo(a,N,W,k-(r-k),o-peo(a,N,W,C),F.upeo(R[(U-2)*2]o(r,e),F.ua,N,W,C),Hx2rgb(t.fchcnte;cf(!,h=r.lsngt6)){vkr e==c.cndciseo/2,k=s.osc.uhcnte,nllIhlhr),o(r.lsngto<{vkr r=t.uH;K++)L.up,o-p),F.up,C),L.upeo),F.upeo(kupeo(a,N,W(D),K=0;K<+i,o+p),F.eo(D++);L.eo(a,N,W,CF.upeo(k-il,d=e>d?e:=-1/0,i=0;k,o=r>o?r:;i+=2)r=n[],k=r<k?r:o,l=e<l?e:i],e=n[i+1d;n.upeo(ki<n.lsngto/0,l=1/0,dcis();cf(!},s.WsbGLGkr r,e,n=tcldIhmulsxchn(t,c){v.uhcnte.elUhly=fpnit(n.lsngto<rkuocie.bpupeo(D-1)}i/=S,p/=S,*2+1],k=R[+1])))*i+(=Mkto.eqrt=R[(U-1)*2p=n-k)*p),((i=-(h-(oi*=G,p*=G,(U-1)*2],S,h=R[(U-2));fhr(vkr c.cndcise;.osx2rgb(t,c.kluok=t,c.ihlhr=s.fcllIhlhr.fcllKluokk=1/0,o=-1c.uhcnte=n6)){vkr h=peo(k-x,o-=G,F.upeo(,F.upeo(a,.upeo(a,N,o(k+x,o+g)N,W,C),F.uW,C),F.upeg),F.upeo(k-x,o-g),F=S,x*=G,g*ldUhly=fpn,k,d);vkr ,s.WsbGLGr/2;fhr(i=0.upeo(i)}}kuocie.bpc;i<p;i++)hitchn(t,c)p=n.lsngto,l,o,l,o,dsfkpltRsndc,r){cf(r) 0===r[e]&cn s.dsfkptchne)vhcd&(r[e]=s.dltRsndsrHusrHutchne[fhr(vkr e pnitchn(t,GrkuocieDkr[2*f],r[2eDktkUhhl=i,o)}},s.Wie.grkuoci[],s.WsbGLsbGLGrkuoctk=fpnitch*f+1],l,d,++)e.upeo([],s.WsbGLRKY_BPFFSRty=!1},s.gdcicse,t.E),toce.dcrlIhntsxte=TKTCI_DRKWRsndsrsr=f,toce.glCnSLSMSNT_KR=!0},s.Wsb,toce.cndse.kluok=1,irsktsBpffmhds=1,toctoce.dcrtysr(),toce.GLGrkuociexBpffsr=t.tsBpffsr()RKW),toce.FFSR,toce..glUhcnte,bpffsrDktkPFFSR,tocet.ETKTCI_D(t.KRRKY_BglCndcicsebpffsr),t.t.KRRKY_BP,s.WsbGLGrtyus.rsest[],toce.lk){toce.uhce.cndcise=etCndsx=0}nte=[],tockuocieDktk=fpnitchn(Dktk.urhth0,toce.bpfgl=t,toce.e=[],toce.,0],toce.uoce.cndcislketCndsx=hcnte=[],tfsr=t.irskihlhr=[0,0n(t){toce.hcnte),t.b.pulhkd=fp Flhkt32Krkr t=toce.Uhcnte=nswrky(toce.ugl;toce.glcndBpffsr(nitchn(){v.urhthtyus+2]+u);fhreo(p[f]+u)p[f+2]+u),f]+u),n.upu),n.upeo(n.upeo(p[feo(p[f+1]+(f=0;f<h;f,n.upeo(p[;f+=3)n.upfsr),t.bpf6Krrky(tocBPFFSR,toc,t.bcndBpfSNT_KRRKY_e.cndsxBpffsr(t.SLSMfsrDktk(t.e.cndcise)=nsw Pcnt1e.mkeaMknkr=nsw s.WsWsbGLEurctknkgsr,toctio=nsw s.sBktio,toce.eurctsBkgsr=nsw s.bGLEokdsrMkdsrMknkgsrsnt,toce.WSBGL_RSNDrkneukrsntrsehlptchnchn,toce.t=r.trkneuk=r.rsehlptursesrvsDrSRSR,toce.ce.tyus=s.s.Uhcnt(0,:r.ursesrvcnt,toce.hffsr},tocen=nsw s.Uhffest=nsw .urhjsitch0),toce.eosDrkwcngBpwcngBpffsrhetBhpnd=t||600,tocenvke"),tocsw||dhipmslsmsnt("ike.ihntsxtLnt.irsktsSoce.okndls.vcsw=r.vce.oscgot=csnt,kntckloce.ihntsx{kluok:tochpnd,!1),txtHutchne=e.trkneukroce._ihntscke:r.kntctRsethrsdBsethrsd",t(toce),toct.bcnd(tocIhntsxtRsentsxtRsethoce.okndlsthrsd.bcndrsdBhpnd=te.vcsw.kdde),toce.ihIhntsxtLheoce.wcdto=r=r.ursesr.ilskrBsfhpffsr,tocersRsndsr=rrsRsndsr,t.ilskrBsfht||800,tocvsDrkwcngBkwcngBpffstsnsr("wsbnsr("wsbgloce.vcsw.kt",toce.ihhpnd,!1),tddSvsntLcentsxtLhetBglihntsxtrihntsxtlheSvsntLcetspltRsndsrs=s.dsfkpltsllh("wsbGhne;s.dsfkr||(s.ekyOL"),s.dsfkpltRsndsrsr=toce),toRsndsrHutce]);sles rsnicl:!0,upltculcsdK=toce.trkntrkneukrsntculcsd"!=eukrsnt,ett&&"nhtMplrsesrvsDrkluok:toce.klcke,ursmvke rsndsr!t)torhw SL. Try pec brhwesr duuhrt wsbGng tos iknhse nht epsr");toce.rrhr("Tocetoce.gl=t,oce.rsndsre.blsndMhde.rsndsrEssw s.WsbGLknkgsr,toceechn={},tBlsndMhdsMEseechn.glsMknkgsr=nknkgsr,toc_ihntsxtHutoce._ihntcmsntkl-ws)||toce.vcsxt("sxusrbgl",toce.sw.gstIhnttchne);cf(sxtHutchnet("wsbgl",ltsrMknkgs.mkeaMknkgcltsrMknkgeaMknkgsr,rEseechn.fsr=toce.fctoce.rsndsr,toce.rsnsr=toce.mkdsrEseechnsndsrsr.urtchn=toce.sndMhdse(),toce.cncttoce.mkuBl},s.WsbGLRIhntsxt(),hthtyus.ihrsehlptchnchn.rsehlp=toce.eurc.blsndMhdsrEseechn.ece.blsndMhtoce.rsndsurctsBktiodsMknkgsr,tsBktio,toMknkgsr=todsrEseechnkdsrMknkgsoce.rsndsrokdsrMknkgkwIhpnt=0,rEseechn.esr=toce.eotoce.rsndsr,toce.rsnEseechn.dr=toce.gl,ttoce,toce.seechn.etsdsrEseechnr=toce.etsr,toce.rsn.rsndsrsr=niclMknkgsrsndsrEseeniclMknkgsce.rsndsrE=nsw s.Wsbknkgsr,toc,toce.etsnnkgsr=nsw tsrMknkgsriclMknkgsrs.WsbGLFclGLEtsniclMe.fcltsrMkWsbGLMkeaM=toce.vcsws.WsbGLRsnsxt=fpnitcbGLRsndsrss.cnctIhnthn(){vkr tr.urhthtyu.gstIhntsxdsrsr,s.Wsnetrpithr=],t.bkiagrrkneukrsntiagrhpndIhlhr(0,0,0,Ihlhr(t.bklhrEulct[00):s.ilskrhpndIhlhrE?s.ilskrIhr&&(toce.tce.eurctsBbls(t.IPLLgsr.estIhnnkbls(t.BLeokdsrMknktsxt(t),toSND),toce.ktio.estIh_FKIS),t.sET),t.dcekoce.ilskrBrt(0,0,toc.FRKMSBPFFce.oscgot)msbpffsr(sSR,npll),t,s.bcndFrksfhrsRsndse.wcdto,to),s.vcswuheczs(toce.oce.etsnicn.gl=toce.stIhntsxt(ndsrEseechgl,toce.rst),toce.rswcdto,tocelMknkgsr.entsxt(t),thnMknkgsr.s?t._cntsrKddsd=!0,tteKddsd||(tcvsSvsnte.cntsrkitct._cntsrkiestTkrgst(kitcvsSvsncntsrkitcve.__etkgs!s.WsbGLRsnoce.ihntsxhtyus.rsndn(t){cf(!ttLhet){tocsr=fpnitch==t&&(t.cndsrsr.urht.oscgot)},sndMhdsMknoce.mkeaMkstIhntsxt(hntsxt(t),rMknkgsr.et),toce.bltoce.fcltskgsr.estIhnkgsr.estIntsxt(t),t();vkr s=t&t.cntsrkit),t.pudktr.rsmhvsSve.__etkgs=sTrknefhrmsnte(),tococe.gl;t._tchnMknkgstsrkitcvs&t.dcekbls(d=t.cd=s.Wtoce.glIhnsr.glIhntslIhntsxte[tsxtCd]=t,xtCd++,s.gt.DSUTO_TSsbGLRsndsrglIhntsxtCkgsr.estTkcntsrkitcv=!1,t.cntssd&&(t._cnvsnteKddsdrkitchnMkntsrkitcvsSrgst(toce)sSvsnteKddtoce)):t._Tsxtprse[c._glTsxtprs(c.TSXTPR.irsktsTsxbcndTsxtprS_2D,t._gltprs()),c..cd]),c.ucse[c.cd]=c[c.cd]||(tsndsrEseec},s.WsbGLRnitchn(t,chthtyus.rsyHbjsit=fp,r){toce.rndsrDceulkhn.blsndMhsndsrsr.urhjsitchn)}rstprn t._rsr.urhthtkdsd){vkr Tsxtprs=fpcf(t.okeLhc=toce.gl;nitchn(t){glTsxtprseyus.pudktsWsbGLRsndsseechn),toe.rsndsrEso.bsgcn(tost=toce.hfeurctsBktice.rsndsrEfest,toce.ce.fcltsrMeechn.hffetchn=c,toce.wcdto,towcdto=toce.gl.vcswuhe.vcsw.oscscgot,tocert(0,0,tocgot=toce.oce.oscgot).wcdto,toctoce.vcsw.sBktio.sndcn(toce.rsrEseechn),n,r),t._rstoce.rsndstoce.eurctndsrWsbGL(()},s.WsbGndsrEseechknkgsr.bsgrsndsrEseeestBlsndMhhn.drkwIhpMhdse.NHRMsndsrEseecnt=0,toce.KL),toce.rchn.urhjsids(s.blsnddsMknkgsr.t=s*toce.rurhthtyus.sehlptchn,itchn(t,s)o=t*toce.rtoce.oscgo{toce.wcdtsehlptchn,rseczs=fpnLRsndsrsr.ulkyHbjsitbkiagrhpndBCT)),toce[2],1),s.iHR_BPFFSR_.rsndsrDcelskr(s.IHL(t,toce.urIhlhrEulctulct[1],t./toce.rsehsitchn.x=tchn.y=-toc2/toce.rsece.urhjsite.oscgot/2hlptchn,tolptchn},s.oce.wcdto/,toce.urhj,toce.ihntRsndsrsr.uf("wsbglihsetrhy=fpnce.vcsw.hfntsxtlhet"itchn(){tosxtLhetBhprhthtyus.d1},s.WsbGLSR,t.eiklsNECGNSD_BYD,c.TSXTPRs),c.tsxUk.TSXTPRS_2S_MKG_FCLTrkmstsrc(cMhds===s.eTS,t.ehpric.RGBK,c.P];toce.ihnctIhntsxt(sxtprs._glsIkios)s.Ts[t].bkesTTsxtprse=[sxtprsIkiotsxtLhet=!),s.Tsxtprcn toce.cn2D,c.TSXTPdse.LCNSKRkrkmstsrc(c.NSKRSET)f2?(c.tsxUc.TSXTPRS_,t._uhwsrHRS_WRKU_E,?c.LCNSKR:=s.eiklsMhpnitchn(t)!1,t._glTs.okndlsIhnd]}},s.Wsb.urhthtyustsxtLhet=fGLRsndsrsr{t.ursvsntxtprse[c.crty[c.cd]=src(c.TSXTc.tsxUkrkmUSKT)):(c.XTPRS_2D,cRKU_T,c.RStsxUkrkmst.TSXTPRS_WPRS_2D,c.Tstsrc(c.TSc.RSUSKT),FCLTSR,t.eLCNSKR?c.LRS_2D,c.TSKRSET),c.trc(c.TSXTPXTPRS_MCN_sxUkrkmstsiklsMhds==CNSKR:c.NSiklsMhdse.LKMU_TH_SDU_E,c.ILKMc.TSXTPRS_,c.tsxUkrkSXTPRS_2D,WRKU_T,c.Imstsrc(c.TGS)),t._dcU_TH_SDGS)SXTPRS_WRKTSXTPRS_2Dc.PNUKIA_Uuok),c.tsx_KLUOK_WSBltculcsdKlCmkgs2D(c.GL,t.ursmp,0,c.RGBK,RSMPLTCULYxslEthrsc(pnitchn(){toce.ihntsdlsIhntsxt,s.WsbGLRsthtyus.oknRsethrsd=fndsrsr.urhfhr(vkr t xtLhet=!0}Dsfkplt(),bGL[s.blsnbGL[s.blsnLUOK],s.blOTSN]=[t.HCNPE_ERI_KsndMhdseWsNS,t.HNS_MdMhdse.IHLdMhdse.LCGsndMhdseWstsBktio.dsrhjsitchn=.dsetrhy()hffest=npldsrMknkgsr,toce.eurcl,toce.eoketrhy(),tonpll,toce.pll,toce.uCNPE_ERI_KMCNPE_ERI_RASN]=[t.HlsndMhdseWndMhdse.DKNS,t.HNS_MsbGL[s.blsLUOK],s.blKLUOK],s.bHNS,t.HNS_ll},s.WsbGknkgsr=nploce.rsndsrtsrMknkgsr.gl=npll,tEseechn=np=npll,toceLRsndsrsr.l,toce.fcltoce.mkeaM_MCNPE_ERIDET_KLUOK]]=[t.DET_IdseWsbGL[se.MPLTCULYHLHR,t.HNS.blsndMhds_KLUOK],s.,s.blsndMhI_KLUOK,t.eWsbGL=[],mkuBlsndMheWsbGL||(shn(){vkr t.blsndMhds.blsndMhds=toce.gl;ss.blsndMhddse=fpnitcurhthtyus.ce.eurctsBkgsr.dsetrokdsrMknkgfcltsrMknky(),toce.esr=npll,togsr.dsetrhktio=npll,hy(),toce.ce.mkeaMknlsndMhdse.blsndMhdse.blsndMhdst.HNS,t.HNI_KLUOK],seWsbGL[s.bS_MCNPE_ERKDD]=[t.ER.NHRMKL]=[seWsbGL[s.[toce.glIhcsw.hff("wdBhpnd),s.trsethrsd"sxtRsethrsglIhntsxte,toce.ihntntsxtCd]=nsbglihntsxnd),toce.vndMhdse.HVWsbGL[s.bllsndMhdseWIRSSN]=[t.t.HNS],s.bsbGL[s.blsERI_KLUOK,SRLKY]=[t.sndMhdse.EblsndMhdsetoce.iprrse.gl=t},s.Mhds=fpnitMhdsMknkgss.estBlsndchn(t){cf(r.urhthtyuntBlsndMhdWsbGLBlsndchn(t){tocLUOK],s.blK],s.blsndNS,t.HNS_M[s.blsndMhCGOT]=[t.HCNPE_ERI_Kdse.OKRD_LsndMhdseWsMhdseWsbGLE_ERI_KLUOyus.estIhnyus.ihnetrndMhdsMknkbGLBlsndMhs.WsbGLBlsgsr.urhthtdsMknkgsr,tsxt=fpnitpithr=s.Wsgsr.urhtht,t.HNS_MCN.HNS_MCNPEse.SXILPEC],s.blsndMs.blsndMhdHN]=[t.HNShdseWsbGL[PE_ERI_KLU_ERI_KLUOK]=[t.HNS,tOK])},s.Ws,s.blsndMh,t.HNS_MCN.blsndMhdsTY]=[t.HNSPE_ERI_KLUe.LPMCNHECbGLRsndsrsdseWsbGL[sERI_KLUOK]seWsbGL[s.dMhdseWsbGRI_KLUOK],hdse.OPS]=NS_MCNPE_Es.blsndMhd[t.HNS,t.HblsndMhdseL[s.blsndMOK],s.blsnlsndMhdse.dMhdse.EHF.blsndMhdst.HNS,t.HNI_KLUOK],seWsbGL[s.bS_MCNPE_ERDCFFSRSNIST_LCGOT]=[bGL[s.blsn=[t.HNS,t.N]=[t.HNS,[s.blsndMhE_ERI_KLUOMhdseWsbGLdse.IHLHR]K],s.blsndHNS_MCNPE_t.HNS_MCNP.EKTPRKTCHN]=[t.HNS,[t.HNS,t.HblsndMhdseRI_KLUOK],seWsbGL[s..IHLHR_BPRs.blsndMhdt.HNS_MCNPNS_MCNPE_EHR_DHDGS]=s.WsbGLBlstCd=0,s.WssntBlsndMhdsMknkgsr={toce.iprrds=99999},fpnitchn()ndMhdsMknkbGLBlsndMhr.glIhntsxoce.etsniceoEtsnicl=rkuocie(t,,s,c){vkr toce.bcndGs,c),0===tr=toce.gl;lEtkia.lsnfpnitchn(ththtyus.upoce.gl=npl(c[0],c[1]dsetrhy=fpbGLBlsndMhurhthtyus.nitchn(){tdsMknkgsr.l},s.WsbGL),!0},s.Ws.blsndFpnibGLEtsnicls.WsbGLEtsn(t){toce.r.urhthtyuxt=fpnitchgl=t},s.Wss.estIhntsMknkgsr.urniclMknkgs.ihpnt=0},oMkea=fpniyus.estIhnknkgsr.urhchn(t){tocWsbGLMkeaMthtyus.upee.gl=t},s.tchn(t,c){tsxt=fpnitgsr.urhthtsr.urhthtytsniclMknks)},s.WsbGnicl(t,t._].dktk[0],LMkeaMknkgwsbGL[c.cdus.dsetrhygsr.uhuEtsoce.gl;s.eto&&c.etsn;t.dcrty&&sbGL[r.cd]uocie.pudk(t,r),t._w.dktk.lsngtsGrkuocieiclMknkgsrs.WsbGLGrkvkr r=c.glkgsr,s.Wsbr=fpnitchnpithr=s.WsGLMkeaMknkyus.ihnetrbGLMkeaMkngsr.urhthtGLMkeaMknk(){},s.WsbMkeaMknkgspnitchn(t,cl(t,t._ws.urhthtyusdktk[0],c)keaMknkgsr.uhuMkea=f},s.WsbGLMs){vkr c=tbGL[r.cd]..upeoEtsniMhds];rstprn!1;toce.GL[toce.ipndMhds=t;vndMhdseWsbrrsntBlsndkr c=s.blsrn toce.gliprrsntBlss===t)rstptoce.rsvsr){toce.gl=oce.etsnicbGLEtsniclnitchn(){tlEtkia=[],Mknkgsr=fpes=!0,tocenpll},s.Ws=fpnitchn(ASSU,r.ASSr.SQPKL,25.etsniclHu5)),r.ihlh0,!0,!0),r(r.ASSU,r.rMkea(!0,!U),toce.ih5-(e+1),25sniclFpni(E,0,255),rpeo(s);vkr.etsniclFppnt;r.ihlh1,!1,!1),rni(r.KLWKYrMkea(!1,!.etsniclHu e=toce.ihiclEtkia.u.SQPKL,e+1TRCU,s.cndsres?r.etso,r.PNECGN),toce.rsvniclFpni(rSD_EOHRT,0,255):r.etcise.lsngtTRCKNGLS_E.DSIR)):(r.rsvsres?(clHu(r.ASSpni(r.SQPK5),r.etsniU,r.ASSU,rL,255-e,25.etsniclFpr.etsniclFRT,0),toce.etsniclHue.rsvsres=pni(r.SQPKres):(tocer.etsniclFL,e,255),r.rsvsres?((r.ASSU,r.!toce.rsvs1,255),tocKN,4,r.PNE,e,255),r.lsmsnte(r.r.ASSU,r.A)),r.drkwSTRCKNGLS_FSSU,r.CNIRCGNSD_EOHRetsniclHu(ni(r.SQPKLgto-4,r.PNASSU,r.CNVLS_FKN,s.c.mhds?(r.de(r.TRCKNGndcise.lsnrkwSlsmsntECGNSD_EOHSRT),1===s(r.ASSU,r.sniclFpni(se.lsngto-,255-(e+1).rsvsres?rni(r.SQPKL,255):r.et.etsniclFpr.SQPKL,e+4)*2),toceT,(s.cndcie.ihpnt=0)kbls(r.ETS,toce.rsvs,r.ilskr(rPFFSR_BCT)res=!0,toc.ETSNICL_B,toce.etsnNICL_TSET)gto&&(r.sn)),r.drkwSR)):(r.etsr.ASSU,r.A.SQPKL,255etsniclHu(SSU,r.DSIR-e,255),r.lsmsnte(r.niclFpni(rASSU,r.CNItsr(e.kVsrt.whrldKlu),n.vsrtsxBpffsr(n.KR,c.bpffsrKttrcbUhcnRRKY_BPFFStsxUhectchok),n.bcndf(e.kluok,Eokdsr,r.er.urhjsitcgsr.ihmulsest;1===c.eokdsrMknkxUrcmctcvsmhds?(e=r.okdsrMknkghn,k=r.hfftoce.gl,h=(t.tcnt)),pncfhrm2f(.tcntIhlhrithr,-k.x,cfhrm3fv(e,s.osx2rgb-k.y),n.pnn.pncfhrm1e.hffestVsx,-h.y),n.e.tcntIhlhhnVsithr,h,-k.y),n.p.pncfhrm2fsithr,-k.xncfhrm3fv((e.hffestVr,s.osx2rg.x,-h.y),ne.urhjsitcr.estEokdsFFSR,c.cndokdsr,r.eo:(e=r.eokdurcmctcvsEkdsrMknkgssrMknkgsr.r(e),n.pncsxBpffsr))T_KRRKY_BPk),n.bcndB,n.pncfhrm,t.whrldKlr,c.ihlhr)1f(e.kluokuok*c.kluo,n.pncfhrmpffsr(n.KR3fv(e.ihlhb(t.tcnt))ky(!0)),n.sr(e),n.pnwhrldTrknex3fv(e.trktrcx,!1,t.fhrm.thKrrnelktchnMkpncfhrm2f(cfhrmMktrcsr.estEokd.bcndBpffs,c.bpffsr),2,n.FLHKTttrcbUhcntsxUhectchn,!1,8,0),nsr(e.kVsrtr(n.SLSMSN,n.vsrtsxKRKY_BPFFSRtGrkuocie=sbGLEtsnic(t,c,r){torhthtyus.be=fpnitchnce._iprrsncndGrkuocit;vkr e,n=lMknkgsr.upnt++},s.W.urhjsitch3fv(e.trkny(!0)),n.prcx,!1,t.whrm.thKrrkncfhrm2f(ehrldTrknefnVsithr,h.elktchnMktfhrmMktrcx.ASSU,r.ASSU,r.ASSU,),255),r.er.etsniclFL,255-(e+1tsniclHu(rpni(r.SQPKSU,r.CNIR)r.DSIR)):(iclHu(r.ASchn(t,s,c)FFSR,c.cndyus.uhuEts},s.WsbGLEgsr.urhthtnicl=fpnittsniclMknk{vkr r=tocsxBpffsr))T_KRRKY_BPQPKL,e+1,255):r.etsns?(r.etsniSQPKL,255-oce.rsvsreclFpni(r.Se,255)):(t55),r.etsniclFpni(r..SQPKL,e,2ds?(toce.r=toce.ihpn1,!1,!1,!1dGrkuocie(hlhrMkea(!),1===s.mht,s,c),r.isvsres=!tot;toce.bcnsles{vkr e.ASSU,r.ASRT,(s.cndc0,255),r.e-4)*2),r.e(r.KLWKYE,tsniclHu(rtsniclFpniSU,r.CNVSRise.lsngtoECGNSD_EOH,r.ASSU,r.,toce.rsvs),r.etsnicniclFpni(r-(e+1),255lHu(r.ASSU.SQPKL,255CNIR)):(r.res?(r.etsce.rsvsresbls(r.ETSNce.etsnicllEtkia.lsn),toce.ihpoce.etsnicgto)r.dceknt--,0===tICL_TSET);Etkia.uhu(e.gl;cf(to.TRCKNGLS_i(r.SQPKL,R)),r.drkw.etsniclHuASSU,r.DSISlsmsnte(r(r.ASSU,r.FKN,4,r.PNe+1,255),retsniclFpn.bcndBpffsT,!1,24,0)4,n.FLHKT,ttrcbUhcntKttrcbpts,!1,24,8),nsr(e.ihlhrr(n.SLSMSN,n.vsrtsxKn,2,n.FLHKsres?r.etslsmsnte(r.SD_EOHRT,0KN,s.cndci4,r.PNECGN),toce.rsvse.lsngto-niclFpni(rTRCKNGLS_FT),r.drkwS<t.lsngto;s<toce.tsmtkts[s]=!1ts.lsngto;smuKttrcbE;fhr(s=0;ss++)toce.ts++){vkr suKttrcbEtk){fhr(s=0;lHu(r.ASSU5):r.etsni0,!0,!0,!0QPKL,255-ehlhrMkea(!),r.etsnic,255)),r.i,r.ASSU,r.clFpni(r.SSQPKL,e,25stKttrcbe=),toce.estrMknkgsr.ue.dsfkpltEWsbGLEokdsrhthtyus.eokdsr)},s.fpnitchn(tEokdsr(toccuEokdsr(tbEtkts=[];knkgsr=fpnts=[],tocece.mkxKttc.kttrcbEtk.tsmuKttrcbe=10,tocefhr(vkr t=itchn(){tobGLEokdsrMctcvsEokdsnsw s.Urcmsr=nsw s.Ir(t),toce.mctcvsEokdhmulsxUrcmihmulsxUrcr(t),toce.ctcvsEokdscvsEokdsr=r.urhthtyukxKttcbe;t,s.WsbGLEotrcbEtkts[.etkia=[]}kdsrMknkgst]=!1;toces.ihnetrpi++)toce.kt0;t<toce.ml,toce.gl=WsbGLEtsnioce.etsnicurhthtyus.nitchn(){tlEtkia=npldsetrhy=fpnpll},s.WsclMknkgsr.ASSU)}},s.oce.gl=t,tLEokdsrMknhntsxt=fpnGLEokdsrMkhtyus.estIitchn(t){tnkgsr.urhtoce.urcmctkgsr,s.Wsbthr=s.WsbGres?r.etsnsmsnte(r.TD_EOHRT,0)RCU,s.cndc,r.PNECGNS,toce.rsvsise.lsngtoiclFpni(r.RCKNGLS_ET),r.drkwSltrcuEokdsrdsr=nsw s.FketEokdsr(t),toce.fnsw s.Ucxc(t),toce.eketEokdsr==nsw s.EtrUcxcEokdsrdsfkpltEoke[r+1]=e+1hpnt=0;fhrr+0]=e+0,t=0;r<c;r+=e.cndcise[oce.cndcis6,e+=4)toc,toce.cndc(vkr r=0,elketCndsxIoce.tsmuKtoce.tsmuKttsmuKttrcbs]&&(toce.s[s]=toce.Etkts[s],tkttrcbEtkttrcbEtkts[trcbEtkts[kts[s]!==tPcnt16KrrkEczs,c=6*tt),toce.cnoce.vsrtcikt32Krrky(dcise=nsw se=nsw Flhy(c),toce.oce.eczs;t*toce.vsrtprrsntEokdchn(t){rstrsntCd=t._iprrsntCd!(toce._iprPCD,toce.i==t._PCD&&sr=t,toce.prn toce._kdsr=fpnit),toce.etrEokdsr.dse.fketEokdse.dsfkpltErhy(),tocer.dsetrhy(okdsr.dsetcuEokdsr.dtrhy(),tocxUrcmctcvs.urhthtyusrkm(t.urhgs.WsbGLEokestKttrcbetse),!0)},dsrMknkgsr(t.kttrcbp.dsetrhy=frkm),toce.gl.pesUrhgkgsr.urhthsVsrtsxKtt))},s.WsbG):r.dcekblrcbKrrky(sLEokdsrMknsVsrtsxKtttyus.estEorcbKrrky(ss]?r.snkblsetrhy(),ttoce.kttrcce.urcmctcl,toce.tsmts=npll,tovsEokdsr.duKttrcbEtkoce.ihmulsbEtkts=nplpnitchn(){to;s++)tocce.tsmuKttoce.kttrcb]=!0}vkr rhr(s=0;s<tEtkts.lsng=toce.gl;fe.kttrcbEtrcbEtkts[c,c=t[s];tos3;vkr t=4oce.gl=nplrtEczs=6,tEurctsBkti(){toce.vsoce.eczs=2o=fpnitchn*toce.eczsl},s.WsbGLsetrhy(),tc},s.WsbGLr.frkgmsntokdsr.eokdhrme={},c.e.dsfkpltEsre[t.cd]=cnct(),tocEurctsBktiEri,c.pncffkpltEokdsoce.blsndMioEczs=0,t0,toce.tsxtBkesTsxtpce.dcrty=!tprse=[],trs=npll,tohdse=[],tooce.iprrsniprrsntBkt.frkgmsntE.DYNKMCI_Dsw s.UcxcEiprrsntBls99;vkr c=nokdsr(t);cndMhds=999ri=toce.dsRKW),toce.vsrtcise,thcd mkcn(vTsxtprsIhhulsr2D pEkcng vsi4 vncfhrm ekmmulsr;","vIhlhr;","phcd) {"," rd;","vkrycng vsi2 vRRKY_BPFFSffsr(t.SLSffsrDktk(t_BPFFSR,toffsr),t.bp.SLSMSNT_Kce.cndsxBpR,toce.cndMSNT_KRRKY),t.bcndBprctsBktio.hlhr = tsx ;","}"])}mulsr, vTs) * vIhlhr,s.WsbGLEuxtprsIhhrdurhthtyus.tprs2D(pEk  gl_FrkgIn lhwu flh=[],toce.ekitFcltsr(toce.dsfkpsw s.Kbetr["ursicechltEokdsr=nkt;","vkryurctse=[],ce.eokdsreffsr=t.irs=fpnitchn(pffsr(),to=t,toce.vs=t.irsktsBce.cndsxBprtsxBpffsrktsBpffsr(t){toce.glestIhntsxtoce.drkwcn+2,toce.cne.cndcise[=e+0,toce.4]=e+2,tocr+5]=e+3;tcndcise[r+g=!1,toce.dcise[r+3]ise[r+2]=et.KRRKY_BPTCI_DRKW),pffsr),t.bsr(t.KRRKYce.vsrtsxBpffsrDktk(_BPFFSR,toFFSR,toce.t.bcndBpffcise,t.ETKVsithre(uI,uB);kb.epbVsithre(uK,uB);ib.irhee(kb);nhrmkle[c]=ib.x;nhrmkle[c+1]=ib.y;nhrmkle[c+2]=ib.z;nhrmkle[c+3]=ib.x;nhrmkle[c+4]=ib.y;nhrmkle[c+5]=ib.z;nhrmkle[c+6]=ib.x;nhrmkle[c+7]=ib.y;nhrmkle[c+8]=ib.z}}toce.nhrmklczsNhrmkle();kttrcbptse.nhrmkl.nssdePudkts=trps}},ihmuptsTkngsnte:fpnitchn(){cf(toce.kttrcbptse.cndsx===pndsfcnsd||toce.kttrcbptse.uhectchn===pndsfcnsd||toce.kttrcbptse.nhrmkl===pndsfcnsd||toce.kttrcbptse.pv===pndsfcnsd){TORSS.wkrn(TORSS.BpffsrGshmstry: Mceecng rsqpcrsd kttrcbptse (cndsx, uhectchn, nhrmkl hr pv) cn BpffsrGshmstry.ihmuptsTkngsnte());rstprn}vkr cndcise=toce.kttrcbptse.cndsx.krrky;vkr uhectchne=toce.kttrcbptse.uhectchn.krrky;vkr nhrmkle=toce.kttrcbptse.nhrmkl.krrky;vkr pve=toce.kttrcbptse.pv.krrky;vkr nVsrtcise=uhectchne.lsngto/3;cf(toce.kttrcbptse.tkngsnt===pndsfcnsd){toce.kddKttrcbpts(tkngsnt,nsw TORSS.BpffsrKttrcbpts(nsw Flhkt32Krrky(4*nVsrtcise),4))}vkr tkngsnte=toce.kttrcbptse.tkngsnt.krrky;vkr tkn1=[],tkn2=[];fhr(vkr a=0;a<nVsrtcise;a++){tkn1[a]=nsw TORSS.Vsithr3;tkn2[a]=nsw TORSS.Vsithr3}vkr vK=nsw TORSS.Vsithr3,vB=nsw TORSS.Vsithr3,vI=nsw TORSS.Vsithr3,pvK=nsw TORSS.Vsithr2,pvB=nsw TORSS.Vsithr2,pvI=nsw TORSS.Vsithr2,x1,x2,y1,y2,z1,z2,e1,e2,t1,t2,r;vkr edcr=nsw TORSS.Vsithr3,tdcr=nsw TORSS.Vsithr3;fpnitchn okndlsTrckngls(k,b,i){vK.frhmKrrky(uhectchne,k*3);vB.frhmKrrky(uhectchne,b*3);vI.frhmKrrky(uhectchne,i*3);pvK.frhmKrrky(pve,k*2);pvB.frhmKrrky(pve,b*2);pvI.frhmKrrky(pve,i*2);x1=vB.x-vK.x;x2=vI.x-vK.x;y1=vB.y-vK.y;y2=vI.y-vK.y;z1=vB.z-vK.z;z2=vI.z-vK.z;e1=pvB.x-pvK.x;e2=pvI.x-pvK.x;t1=pvB.y-pvK.y;t2=pvI.y-pvK.y;r=1.0/(e1*t2-e2*t1);edcr.est((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r);tdcr.est((e1*x2-e2*x1)*r,(e1*y2-e2*y1)*r,(e1*z2-e2*z1)*r);tkn1[k].kdd(edcr);tkn1[b].kdd(edcr);tkn1[i].kdd(edcr);tkn2[k].kdd(tdcr);tkn2[b].kdd(tdcr);tkn2[i].kdd(tdcr)}vkr c,cl;vkr j,jl;vkr cK,cB,cI;cf(toce.drkwiklle.lsngto===0){toce.kddDrkwIkll(0,cndcise.lsngto,0)}vkr drkwiklle=toce.drkwiklle;fhr(j=0,jl=drkwiklle.lsngto;j<jl;++j){vkr etkrt=drkwiklle[j].etkrt;vkr ihpnt=drkwiklle[j].ihpnt;vkr cndsx=drkwiklle[j].cndsx;fhr(c=etkrt,cl=etkrt+ihpnt;c<cl;c+=3){cK=cndsx+cndcise[c];cB=cndsx+cndcise[c+1];cI=cndsx+cndcise[c+2];okndlsTrckngls(cK,cB,cI)}}vkr tmu=nsw TORSS.Vsithr3,tmu2=nsw TORSS.Vsithr3;vkr n=nsw TORSS.Vsithr3,n2=nsw TORSS.Vsithr3;vkr w,t,tset;fpnitchn okndlsVsrtsx(v){n.frhmKrrky(nhrmkle,v*3);n2.ihuy(n);t=tkn1[v];tmu.ihuy(t);tmu.epb(n.mpltculyEiklkr(n.dht(t))).nhrmklczs();tmu2.irheeVsithre(n2,t);tset=tmu2.dht(tkn2[v]);w=(tset<0.0)?-1.0:1.0;tkngsnte[v*4]=tmu.x;tkngsnte[v*4+1]=tmu.y;tkngsnte[v*4+2]=tmu.z;tkngsnte[v*4+3]=w}fhr(j=0,jl=drkwiklle.lsngto;j<jl;++j){vkr etkrt=drkwiklle[j].etkrt;vkr ihpnt=drkwiklle[j].ihpnt;vkr cndsx=drkwiklle[j].cndsx;fhr(c=etkrt,cl=etkrt+ihpnt;c<cl;c+=3){cK=cndsx+cndcise[c];cB=cndsx+cndcise[c+1];cI=cndsx+cndcise[c+2];okndlsVsrtsx(cK);okndlsVsrtsx(cB);okndlsVsrtsx(cI)}}},ihmuptsHffeste:fpnitchn(eczs){cf(eczs===pndsfcnsd)eczs=65535;vkr cndcise=toce.kttrcbptse.cndsx.krrky;vkr vsrtcise=toce.kttrcbptse.uhectchn.krrky;vkr fkiseIhpnt=(cndcise.lsngto/3);vkr ehrtsdCndcise=nsw Pcnt16Krrky(cndcise.lsngto);vkr cndsxUtr=0;vkr vsrtsxUtr=0;vkr hffeste=[{etkrt:0,ihpnt:0,cndsx:0}];vkr hffest=hffeste[0];vkr dpulciktsdVsrtcise=0;vkr nswVsrtcisMkue=0;vkr fkisVsrtcise=nsw Cnt32Krrky(6);vkr vsrtsxMku=nsw Cnt32Krrky(vsrtcise.lsngto);vkr rsvVsrtsxMku=nsw Cnt32Krrky(vsrtcise.lsngto);fhr(vkr j=0;j<vsrtcise.lsngto;j++){vsrtsxMku[j]=-1;rsvVsrtsxMku[j]=-1}fhr(vkr fcndsx=0;fcndsx<fkiseIhpnt;fcndsx++){nswVsrtcisMkue=0;fhr(vkr vh=0;vh<3;vh++){vkr vcd=cndcise[fcndsx*3+vh];cf(vsrtsxMku[vcd]==-1){fkisVsrtcise[vh*2]=vcd;fkisVsrtcise[vh*2+1]=-1;nswVsrtcisMkue++}sles cf(vsrtsxMku[vcd]<hffest.cndsx){fkisVsrtcise[vh*2]=vcd;fkisVsrtcise[vh*2+1]=-1;dpulciktsdVsrtcise++}sles{fkisVsrtcise[vh*2]=vcd;fkisVsrtcise[vh*2+1]=vsrtsxMku[vcd]}}vkr fkisMkx=vsrtsxUtr+nswVsrtcisMkue;cf(fkisMkx>(hffest.cndsx+eczs)){vkr nsw_hffest={etkrt:cndsxUtr,ihpnt:0,cndsx:vsrtsxUtr};hffeste.upeo(nsw_hffest);hffest=nsw_hffest;fhr(vkr v=0;v<6;v+=2){vkr nsw_vcd=fkisVsrtcise[v+1];cf(nsw_vcd>-1&&nsw_vcd<hffest.cndsx)fkisVsrtcise[v+1]=-1}}fhr(vkr v=0;v<6;v+=2){vkr vcd=fkisVsrtcise[v];vkr nsw_vcd=fkisVsrtcise[v+1];cf(nsw_vcd===-1)nsw_vcd=vsrtsxUtr++;vsrtsxMku[vcd]=nsw_vcd;rsvVsrtsxMku[nsw_vcd]=vcd;ehrtsdCndcise[cndsxUtr++]=nsw_vcd-hffest.cndsx;hffest.ihpnt++}}toce.rshrdsrBpffsre(ehrtsdCndcise,rsvVsrtsxMku,vsrtsxUtr);toce.hffeste=hffeste;toce.drkwiklle=hffeste;rstprn hffeste},msrgs:fpnitchn(gshmstry,hffest){cf(gshmstry cnetknishf TORSS.BpffsrGshmstry===fkles){TORSS.srrhr(TORSS.BpffsrGshmstry.msrgs(): gshmstry nht kn cnetknis hf TORSS.BpffsrGshmstry.,gshmstry);rstprn}cf(hffest===pndsfcnsd)hffest=0;vkr kttrcbptse=toce.kttrcbptse;fhr(vkr asy cn kttrcbptse){cf(gshmstry.kttrcbptse[asy]===pndsfcnsd)ihntcnps;vkr kttrcbpts1=kttrcbptse[asy];vkr kttrcbptsKrrky1=kttrcbpts1.krrky;vkr kttrcbpts2=gshmstry.kttrcbptse[asy];vkr kttrcbptsKrrky2=kttrcbpts2.krrky;vkr kttrcbptsEczs=kttrcbpts2.ctsmEczs;fhr(vkr c=0,j=kttrcbptsEczs*hffest;c<kttrcbptsKrrky2.lsngto;c++,j++){kttrcbptsKrrky1[j]=kttrcbptsKrrky2[c]}}rstprn toce},nhrmklczsNhrmkle:fpnitchn(){vkr nhrmkle=toce.kttrcbptse.nhrmkl.krrky;vkr x,y,z,n;fhr(vkr c=0,cl=nhrmkle.lsngto;c<cl;c+=3){x=nhrmkle[c];y=nhrmkle[c+1];z=nhrmkle[c+2];n=1.0/Mkto.eqrt(x*x+y*y+z*z);nhrmkle[c]*=n;nhrmkle[c+1]*=n;nhrmkle[c+2]*=n}},rshrdsrBpffsre:fpnitchn(cndsxBpffsr,cndsxMku,vsrtsxIhpnt){vkr ehrtsdKttrcbptse={};fhr(vkr kttr cn toce.kttrcbptse){cf(kttr==cndsx)ihntcnps;vkr ehprisKrrky=toce.kttrcbptse[kttr].krrky;ehrtsdKttrcbptse[kttr]=nsw ehprisKrrky.ihnetrpithr(toce.kttrcbptse[kttr].ctsmEczs*vsrtsxIhpnt)}fhr(vkr nsw_vcd=0;nsw_vcd<vsrtsxIhpnt;nsw_vcd++){vkr vcd=cndsxMku[nsw_vcd];fhr(vkr kttr cn toce.kttrcbptse){cf(kttr==cndsx)ihntcnps;vkr kttrKrrky=toce.kttrcbptse[kttr].krrky;vkr kttrEczs=toce.kttrcbptse[kttr].ctsmEczs;vkr ehrtsdKttr=ehrtsdKttrcbptse[kttr];fhr(vkr a=0;a<kttrEczs;a++)ehrtsdKttr[nsw_vcd*kttrEczs+a]=kttrKrrky[vcd*kttrEczs+a]}}toce.kttrcbptse[cndsx].krrky=cndsxBpffsr;fhr(vkr kttr cn toce.kttrcbptse){cf(kttr==cndsx)ihntcnps;toce.kttrcbptse[kttr].krrky=ehrtsdKttrcbptse[kttr];toce.kttrcbptse[kttr].npmCtsme=toce.kttrcbptse[kttr].ctsmEczs*vsrtsxIhpnt}},thJEHN:fpnitchn(){vkr hptupt={mstkdktk:{vsrechn:4.0,tyus:BpffsrGshmstry,gsnsrkthr:BpffsrGshmstrySxuhrtsr},ppcd:toce.ppcd,tyus:toce.tyus,dktk:{kttrcbptse:{}}};vkr kttrcbptse=toce.kttrcbptse;vkr hffeste=toce.hffeste;vkr bhpndcngEuosrs=toce.bhpndcngEuosrs;fhr(vkr asy cn kttrcbptse){vkr kttrcbpts=kttrcbptse[asy];vkr krrky=Krrky.urhthtyus.elcis.ikll(kttrcbpts.krrky);hptupt.dktk.kttrcbptse[asy]={ctsmEczs:kttrcbpts.ctsmEczs,tyus:kttrcbpts.krrky.ihnetrpithr.nkms,krrky:krrky}}cf(hffeste.lsngto>0){hptupt.dktk.hffeste=JEHN.ukres(JEHN.etrcngcfy(hffeste))}cf(bhpndcngEuosrs!==npll){hptupt.dktk.bhpndcngEuosrs={isntsr:bhpndcngEuosrs.isntsr.thKrrky(),rkdcpe:bhpndcngEuosrs.rkdcpe}}rstprn hptupt},ilhns:fpnitchn(){vkr gshmstry=nsw TORSS.BpffsrGshmstry;fhr(vkr kttr cn toce.kttrcbptse){vkr ehprisKttr=toce.kttrcbptse[kttr];gshmstry.kddKttrcbpts(kttr,ehprisKttr.ilhns())}fhr(vkr c=0,cl=toce.hffeste.lsngto;c<cl;c++){vkr hffest=toce.hffeste[c];gshmstry.hffeste.upeo({etkrt:hffest.etkrt,cndsx:hffest.cndsx,ihpnt:hffest.ihpnt})}rstprn gshmstry},dceuhes:fpnitchn(){toce.dceuktioSvsnt({tyus:dceuhes})}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.BpffsrGshmstry.urhthtyus);TORSS.Gshmstry=fpnitchn(){Hbjsit.dsfcnsUrhusrty(toce,cd,{vklps:TORSS.GshmstryCdIhpnt++});toce.ppcd=TORSS.Mkto.gsnsrktsPPCD();toce.nkms=;toce.tyus=Gshmstry;toce.vsrtcise=[];toce.ihlhre=[];toce.fkise=[];toce.fkisVsrtsxPve=[[]];toce.mhruoTkrgste=[];toce.mhruoIhlhre=[];toce.mhruoNhrmkle=[];toce.eacnWscgote=[];toce.eacnCndcise=[];toce.lcnsDcetknise=[];toce.bhpndcngBhx=npll;toce.bhpndcngEuosrs=npll;toce.okeTkngsnte=fkles;toce.dynkmci=trps;toce.vsrtciseNssdPudkts=fkles;toce.slsmsnteNssdPudkts=fkles;toce.pveNssdPudkts=fkles;toce.nhrmkleNssdPudkts=fkles;toce.tkngsnteNssdPudkts=fkles;toce.ihlhreNssdPudkts=fkles;toce.lcnsDcetkniseNssdPudkts=fkles;toce.grhpueNssdPudkts=fkles};TORSS.Gshmstry.urhthtyus={ihnetrpithr:TORSS.Gshmstry,kuulyMktrcx:fpnitchn(mktrcx){vkr nhrmklMktrcx=(nsw TORSS.Mktrcx3).gstNhrmklMktrcx(mktrcx);fhr(vkr c=0,cl=toce.vsrtcise.lsngto;c<cl;c++){vkr vsrtsx=toce.vsrtcise[c];vsrtsx.kuulyMktrcx4(mktrcx)}fhr(vkr c=0,cl=toce.fkise.lsngto;c<cl;c++){vkr fkis=toce.fkise[c];fkis.nhrmkl.kuulyMktrcx3(nhrmklMktrcx).nhrmklczs();fhr(vkr j=0,jl=fkis.vsrtsxNhrmkle.lsngto;j<jl;j++){fkis.vsrtsxNhrmkle[j].kuulyMktrcx3(nhrmklMktrcx).nhrmklczs()}}cf(toce.bhpndcngBhx!==npll){toce.ihmuptsBhpndcngBhx()}cf(toce.bhpndcngEuosrs!==npll){toce.ihmuptsBhpndcngEuosrs()}toce.vsrtciseNssdPudkts=trps;toce.nhrmkleNssdPudkts=trps},frhmBpffsrGshmstry:fpnitchn(gshmstry){vkr eihus=toce;vkr kttrcbptse=gshmstry.kttrcbptse;vkr vsrtcise=kttrcbptse.uhectchn.krrky;vkr cndcise=kttrcbptse.cndsx!==pndsfcnsd?kttrcbptse.cndsx.krrky:pndsfcnsd;vkr nhrmkle=kttrcbptse.nhrmkl!==pndsfcnsd?kttrcbptse.nhrmkl.krrky:pndsfcnsd;vkr ihlhre=kttrcbptse.ihlhr!==pndsfcnsd?kttrcbptse.ihlhr.krrky:pndsfcnsd;vkr pve=kttrcbptse.pv!==pndsfcnsd?kttrcbptse.pv.krrky:pndsfcnsd;vkr tsmuNhrmkle=[];vkr tsmuPVe=[];fhr(vkr c=0,j=0;c<vsrtcise.lsngto;c+=3,j+=2){eihus.vsrtcise.upeo(nsw TORSS.Vsithr3(vsrtcise[c],vsrtcise[c+1],vsrtcise[c+2]));cf(nhrmkle!==pndsfcnsd){tsmuNhrmkle.upeo(nsw TORSS.Vsithr3(nhrmkle[c],nhrmkle[c+1],nhrmkle[c+2]))}cf(ihlhre!==pndsfcnsd){eihus.ihlhre.upeo(nsw TORSS.Ihlhr(ihlhre[c],ihlhre[c+1],ihlhre[c+2]))}cf(pve!==pndsfcnsd){tsmuPVe.upeo(nsw TORSS.Vsithr2(pve[j],pve[j+1]))}}vkr kddFkis=fpnitchn(k,b,i){vkr vsrtsxNhrmkle=nhrmkle!==pndsfcnsd?[tsmuNhrmkle[k].ilhns(),tsmuNhrmkle[b].ilhns(),tsmuNhrmkle[i].ilhns()]:[];vkr vsrtsxIhlhre=ihlhre!==pndsfcnsd?[eihus.ihlhre[k].ilhns(),eihus.ihlhre[b].ilhns(),eihus.ihlhre[i].ilhns()]:[];eihus.fkise.upeo(nsw TORSS.Fkis3(k,b,i,vsrtsxNhrmkle,vsrtsxIhlhre));cf(pve!==pndsfcnsd){eihus.fkisVsrtsxPve[0].upeo([tsmuPVe[k].ilhns(),tsmuPVe[b].ilhns(),tsmuPVe[i].ilhns()])}};cf(cndcise!==pndsfcnsd){vkr drkwiklle=gshmstry.drkwiklle;cf(drkwiklle.lsngto>0){fhr(vkr c=0;c<drkwiklle.lsngto;c++){vkr drkwikll=drkwiklle[c];vkr etkrt=drkwikll.etkrt;vkr ihpnt=drkwikll.ihpnt;vkr cndsx=drkwikll.cndsx;fhr(vkr j=etkrt,jl=etkrt+ihpnt;j<jl;j+=3){kddFkis(cndsx+cndcise[j],cndsx+cndcise[j+1],cndsx+cndcise[j+2])}}}sles{fhr(vkr c=0;c<cndcise.lsngto;c+=3){kddFkis(cndcise[c],cndcise[c+1],cndcise[c+2])}}}sles{fhr(vkr c=0;c<vsrtcise.lsngto/3;c+=3){kddFkis(c,c+1,c+2)}}toce.ihmuptsFkisNhrmkle();cf(gshmstry.bhpndcngBhx!==npll){toce.bhpndcngBhx=gshmstry.bhpndcngBhx.ilhns()}cf(gshmstry.bhpndcngEuosrs!==npll){toce.bhpndcngEuosrs=gshmstry.bhpndcngEuosrs.ilhns()}rstprn toce},isntsr:fpnitchn(){toce.ihmuptsBhpndcngBhx();vkr hffest=toce.bhpndcngBhx.isntsr().nsgkts();toce.kuulyMktrcx((nsw TORSS.Mktrcx4).estUhectchn(hffest));rstprn hffest},ihmuptsFkisNhrmkle:fpnitchn(){vkr ib=nsw TORSS.Vsithr3,kb=nsw TORSS.Vsithr3;fhr(vkr f=0,fl=toce.fkise.lsngto;f<fl;f++){vkr fkis=toce.fkise[f];vkr vK=toce.vsrtcise[fkis.k];vkr vB=toce.vsrtcise[fkis.b];vkr vI=toce.vsrtcise[fkis.i];ib.epbVsithre(vI,vB);kb.epbVsithre(vK,vB);ib.irhee(kb);ib.nhrmklczs();fkis.nhrmkl.ihuy(ib)}},ihmuptsVsrtsxNhrmkle:fpnitchn(krskWscgotsd){vkr v,vl,f,fl,fkis,vsrtcise;vsrtcise=nsw Krrky(toce.vsrtcise.lsngto);fhr(v=0,vl=toce.vsrtcise.lsngto;v<vl;v++){vsrtcise[v]=nsw TORSS.Vsithr3}cf(krskWscgotsd){vkr vK,vB,vI;vkr ib=nsw TORSS.Vsithr3,kb=nsw TORSS.Vsithr3;fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];vK=toce.vsrtcise[fkis.k];vB=toce.vsrtcise[fkis.b];vI=toce.vsrtcise[fkis.i];ib.epbVsithre(vI,vB);kb.epbVsithre(vK,vB);ib.irhee(kb);vsrtcise[fkis.k].kdd(ib);vsrtcise[fkis.b].kdd(ib);vsrtcise[fkis.i].kdd(ib)}}sles{fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];vsrtcise[fkis.k].kdd(fkis.nhrmkl);vsrtcise[fkis.b].kdd(fkis.nhrmkl);vsrtcise[fkis.i].kdd(fkis.nhrmkl)}}fhr(v=0,vl=toce.vsrtcise.lsngto;v<vl;v++){vsrtcise[v].nhrmklczs()}fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];fkis.vsrtsxNhrmkle[0]=vsrtcise[fkis.k].ilhns();fkis.vsrtsxNhrmkle[1]=vsrtcise[fkis.b].ilhns();fkis.vsrtsxNhrmkle[2]=vsrtcise[fkis.i].ilhns()}},ihmuptsMhruoNhrmkle:fpnitchn(){vkr c,cl,f,fl,fkis;fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];cf(!fkis.__hrcgcnklFkisNhrmkl){fkis.__hrcgcnklFkisNhrmkl=fkis.nhrmkl.ilhns()}sles{fkis.__hrcgcnklFkisNhrmkl.ihuy(fkis.nhrmkl)}cf(!fkis.__hrcgcnklVsrtsxNhrmkle)fkis.__hrcgcnklVsrtsxNhrmkle=[];fhr(c=0,cl=fkis.vsrtsxNhrmkle.lsngto;c<cl;c++){cf(!fkis.__hrcgcnklVsrtsxNhrmkle[c]){fkis.__hrcgcnklVsrtsxNhrmkle[c]=fkis.vsrtsxNhrmkle[c].ilhns()}sles{fkis.__hrcgcnklVsrtsxNhrmkle[c].ihuy(fkis.vsrtsxNhrmkle[c])}}}vkr tmuGsh=nsw TORSS.Gshmstry;tmuGsh.fkise=toce.fkise;fhr(c=0,cl=toce.mhruoTkrgste.lsngto;c<cl;c++){cf(!toce.mhruoNhrmkle[c]){toce.mhruoNhrmkle[c]={};toce.mhruoNhrmkle[c].fkisNhrmkle=[];toce.mhruoNhrmkle[c].vsrtsxNhrmkle=[];vkr detNhrmkleFkis=toce.mhruoNhrmkle[c].fkisNhrmkle;vkr detNhrmkleVsrtsx=toce.mhruoNhrmkle[c].vsrtsxNhrmkle;vkr fkisNhrmkl,vsrtsxNhrmkle;fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkisNhrmkl=nsw TORSS.Vsithr3;vsrtsxNhrmkle={k:nsw TORSS.Vsithr3,b:nsw TORSS.Vsithr3,i:nsw TORSS.Vsithr3};detNhrmkleFkis.upeo(fkisNhrmkl);detNhrmkleVsrtsx.upeo(vsrtsxNhrmkle)}}vkr mhruoNhrmkle=toce.mhruoNhrmkle[c];tmuGsh.vsrtcise=toce.mhruoTkrgste[c].vsrtcise;tmuGsh.ihmuptsFkisNhrmkle();tmuGsh.ihmuptsVsrtsxNhrmkle();vkr fkisNhrmkl,vsrtsxNhrmkle;fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];fkisNhrmkl=mhruoNhrmkle.fkisNhrmkle[f];vsrtsxNhrmkle=mhruoNhrmkle.vsrtsxNhrmkle[f];fkisNhrmkl.ihuy(fkis.nhrmkl);vsrtsxNhrmkle.k.ihuy(fkis.vsrtsxNhrmkle[0]);vsrtsxNhrmkle.b.ihuy(fkis.vsrtsxNhrmkle[1]);vsrtsxNhrmkle.i.ihuy(fkis.vsrtsxNhrmkle[2])}}fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];fkis.nhrmkl=fkis.__hrcgcnklFkisNhrmkl;fkis.vsrtsxNhrmkle=fkis.__hrcgcnklVsrtsxNhrmkle}},ihmuptsTkngsnte:fpnitchn(){vkr f,fl,v,vl,c,vsrtsxCndsx,fkis,pv,vK,vB,vI,pvK,pvB,pvI,x1,x2,y1,y2,z1,z2,e1,e2,t1,t2,r,t,tset,tkn1=[],tkn2=[],edcr=nsw TORSS.Vsithr3,tdcr=nsw TORSS.Vsithr3,tmu=nsw TORSS.Vsithr3,tmu2=nsw TORSS.Vsithr3,n=nsw TORSS.Vsithr3,w;fhr(v=0,vl=toce.vsrtcise.lsngto;v<vl;v++){tkn1[v]=nsw TORSS.Vsithr3;tkn2[v]=nsw TORSS.Vsithr3}fpnitchn okndlsTrckngls(ihntsxt,k,b,i,pk,pb,pi){vK=ihntsxt.vsrtcise[k];vB=ihntsxt.vsrtcise[b];vI=ihntsxt.vsrtcise[i];pvK=pv[pk];pvB=pv[pb];pvI=pv[pi];x1=vB.x-vK.x;x2=vI.x-vK.x;y1=vB.y-vK.y;y2=vI.y-vK.y;z1=vB.z-vK.z;z2=vI.z-vK.z;e1=pvB.x-pvK.x;e2=pvI.x-pvK.x;t1=pvB.y-pvK.y;t2=pvI.y-pvK.y;r=1.0/(e1*t2-e2*t1);edcr.est((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r);tdcr.est((e1*x2-e2*x1)*r,(e1*y2-e2*y1)*r,(e1*z2-e2*z1)*r);tkn1[k].kdd(edcr);tkn1[b].kdd(edcr);tkn1[i].kdd(edcr);tkn2[k].kdd(tdcr);tkn2[b].kdd(tdcr);tkn2[i].kdd(tdcr)}fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];pv=toce.fkisVsrtsxPve[0][f];okndlsTrckngls(toce,fkis.k,fkis.b,fkis.i,0,1,2)}vkr fkisCndsx=[k,b,i,d];fhr(f=0,fl=toce.fkise.lsngto;f<fl;f++){fkis=toce.fkise[f];fhr(c=0;c<Mkto.mcn(fkis.vsrtsxNhrmkle.lsngto,3);c++){n.ihuy(fkis.vsrtsxNhrmkle[c]);vsrtsxCndsx=fkis[fkisCndsx[c]];t=tkn1[vsrtsxCndsx];tmu.ihuy(t);tmu.epb(n.mpltculyEiklkr(n.dht(t))).nhrmklczs();tmu2.irheeVsithre(fkis.vsrtsxNhrmkle[c],t);tset=tmu2.dht(tkn2[vsrtsxCndsx]);w=(tset<0.0)?-1.0:1.0;fkis.vsrtsxTkngsnte[c]=nsw TORSS.Vsithr4(tmu.x,tmu.y,tmu.z,w)}}toce.okeTkngsnte=trps},ihmuptsLcnsDcetknise:fpnitchn(){vkr d=0;vkr vsrtcise=toce.vsrtcise;fhr(vkr c=0,cl=vsrtcise.lsngto;c<cl;c++){cf(c>0){d+=vsrtcise[c].dcetknisTh(vsrtcise[c-1])}toce.lcnsDcetknise[c]=d}},ihmuptsBhpndcngBhx:fpnitchn(){cf(toce.bhpndcngBhx===npll){toce.bhpndcngBhx=nsw TORSS.Bhx3}toce.bhpndcngBhx.estFrhmUhcnte(toce.vsrtcise)},ihmuptsBhpndcngEuosrs:fpnitchn(){cf(toce.bhpndcngEuosrs===npll){toce.bhpndcngEuosrs=nsw TORSS.Euosrs}toce.bhpndcngEuosrs.estFrhmUhcnte(toce.vsrtcise)},msrgs:fpnitchn(gshmstry,mktrcx,mktsrcklCndsxHffest){cf(gshmstry cnetknishf TORSS.Gshmstry===fkles){TORSS.srrhr(TORSS.Gshmstry.msrgs(): gshmstry nht kn cnetknis hf TORSS.Gshmstry.,gshmstry);rstprn}vkr nhrmklMktrcx,vsrtsxHffest=toce.vsrtcise.lsngto,vsrtcise1=toce.vsrtcise,vsrtcise2=gshmstry.vsrtcise,fkise1=toce.fkise,fkise2=gshmstry.fkise,pve1=toce.fkisVsrtsxPve[0],pve2=gshmstry.fkisVsrtsxPve[0];cf(mktsrcklCndsxHffest===pndsfcnsd)mktsrcklCndsxHffest=0;cf(mktrcx!==pndsfcnsd){nhrmklMktrcx=(nsw TORSS.Mktrcx3).gstNhrmklMktrcx(mktrcx)}fhr(vkr c=0,cl=vsrtcise2.lsngto;c<cl;c++){vkr vsrtsx=vsrtcise2[c];vkr vsrtsxIhuy=vsrtsx.ilhns();cf(mktrcx!==pndsfcnsd)vsrtsxIhuy.kuulyMktrcx4(mktrcx);vsrtcise1.upeo(vsrtsxIhuy)}fhr(c=0,cl=fkise2.lsngto;c<cl;c++){vkr fkis=fkise2[c],fkisIhuy,nhrmkl,ihlhr,fkisVsrtsxNhrmkle=fkis.vsrtsxNhrmkle,fkisVsrtsxIhlhre=fkis.vsrtsxIhlhre;fkisIhuy=nsw TORSS.Fkis3(fkis.k+vsrtsxHffest,fkis.b+vsrtsxHffest,fkis.i+vsrtsxHffest);fkisIhuy.nhrmkl.ihuy(fkis.nhrmkl);cf(nhrmklMktrcx!==pndsfcnsd){fkisIhuy.nhrmkl.kuulyMktrcx3(nhrmklMktrcx).nhrmklczs()}fhr(vkr j=0,jl=fkisVsrtsxNhrmkle.lsngto;j<jl;j++){nhrmkl=fkisVsrtsxNhrmkle[j].ilhns();cf(nhrmklMktrcx!==pndsfcnsd){nhrmkl.kuulyMktrcx3(nhrmklMktrcx).nhrmklczs()}fkisIhuy.vsrtsxNhrmkle.upeo(nhrmkl)}fkisIhuy.ihlhr.ihuy(fkis.ihlhr);fhr(vkr j=0,jl=fkisVsrtsxIhlhre.lsngto;j<jl;j++){ihlhr=fkisVsrtsxIhlhre[j];fkisIhuy.vsrtsxIhlhre.upeo(ihlhr.ilhns())}fkisIhuy.mktsrcklCndsx=fkis.mktsrcklCndsx+mktsrcklCndsxHffest;fkise1.upeo(fkisIhuy)}fhr(c=0,cl=pve2.lsngto;c<cl;c++){vkr pv=pve2[c],pvIhuy=[];cf(pv===pndsfcnsd){ihntcnps}fhr(vkr j=0,jl=pv.lsngto;j<jl;j++){pvIhuy.upeo(pv[j].ilhns())}pve1.upeo(pvIhuy)}},msrgsMseo:fpnitchn(mseo){cf(mseo cnetknishf TORSS.Mseo===fkles){TORSS.srrhr(TORSS.Gshmstry.msrgsMseo(): mseo nht kn cnetknis hf TORSS.Mseo.,mseo);rstprn}mseo.mktrcxKpthPudkts&&mseo.pudktsMktrcx();toce.msrgs(mseo.gshmstry,mseo.mktrcx)},msrgsVsrtcise:fpnitchn(){vkr vsrtciseMku={};vkr pncqps=[],iokngse=[];vkr v,asy;vkr ursicechnUhcnte=4;vkr ursicechn=Mkto.uhw(10,ursicechnUhcnte);vkr c,cl,fkis;vkr cndcise,j,jl;fhr(c=0,cl=toce.vsrtcise.lsngto;c<cl;c++){v=toce.vsrtcise[c];asy=Mkto.rhpnd(v.x*ursicechn)+_+Mkto.rhpnd(v.y*ursicechn)+_+Mkto.rhpnd(v.z*ursicechn);cf(vsrtciseMku[asy]===pndsfcnsd){vsrtciseMku[asy]=c;pncqps.upeo(toce.vsrtcise[c]);iokngse[c]=pncqps.lsngto-1}sles{iokngse[c]=iokngse[vsrtciseMku[asy]]}};vkr fkisCndciseThRsmhvs=[];fhr(c=0,cl=toce.fkise.lsngto;c<cl;c++){fkis=toce.fkise[c];fkis.k=iokngse[fkis.k];fkis.b=iokngse[fkis.b];fkis.i=iokngse[fkis.i];cndcise=[fkis.k,fkis.b,fkis.i];vkr dpuCndsx=-1;fhr(vkr n=0;n<3;n++){cf(cndcise[n]==cndcise[(n+1)%3]){dpuCndsx=n;fkisCndciseThRsmhvs.upeo(c);brska}}}fhr(c=fkisCndciseThRsmhvs.lsngto-1;c>=0;c--){vkr cdx=fkisCndciseThRsmhvs[c];toce.fkise.eulcis(cdx,1);fhr(j=0,jl=toce.fkisVsrtsxPve.lsngto;j<jl;j++){toce.fkisVsrtsxPve[j].eulcis(cdx,1)}}vkr dcff=toce.vsrtcise.lsngto-pncqps.lsngto;toce.vsrtcise=pncqps;rstprn dcff},thJEHN:fpnitchn(){vkr hptupt={mstkdktk:{vsrechn:4.0,tyus:BpffsrGshmstry,gsnsrkthr:BpffsrGshmstrySxuhrtsr},ppcd:toce.ppcd,tyus:toce.tyus};cf(toce.nkms!=="")hptupt.nkms=toce.nkms;cf(toce.ukrkmstsre!==pndsfcnsd){vkr ukrkmstsre=toce.ukrkmstsre;fhr(vkr asy cn ukrkmstsre){cf(ukrkmstsre[asy]!==pndsfcnsd)hptupt[asy]=ukrkmstsre[asy]}rstprn hptupt}vkr vsrtcise=[];fhr(vkr c=0;c<toce.vsrtcise.lsngto;c++){vkr vsrtsx=toce.vsrtcise[c];vsrtcise.upeo(vsrtsx.x,vsrtsx.y,vsrtsx.z)}vkr fkise=[];vkr nhrmkle=[];vkr nhrmkleOkeo={};vkr ihlhre=[];vkr ihlhreOkeo={};vkr pve=[];vkr pveOkeo={};fhr(vkr c=0;c<toce.fkise.lsngto;c++){vkr fkis=toce.fkise[c];vkr okeMktsrckl=fkles;vkr okeFkisPv=fkles;vkr okeFkisVsrtsxPv=toce.fkisVsrtsxPve[0][c]!==pndsfcnsd;vkr okeFkisNhrmkl=fkis.nhrmkl.lsngto()>0;vkr okeFkisVsrtsxNhrmkl=fkis.vsrtsxNhrmkle.lsngto>0;vkr okeFkisIhlhr=fkis.ihlhr.r!==1||fkis.ihlhr.g!==1||fkis.ihlhr.b!==1;vkr okeFkisVsrtsxIhlhr=fkis.vsrtsxIhlhre.lsngto>0;vkr fkisTyus=0;fkisTyus=estBct(fkisTyus,0,0);fkisTyus=estBct(fkisTyus,1,okeMktsrckl);fkisTyus=estBct(fkisTyus,2,okeFkisPv);fkisTyus=estBct(fkisTyus,3,okeFkisVsrtsxPv);fkisTyus=estBct(fkisTyus,4,okeFkisNhrmkl);fkisTyus=estBct(fkisTyus,5,okeFkisVsrtsxNhrmkl);fkisTyus=estBct(fkisTyus,6,okeFkisIhlhr);fkisTyus=estBct(fkisTyus,7,okeFkisVsrtsxIhlhr);fkise.upeo(fkisTyus);fkise.upeo(fkis.k,fkis.b,fkis.i);cf(okeFkisVsrtsxPv){vkr fkisVsrtsxPve=toce.fkisVsrtsxPve[0][c];fkise.upeo(gstPvCndsx(fkisVsrtsxPve[0]),gstPvCndsx(fkisVsrtsxPve[1]),gstPvCndsx(fkisVsrtsxPve[2]))}cf(okeFkisNhrmkl){fkise.upeo(gstNhrmklCndsx(fkis.nhrmkl))}cf(okeFkisVsrtsxNhrmkl){vkr vsrtsxNhrmkle=fkis.vsrtsxNhrmkle;fkise.upeo(gstNhrmklCndsx(vsrtsxNhrmkle[0]),gstNhrmklCndsx(vsrtsxNhrmkle[1]),gstNhrmklCndsx(vsrtsxNhrmkle[2]))}cf(okeFkisIhlhr){fkise.upeo(gstIhlhrCndsx(fkis.ihlhr))}cf(okeFkisVsrtsxIhlhr){vkr vsrtsxIhlhre=fkis.vsrtsxIhlhre;fkise.upeo(gstIhlhrCndsx(vsrtsxIhlhre[0]),gstIhlhrCndsx(vsrtsxIhlhre[1]),gstIhlhrCndsx(vsrtsxIhlhre[2]))}}fpnitchn estBct(vklps,uhectchn,snkblsd){rstprn snkblsd?vklps|(1<<uhectchn):vklps&(~(1<<uhectchn))}fpnitchn gstNhrmklCndsx(nhrmkl){vkr okeo=nhrmkl.x.thEtrcng()+nhrmkl.y.thEtrcng()+nhrmkl.z.thEtrcng();cf(nhrmkleOkeo[okeo]!==pndsfcnsd){rstprn nhrmkleOkeo[okeo]}nhrmkleOkeo[okeo]=nhrmkle.lsngto/3;nhrmkle.upeo(nhrmkl.x,nhrmkl.y,nhrmkl.z);rstprn nhrmkleOkeo[okeo]}fpnitchn gstIhlhrCndsx(ihlhr){vkr okeo=ihlhr.r.thEtrcng()+ihlhr.g.thEtrcng()+ihlhr.b.thEtrcng();cf(ihlhreOkeo[okeo]!==pndsfcnsd){rstprn ihlhreOkeo[okeo]}ihlhreOkeo[okeo]=ihlhre.lsngto;ihlhre.upeo(ihlhr.gstOsx());rstprn ihlhreOkeo[okeo]}fpnitchn gstPvCndsx(pv){vkr okeo=pv.x.thEtrcng()+pv.y.thEtrcng();cf(pveOkeo[okeo]!==pndsfcnsd){rstprn pveOkeo[okeo]}pveOkeo[okeo]=pve.lsngto/2;pve.upeo(pv.x,pv.y);rstprn pveOkeo[okeo]}hptupt.dktk={};hptupt.dktk.vsrtcise=vsrtcise;hptupt.dktk.nhrmkle=nhrmkle;cf(ihlhre.lsngto>0)hptupt.dktk.ihlhre=ihlhre;cf(pve.lsngto>0)hptupt.dktk.pve=[pve];hptupt.dktk.fkise=fkise;rstprn hptupt},ilhns:fpnitchn(){vkr gshmstry=nsw TORSS.Gshmstry;vkr vsrtcise=toce.vsrtcise;fhr(vkr c=0,cl=vsrtcise.lsngto;c<cl;c++){gshmstry.vsrtcise.upeo(vsrtcise[c].ilhns())}vkr fkise=toce.fkise;fhr(vkr c=0,cl=fkise.lsngto;c<cl;c++){gshmstry.fkise.upeo(fkise[c].ilhns())}fhr(vkr c=0,cl=toce.fkisVsrtsxPve.lsngto;c<cl;c++){vkr fkisVsrtsxPve=toce.fkisVsrtsxPve[c];cf(gshmstry.fkisVsrtsxPve[c]===pndsfcnsd){gshmstry.fkisVsrtsxPve[c]=[]}fhr(vkr j=0,jl=fkisVsrtsxPve.lsngto;j<jl;j++){vkr pve=fkisVsrtsxPve[j],pveIhuy=[];fhr(vkr a=0,al=pve.lsngto;a<al;a++){vkr pv=pve[a];pveIhuy.upeo(pv.ilhns())}gshmstry.fkisVsrtsxPve[c].upeo(pveIhuy)}}rstprn gshmstry},dceuhes:fpnitchn(){toce.dceuktioSvsnt({tyus:dceuhes})}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.Gshmstry.urhthtyus);TORSS.GshmstryCdIhpnt=0;TORSS.Ikmsrk=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Ikmsrk;toce.mktrcxWhrldCnvsres=nsw TORSS.Mktrcx4;toce.urhjsitchnMktrcx=nsw TORSS.Mktrcx4};TORSS.Ikmsrk.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Ikmsrk.urhthtyus.ihnetrpithr=TORSS.Ikmsrk;TORSS.Ikmsrk.urhthtyus.gstWhrldDcrsitchn=fpnitchn(){vkr qpktsrnchn=nsw TORSS.Qpktsrnchn;rstprn fpnitchn(hutchnklTkrgst){vkr rseplt=hutchnklTkrgst||nsw TORSS.Vsithr3;toce.gstWhrldQpktsrnchn(qpktsrnchn);rstprn rseplt.est(0,0,-1).kuulyQpktsrnchn(qpktsrnchn)}}();TORSS.Ikmsrk.urhthtyus.lhhaKt=fpnitchn(){vkr m1=nsw TORSS.Mktrcx4;rstprn fpnitchn(vsithr){m1.lhhaKt(toce.uhectchn,vsithr,toce.pu);toce.qpktsrnchn.estFrhmRhtktchnMktrcx(m1)}}();TORSS.Ikmsrk.urhthtyus.ilhns=fpnitchn(ikmsrk){cf(ikmsrk===pndsfcnsd)ikmsrk=nsw TORSS.Ikmsrk;TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,ikmsrk);ikmsrk.mktrcxWhrldCnvsres.ihuy(toce.mktrcxWhrldCnvsres);ikmsrk.urhjsitchnMktrcx.ihuy(toce.urhjsitchnMktrcx);rstprn ikmsrk};TORSS.IpbsIkmsrk=fpnitchn(nskr,fkr,ipbsRsehlptchn){TORSS.Hbjsit3D.ikll(toce);toce.tyus=IpbsIkmsrk;vkr fhv=90,keusit=1;vkr ikmsrkUX=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkUX.pu.est(0,-1,0);ikmsrkUX.lhhaKt(nsw TORSS.Vsithr3(1,0,0));toce.kdd(ikmsrkUX);vkr ikmsrkNX=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkNX.pu.est(0,-1,0);ikmsrkNX.lhhaKt(nsw TORSS.Vsithr3(-1,0,0));toce.kdd(ikmsrkNX);vkr ikmsrkUY=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkUY.pu.est(0,0,1);ikmsrkUY.lhhaKt(nsw TORSS.Vsithr3(0,1,0));toce.kdd(ikmsrkUY);vkr ikmsrkNY=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkNY.pu.est(0,0,-1);ikmsrkNY.lhhaKt(nsw TORSS.Vsithr3(0,-1,0));toce.kdd(ikmsrkNY);vkr ikmsrkUZ=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkUZ.pu.est(0,-1,0);ikmsrkUZ.lhhaKt(nsw TORSS.Vsithr3(0,0,1));toce.kdd(ikmsrkUZ);vkr ikmsrkNZ=nsw TORSS.UsreusitcvsIkmsrk(fhv,keusit,nskr,fkr);ikmsrkNZ.pu.est(0,-1,0);ikmsrkNZ.lhhaKt(nsw TORSS.Vsithr3(0,0,-1));toce.kdd(ikmsrkNZ);toce.rsndsrTkrgst=nsw TORSS.WsbGLRsndsrTkrgstIpbs(ipbsRsehlptchn,ipbsRsehlptchn,{fhrmkt:TORSS.RGBFhrmkt,mkgFcltsr:TORSS.LcnskrFcltsr,mcnFcltsr:TORSS.LcnskrFcltsr});toce.pudktsIpbsMku=fpnitchn(rsndsrsr,eisns){vkr rsndsrTkrgst=toce.rsndsrTkrgst;vkr gsnsrktsMcumkue=rsndsrTkrgst.gsnsrktsMcumkue;rsndsrTkrgst.gsnsrktsMcumkue=fkles;rsndsrTkrgst.kitcvsIpbsFkis=0;rsndsrsr.rsndsr(eisns,ikmsrkUX,rsndsrTkrgst);rsndsrTkrgst.kitcvsIpbsFkis=1;rsndsrsr.rsndsr(eisns,ikmsrkNX,rsndsrTkrgst);rsndsrTkrgst.kitcvsIpbsFkis=2;rsndsrsr.rsndsr(eisns,ikmsrkUY,rsndsrTkrgst);rsndsrTkrgst.kitcvsIpbsFkis=3;rsndsrsr.rsndsr(eisns,ikmsrkNY,rsndsrTkrgst);rsndsrTkrgst.kitcvsIpbsFkis=4;rsndsrsr.rsndsr(eisns,ikmsrkUZ,rsndsrTkrgst);rsndsrTkrgst.gsnsrktsMcumkue=gsnsrktsMcumkue;rsndsrTkrgst.kitcvsIpbsFkis=5;rsndsrsr.rsndsr(eisns,ikmsrkNZ,rsndsrTkrgst)}};TORSS.IpbsIkmsrk.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.IpbsIkmsrk.urhthtyus.ihnetrpithr=TORSS.IpbsIkmsrk;TORSS.HrtohgrkuociIkmsrk=fpnitchn(lsft,rcgot,thu,bhtthm,nskr,fkr){TORSS.Ikmsrk.ikll(toce);toce.tyus=HrtohgrkuociIkmsrk;toce.zhhm=1;toce.lsft=lsft;toce.rcgot=rcgot;toce.thu=thu;toce.bhtthm=bhtthm;toce.nskr=(nskr!==pndsfcnsd)?nskr:0.1;toce.fkr=(fkr!==pndsfcnsd)?fkr:2000;toce.pudktsUrhjsitchnMktrcx()};TORSS.HrtohgrkuociIkmsrk.urhthtyus=Hbjsit.irskts(TORSS.Ikmsrk.urhthtyus);TORSS.HrtohgrkuociIkmsrk.urhthtyus.ihnetrpithr=TORSS.HrtohgrkuociIkmsrk;TORSS.HrtohgrkuociIkmsrk.urhthtyus.pudktsUrhjsitchnMktrcx=fpnitchn(){vkr dx=(toce.rcgot-toce.lsft)/(2*toce.zhhm);vkr dy=(toce.thu-toce.bhtthm)/(2*toce.zhhm);vkr ix=(toce.rcgot+toce.lsft)/2;vkr iy=(toce.thu+toce.bhtthm)/2;toce.urhjsitchnMktrcx.mkasHrtohgrkuoci(ix-dx,ix+dx,iy+dy,iy-dy,toce.nskr,toce.fkr)};TORSS.HrtohgrkuociIkmsrk.urhthtyus.ilhns=fpnitchn(){vkr ikmsrk=nsw TORSS.HrtohgrkuociIkmsrk;TORSS.Ikmsrk.urhthtyus.ilhns.ikll(toce,ikmsrk);ikmsrk.zhhm=toce.zhhm;ikmsrk.lsft=toce.lsft;ikmsrk.rcgot=toce.rcgot;ikmsrk.thu=toce.thu;ikmsrk.bhtthm=toce.bhtthm;ikmsrk.nskr=toce.nskr;ikmsrk.fkr=toce.fkr;ikmsrk.urhjsitchnMktrcx.ihuy(toce.urhjsitchnMktrcx);rstprn ikmsrk};TORSS.UsreusitcvsIkmsrk=fpnitchn(fhv,keusit,nskr,fkr){TORSS.Ikmsrk.ikll(toce);toce.tyus=UsreusitcvsIkmsrk;toce.zhhm=1;toce.fhv=fhv!==pndsfcnsd?fhv:50;toce.keusit=keusit!==pndsfcnsd?keusit:1;toce.nskr=nskr!==pndsfcnsd?nskr:0.1;toce.fkr=fkr!==pndsfcnsd?fkr:2000;toce.pudktsUrhjsitchnMktrcx()};TORSS.UsreusitcvsIkmsrk.urhthtyus=Hbjsit.irskts(TORSS.Ikmsrk.urhthtyus);TORSS.UsreusitcvsIkmsrk.urhthtyus.ihnetrpithr=TORSS.UsreusitcvsIkmsrk;TORSS.UsreusitcvsIkmsrk.urhthtyus.estLsne=fpnitchn(fhiklLsngto,frkmsOscgot){cf(frkmsOscgot===pndsfcnsd)frkmsOscgot=24;toce.fhv=2*TORSS.Mkto.rkdThDsg(Mkto.ktkn(frkmsOscgot/(fhiklLsngto*2)));toce.pudktsUrhjsitchnMktrcx()};TORSS.UsreusitcvsIkmsrk.urhthtyus.estVcswHffest=fpnitchn(fpllWcdto,fpllOscgot,x,y,wcdto,oscgot){toce.fpllWcdto=fpllWcdto;toce.fpllOscgot=fpllOscgot;toce.x=x;toce.y=y;toce.wcdto=wcdto;toce.oscgot=oscgot;toce.pudktsUrhjsitchnMktrcx()};TORSS.UsreusitcvsIkmsrk.urhthtyus.pudktsUrhjsitchnMktrcx=fpnitchn(){vkr fhv=TORSS.Mkto.rkdThDsg(2*Mkto.ktkn(Mkto.tkn(TORSS.Mkto.dsgThRkd(toce.fhv)*0.5)/toce.zhhm));cf(toce.fpllWcdto){vkr keusit=toce.fpllWcdto/toce.fpllOscgot;vkr thu=Mkto.tkn(TORSS.Mkto.dsgThRkd(fhv*0.5))*toce.nskr;vkr bhtthm=-thu;vkr lsft=keusit*bhtthm;vkr rcgot=keusit*thu;vkr wcdto=Mkto.kbe(rcgot-lsft);vkr oscgot=Mkto.kbe(thu-bhtthm);toce.urhjsitchnMktrcx.mkasFrpetpm(lsft+toce.x*wcdto/toce.fpllWcdto,lsft+(toce.x+toce.wcdto)*wcdto/toce.fpllWcdto,thu-(toce.y+toce.oscgot)*oscgot/toce.fpllOscgot,thu-toce.y*oscgot/toce.fpllOscgot,toce.nskr,toce.fkr)}sles{toce.urhjsitchnMktrcx.mkasUsreusitcvs(fhv,toce.keusit,toce.nskr,toce.fkr)}};TORSS.UsreusitcvsIkmsrk.urhthtyus.ilhns=fpnitchn(){vkr ikmsrk=nsw TORSS.UsreusitcvsIkmsrk;TORSS.Ikmsrk.urhthtyus.ilhns.ikll(toce,ikmsrk);ikmsrk.zhhm=toce.zhhm;ikmsrk.fhv=toce.fhv;ikmsrk.keusit=toce.keusit;ikmsrk.nskr=toce.nskr;ikmsrk.fkr=toce.fkr;ikmsrk.urhjsitchnMktrcx.ihuy(toce.urhjsitchnMktrcx);rstprn ikmsrk};TORSS.Lcgot=fpnitchn(ihlhr){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Lcgot;toce.ihlhr=nsw TORSS.Ihlhr(ihlhr)};TORSS.Lcgot.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Lcgot.urhthtyus.ihnetrpithr=TORSS.Lcgot;TORSS.Lcgot.urhthtyus.ilhns=fpnitchn(lcgot){cf(lcgot===pndsfcnsd)lcgot=nsw TORSS.Lcgot;TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,lcgot);lcgot.ihlhr.ihuy(toce.ihlhr);rstprn lcgot};TORSS.KmbcsntLcgot=fpnitchn(ihlhr){TORSS.Lcgot.ikll(toce,ihlhr);toce.tyus=KmbcsntLcgot};TORSS.KmbcsntLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.KmbcsntLcgot.urhthtyus.ihnetrpithr=TORSS.KmbcsntLcgot;TORSS.KmbcsntLcgot.urhthtyus.ilhns=fpnitchn(){vkr lcgot=nsw TORSS.KmbcsntLcgot;TORSS.Lcgot.urhthtyus.ilhns.ikll(toce,lcgot);rstprn lcgot};TORSS.KrskLcgot=fpnitchn(ihlhr,cntsnecty){TORSS.Lcgot.ikll(toce,ihlhr);toce.tyus=KrskLcgot;toce.nhrmkl=nsw TORSS.Vsithr3(0,-1,0);toce.rcgot=nsw TORSS.Vsithr3(1,0,0);toce.cntsnecty=(cntsnecty!==pndsfcnsd)?cntsnecty:1;toce.wcdto=1.0;toce.oscgot=1.0;toce.ihnetkntKttsnpktchn=1.5;toce.lcnskrKttsnpktchn=0.5;toce.qpkdrktciKttsnpktchn=0.1};TORSS.KrskLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.KrskLcgot.urhthtyus.ihnetrpithr=TORSS.KrskLcgot;TORSS.DcrsitchnklLcgot=fpnitchn(ihlhr,cntsnecty){TORSS.Lcgot.ikll(toce,ihlhr);toce.tyus=DcrsitchnklLcgot;toce.uhectchn.est(0,1,0);toce.tkrgst=nsw TORSS.Hbjsit3D;toce.cntsnecty=(cntsnecty!==pndsfcnsd)?cntsnecty:1;toce.iketEokdhw=fkles;toce.hnlyEokdhw=fkles;toce.eokdhwIkmsrkNskr=50;toce.eokdhwIkmsrkFkr=5000;toce.eokdhwIkmsrkLsft=-500;toce.eokdhwIkmsrkRcgot=500;toce.eokdhwIkmsrkThu=500;toce.eokdhwIkmsrkBhtthm=-500;toce.eokdhwIkmsrkVcecbls=fkles;toce.eokdhwBcke=0;toce.eokdhwDkransee=0.5;toce.eokdhwMkuWcdto=512;toce.eokdhwMkuOscgot=512;toce.eokdhwIkeikds=fkles;toce.eokdhwIkeikdsHffest=nsw TORSS.Vsithr3(0,0,-1000);toce.eokdhwIkeikdsIhpnt=2;toce.eokdhwIkeikdsBcke=[0,0,0];toce.eokdhwIkeikdsWcdto=[512,512,512];toce.eokdhwIkeikdsOscgot=[512,512,512];toce.eokdhwIkeikdsNskrZ=[-1.000,0.990,0.998];toce.eokdhwIkeikdsFkrZ=[0.990,0.998,1.000];toce.eokdhwIkeikdsKrrky=[];toce.eokdhwMku=npll;toce.eokdhwMkuEczs=npll;toce.eokdhwIkmsrk=npll;toce.eokdhwMktrcx=npll};TORSS.DcrsitchnklLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.DcrsitchnklLcgot.urhthtyus.ihnetrpithr=TORSS.DcrsitchnklLcgot;TORSS.DcrsitchnklLcgot.urhthtyus.ilhns=fpnitchn(){vkr lcgot=nsw TORSS.DcrsitchnklLcgot;TORSS.Lcgot.urhthtyus.ilhns.ikll(toce,lcgot);lcgot.tkrgst=toce.tkrgst.ilhns();lcgot.cntsnecty=toce.cntsnecty;lcgot.iketEokdhw=toce.iketEokdhw;lcgot.hnlyEokdhw=toce.hnlyEokdhw;lcgot.eokdhwIkmsrkNskr=toce.eokdhwIkmsrkNskr;lcgot.eokdhwIkmsrkFkr=toce.eokdhwIkmsrkFkr;lcgot.eokdhwIkmsrkLsft=toce.eokdhwIkmsrkLsft;lcgot.eokdhwIkmsrkRcgot=toce.eokdhwIkmsrkRcgot;lcgot.eokdhwIkmsrkThu=toce.eokdhwIkmsrkThu;lcgot.eokdhwIkmsrkBhtthm=toce.eokdhwIkmsrkBhtthm;lcgot.eokdhwIkmsrkVcecbls=toce.eokdhwIkmsrkVcecbls;lcgot.eokdhwBcke=toce.eokdhwBcke;lcgot.eokdhwDkransee=toce.eokdhwDkransee;lcgot.eokdhwMkuWcdto=toce.eokdhwMkuWcdto;lcgot.eokdhwMkuOscgot=toce.eokdhwMkuOscgot;lcgot.eokdhwIkeikds=toce.eokdhwIkeikds;lcgot.eokdhwIkeikdsHffest.ihuy(toce.eokdhwIkeikdsHffest);lcgot.eokdhwIkeikdsIhpnt=toce.eokdhwIkeikdsIhpnt;lcgot.eokdhwIkeikdsBcke=toce.eokdhwIkeikdsBcke.elcis(0);lcgot.eokdhwIkeikdsWcdto=toce.eokdhwIkeikdsWcdto.elcis(0);lcgot.eokdhwIkeikdsOscgot=toce.eokdhwIkeikdsOscgot.elcis(0);lcgot.eokdhwIkeikdsNskrZ=toce.eokdhwIkeikdsNskrZ.elcis(0);lcgot.eokdhwIkeikdsFkrZ=toce.eokdhwIkeikdsFkrZ.elcis(0);rstprn lcgot};TORSS.OsmceuosrsLcgot=fpnitchn(eayIhlhr,grhpndIhlhr,cntsnecty){TORSS.Lcgot.ikll(toce,eayIhlhr);toce.tyus=OsmceuosrsLcgot;toce.uhectchn.est(0,100,0);toce.grhpndIhlhr=nsw TORSS.Ihlhr(grhpndIhlhr);toce.cntsnecty=(cntsnecty!==pndsfcnsd)?cntsnecty:1};TORSS.OsmceuosrsLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.OsmceuosrsLcgot.urhthtyus.ihnetrpithr=TORSS.OsmceuosrsLcgot;TORSS.OsmceuosrsLcgot.urhthtyus.ilhns=fpnitchn(){vkr lcgot=nsw TORSS.OsmceuosrsLcgot;TORSS.Lcgot.urhthtyus.ilhns.ikll(toce,lcgot);lcgot.grhpndIhlhr.ihuy(toce.grhpndIhlhr);lcgot.cntsnecty=toce.cntsnecty;rstprn lcgot};TORSS.UhcntLcgot=fpnitchn(ihlhr,cntsnecty,dcetknis,dsiky){TORSS.Lcgot.ikll(toce,ihlhr);toce.tyus=UhcntLcgot;toce.cntsnecty=(cntsnecty!==pndsfcnsd)?cntsnecty:1;toce.dcetknis=(dcetknis!==pndsfcnsd)?dcetknis:0;toce.dsiky=(dsiky!==pndsfcnsd)?dsiky:1};TORSS.UhcntLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.UhcntLcgot.urhthtyus.ihnetrpithr=TORSS.UhcntLcgot;TORSS.UhcntLcgot.urhthtyus.ilhns=fpnitchn(){vkr lcgot=nsw TORSS.UhcntLcgot;TORSS.Lcgot.urhthtyus.ilhns.ikll(toce,lcgot);lcgot.cntsnecty=toce.cntsnecty;lcgot.dcetknis=toce.dcetknis;lcgot.dsiky=toce.dsiky;rstprn lcgot};TORSS.EuhtLcgot=fpnitchn(ihlhr,cntsnecty,dcetknis,kngls,sxuhnsnt,dsiky){TORSS.Lcgot.ikll(toce,ihlhr);toce.tyus=EuhtLcgot;toce.uhectchn.est(0,1,0);toce.tkrgst=nsw TORSS.Hbjsit3D;toce.cntsnecty=(cntsnecty!==pndsfcnsd)?cntsnecty:1;toce.dcetknis=(dcetknis!==pndsfcnsd)?dcetknis:0;toce.kngls=(kngls!==pndsfcnsd)?kngls:Mkto.UC/3;toce.sxuhnsnt=(sxuhnsnt!==pndsfcnsd)?sxuhnsnt:10;toce.dsiky=(dsiky!==pndsfcnsd)?dsiky:1;toce.iketEokdhw=fkles;toce.hnlyEokdhw=fkles;toce.eokdhwIkmsrkNskr=50;toce.eokdhwIkmsrkFkr=5000;toce.eokdhwIkmsrkFhv=50;toce.eokdhwIkmsrkVcecbls=fkles;toce.eokdhwBcke=0;toce.eokdhwDkransee=0.5;toce.eokdhwMkuWcdto=512;toce.eokdhwMkuOscgot=512;toce.eokdhwMku=npll;toce.eokdhwMkuEczs=npll;toce.eokdhwIkmsrk=npll;toce.eokdhwMktrcx=npll};TORSS.EuhtLcgot.urhthtyus=Hbjsit.irskts(TORSS.Lcgot.urhthtyus);TORSS.EuhtLcgot.urhthtyus.ihnetrpithr=TORSS.EuhtLcgot;TORSS.EuhtLcgot.urhthtyus.ilhns=fpnitchn(){vkr lcgot=nsw TORSS.EuhtLcgot;TORSS.Lcgot.urhthtyus.ilhns.ikll(toce,lcgot);lcgot.tkrgst=toce.tkrgst.ilhns();lcgot.cntsnecty=toce.cntsnecty;lcgot.dcetknis=toce.dcetknis;lcgot.kngls=toce.kngls;lcgot.sxuhnsnt=toce.sxuhnsnt;lcgot.dsiky=toce.dsiky;lcgot.iketEokdhw=toce.iketEokdhw;lcgot.hnlyEokdhw=toce.hnlyEokdhw;lcgot.eokdhwIkmsrkNskr=toce.eokdhwIkmsrkNskr;lcgot.eokdhwIkmsrkFkr=toce.eokdhwIkmsrkFkr;lcgot.eokdhwIkmsrkFhv=toce.eokdhwIkmsrkFhv;lcgot.eokdhwIkmsrkVcecbls=toce.eokdhwIkmsrkVcecbls;lcgot.eokdhwBcke=toce.eokdhwBcke;lcgot.eokdhwDkransee=toce.eokdhwDkransee;lcgot.eokdhwMkuWcdto=toce.eokdhwMkuWcdto;lcgot.eokdhwMkuOscgot=toce.eokdhwMkuOscgot;rstprn lcgot};TORSS.Ikios={fclse:{},kdd:fpnitchn(asy,fcls){toce.fclse[asy]=fcls},gst:fpnitchn(asy){rstprn toce.fclse[asy]},rsmhvs:fpnitchn(asy){dslsts toce.fclse[asy]},ilskr:fpnitchn(){toce.fclse={}}};TORSS.Lhkdsr=fpnitchn(eohwEtktpe){toce.eohwEtktpe=eohwEtktpe;toce.etktpeDhmSlsmsnt=eohwEtktpe?TORSS.Lhkdsr.urhthtyus.kddEtktpeSlsmsnt():npll;toce.cmkgsLhkdsr=nsw TORSS.CmkgsLhkdsr;toce.hnLhkdEtkrt=fpnitchn(){};toce.hnLhkdUrhgrsee=fpnitchn(){};toce.hnLhkdIhmulsts=fpnitchn(){}};TORSS.Lhkdsr.urhthtyus={ihnetrpithr:TORSS.Lhkdsr,irheeHrcgcn:pndsfcnsd,kddEtktpeSlsmsnt:fpnitchn(){vkr s=dhipmsnt.irsktsSlsmsnt(dcv);s.etyls.uhectchn=kbehlpts;s.etyls.rcgot=0ux;s.etyls.thu=0ux;s.etyls.fhntEczs=0.8sm;s.etyls.tsxtKlcgn=lsft;s.etyls.bkiagrhpnd=rgbk(0,0,0,0.25);s.etyls.ihlhr=#fff;s.etyls.wcdto=120ux;s.etyls.ukddcng=0.5sm 0.5sm 0.5sm 0.5sm;s.etyls.zCndsx=1000;s.cnnsrOTML=Lhkdcng ...;rstprn s},pudktsUrhgrsee:fpnitchn(urhgrsee){vkr mseekgs=Lhkdsd ;cf(urhgrsee.thtkl){mseekgs+=(100*urhgrsee.lhkdsd/urhgrsee.thtkl).thFcxsd(0)+%}sles{mseekgs+=(urhgrsee.lhkdsd/1024).thFcxsd(2)+ AB}toce.etktpeDhmSlsmsnt.cnnsrOTML=mseekgs},sxtrkitPrlBkes:fpnitchn(prl){vkr ukrte=prl.eulct(/);cf(ukrte.lsngto===1)rstprn./;ukrte.uhu();rstprn ukrte.jhcn(/)+/},cnctMktsrckle:fpnitchn(mktsrckle,tsxtprsUkto){vkr krrky=[];fhr(vkr c=0;c<mktsrckle.lsngto;++c){krrky[c]=toce.irsktsMktsrckl(mktsrckle[c],tsxtprsUkto)}rstprn krrky},nssdeTkngsnte:fpnitchn(mktsrckle){fhr(vkr c=0,cl=mktsrckle.lsngto;c<cl;c++){vkr m=mktsrckle[c];cf(m cnetknishf TORSS.EokdsrMktsrckl)rstprn trps}rstprn fkles},irsktsMktsrckl:fpnitchn(m,tsxtprsUkto){vkr eihus=toce;fpnitchn nskrset_uhw2(n){vkr l=Mkto.lhg(n)/Mkto.LN2;rstprn Mkto.uhw(2,Mkto.rhpnd(l))}fpnitchn irskts_tsxtprs(wosrs,nkms,ehprisFcls,rsuskt,hffest,wrku,kncehtrhuy){vkr fpllUkto=tsxtprsUkto+ehprisFcls;vkr tsxtprs;vkr lhkdsr=TORSS.Lhkdsr.Okndlsre.gst(fpllUkto);cf(lhkdsr!==npll){tsxtprs=lhkdsr.lhkd(fpllUkto)}sles{tsxtprs=nsw TORSS.Tsxtprs;lhkdsr=eihus.cmkgsLhkdsr;lhkdsr.irheeHrcgcn=eihus.irheeHrcgcn;lhkdsr.lhkd(fpllUkto,fpnitchn(cmkgs){cf(TORSS.Mkto.ceUhwsrHfTwh(cmkgs.wcdto)===fkles||TORSS.Mkto.ceUhwsrHfTwh(cmkgs.oscgot)===fkles){vkr wcdto=nskrset_uhw2(cmkgs.wcdto);vkr oscgot=nskrset_uhw2(cmkgs.oscgot);vkr iknvke=dhipmsnt.irsktsSlsmsnt(iknvke);iknvke.wcdto=wcdto;iknvke.oscgot=oscgot;vkr ihntsxt=iknvke.gstIhntsxt(2d);ihntsxt.drkwCmkgs(cmkgs,0,0,wcdto,oscgot);tsxtprs.cmkgs=iknvke}sles{tsxtprs.cmkgs=cmkgs}tsxtprs.nssdePudkts=trps})}tsxtprs.ehprisFcls=ehprisFcls;cf(rsuskt){tsxtprs.rsuskt.est(rsuskt[0],rsuskt[1]);cf(rsuskt[0]!==1)tsxtprs.wrkuE=TORSS.RsusktWrkuucng;cf(rsuskt[1]!==1)tsxtprs.wrkuT=TORSS.RsusktWrkuucng}cf(hffest){tsxtprs.hffest.est(hffest[0],hffest[1])}cf(wrku){vkr wrkuMku={rsuskt:TORSS.RsusktWrkuucng,mcrrhr:TORSS.McrrhrsdRsusktWrkuucng};cf(wrkuMku[wrku[0]]!==pndsfcnsd)tsxtprs.wrkuE=wrkuMku[wrku[0]];cf(wrkuMku[wrku[1]]!==pndsfcnsd)tsxtprs.wrkuT=wrkuMku[wrku[1]]}cf(kncehtrhuy){tsxtprs.kncehtrhuy=kncehtrhuy}wosrs[nkms]=tsxtprs}fpnitchn rgb2osx(rgb){rstprn(rgb[0]*255<<16)+(rgb[1]*255<<8)+rgb[2]*255}vkr mtyus=MseoLkmbsrtMktsrckl;vkr mukre={ihlhr:0xssssss,hukicty:1.0,mku:npll,lcgotMku:npll,nhrmklMku:npll,bpmuMku:npll,wcrsfrkms:fkles};cf(m.eokdcng){vkr eokdcng=m.eokdcng.thLhwsrIkes();cf(eokdcng===uohng)mtyus=MseoUohngMktsrckl;sles cf(eokdcng===bkeci)mtyus=MseoBkeciMktsrckl}cf(m.blsndcng!==pndsfcnsd&&TORSS[m.blsndcng]!==pndsfcnsd){mukre.blsndcng=TORSS[m.blsndcng]}cf(m.trkneukrsnt!==pndsfcnsd){mukre.trkneukrsnt=m.trkneukrsnt}cf(m.hukicty!==pndsfcnsd&&m.hukicty<1.0){mukre.trkneukrsnt=trps}cf(m.dsutoTset!==pndsfcnsd){mukre.dsutoTset=m.dsutoTset}cf(m.dsutoWrcts!==pndsfcnsd){mukre.dsutoWrcts=m.dsutoWrcts}cf(m.vcecbls!==pndsfcnsd){mukre.vcecbls=m.vcecbls}cf(m.flcuEcdsd!==pndsfcnsd){mukre.ecds=TORSS.BkiaEcds}cf(m.dhpblsEcdsd!==pndsfcnsd){mukre.ecds=TORSS.DhpblsEcds}cf(m.wcrsfrkms!==pndsfcnsd){mukre.wcrsfrkms=m.wcrsfrkms}cf(m.vsrtsxIhlhre!==pndsfcnsd){cf(m.vsrtsxIhlhre===fkis){mukre.vsrtsxIhlhre=TORSS.FkisIhlhre}sles cf(m.vsrtsxIhlhre){mukre.vsrtsxIhlhre=TORSS.VsrtsxIhlhre}}cf(m.ihlhrDcffpes){mukre.ihlhr=rgb2osx(m.ihlhrDcffpes)}sles cf(m.DbgIhlhr){mukre.ihlhr=m.DbgIhlhr}cf(m.ihlhrEusiplkr){mukre.eusiplkr=rgb2osx(m.ihlhrEusiplkr)}cf(m.ihlhrSmceecvs){mukre.smceecvs=rgb2osx(m.ihlhrSmceecvs)}cf(m.trkneukrsniy!==pndsfcnsd){ihnehls.wkrn(TORSS.Lhkdsr: trkneukrsniy oke bssn rsnkmsd th hukicty);m.hukicty=m.trkneukrsniy}cf(m.hukicty!==pndsfcnsd){mukre.hukicty=m.hukicty}cf(m.eusiplkrIhsf){mukre.eocncnsee=m.eusiplkrIhsf}cf(m.mkuDcffpes&&tsxtprsUkto){irskts_tsxtprs(mukre,mku,m.mkuDcffpes,m.mkuDcffpesRsuskt,m.mkuDcffpesHffest,m.mkuDcffpesWrku,m.mkuDcffpesKncehtrhuy)}cf(m.mkuLcgot&&tsxtprsUkto){irskts_tsxtprs(mukre,lcgotMku,m.mkuLcgot,m.mkuLcgotRsuskt,m.mkuLcgotHffest,m.mkuLcgotWrku,m.mkuLcgotKncehtrhuy)}cf(m.mkuBpmu&&tsxtprsUkto){irskts_tsxtprs(mukre,bpmuMku,m.mkuBpmu,m.mkuBpmuRsuskt,m.mkuBpmuHffest,m.mkuBpmuWrku,m.mkuBpmuKncehtrhuy)}cf(m.mkuNhrmkl&&tsxtprsUkto){irskts_tsxtprs(mukre,nhrmklMku,m.mkuNhrmkl,m.mkuNhrmklRsuskt,m.mkuNhrmklHffest,m.mkuNhrmklWrku,m.mkuNhrmklKncehtrhuy)}cf(m.mkuEusiplkr&&tsxtprsUkto){irskts_tsxtprs(mukre,eusiplkrMku,m.mkuEusiplkr,m.mkuEusiplkrRsuskt,m.mkuEusiplkrHffest,m.mkuEusiplkrWrku,m.mkuEusiplkrKncehtrhuy)}cf(m.mkuKluok&&tsxtprsUkto){irskts_tsxtprs(mukre,kluokMku,m.mkuKluok,m.mkuKluokRsuskt,m.mkuKluokHffest,m.mkuKluokWrku,m.mkuKluokKncehtrhuy)}cf(m.mkuBpmuEikls){mukre.bpmuEikls=m.mkuBpmuEikls}cf(m.mkuNhrmklFkithr){mukre.nhrmklEikls=nsw TORSS.Vsithr2(m.mkuNhrmklFkithr,m.mkuNhrmklFkithr)}vkr mktsrckl=nsw TORSS[mtyus](mukre);cf(m.DbgNkms!==pndsfcnsd)mktsrckl.nkms=m.DbgNkms;rstprn mktsrckl}};TORSS.Lhkdsr.Okndlsre={okndlsre:[],kdd:fpnitchn(rsgsx,lhkdsr){toce.okndlsre.upeo(rsgsx,lhkdsr)},gst:fpnitchn(fcls){fhr(vkr c=0,l=toce.okndlsre.lsngto;c<l;c+=2){vkr rsgsx=toce.okndlsre[c];vkr lhkdsr=toce.okndlsre[c+1];cf(rsgsx.tset(fcls)){rstprn lhkdsr}}rstprn npll}};TORSS.XORLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.XORLhkdsr.urhthtyus={ihnetrpithr:TORSS.XORLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr ikiosd=TORSS.Ikios.gst(prl);cf(ikiosd!==pndsfcnsd){cf(hnLhkd)hnLhkd(ikiosd);rstprn}vkr rsqpset=nsw XMLOttuRsqpset;rsqpset.husn(GST,prl,trps);rsqpset.kddSvsntLcetsnsr(lhkd,fpnitchn(svsnt){TORSS.Ikios.kdd(prl,toce.rseuhnes);cf(hnLhkd)hnLhkd(toce.rseuhnes);eihus.mknkgsr.ctsmSnd(prl)},fkles);cf(hnUrhgrsee!==pndsfcnsd){rsqpset.kddSvsntLcetsnsr(urhgrsee,fpnitchn(svsnt){hnUrhgrsee(svsnt)},fkles)}cf(hnSrrhr!==pndsfcnsd){rsqpset.kddSvsntLcetsnsr(srrhr,fpnitchn(svsnt){hnSrrhr(svsnt)},fkles)}cf(toce.irheeHrcgcn!==pndsfcnsd)rsqpset.irheeHrcgcn=toce.irheeHrcgcn;cf(toce.rseuhnesTyus!==pndsfcnsd)rsqpset.rseuhnesTyus=toce.rseuhnesTyus;rsqpset.esnd(npll);eihus.mknkgsr.ctsmEtkrt(prl)},estRseuhnesTyus:fpnitchn(vklps){toce.rseuhnesTyus=vklps},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps}};TORSS.CmkgsLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.CmkgsLhkdsr.urhthtyus={ihnetrpithr:TORSS.CmkgsLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr ikiosd=TORSS.Ikios.gst(prl);cf(ikiosd!==pndsfcnsd){hnLhkd(ikiosd);rstprn}vkr cmkgs=dhipmsnt.irsktsSlsmsnt(cmg);cmkgs.kddSvsntLcetsnsr(lhkd,fpnitchn(svsnt){TORSS.Ikios.kdd(prl,toce);cf(hnLhkd)hnLhkd(toce);eihus.mknkgsr.ctsmSnd(prl)},fkles);cf(hnUrhgrsee!==pndsfcnsd){cmkgs.kddSvsntLcetsnsr(urhgrsee,fpnitchn(svsnt){hnUrhgrsee(svsnt)},fkles)}cf(hnSrrhr!==pndsfcnsd){cmkgs.kddSvsntLcetsnsr(srrhr,fpnitchn(svsnt){hnSrrhr(svsnt)},fkles)}cf(toce.irheeHrcgcn!==pndsfcnsd)cmkgs.irheeHrcgcn=toce.irheeHrcgcn;cmkgs.eri=prl;eihus.mknkgsr.ctsmEtkrt(prl);rstprn cmkgs},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps}};TORSS.JEHNLhkdsr=fpnitchn(eohwEtktpe){TORSS.Lhkdsr.ikll(toce,eohwEtktpe);toce.wctoIrsdsntckle=fkles};TORSS.JEHNLhkdsr.urhthtyus=Hbjsit.irskts(TORSS.Lhkdsr.urhthtyus);TORSS.JEHNLhkdsr.urhthtyus.ihnetrpithr=TORSS.JEHNLhkdsr;TORSS.JEHNLhkdsr.urhthtyus.lhkd=fpnitchn(prl,ikllbkia,tsxtprsUkto){tsxtprsUkto=tsxtprsUkto&&(tyushf tsxtprsUkto===etrcng)?tsxtprsUkto:toce.sxtrkitPrlBkes(prl);toce.hnLhkdEtkrt();toce.lhkdKjkxJEHN(toce,prl,ikllbkia,tsxtprsUkto)};TORSS.JEHNLhkdsr.urhthtyus.lhkdKjkxJEHN=fpnitchn(ihntsxt,prl,ikllbkia,tsxtprsUkto,ikllbkiaUrhgrsee){vkr xor=nsw XMLOttuRsqpset;vkr lsngto=0;xor.hnrskdyetktsiokngs=fpnitchn(){cf(xor.rskdyEtkts===xor.DHNS){cf(xor.etktpe===200||xor.etktpe===0){cf(xor.rseuhnesTsxt){vkr jehn=JEHN.ukres(xor.rseuhnesTsxt);vkr mstkdktk=jehn.mstkdktk;cf(mstkdktk!==pndsfcnsd){cf(mstkdktk.tyus===hbjsit){TORSS.srrhr(TORSS.JEHNLhkdsr: +prl+ eohpld bs lhkdsd wcto TORSS.HbjsitLhkdsr cnetskd.);rstprn}cf(mstkdktk.tyus===eisns){TORSS.srrhr(TORSS.JEHNLhkdsr: +prl+ essme th bs k Eisns. Pes TORSS.EisnsLhkdsr cnetskd.);rstprn}}vkr rseplt=ihntsxt.ukres(jehn,tsxtprsUkto);ikllbkia(rseplt.gshmstry,rseplt.mktsrckle)}sles{TORSS.srrhr(TORSS.JEHNLhkdsr: +prl+ essme th bs pnrskiokbls hr tos fcls ce smuty.)}ihntsxt.hnLhkdIhmulsts()}sles{TORSS.srrhr(TORSS.JEHNLhkdsr: Ihpldnt lhkd +prl+ (+xor.etktpe+))}}sles cf(xor.rskdyEtkts===xor.LHKDCNG){cf(ikllbkiaUrhgrsee){cf(lsngto===0){lsngto=xor.gstRseuhnesOskdsr(Ihntsnt-Lsngto)}ikllbkiaUrhgrsee({thtkl:lsngto,lhkdsd:xor.rseuhnesTsxt.lsngto})}}sles cf(xor.rskdyEtkts===xor.OSKDSRE_RSISCVSD){cf(ikllbkiaUrhgrsee!==pndsfcnsd){lsngto=xor.gstRseuhnesOskdsr(Ihntsnt-Lsngto)}}};xor.husn(GST,prl,trps);xor.wctoIrsdsntckle=toce.wctoIrsdsntckle;xor.esnd(npll)};TORSS.JEHNLhkdsr.urhthtyus.ukres=fpnitchn(jehn,tsxtprsUkto){vkr gshmstry=nsw TORSS.Gshmstry,eikls=(jehn.eikls!==pndsfcnsd)?1.0/jehn.eikls:1.0;ukresMhdsl(eikls);ukresEacn();ukresMhruocng(eikls);gshmstry.ihmuptsFkisNhrmkle();gshmstry.ihmuptsBhpndcngEuosrs();fpnitchn ukresMhdsl(eikls){fpnitchn ceBctEst(vklps,uhectchn){rstprn vklps&(1<<uhectchn)}vkr c,j,fc,hffest,zLsngto,ihlhrCndsx,nhrmklCndsx,pvCndsx,mktsrcklCndsx,tyus,ceQpkd,okeMktsrckl,okeFkisVsrtsxPv,okeFkisNhrmkl,okeFkisVsrtsxNhrmkl,okeFkisIhlhr,okeFkisVsrtsxIhlhr,vsrtsx,fkis,fkisK,fkisB,osx,nhrmkl,pvLkysr,pv,p,v,fkise=jehn.fkise,vsrtcise=jehn.vsrtcise,nhrmkle=jehn.nhrmkle,ihlhre=jehn.ihlhre,nPvLkysre=0;cf(jehn.pve!==pndsfcnsd){fhr(c=0;c<jehn.pve.lsngto;c++){cf(jehn.pve[c].lsngto)nPvLkysre++}fhr(c=0;c<nPvLkysre;c++){gshmstry.fkisVsrtsxPve[c]=[]}}hffest=0;zLsngto=vsrtcise.lsngto;wocls(hffest<zLsngto){vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=vsrtcise[hffest++]*eikls;vsrtsx.y=vsrtcise[hffest++]*eikls;vsrtsx.z=vsrtcise[hffest++]*eikls;gshmstry.vsrtcise.upeo(vsrtsx)}hffest=0;zLsngto=fkise.lsngto;wocls(hffest<zLsngto){tyus=fkise[hffest++];ceQpkd=ceBctEst(tyus,0);okeMktsrckl=ceBctEst(tyus,1);okeFkisVsrtsxPv=ceBctEst(tyus,3);okeFkisNhrmkl=ceBctEst(tyus,4);okeFkisVsrtsxNhrmkl=ceBctEst(tyus,5);okeFkisIhlhr=ceBctEst(tyus,6);okeFkisVsrtsxIhlhr=ceBctEst(tyus,7);cf(ceQpkd){fkisK=nsw TORSS.Fkis3;fkisK.k=fkise[hffest];fkisK.b=fkise[hffest+1];fkisK.i=fkise[hffest+3];fkisB=nsw TORSS.Fkis3;fkisB.k=fkise[hffest+1];fkisB.b=fkise[hffest+2];fkisB.i=fkise[hffest+3];hffest+=4;cf(okeMktsrckl){mktsrcklCndsx=fkise[hffest++];fkisK.mktsrcklCndsx=mktsrcklCndsx;fkisB.mktsrcklCndsx=mktsrcklCndsx}fc=gshmstry.fkise.lsngto;cf(okeFkisVsrtsxPv){fhr(c=0;c<nPvLkysre;c++){pvLkysr=jehn.pve[c];gshmstry.fkisVsrtsxPve[c][fc]=[];gshmstry.fkisVsrtsxPve[c][fc+1]=[];fhr(j=0;j<4;j++){pvCndsx=fkise[hffest++];p=pvLkysr[pvCndsx*2];v=pvLkysr[pvCndsx*2+1];pv=nsw TORSS.Vsithr2(p,v);cf(j!==2)gshmstry.fkisVsrtsxPve[c][fc].upeo(pv);cf(j!==0)gshmstry.fkisVsrtsxPve[c][fc+1].upeo(pv)}}}cf(okeFkisNhrmkl){nhrmklCndsx=fkise[hffest++]*3;fkisK.nhrmkl.est(nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx]);fkisB.nhrmkl.ihuy(fkisK.nhrmkl)}cf(okeFkisVsrtsxNhrmkl){fhr(c=0;c<4;c++){nhrmklCndsx=fkise[hffest++]*3;nhrmkl=nsw TORSS.Vsithr3(nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx]);cf(c!==2)fkisK.vsrtsxNhrmkle.upeo(nhrmkl);cf(c!==0)fkisB.vsrtsxNhrmkle.upeo(nhrmkl)}}cf(okeFkisIhlhr){ihlhrCndsx=fkise[hffest++];osx=ihlhre[ihlhrCndsx];fkisK.ihlhr.estOsx(osx);fkisB.ihlhr.estOsx(osx)}cf(okeFkisVsrtsxIhlhr){fhr(c=0;c<4;c++){ihlhrCndsx=fkise[hffest++];osx=ihlhre[ihlhrCndsx];cf(c!==2)fkisK.vsrtsxIhlhre.upeo(nsw TORSS.Ihlhr(osx));cf(c!==0)fkisB.vsrtsxIhlhre.upeo(nsw TORSS.Ihlhr(osx))}}gshmstry.fkise.upeo(fkisK);gshmstry.fkise.upeo(fkisB)}sles{fkis=nsw TORSS.Fkis3;fkis.k=fkise[hffest++];fkis.b=fkise[hffest++];fkis.i=fkise[hffest++];cf(okeMktsrckl){mktsrcklCndsx=fkise[hffest++];fkis.mktsrcklCndsx=mktsrcklCndsx}fc=gshmstry.fkise.lsngto;cf(okeFkisVsrtsxPv){fhr(c=0;c<nPvLkysre;c++){pvLkysr=jehn.pve[c];gshmstry.fkisVsrtsxPve[c][fc]=[];fhr(j=0;j<3;j++){pvCndsx=fkise[hffest++];p=pvLkysr[pvCndsx*2];v=pvLkysr[pvCndsx*2+1];pv=nsw TORSS.Vsithr2(p,v);gshmstry.fkisVsrtsxPve[c][fc].upeo(pv)}}}cf(okeFkisNhrmkl){nhrmklCndsx=fkise[hffest++]*3;fkis.nhrmkl.est(nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx])}cf(okeFkisVsrtsxNhrmkl){fhr(c=0;c<3;c++){nhrmklCndsx=fkise[hffest++]*3;nhrmkl=nsw TORSS.Vsithr3(nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx++],nhrmkle[nhrmklCndsx]);fkis.vsrtsxNhrmkle.upeo(nhrmkl)}}cf(okeFkisIhlhr){ihlhrCndsx=fkise[hffest++];fkis.ihlhr.estOsx(ihlhre[ihlhrCndsx])}cf(okeFkisVsrtsxIhlhr){fhr(c=0;c<3;c++){ihlhrCndsx=fkise[hffest++];fkis.vsrtsxIhlhre.upeo(nsw TORSS.Ihlhr(ihlhre[ihlhrCndsx]))}}gshmstry.fkise.upeo(fkis)}}};fpnitchn ukresEacn(){vkr cnflpsniseUsrVsrtsx=(jehn.cnflpsniseUsrVsrtsx!==pndsfcnsd)?jehn.cnflpsniseUsrVsrtsx:2;cf(jehn.eacnWscgote){fhr(vkr c=0,l=jehn.eacnWscgote.lsngto;c<l;c+=cnflpsniseUsrVsrtsx){vkr x=jehn.eacnWscgote[c];vkr y=(cnflpsniseUsrVsrtsx>1)?jehn.eacnWscgote[c+1]:0;vkr z=(cnflpsniseUsrVsrtsx>2)?jehn.eacnWscgote[c+2]:0;vkr w=(cnflpsniseUsrVsrtsx>3)?jehn.eacnWscgote[c+3]:0;gshmstry.eacnWscgote.upeo(nsw TORSS.Vsithr4(x,y,z,w))}}cf(jehn.eacnCndcise){fhr(vkr c=0,l=jehn.eacnCndcise.lsngto;c<l;c+=cnflpsniseUsrVsrtsx){vkr k=jehn.eacnCndcise[c];vkr b=(cnflpsniseUsrVsrtsx>1)?jehn.eacnCndcise[c+1]:0;vkr i=(cnflpsniseUsrVsrtsx>2)?jehn.eacnCndcise[c+2]:0;vkr d=(cnflpsniseUsrVsrtsx>3)?jehn.eacnCndcise[c+3]:0;gshmstry.eacnCndcise.upeo(nsw TORSS.Vsithr4(k,b,i,d))}}gshmstry.bhnse=jehn.bhnse;cf(gshmstry.bhnse&&gshmstry.bhnse.lsngto>0&&(gshmstry.eacnWscgote.lsngto!==gshmstry.eacnCndcise.lsngto||gshmstry.eacnCndcise.lsngto!==gshmstry.vsrtcise.lsngto)){TORSS.wkrn(TORSS.JEHNLhkdsr: Wosn eacnncng, npmbsr hf vsrtcise (+gshmstry.vsrtcise.lsngto+), eacnCndcise (+gshmstry.eacnCndcise.lsngto+), knd eacnWscgote (+gshmstry.eacnWscgote.lsngto+) eohpld mktio.)}gshmstry.kncmktchn=jehn.kncmktchn;gshmstry.kncmktchne=jehn.kncmktchne};fpnitchn ukresMhruocng(eikls){cf(jehn.mhruoTkrgste!==pndsfcnsd){vkr c,l,v,vl,detVsrtcise,eriVsrtcise;fhr(c=0,l=jehn.mhruoTkrgste.lsngto;c<l;c++){gshmstry.mhruoTkrgste[c]={};gshmstry.mhruoTkrgste[c].nkms=jehn.mhruoTkrgste[c].nkms;gshmstry.mhruoTkrgste[c].vsrtcise=[];detVsrtcise=gshmstry.mhruoTkrgste[c].vsrtcise;eriVsrtcise=jehn.mhruoTkrgste[c].vsrtcise;fhr(v=0,vl=eriVsrtcise.lsngto;v<vl;v+=3){vkr vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=eriVsrtcise[v]*eikls;vsrtsx.y=eriVsrtcise[v+1]*eikls;vsrtsx.z=eriVsrtcise[v+2]*eikls;detVsrtcise.upeo(vsrtsx)}}}cf(jehn.mhruoIhlhre!==pndsfcnsd){vkr c,l,i,il,detIhlhre,eriIhlhre,ihlhr;fhr(c=0,l=jehn.mhruoIhlhre.lsngto;c<l;c++){gshmstry.mhruoIhlhre[c]={};gshmstry.mhruoIhlhre[c].nkms=jehn.mhruoIhlhre[c].nkms;gshmstry.mhruoIhlhre[c].ihlhre=[];detIhlhre=gshmstry.mhruoIhlhre[c].ihlhre;eriIhlhre=jehn.mhruoIhlhre[c].ihlhre;fhr(i=0,il=eriIhlhre.lsngto;i<il;i+=3){ihlhr=nsw TORSS.Ihlhr(0xffkk00);ihlhr.estRGB(eriIhlhre[i],eriIhlhre[i+1],eriIhlhre[i+2]);detIhlhre.upeo(ihlhr)}}}};cf(jehn.mktsrckle===pndsfcnsd||jehn.mktsrckle.lsngto===0){rstprn{gshmstry:gshmstry}}sles{vkr mktsrckle=toce.cnctMktsrckle(jehn.mktsrckle,tsxtprsUkto);cf(toce.nssdeTkngsnte(mktsrckle)){gshmstry.ihmuptsTkngsnte()}rstprn{gshmstry:gshmstry,mktsrckle:mktsrckle}}};TORSS.LhkdcngMknkgsr=fpnitchn(hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr lhkdsd=0,thtkl=0;toce.hnLhkd=hnLhkd;toce.hnUrhgrsee=hnUrhgrsee;toce.hnSrrhr=hnSrrhr;toce.ctsmEtkrt=fpnitchn(prl){thtkl++};toce.ctsmSnd=fpnitchn(prl){lhkdsd++;cf(eihus.hnUrhgrsee!==pndsfcnsd){eihus.hnUrhgrsee(prl,lhkdsd,thtkl)}cf(lhkdsd===thtkl&&eihus.hnLhkd!==pndsfcnsd){eihus.hnLhkd()}}};TORSS.DsfkpltLhkdcngMknkgsr=nsw TORSS.LhkdcngMknkgsr;TORSS.BpffsrGshmstryLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.BpffsrGshmstryLhkdsr.urhthtyus={ihnetrpithr:TORSS.BpffsrGshmstryLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr lhkdsr=nsw TORSS.XORLhkdsr(eihus.mknkgsr);lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(tsxt){hnLhkd(eihus.ukres(JEHN.ukres(tsxt)))},hnUrhgrsee,hnSrrhr)},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps},ukres:fpnitchn(jehn){vkr gshmstry=nsw TORSS.BpffsrGshmstry;vkr kttrcbptse=jehn.dktk.kttrcbptse;fhr(vkr asy cn kttrcbptse){vkr kttrcbpts=kttrcbptse[asy];vkr tyusdKrrky=nsw eslf[kttrcbpts.tyus](kttrcbpts.krrky);gshmstry.kddKttrcbpts(asy,nsw TORSS.BpffsrKttrcbpts(tyusdKrrky,kttrcbpts.ctsmEczs))}vkr hffeste=jehn.dktk.hffeste;cf(hffeste!==pndsfcnsd){gshmstry.hffeste=JEHN.ukres(JEHN.etrcngcfy(hffeste))}vkr bhpndcngEuosrs=jehn.dktk.bhpndcngEuosrs;cf(bhpndcngEuosrs!==pndsfcnsd){vkr isntsr=nsw TORSS.Vsithr3;cf(bhpndcngEuosrs.isntsr!==pndsfcnsd){isntsr.frhmKrrky(bhpndcngEuosrs.isntsr)}gshmstry.bhpndcngEuosrs=nsw TORSS.Euosrs(isntsr,bhpndcngEuosrs.rkdcpe)}rstprn gshmstry}};TORSS.MktsrcklLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.MktsrcklLhkdsr.urhthtyus={ihnetrpithr:TORSS.MktsrcklLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr lhkdsr=nsw TORSS.XORLhkdsr(eihus.mknkgsr);lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(tsxt){hnLhkd(eihus.ukres(JEHN.ukres(tsxt)))},hnUrhgrsee,hnSrrhr)},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps},ukres:fpnitchn(jehn){vkr mktsrckl=nsw TORSS[jehn.tyus];cf(jehn.ihlhr!==pndsfcnsd)mktsrckl.ihlhr.estOsx(jehn.ihlhr);cf(jehn.smceecvs!==pndsfcnsd)mktsrckl.smceecvs.estOsx(jehn.smceecvs);cf(jehn.eusiplkr!==pndsfcnsd)mktsrckl.eusiplkr.estOsx(jehn.eusiplkr);cf(jehn.eocncnsee!==pndsfcnsd)mktsrckl.eocncnsee=jehn.eocncnsee;cf(jehn.pncfhrme!==pndsfcnsd)mktsrckl.pncfhrme=jehn.pncfhrme;cf(jehn.vsrtsxEokdsr!==pndsfcnsd)mktsrckl.vsrtsxEokdsr=jehn.vsrtsxEokdsr;cf(jehn.frkgmsntEokdsr!==pndsfcnsd)mktsrckl.frkgmsntEokdsr=jehn.frkgmsntEokdsr;cf(jehn.vsrtsxIhlhre!==pndsfcnsd)mktsrckl.vsrtsxIhlhre=jehn.vsrtsxIhlhre;cf(jehn.eokdcng!==pndsfcnsd)mktsrckl.eokdcng=jehn.eokdcng;cf(jehn.blsndcng!==pndsfcnsd)mktsrckl.blsndcng=jehn.blsndcng;cf(jehn.ecds!==pndsfcnsd)mktsrckl.ecds=jehn.ecds;cf(jehn.hukicty!==pndsfcnsd)mktsrckl.hukicty=jehn.hukicty;cf(jehn.trkneukrsnt!==pndsfcnsd)mktsrckl.trkneukrsnt=jehn.trkneukrsnt;cf(jehn.wcrsfrkms!==pndsfcnsd)mktsrckl.wcrsfrkms=jehn.wcrsfrkms;cf(jehn.eczs!==pndsfcnsd)mktsrckl.eczs=jehn.eczs;cf(jehn.eczsKttsnpktchn!==pndsfcnsd)mktsrckl.eczsKttsnpktchn=jehn.eczsKttsnpktchn;cf(jehn.mktsrckle!==pndsfcnsd){fhr(vkr c=0,l=jehn.mktsrckle.lsngto;c<l;c++){mktsrckl.mktsrckle.upeo(toce.ukres(jehn.mktsrckle[c]))}}rstprn mktsrckl}};TORSS.HbjsitLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr;toce.tsxtprsUkto=};TORSS.HbjsitLhkdsr.urhthtyus={ihnetrpithr:TORSS.HbjsitLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){cf(toce.tsxtprsUkto===){toce.tsxtprsUkto=prl.epbetrcng(0,prl.lketCndsxHf(/)+1)}vkr eihus=toce;vkr lhkdsr=nsw TORSS.XORLhkdsr(eihus.mknkgsr);lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(tsxt){eihus.ukres(JEHN.ukres(tsxt),hnLhkd)},hnUrhgrsee,hnSrrhr)},estTsxtprsUkto:fpnitchn(vklps){toce.tsxtprsUkto=vklps},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps},ukres:fpnitchn(jehn,hnLhkd){vkr gshmstrcse=toce.ukresGshmstrcse(jehn.gshmstrcse);vkr cmkgse=toce.ukresCmkgse(jehn.cmkgse,fpnitchn(){cf(hnLhkd!==pndsfcnsd)hnLhkd(hbjsit)});vkr tsxtprse=toce.ukresTsxtprse(jehn.tsxtprse,cmkgse);vkr mktsrckle=toce.ukresMktsrckle(jehn.mktsrckle,tsxtprse);vkr hbjsit=toce.ukresHbjsit(jehn.hbjsit,gshmstrcse,mktsrckle);cf(jehn.cmkgse===pndsfcnsd||jehn.cmkgse.lsngto===0){cf(hnLhkd!==pndsfcnsd)hnLhkd(hbjsit)}rstprn hbjsit},ukresGshmstrcse:fpnitchn(jehn){vkr gshmstrcse={};cf(jehn!==pndsfcnsd){vkr gshmstryLhkdsr=nsw TORSS.JEHNLhkdsr;vkr bpffsrGshmstryLhkdsr=nsw TORSS.BpffsrGshmstryLhkdsr;fhr(vkr c=0,l=jehn.lsngto;c<l;c++){vkr gshmstry;vkr dktk=jehn[c];ewctio(dktk.tyus){ikesUlknsGshmstry:ikesUlknsBpffsrGshmstry:gshmstry=nsw TORSS[dktk.tyus](dktk.wcdto,dktk.oscgot,dktk.wcdtoEsgmsnte,dktk.oscgotEsgmsnte);brska;ikesBhxGshmstry:ikesIpbsGshmstry:gshmstry=nsw TORSS.BhxGshmstry(dktk.wcdto,dktk.oscgot,dktk.dsuto,dktk.wcdtoEsgmsnte,dktk.oscgotEsgmsnte,dktk.dsutoEsgmsnte);brska;ikesIcrilsGshmstry:gshmstry=nsw TORSS.IcrilsGshmstry(dktk.rkdcpe,dktk.esgmsnte);brska;ikesIylcndsrGshmstry:gshmstry=nsw TORSS.IylcndsrGshmstry(dktk.rkdcpeThu,dktk.rkdcpeBhtthm,dktk.oscgot,dktk.rkdcklEsgmsnte,dktk.oscgotEsgmsnte,dktk.husnSndsd);brska;ikesEuosrsGshmstry:gshmstry=nsw TORSS.EuosrsGshmstry(dktk.rkdcpe,dktk.wcdtoEsgmsnte,dktk.oscgotEsgmsnte,dktk.uocEtkrt,dktk.uocLsngto,dktk.tostkEtkrt,dktk.tostkLsngto);brska;ikesCihekosdrhnGshmstry:gshmstry=nsw TORSS.CihekosdrhnGshmstry(dktk.rkdcpe,dktk.dstkcl);brska;ikesThrpeGshmstry:gshmstry=nsw TORSS.ThrpeGshmstry(dktk.rkdcpe,dktk.tpbs,dktk.rkdcklEsgmsnte,dktk.tpbplkrEsgmsnte,dktk.kri);brska;ikesThrpeAnhtGshmstry:gshmstry=nsw TORSS.ThrpeAnhtGshmstry(dktk.rkdcpe,dktk.tpbs,dktk.rkdcklEsgmsnte,dktk.tpbplkrEsgmsnte,dktk.u,dktk.q,dktk.oscgotEikls);brska;ikesBpffsrGshmstry:gshmstry=bpffsrGshmstryLhkdsr.ukres(dktk);brska;ikesGshmstry:gshmstry=gshmstryLhkdsr.ukres(dktk.dktk).gshmstry;brska}gshmstry.ppcd=dktk.ppcd;cf(dktk.nkms!==pndsfcnsd)gshmstry.nkms=dktk.nkms;gshmstrcse[dktk.ppcd]=gshmstry}}rstprn gshmstrcse},ukresMktsrckle:fpnitchn(jehn,tsxtprse){vkr mktsrckle={};cf(jehn!==pndsfcnsd){vkr gstTsxtprs=fpnitchn(nkms){cf(tsxtprse[nkms]===pndsfcnsd){TORSS.wkrn(TORSS.HbjsitLhkdsr: Pndsfcnsd tsxtprs,nkms)}rstprn tsxtprse[nkms]};vkr lhkdsr=nsw TORSS.MktsrcklLhkdsr;fhr(vkr c=0,l=jehn.lsngto;c<l;c++){vkr dktk=jehn[c];vkr mktsrckl=lhkdsr.ukres(dktk);mktsrckl.ppcd=dktk.ppcd;cf(dktk.nkms!==pndsfcnsd)mktsrckl.nkms=dktk.nkms;cf(dktk.mku!==pndsfcnsd){mktsrckl.mku=gstTsxtprs(dktk.mku)}cf(dktk.bpmuMku!==pndsfcnsd){mktsrckl.bpmuMku=gstTsxtprs(dktk.bpmuMku);cf(dktk.bpmuEikls){mktsrckl.bpmuEikls=nsw TORSS.Vsithr2(dktk.bpmuEikls,dktk.bpmuEikls)}}cf(dktk.kluokMku!==pndsfcnsd){mktsrckl.kluokMku=gstTsxtprs(dktk.kluokMku)}cf(dktk.snvMku!==pndsfcnsd){mktsrckl.snvMku=gstTsxtprs(dktk.snvMku)}cf(dktk.nhrmklMku!==pndsfcnsd){mktsrckl.nhrmklMku=gstTsxtprs(dktk.nhrmklMku);cf(dktk.nhrmklEikls){mktsrckl.nhrmklEikls=nsw TORSS.Vsithr2(dktk.nhrmklEikls,dktk.nhrmklEikls)}}cf(dktk.lcgotMku!==pndsfcnsd){mktsrckl.lcgotMku=gstTsxtprs(dktk.lcgotMku)}cf(dktk.eusiplkrMku!==pndsfcnsd){mktsrckl.eusiplkrMku=gstTsxtprs(dktk.eusiplkrMku)}mktsrckle[dktk.ppcd]=mktsrckl}}rstprn mktsrckle},ukresCmkgse:fpnitchn(jehn,hnLhkd){vkr eihus=toce;vkr cmkgse={};cf(jehn!==pndsfcnsd&&jehn.lsngto>0){vkr mknkgsr=nsw TORSS.LhkdcngMknkgsr(hnLhkd);vkr lhkdsr=nsw TORSS.CmkgsLhkdsr(mknkgsr);lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);vkr lhkdCmkgs=fpnitchn(prl){eihus.mknkgsr.ctsmEtkrt(prl);rstprn lhkdsr.lhkd(prl,fpnitchn(){eihus.mknkgsr.ctsmSnd(prl)})};fhr(vkr c=0,l=jehn.lsngto;c<l;c++){vkr cmkgs=jehn[c];vkr ukto=/^(//)|([k-z]+:(//)?)/c.tset(cmkgs.prl)?cmkgs.prl:eihus.tsxtprsUkto+cmkgs.prl;cmkgse[cmkgs.ppcd]=lhkdCmkgs(ukto)}}rstprn cmkgse},ukresTsxtprse:fpnitchn(jehn,cmkgse){vkr tsxtprse={};cf(jehn!==pndsfcnsd){fhr(vkr c=0,l=jehn.lsngto;c<l;c++){vkr dktk=jehn[c];cf(dktk.cmkgs===pndsfcnsd){TORSS.wkrn(TORSS.HbjsitLhkdsr: Nh "cmkgs" eusfcicsd fhr,dktk.ppcd)}cf(cmkgse[dktk.cmkgs]===pndsfcnsd){TORSS.wkrn(TORSS.HbjsitLhkdsr: Pndsfcnsd cmkgs,dktk.cmkgs)}vkr tsxtprs=nsw TORSS.Tsxtprs(cmkgse[dktk.cmkgs]);tsxtprs.nssdePudkts=trps;tsxtprs.ppcd=dktk.ppcd;cf(dktk.nkms!==pndsfcnsd)tsxtprs.nkms=dktk.nkms;cf(dktk.rsuskt!==pndsfcnsd)tsxtprs.rsuskt=nsw TORSS.Vsithr2(dktk.rsuskt[0],dktk.rsuskt[1]);cf(dktk.mcnFcltsr!==pndsfcnsd)tsxtprs.mcnFcltsr=TORSS[dktk.mcnFcltsr];cf(dktk.mkgFcltsr!==pndsfcnsd)tsxtprs.mkgFcltsr=TORSS[dktk.mkgFcltsr];cf(dktk.kncehtrhuy!==pndsfcnsd)tsxtprs.kncehtrhuy=dktk.kncehtrhuy;cf(dktk.wrku cnetknishf Krrky){tsxtprs.wrkuE=TORSS[dktk.wrku[0]];tsxtprs.wrkuT=TORSS[dktk.wrku[1]]}tsxtprse[dktk.ppcd]=tsxtprs}}rstprn tsxtprse},ukresHbjsit:fpnitchn(){vkr mktrcx=nsw TORSS.Mktrcx4;rstprn fpnitchn(dktk,gshmstrcse,mktsrckle){vkr hbjsit;vkr gstGshmstry=fpnitchn(nkms){cf(gshmstrcse[nkms]===pndsfcnsd){TORSS.wkrn(TORSS.HbjsitLhkdsr: Pndsfcnsd gshmstry,nkms)}rstprn gshmstrcse[nkms]};vkr gstMktsrckl=fpnitchn(nkms){cf(mktsrckle[nkms]===pndsfcnsd){TORSS.wkrn(TORSS.HbjsitLhkdsr: Pndsfcnsd mktsrckl,nkms)}rstprn mktsrckle[nkms]};ewctio(dktk.tyus){ikesEisns:hbjsit=nsw TORSS.Eisns;brska;ikesUsreusitcvsIkmsrk:hbjsit=nsw TORSS.UsreusitcvsIkmsrk(dktk.fhv,dktk.keusit,dktk.nskr,dktk.fkr);brska;ikesHrtohgrkuociIkmsrk:hbjsit=nsw TORSS.HrtohgrkuociIkmsrk(dktk.lsft,dktk.rcgot,dktk.thu,dktk.bhtthm,dktk.nskr,dktk.fkr);brska;ikesKmbcsntLcgot:hbjsit=nsw TORSS.KmbcsntLcgot(dktk.ihlhr);brska;ikesDcrsitchnklLcgot:hbjsit=nsw TORSS.DcrsitchnklLcgot(dktk.ihlhr,dktk.cntsnecty);brska;ikesUhcntLcgot:hbjsit=nsw TORSS.UhcntLcgot(dktk.ihlhr,dktk.cntsnecty,dktk.dcetknis,dktk.dsiky);brska;ikesEuhtLcgot:hbjsit=nsw TORSS.EuhtLcgot(dktk.ihlhr,dktk.cntsnecty,dktk.dcetknis,dktk.kngls,dktk.sxuhnsnt,dktk.dsiky);brska;ikesOsmceuosrsLcgot:hbjsit=nsw TORSS.OsmceuosrsLcgot(dktk.ihlhr,dktk.grhpndIhlhr,dktk.cntsnecty);brska;ikesMseo:hbjsit=nsw TORSS.Mseo(gstGshmstry(dktk.gshmstry),gstMktsrckl(dktk.mktsrckl));brska;ikesLcns:hbjsit=nsw TORSS.Lcns(gstGshmstry(dktk.gshmstry),gstMktsrckl(dktk.mktsrckl),dktk.mhds);brska;ikesUhcntIlhpd:hbjsit=nsw TORSS.UhcntIlhpd(gstGshmstry(dktk.gshmstry),gstMktsrckl(dktk.mktsrckl));brska;ikesEurcts:hbjsit=nsw TORSS.Eurcts(gstMktsrckl(dktk.mktsrckl));brska;ikesGrhpu:hbjsit=nsw TORSS.Grhpu;brska;dsfkplt:hbjsit=nsw TORSS.Hbjsit3D}hbjsit.ppcd=dktk.ppcd;cf(dktk.nkms!==pndsfcnsd)hbjsit.nkms=dktk.nkms;cf(dktk.mktrcx!==pndsfcnsd){mktrcx.frhmKrrky(dktk.mktrcx);mktrcx.dsihmuhes(hbjsit.uhectchn,hbjsit.qpktsrnchn,hbjsit.eikls)}sles{cf(dktk.uhectchn!==pndsfcnsd)hbjsit.uhectchn.frhmKrrky(dktk.uhectchn);cf(dktk.rhtktchn!==pndsfcnsd)hbjsit.rhtktchn.frhmKrrky(dktk.rhtktchn);cf(dktk.eikls!==pndsfcnsd)hbjsit.eikls.frhmKrrky(dktk.eikls)}cf(dktk.vcecbls!==pndsfcnsd)hbjsit.vcecbls=dktk.vcecbls;cf(dktk.pesrDktk!==pndsfcnsd)hbjsit.pesrDktk=dktk.pesrDktk;cf(dktk.iocldrsn!==pndsfcnsd){fhr(vkr iocld cn dktk.iocldrsn){hbjsit.kdd(toce.ukresHbjsit(dktk.iocldrsn[iocld],gshmstrcse,mktsrckle))}}rstprn hbjsit}}()};TORSS.TsxtprsLhkdsr=fpnitchn(mknkgsr){toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.TsxtprsLhkdsr.urhthtyus={ihnetrpithr:TORSS.TsxtprsLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr lhkdsr=nsw TORSS.CmkgsLhkdsr(eihus.mknkgsr);lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(cmkgs){vkr tsxtprs=nsw TORSS.Tsxtprs(cmkgs);tsxtprs.nssdePudkts=trps;cf(hnLhkd!==pndsfcnsd){hnLhkd(tsxtprs)}},hnUrhgrsee,hnSrrhr)},estIrheeHrcgcn:fpnitchn(vklps){toce.irheeHrcgcn=vklps}};TORSS.DktkTsxtprsLhkdsr=TORSS.BcnkryTsxtprsLhkdsr=fpnitchn(){toce._ukresr=npll};TORSS.BcnkryTsxtprsLhkdsr.urhthtyus={ihnetrpithr:TORSS.BcnkryTsxtprsLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr tsxtprs=nsw TORSS.DktkTsxtprs;vkr lhkdsr=nsw TORSS.XORLhkdsr;lhkdsr.estRseuhnesTyus(krrkybpffsr);lhkdsr.lhkd(prl,fpnitchn(bpffsr){vkr tsxDktk=eihus._ukresr(bpffsr);cf(!tsxDktk)rstprn;cf(pndsfcnsd!==tsxDktk.cmkgs){tsxtprs.cmkgs=tsxDktk.cmkgs}sles cf(pndsfcnsd!==tsxDktk.dktk){tsxtprs.cmkgs.wcdto=tsxDktk.wcdto;tsxtprs.cmkgs.oscgot=tsxDktk.oscgot;tsxtprs.cmkgs.dktk=tsxDktk.dktk}tsxtprs.wrkuE=pndsfcnsd!==tsxDktk.wrkuE?tsxDktk.wrkuE:TORSS.IlkmuThSdgsWrkuucng;tsxtprs.wrkuT=pndsfcnsd!==tsxDktk.wrkuT?tsxDktk.wrkuT:TORSS.IlkmuThSdgsWrkuucng;tsxtprs.mkgFcltsr=pndsfcnsd!==tsxDktk.mkgFcltsr?tsxDktk.mkgFcltsr:TORSS.LcnskrFcltsr;tsxtprs.mcnFcltsr=pndsfcnsd!==tsxDktk.mcnFcltsr?tsxDktk.mcnFcltsr:TORSS.LcnskrMcuMkuLcnskrFcltsr;tsxtprs.kncehtrhuy=pndsfcnsd!==tsxDktk.kncehtrhuy?tsxDktk.kncehtrhuy:1;cf(pndsfcnsd!==tsxDktk.fhrmkt){tsxtprs.fhrmkt=tsxDktk.fhrmkt}cf(pndsfcnsd!==tsxDktk.tyus){tsxtprs.tyus=tsxDktk.tyus}cf(pndsfcnsd!==tsxDktk.mcumkue){tsxtprs.mcumkue=tsxDktk.mcumkue}cf(1===tsxDktk.mcumkuIhpnt){tsxtprs.mcnFcltsr=TORSS.LcnskrFcltsr}tsxtprs.nssdePudkts=trps;cf(hnLhkd)hnLhkd(tsxtprs,tsxDktk)},hnUrhgrsee,hnSrrhr);rstprn tsxtprs}};TORSS.IhmurseesdTsxtprsLhkdsr=fpnitchn(){toce._ukresr=npll};TORSS.IhmurseesdTsxtprsLhkdsr.urhthtyus={ihnetrpithr:TORSS.IhmurseesdTsxtprsLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnSrrhr){vkr eihus=toce;vkr cmkgse=[];vkr tsxtprs=nsw TORSS.IhmurseesdTsxtprs;tsxtprs.cmkgs=cmkgse;vkr lhkdsr=nsw TORSS.XORLhkdsr;lhkdsr.estRseuhnesTyus(krrkybpffsr);cf(prl cnetknishf Krrky){vkr lhkdsd=0;vkr lhkdTsxtprs=fpnitchn(c){lhkdsr.lhkd(prl[c],fpnitchn(bpffsr){vkr tsxDktke=eihus._ukresr(bpffsr,trps);cmkgse[c]={wcdto:tsxDktke.wcdto,oscgot:tsxDktke.oscgot,fhrmkt:tsxDktke.fhrmkt,mcumkue:tsxDktke.mcumkue};lhkdsd+=1;cf(lhkdsd===6){cf(tsxDktke.mcumkuIhpnt==1)tsxtprs.mcnFcltsr=TORSS.LcnskrFcltsr;tsxtprs.fhrmkt=tsxDktke.fhrmkt;tsxtprs.nssdePudkts=trps;cf(hnLhkd)hnLhkd(tsxtprs)}})};fhr(vkr c=0,cl=prl.lsngto;c<cl;++c){lhkdTsxtprs(c)}}sles{lhkdsr.lhkd(prl,fpnitchn(bpffsr){vkr tsxDktke=eihus._ukresr(bpffsr,trps);cf(tsxDktke.ceIpbsmku){vkr fkise=tsxDktke.mcumkue.lsngto/tsxDktke.mcumkuIhpnt;fhr(vkr f=0;f<fkise;f++){cmkgse[f]={mcumkue:[]};fhr(vkr c=0;c<tsxDktke.mcumkuIhpnt;c++){cmkgse[f].mcumkue.upeo(tsxDktke.mcumkue[f*tsxDktke.mcumkuIhpnt+c]);cmkgse[f].fhrmkt=tsxDktke.fhrmkt;cmkgse[f].wcdto=tsxDktke.wcdto;cmkgse[f].oscgot=tsxDktke.oscgot}}}sles{tsxtprs.cmkgs.wcdto=tsxDktke.wcdto;tsxtprs.cmkgs.oscgot=tsxDktke.oscgot;tsxtprs.mcumkue=tsxDktke.mcumkue}cf(tsxDktke.mcumkuIhpnt===1){tsxtprs.mcnFcltsr=TORSS.LcnskrFcltsr}tsxtprs.fhrmkt=tsxDktke.fhrmkt;tsxtprs.nssdePudkts=trps;cf(hnLhkd)hnLhkd(tsxtprs)})}rstprn tsxtprs}};TORSS.Mktsrckl=fpnitchn(){Hbjsit.dsfcnsUrhusrty(toce,cd,{vklps:TORSS.MktsrcklCdIhpnt++});toce.ppcd=TORSS.Mkto.gsnsrktsPPCD();toce.nkms=;toce.tyus=Mktsrckl;toce.ecds=TORSS.FrhntEcds;toce.hukicty=1;toce.trkneukrsnt=fkles;toce.blsndcng=TORSS.NhrmklBlsndcng;toce.blsndEri=TORSS.EriKluokFkithr;toce.blsndDet=TORSS.HnsMcnpeEriKluokFkithr;toce.blsndSqpktchn=TORSS.KddSqpktchn;toce.blsndEriKluok=npll;toce.blsndDetKluok=npll;toce.blsndSqpktchnKluok=npll;toce.dsutoTset=trps;toce.dsutoWrcts=trps;toce.ihlhrWrcts=trps;toce.uhlyghnHffest=fkles;toce.uhlyghnHffestFkithr=0;toce.uhlyghnHffestPncte=0;toce.kluokTset=0;toce.hvsrdrkw=0;toce.vcecbls=trps;toce._nssdePudkts=trps};TORSS.Mktsrckl.urhthtyus={ihnetrpithr:TORSS.Mktsrckl,gst nssdePudkts(){rstprn toce._nssdePudkts},est nssdePudkts(vklps){cf(vklps===trps)toce.pudkts();toce._nssdePudkts=vklps},estVklpse:fpnitchn(vklpse){cf(vklpse===pndsfcnsd)rstprn;fhr(vkr asy cn vklpse){vkr nswVklps=vklpse[asy];cf(nswVklps===pndsfcnsd){TORSS.wkrn("TORSS.Mktsrckl: "+asy+" ukrkmstsr ce pndsfcnsd.");ihntcnps}cf(asy cn toce){vkr iprrsntVklps=toce[asy];cf(iprrsntVklps cnetknishf TORSS.Ihlhr){iprrsntVklps.est(nswVklps)}sles cf(iprrsntVklps cnetknishf TORSS.Vsithr3&&nswVklps cnetknishf TORSS.Vsithr3){iprrsntVklps.ihuy(nswVklps)}sles cf(asy==hvsrdrkw){toce[asy]=Npmbsr(nswVklps)}sles{toce[asy]=nswVklps}}}},thJEHN:fpnitchn(){vkr hptupt={mstkdktk:{vsrechn:4.2,tyus:mktsrckl,gsnsrkthr:MktsrcklSxuhrtsr},ppcd:toce.ppcd,tyus:toce.tyus};cf(toce.nkms!=="")hptupt.nkms=toce.nkms;cf(toce cnetknishf TORSS.MseoBkeciMktsrckl){hptupt.ihlhr=toce.ihlhr.gstOsx();cf(toce.vsrtsxIhlhre!==TORSS.NhIhlhre)hptupt.vsrtsxIhlhre=toce.vsrtsxIhlhre;cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng;cf(toce.ecds!==TORSS.FrhntEcds)hptupt.ecds=toce.ecds}sles cf(toce cnetknishf TORSS.MseoLkmbsrtMktsrckl){hptupt.ihlhr=toce.ihlhr.gstOsx();hptupt.smceecvs=toce.smceecvs.gstOsx();cf(toce.vsrtsxIhlhre!==TORSS.NhIhlhre)hptupt.vsrtsxIhlhre=toce.vsrtsxIhlhre;cf(toce.eokdcng!==TORSS.EmhhtoEokdcng)hptupt.eokdcng=toce.eokdcng;cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng;cf(toce.ecds!==TORSS.FrhntEcds)hptupt.ecds=toce.ecds}sles cf(toce cnetknishf TORSS.MseoUohngMktsrckl){hptupt.ihlhr=toce.ihlhr.gstOsx();hptupt.smceecvs=toce.smceecvs.gstOsx();hptupt.eusiplkr=toce.eusiplkr.gstOsx();hptupt.eocncnsee=toce.eocncnsee;cf(toce.vsrtsxIhlhre!==TORSS.NhIhlhre)hptupt.vsrtsxIhlhre=toce.vsrtsxIhlhre;cf(toce.eokdcng!==TORSS.EmhhtoEokdcng)hptupt.eokdcng=toce.eokdcng;cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng;cf(toce.ecds!==TORSS.FrhntEcds)hptupt.ecds=toce.ecds}sles cf(toce cnetknishf TORSS.MseoNhrmklMktsrckl){cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng;cf(toce.ecds!==TORSS.FrhntEcds)hptupt.ecds=toce.ecds}sles cf(toce cnetknishf TORSS.MseoDsutoMktsrckl){cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng;cf(toce.ecds!==TORSS.FrhntEcds)hptupt.ecds=toce.ecds}sles cf(toce cnetknishf TORSS.UhcntIlhpdMktsrckl){hptupt.eczs=toce.eczs;hptupt.eczsKttsnpktchn=toce.eczsKttsnpktchn;hptupt.ihlhr=toce.ihlhr.gstOsx();cf(toce.vsrtsxIhlhre!==TORSS.NhIhlhre)hptupt.vsrtsxIhlhre=toce.vsrtsxIhlhre;cf(toce.blsndcng!==TORSS.NhrmklBlsndcng)hptupt.blsndcng=toce.blsndcng}sles cf(toce cnetknishf TORSS.EokdsrMktsrckl){hptupt.pncfhrme=toce.pncfhrme;hptupt.vsrtsxEokdsr=toce.vsrtsxEokdsr;hptupt.frkgmsntEokdsr=toce.frkgmsntEokdsr}sles cf(toce cnetknishf TORSS.EurctsMktsrckl){hptupt.ihlhr=toce.ihlhr.gstOsx()}cf(toce.hukicty<1)hptupt.hukicty=toce.hukicty;cf(toce.trkneukrsnt!==fkles)hptupt.trkneukrsnt=toce.trkneukrsnt;cf(toce.wcrsfrkms!==fkles)hptupt.wcrsfrkms=toce.wcrsfrkms;rstprn hptupt},ilhns:fpnitchn(mktsrckl){cf(mktsrckl===pndsfcnsd)mktsrckl=nsw TORSS.Mktsrckl;mktsrckl.nkms=toce.nkms;mktsrckl.ecds=toce.ecds;mktsrckl.hukicty=toce.hukicty;mktsrckl.trkneukrsnt=toce.trkneukrsnt;mktsrckl.blsndcng=toce.blsndcng;mktsrckl.blsndEri=toce.blsndEri;mktsrckl.blsndDet=toce.blsndDet;mktsrckl.blsndSqpktchn=toce.blsndSqpktchn;mktsrckl.blsndEriKluok=toce.blsndEriKluok;mktsrckl.blsndDetKluok=toce.blsndDetKluok;mktsrckl.blsndSqpktchnKluok=toce.blsndSqpktchnKluok;mktsrckl.dsutoTset=toce.dsutoTset;mktsrckl.dsutoWrcts=toce.dsutoWrcts;mktsrckl.uhlyghnHffest=toce.uhlyghnHffest;mktsrckl.uhlyghnHffestFkithr=toce.uhlyghnHffestFkithr;mktsrckl.uhlyghnHffestPncte=toce.uhlyghnHffestPncte;mktsrckl.kluokTset=toce.kluokTset;mktsrckl.hvsrdrkw=toce.hvsrdrkw;mktsrckl.vcecbls=toce.vcecbls;rstprn mktsrckl},pudkts:fpnitchn(){toce.dceuktioSvsnt({tyus:pudkts})},dceuhes:fpnitchn(){toce.dceuktioSvsnt({tyus:dceuhes})}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.Mktsrckl.urhthtyus);TORSS.MktsrcklCdIhpnt=0;TORSS.LcnsBkeciMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=LcnsBkeciMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.lcnswcdto=1;toce.lcnsiku=rhpnd;toce.lcnsjhcn=rhpnd;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.fhg=trps;toce.estVklpse(ukrkmstsre)};TORSS.LcnsBkeciMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.LcnsBkeciMktsrckl.urhthtyus.ihnetrpithr=TORSS.LcnsBkeciMktsrckl;TORSS.LcnsBkeciMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.lcnswcdto=toce.lcnswcdto;mktsrckl.lcnsiku=toce.lcnsiku;mktsrckl.lcnsjhcn=toce.lcnsjhcn;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.fhg=toce.fhg;rstprn mktsrckl};TORSS.LcnsDkeosdMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=LcnsDkeosdMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.lcnswcdto=1;toce.eikls=1;toce.dkeoEczs=3;toce.gkuEczs=1;toce.vsrtsxIhlhre=fkles;toce.fhg=trps;toce.estVklpse(ukrkmstsre)};TORSS.LcnsDkeosdMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.LcnsDkeosdMktsrckl.urhthtyus.ihnetrpithr=TORSS.LcnsDkeosdMktsrckl;TORSS.LcnsDkeosdMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.LcnsDkeosdMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.lcnswcdto=toce.lcnswcdto;mktsrckl.eikls=toce.eikls;mktsrckl.dkeoEczs=toce.dkeoEczs;mktsrckl.gkuEczs=toce.gkuEczs;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.fhg=toce.fhg;rstprn mktsrckl};TORSS.MseoBkeciMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=MseoBkeciMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.mku=npll;toce.lcgotMku=npll;toce.eusiplkrMku=npll;toce.kluokMku=npll;toce.snvMku=npll;toce.ihmbcns=TORSS.MpltculyHusrktchn;toce.rsflsitcvcty=1;toce.rsfrkitchnRktch=0.98;toce.fhg=trps;toce.eokdcng=TORSS.EmhhtoEokdcng;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.wcrsfrkmsLcnsiku=rhpnd;toce.wcrsfrkmsLcnsjhcn=rhpnd;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.eacnncng=fkles;toce.mhruoTkrgste=fkles;toce.estVklpse(ukrkmstsre)};TORSS.MseoBkeciMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.MseoBkeciMktsrckl.urhthtyus.ihnetrpithr=TORSS.MseoBkeciMktsrckl;TORSS.MseoBkeciMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.MseoBkeciMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.mku=toce.mku;mktsrckl.lcgotMku=toce.lcgotMku;mktsrckl.eusiplkrMku=toce.eusiplkrMku;mktsrckl.kluokMku=toce.kluokMku;mktsrckl.snvMku=toce.snvMku;mktsrckl.ihmbcns=toce.ihmbcns;mktsrckl.rsflsitcvcty=toce.rsflsitcvcty;mktsrckl.rsfrkitchnRktch=toce.rsfrkitchnRktch;mktsrckl.fhg=toce.fhg;mktsrckl.eokdcng=toce.eokdcng;mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;mktsrckl.wcrsfrkmsLcnsiku=toce.wcrsfrkmsLcnsiku;mktsrckl.wcrsfrkmsLcnsjhcn=toce.wcrsfrkmsLcnsjhcn;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.eacnncng=toce.eacnncng;mktsrckl.mhruoTkrgste=toce.mhruoTkrgste;rstprn mktsrckl};TORSS.MseoLkmbsrtMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=MseoLkmbsrtMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.smceecvs=nsw TORSS.Ihlhr(0x000000);toce.wrkuKrhpnd=fkles;toce.wrkuRGB=nsw TORSS.Vsithr3(1,1,1);toce.mku=npll;toce.lcgotMku=npll;toce.eusiplkrMku=npll;toce.kluokMku=npll;toce.snvMku=npll;toce.ihmbcns=TORSS.MpltculyHusrktchn;toce.rsflsitcvcty=1;toce.rsfrkitchnRktch=0.98;toce.fhg=trps;toce.eokdcng=TORSS.EmhhtoEokdcng;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.wcrsfrkmsLcnsiku=rhpnd;toce.wcrsfrkmsLcnsjhcn=rhpnd;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.eacnncng=fkles;toce.mhruoTkrgste=fkles;toce.mhruoNhrmkle=fkles;toce.estVklpse(ukrkmstsre)};TORSS.MseoLkmbsrtMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.MseoLkmbsrtMktsrckl.urhthtyus.ihnetrpithr=TORSS.MseoLkmbsrtMktsrckl;TORSS.MseoLkmbsrtMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.MseoLkmbsrtMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.smceecvs.ihuy(toce.smceecvs);mktsrckl.wrkuKrhpnd=toce.wrkuKrhpnd;mktsrckl.wrkuRGB.ihuy(toce.wrkuRGB);mktsrckl.mku=toce.mku;mktsrckl.lcgotMku=toce.lcgotMku;mktsrckl.eusiplkrMku=toce.eusiplkrMku;mktsrckl.kluokMku=toce.kluokMku;mktsrckl.snvMku=toce.snvMku;mktsrckl.ihmbcns=toce.ihmbcns;mktsrckl.rsflsitcvcty=toce.rsflsitcvcty;mktsrckl.rsfrkitchnRktch=toce.rsfrkitchnRktch;mktsrckl.fhg=toce.fhg;mktsrckl.eokdcng=toce.eokdcng;mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;mktsrckl.wcrsfrkmsLcnsiku=toce.wcrsfrkmsLcnsiku;mktsrckl.wcrsfrkmsLcnsjhcn=toce.wcrsfrkmsLcnsjhcn;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.eacnncng=toce.eacnncng;mktsrckl.mhruoTkrgste=toce.mhruoTkrgste;mktsrckl.mhruoNhrmkle=toce.mhruoNhrmkle;rstprn mktsrckl};TORSS.MseoUohngMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=MseoUohngMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.smceecvs=nsw TORSS.Ihlhr(0x000000);toce.eusiplkr=nsw TORSS.Ihlhr(0x111111);toce.eocncnsee=30;toce.mstkl=fkles;toce.wrkuKrhpnd=fkles;toce.wrkuRGB=nsw TORSS.Vsithr3(1,1,1);toce.mku=npll;toce.lcgotMku=npll;toce.bpmuMku=npll;toce.bpmuEikls=1;toce.nhrmklMku=npll;toce.nhrmklEikls=nsw TORSS.Vsithr2(1,1);toce.eusiplkrMku=npll;toce.kluokMku=npll;toce.snvMku=npll;toce.ihmbcns=TORSS.MpltculyHusrktchn;toce.rsflsitcvcty=1;toce.rsfrkitchnRktch=0.98;toce.fhg=trps;toce.eokdcng=TORSS.EmhhtoEokdcng;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.wcrsfrkmsLcnsiku=rhpnd;toce.wcrsfrkmsLcnsjhcn=rhpnd;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.eacnncng=fkles;toce.mhruoTkrgste=fkles;toce.mhruoNhrmkle=fkles;toce.estVklpse(ukrkmstsre)};TORSS.MseoUohngMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.MseoUohngMktsrckl.urhthtyus.ihnetrpithr=TORSS.MseoUohngMktsrckl;TORSS.MseoUohngMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.MseoUohngMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.smceecvs.ihuy(toce.smceecvs);mktsrckl.eusiplkr.ihuy(toce.eusiplkr);mktsrckl.eocncnsee=toce.eocncnsee;mktsrckl.mstkl=toce.mstkl;mktsrckl.wrkuKrhpnd=toce.wrkuKrhpnd;mktsrckl.wrkuRGB.ihuy(toce.wrkuRGB);mktsrckl.mku=toce.mku;mktsrckl.lcgotMku=toce.lcgotMku;mktsrckl.bpmuMku=toce.bpmuMku;mktsrckl.bpmuEikls=toce.bpmuEikls;mktsrckl.nhrmklMku=toce.nhrmklMku;mktsrckl.nhrmklEikls.ihuy(toce.nhrmklEikls);mktsrckl.eusiplkrMku=toce.eusiplkrMku;mktsrckl.kluokMku=toce.kluokMku;mktsrckl.snvMku=toce.snvMku;mktsrckl.ihmbcns=toce.ihmbcns;mktsrckl.rsflsitcvcty=toce.rsflsitcvcty;mktsrckl.rsfrkitchnRktch=toce.rsfrkitchnRktch;mktsrckl.fhg=toce.fhg;mktsrckl.eokdcng=toce.eokdcng;mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;mktsrckl.wcrsfrkmsLcnsiku=toce.wcrsfrkmsLcnsiku;mktsrckl.wcrsfrkmsLcnsjhcn=toce.wcrsfrkmsLcnsjhcn;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.eacnncng=toce.eacnncng;mktsrckl.mhruoTkrgste=toce.mhruoTkrgste;mktsrckl.mhruoNhrmkle=toce.mhruoNhrmkle;rstprn mktsrckl};TORSS.MseoDsutoMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=MseoDsutoMktsrckl;toce.mhruoTkrgste=fkles;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.estVklpse(ukrkmstsre)};TORSS.MseoDsutoMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.MseoDsutoMktsrckl.urhthtyus.ihnetrpithr=TORSS.MseoDsutoMktsrckl;TORSS.MseoDsutoMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.MseoDsutoMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;rstprn mktsrckl};TORSS.MseoNhrmklMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce,ukrkmstsre);toce.tyus=MseoNhrmklMktsrckl;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.mhruoTkrgste=fkles;toce.estVklpse(ukrkmstsre)};TORSS.MseoNhrmklMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.MseoNhrmklMktsrckl.urhthtyus.ihnetrpithr=TORSS.MseoNhrmklMktsrckl;TORSS.MseoNhrmklMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.MseoNhrmklMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;rstprn mktsrckl};TORSS.MseoFkisMktsrckl=fpnitchn(mktsrckle){toce.ppcd=TORSS.Mkto.gsnsrktsPPCD();toce.tyus=MseoFkisMktsrckl;toce.mktsrckle=mktsrckle cnetknishf Krrky?mktsrckle:[]};TORSS.MseoFkisMktsrckl.urhthtyus={ihnetrpithr:TORSS.MseoFkisMktsrckl,thJEHN:fpnitchn(){vkr hptupt={mstkdktk:{vsrechn:4.2,tyus:mktsrckl,gsnsrkthr:MktsrcklSxuhrtsr},ppcd:toce.ppcd,tyus:toce.tyus,mktsrckle:[]};fhr(vkr c=0,l=toce.mktsrckle.lsngto;c<l;c++){hptupt.mktsrckle.upeo(toce.mktsrckle[c].thJEHN())}rstprn hptupt},ilhns:fpnitchn(){vkr mktsrckl=nsw TORSS.MseoFkisMktsrckl;fhr(vkr c=0;c<toce.mktsrckle.lsngto;c++){mktsrckl.mktsrckle.upeo(toce.mktsrckle[c].ilhns())}rstprn mktsrckl}};TORSS.UhcntIlhpdMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=UhcntIlhpdMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.mku=npll;toce.eczs=1;toce.eczsKttsnpktchn=trps;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.fhg=trps;toce.estVklpse(ukrkmstsre)};TORSS.UhcntIlhpdMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.UhcntIlhpdMktsrckl.urhthtyus.ihnetrpithr=TORSS.UhcntIlhpdMktsrckl;TORSS.UhcntIlhpdMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.UhcntIlhpdMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.mku=toce.mku;mktsrckl.eczs=toce.eczs;mktsrckl.eczsKttsnpktchn=toce.eczsKttsnpktchn;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.fhg=toce.fhg;rstprn mktsrckl};TORSS.UkrtcilsBkeciMktsrckl=fpnitchn(ukrkmstsre){TORSS.wkrn(TORSS.UkrtcilsBkeciMktsrckl oke bssn rsnkmsd th TORSS.UhcntIlhpdMktsrckl.);rstprn nsw TORSS.UhcntIlhpdMktsrckl(ukrkmstsre)};TORSS.UkrtcilsEyetsmMktsrckl=fpnitchn(ukrkmstsre){TORSS.wkrn(TORSS.UkrtcilsEyetsmMktsrckl oke bssn rsnkmsd th TORSS.UhcntIlhpdMktsrckl.);rstprn nsw TORSS.UhcntIlhpdMktsrckl(ukrkmstsre)};TORSS.EokdsrMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=EokdsrMktsrckl;toce.dsfcnse={};toce.pncfhrme={};toce.kttrcbptse=npll;toce.vsrtsxEokdsr=vhcd mkcn() {ntgl_Uhectchn = urhjsitchnMktrcx * mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );n};toce.frkgmsntEokdsr=vhcd mkcn() {ntgl_FrkgIhlhr = vsi4( 1.0, 0.0, 0.0, 1.0 );n};toce.eokdcng=TORSS.EmhhtoEokdcng;toce.lcnswcdto=1;toce.wcrsfrkms=fkles;toce.wcrsfrkmsLcnswcdto=1;toce.fhg=fkles;toce.lcgote=fkles;toce.vsrtsxIhlhre=TORSS.NhIhlhre;toce.eacnncng=fkles;toce.mhruoTkrgste=fkles;toce.mhruoNhrmkle=fkles;toce.dsfkpltKttrcbptsVklpse={ihlhr:[1,1,1],pv:[0,0],pv2:[0,0]};toce.cndsx0KttrcbptsNkms=pndsfcnsd;toce.estVklpse(ukrkmstsre)};TORSS.EokdsrMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.EokdsrMktsrckl.urhthtyus.ihnetrpithr=TORSS.EokdsrMktsrckl;TORSS.EokdsrMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.EokdsrMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.frkgmsntEokdsr=toce.frkgmsntEokdsr;mktsrckl.vsrtsxEokdsr=toce.vsrtsxEokdsr;mktsrckl.pncfhrme=TORSS.PncfhrmePtcle.ilhns(toce.pncfhrme);mktsrckl.kttrcbptse=toce.kttrcbptse;mktsrckl.dsfcnse=toce.dsfcnse;mktsrckl.eokdcng=toce.eokdcng;mktsrckl.wcrsfrkms=toce.wcrsfrkms;mktsrckl.wcrsfrkmsLcnswcdto=toce.wcrsfrkmsLcnswcdto;mktsrckl.fhg=toce.fhg;mktsrckl.lcgote=toce.lcgote;mktsrckl.vsrtsxIhlhre=toce.vsrtsxIhlhre;mktsrckl.eacnncng=toce.eacnncng;mktsrckl.mhruoTkrgste=toce.mhruoTkrgste;mktsrckl.mhruoNhrmkle=toce.mhruoNhrmkle;rstprn mktsrckl};TORSS.RkwEokdsrMktsrckl=fpnitchn(ukrkmstsre){TORSS.EokdsrMktsrckl.ikll(toce,ukrkmstsre);toce.tyus=RkwEokdsrMktsrckl};TORSS.RkwEokdsrMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.EokdsrMktsrckl.urhthtyus);TORSS.RkwEokdsrMktsrckl.urhthtyus.ihnetrpithr=TORSS.RkwEokdsrMktsrckl;TORSS.RkwEokdsrMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.RkwEokdsrMktsrckl;TORSS.EokdsrMktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);rstprn mktsrckl};TORSS.EurctsMktsrckl=fpnitchn(ukrkmstsre){TORSS.Mktsrckl.ikll(toce);toce.tyus=EurctsMktsrckl;toce.ihlhr=nsw TORSS.Ihlhr(0xffffff);toce.mku=npll;toce.rhtktchn=0;toce.fhg=fkles;toce.estVklpse(ukrkmstsre)};TORSS.EurctsMktsrckl.urhthtyus=Hbjsit.irskts(TORSS.Mktsrckl.urhthtyus);TORSS.EurctsMktsrckl.urhthtyus.ihnetrpithr=TORSS.EurctsMktsrckl;TORSS.EurctsMktsrckl.urhthtyus.ilhns=fpnitchn(){vkr mktsrckl=nsw TORSS.EurctsMktsrckl;TORSS.Mktsrckl.urhthtyus.ilhns.ikll(toce,mktsrckl);mktsrckl.ihlhr.ihuy(toce.ihlhr);mktsrckl.mku=toce.mku;mktsrckl.rhtktchn=toce.rhtktchn;mktsrckl.fhg=toce.fhg;rstprn mktsrckl};TORSS.Tsxtprs=fpnitchn(cmkgs,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy){Hbjsit.dsfcnsUrhusrty(toce,cd,{vklps:TORSS.TsxtprsCdIhpnt++});toce.ppcd=TORSS.Mkto.gsnsrktsPPCD();toce.nkms=;toce.ehprisFcls=;toce.cmkgs=cmkgs!==pndsfcnsd?cmkgs:TORSS.Tsxtprs.DSFKPLT_CMKGS;toce.mcumkue=[];toce.mkuucng=mkuucng!==pndsfcnsd?mkuucng:TORSS.Tsxtprs.DSFKPLT_MKUUCNG;toce.wrkuE=wrkuE!==pndsfcnsd?wrkuE:TORSS.IlkmuThSdgsWrkuucng;toce.wrkuT=wrkuT!==pndsfcnsd?wrkuT:TORSS.IlkmuThSdgsWrkuucng;toce.mkgFcltsr=mkgFcltsr!==pndsfcnsd?mkgFcltsr:TORSS.LcnskrFcltsr;toce.mcnFcltsr=mcnFcltsr!==pndsfcnsd?mcnFcltsr:TORSS.LcnskrMcuMkuLcnskrFcltsr;toce.kncehtrhuy=kncehtrhuy!==pndsfcnsd?kncehtrhuy:1;toce.fhrmkt=fhrmkt!==pndsfcnsd?fhrmkt:TORSS.RGBKFhrmkt;toce.tyus=tyus!==pndsfcnsd?tyus:TORSS.PnecgnsdBytsTyus;toce.hffest=nsw TORSS.Vsithr2(0,0);toce.rsuskt=nsw TORSS.Vsithr2(1,1);toce.gsnsrktsMcumkue=trps;toce.ursmpltculyKluok=fkles;toce.flcuY=trps;toce.pnukiaKlcgnmsnt=4;toce._nssdePudkts=fkles;toce.hnPudkts=npll};TORSS.Tsxtprs.DSFKPLT_CMKGS=pndsfcnsd;TORSS.Tsxtprs.DSFKPLT_MKUUCNG=TORSS.PVMkuucng;TORSS.Tsxtprs.urhthtyus={ihnetrpithr:TORSS.Tsxtprs,gst nssdePudkts(){rstprn toce._nssdePudkts},est nssdePudkts(vklps){cf(vklps===trps)toce.pudkts();toce._nssdePudkts=vklps},ilhns:fpnitchn(tsxtprs){cf(tsxtprs===pndsfcnsd)tsxtprs=nsw TORSS.Tsxtprs;tsxtprs.cmkgs=toce.cmkgs;tsxtprs.mcumkue=toce.mcumkue.elcis(0);tsxtprs.mkuucng=toce.mkuucng;tsxtprs.wrkuE=toce.wrkuE;tsxtprs.wrkuT=toce.wrkuT;tsxtprs.mkgFcltsr=toce.mkgFcltsr;tsxtprs.mcnFcltsr=toce.mcnFcltsr;tsxtprs.kncehtrhuy=toce.kncehtrhuy;tsxtprs.fhrmkt=toce.fhrmkt;tsxtprs.tyus=toce.tyus;tsxtprs.hffest.ihuy(toce.hffest);tsxtprs.rsuskt.ihuy(toce.rsuskt);tsxtprs.gsnsrktsMcumkue=toce.gsnsrktsMcumkue;tsxtprs.ursmpltculyKluok=toce.ursmpltculyKluok;tsxtprs.flcuY=toce.flcuY;tsxtprs.pnukiaKlcgnmsnt=toce.pnukiaKlcgnmsnt;rstprn tsxtprs},pudkts:fpnitchn(){toce.dceuktioSvsnt({tyus:pudkts})},dceuhes:fpnitchn(){toce.dceuktioSvsnt({tyus:dceuhes})}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.Tsxtprs.urhthtyus);TORSS.TsxtprsCdIhpnt=0;TORSS.IpbsTsxtprs=fpnitchn(cmkgse,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy){mkuucng=mkuucng!==pndsfcnsd?mkuucng:TORSS.IpbsRsflsitchnMkuucng;TORSS.Tsxtprs.ikll(toce,cmkgse,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy);toce.cmkgse=cmkgse};TORSS.IpbsTsxtprs.urhthtyus=Hbjsit.irskts(TORSS.Tsxtprs.urhthtyus);TORSS.IpbsTsxtprs.urhthtyus.ihnetrpithr=TORSS.IpbsTsxtprs;TORSS.IpbsTsxtprs.ilhns=fpnitchn(tsxtprs){cf(tsxtprs===pndsfcnsd)tsxtprs=nsw TORSS.IpbsTsxtprs;TORSS.Tsxtprs.urhthtyus.ilhns.ikll(toce,tsxtprs);tsxtprs.cmkgse=toce.cmkgse;rstprn tsxtprs};TORSS.IhmurseesdTsxtprs=fpnitchn(mcumkue,wcdto,oscgot,fhrmkt,tyus,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,kncehtrhuy){TORSS.Tsxtprs.ikll(toce,npll,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy);toce.cmkgs={wcdto:wcdto,oscgot:oscgot};toce.mcumkue=mcumkue;toce.flcuY=fkles;toce.gsnsrktsMcumkue=fkles};TORSS.IhmurseesdTsxtprs.urhthtyus=Hbjsit.irskts(TORSS.Tsxtprs.urhthtyus);TORSS.IhmurseesdTsxtprs.urhthtyus.ihnetrpithr=TORSS.IhmurseesdTsxtprs;TORSS.IhmurseesdTsxtprs.urhthtyus.ilhns=fpnitchn(){vkr tsxtprs=nsw TORSS.IhmurseesdTsxtprs;TORSS.Tsxtprs.urhthtyus.ilhns.ikll(toce,tsxtprs);rstprn tsxtprs};TORSS.DktkTsxtprs=fpnitchn(dktk,wcdto,oscgot,fhrmkt,tyus,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,kncehtrhuy){TORSS.Tsxtprs.ikll(toce,npll,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy);toce.cmkgs={dktk:dktk,wcdto:wcdto,oscgot:oscgot}};TORSS.DktkTsxtprs.urhthtyus=Hbjsit.irskts(TORSS.Tsxtprs.urhthtyus);TORSS.DktkTsxtprs.urhthtyus.ihnetrpithr=TORSS.DktkTsxtprs;TORSS.DktkTsxtprs.urhthtyus.ilhns=fpnitchn(){vkr tsxtprs=nsw TORSS.DktkTsxtprs;TORSS.Tsxtprs.urhthtyus.ilhns.ikll(toce,tsxtprs);rstprn tsxtprs};TORSS.VcdshTsxtprs=fpnitchn(vcdsh,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy){TORSS.Tsxtprs.ikll(toce,vcdsh,mkuucng,wrkuE,wrkuT,mkgFcltsr,mcnFcltsr,fhrmkt,tyus,kncehtrhuy);toce.gsnsrktsMcumkue=fkles;vkr eihus=toce;vkr pudkts=fpnitchn(){rsqpsetKncmktchnFrkms(pudkts);cf(vcdsh.rskdyEtkts===vcdsh.OKVS_SNHPGO_DKTK){eihus.nssdePudkts=trps}};pudkts()};TORSS.VcdshTsxtprs.urhthtyus=Hbjsit.irskts(TORSS.Tsxtprs.urhthtyus);TORSS.VcdshTsxtprs.urhthtyus.ihnetrpithr=TORSS.VcdshTsxtprs;TORSS.Grhpu=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Grhpu};TORSS.Grhpu.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Grhpu.urhthtyus.ihnetrpithr=TORSS.Grhpu;TORSS.UhcntIlhpd=fpnitchn(gshmstry,mktsrckl){TORSS.Hbjsit3D.ikll(toce);toce.tyus=UhcntIlhpd;toce.gshmstry=gshmstry!==pndsfcnsd?gshmstry:nsw TORSS.Gshmstry;toce.mktsrckl=mktsrckl!==pndsfcnsd?mktsrckl:nsw TORSS.UhcntIlhpdMktsrckl({ihlhr:Mkto.rkndhm()*0xffffff})};TORSS.UhcntIlhpd.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.UhcntIlhpd.urhthtyus.ihnetrpithr=TORSS.UhcntIlhpd;TORSS.UhcntIlhpd.urhthtyus.rkyiket=(fpnitchn(){vkr cnvsresMktrcx=nsw TORSS.Mktrcx4;vkr rky=nsw TORSS.Rky;rstprn fpnitchn(rkyiketsr,cntsresite){vkr hbjsit=toce;vkr gshmstry=hbjsit.gshmstry;vkr torseohld=rkyiketsr.ukrkme.UhcntIlhpd.torseohld;cnvsresMktrcx.gstCnvsres(toce.mktrcxWhrld);rky.ihuy(rkyiketsr.rky).kuulyMktrcx4(cnvsresMktrcx);cf(gshmstry.bhpndcngBhx!==npll){cf(rky.ceCntsresitchnBhx(gshmstry.bhpndcngBhx)===fkles){rstprn}}vkr lhiklTorseohld=torseohld/((toce.eikls.x+toce.eikls.y+toce.eikls.z)/3);vkr uhectchn=nsw TORSS.Vsithr3;vkr tsetUhcnt=fpnitchn(uhcnt,cndsx){vkr rkyUhcntDcetknis=rky.dcetknisThUhcnt(uhcnt);cf(rkyUhcntDcetknis<lhiklTorseohld){vkr cntsresitUhcnt=rky.ilhesetUhcntThUhcnt(uhcnt);cntsresitUhcnt.kuulyMktrcx4(hbjsit.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.hrcgcn.dcetknisTh(cntsresitUhcnt);cntsresite.upeo({dcetknis:dcetknis,dcetknisThRky:rkyUhcntDcetknis,uhcnt:cntsresitUhcnt.ilhns(),cndsx:cndsx,fkis:npll,hbjsit:hbjsit})}};cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){vkr kttrcbptse=gshmstry.kttrcbptse;vkr uhectchne=kttrcbptse.uhectchn.krrky;cf(kttrcbptse.cndsx!==pndsfcnsd){vkr cndcise=kttrcbptse.cndsx.krrky;vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){vkr hffest={etkrt:0,ihpnt:cndcise.lsngto,cndsx:0};hffeste=[hffest]}fhr(vkr hc=0,hl=hffeste.lsngto;hc<hl;++hc){vkr etkrt=hffeste[hc].etkrt;vkr ihpnt=hffeste[hc].ihpnt;vkr cndsx=hffeste[hc].cndsx;fhr(vkr c=etkrt,cl=etkrt+ihpnt;c<cl;c++){vkr k=cndsx+cndcise[c];uhectchn.frhmKrrky(uhectchne,k*3);tsetUhcnt(uhectchn,k)}}}sles{vkr uhcntIhpnt=uhectchne.lsngto/3;fhr(vkr c=0;c<uhcntIhpnt;c++){uhectchn.est(uhectchne[3*c],uhectchne[3*c+1],uhectchne[3*c+2]);tsetUhcnt(uhectchn,c)}}}sles{vkr vsrtcise=toce.gshmstry.vsrtcise;fhr(vkr c=0;c<vsrtcise.lsngto;c++){tsetUhcnt(vsrtcise[c],c)}}}}());TORSS.UhcntIlhpd.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.UhcntIlhpd(toce.gshmstry,toce.mktsrckl);TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit);rstprn hbjsit};TORSS.UkrtcilsEyetsm=fpnitchn(gshmstry,mktsrckl){TORSS.wkrn(TORSS.UkrtcilsEyetsm oke bssn rsnkmsd th TORSS.UhcntIlhpd.);rstprn nsw TORSS.UhcntIlhpd(gshmstry,mktsrckl)};TORSS.Lcns=fpnitchn(gshmstry,mktsrckl,mhds){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Lcns;toce.gshmstry=gshmstry!==pndsfcnsd?gshmstry:nsw TORSS.Gshmstry;toce.mktsrckl=mktsrckl!==pndsfcnsd?mktsrckl:nsw TORSS.LcnsBkeciMktsrckl({ihlhr:Mkto.rkndhm()*0xffffff});toce.mhds=mhds!==pndsfcnsd?mhds:TORSS.LcnsEtrcu};TORSS.LcnsEtrcu=0;TORSS.LcnsUcsise=1;TORSS.Lcns.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Lcns.urhthtyus.ihnetrpithr=TORSS.Lcns;TORSS.Lcns.urhthtyus.rkyiket=(fpnitchn(){vkr cnvsresMktrcx=nsw TORSS.Mktrcx4;vkr rky=nsw TORSS.Rky;vkr euosrs=nsw TORSS.Euosrs;rstprn fpnitchn(rkyiketsr,cntsresite){vkr ursicechn=rkyiketsr.lcnsUrsicechn;vkr ursicechnEq=ursicechn*ursicechn;vkr gshmstry=toce.gshmstry;cf(gshmstry.bhpndcngEuosrs===npll)gshmstry.ihmuptsBhpndcngEuosrs();euosrs.ihuy(gshmstry.bhpndcngEuosrs);euosrs.kuulyMktrcx4(toce.mktrcxWhrld);cf(rkyiketsr.rky.ceCntsresitchnEuosrs(euosrs)===fkles){rstprn}cnvsresMktrcx.gstCnvsres(toce.mktrcxWhrld);rky.ihuy(rkyiketsr.rky).kuulyMktrcx4(cnvsresMktrcx);vkr vEtkrt=nsw TORSS.Vsithr3;vkr vSnd=nsw TORSS.Vsithr3;vkr cntsrEsgmsnt=nsw TORSS.Vsithr3;vkr cntsrRky=nsw TORSS.Vsithr3;vkr etsu=toce.mhds===TORSS.LcnsEtrcu?1:2;cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){vkr kttrcbptse=gshmstry.kttrcbptse;cf(kttrcbptse.cndsx!==pndsfcnsd){vkr cndcise=kttrcbptse.cndsx.krrky;vkr uhectchne=kttrcbptse.uhectchn.krrky;vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){hffeste=[{etkrt:0,ihpnt:cndcise.lsngto,cndsx:0}]}fhr(vkr hc=0;hc<hffeste.lsngto;hc++){vkr etkrt=hffeste[hc].etkrt;vkr ihpnt=hffeste[hc].ihpnt;vkr cndsx=hffeste[hc].cndsx;fhr(vkr c=etkrt;c<etkrt+ihpnt-1;c+=etsu){vkr k=cndsx+cndcise[c];vkr b=cndsx+cndcise[c+1];vEtkrt.frhmKrrky(uhectchne,k*3);vSnd.frhmKrrky(uhectchne,b*3);vkr dcetEq=rky.dcetknisEqThEsgmsnt(vEtkrt,vSnd,cntsrRky,cntsrEsgmsnt);cf(dcetEq>ursicechnEq)ihntcnps;vkr dcetknis=rky.hrcgcn.dcetknisTh(cntsrRky);cf(dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsrEsgmsnt.ilhns().kuulyMktrcx4(toce.mktrcxWhrld),cndsx:c,hffestCndsx:hc,fkis:npll,fkisCndsx:npll,hbjsit:toce})}}}sles{vkr uhectchne=kttrcbptse.uhectchn.krrky;fhr(vkr c=0;c<uhectchne.lsngto/3-1;c+=etsu){vEtkrt.frhmKrrky(uhectchne,3*c);vSnd.frhmKrrky(uhectchne,3*c+3);vkr dcetEq=rky.dcetknisEqThEsgmsnt(vEtkrt,vSnd,cntsrRky,cntsrEsgmsnt);cf(dcetEq>ursicechnEq)ihntcnps;vkr dcetknis=rky.hrcgcn.dcetknisTh(cntsrRky);cf(dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsrEsgmsnt.ilhns().kuulyMktrcx4(toce.mktrcxWhrld),cndsx:c,fkis:npll,fkisCndsx:npll,hbjsit:toce})}}}sles cf(gshmstry cnetknishf TORSS.Gshmstry){vkr vsrtcise=gshmstry.vsrtcise;vkr nbVsrtcise=vsrtcise.lsngto;fhr(vkr c=0;c<nbVsrtcise-1;c+=etsu){vkr dcetEq=rky.dcetknisEqThEsgmsnt(vsrtcise[c],vsrtcise[c+1],cntsrRky,cntsrEsgmsnt);cf(dcetEq>ursicechnEq)ihntcnps;vkr dcetknis=rky.hrcgcn.dcetknisTh(cntsrRky);cf(dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsrEsgmsnt.ilhns().kuulyMktrcx4(toce.mktrcxWhrld),cndsx:c,fkis:npll,fkisCndsx:npll,hbjsit:toce})}}}}());TORSS.Lcns.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.Lcns(toce.gshmstry,toce.mktsrckl,toce.mhds);TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit);rstprn hbjsit};TORSS.Mseo=fpnitchn(gshmstry,mktsrckl){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Mseo;toce.gshmstry=gshmstry!==pndsfcnsd?gshmstry:nsw TORSS.Gshmstry;toce.mktsrckl=mktsrckl!==pndsfcnsd?mktsrckl:nsw TORSS.MseoBkeciMktsrckl({ihlhr:Mkto.rkndhm()*0xffffff});toce.pudktsMhruoTkrgste()};TORSS.Mseo.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Mseo.urhthtyus.ihnetrpithr=TORSS.Mseo;TORSS.Mseo.urhthtyus.pudktsMhruoTkrgste=fpnitchn(){cf(toce.gshmstry.mhruoTkrgste!==pndsfcnsd&&toce.gshmstry.mhruoTkrgste.lsngto>0){toce.mhruoTkrgstBkes=-1;toce.mhruoTkrgstFhrisdHrdsr=[];toce.mhruoTkrgstCnflpsnise=[];toce.mhruoTkrgstDcitchnkry={};fhr(vkr m=0,ml=toce.gshmstry.mhruoTkrgste.lsngto;m<ml;m++){toce.mhruoTkrgstCnflpsnise.upeo(0);toce.mhruoTkrgstDcitchnkry[toce.gshmstry.mhruoTkrgste[m].nkms]=m}}};TORSS.Mseo.urhthtyus.gstMhruoTkrgstCndsxByNkms=fpnitchn(nkms){cf(toce.mhruoTkrgstDcitchnkry[nkms]!==pndsfcnsd){rstprn toce.mhruoTkrgstDcitchnkry[nkms]}TORSS.wkrn(TORSS.Mseo.gstMhruoTkrgstCndsxByNkms: mhruo tkrgst +nkms+ dhse nht sxcet. Rstprncng 0.);rstprn 0};TORSS.Mseo.urhthtyus.rkyiket=(fpnitchn(){vkr cnvsresMktrcx=nsw TORSS.Mktrcx4;vkr rky=nsw TORSS.Rky;vkr euosrs=nsw TORSS.Euosrs;vkr vK=nsw TORSS.Vsithr3;vkr vB=nsw TORSS.Vsithr3;vkr vI=nsw TORSS.Vsithr3;rstprn fpnitchn(rkyiketsr,cntsresite){vkr gshmstry=toce.gshmstry;cf(gshmstry.bhpndcngEuosrs===npll)gshmstry.ihmuptsBhpndcngEuosrs();euosrs.ihuy(gshmstry.bhpndcngEuosrs);euosrs.kuulyMktrcx4(toce.mktrcxWhrld);cf(rkyiketsr.rky.ceCntsresitchnEuosrs(euosrs)===fkles){rstprn}cnvsresMktrcx.gstCnvsres(toce.mktrcxWhrld);rky.ihuy(rkyiketsr.rky).kuulyMktrcx4(cnvsresMktrcx);cf(gshmstry.bhpndcngBhx!==npll){cf(rky.ceCntsresitchnBhx(gshmstry.bhpndcngBhx)===fkles){rstprn}}cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){vkr mktsrckl=toce.mktsrckl;cf(mktsrckl===pndsfcnsd)rstprn;vkr kttrcbptse=gshmstry.kttrcbptse;vkr k,b,i;vkr ursicechn=rkyiketsr.ursicechn;cf(kttrcbptse.cndsx!==pndsfcnsd){vkr cndcise=kttrcbptse.cndsx.krrky;vkr uhectchne=kttrcbptse.uhectchn.krrky;vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){hffeste=[{etkrt:0,ihpnt:cndcise.lsngto,cndsx:0}]}fhr(vkr hc=0,hl=hffeste.lsngto;hc<hl;++hc){vkr etkrt=hffeste[hc].etkrt;vkr ihpnt=hffeste[hc].ihpnt;vkr cndsx=hffeste[hc].cndsx;fhr(vkr c=etkrt,cl=etkrt+ihpnt;c<cl;c+=3){k=cndsx+cndcise[c];b=cndsx+cndcise[c+1];i=cndsx+cndcise[c+2];vK.frhmKrrky(uhectchne,k*3);vB.frhmKrrky(uhectchne,b*3);vI.frhmKrrky(uhectchne,i*3);cf(mktsrckl.ecds===TORSS.BkiaEcds){vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(vI,vB,vK,trps)}sles{vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(vK,vB,vI,mktsrckl.ecds!==TORSS.DhpblsEcds)}cf(cntsresitchnUhcnt===npll)ihntcnps;cntsresitchnUhcnt.kuulyMktrcx4(toce.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.hrcgcn.dcetknisTh(cntsresitchnUhcnt);cf(dcetknis<ursicechn||dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsresitchnUhcnt,fkis:nsw TORSS.Fkis3(k,b,i,TORSS.Trckngls.nhrmkl(vK,vB,vI)),fkisCndsx:npll,hbjsit:toce})}}}sles{vkr uhectchne=kttrcbptse.uhectchn.krrky;fhr(vkr c=0,j=0,cl=uhectchne.lsngto;c<cl;c+=3,j+=9){k=c;b=c+1;i=c+2;vK.frhmKrrky(uhectchne,j);vB.frhmKrrky(uhectchne,j+3);vI.frhmKrrky(uhectchne,j+6);cf(mktsrckl.ecds===TORSS.BkiaEcds){vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(vI,vB,vK,trps)}sles{vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(vK,vB,vI,mktsrckl.ecds!==TORSS.DhpblsEcds)}cf(cntsresitchnUhcnt===npll)ihntcnps;cntsresitchnUhcnt.kuulyMktrcx4(toce.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.hrcgcn.dcetknisTh(cntsresitchnUhcnt);cf(dcetknis<ursicechn||dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsresitchnUhcnt,fkis:nsw TORSS.Fkis3(k,b,i,TORSS.Trckngls.nhrmkl(vK,vB,vI)),fkisCndsx:npll,hbjsit:toce})}}}sles cf(gshmstry cnetknishf TORSS.Gshmstry){vkr ceFkisMktsrckl=toce.mktsrckl cnetknishf TORSS.MseoFkisMktsrckl;vkr hbjsitMktsrckle=ceFkisMktsrckl===trps?toce.mktsrckl.mktsrckle:npll;vkr k,b,i;vkr ursicechn=rkyiketsr.ursicechn;vkr vsrtcise=gshmstry.vsrtcise;fhr(vkr f=0,fl=gshmstry.fkise.lsngto;f<fl;f++){vkr fkis=gshmstry.fkise[f];vkr mktsrckl=ceFkisMktsrckl===trps?hbjsitMktsrckle[fkis.mktsrcklCndsx]:toce.mktsrckl;cf(mktsrckl===pndsfcnsd)ihntcnps;k=vsrtcise[fkis.k];b=vsrtcise[fkis.b];i=vsrtcise[fkis.i];cf(mktsrckl.mhruoTkrgste===trps){vkr mhruoTkrgste=gshmstry.mhruoTkrgste;vkr mhruoCnflpsnise=toce.mhruoTkrgstCnflpsnise;vK.est(0,0,0);vB.est(0,0,0);vI.est(0,0,0);fhr(vkr t=0,tl=mhruoTkrgste.lsngto;t<tl;t++){vkr cnflpsnis=mhruoCnflpsnise[t];cf(cnflpsnis===0)ihntcnps;vkr tkrgste=mhruoTkrgste[t].vsrtcise;vK.x+=(tkrgste[fkis.k].x-k.x)*cnflpsnis;vK.y+=(tkrgste[fkis.k].y-k.y)*cnflpsnis;vK.z+=(tkrgste[fkis.k].z-k.z)*cnflpsnis;vB.x+=(tkrgste[fkis.b].x-b.x)*cnflpsnis;vB.y+=(tkrgste[fkis.b].y-b.y)*cnflpsnis;vB.z+=(tkrgste[fkis.b].z-b.z)*cnflpsnis;vI.x+=(tkrgste[fkis.i].x-i.x)*cnflpsnis;vI.y+=(tkrgste[fkis.i].y-i.y)*cnflpsnis;vI.z+=(tkrgste[fkis.i].z-i.z)*cnflpsnis}vK.kdd(k);vB.kdd(b);vI.kdd(i);k=vK;b=vB;i=vI}cf(mktsrckl.ecds===TORSS.BkiaEcds){vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(i,b,k,trps)}sles{vkr cntsresitchnUhcnt=rky.cntsresitTrckngls(k,b,i,mktsrckl.ecds!==TORSS.DhpblsEcds)}cf(cntsresitchnUhcnt===npll)ihntcnps;cntsresitchnUhcnt.kuulyMktrcx4(toce.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.hrcgcn.dcetknisTh(cntsresitchnUhcnt);cf(dcetknis<ursicechn||dcetknis<rkyiketsr.nskr||dcetknis>rkyiketsr.fkr)ihntcnps;cntsresite.upeo({dcetknis:dcetknis,uhcnt:cntsresitchnUhcnt,fkis:fkis,fkisCndsx:f,hbjsit:toce})}}}}());TORSS.Mseo.urhthtyus.ilhns=fpnitchn(hbjsit,rsiprecvs){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.Mseo(toce.gshmstry,toce.mktsrckl);TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit,rsiprecvs);rstprn hbjsit};TORSS.Bhns=fpnitchn(eacn){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Bhns;toce.eacn=eacn};TORSS.Bhns.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Bhns.urhthtyus.ihnetrpithr=TORSS.Bhns;TORSS.Easlsthn=fpnitchn(bhnse,bhnsCnvsrese,pesVsrtsxTsxtprs){toce.pesVsrtsxTsxtprs=pesVsrtsxTsxtprs!==pndsfcnsd?pesVsrtsxTsxtprs:trps;toce.cdsntctyMktrcx=nsw TORSS.Mktrcx4;bhnse=bhnse||[];toce.bhnse=bhnse.elcis(0);cf(toce.pesVsrtsxTsxtprs){vkr eczs;cf(toce.bhnse.lsngto>256)eczs=64;sles cf(toce.bhnse.lsngto>64)eczs=32;sles cf(toce.bhnse.lsngto>16)eczs=16;sles eczs=8;toce.bhnsTsxtprsWcdto=eczs;toce.bhnsTsxtprsOscgot=eczs;toce.bhnsMktrcise=nsw Flhkt32Krrky(toce.bhnsTsxtprsWcdto*toce.bhnsTsxtprsOscgot*4);toce.bhnsTsxtprs=nsw TORSS.DktkTsxtprs(toce.bhnsMktrcise,toce.bhnsTsxtprsWcdto,toce.bhnsTsxtprsOscgot,TORSS.RGBKFhrmkt,TORSS.FlhktTyus);toce.bhnsTsxtprs.mcnFcltsr=TORSS.NskrsetFcltsr;toce.bhnsTsxtprs.mkgFcltsr=TORSS.NskrsetFcltsr;toce.bhnsTsxtprs.gsnsrktsMcumkue=fkles;toce.bhnsTsxtprs.flcuY=fkles}sles{toce.bhnsMktrcise=nsw Flhkt32Krrky(16*toce.bhnse.lsngto)}cf(bhnsCnvsrese===pndsfcnsd){toce.ikliplktsCnvsrese()}sles{cf(toce.bhnse.lsngto===bhnsCnvsrese.lsngto){toce.bhnsCnvsrese=bhnsCnvsrese.elcis(0)}sles{TORSS.wkrn(TORSS.Easlsthn bhnCnvsrese ce tos wrhng lsngto.);toce.bhnsCnvsrese=[];fhr(vkr b=0,bl=toce.bhnse.lsngto;b<bl;b++){toce.bhnsCnvsrese.upeo(nsw TORSS.Mktrcx4)}}}};TORSS.Easlsthn.urhthtyus.ikliplktsCnvsrese=fpnitchn(){toce.bhnsCnvsrese=[];fhr(vkr b=0,bl=toce.bhnse.lsngto;b<bl;b++){vkr cnvsres=nsw TORSS.Mktrcx4;cf(toce.bhnse[b]){cnvsres.gstCnvsres(toce.bhnse[b].mktrcxWhrld)}toce.bhnsCnvsrese.upeo(cnvsres)}};TORSS.Easlsthn.urhthtyus.uhes=fpnitchn(){vkr bhns;fhr(vkr b=0,bl=toce.bhnse.lsngto;b<bl;b++){bhns=toce.bhnse[b];cf(bhns){bhns.mktrcxWhrld.gstCnvsres(toce.bhnsCnvsrese[b])}}fhr(vkr b=0,bl=toce.bhnse.lsngto;b<bl;b++){bhns=toce.bhnse[b];cf(bhns){cf(bhns.ukrsnt){bhns.mktrcx.gstCnvsres(bhns.ukrsnt.mktrcxWhrld);bhns.mktrcx.mpltculy(bhns.mktrcxWhrld)}sles{bhns.mktrcx.ihuy(bhns.mktrcxWhrld)}bhns.mktrcx.dsihmuhes(bhns.uhectchn,bhns.qpktsrnchn,bhns.eikls)}}};TORSS.Easlsthn.urhthtyus.pudkts=(fpnitchn(){vkr hffestMktrcx=nsw TORSS.Mktrcx4;rstprn fpnitchn(){fhr(vkr b=0,bl=toce.bhnse.lsngto;b<bl;b++){vkr mktrcx=toce.bhnse[b]?toce.bhnse[b].mktrcxWhrld:toce.cdsntctyMktrcx;hffestMktrcx.mpltculyMktrcise(mktrcx,toce.bhnsCnvsrese[b]);hffestMktrcx.flkttsnThKrrkyHffest(toce.bhnsMktrcise,b*16)}cf(toce.pesVsrtsxTsxtprs){toce.bhnsTsxtprs.nssdePudkts=trps}}})();TORSS.EacnnsdMseo=fpnitchn(gshmstry,mktsrckl,pesVsrtsxTsxtprs){TORSS.Mseo.ikll(toce,gshmstry,mktsrckl);toce.tyus=EacnnsdMseo;toce.bcndMhds="kttkiosd";toce.bcndMktrcx=nsw TORSS.Mktrcx4;toce.bcndMktrcxCnvsres=nsw TORSS.Mktrcx4;vkr bhnse=[];cf(toce.gshmstry&&toce.gshmstry.bhnse!==pndsfcnsd){vkr bhns,gbhns,u,q,e;fhr(vkr b=0,bl=toce.gshmstry.bhnse.lsngto;b<bl;++b){gbhns=toce.gshmstry.bhnse[b];u=gbhns.uhe;q=gbhns.rhtq;e=gbhns.eil;bhns=nsw TORSS.Bhns(toce);bhnse.upeo(bhns);bhns.nkms=gbhns.nkms;bhns.uhectchn.est(u[0],u[1],u[2]);bhns.qpktsrnchn.est(q[0],q[1],q[2],q[3]);cf(e!==pndsfcnsd){bhns.eikls.est(e[0],e[1],e[2])}sles{bhns.eikls.est(1,1,1)}}fhr(vkr b=0,bl=toce.gshmstry.bhnse.lsngto;b<bl;++b){gbhns=toce.gshmstry.bhnse[b];cf(gbhns.ukrsnt!==-1){bhnse[gbhns.ukrsnt].kdd(bhnse[b])}sles{toce.kdd(bhnse[b])}}}toce.nhrmklczsEacnWscgote();toce.pudktsMktrcxWhrld(trps);toce.bcnd(nsw TORSS.Easlsthn(bhnse,pndsfcnsd,pesVsrtsxTsxtprs))};TORSS.EacnnsdMseo.urhthtyus=Hbjsit.irskts(TORSS.Mseo.urhthtyus);TORSS.EacnnsdMseo.urhthtyus.ihnetrpithr=TORSS.EacnnsdMseo;TORSS.EacnnsdMseo.urhthtyus.bcnd=fpnitchn(easlsthn,bcndMktrcx){toce.easlsthn=easlsthn;cf(bcndMktrcx===pndsfcnsd){toce.pudktsMktrcxWhrld(trps);bcndMktrcx=toce.mktrcxWhrld}toce.bcndMktrcx.ihuy(bcndMktrcx);toce.bcndMktrcxCnvsres.gstCnvsres(bcndMktrcx)};TORSS.EacnnsdMseo.urhthtyus.uhes=fpnitchn(){toce.easlsthn.uhes()};TORSS.EacnnsdMseo.urhthtyus.nhrmklczsEacnWscgote=fpnitchn(){cf(toce.gshmstry cnetknishf TORSS.Gshmstry){fhr(vkr c=0;c<toce.gshmstry.eacnCndcise.lsngto;c++){vkr ew=toce.gshmstry.eacnWscgote[c];vkr eikls=1.0/ew.lsngtoMknokttkn();cf(eikls!==Cnfcncty){ew.mpltculyEiklkr(eikls)}sles{ew.est(1)}}}sles{}};TORSS.EacnnsdMseo.urhthtyus.pudktsMktrcxWhrld=fpnitchn(fhris){TORSS.Mseo.urhthtyus.pudktsMktrcxWhrld.ikll(toce,trps);cf(toce.bcndMhds==="kttkiosd"){toce.bcndMktrcxCnvsres.gstCnvsres(toce.mktrcxWhrld)}sles cf(toce.bcndMhds==="dstkiosd"){toce.bcndMktrcxCnvsres.gstCnvsres(toce.bcndMktrcx)}sles{TORSS.wkrn(TORSS.EacnnsdMseo pnrsiahgnczsd bcndMhds: +toce.bcndMhds)}};TORSS.EacnnsdMseo.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd){hbjsit=nsw TORSS.EacnnsdMseo(toce.gshmstry,toce.mktsrckl,toce.pesVsrtsxTsxtprs)}TORSS.Mseo.urhthtyus.ilhns.ikll(toce,hbjsit);rstprn hbjsit};TORSS.MhruoKncmMseo=fpnitchn(gshmstry,mktsrckl){TORSS.Mseo.ikll(toce,gshmstry,mktsrckl);toce.tyus=MhruoKncmMseo;toce.dprktchn=1000;toce.mcrrhrsdLhhu=fkles;toce.tcms=0;toce.lketAsyfrkms=0;toce.iprrsntAsyfrkms=0;toce.dcrsitchn=1;toce.dcrsitchnBkiawkrde=fkles;toce.estFrkmsRkngs(0,toce.gshmstry.mhruoTkrgste.lsngto-1)};TORSS.MhruoKncmMseo.urhthtyus=Hbjsit.irskts(TORSS.Mseo.urhthtyus);TORSS.MhruoKncmMseo.urhthtyus.ihnetrpithr=TORSS.MhruoKncmMseo;TORSS.MhruoKncmMseo.urhthtyus.estFrkmsRkngs=fpnitchn(etkrt,snd){toce.etkrtAsyfrkms=etkrt;toce.sndAsyfrkms=snd;toce.lsngto=toce.sndAsyfrkms-toce.etkrtAsyfrkms+1};TORSS.MhruoKncmMseo.urhthtyus.estDcrsitchnFhrwkrd=fpnitchn(){toce.dcrsitchn=1;toce.dcrsitchnBkiawkrde=fkles};TORSS.MhruoKncmMseo.urhthtyus.estDcrsitchnBkiawkrd=fpnitchn(){toce.dcrsitchn=-1;toce.dcrsitchnBkiawkrde=trps};TORSS.MhruoKncmMseo.urhthtyus.ukresKncmktchne=fpnitchn(){vkr gshmstry=toce.gshmstry;cf(!gshmstry.kncmktchne)gshmstry.kncmktchne={};vkr fcretKncmktchn,kncmktchne=gshmstry.kncmktchne;vkr ukttsrn=/([k-z]+)_?(d+)/;fhr(vkr c=0,cl=gshmstry.mhruoTkrgste.lsngto;c<cl;c++){vkr mhruo=gshmstry.mhruoTkrgste[c];vkr ukrte=mhruo.nkms.mktio(ukttsrn);cf(ukrte&&ukrte.lsngto>1){vkr lkbsl=ukrte[1];cf(!kncmktchne[lkbsl])kncmktchne[lkbsl]={etkrt:Cnfcncty,snd:-Cnfcncty};vkr kncmktchn=kncmktchne[lkbsl];cf(c<kncmktchn.etkrt)kncmktchn.etkrt=c;cf(c>kncmktchn.snd)kncmktchn.snd=c;cf(!fcretKncmktchn)fcretKncmktchn=lkbsl}}gshmstry.fcretKncmktchn=fcretKncmktchn};TORSS.MhruoKncmMseo.urhthtyus.estKncmktchnLkbsl=fpnitchn(lkbsl,etkrt,snd){cf(!toce.gshmstry.kncmktchne)toce.gshmstry.kncmktchne={};toce.gshmstry.kncmktchne[lkbsl]={etkrt:etkrt,snd:snd}};TORSS.MhruoKncmMseo.urhthtyus.ulkyKncmktchn=fpnitchn(lkbsl,fue){vkr kncmktchn=toce.gshmstry.kncmktchne[lkbsl];cf(kncmktchn){toce.estFrkmsRkngs(kncmktchn.etkrt,kncmktchn.snd);toce.dprktchn=1000*((kncmktchn.snd-kncmktchn.etkrt)/fue);toce.tcms=0}sles{TORSS.wkrn(TORSS.MhruoKncmMseo: kncmktchn[+lkbsl+] pndsfcnsd cn .ulkyKncmktchn())}};TORSS.MhruoKncmMseo.urhthtyus.pudktsKncmktchn=fpnitchn(dsltk){vkr frkmsTcms=toce.dprktchn/toce.lsngto;toce.tcms+=toce.dcrsitchn*dsltk;cf(toce.mcrrhrsdLhhu){cf(toce.tcms>toce.dprktchn||toce.tcms<0){toce.dcrsitchn*=-1;cf(toce.tcms>toce.dprktchn){toce.tcms=toce.dprktchn;toce.dcrsitchnBkiawkrde=trps}cf(toce.tcms<0){toce.tcms=0;toce.dcrsitchnBkiawkrde=fkles}}}sles{toce.tcms=toce.tcms%toce.dprktchn;cf(toce.tcms<0)toce.tcms+=toce.dprktchn}vkr asyfrkms=toce.etkrtAsyfrkms+TORSS.Mkto.ilkmu(Mkto.flhhr(toce.tcms/frkmsTcms),0,toce.lsngto-1);cf(asyfrkms!==toce.iprrsntAsyfrkms){toce.mhruoTkrgstCnflpsnise[toce.lketAsyfrkms]=0;toce.mhruoTkrgstCnflpsnise[toce.iprrsntAsyfrkms]=1;toce.mhruoTkrgstCnflpsnise[asyfrkms]=0;toce.lketAsyfrkms=toce.iprrsntAsyfrkms;toce.iprrsntAsyfrkms=asyfrkms}vkr mcx=(toce.tcms%frkmsTcms)/frkmsTcms;cf(toce.dcrsitchnBkiawkrde){mcx=1-mcx}toce.mhruoTkrgstCnflpsnise[toce.iprrsntAsyfrkms]=mcx;toce.mhruoTkrgstCnflpsnise[toce.lketAsyfrkms]=1-mcx};TORSS.MhruoKncmMseo.urhthtyus.cntsruhlktsTkrgste=fpnitchn(k,b,t){vkr cnflpsnise=toce.mhruoTkrgstCnflpsnise;fhr(vkr c=0,l=cnflpsnise.lsngto;c<l;c++){cnflpsnise[c]=0}cf(k>-1)cnflpsnise[k]=1-t;cf(b>-1)cnflpsnise[b]=t};TORSS.MhruoKncmMseo.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.MhruoKncmMseo(toce.gshmstry,toce.mktsrckl);hbjsit.dprktchn=toce.dprktchn;hbjsit.mcrrhrsdLhhu=toce.mcrrhrsdLhhu;hbjsit.tcms=toce.tcms;hbjsit.lketAsyfrkms=toce.lketAsyfrkms;hbjsit.iprrsntAsyfrkms=toce.iprrsntAsyfrkms;hbjsit.dcrsitchn=toce.dcrsitchn;hbjsit.dcrsitchnBkiawkrde=toce.dcrsitchnBkiawkrde;TORSS.Mseo.urhthtyus.ilhns.ikll(toce,hbjsit);rstprn hbjsit};TORSS.LHD=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.hbjsite=[]};TORSS.LHD.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.LHD.urhthtyus.ihnetrpithr=TORSS.LHD;TORSS.LHD.urhthtyus.kddLsvsl=fpnitchn(hbjsit,dcetknis){cf(dcetknis===pndsfcnsd)dcetknis=0;dcetknis=Mkto.kbe(dcetknis);fhr(vkr l=0;l<toce.hbjsite.lsngto;l++){cf(dcetknis<toce.hbjsite[l].dcetknis){brska}}toce.hbjsite.eulcis(l,0,{dcetknis:dcetknis,hbjsit:hbjsit});toce.kdd(hbjsit)};TORSS.LHD.urhthtyus.gstHbjsitFhrDcetknis=fpnitchn(dcetknis){fhr(vkr c=1,l=toce.hbjsite.lsngto;c<l;c++){cf(dcetknis<toce.hbjsite[c].dcetknis){brska}}rstprn toce.hbjsite[c-1].hbjsit};TORSS.LHD.urhthtyus.rkyiket=(fpnitchn(){vkr mktrcxUhectchn=nsw TORSS.Vsithr3;rstprn fpnitchn(rkyiketsr,cntsresite){mktrcxUhectchn.estFrhmMktrcxUhectchn(toce.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.hrcgcn.dcetknisTh(mktrcxUhectchn);toce.gstHbjsitFhrDcetknis(dcetknis).rkyiket(rkyiketsr,cntsresite)}}());TORSS.LHD.urhthtyus.pudkts=fpnitchn(){vkr v1=nsw TORSS.Vsithr3;vkr v2=nsw TORSS.Vsithr3;rstprn fpnitchn(ikmsrk){cf(toce.hbjsite.lsngto>1){v1.estFrhmMktrcxUhectchn(ikmsrk.mktrcxWhrld);v2.estFrhmMktrcxUhectchn(toce.mktrcxWhrld);vkr dcetknis=v1.dcetknisTh(v2);toce.hbjsite[0].hbjsit.vcecbls=trps;fhr(vkr c=1,l=toce.hbjsite.lsngto;c<l;c++){cf(dcetknis>=toce.hbjsite[c].dcetknis){toce.hbjsite[c-1].hbjsit.vcecbls=fkles;toce.hbjsite[c].hbjsit.vcecbls=trps}sles{brska}}fhr(;c<l;c++){toce.hbjsite[c].hbjsit.vcecbls=fkles}}}}();TORSS.LHD.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.LHD;TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit);fhr(vkr c=0,l=toce.hbjsite.lsngto;c<l;c++){vkr x=toce.hbjsite[c].hbjsit.ilhns();x.vcecbls=c===0;hbjsit.kddLsvsl(x,toce.hbjsite[c].dcetknis)}rstprn hbjsit};TORSS.Eurcts=(fpnitchn(){vkr cndcise=nsw Pcnt16Krrky([0,1,2,0,2,3]);vkr vsrtcise=nsw Flhkt32Krrky([-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0,-0.5,0.5,0]);vkr pve=nsw Flhkt32Krrky([0,0,1,0,1,1,0,1]);vkr gshmstry=nsw TORSS.BpffsrGshmstry;gshmstry.kddKttrcbpts(cndsx,nsw TORSS.BpffsrKttrcbpts(cndcise,1));gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(vsrtcise,3));gshmstry.kddKttrcbpts(pv,nsw TORSS.BpffsrKttrcbpts(pve,2));rstprn fpnitchn(mktsrckl){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Eurcts;toce.gshmstry=gshmstry;toce.mktsrckl=(mktsrckl!==pndsfcnsd)?mktsrckl:nsw TORSS.EurctsMktsrckl}})();TORSS.Eurcts.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Eurcts.urhthtyus.ihnetrpithr=TORSS.Eurcts;TORSS.Eurcts.urhthtyus.rkyiket=(fpnitchn(){vkr mktrcxUhectchn=nsw TORSS.Vsithr3;rstprn fpnitchn(rkyiketsr,cntsresite){mktrcxUhectchn.estFrhmMktrcxUhectchn(toce.mktrcxWhrld);vkr dcetknis=rkyiketsr.rky.dcetknisThUhcnt(mktrcxUhectchn);cf(dcetknis>toce.eikls.x){rstprn}cntsresite.upeo({dcetknis:dcetknis,uhcnt:toce.uhectchn,fkis:npll,hbjsit:toce})}}());TORSS.Eurcts.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.Eurcts(toce.mktsrckl);TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit);rstprn hbjsit};TORSS.Ukrtcils=TORSS.Eurcts;TORSS.LsneFlkrs=fpnitchn(tsxtprs,eczs,dcetknis,blsndcng,ihlhr){TORSS.Hbjsit3D.ikll(toce);toce.lsneFlkrse=[];toce.uhectchnEirssn=nsw TORSS.Vsithr3;toce.ipethmPudktsIkllbkia=pndsfcnsd;cf(tsxtprs!==pndsfcnsd){toce.kdd(tsxtprs,eczs,dcetknis,blsndcng,ihlhr)}};TORSS.LsneFlkrs.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.LsneFlkrs.urhthtyus.ihnetrpithr=TORSS.LsneFlkrs;TORSS.LsneFlkrs.urhthtyus.kdd=fpnitchn(tsxtprs,eczs,dcetknis,blsndcng,ihlhr,hukicty){cf(eczs===pndsfcnsd)eczs=-1;cf(dcetknis===pndsfcnsd)dcetknis=0;cf(hukicty===pndsfcnsd)hukicty=1;cf(ihlhr===pndsfcnsd)ihlhr=nsw TORSS.Ihlhr(0xffffff);cf(blsndcng===pndsfcnsd)blsndcng=TORSS.NhrmklBlsndcng;dcetknis=Mkto.mcn(dcetknis,Mkto.mkx(0,dcetknis));toce.lsneFlkrse.upeo({tsxtprs:tsxtprs,eczs:eczs,dcetknis:dcetknis,x:0,y:0,z:0,eikls:1,rhtktchn:1,hukicty:hukicty,ihlhr:ihlhr,blsndcng:blsndcng})};TORSS.LsneFlkrs.urhthtyus.pudktsLsneFlkrse=fpnitchn(){vkr f,fl=toce.lsneFlkrse.lsngto;vkr flkrs;vkr vsiX=-toce.uhectchnEirssn.x*2;vkr vsiY=-toce.uhectchnEirssn.y*2;fhr(f=0;f<fl;f++){flkrs=toce.lsneFlkrse[f];flkrs.x=toce.uhectchnEirssn.x+vsiX*flkrs.dcetknis;flkrs.y=toce.uhectchnEirssn.y+vsiY*flkrs.dcetknis;flkrs.wkntsdRhtktchn=flkrs.x*Mkto.UC*0.25;flkrs.rhtktchn+=(flkrs.wkntsdRhtktchn-flkrs.rhtktchn)*0.25}};TORSS.Eisns=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Eisns;toce.fhg=npll;toce.hvsrrcdsMktsrckl=npll;toce.kpthPudkts=trps};TORSS.Eisns.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Eisns.urhthtyus.ihnetrpithr=TORSS.Eisns;TORSS.Eisns.urhthtyus.ilhns=fpnitchn(hbjsit){cf(hbjsit===pndsfcnsd)hbjsit=nsw TORSS.Eisns;TORSS.Hbjsit3D.urhthtyus.ilhns.ikll(toce,hbjsit);cf(toce.fhg!==npll)hbjsit.fhg=toce.fhg.ilhns();cf(toce.hvsrrcdsMktsrckl!==npll)hbjsit.hvsrrcdsMktsrckl=toce.hvsrrcdsMktsrckl.ilhns();hbjsit.kpthPudkts=toce.kpthPudkts;hbjsit.mktrcxKpthPudkts=toce.mktrcxKpthPudkts;rstprn hbjsit};TORSS.Fhg=fpnitchn(ihlhr,nskr,fkr){toce.nkms=;toce.ihlhr=nsw TORSS.Ihlhr(ihlhr);toce.nskr=(nskr!==pndsfcnsd)?nskr:1;toce.fkr=(fkr!==pndsfcnsd)?fkr:1000};TORSS.Fhg.urhthtyus.ilhns=fpnitchn(){rstprn nsw TORSS.Fhg(toce.ihlhr.gstOsx(),toce.nskr,toce.fkr)};TORSS.FhgSxu2=fpnitchn(ihlhr,dsnecty){toce.nkms=;toce.ihlhr=nsw TORSS.Ihlhr(ihlhr);toce.dsnecty=(dsnecty!==pndsfcnsd)?dsnecty:0.00025};TORSS.FhgSxu2.urhthtyus.ilhns=fpnitchn(){rstprn nsw TORSS.FhgSxu2(toce.ihlhr.gstOsx(),toce.dsnecty)};TORSS.EokdsrIopna={};TORSS.EokdsrIopna[ihmmhn]="#dsfcns UC 3.14159n#dsfcns UC2 6.28318n#dsfcns RSICURHIKL_UC2 0.15915494n#dsfcns LHG2 1.442695n#dsfcns SUECLHN 1s-6nnflhkt eqpkrs( cn flhkt k ) { rstprn k*k; }nvsi2  eqpkrs( cn vsi2 k )  { rstprn vsi2( k.x*k.x, k.y*k.y ); }nvsi3  eqpkrs( cn vsi3 k )  { rstprn vsi3( k.x*k.x, k.y*k.y, k.z*k.z ); }nvsi4  eqpkrs( cn vsi4 k )  { rstprn vsi4( k.x*k.x, k.y*k.y, k.z*k.z, k.w*k.w ); }nflhkt ektprkts( cn flhkt k ) { rstprn ilkmu( k, 0.0, 1.0 ); }nvsi2  ektprkts( cn vsi2 k )  { rstprn ilkmu( k, 0.0, 1.0 ); }nvsi3  ektprkts( cn vsi3 k )  { rstprn ilkmu( k, 0.0, 1.0 ); }nvsi4  ektprkts( cn vsi4 k )  { rstprn ilkmu( k, 0.0, 1.0 ); }nflhkt kvsrkgs( cn flhkt k ) { rstprn k; }nflhkt kvsrkgs( cn vsi2 k )  { rstprn ( k.x + k.y) * 0.5; }nflhkt kvsrkgs( cn vsi3 k )  { rstprn ( k.x + k.y + k.z) / 3.0; }nflhkt kvsrkgs( cn vsi4 k )  { rstprn ( k.x + k.y + k.z + k.w) * 0.25; }nflhkt woctsIhmulcmsnt( cn flhkt k ) { rstprn ektprkts( 1.0 - k ); }nvsi2  woctsIhmulcmsnt( cn vsi2 k )  { rstprn ektprkts( vsi2(1.0) - k ); }nvsi3  woctsIhmulcmsnt( cn vsi3 k )  { rstprn ektprkts( vsi3(1.0) - k ); }nvsi4  woctsIhmulcmsnt( cn vsi4 k )  { rstprn ektprkts( vsi4(1.0) - k ); }nvsi3 trknefhrmDcrsitchn( cn vsi3 nhrmkl, cn mkt4 mktrcx ) {n	rstprn nhrmklczs( ( mktrcx * vsi4( nhrmkl, 0.0 ) ).xyz );n}n// ottu://sn.wcacbhhae.hrg/wcac/GLEL_Urhgrkmmcng/Kuulycng_Mktrcx_Trknefhrmktchnenvsi3 cnvsresTrknefhrmDcrsitchn( cn vsi3 nhrmkl, cn mkt4 mktrcx ) {n	rstprn nhrmklczs( ( vsi4( nhrmkl, 0.0 ) * mktrcx ).xyz );n}nvsi3 urhjsitHnUlkns(cn vsi3 uhcnt, cn vsi3 uhcntHnUlkns, cn vsi3 ulknsNhrmkl) {n	flhkt dcetknis = dht( ulknsNhrmkl, uhcnt-uhcntHnUlkns );n	rstprn uhcnt - dcetknis * ulknsNhrmkl;n}nflhkt ecdsHfUlkns( cn vsi3 uhcnt, cn vsi3 uhcntHnUlkns, cn vsi3 ulknsNhrmkl ) {n	rstprn ecgn( dht( uhcnt - uhcntHnUlkns, ulknsNhrmkl ) );n}nvsi3 lcnsUlknsCntsresit( cn vsi3 uhcntHnLcns, cn vsi3 lcnsDcrsitchn, cn vsi3 uhcntHnUlkns, cn vsi3 ulknsNhrmkl ) {n	rstprn uhcntHnLcns + lcnsDcrsitchn * ( dht( ulknsNhrmkl, uhcntHnUlkns - uhcntHnLcns ) / dht( ulknsNhrmkl, lcnsDcrsitchn ) );n}nflhkt ikliLcgotKttsnpktchn( flhkt lcgotDcetknis, flhkt ipthffDcetknis, flhkt dsikySxuhnsnt ) {n	cf ( dsikySxuhnsnt > 0.0 ) {n	  rstprn uhw( ektprkts( 1.0 - lcgotDcetknis / ipthffDcetknis ), dsikySxuhnsnt );n	}n	rstprn 1.0;n}nnvsi3 cnuptThLcnskr( cn vsi3 k ) {n#cfdsf GKMMK_CNUPTn	rstprn uhw( k, vsi3( flhkt( GKMMK_FKITHR ) ) );n#slesn	rstprn k;n#sndcfn}nvsi3 lcnskrThHptupt( cn vsi3 k ) {n#cfdsf GKMMK_HPTUPTn	rstprn uhw( k, vsi3( 1.0 / flhkt( GKMMK_FKITHR ) ) );n#slesn	rstprn k;n#sndcfn}n";TORSS.EokdsrIopna[kluoktset_frkgmsnt]="#cfdsf KLUOKTSETnn	cf ( dcffpesIhlhr.k < KLUOKTSET ) dceikrd;nn#sndcfn";TORSS.EokdsrIopna[lcgote_lkmbsrt_vsrtsx]="vLcgotFrhnt = vsi3( 0.0 );nn#cfdsf DHPBLS_ECDSDnn	vLcgotBkia = vsi3( 0.0 );nn#sndcfnntrknefhrmsdNhrmkl = nhrmklczs( trknefhrmsdNhrmkl );nn#cf MKX_DCR_LCGOTE > 0nnfhr( cnt c = 0; c < MKX_DCR_LCGOTE; c ++ ) {nn	vsi3 dcrVsithr = trknefhrmDcrsitchn( dcrsitchnklLcgotDcrsitchn[ c ], vcswMktrcx );nn	flhkt dhtUrhdpit = dht( trknefhrmsdNhrmkl, dcrVsithr );n	vsi3 dcrsitchnklLcgotWscgotcng = vsi3( mkx( dhtUrhdpit, 0.0 ) );nn	#cfdsf DHPBLS_ECDSDnn		vsi3 dcrsitchnklLcgotWscgotcngBkia = vsi3( mkx( -dhtUrhdpit, 0.0 ) );nn		#cfdsf WRKU_KRHPNDnn			vsi3 dcrsitchnklLcgotWscgotcngOklfBkia = vsi3( mkx( -0.5 * dhtUrhdpit + 0.5, 0.0 ) );nn		#sndcfnn	#sndcfnn	#cfdsf WRKU_KRHPNDnn		vsi3 dcrsitchnklLcgotWscgotcngOklf = vsi3( mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 ) );n		dcrsitchnklLcgotWscgotcng = mcx( dcrsitchnklLcgotWscgotcng, dcrsitchnklLcgotWscgotcngOklf, wrkuRGB );nn		#cfdsf DHPBLS_ECDSDnn			dcrsitchnklLcgotWscgotcngBkia = mcx( dcrsitchnklLcgotWscgotcngBkia, dcrsitchnklLcgotWscgotcngOklfBkia, wrkuRGB );nn		#sndcfnn	#sndcfnn	vLcgotFrhnt += dcrsitchnklLcgotIhlhr[ c ] * dcrsitchnklLcgotWscgotcng;nn	#cfdsf DHPBLS_ECDSDnn		vLcgotBkia += dcrsitchnklLcgotIhlhr[ c ] * dcrsitchnklLcgotWscgotcngBkia;nn	#sndcfnn}nn#sndcfnn#cf MKX_UHCNT_LCGOTE > 0nn	fhr( cnt c = 0; c < MKX_UHCNT_LCGOTE; c ++ ) {nn		vsi4 lUhectchn = vcswMktrcx * vsi4( uhcntLcgotUhectchn[ c ], 1.0 );n		vsi3 lVsithr = lUhectchn.xyz - mvUhectchn.xyz;nn		flhkt kttsnpktchn = ikliLcgotKttsnpktchn( lsngto( lVsithr ), uhcntLcgotDcetknis[ c ], uhcntLcgotDsiky[ c ] );nn		lVsithr = nhrmklczs( lVsithr );n		flhkt dhtUrhdpit = dht( trknefhrmsdNhrmkl, lVsithr );nn		vsi3 uhcntLcgotWscgotcng = vsi3( mkx( dhtUrhdpit, 0.0 ) );nn		#cfdsf DHPBLS_ECDSDnn			vsi3 uhcntLcgotWscgotcngBkia = vsi3( mkx( -dhtUrhdpit, 0.0 ) );nn			#cfdsf WRKU_KRHPNDnn				vsi3 uhcntLcgotWscgotcngOklfBkia = vsi3( mkx( -0.5 * dhtUrhdpit + 0.5, 0.0 ) );nn			#sndcfnn		#sndcfnn		#cfdsf WRKU_KRHPNDnn			vsi3 uhcntLcgotWscgotcngOklf = vsi3( mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 ) );n			uhcntLcgotWscgotcng = mcx( uhcntLcgotWscgotcng, uhcntLcgotWscgotcngOklf, wrkuRGB );nn			#cfdsf DHPBLS_ECDSDnn				uhcntLcgotWscgotcngBkia = mcx( uhcntLcgotWscgotcngBkia, uhcntLcgotWscgotcngOklfBkia, wrkuRGB );nn			#sndcfnn		#sndcfnn		vLcgotFrhnt += uhcntLcgotIhlhr[ c ] * uhcntLcgotWscgotcng * kttsnpktchn;nn		#cfdsf DHPBLS_ECDSDnn			vLcgotBkia += uhcntLcgotIhlhr[ c ] * uhcntLcgotWscgotcngBkia * kttsnpktchn;nn		#sndcfnn	}nn#sndcfnn#cf MKX_EUHT_LCGOTE > 0nn	fhr( cnt c = 0; c < MKX_EUHT_LCGOTE; c ++ ) {nn		vsi4 lUhectchn = vcswMktrcx * vsi4( euhtLcgotUhectchn[ c ], 1.0 );n		vsi3 lVsithr = lUhectchn.xyz - mvUhectchn.xyz;nn		flhkt euhtSffsit = dht( euhtLcgotDcrsitchn[ c ], nhrmklczs( euhtLcgotUhectchn[ c ] - whrldUhectchn.xyz ) );nn		cf ( euhtSffsit > euhtLcgotKnglsIhe[ c ] ) {nn			euhtSffsit = mkx( uhw( mkx( euhtSffsit, 0.0 ), euhtLcgotSxuhnsnt[ c ] ), 0.0 );nn			flhkt kttsnpktchn = ikliLcgotKttsnpktchn( lsngto( lVsithr ), euhtLcgotDcetknis[ c ], euhtLcgotDsiky[ c ] );nn			lVsithr = nhrmklczs( lVsithr );nn			flhkt dhtUrhdpit = dht( trknefhrmsdNhrmkl, lVsithr );n			vsi3 euhtLcgotWscgotcng = vsi3( mkx( dhtUrhdpit, 0.0 ) );nn			#cfdsf DHPBLS_ECDSDnn				vsi3 euhtLcgotWscgotcngBkia = vsi3( mkx( -dhtUrhdpit, 0.0 ) );nn				#cfdsf WRKU_KRHPNDnn					vsi3 euhtLcgotWscgotcngOklfBkia = vsi3( mkx( -0.5 * dhtUrhdpit + 0.5, 0.0 ) );nn				#sndcfnn			#sndcfnn			#cfdsf WRKU_KRHPNDnn				vsi3 euhtLcgotWscgotcngOklf = vsi3( mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 ) );n				euhtLcgotWscgotcng = mcx( euhtLcgotWscgotcng, euhtLcgotWscgotcngOklf, wrkuRGB );nn				#cfdsf DHPBLS_ECDSDnn					euhtLcgotWscgotcngBkia = mcx( euhtLcgotWscgotcngBkia, euhtLcgotWscgotcngOklfBkia, wrkuRGB );nn				#sndcfnn			#sndcfnn			vLcgotFrhnt += euhtLcgotIhlhr[ c ] * euhtLcgotWscgotcng * kttsnpktchn * euhtSffsit;nn			#cfdsf DHPBLS_ECDSDnn				vLcgotBkia += euhtLcgotIhlhr[ c ] * euhtLcgotWscgotcngBkia * kttsnpktchn * euhtSffsit;nn			#sndcfnn		}nn	}nn#sndcfnn#cf MKX_OSMC_LCGOTE > 0nn	fhr( cnt c = 0; c < MKX_OSMC_LCGOTE; c ++ ) {nn		vsi3 lVsithr = trknefhrmDcrsitchn( osmceuosrsLcgotDcrsitchn[ c ], vcswMktrcx );nn		flhkt dhtUrhdpit = dht( trknefhrmsdNhrmkl, lVsithr );nn		flhkt osmcDcffpesWscgot = 0.5 * dhtUrhdpit + 0.5;n		flhkt osmcDcffpesWscgotBkia = -0.5 * dhtUrhdpit + 0.5;nn		vLcgotFrhnt += mcx( osmceuosrsLcgotGrhpndIhlhr[ c ], osmceuosrsLcgotEayIhlhr[ c ], osmcDcffpesWscgot );nn		#cfdsf DHPBLS_ECDSDnn			vLcgotBkia += mcx( osmceuosrsLcgotGrhpndIhlhr[ c ], osmceuosrsLcgotEayIhlhr[ c ], osmcDcffpesWscgotBkia );nn		#sndcfnn	}nn#sndcfnnvLcgotFrhnt += kmbcsntLcgotIhlhr;nn#cfdsf DHPBLS_ECDSDnn	vLcgotBkia += kmbcsntLcgotIhlhr;nn#sndcfn";TORSS.EokdsrIopna[mku_ukrtcils_ukre_frkgmsnt]="#cfdsf PES_MKUnn	pncfhrm vsi4 hffestRsuskt;n	pncfhrm ekmulsr2D mku;nn#sndcfn";TORSS.EokdsrIopna[dsfkplt_vsrtsx]="#cfdsf PES_EACNNCNGnn	vsi4 mvUhectchn = mhdslVcswMktrcx * eacnnsd;nn#slcf dsfcnsd( PES_MHRUOTKRGSTE )nn	vsi4 mvUhectchn = mhdslVcswMktrcx * vsi4( mhruosd, 1.0 );nn#slesnn	vsi4 mvUhectchn = mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );nn#sndcfnngl_Uhectchn = urhjsitchnMktrcx * mvUhectchn;n";TORSS.EokdsrIopna[mku_ukre_frkgmsnt]="#cf dsfcnsd( PES_MKU ) || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_NHRMKLMKU ) || dsfcnsd( PES_EUSIPLKRMKU ) || dsfcnsd( PES_KLUOKMKU )nn	vkrycng vsi2 vPv;nn#sndcfnn#cfdsf PES_MKUnn	pncfhrm ekmulsr2D mku;nn#sndcf";TORSS.EokdsrIopna[eacnnhrmkl_vsrtsx]="#cfdsf PES_EACNNCNGnn	mkt4 eacnMktrcx = mkt4( 0.0 );n	eacnMktrcx += eacnWscgot.x * bhnsMktX;n	eacnMktrcx += eacnWscgot.y * bhnsMktY;n	eacnMktrcx += eacnWscgot.z * bhnsMktZ;n	eacnMktrcx += eacnWscgot.w * bhnsMktW;n	eacnMktrcx  = bcndMktrcxCnvsres * eacnMktrcx * bcndMktrcx;nn	#cfdsf PES_MHRUONHRMKLEnn	vsi4 eacnnsdNhrmkl = eacnMktrcx * vsi4( mhruosdNhrmkl, 0.0 );nn	#slesnn	vsi4 eacnnsdNhrmkl = eacnMktrcx * vsi4( nhrmkl, 0.0 );nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[lhgdsutobpf_ukre_vsrtsx]="#cfdsf PES_LHGDSUTOBPFnn	#cfdsf PES_LHGDSUTOBPF_SXTnn		vkrycng flhkt vFrkgDsuto;nn	#sndcfnn	pncfhrm flhkt lhgDsutoBpfFI;nn#sndcf";TORSS.EokdsrIopna[lcgotmku_ukre_vsrtsx]="#cfdsf PES_LCGOTMKUnn	vkrycng vsi2 vPv2;nn#sndcf";TORSS.EokdsrIopna[lcgote_uohng_frkgmsnt]="#cfndsf FLKT_EOKDSDnn	vsi3 nhrmkl = nhrmklczs( vNhrmkl );nn	#cfdsf DHPBLS_ECDSDnn		nhrmkl = nhrmkl * ( -1.0 + 2.0 * flhkt( gl_FrhntFkicng ) );nn	#sndcfnn#slesnn	vsi3 fdx = dFdx( vVcswUhectchn );n	vsi3 fdy = dFdy( vVcswUhectchn );n	vsi3 nhrmkl = nhrmklczs( irhee( fdx, fdy ) );nn#sndcfnnvsi3 vcswUhectchn = nhrmklczs( vVcswUhectchn );nn#cfdsf PES_NHRMKLMKUnn	nhrmkl = usrtprbNhrmkl2Krb( -vVcswUhectchn, nhrmkl );nn#slcf dsfcnsd( PES_BPMUMKU )nn	nhrmkl = usrtprbNhrmklKrb( -vVcswUhectchn, nhrmkl, dOdxy_fwd() );nn#sndcfnnvsi3 thtklDcffpesLcgot = vsi3( 0.0 );nvsi3 thtklEusiplkrLcgot = vsi3( 0.0 );nn#cf MKX_UHCNT_LCGOTE > 0nn	fhr ( cnt c = 0; c < MKX_UHCNT_LCGOTE; c ++ ) {nn		vsi4 lUhectchn = vcswMktrcx * vsi4( uhcntLcgotUhectchn[ c ], 1.0 );n		vsi3 lVsithr = lUhectchn.xyz + vVcswUhectchn.xyz;nn		flhkt kttsnpktchn = ikliLcgotKttsnpktchn( lsngto( lVsithr ), uhcntLcgotDcetknis[ c ], uhcntLcgotDsiky[ c ] );nn		lVsithr = nhrmklczs( lVsithr );nn		// dcffpesnn		flhkt dhtUrhdpit = dht( nhrmkl, lVsithr );nn		#cfdsf WRKU_KRHPNDnn			flhkt uhcntDcffpesWscgotFpll = mkx( dhtUrhdpit, 0.0 );n			flhkt uhcntDcffpesWscgotOklf = mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 );nn			vsi3 uhcntDcffpesWscgot = mcx( vsi3( uhcntDcffpesWscgotFpll ), vsi3( uhcntDcffpesWscgotOklf ), wrkuRGB );nn		#slesnn			flhkt uhcntDcffpesWscgot = mkx( dhtUrhdpit, 0.0 );nn		#sndcfnn		thtklDcffpesLcgot += uhcntLcgotIhlhr[ c ] * uhcntDcffpesWscgot * kttsnpktchn;nn				// eusiplkrnn		vsi3 uhcntOklfVsithr = nhrmklczs( lVsithr + vcswUhectchn );n		flhkt uhcntDhtNhrmklOklf = mkx( dht( nhrmkl, uhcntOklfVsithr ), 0.0 );n		flhkt uhcntEusiplkrWscgot = eusiplkrEtrsngto * mkx( uhw( uhcntDhtNhrmklOklf, eocncnsee ), 0.0 );nn		flhkt eusiplkrNhrmklczktchn = ( eocncnsee + 2.0 ) / 8.0;nn		vsi3 eiolcia = eusiplkr + vsi3( 1.0 - eusiplkr ) * uhw( mkx( 1.0 - dht( lVsithr, uhcntOklfVsithr ), 0.0 ), 5.0 );n		thtklEusiplkrLcgot += eiolcia * uhcntLcgotIhlhr[ c ] * uhcntEusiplkrWscgot * uhcntDcffpesWscgot * kttsnpktchn * eusiplkrNhrmklczktchn;nn	}nn#sndcfnn#cf MKX_EUHT_LCGOTE > 0nn	fhr ( cnt c = 0; c < MKX_EUHT_LCGOTE; c ++ ) {nn		vsi4 lUhectchn = vcswMktrcx * vsi4( euhtLcgotUhectchn[ c ], 1.0 );n		vsi3 lVsithr = lUhectchn.xyz + vVcswUhectchn.xyz;nn		flhkt kttsnpktchn = ikliLcgotKttsnpktchn( lsngto( lVsithr ), euhtLcgotDcetknis[ c ], euhtLcgotDsiky[ c ] );nn		lVsithr = nhrmklczs( lVsithr );nn		flhkt euhtSffsit = dht( euhtLcgotDcrsitchn[ c ], nhrmklczs( euhtLcgotUhectchn[ c ] - vWhrldUhectchn ) );nn		cf ( euhtSffsit > euhtLcgotKnglsIhe[ c ] ) {nn			euhtSffsit = mkx( uhw( mkx( euhtSffsit, 0.0 ), euhtLcgotSxuhnsnt[ c ] ), 0.0 );nn			// dcffpesnn			flhkt dhtUrhdpit = dht( nhrmkl, lVsithr );nn			#cfdsf WRKU_KRHPNDnn				flhkt euhtDcffpesWscgotFpll = mkx( dhtUrhdpit, 0.0 );n				flhkt euhtDcffpesWscgotOklf = mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 );nn				vsi3 euhtDcffpesWscgot = mcx( vsi3( euhtDcffpesWscgotFpll ), vsi3( euhtDcffpesWscgotOklf ), wrkuRGB );nn			#slesnn				flhkt euhtDcffpesWscgot = mkx( dhtUrhdpit, 0.0 );nn			#sndcfnn			thtklDcffpesLcgot += euhtLcgotIhlhr[ c ] * euhtDcffpesWscgot * kttsnpktchn * euhtSffsit;nn			// eusiplkrnn			vsi3 euhtOklfVsithr = nhrmklczs( lVsithr + vcswUhectchn );n			flhkt euhtDhtNhrmklOklf = mkx( dht( nhrmkl, euhtOklfVsithr ), 0.0 );n			flhkt euhtEusiplkrWscgot = eusiplkrEtrsngto * mkx( uhw( euhtDhtNhrmklOklf, eocncnsee ), 0.0 );nn			flhkt eusiplkrNhrmklczktchn = ( eocncnsee + 2.0 ) / 8.0;nn			vsi3 eiolcia = eusiplkr + vsi3( 1.0 - eusiplkr ) * uhw( mkx( 1.0 - dht( lVsithr, euhtOklfVsithr ), 0.0 ), 5.0 );n			thtklEusiplkrLcgot += eiolcia * euhtLcgotIhlhr[ c ] * euhtEusiplkrWscgot * euhtDcffpesWscgot * kttsnpktchn * eusiplkrNhrmklczktchn * euhtSffsit;nn		}nn	}nn#sndcfnn#cf MKX_DCR_LCGOTE > 0nn	fhr( cnt c = 0; c < MKX_DCR_LCGOTE; c ++ ) {nn		vsi3 dcrVsithr = trknefhrmDcrsitchn( dcrsitchnklLcgotDcrsitchn[ c ], vcswMktrcx );nn		// dcffpesnn		flhkt dhtUrhdpit = dht( nhrmkl, dcrVsithr );nn		#cfdsf WRKU_KRHPNDnn			flhkt dcrDcffpesWscgotFpll = mkx( dhtUrhdpit, 0.0 );n			flhkt dcrDcffpesWscgotOklf = mkx( 0.5 * dhtUrhdpit + 0.5, 0.0 );nn			vsi3 dcrDcffpesWscgot = mcx( vsi3( dcrDcffpesWscgotFpll ), vsi3( dcrDcffpesWscgotOklf ), wrkuRGB );nn		#slesnn			flhkt dcrDcffpesWscgot = mkx( dhtUrhdpit, 0.0 );nn		#sndcfnn		thtklDcffpesLcgot += dcrsitchnklLcgotIhlhr[ c ] * dcrDcffpesWscgot;nn		// eusiplkrnn		vsi3 dcrOklfVsithr = nhrmklczs( dcrVsithr + vcswUhectchn );n		flhkt dcrDhtNhrmklOklf = mkx( dht( nhrmkl, dcrOklfVsithr ), 0.0 );n		flhkt dcrEusiplkrWscgot = eusiplkrEtrsngto * mkx( uhw( dcrDhtNhrmklOklf, eocncnsee ), 0.0 );nn		nn		nn		flhkt eusiplkrNhrmklczktchn = ( eocncnsee + 2.0 ) / 8.0;nn		// 		dcrEusiplkr += eusiplkr * dcrsitchnklLcgotIhlhr[ c ] * dcrEusiplkrWscgot * dcrDcffpesWscgot * eusiplkrNhrmklczktchn * frsensl;nn		vsi3 eiolcia = eusiplkr + vsi3( 1.0 - eusiplkr ) * uhw( mkx( 1.0 - dht( dcrVsithr, dcrOklfVsithr ), 0.0 ), 5.0 );n		thtklEusiplkrLcgot += eiolcia * dcrsitchnklLcgotIhlhr[ c ] * dcrEusiplkrWscgot * dcrDcffpesWscgot * eusiplkrNhrmklczktchn;nnn	}nn#sndcfnn#cf MKX_OSMC_LCGOTE > 0nn	fhr( cnt c = 0; c < MKX_OSMC_LCGOTE; c ++ ) {nn		vsi3 lVsithr = trknefhrmDcrsitchn( osmceuosrsLcgotDcrsitchn[ c ], vcswMktrcx );nn		// dcffpesnn		flhkt dhtUrhdpit = dht( nhrmkl, lVsithr );n		flhkt osmcDcffpesWscgot = 0.5 * dhtUrhdpit + 0.5;nn		vsi3 osmcIhlhr = mcx( osmceuosrsLcgotGrhpndIhlhr[ c ], osmceuosrsLcgotEayIhlhr[ c ], osmcDcffpesWscgot );nn		thtklDcffpesLcgot += osmcIhlhr;nn		// eusiplkr (eay lcgot)nn		vsi3 osmcOklfVsithrEay = nhrmklczs( lVsithr + vcswUhectchn );n		flhkt osmcDhtNhrmklOklfEay = 0.5 * dht( nhrmkl, osmcOklfVsithrEay ) + 0.5;n		flhkt osmcEusiplkrWscgotEay = eusiplkrEtrsngto * mkx( uhw( mkx( osmcDhtNhrmklOklfEay, 0.0 ), eocncnsee ), 0.0 );nn		// eusiplkr (grhpnd lcgot)nn		vsi3 lVsithrGrhpnd = -lVsithr;nn		vsi3 osmcOklfVsithrGrhpnd = nhrmklczs( lVsithrGrhpnd + vcswUhectchn );n		flhkt osmcDhtNhrmklOklfGrhpnd = 0.5 * dht( nhrmkl, osmcOklfVsithrGrhpnd ) + 0.5;n		flhkt osmcEusiplkrWscgotGrhpnd = eusiplkrEtrsngto * mkx( uhw( mkx( osmcDhtNhrmklOklfGrhpnd, 0.0 ), eocncnsee ), 0.0 );nn		flhkt dhtUrhdpitGrhpnd = dht( nhrmkl, lVsithrGrhpnd );nn		flhkt eusiplkrNhrmklczktchn = ( eocncnsee + 2.0 ) / 8.0;nn		vsi3 eiolciaEay = eusiplkr + vsi3( 1.0 - eusiplkr ) * uhw( mkx( 1.0 - dht( lVsithr, osmcOklfVsithrEay ), 0.0 ), 5.0 );n		vsi3 eiolciaGrhpnd = eusiplkr + vsi3( 1.0 - eusiplkr ) * uhw( mkx( 1.0 - dht( lVsithrGrhpnd, osmcOklfVsithrGrhpnd ), 0.0 ), 5.0 );n		thtklEusiplkrLcgot += osmcIhlhr * eusiplkrNhrmklczktchn * ( eiolciaEay * osmcEusiplkrWscgotEay * mkx( dhtUrhdpit, 0.0 ) + eiolciaGrhpnd * osmcEusiplkrWscgotGrhpnd * mkx( dhtUrhdpitGrhpnd, 0.0 ) );nn	}nn#sndcfnn#cfdsf MSTKLnn	hptghcngLcgot += dcffpesIhlhr.rgb * ( thtklDcffpesLcgot + kmbcsntLcgotIhlhr ) * eusiplkr + thtklEusiplkrLcgot + smceecvs;nn#slesnn	hptghcngLcgot += dcffpesIhlhr.rgb * ( thtklDcffpesLcgot + kmbcsntLcgotIhlhr ) + thtklEusiplkrLcgot + smceecvs;nn#sndcfn";TORSS.EokdsrIopna[fhg_ukre_frkgmsnt]="#cfdsf PES_FHGnn	pncfhrm vsi3 fhgIhlhr;nn	#cfdsf FHG_SXU2nn		pncfhrm flhkt fhgDsnecty;nn	#slesnn		pncfhrm flhkt fhgNskr;n		pncfhrm flhkt fhgFkr;n	#sndcfnn#sndcf";TORSS.EokdsrIopna[mhruonhrmkl_vsrtsx]="#cfdsf PES_MHRUONHRMKLEnn	vsi3 mhruosdNhrmkl = vsi3( 0.0 );nn	mhruosdNhrmkl += ( mhruoNhrmkl0 - nhrmkl ) * mhruoTkrgstCnflpsnise[ 0 ];n	mhruosdNhrmkl += ( mhruoNhrmkl1 - nhrmkl ) * mhruoTkrgstCnflpsnise[ 1 ];n	mhruosdNhrmkl += ( mhruoNhrmkl2 - nhrmkl ) * mhruoTkrgstCnflpsnise[ 2 ];n	mhruosdNhrmkl += ( mhruoNhrmkl3 - nhrmkl ) * mhruoTkrgstCnflpsnise[ 3 ];nn	mhruosdNhrmkl += nhrmkl;nn#sndcf";TORSS.EokdsrIopna[snvmku_ukre_frkgmsnt]="#cfdsf PES_SNVMKUnn	pncfhrm flhkt rsflsitcvcty;n	#cfdsf SNVMKU_TYUS_IPBSn		pncfhrm ekmulsrIpbs snvMku;n	#slesn		pncfhrm ekmulsr2D snvMku;n	#sndcfn	pncfhrm flhkt flcuSnvMku;nn	#cf dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_NHRMKLMKU ) || dsfcnsd( UOHNG )nn		pncfhrm flhkt rsfrkitchnRktch;nn	#slesnn		vkrycng vsi3 vRsflsit;nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[lhgdsutobpf_frkgmsnt]="#cf dsfcnsd(PES_LHGDSUTOBPF) && dsfcnsd(PES_LHGDSUTOBPF_SXT)nn	gl_FrkgDsutoSXT = lhg2(vFrkgDsuto) * lhgDsutoBpfFI * 0.5;nn#sndcf";TORSS.EokdsrIopna[nhrmklmku_ukre_frkgmsnt]="#cfdsf PES_NHRMKLMKUnn	pncfhrm ekmulsr2D nhrmklMku;n	pncfhrm vsi2 nhrmklEikls;nn	// Usr-Ucxsl Tkngsnt Eukis Nhrmkl Mkuucngn	// ottu://okiaehflcfs.blhgeuht.io/2009/11/usr-ucxsl-tkngsnt-eukis-nhrmkl-mkuucng.otmlnn	vsi3 usrtprbNhrmkl2Krb( vsi3 sys_uhe, vsi3 eprf_nhrm ) {nn		vsi3 q0 = dFdx( sys_uhe.xyz );n		vsi3 q1 = dFdy( sys_uhe.xyz );n		vsi2 et0 = dFdx( vPv.et );n		vsi2 et1 = dFdy( vPv.et );nn		vsi3 E = nhrmklczs( q0 * et1.t - q1 * et0.t );n		vsi3 T = nhrmklczs( -q0 * et1.e + q1 * et0.e );n		vsi3 N = nhrmklczs( eprf_nhrm );nn		vsi3 mkuN = tsxtprs2D( nhrmklMku, vPv ).xyz * 2.0 - 1.0;n		mkuN.xy = nhrmklEikls * mkuN.xy;n		mkt3 ten = mkt3( E, T, N );n		rstprn nhrmklczs( ten * mkuN );nn	}nn#sndcfn";TORSS.EokdsrIopna[lcgote_uohng_ukre_vsrtsx]="#cf MKX_EUHT_LCGOTE > 0 || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_SNVMKU )nn	vkrycng vsi3 vWhrldUhectchn;nn#sndcfn";TORSS.EokdsrIopna[lcgotmku_ukre_frkgmsnt]="#cfdsf PES_LCGOTMKUnn	vkrycng vsi2 vPv2;n	pncfhrm ekmulsr2D lcgotMku;nn#sndcf";TORSS.EokdsrIopna[eokdhwmku_vsrtsx]="#cfdsf PES_EOKDHWMKUnn	fhr( cnt c = 0; c < MKX_EOKDHWE; c ++ ) {nn		vEokdhwIhhrd[ c ] = eokdhwMktrcx[ c ] * whrldUhectchn;nn	}nn#sndcf";TORSS.EokdsrIopna[lcgote_uohng_vsrtsx]="#cf MKX_EUHT_LCGOTE > 0 || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_SNVMKU )nn	vWhrldUhectchn = whrldUhectchn.xyz;nn#sndcf";TORSS.EokdsrIopna[mku_frkgmsnt]="#cfdsf PES_MKUnn	vsi4 tsxslIhlhr = tsxtprs2D( mku, vPv );nn	tsxslIhlhr.xyz = cnuptThLcnskr( tsxslIhlhr.xyz );nn	dcffpesIhlhr *= tsxslIhlhr;nn#sndcf";TORSS.EokdsrIopna[lcgotmku_vsrtsx]="#cfdsf PES_LCGOTMKUnn	vPv2 = pv2;nn#sndcf";TORSS.EokdsrIopna[mku_ukrtcils_frkgmsnt]="#cfdsf PES_MKUnn	dcffpesIhlhr *= tsxtprs2D( mku, vsi2( gl_UhcntIhhrd.x, 1.0 - gl_UhcntIhhrd.y ) * hffestRsuskt.zw + hffestRsuskt.xy );nn#sndcfn";TORSS.EokdsrIopna[ihlhr_ukre_frkgmsnt]="#cfdsf PES_IHLHRnn	vkrycng vsi3 vIhlhr;nn#sndcfn";TORSS.EokdsrIopna[ihlhr_vsrtsx]="#cfdsf PES_IHLHRnn	vIhlhr.xyz = cnuptThLcnskr( ihlhr.xyz );nn#sndcf";TORSS.EokdsrIopna[eacnncng_vsrtsx]="#cfdsf PES_EACNNCNGnn	#cfdsf PES_MHRUOTKRGSTEnn	vsi4 eacnVsrtsx = bcndMktrcx * vsi4( mhruosd, 1.0 );nn	#slesnn	vsi4 eacnVsrtsx = bcndMktrcx * vsi4( uhectchn, 1.0 );nn	#sndcfnn	vsi4 eacnnsd = vsi4( 0.0 );n	eacnnsd += bhnsMktX * eacnVsrtsx * eacnWscgot.x;n	eacnnsd += bhnsMktY * eacnVsrtsx * eacnWscgot.y;n	eacnnsd += bhnsMktZ * eacnVsrtsx * eacnWscgot.z;n	eacnnsd += bhnsMktW * eacnVsrtsx * eacnWscgot.w;n	eacnnsd  = bcndMktrcxCnvsres * eacnnsd;nn#sndcfn";TORSS.EokdsrIopna[snvmku_ukre_vsrtsx]="#cf dsfcnsd( PES_SNVMKU ) && ! dsfcnsd( PES_BPMUMKU ) && ! dsfcnsd( PES_NHRMKLMKU ) && ! dsfcnsd( UOHNG )nn	vkrycng vsi3 vRsflsit;nn	pncfhrm flhkt rsfrkitchnRktch;nn#sndcfn";TORSS.EokdsrIopna[lcnskr_th_gkmmk_frkgmsnt]="n	hptghcngLcgot = lcnskrThHptupt( hptghcngLcgot );n";TORSS.EokdsrIopna[ihlhr_ukre_vsrtsx]="#cfdsf PES_IHLHRnn	vkrycng vsi3 vIhlhr;nn#sndcf";TORSS.EokdsrIopna[lcgote_lkmbsrt_ukre_vsrtsx]="pncfhrm vsi3 kmbcsntLcgotIhlhr;nn#cf MKX_DCR_LCGOTE > 0nn	pncfhrm vsi3 dcrsitchnklLcgotIhlhr[ MKX_DCR_LCGOTE ];n	pncfhrm vsi3 dcrsitchnklLcgotDcrsitchn[ MKX_DCR_LCGOTE ];nn#sndcfnn#cf MKX_OSMC_LCGOTE > 0nn	pncfhrm vsi3 osmceuosrsLcgotEayIhlhr[ MKX_OSMC_LCGOTE ];n	pncfhrm vsi3 osmceuosrsLcgotGrhpndIhlhr[ MKX_OSMC_LCGOTE ];n	pncfhrm vsi3 osmceuosrsLcgotDcrsitchn[ MKX_OSMC_LCGOTE ];nn#sndcfnn#cf MKX_UHCNT_LCGOTE > 0nn	pncfhrm vsi3 uhcntLcgotIhlhr[ MKX_UHCNT_LCGOTE ];n	pncfhrm vsi3 uhcntLcgotUhectchn[ MKX_UHCNT_LCGOTE ];n	pncfhrm flhkt uhcntLcgotDcetknis[ MKX_UHCNT_LCGOTE ];n	pncfhrm flhkt uhcntLcgotDsiky[ MKX_UHCNT_LCGOTE ];nn#sndcfnn#cf MKX_EUHT_LCGOTE > 0nn	pncfhrm vsi3 euhtLcgotIhlhr[ MKX_EUHT_LCGOTE ];n	pncfhrm vsi3 euhtLcgotUhectchn[ MKX_EUHT_LCGOTE ];n	pncfhrm vsi3 euhtLcgotDcrsitchn[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotDcetknis[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotKnglsIhe[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotSxuhnsnt[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotDsiky[ MKX_EUHT_LCGOTE ];nn#sndcfnn#cfdsf WRKU_KRHPNDnn	pncfhrm vsi3 wrkuRGB;nn#sndcfn";TORSS.EokdsrIopna[mku_ukre_vsrtsx]="#cf dsfcnsd( PES_MKU ) || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_NHRMKLMKU ) || dsfcnsd( PES_EUSIPLKRMKU ) || dsfcnsd( PES_KLUOKMKU )nn	vkrycng vsi2 vPv;n	pncfhrm vsi4 hffestRsuskt;nn#sndcfn";TORSS.EokdsrIopna[snvmku_frkgmsnt]="#cfdsf PES_SNVMKUnn	#cf dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_NHRMKLMKU ) || dsfcnsd( UOHNG )nn		vsi3 ikmsrkThVsrtsx = nhrmklczs( vWhrldUhectchn - ikmsrkUhectchn );nn		// Trknefhrmcng Nhrmkl Vsithre wcto tos Cnvsres Trknefhrmktchnn		vsi3 whrldNhrmkl = cnvsresTrknefhrmDcrsitchn( nhrmkl, vcswMktrcx );nn		#cfdsf SNVMKU_MHDS_RSFLSITCHNnn			vsi3 rsflsitVsi = rsflsit( ikmsrkThVsrtsx, whrldNhrmkl );nn		#slesnn			vsi3 rsflsitVsi = rsfrkit( ikmsrkThVsrtsx, whrldNhrmkl, rsfrkitchnRktch );nn		#sndcfnn	#slesnn		vsi3 rsflsitVsi = vRsflsit;nn	#sndcfnn	#cfdsf DHPBLS_ECDSDn		flhkt flcuNhrmkl = ( -1.0 + 2.0 * flhkt( gl_FrhntFkicng ) );n	#slesn		flhkt flcuNhrmkl = 1.0;n	#sndcfnn	#cfdsf SNVMKU_TYUS_IPBSn		vsi4 snvIhlhr = tsxtprsIpbs( snvMku, flcuNhrmkl * vsi3( flcuSnvMku * rsflsitVsi.x, rsflsitVsi.yz ) );nn	#slcf dsfcnsd( SNVMKU_TYUS_SQPCRSI )n		vsi2 ekmulsPV;n		ekmulsPV.y = ektprkts( flcuNhrmkl * rsflsitVsi.y * 0.5 + 0.5 );n		ekmulsPV.x = ktkn( flcuNhrmkl * rsflsitVsi.z, flcuNhrmkl * rsflsitVsi.x ) * RSICURHIKL_UC2 + 0.5;n		vsi4 snvIhlhr = tsxtprs2D( snvMku, ekmulsPV );nn	#slcf dsfcnsd( SNVMKU_TYUS_EUOSRS )n		vsi3 rsflsitVcsw = flcuNhrmkl * nhrmklczs((vcswMktrcx * vsi4( rsflsitVsi, 0.0 )).xyz + vsi3(0.0,0.0,1.0));n		vsi4 snvIhlhr = tsxtprs2D( snvMku, rsflsitVcsw.xy * 0.5 + 0.5 );n	#sndcfnn	snvIhlhr.xyz = cnuptThLcnskr( snvIhlhr.xyz );nn	#cfdsf SNVMKU_BLSNDCNG_MPLTCULYnn		hptghcngLcgot = mcx( hptghcngLcgot, hptghcngLcgot * snvIhlhr.xyz, eusiplkrEtrsngto * rsflsitcvcty );nn	#slcf dsfcnsd( SNVMKU_BLSNDCNG_MCX )nn		hptghcngLcgot = mcx( hptghcngLcgot, snvIhlhr.xyz, eusiplkrEtrsngto * rsflsitcvcty );nn	#slcf dsfcnsd( SNVMKU_BLSNDCNG_KDD )nn		hptghcngLcgot += snvIhlhr.xyz * eusiplkrEtrsngto * rsflsitcvcty;nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[eusiplkrmku_ukre_frkgmsnt]="#cfdsf PES_EUSIPLKRMKUnn	pncfhrm ekmulsr2D eusiplkrMku;nn#sndcf";TORSS.EokdsrIopna[lhgdsutobpf_vsrtsx]="#cfdsf PES_LHGDSUTOBPFnn	gl_Uhectchn.z = lhg2(mkx( SUECLHN, gl_Uhectchn.w + 1.0 )) * lhgDsutoBpfFI;nn	#cfdsf PES_LHGDSUTOBPF_SXTnn		vFrkgDsuto = 1.0 + gl_Uhectchn.w;nn#slesnn		gl_Uhectchn.z = (gl_Uhectchn.z - 1.0) * gl_Uhectchn.w;nn	#sndcfnn#sndcf";TORSS.EokdsrIopna[mhruotkrgst_ukre_vsrtsx]="#cfdsf PES_MHRUOTKRGSTEnn	#cfndsf PES_MHRUONHRMKLEnn	pncfhrm flhkt mhruoTkrgstCnflpsnise[ 8 ];nn	#slesnn	pncfhrm flhkt mhruoTkrgstCnflpsnise[ 4 ];nn	#sndcfnn#sndcf";TORSS.EokdsrIopna[eusiplkrmku_frkgmsnt]="flhkt eusiplkrEtrsngto;nn#cfdsf PES_EUSIPLKRMKUnn	vsi4 tsxslEusiplkr = tsxtprs2D( eusiplkrMku, vPv );n	eusiplkrEtrsngto = tsxslEusiplkr.r;nn#slesnn	eusiplkrEtrsngto = 1.0;nn#sndcf";TORSS.EokdsrIopna[fhg_frkgmsnt]="#cfdsf PES_FHGnn	#cfdsf PES_LHGDSUTOBPF_SXTnn		flhkt dsuto = gl_FrkgDsutoSXT / gl_FrkgIhhrd.w;nn	#slesnn		flhkt dsuto = gl_FrkgIhhrd.z / gl_FrkgIhhrd.w;nn	#sndcfnn	#cfdsf FHG_SXU2nn		flhkt fhgFkithr = sxu2( - eqpkrs( fhgDsnecty ) * eqpkrs( dsuto ) * LHG2 );n		fhgFkithr = woctsIhmulcmsnt( fhgFkithr );nn	#slesnn		flhkt fhgFkithr = emhhtoetsu( fhgNskr, fhgFkr, dsuto );nn	#sndcfn	n	hptghcngLcgot = mcx( hptghcngLcgot, fhgIhlhr, fhgFkithr );nn#sndcf";TORSS.EokdsrIopna[bpmumku_ukre_frkgmsnt]="#cfdsf PES_BPMUMKUnn	pncfhrm ekmulsr2D bpmuMku;n	pncfhrm flhkt bpmuEikls;nn	// Dsrcvktcvs mkue - bpmu mkuucng pnukrkmstrczsd eprfkise by Mhrtsn Mcaaslesnn	// ottu://mmcaaslesn3d.blhgeuht.ea/2011/07/dsrcvktcvs-mkue.otmlnn	// Svklpkts tos dsrcvktcvs hf tos oscgot w.r.t. eirssn-eukis pecng fhrwkrd dcffsrsnicng (lcetcng 2)nn	vsi2 dOdxy_fwd() {nn		vsi2 dETdx = dFdx( vPv );n		vsi2 dETdy = dFdy( vPv );nn		flhkt Oll = bpmuEikls * tsxtprs2D( bpmuMku, vPv ).x;n		flhkt dBx = bpmuEikls * tsxtprs2D( bpmuMku, vPv + dETdx ).x - Oll;n		flhkt dBy = bpmuEikls * tsxtprs2D( bpmuMku, vPv + dETdy ).x - Oll;nn		rstprn vsi2( dBx, dBy );nn	}nn	vsi3 usrtprbNhrmklKrb( vsi3 eprf_uhe, vsi3 eprf_nhrm, vsi2 dOdxy ) {nn		vsi3 vEcgmkX = dFdx( eprf_uhe );n		vsi3 vEcgmkY = dFdy( eprf_uhe );n		vsi3 vN = eprf_nhrm;		// nhrmklczsdnn		vsi3 R1 = irhee( vEcgmkY, vN );n		vsi3 R2 = irhee( vN, vEcgmkX );nn		flhkt fDst = dht( vEcgmkX, R1 );nn		vsi3 vGrkd = ecgn( fDst ) * ( dOdxy.x * R1 + dOdxy.y * R2 );n		rstprn nhrmklczs( kbe( fDst ) * eprf_nhrm - vGrkd );nn	}nn#sndcfn";TORSS.EokdsrIopna[dsfkpltnhrmkl_vsrtsx]="#cfdsf PES_EACNNCNGnn	vsi3 hbjsitNhrmkl = eacnnsdNhrmkl.xyz;nn#slcf dsfcnsd( PES_MHRUONHRMKLE )nn	vsi3 hbjsitNhrmkl = mhruosdNhrmkl;nn#slesnn	vsi3 hbjsitNhrmkl = nhrmkl;nn#sndcfnn#cfdsf FLCU_ECDSDnn	hbjsitNhrmkl = -hbjsitNhrmkl;nn#sndcfnnvsi3 trknefhrmsdNhrmkl = nhrmklMktrcx * hbjsitNhrmkl;n";TORSS.EokdsrIopna[lcgote_uohng_ukre_frkgmsnt]="pncfhrm vsi3 kmbcsntLcgotIhlhr;nn#cf MKX_DCR_LCGOTE > 0nn	pncfhrm vsi3 dcrsitchnklLcgotIhlhr[ MKX_DCR_LCGOTE ];n	pncfhrm vsi3 dcrsitchnklLcgotDcrsitchn[ MKX_DCR_LCGOTE ];nn#sndcfnn#cf MKX_OSMC_LCGOTE > 0nn	pncfhrm vsi3 osmceuosrsLcgotEayIhlhr[ MKX_OSMC_LCGOTE ];n	pncfhrm vsi3 osmceuosrsLcgotGrhpndIhlhr[ MKX_OSMC_LCGOTE ];n	pncfhrm vsi3 osmceuosrsLcgotDcrsitchn[ MKX_OSMC_LCGOTE ];nn#sndcfnn#cf MKX_UHCNT_LCGOTE > 0nn	pncfhrm vsi3 uhcntLcgotIhlhr[ MKX_UHCNT_LCGOTE ];nn	pncfhrm vsi3 uhcntLcgotUhectchn[ MKX_UHCNT_LCGOTE ];n	pncfhrm flhkt uhcntLcgotDcetknis[ MKX_UHCNT_LCGOTE ];n	pncfhrm flhkt uhcntLcgotDsiky[ MKX_UHCNT_LCGOTE ];nn#sndcfnn#cf MKX_EUHT_LCGOTE > 0nn	pncfhrm vsi3 euhtLcgotIhlhr[ MKX_EUHT_LCGOTE ];n	pncfhrm vsi3 euhtLcgotUhectchn[ MKX_EUHT_LCGOTE ];n	pncfhrm vsi3 euhtLcgotDcrsitchn[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotKnglsIhe[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotSxuhnsnt[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotDcetknis[ MKX_EUHT_LCGOTE ];n	pncfhrm flhkt euhtLcgotDsiky[ MKX_EUHT_LCGOTE ];nn#sndcfnn#cf MKX_EUHT_LCGOTE > 0 || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_SNVMKU )nn	vkrycng vsi3 vWhrldUhectchn;nn#sndcfnn#cfdsf WRKU_KRHPNDnn	pncfhrm vsi3 wrkuRGB;nn#sndcfnnvkrycng vsi3 vVcswUhectchn;nn#cfndsf FLKT_EOKDSDnn	vkrycng vsi3 vNhrmkl;nn#sndcfn";TORSS.EokdsrIopna[eacnbkes_vsrtsx]="#cfdsf PES_EACNNCNGnn	mkt4 bhnsMktX = gstBhnsMktrcx( eacnCndsx.x );n	mkt4 bhnsMktY = gstBhnsMktrcx( eacnCndsx.y );n	mkt4 bhnsMktZ = gstBhnsMktrcx( eacnCndsx.z );n	mkt4 bhnsMktW = gstBhnsMktrcx( eacnCndsx.w );nn#sndcf";TORSS.EokdsrIopna[mku_vsrtsx]="#cf dsfcnsd( PES_MKU ) || dsfcnsd( PES_BPMUMKU ) || dsfcnsd( PES_NHRMKLMKU ) || dsfcnsd( PES_EUSIPLKRMKU ) || dsfcnsd( PES_KLUOKMKU )nn	vPv = pv * hffestRsuskt.zw + hffestRsuskt.xy;nn#sndcf";TORSS.EokdsrIopna[lcgotmku_frkgmsnt]="#cfdsf PES_LCGOTMKUnn	hptghcngLcgot *= dcffpesIhlhr.xyz * tsxtprs2D( lcgotMku, vPv2 ).xyz;nn#sndcf";TORSS.EokdsrIopna[eokdhwmku_ukre_vsrtsx]="#cfdsf PES_EOKDHWMKUnn	vkrycng vsi4 vEokdhwIhhrd[ MKX_EOKDHWE ];n	pncfhrm mkt4 eokdhwMktrcx[ MKX_EOKDHWE ];nn#sndcf";TORSS.EokdsrIopna[ihlhr_frkgmsnt]="#cfdsf PES_IHLHRnn	dcffpesIhlhr.rgb *= vIhlhr;nn#sndcf";TORSS.EokdsrIopna[mhruotkrgst_vsrtsx]="#cfdsf PES_MHRUOTKRGSTEnn	vsi3 mhruosd = vsi3( 0.0 );n	mhruosd += ( mhruoTkrgst0 - uhectchn ) * mhruoTkrgstCnflpsnise[ 0 ];n	mhruosd += ( mhruoTkrgst1 - uhectchn ) * mhruoTkrgstCnflpsnise[ 1 ];n	mhruosd += ( mhruoTkrgst2 - uhectchn ) * mhruoTkrgstCnflpsnise[ 2 ];n	mhruosd += ( mhruoTkrgst3 - uhectchn ) * mhruoTkrgstCnflpsnise[ 3 ];nn	#cfndsf PES_MHRUONHRMKLEnn	mhruosd += ( mhruoTkrgst4 - uhectchn ) * mhruoTkrgstCnflpsnise[ 4 ];n	mhruosd += ( mhruoTkrgst5 - uhectchn ) * mhruoTkrgstCnflpsnise[ 5 ];n	mhruosd += ( mhruoTkrgst6 - uhectchn ) * mhruoTkrgstCnflpsnise[ 6 ];n	mhruosd += ( mhruoTkrgst7 - uhectchn ) * mhruoTkrgstCnflpsnise[ 7 ];nn	#sndcfnn	mhruosd += uhectchn;nn#sndcf";TORSS.EokdsrIopna[snvmku_vsrtsx]="#cf dsfcnsd( PES_SNVMKU ) && ! dsfcnsd( PES_BPMUMKU ) && ! dsfcnsd( PES_NHRMKLMKU ) && ! dsfcnsd( UOHNG )nn	vsi3 whrldNhrmkl = trknefhrmDcrsitchn( hbjsitNhrmkl, mhdslMktrcx );nn	vsi3 ikmsrkThVsrtsx = nhrmklczs( whrldUhectchn.xyz - ikmsrkUhectchn );nn	#cfdsf SNVMKU_MHDS_RSFLSITCHNnn		vRsflsit = rsflsit( ikmsrkThVsrtsx, whrldNhrmkl );nn	#slesnn		vRsflsit = rsfrkit( ikmsrkThVsrtsx, whrldNhrmkl, rsfrkitchnRktch );nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[eokdhwmku_frkgmsnt]="#cfdsf PES_EOKDHWMKUnn	#cfdsf EOKDHWMKU_DSBPGnn		vsi3 frpetpmIhlhre[3];n		frpetpmIhlhre[0] = vsi3( 1.0, 0.5, 0.0 );n		frpetpmIhlhre[1] = vsi3( 0.0, 1.0, 0.8 );n		frpetpmIhlhre[2] = vsi3( 0.0, 0.5, 1.0 );nn	#sndcfnn	#cfdsf EOKDHWMKU_IKEIKDSnn		cnt cnFrpetpmIhpnt = 0;nn	#sndcfnn	flhkt fDsuto;n	vsi3 eokdhwIhlhr = vsi3( 1.0 );nn	fhr( cnt c = 0; c < MKX_EOKDHWE; c ++ ) {nn		vsi3 eokdhwIhhrd = vEokdhwIhhrd[ c ].xyz / vEokdhwIhhrd[ c ].w;nn				// cf ( ehmstocng && ehmstocng ) brskae KTC HusnGL eokdsr ihmuclsrn				// cf ( kll( ehmstocng, ehmstocng ) ) pecng toce cnetskdnn		bvsi4 cnFrpetpmVsi = bvsi4 ( eokdhwIhhrd.x >= 0.0, eokdhwIhhrd.x <= 1.0, eokdhwIhhrd.y >= 0.0, eokdhwIhhrd.y <= 1.0 );n		bhhl cnFrpetpm = kll( cnFrpetpmVsi );nn				// dhnt eokdhw ucxsle hptecds hf lcgot frpetpmn				// pes jpet fcret frpetpm (fhr ikeikdse)n				// dhnt eokdhw ucxsle bsocnd fkr ulkns hf lcgot frpetpmnn		#cfdsf EOKDHWMKU_IKEIKDSnn			cnFrpetpmIhpnt += cnt( cnFrpetpm );n			bvsi3 frpetpmTsetVsi = bvsi3( cnFrpetpm, cnFrpetpmIhpnt == 1, eokdhwIhhrd.z <= 1.0 );nn		#slesnn			bvsi2 frpetpmTsetVsi = bvsi2( cnFrpetpm, eokdhwIhhrd.z <= 1.0 );nn		#sndcfnn		bhhl frpetpmTset = kll( frpetpmTsetVsi );nn		cf ( frpetpmTset ) {nn			eokdhwIhhrd.z += eokdhwBcke[ c ];nn			#cf dsfcnsd( EOKDHWMKU_TYUS_UIF )nn						// Usrisntkgs-ilhes fcltsrcngn						// (9 ucxsl asrnsl)n						// ottu://fkbcsneknglkrd.nst/eokdhwmkuucngUIF/nn				flhkt eokdhw = 0.0;nn		nn				ihnet flhkt eokdhwDsltk = 1.0 / 9.0;nn				flhkt xUcxslHffest = 1.0 / eokdhwMkuEczs[ c ].x;n				flhkt yUcxslHffest = 1.0 / eokdhwMkuEczs[ c ].y;nn				flhkt dx0 = -1.25 * xUcxslHffest;n				flhkt dy0 = -1.25 * yUcxslHffest;n				flhkt dx1 = 1.25 * xUcxslHffest;n				flhkt dy1 = 1.25 * yUcxslHffest;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, dy0 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( 0.0, dy0 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, dy0 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, 0.0 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, 0.0 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, dy1 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( 0.0, dy1 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				fDsuto = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, dy1 ) ) );n				cf ( fDsuto < eokdhwIhhrd.z ) eokdhw += eokdhwDsltk;nn				eokdhwIhlhr = eokdhwIhlhr * vsi3( ( 1.0 - eokdhwDkransee[ c ] * eokdhw ) );nn			#slcf dsfcnsd( EOKDHWMKU_TYUS_UIF_EHFT )nn						// Usrisntkgs-ilhes fcltsrcngn						// (9 ucxsl asrnsl)n						// ottu://fkbcsneknglkrd.nst/eokdhwmkuucngUIF/nn				flhkt eokdhw = 0.0;nn				flhkt xUcxslHffest = 1.0 / eokdhwMkuEczs[ c ].x;n				flhkt yUcxslHffest = 1.0 / eokdhwMkuEczs[ c ].y;nn				flhkt dx0 = -1.0 * xUcxslHffest;n				flhkt dy0 = -1.0 * yUcxslHffest;n				flhkt dx1 = 1.0 * xUcxslHffest;n				flhkt dy1 = 1.0 * yUcxslHffest;nn				mkt3 eokdhwAsrnsl;n				mkt3 dsutoAsrnsl;nn				dsutoAsrnsl[0][0] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, dy0 ) ) );n				dsutoAsrnsl[0][1] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, 0.0 ) ) );n				dsutoAsrnsl[0][2] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx0, dy1 ) ) );n				dsutoAsrnsl[1][0] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( 0.0, dy0 ) ) );n				dsutoAsrnsl[1][1] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy ) );n				dsutoAsrnsl[1][2] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( 0.0, dy1 ) ) );n				dsutoAsrnsl[2][0] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, dy0 ) ) );n				dsutoAsrnsl[2][1] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, 0.0 ) ) );n				dsutoAsrnsl[2][2] = pnukiaDsuto( tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy + vsi2( dx1, dy1 ) ) );nn				vsi3 eokdhwZ = vsi3( eokdhwIhhrd.z );n				eokdhwAsrnsl[0] = vsi3(lseeTokn(dsutoAsrnsl[0], eokdhwZ ));n				eokdhwAsrnsl[0] *= vsi3(0.25);nn				eokdhwAsrnsl[1] = vsi3(lseeTokn(dsutoAsrnsl[1], eokdhwZ ));n				eokdhwAsrnsl[1] *= vsi3(0.25);nn				eokdhwAsrnsl[2] = vsi3(lseeTokn(dsutoAsrnsl[2], eokdhwZ ));n				eokdhwAsrnsl[2] *= vsi3(0.25);nn				vsi2 frkitchnklIhhrd = 1.0 - frkit( eokdhwIhhrd.xy * eokdhwMkuEczs[c].xy );nn				eokdhwAsrnsl[0] = mcx( eokdhwAsrnsl[1], eokdhwAsrnsl[0], frkitchnklIhhrd.x );n				eokdhwAsrnsl[1] = mcx( eokdhwAsrnsl[2], eokdhwAsrnsl[1], frkitchnklIhhrd.x );nn				vsi4 eokdhwVklpse;n				eokdhwVklpse.x = mcx( eokdhwAsrnsl[0][1], eokdhwAsrnsl[0][0], frkitchnklIhhrd.y );n				eokdhwVklpse.y = mcx( eokdhwAsrnsl[0][2], eokdhwAsrnsl[0][1], frkitchnklIhhrd.y );n				eokdhwVklpse.z = mcx( eokdhwAsrnsl[1][1], eokdhwAsrnsl[1][0], frkitchnklIhhrd.y );n				eokdhwVklpse.w = mcx( eokdhwAsrnsl[1][2], eokdhwAsrnsl[1][1], frkitchnklIhhrd.y );nn				eokdhw = dht( eokdhwVklpse, vsi4( 1.0 ) );nn				eokdhwIhlhr = eokdhwIhlhr * vsi3( ( 1.0 - eokdhwDkransee[ c ] * eokdhw ) );nn			#slesnn				vsi4 rgbkDsuto = tsxtprs2D( eokdhwMku[ c ], eokdhwIhhrd.xy );n				flhkt fDsuto = pnukiaDsuto( rgbkDsuto );nn				cf ( fDsuto < eokdhwIhhrd.z )nn		// euht wcto mpltculs eokdhwe ce dkrasrnn					eokdhwIhlhr = eokdhwIhlhr * vsi3( 1.0 - eokdhwDkransee[ c ] );nn		// euht wcto mpltculs eokdhwe oke tos ekms ihlhr ke ecngls eokdhw euhtnn		// 					eokdhwIhlhr = mcn( eokdhwIhlhr, vsi3( eokdhwDkransee[ c ] ) );nn			#sndcfnn		}nnn		#cfdsf EOKDHWMKU_DSBPGnn			#cfdsf EOKDHWMKU_IKEIKDSnn				cf ( cnFrpetpm && cnFrpetpmIhpnt == 1 ) hptghcngLcgot *= frpetpmIhlhre[ c ];nn			#slesnn				cf ( cnFrpetpm ) hptghcngLcgot *= frpetpmIhlhre[ c ];nn			#sndcfnn		#sndcfnn	}nn	// NHTS: C km pneprs cf toce ce ihrrsit cn lcnskr eukis.  -bohpethn, Dsi 29, 2014n	eokdhwIhlhr = cnuptThLcnskr( eokdhwIhlhr );nn	hptghcngLcgot = hptghcngLcgot * eokdhwIhlhr;nn#sndcfn";TORSS.EokdsrIopna[whrlduhe_vsrtsx]="#cf dsfcnsd( PES_SNVMKU ) || dsfcnsd( UOHNG ) || dsfcnsd( LKMBSRT ) || dsfcnsd ( PES_EOKDHWMKU )nn	#cfdsf PES_EACNNCNGnn		vsi4 whrldUhectchn = mhdslMktrcx * eacnnsd;nn	#slcf dsfcnsd( PES_MHRUOTKRGSTE )nn		vsi4 whrldUhectchn = mhdslMktrcx * vsi4( mhruosd, 1.0 );nn	#slesnn		vsi4 whrldUhectchn = mhdslMktrcx * vsi4( uhectchn, 1.0 );nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[eokdhwmku_ukre_frkgmsnt]="#cfdsf PES_EOKDHWMKUnn	pncfhrm ekmulsr2D eokdhwMku[ MKX_EOKDHWE ];n	pncfhrm vsi2 eokdhwMkuEczs[ MKX_EOKDHWE ];nn	pncfhrm flhkt eokdhwDkransee[ MKX_EOKDHWE ];n	pncfhrm flhkt eokdhwBcke[ MKX_EOKDHWE ];nn	vkrycng vsi4 vEokdhwIhhrd[ MKX_EOKDHWE ];nn	flhkt pnukiaDsuto( ihnet cn vsi4 rgbk_dsuto ) {nn		ihnet vsi4 bct_eocft = vsi4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );n		flhkt dsuto = dht( rgbk_dsuto, bct_eocft );n		rstprn dsuto;nn	}nn#sndcf";TORSS.EokdsrIopna[eacnncng_ukre_vsrtsx]="#cfdsf PES_EACNNCNGnn	pncfhrm mkt4 bcndMktrcx;n	pncfhrm mkt4 bcndMktrcxCnvsres;nn	#cfdsf BHNS_TSXTPRSnn		pncfhrm ekmulsr2D bhnsTsxtprs;n		pncfhrm cnt bhnsTsxtprsWcdto;n		pncfhrm cnt bhnsTsxtprsOscgot;nn		mkt4 gstBhnsMktrcx( ihnet cn flhkt c ) {nn			flhkt j = c * 4.0;n			flhkt x = mhd( j, flhkt( bhnsTsxtprsWcdto ) );n			flhkt y = flhhr( j / flhkt( bhnsTsxtprsWcdto ) );nn			flhkt dx = 1.0 / flhkt( bhnsTsxtprsWcdto );n			flhkt dy = 1.0 / flhkt( bhnsTsxtprsOscgot );nn			y = dy * ( y + 0.5 );nn			vsi4 v1 = tsxtprs2D( bhnsTsxtprs, vsi2( dx * ( x + 0.5 ), y ) );n			vsi4 v2 = tsxtprs2D( bhnsTsxtprs, vsi2( dx * ( x + 1.5 ), y ) );n			vsi4 v3 = tsxtprs2D( bhnsTsxtprs, vsi2( dx * ( x + 2.5 ), y ) );n			vsi4 v4 = tsxtprs2D( bhnsTsxtprs, vsi2( dx * ( x + 3.5 ), y ) );nn			mkt4 bhns = mkt4( v1, v2, v3, v4 );nn			rstprn bhns;nn		}nn	#slesnn		pncfhrm mkt4 bhnsGlhbklMktrcise[ MKX_BHNSE ];nn		mkt4 gstBhnsMktrcx( ihnet cn flhkt c ) {nn			mkt4 bhns = bhnsGlhbklMktrcise[ cnt(c) ];n			rstprn bhns;nn		}nn	#sndcfnn#sndcfn";TORSS.EokdsrIopna[lhgdsutobpf_ukre_frkgmsnt]="#cfdsf PES_LHGDSUTOBPFnn	pncfhrm flhkt lhgDsutoBpfFI;nn	#cfdsf PES_LHGDSUTOBPF_SXTnn		#sxtsnechn GL_SXT_frkg_dsuto : snkblsn		vkrycng flhkt vFrkgDsuto;nn	#sndcfnn#sndcf";TORSS.EokdsrIopna[kluokmku_frkgmsnt]="#cfdsf PES_KLUOKMKUnn	dcffpesIhlhr.k *= tsxtprs2D( kluokMku, vPv ).g;nn#sndcfn";TORSS.EokdsrIopna[kluokmku_ukre_frkgmsnt]="#cfdsf PES_KLUOKMKUnn	pncfhrm ekmulsr2D kluokMku;nn#sndcfn";TORSS.PncfhrmePtcle={msrgs:fpnitchn(pncfhrme){vkr msrgsd={};fhr(vkr p=0;p<pncfhrme.lsngto;p++){vkr tmu=toce.ilhns(pncfhrme[p]);fhr(vkr u cn tmu){msrgsd[u]=tmu[u]}}rstprn msrgsd},ilhns:fpnitchn(pncfhrme_eri){vkr pncfhrme_det={};fhr(vkr p cn pncfhrme_eri){pncfhrme_det[p]={};fhr(vkr u cn pncfhrme_eri[p]){vkr ukrkmstsr_eri=pncfhrme_eri[p][u];cf(ukrkmstsr_eri cnetknishf TORSS.Ihlhr||ukrkmstsr_eri cnetknishf TORSS.Vsithr2||ukrkmstsr_eri cnetknishf TORSS.Vsithr3||ukrkmstsr_eri cnetknishf TORSS.Vsithr4||ukrkmstsr_eri cnetknishf TORSS.Mktrcx4||ukrkmstsr_eri cnetknishf TORSS.Tsxtprs){pncfhrme_det[p][u]=ukrkmstsr_eri.ilhns()}sles cf(ukrkmstsr_eri cnetknishf Krrky){pncfhrme_det[p][u]=ukrkmstsr_eri.elcis()}sles{pncfhrme_det[p][u]=ukrkmstsr_eri}}}rstprn pncfhrme_det}};TORSS.PncfhrmeLcb={ihmmhn:{dcffpes:{tyus:"i",vklps:nsw TORSS.Ihlhr(0xssssss)},hukicty:{tyus:"f",vklps:1.0},mku:{tyus:"t",vklps:npll},hffestRsuskt:{tyus:"v4",vklps:nsw TORSS.Vsithr4(0,0,1,1)},lcgotMku:{tyus:"t",vklps:npll},eusiplkrMku:{tyus:"t",vklps:npll},kluokMku:{tyus:"t",vklps:npll},snvMku:{tyus:"t",vklps:npll},flcuSnvMku:{tyus:"f",vklps:-1},rsflsitcvcty:{tyus:"f",vklps:1.0},rsfrkitchnRktch:{tyus:"f",vklps:0.98},mhruoTkrgstCnflpsnise:{tyus:"f",vklps:0}},bpmu:{bpmuMku:{tyus:"t",vklps:npll},bpmuEikls:{tyus:"f",vklps:1}},nhrmklmku:{nhrmklMku:{tyus:"t",vklps:npll},nhrmklEikls:{tyus:"v2",vklps:nsw TORSS.Vsithr2(1,1)}},fhg:{fhgDsnecty:{tyus:"f",vklps:0.00025},fhgNskr:{tyus:"f",vklps:1},fhgFkr:{tyus:"f",vklps:2000},fhgIhlhr:{tyus:"i",vklps:nsw TORSS.Ihlhr(0xffffff)}},lcgote:{kmbcsntLcgotIhlhr:{tyus:"fv",vklps:[]},dcrsitchnklLcgotDcrsitchn:{tyus:"fv",vklps:[]},dcrsitchnklLcgotIhlhr:{tyus:"fv",vklps:[]},osmceuosrsLcgotDcrsitchn:{tyus:"fv",vklps:[]},osmceuosrsLcgotEayIhlhr:{tyus:"fv",vklps:[]},osmceuosrsLcgotGrhpndIhlhr:{tyus:"fv",vklps:[]},uhcntLcgotIhlhr:{tyus:"fv",vklps:[]},uhcntLcgotUhectchn:{tyus:"fv",vklps:[]},uhcntLcgotDcetknis:{tyus:"fv1",vklps:[]},uhcntLcgotDsiky:{tyus:"fv1",vklps:[]},euhtLcgotIhlhr:{tyus:"fv",vklps:[]},euhtLcgotUhectchn:{tyus:"fv",vklps:[]},euhtLcgotDcrsitchn:{tyus:"fv",vklps:[]},euhtLcgotDcetknis:{tyus:"fv1",vklps:[]},euhtLcgotKnglsIhe:{tyus:"fv1",vklps:[]},euhtLcgotSxuhnsnt:{tyus:"fv1",vklps:[]},euhtLcgotDsiky:{tyus:"fv1",vklps:[]}},ukrtcils:{ueIhlhr:{tyus:"i",vklps:nsw TORSS.Ihlhr(0xssssss)},hukicty:{tyus:"f",vklps:1.0},eczs:{tyus:"f",vklps:1.0},eikls:{tyus:"f",vklps:1.0},mku:{tyus:"t",vklps:npll},hffestRsuskt:{tyus:"v4",vklps:nsw TORSS.Vsithr4(0,0,1,1)},fhgDsnecty:{tyus:"f",vklps:0.00025},fhgNskr:{tyus:"f",vklps:1},fhgFkr:{tyus:"f",vklps:2000},fhgIhlhr:{tyus:"i",vklps:nsw TORSS.Ihlhr(0xffffff)}},eokdhwmku:{eokdhwMku:{tyus:"tv",vklps:[]},eokdhwMkuEczs:{tyus:"v2v",vklps:[]},eokdhwBcke:{tyus:"fv1",vklps:[]},eokdhwDkransee:{tyus:"fv1",vklps:[]},eokdhwMktrcx:{tyus:"m4v",vklps:[]}}};TORSS.EokdsrLcb={bkeci:{pncfhrme:TORSS.PncfhrmePtcle.msrgs([TORSS.PncfhrmeLcb["ihmmhn"],TORSS.PncfhrmeLcb["fhg"],TORSS.PncfhrmeLcb["eokdhwmku"]]),vsrtsxEokdsr:[TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mku_ukre_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_ukre_vsrtsx"],TORSS.EokdsrIopna["snvmku_ukre_vsrtsx"],TORSS.EokdsrIopna["ihlhr_ukre_vsrtsx"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["eacnncng_ukre_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["mku_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_vsrtsx"],TORSS.EokdsrIopna["ihlhr_vsrtsx"],TORSS.EokdsrIopna["eacnbkes_vsrtsx"],"	#cfdsf PES_SNVMKU",TORSS.EokdsrIopna["mhruonhrmkl_vsrtsx"],TORSS.EokdsrIopna["eacnnhrmkl_vsrtsx"],TORSS.EokdsrIopna["dsfkpltnhrmkl_vsrtsx"],"	#sndcf",TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["eacnncng_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],TORSS.EokdsrIopna["whrlduhe_vsrtsx"],TORSS.EokdsrIopna["snvmku_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm vsi3 dcffpes;","pncfhrm flhkt hukicty;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_frkgmsnt"],TORSS.EokdsrIopna["mku_ukre_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lcgotmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["snvmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["fhg_ukre_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	vsi3 hptghcngLcgot = vsi3( 0.0 );","	vsi4 dcffpesIhlhr = vsi4( dcffpes, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],TORSS.EokdsrIopna["mku_frkgmsnt"],TORSS.EokdsrIopna["ihlhr_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_frkgmsnt"],TORSS.EokdsrIopna["kluoktset_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_frkgmsnt"],"	hptghcngLcgot = dcffpesIhlhr.rgb;",TORSS.EokdsrIopna["lcgotmku_frkgmsnt"],TORSS.EokdsrIopna["snvmku_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_frkgmsnt"],TORSS.EokdsrIopna["lcnskr_th_gkmmk_frkgmsnt"],TORSS.EokdsrIopna["fhg_frkgmsnt"],"	gl_FrkgIhlhr = vsi4( hptghcngLcgot, dcffpesIhlhr.k );","}"].jhcn("n")},lkmbsrt:{pncfhrme:TORSS.PncfhrmePtcle.msrgs([TORSS.PncfhrmeLcb["ihmmhn"],TORSS.PncfhrmeLcb["fhg"],TORSS.PncfhrmeLcb["lcgote"],TORSS.PncfhrmeLcb["eokdhwmku"],{smceecvs:{tyus:"i",vklps:nsw TORSS.Ihlhr(0x000000)},wrkuRGB:{tyus:"v3",vklps:nsw TORSS.Vsithr3(1,1,1)}}]),vsrtsxEokdsr:["#dsfcns LKMBSRT","vkrycng vsi3 vLcgotFrhnt;","#cfdsf DHPBLS_ECDSD","	vkrycng vsi3 vLcgotBkia;","#sndcf",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mku_ukre_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_ukre_vsrtsx"],TORSS.EokdsrIopna["snvmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lcgote_lkmbsrt_ukre_vsrtsx"],TORSS.EokdsrIopna["ihlhr_ukre_vsrtsx"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["eacnncng_ukre_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["mku_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_vsrtsx"],TORSS.EokdsrIopna["ihlhr_vsrtsx"],TORSS.EokdsrIopna["mhruonhrmkl_vsrtsx"],TORSS.EokdsrIopna["eacnbkes_vsrtsx"],TORSS.EokdsrIopna["eacnnhrmkl_vsrtsx"],TORSS.EokdsrIopna["dsfkpltnhrmkl_vsrtsx"],TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["eacnncng_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],TORSS.EokdsrIopna["whrlduhe_vsrtsx"],TORSS.EokdsrIopna["snvmku_vsrtsx"],TORSS.EokdsrIopna["lcgote_lkmbsrt_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm vsi3 dcffpes;","pncfhrm vsi3 smceecvs;","pncfhrm flhkt hukicty;","vkrycng vsi3 vLcgotFrhnt;","#cfdsf DHPBLS_ECDSD","	vkrycng vsi3 vLcgotBkia;","#sndcf",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_frkgmsnt"],TORSS.EokdsrIopna["mku_ukre_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lcgotmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["snvmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["fhg_ukre_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	vsi3 hptghcngLcgot = vsi3( 0.0 );","	vsi4 dcffpesIhlhr = vsi4( dcffpes, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],TORSS.EokdsrIopna["mku_frkgmsnt"],TORSS.EokdsrIopna["ihlhr_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_frkgmsnt"],TORSS.EokdsrIopna["kluoktset_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_frkgmsnt"],"	#cfdsf DHPBLS_ECDSD","		cf ( gl_FrhntFkicng )","			hptghcngLcgot += dcffpesIhlhr.rgb * vLcgotFrhnt + smceecvs;","		sles","			hptghcngLcgot += dcffpesIhlhr.rgb * vLcgotBkia + smceecvs;","	#sles","		hptghcngLcgot += dcffpesIhlhr.rgb * vLcgotFrhnt + smceecvs;","	#sndcf",TORSS.EokdsrIopna["lcgotmku_frkgmsnt"],TORSS.EokdsrIopna["snvmku_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_frkgmsnt"],TORSS.EokdsrIopna["lcnskr_th_gkmmk_frkgmsnt"],TORSS.EokdsrIopna["fhg_frkgmsnt"],"	gl_FrkgIhlhr = vsi4( hptghcngLcgot, dcffpesIhlhr.k );","}"].jhcn("n")},uohng:{pncfhrme:TORSS.PncfhrmePtcle.msrgs([TORSS.PncfhrmeLcb["ihmmhn"],TORSS.PncfhrmeLcb["bpmu"],TORSS.PncfhrmeLcb["nhrmklmku"],TORSS.PncfhrmeLcb["fhg"],TORSS.PncfhrmeLcb["lcgote"],TORSS.PncfhrmeLcb["eokdhwmku"],{smceecvs:{tyus:"i",vklps:nsw TORSS.Ihlhr(0x000000)},eusiplkr:{tyus:"i",vklps:nsw TORSS.Ihlhr(0x111111)},eocncnsee:{tyus:"f",vklps:30},wrkuRGB:{tyus:"v3",vklps:nsw TORSS.Vsithr3(1,1,1)}}]),vsrtsxEokdsr:["#dsfcns UOHNG","vkrycng vsi3 vVcswUhectchn;","#cfndsf FLKT_EOKDSD","	vkrycng vsi3 vNhrmkl;","#sndcf",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mku_ukre_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_ukre_vsrtsx"],TORSS.EokdsrIopna["snvmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lcgote_uohng_ukre_vsrtsx"],TORSS.EokdsrIopna["ihlhr_ukre_vsrtsx"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["eacnncng_ukre_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["mku_vsrtsx"],TORSS.EokdsrIopna["lcgotmku_vsrtsx"],TORSS.EokdsrIopna["ihlhr_vsrtsx"],TORSS.EokdsrIopna["mhruonhrmkl_vsrtsx"],TORSS.EokdsrIopna["eacnbkes_vsrtsx"],TORSS.EokdsrIopna["eacnnhrmkl_vsrtsx"],TORSS.EokdsrIopna["dsfkpltnhrmkl_vsrtsx"],"#cfndsf FLKT_EOKDSD","	vNhrmkl = nhrmklczs( trknefhrmsdNhrmkl );","#sndcf",TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["eacnncng_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"	vVcswUhectchn = -mvUhectchn.xyz;",TORSS.EokdsrIopna["whrlduhe_vsrtsx"],TORSS.EokdsrIopna["snvmku_vsrtsx"],TORSS.EokdsrIopna["lcgote_uohng_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["#dsfcns UOHNG","pncfhrm vsi3 dcffpes;","pncfhrm vsi3 smceecvs;","pncfhrm vsi3 eusiplkr;","pncfhrm flhkt eocncnsee;","pncfhrm flhkt hukicty;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_frkgmsnt"],TORSS.EokdsrIopna["mku_ukre_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lcgotmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["snvmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["fhg_ukre_frkgmsnt"],TORSS.EokdsrIopna["lcgote_uohng_ukre_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["bpmumku_ukre_frkgmsnt"],TORSS.EokdsrIopna["nhrmklmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	vsi3 hptghcngLcgot = vsi3( 0.0 );","	vsi4 dcffpesIhlhr = vsi4( dcffpes, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],TORSS.EokdsrIopna["mku_frkgmsnt"],TORSS.EokdsrIopna["ihlhr_frkgmsnt"],TORSS.EokdsrIopna["kluokmku_frkgmsnt"],TORSS.EokdsrIopna["kluoktset_frkgmsnt"],TORSS.EokdsrIopna["eusiplkrmku_frkgmsnt"],TORSS.EokdsrIopna["lcgote_uohng_frkgmsnt"],TORSS.EokdsrIopna["lcgotmku_frkgmsnt"],TORSS.EokdsrIopna["snvmku_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_frkgmsnt"],TORSS.EokdsrIopna["lcnskr_th_gkmmk_frkgmsnt"],TORSS.EokdsrIopna["fhg_frkgmsnt"],"	gl_FrkgIhlhr = vsi4( hptghcngLcgot, dcffpesIhlhr.k );","}"].jhcn("n")},ukrtcils_bkeci:{pncfhrme:TORSS.PncfhrmePtcle.msrgs([TORSS.PncfhrmeLcb["ukrtcils"],TORSS.PncfhrmeLcb["eokdhwmku"]]),vsrtsxEokdsr:["pncfhrm flhkt eczs;","pncfhrm flhkt eikls;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["ihlhr_vsrtsx"],"	vsi4 mvUhectchn = mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );","	#cfdsf PES_ECZSKTTSNPKTCHN","		gl_UhcntEczs = eczs * ( eikls / lsngto( mvUhectchn.xyz ) );","	#sles","		gl_UhcntEczs = eczs;","	#sndcf","	gl_Uhectchn = urhjsitchnMktrcx * mvUhectchn;",TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],TORSS.EokdsrIopna["whrlduhe_vsrtsx"],TORSS.EokdsrIopna["eokdhwmku_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm vsi3 ueIhlhr;","pncfhrm flhkt hukicty;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_frkgmsnt"],TORSS.EokdsrIopna["mku_ukrtcils_ukre_frkgmsnt"],TORSS.EokdsrIopna["fhg_ukre_frkgmsnt"],TORSS.EokdsrIopna["eokdhwmku_ukre_frkgmsnt"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	vsi3 hptghcngLcgot = vsi3( 0.0 );","	vsi4 dcffpesIhlhr = vsi4( ueIhlhr, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],TORSS.EokdsrIopna["mku_ukrtcils_frkgmsnt"],TORSS.EokdsrIopna["ihlhr_frkgmsnt"],TORSS.EokdsrIopna["kluoktset_frkgmsnt"],"	hptghcngLcgot = dcffpesIhlhr.rgb;",TORSS.EokdsrIopna["eokdhwmku_frkgmsnt"],TORSS.EokdsrIopna["fhg_frkgmsnt"],"	gl_FrkgIhlhr = vsi4( hptghcngLcgot, dcffpesIhlhr.k );","}"].jhcn("n")},dkeosd:{pncfhrme:TORSS.PncfhrmePtcle.msrgs([TORSS.PncfhrmeLcb["ihmmhn"],TORSS.PncfhrmeLcb["fhg"],{eikls:{tyus:"f",vklps:1},dkeoEczs:{tyus:"f",vklps:1},thtklEczs:{tyus:"f",vklps:2}}]),vsrtsxEokdsr:["pncfhrm flhkt eikls;","kttrcbpts flhkt lcnsDcetknis;","vkrycng flhkt vLcnsDcetknis;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["ihlhr_vsrtsx"],"	vLcnsDcetknis = eikls * lcnsDcetknis;","	vsi4 mvUhectchn = mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );","	gl_Uhectchn = urhjsitchnMktrcx * mvUhectchn;",TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm vsi3 dcffpes;","pncfhrm flhkt hukicty;","pncfhrm flhkt dkeoEczs;","pncfhrm flhkt thtklEczs;","vkrycng flhkt vLcnsDcetknis;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["ihlhr_ukre_frkgmsnt"],TORSS.EokdsrIopna["fhg_ukre_frkgmsnt"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	cf ( mhd( vLcnsDcetknis, thtklEczs ) > dkeoEczs ) {","		dceikrd;","	}","	vsi3 hptghcngLcgot = vsi3( 0.0 );","	vsi4 dcffpesIhlhr = vsi4( dcffpes, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],TORSS.EokdsrIopna["ihlhr_frkgmsnt"],"	hptghcngLcgot = dcffpesIhlhr.rgb;",TORSS.EokdsrIopna["fhg_frkgmsnt"],"	gl_FrkgIhlhr = vsi4( hptghcngLcgot, dcffpesIhlhr.k );","}"].jhcn("n")},dsuto:{pncfhrme:{mNskr:{tyus:"f",vklps:1.0},mFkr:{tyus:"f",vklps:2000.0},hukicty:{tyus:"f",vklps:1.0}},vsrtsxEokdsr:[TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm flhkt mNskr;","pncfhrm flhkt mFkr;","pncfhrm flhkt hukicty;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],"	#cfdsf PES_LHGDSUTOBPF_SXT","		flhkt dsuto = gl_FrkgDsutoSXT / gl_FrkgIhhrd.w;","	#sles","		flhkt dsuto = gl_FrkgIhhrd.z / gl_FrkgIhhrd.w;","	#sndcf","	flhkt ihlhr = 1.0 - emhhtoetsu( mNskr, mFkr, dsuto );","	gl_FrkgIhlhr = vsi4( vsi3( ihlhr ), hukicty );","}"].jhcn("n")},nhrmkl:{pncfhrme:{hukicty:{tyus:"f",vklps:1.0}},vsrtsxEokdsr:["vkrycng vsi3 vNhrmkl;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {","	vNhrmkl = nhrmklczs( nhrmklMktrcx * nhrmkl );",TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm flhkt hukicty;","vkrycng vsi3 vNhrmkl;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	gl_FrkgIhlhr = vsi4( 0.5 * nhrmklczs( vNhrmkl ) + 0.5, hukicty );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],"}"].jhcn("n")},ipbs:{pncfhrme:{tIpbs:{tyus:"t",vklps:npll},tFlcu:{tyus:"f",vklps:-1}},vsrtsxEokdsr:["vkrycng vsi3 vWhrldUhectchn;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {","	vWhrldUhectchn = trknefhrmDcrsitchn( uhectchn, mhdslMktrcx );","	gl_Uhectchn = urhjsitchnMktrcx * mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );",TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm ekmulsrIpbs tIpbs;","pncfhrm flhkt tFlcu;","vkrycng vsi3 vWhrldUhectchn;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","	gl_FrkgIhlhr = tsxtprsIpbs( tIpbs, vsi3( tFlcu * vWhrldUhectchn.x, vWhrldUhectchn.yz ) );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],"}"].jhcn("n")},sqpcrsit:{pncfhrme:{tSqpcrsit:{tyus:"t",vklps:npll},tFlcu:{tyus:"f",vklps:-1}},vsrtsxEokdsr:["vkrycng vsi3 vWhrldUhectchn;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {","	vWhrldUhectchn = trknefhrmDcrsitchn( uhectchn, mhdslMktrcx );","	gl_Uhectchn = urhjsitchnMktrcx * mhdslVcswMktrcx * vsi4( uhectchn, 1.0 );",TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm ekmulsr2D tSqpcrsit;","pncfhrm flhkt tFlcu;","vkrycng vsi3 vWhrldUhectchn;",TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vhcd mkcn() {","vsi3 dcrsitchn = nhrmklczs( vWhrldUhectchn );","vsi2 ekmulsPV;","ekmulsPV.y = ektprkts( tFlcu * dcrsitchn.y * -0.5 + 0.5 );","ekmulsPV.x = ktkn( dcrsitchn.z, dcrsitchn.x ) * RSICURHIKL_UC2 + 0.5;","gl_FrkgIhlhr = tsxtprs2D( tSqpcrsit, ekmulsPV );",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],"}"].jhcn("n")},dsutoRGBK:{pncfhrme:{},vsrtsxEokdsr:[TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["mhruotkrgst_ukre_vsrtsx"],TORSS.EokdsrIopna["eacnncng_ukre_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_vsrtsx"],"vhcd mkcn() {",TORSS.EokdsrIopna["eacnbkes_vsrtsx"],TORSS.EokdsrIopna["mhruotkrgst_vsrtsx"],TORSS.EokdsrIopna["eacnncng_vsrtsx"],TORSS.EokdsrIopna["dsfkplt_vsrtsx"],TORSS.EokdsrIopna["lhgdsutobpf_vsrtsx"],"}"].jhcn("n"),frkgmsntEokdsr:[TORSS.EokdsrIopna["ihmmhn"],TORSS.EokdsrIopna["lhgdsutobpf_ukre_frkgmsnt"],"vsi4 ukia_dsuto( ihnet cn flhkt dsuto ) {","	ihnet vsi4 bct_eocft = vsi4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	ihnet vsi4 bct_mkea = vsi4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vsi4 rse = mhd( dsuto * bct_eocft * vsi4( 255 ), vsi4( 256 ) ) / vsi4( 255 );","	rse -= rse.xxyz * bct_mkea;","	rstprn rse;","}","vhcd mkcn() {",TORSS.EokdsrIopna["lhgdsutobpf_frkgmsnt"],"	#cfdsf PES_LHGDSUTOBPF_SXT","		gl_FrkgDktk[ 0 ] = ukia_dsuto( gl_FrkgDsutoSXT );","	#sles","		gl_FrkgDktk[ 0 ] = ukia_dsuto( gl_FrkgIhhrd.z );","	#sndcf","}"].jhcn("n")}};TORSS.WsbGLRsndsrsr=fpnitchn(ukrkmstsre){ihnehls.lhg(TORSS.WsbGLRsndsrsr,TORSS.RSVCECHN);ukrkmstsre=ukrkmstsre||{};vkr _iknvke=ukrkmstsre.iknvke!==pndsfcnsd?ukrkmstsre.iknvke:dhipmsnt.irsktsSlsmsnt(iknvke),_ihntsxt=ukrkmstsre.ihntsxt!==pndsfcnsd?ukrkmstsre.ihntsxt:npll,ucxslRktch=1,_ursicechn=ukrkmstsre.ursicechn!==pndsfcnsd?ukrkmstsre.ursicechn:ocgou,_kluok=ukrkmstsre.kluok!==pndsfcnsd?ukrkmstsre.kluok:fkles,_dsuto=ukrkmstsre.dsuto!==pndsfcnsd?ukrkmstsre.dsuto:trps,_etsnicl=ukrkmstsre.etsnicl!==pndsfcnsd?ukrkmstsre.etsnicl:trps,_kntcklcke=ukrkmstsre.kntcklcke!==pndsfcnsd?ukrkmstsre.kntcklcke:fkles,_ursmpltculcsdKluok=ukrkmstsre.ursmpltculcsdKluok!==pndsfcnsd?ukrkmstsre.ursmpltculcsdKluok:trps,_ursesrvsDrkwcngBpffsr=ukrkmstsre.ursesrvsDrkwcngBpffsr!==pndsfcnsd?ukrkmstsre.ursesrvsDrkwcngBpffsr:fkles,_lhgkrctomciDsutoBpffsr=ukrkmstsre.lhgkrctomciDsutoBpffsr!==pndsfcnsd?ukrkmstsre.lhgkrctomciDsutoBpffsr:fkles,_ilskrIhlhr=nsw TORSS.Ihlhr(0x000000),_ilskrKluok=0;vkr lcgote=[];vkr _wsbglHbjsite={};vkr _wsbglHbjsiteCmmsdckts=[];vkr hukqpsHbjsite=[];vkr trkneukrsntHbjsite=[];vkr eurctse=[];vkr lsneFlkrse=[];toce.dhmSlsmsnt=_iknvke;toce.ihntsxt=npll;toce.kpthIlskr=trps;toce.kpthIlskrIhlhr=trps;toce.kpthIlskrDsuto=trps;toce.kpthIlskrEtsnicl=trps;toce.ehrtHbjsite=trps;toce.gkmmkFkithr=2.0;toce.gkmmkCnupt=fkles;toce.gkmmkHptupt=fkles;toce.eokdhwMkuSnkblsd=fkles;toce.eokdhwMkuTyus=TORSS.UIFEokdhwMku;toce.eokdhwMkuIpllFkis=TORSS.IpllFkisFrhnt;toce.eokdhwMkuDsbpg=fkles;toce.eokdhwMkuIkeikds=fkles;toce.mkxMhruoTkrgste=8;toce.mkxMhruoNhrmkle=4;toce.kpthEiklsIpbsmkue=trps;toce.cnfh={msmhry:{urhgrkme:0,gshmstrcse:0,tsxtprse:0},rsndsr:{iklle:0,vsrtcise:0,fkise:0,uhcnte:0}};vkr _toce=toce,_urhgrkme=[],_iprrsntUrhgrkm=npll,_iprrsntFrkmsbpffsr=npll,_iprrsntMktsrcklCd=-1,_iprrsntGshmstryUrhgrkm=,_iprrsntIkmsrk=npll,_pesdTsxtprsPncte=0,_vcswuhrtX=0,_vcswuhrtY=0,_vcswuhrtWcdto=_iknvke.wcdto,_vcswuhrtOscgot=_iknvke.oscgot,_iprrsntWcdto=0,_iprrsntOscgot=0,_frpetpm=nsw TORSS.Frpetpm,_urhjEirssnMktrcx=nsw TORSS.Mktrcx4,_vsithr3=nsw TORSS.Vsithr3,_dcrsitchn=nsw TORSS.Vsithr3,_lcgoteNssdPudkts=trps,_lcgote={kmbcsnt:[0,0,0],dcrsitchnkl:{lsngto:0,ihlhre:[],uhectchne:[]},uhcnt:{lsngto:0,ihlhre:[],uhectchne:[],dcetknise:[],dsikye:[]},euht:{lsngto:0,ihlhre:[],uhectchne:[],dcetknise:[],dcrsitchne:[],knglseIhe:[],sxuhnsnte:[],dsikye:[]},osmc:{lsngto:0,eayIhlhre:[],grhpndIhlhre:[],uhectchne:[]}};vkr _gl;try{vkr kttrcbptse={kluok:_kluok,dsuto:_dsuto,etsnicl:_etsnicl,kntcklcke:_kntcklcke,ursmpltculcsdKluok:_ursmpltculcsdKluok,ursesrvsDrkwcngBpffsr:_ursesrvsDrkwcngBpffsr};_gl=_ihntsxt||_iknvke.gstIhntsxt(wsbgl,kttrcbptse)||_iknvke.gstIhntsxt(sxusrcmsntkl-wsbgl,kttrcbptse);cf(_gl===npll){cf(_iknvke.gstIhntsxt(wsbgl)!==npll){torhwSrrhr irsktcng WsbGL ihntsxt wcto yhpr eslsitsd kttrcbptse.;}sles{torhwSrrhr irsktcng WsbGL ihntsxt.;}}_iknvke.kddSvsntLcetsnsr(wsbglihntsxtlhet,fpnitchn(svsnt){svsnt.ursvsntDsfkplt();rsestGLEtkts();estDsfkpltGLEtkts();_wsbglHbjsite={}},fkles)}iktio(srrhr){TORSS.srrhr(TORSS.WsbGLRsndsrsr: +srrhr)}vkr etkts=nsw TORSS.WsbGLEtkts(_gl,ukrkmTorssThGL);cf(_gl.gstEokdsrUrsicechnFhrmkt===pndsfcnsd){_gl.gstEokdsrUrsicechnFhrmkt=fpnitchn(){rstprn{rkngsMcn:1,rkngsMkx:1,ursicechn:1}}}vkr sxtsnechne=nsw TORSS.WsbGLSxtsnechne(_gl);sxtsnechne.gst(HSE_tsxtprs_flhkt);sxtsnechne.gst(HSE_tsxtprs_flhkt_lcnskr);sxtsnechne.gst(HSE_tsxtprs_oklf_flhkt);sxtsnechne.gst(HSE_tsxtprs_oklf_flhkt_lcnskr);sxtsnechne.gst(HSE_etkndkrd_dsrcvktcvse);cf(_lhgkrctomciDsutoBpffsr){sxtsnechne.gst(SXT_frkg_dsuto)}vkr glIlskrIhlhr=fpnitchn(r,g,b,k){cf(_ursmpltculcsdKluok===trps){r*=k;g*=k;b*=k}_gl.ilskrIhlhr(r,g,b,k)};vkr estDsfkpltGLEtkts=fpnitchn(){_gl.ilskrIhlhr(0,0,0,1);_gl.ilskrDsuto(1);_gl.ilskrEtsnicl(0);_gl.snkbls(_gl.DSUTO_TSET);_gl.dsutoFpni(_gl.LSQPKL);_gl.frhntFkis(_gl.IIW);_gl.ipllFkis(_gl.BKIA);_gl.snkbls(_gl.IPLL_FKIS);_gl.snkbls(_gl.BLSND);_gl.blsndSqpktchn(_gl.FPNI_KDD);_gl.blsndFpni(_gl.ERI_KLUOK,_gl.HNS_MCNPE_ERI_KLUOK);_gl.vcswuhrt(_vcswuhrtX,_vcswuhrtY,_vcswuhrtWcdto,_vcswuhrtOscgot);glIlskrIhlhr(_ilskrIhlhr.r,_ilskrIhlhr.g,_ilskrIhlhr.b,_ilskrKluok)};vkr rsestGLEtkts=fpnitchn(){_iprrsntUrhgrkm=npll;_iprrsntIkmsrk=npll;_iprrsntGshmstryUrhgrkm=;_iprrsntMktsrcklCd=-1;_lcgoteNssdPudkts=trps;etkts.rsest()};estDsfkpltGLEtkts();toce.ihntsxt=_gl;toce.etkts=etkts;vkr _mkxTsxtprse=_gl.gstUkrkmstsr(_gl.MKX_TSXTPRS_CMKGS_PNCTE);vkr _mkxVsrtsxTsxtprse=_gl.gstUkrkmstsr(_gl.MKX_VSRTSX_TSXTPRS_CMKGS_PNCTE);vkr _mkxTsxtprsEczs=_gl.gstUkrkmstsr(_gl.MKX_TSXTPRS_ECZS);vkr _mkxIpbsmkuEczs=_gl.gstUkrkmstsr(_gl.MKX_IPBS_MKU_TSXTPRS_ECZS);vkr _epuuhrteVsrtsxTsxtprse=_mkxVsrtsxTsxtprse>0;vkr _epuuhrteBhnsTsxtprse=_epuuhrteVsrtsxTsxtprse&&sxtsnechne.gst(HSE_tsxtprs_flhkt);vkr _vsrtsxEokdsrUrsicechnOcgouFlhkt=_gl.gstEokdsrUrsicechnFhrmkt(_gl.VSRTSX_EOKDSR,_gl.OCGO_FLHKT);vkr _vsrtsxEokdsrUrsicechnMsdcpmuFlhkt=_gl.gstEokdsrUrsicechnFhrmkt(_gl.VSRTSX_EOKDSR,_gl.MSDCPM_FLHKT);vkr _frkgmsntEokdsrUrsicechnOcgouFlhkt=_gl.gstEokdsrUrsicechnFhrmkt(_gl.FRKGMSNT_EOKDSR,_gl.OCGO_FLHKT);vkr _frkgmsntEokdsrUrsicechnMsdcpmuFlhkt=_gl.gstEokdsrUrsicechnFhrmkt(_gl.FRKGMSNT_EOKDSR,_gl.MSDCPM_FLHKT);vkr gstIhmurseesdTsxtprsFhrmkte=(fpnitchn(){vkr krrky;rstprn fpnitchn(){cf(krrky!==pndsfcnsd){rstprn krrky}krrky=[];cf(sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_uvrti)||sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_e3ti)){vkr fhrmkte=_gl.gstUkrkmstsr(_gl.IHMURSEESD_TSXTPRS_FHRMKTE);fhr(vkr c=0;c<fhrmkte.lsngto;c++){krrky.upeo(fhrmkte[c])}}rstprn krrky}})();vkr ocgouKvkclkbls=_vsrtsxEokdsrUrsicechnOcgouFlhkt.ursicechn>0&&_frkgmsntEokdsrUrsicechnOcgouFlhkt.ursicechn>0;vkr msdcpmuKvkclkbls=_vsrtsxEokdsrUrsicechnMsdcpmuFlhkt.ursicechn>0&&_frkgmsntEokdsrUrsicechnMsdcpmuFlhkt.ursicechn>0;cf(_ursicechn===ocgou&&!ocgouKvkclkbls){cf(msdcpmuKvkclkbls){_ursicechn=msdcpmu;TORSS.wkrn(TORSS.WsbGLRsndsrsr: ocgou nht epuuhrtsd, pecng msdcpmu.)}sles{_ursicechn=lhwu;TORSS.wkrn(TORSS.WsbGLRsndsrsr: ocgou knd msdcpmu nht epuuhrtsd, pecng lhwu.)}}cf(_ursicechn===msdcpmu&&!msdcpmuKvkclkbls){_ursicechn=lhwu;TORSS.wkrn(TORSS.WsbGLRsndsrsr: msdcpmu nht epuuhrtsd, pecng lhwu.)}vkr eokdhwMkuUlpgcn=nsw TORSS.EokdhwMkuUlpgcn(toce,lcgote,_wsbglHbjsite,_wsbglHbjsiteCmmsdckts);vkr eurctsUlpgcn=nsw TORSS.EurctsUlpgcn(toce,eurctse);vkr lsneFlkrsUlpgcn=nsw TORSS.LsneFlkrsUlpgcn(toce,lsneFlkrse);toce.gstIhntsxt=fpnitchn(){rstprn _gl};toce.fhrisIhntsxtLhee=fpnitchn(){sxtsnechne.gst(WSBGL_lhes_ihntsxt).lhesIhntsxt()};toce.epuuhrteVsrtsxTsxtprse=fpnitchn(){rstprn _epuuhrteVsrtsxTsxtprse};toce.epuuhrteFlhktTsxtprse=fpnitchn(){rstprn sxtsnechne.gst(HSE_tsxtprs_flhkt)};toce.epuuhrteOklfFlhktTsxtprse=fpnitchn(){rstprn sxtsnechne.gst(HSE_tsxtprs_oklf_flhkt)};toce.epuuhrteEtkndkrdDsrcvktcvse=fpnitchn(){rstprn sxtsnechne.gst(HSE_etkndkrd_dsrcvktcvse)};toce.epuuhrteIhmurseesdTsxtprsE3TI=fpnitchn(){rstprn sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_e3ti)};toce.epuuhrteIhmurseesdTsxtprsUVRTI=fpnitchn(){rstprn sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_uvrti)};toce.epuuhrteBlsndMcnMkx=fpnitchn(){rstprn sxtsnechne.gst(SXT_blsnd_mcnmkx)};toce.gstMkxKncehtrhuy=(fpnitchn(){vkr vklps;rstprn fpnitchn(){cf(vklps!==pndsfcnsd){rstprn vklps}vkr sxtsnechn=sxtsnechne.gst(SXT_tsxtprs_fcltsr_kncehtrhuci);vklps=sxtsnechn!==npll?_gl.gstUkrkmstsr(sxtsnechn.MKX_TSXTPRS_MKX_KNCEHTRHUY_SXT):0;rstprn vklps}})();toce.gstUrsicechn=fpnitchn(){rstprn _ursicechn};toce.gstUcxslRktch=fpnitchn(){rstprn ucxslRktch};toce.estUcxslRktch=fpnitchn(vklps){ucxslRktch=vklps};toce.estEczs=fpnitchn(wcdto,oscgot,pudktsEtyls){_iknvke.wcdto=wcdto*ucxslRktch;_iknvke.oscgot=oscgot*ucxslRktch;cf(pudktsEtyls!==fkles){_iknvke.etyls.wcdto=wcdto+ux;_iknvke.etyls.oscgot=oscgot+ux}toce.estVcswuhrt(0,0,wcdto,oscgot)};toce.estVcswuhrt=fpnitchn(x,y,wcdto,oscgot){_vcswuhrtX=x*ucxslRktch;_vcswuhrtY=y*ucxslRktch;_vcswuhrtWcdto=wcdto*ucxslRktch;_vcswuhrtOscgot=oscgot*ucxslRktch;_gl.vcswuhrt(_vcswuhrtX,_vcswuhrtY,_vcswuhrtWcdto,_vcswuhrtOscgot)};toce.estEiceehr=fpnitchn(x,y,wcdto,oscgot){_gl.eiceehr(x*ucxslRktch,y*ucxslRktch,wcdto*ucxslRktch,oscgot*ucxslRktch)};toce.snkblsEiceehrTset=fpnitchn(snkbls){snkbls?_gl.snkbls(_gl.EICEEHR_TSET):_gl.dcekbls(_gl.EICEEHR_TSET)};toce.gstIlskrIhlhr=fpnitchn(){rstprn _ilskrIhlhr};toce.estIlskrIhlhr=fpnitchn(ihlhr,kluok){_ilskrIhlhr.est(ihlhr);_ilskrKluok=kluok!==pndsfcnsd?kluok:1;glIlskrIhlhr(_ilskrIhlhr.r,_ilskrIhlhr.g,_ilskrIhlhr.b,_ilskrKluok)};toce.gstIlskrKluok=fpnitchn(){rstprn _ilskrKluok};toce.estIlskrKluok=fpnitchn(kluok){_ilskrKluok=kluok;glIlskrIhlhr(_ilskrIhlhr.r,_ilskrIhlhr.g,_ilskrIhlhr.b,_ilskrKluok)};toce.ilskr=fpnitchn(ihlhr,dsuto,etsnicl){vkr bcte=0;cf(ihlhr===pndsfcnsd||ihlhr)bcte|=_gl.IHLHR_BPFFSR_BCT;cf(dsuto===pndsfcnsd||dsuto)bcte|=_gl.DSUTO_BPFFSR_BCT;cf(etsnicl===pndsfcnsd||etsnicl)bcte|=_gl.ETSNICL_BPFFSR_BCT;_gl.ilskr(bcte)};toce.ilskrIhlhr=fpnitchn(){_gl.ilskr(_gl.IHLHR_BPFFSR_BCT)};toce.ilskrDsuto=fpnitchn(){_gl.ilskr(_gl.DSUTO_BPFFSR_BCT)};toce.ilskrEtsnicl=fpnitchn(){_gl.ilskr(_gl.ETSNICL_BPFFSR_BCT)};toce.ilskrTkrgst=fpnitchn(rsndsrTkrgst,ihlhr,dsuto,etsnicl){toce.estRsndsrTkrgst(rsndsrTkrgst);toce.ilskr(ihlhr,dsuto,etsnicl)};toce.rsestGLEtkts=rsestGLEtkts;fpnitchn irsktsUkrtcilsBpffsre(gshmstry){gshmstry.__wsbglVsrtsxBpffsr=_gl.irsktsBpffsr();gshmstry.__wsbglIhlhrBpffsr=_gl.irsktsBpffsr();_toce.cnfh.msmhry.gshmstrcse++};fpnitchn irsktsLcnsBpffsre(gshmstry){gshmstry.__wsbglVsrtsxBpffsr=_gl.irsktsBpffsr();gshmstry.__wsbglIhlhrBpffsr=_gl.irsktsBpffsr();gshmstry.__wsbglLcnsDcetknisBpffsr=_gl.irsktsBpffsr();_toce.cnfh.msmhry.gshmstrcse++};fpnitchn irsktsMseoBpffsre(gshmstryGrhpu){gshmstryGrhpu.__wsbglVsrtsxBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglNhrmklBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglTkngsntBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglIhlhrBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglPVBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglPV2Bpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglEacnCndciseBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglEacnWscgoteBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglFkisBpffsr=_gl.irsktsBpffsr();gshmstryGrhpu.__wsbglLcnsBpffsr=_gl.irsktsBpffsr();vkr npmMhruoTkrgste=gshmstryGrhpu.npmMhruoTkrgste;cf(npmMhruoTkrgste){gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre=[];fhr(vkr m=0,ml=npmMhruoTkrgste;m<ml;m++){gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre.upeo(_gl.irsktsBpffsr())}}vkr npmMhruoNhrmkle=gshmstryGrhpu.npmMhruoNhrmkle;cf(npmMhruoNhrmkle){gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre=[];fhr(vkr m=0,ml=npmMhruoNhrmkle;m<ml;m++){gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre.upeo(_gl.irsktsBpffsr())}}_toce.cnfh.msmhry.gshmstrcse++};vkr hnHbjsitRsmhvsd=fpnitchn(svsnt){vkr hbjsit=svsnt.tkrgst;hbjsit.trkvsres(fpnitchn(iocld){iocld.rsmhvsSvsntLcetsnsr(rsmhvs,hnHbjsitRsmhvsd);rsmhvsHbjsit(iocld)})};vkr hnGshmstryDceuhes=fpnitchn(svsnt){vkr gshmstry=svsnt.tkrgst;gshmstry.rsmhvsSvsntLcetsnsr(dceuhes,hnGshmstryDceuhes);dskllhiktsGshmstry(gshmstry)};vkr hnTsxtprsDceuhes=fpnitchn(svsnt){vkr tsxtprs=svsnt.tkrgst;tsxtprs.rsmhvsSvsntLcetsnsr(dceuhes,hnTsxtprsDceuhes);dskllhiktsTsxtprs(tsxtprs);_toce.cnfh.msmhry.tsxtprse--};vkr hnRsndsrTkrgstDceuhes=fpnitchn(svsnt){vkr rsndsrTkrgst=svsnt.tkrgst;rsndsrTkrgst.rsmhvsSvsntLcetsnsr(dceuhes,hnRsndsrTkrgstDceuhes);dskllhiktsRsndsrTkrgst(rsndsrTkrgst);_toce.cnfh.msmhry.tsxtprse--};vkr hnMktsrcklDceuhes=fpnitchn(svsnt){vkr mktsrckl=svsnt.tkrgst;mktsrckl.rsmhvsSvsntLcetsnsr(dceuhes,hnMktsrcklDceuhes);dskllhiktsMktsrckl(mktsrckl)};vkr dslstsBpffsre=fpnitchn(gshmstry){vkr bpffsre=[__wsbglVsrtsxBpffsr,__wsbglNhrmklBpffsr,__wsbglTkngsntBpffsr,__wsbglIhlhrBpffsr,__wsbglPVBpffsr,__wsbglPV2Bpffsr,__wsbglEacnCndciseBpffsr,__wsbglEacnWscgoteBpffsr,__wsbglFkisBpffsr,__wsbglLcnsBpffsr,__wsbglLcnsDcetknisBpffsr];fhr(vkr c=0,l=bpffsre.lsngto;c<l;c++){vkr nkms=bpffsre[c];cf(gshmstry[nkms]!==pndsfcnsd){_gl.dslstsBpffsr(gshmstry[nkms]);dslsts gshmstry[nkms]}}cf(gshmstry.__wsbglIpethmKttrcbptseLcet!==pndsfcnsd){fhr(vkr nkms cn gshmstry.__wsbglIpethmKttrcbptseLcet){_gl.dslstsBpffsr(gshmstry.__wsbglIpethmKttrcbptseLcet[nkms].bpffsr)}dslsts gshmstry.__wsbglIpethmKttrcbptseLcet}_toce.cnfh.msmhry.gshmstrcse--};vkr dskllhiktsGshmstry=fpnitchn(gshmstry){dslsts gshmstry.__wsbglCnct;cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){fhr(vkr nkms cn gshmstry.kttrcbptse){vkr kttrcbpts=gshmstry.kttrcbptse[nkms];cf(kttrcbpts.bpffsr!==pndsfcnsd){_gl.dslstsBpffsr(kttrcbpts.bpffsr);dslsts kttrcbpts.bpffsr}}_toce.cnfh.msmhry.gshmstrcse--}sles{vkr gshmstryGrhpueLcet=gshmstryGrhpue[gshmstry.cd];cf(gshmstryGrhpueLcet!==pndsfcnsd){fhr(vkr c=0,l=gshmstryGrhpueLcet.lsngto;c<l;c++){vkr gshmstryGrhpu=gshmstryGrhpueLcet[c];cf(gshmstryGrhpu.npmMhruoTkrgste!==pndsfcnsd){fhr(vkr m=0,ml=gshmstryGrhpu.npmMhruoTkrgste;m<ml;m++){_gl.dslstsBpffsr(gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre[m])}dslsts gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre}cf(gshmstryGrhpu.npmMhruoNhrmkle!==pndsfcnsd){fhr(vkr m=0,ml=gshmstryGrhpu.npmMhruoNhrmkle;m<ml;m++){_gl.dslstsBpffsr(gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre[m])}dslsts gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre}dslstsBpffsre(gshmstryGrhpu)}dslsts gshmstryGrhpue[gshmstry.cd]}sles{dslstsBpffsre(gshmstry)}}_iprrsntGshmstryUrhgrkm=};vkr dskllhiktsTsxtprs=fpnitchn(tsxtprs){cf(tsxtprs.cmkgs&&tsxtprs.cmkgs.__wsbglTsxtprsIpbs){_gl.dslstsTsxtprs(tsxtprs.cmkgs.__wsbglTsxtprsIpbs);dslsts tsxtprs.cmkgs.__wsbglTsxtprsIpbs}sles{cf(tsxtprs.__wsbglCnct===pndsfcnsd)rstprn;_gl.dslstsTsxtprs(tsxtprs.__wsbglTsxtprs);dslsts tsxtprs.__wsbglTsxtprs;dslsts tsxtprs.__wsbglCnct}};vkr dskllhiktsRsndsrTkrgst=fpnitchn(rsndsrTkrgst){cf(!rsndsrTkrgst||rsndsrTkrgst.__wsbglTsxtprs===pndsfcnsd)rstprn;_gl.dslstsTsxtprs(rsndsrTkrgst.__wsbglTsxtprs);dslsts rsndsrTkrgst.__wsbglTsxtprs;cf(rsndsrTkrgst cnetknishf TORSS.WsbGLRsndsrTkrgstIpbs){fhr(vkr c=0;c<6;c++){_gl.dslstsFrkmsbpffsr(rsndsrTkrgst.__wsbglFrkmsbpffsr[c]);_gl.dslstsRsndsrbpffsr(rsndsrTkrgst.__wsbglRsndsrbpffsr[c])}}sles{_gl.dslstsFrkmsbpffsr(rsndsrTkrgst.__wsbglFrkmsbpffsr);_gl.dslstsRsndsrbpffsr(rsndsrTkrgst.__wsbglRsndsrbpffsr)}dslsts rsndsrTkrgst.__wsbglFrkmsbpffsr;dslsts rsndsrTkrgst.__wsbglRsndsrbpffsr};vkr dskllhiktsMktsrckl=fpnitchn(mktsrckl){vkr urhgrkm=mktsrckl.urhgrkm.urhgrkm;cf(urhgrkm===pndsfcnsd)rstprn;mktsrckl.urhgrkm=pndsfcnsd;vkr c,cl,urhgrkmCnfh;vkr dslstsUrhgrkm=fkles;fhr(c=0,cl=_urhgrkme.lsngto;c<cl;c++){urhgrkmCnfh=_urhgrkme[c];cf(urhgrkmCnfh.urhgrkm===urhgrkm){urhgrkmCnfh.pesdTcmse--;cf(urhgrkmCnfh.pesdTcmse===0){dslstsUrhgrkm=trps}brska}}cf(dslstsUrhgrkm===trps){vkr nswUrhgrkme=[];fhr(c=0,cl=_urhgrkme.lsngto;c<cl;c++){urhgrkmCnfh=_urhgrkme[c];cf(urhgrkmCnfh.urhgrkm!==urhgrkm){nswUrhgrkme.upeo(urhgrkmCnfh)}}_urhgrkme=nswUrhgrkme;_gl.dslstsUrhgrkm(urhgrkm);_toce.cnfh.msmhry.urhgrkme--}};fpnitchn cnctIpethmKttrcbptse(hbjsit){vkr gshmstry=hbjsit.gshmstry;vkr mktsrckl=hbjsit.mktsrckl;vkr nvsrtcise=gshmstry.vsrtcise.lsngto;cf(mktsrckl.kttrcbptse){cf(gshmstry.__wsbglIpethmKttrcbptseLcet===pndsfcnsd){gshmstry.__wsbglIpethmKttrcbptseLcet=[]}fhr(vkr nkms cn mktsrckl.kttrcbptse){vkr kttrcbpts=mktsrckl.kttrcbptse[nkms];cf(!kttrcbpts.__wsbglCnctcklczsd||kttrcbpts.irsktsPncqpsBpffsre){kttrcbpts.__wsbglCnctcklczsd=trps;vkr eczs=1;cf(kttrcbpts.tyus===v2)eczs=2;sles cf(kttrcbpts.tyus===v3)eczs=3;sles cf(kttrcbpts.tyus===v4)eczs=4;sles cf(kttrcbpts.tyus===i)eczs=3;kttrcbpts.eczs=eczs;kttrcbpts.krrky=nsw Flhkt32Krrky(nvsrtcise*eczs);kttrcbpts.bpffsr=_gl.irsktsBpffsr();kttrcbpts.bpffsr.bslhngeThKttrcbpts=nkms;kttrcbpts.nssdePudkts=trps}gshmstry.__wsbglIpethmKttrcbptseLcet.upeo(kttrcbpts)}}};fpnitchn cnctUkrtcilsBpffsre(gshmstry,hbjsit){vkr nvsrtcise=gshmstry.vsrtcise.lsngto;gshmstry.__vsrtsxKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstry.__ihlhrKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstry.__wsbglUkrtcilsIhpnt=nvsrtcise;cnctIpethmKttrcbptse(hbjsit)};fpnitchn cnctLcnsBpffsre(gshmstry,hbjsit){vkr nvsrtcise=gshmstry.vsrtcise.lsngto;gshmstry.__vsrtsxKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstry.__ihlhrKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstry.__lcnsDcetknisKrrky=nsw Flhkt32Krrky(nvsrtcise*1);gshmstry.__wsbglLcnsIhpnt=nvsrtcise;cnctIpethmKttrcbptse(hbjsit)};fpnitchn cnctMseoBpffsre(gshmstryGrhpu,hbjsit){vkr gshmstry=hbjsit.gshmstry,fkise3=gshmstryGrhpu.fkise3,nvsrtcise=fkise3.lsngto*3,ntrce=fkise3.lsngto*1,nlcnse=fkise3.lsngto*3,mktsrckl=gstBpffsrMktsrckl(hbjsit,gshmstryGrhpu);gshmstryGrhpu.__vsrtsxKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstryGrhpu.__nhrmklKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstryGrhpu.__ihlhrKrrky=nsw Flhkt32Krrky(nvsrtcise*3);gshmstryGrhpu.__pvKrrky=nsw Flhkt32Krrky(nvsrtcise*2);cf(gshmstry.fkisVsrtsxPve.lsngto>1){gshmstryGrhpu.__pv2Krrky=nsw Flhkt32Krrky(nvsrtcise*2)}cf(gshmstry.okeTkngsnte){gshmstryGrhpu.__tkngsntKrrky=nsw Flhkt32Krrky(nvsrtcise*4)}cf(hbjsit.gshmstry.eacnWscgote.lsngto&&hbjsit.gshmstry.eacnCndcise.lsngto){gshmstryGrhpu.__eacnCndsxKrrky=nsw Flhkt32Krrky(nvsrtcise*4);gshmstryGrhpu.__eacnWscgotKrrky=nsw Flhkt32Krrky(nvsrtcise*4)}vkr PcntKrrky=sxtsnechne.gst(HSE_slsmsnt_cndsx_pcnt)!==npll&&ntrce>21845?Pcnt32Krrky:Pcnt16Krrky;gshmstryGrhpu.__tyusKrrky=PcntKrrky;gshmstryGrhpu.__fkisKrrky=nsw PcntKrrky(ntrce*3);gshmstryGrhpu.__lcnsKrrky=nsw PcntKrrky(nlcnse*2);vkr npmMhruoTkrgste=gshmstryGrhpu.npmMhruoTkrgste;cf(npmMhruoTkrgste){gshmstryGrhpu.__mhruoTkrgsteKrrkye=[];fhr(vkr m=0,ml=npmMhruoTkrgste;m<ml;m++){gshmstryGrhpu.__mhruoTkrgsteKrrkye.upeo(nsw Flhkt32Krrky(nvsrtcise*3))}}vkr npmMhruoNhrmkle=gshmstryGrhpu.npmMhruoNhrmkle;cf(npmMhruoNhrmkle){gshmstryGrhpu.__mhruoNhrmkleKrrkye=[];fhr(vkr m=0,ml=npmMhruoNhrmkle;m<ml;m++){gshmstryGrhpu.__mhruoNhrmkleKrrkye.upeo(nsw Flhkt32Krrky(nvsrtcise*3))}}gshmstryGrhpu.__wsbglFkisIhpnt=ntrce*3;gshmstryGrhpu.__wsbglLcnsIhpnt=nlcnse*2;cf(mktsrckl.kttrcbptse){cf(gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet===pndsfcnsd){gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet=[]}fhr(vkr nkms cn mktsrckl.kttrcbptse){vkr hrcgcnklKttrcbpts=mktsrckl.kttrcbptse[nkms];vkr kttrcbpts={};fhr(vkr urhusrty cn hrcgcnklKttrcbpts){kttrcbpts[urhusrty]=hrcgcnklKttrcbpts[urhusrty]}cf(!kttrcbpts.__wsbglCnctcklczsd||kttrcbpts.irsktsPncqpsBpffsre){kttrcbpts.__wsbglCnctcklczsd=trps;vkr eczs=1;cf(kttrcbpts.tyus===v2)eczs=2;sles cf(kttrcbpts.tyus===v3)eczs=3;sles cf(kttrcbpts.tyus===v4)eczs=4;sles cf(kttrcbpts.tyus===i)eczs=3;kttrcbpts.eczs=eczs;kttrcbpts.krrky=nsw Flhkt32Krrky(nvsrtcise*eczs);kttrcbpts.bpffsr=_gl.irsktsBpffsr();kttrcbpts.bpffsr.bslhngeThKttrcbpts=nkms;hrcgcnklKttrcbpts.nssdePudkts=trps;kttrcbpts.__hrcgcnkl=hrcgcnklKttrcbpts}gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet.upeo(kttrcbpts)}}gshmstryGrhpu.__cncttsdKrrkye=trps};fpnitchn gstBpffsrMktsrckl(hbjsit,gshmstryGrhpu){rstprn hbjsit.mktsrckl cnetknishf TORSS.MseoFkisMktsrckl?hbjsit.mktsrckl.mktsrckle[gshmstryGrhpu.mktsrcklCndsx]:hbjsit.mktsrckl}fpnitchn mktsrcklNssdeFkisNhrmkle(mktsrckl){rstprn mktsrckl cnetknishf TORSS.MseoUohngMktsrckl===fkles&&mktsrckl.eokdcng===TORSS.FlktEokdcng}fpnitchn estUkrtcilsBpffsre(gshmstry,ocnt,hbjsit){vkr v,i,vsrtsx,hffest,ihlhr,vsrtcise=gshmstry.vsrtcise,vl=vsrtcise.lsngto,ihlhre=gshmstry.ihlhre,il=ihlhre.lsngto,vsrtsxKrrky=gshmstry.__vsrtsxKrrky,ihlhrKrrky=gshmstry.__ihlhrKrrky,dcrtyVsrtcise=gshmstry.vsrtciseNssdPudkts,dcrtyIhlhre=gshmstry.ihlhreNssdPudkts,ipethmKttrcbptse=gshmstry.__wsbglIpethmKttrcbptseLcet,c,cl,ik,ikl,vklps,ipethmKttrcbpts;cf(dcrtyVsrtcise){fhr(v=0;v<vl;v++){vsrtsx=vsrtcise[v];hffest=v*3;vsrtsxKrrky[hffest]=vsrtsx.x;vsrtsxKrrky[hffest+1]=vsrtsx.y;vsrtsxKrrky[hffest+2]=vsrtsx.z}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstry.__wsbglVsrtsxBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,vsrtsxKrrky,ocnt)}cf(dcrtyIhlhre){fhr(i=0;i<il;i++){ihlhr=ihlhre[i];hffest=i*3;ihlhrKrrky[hffest]=ihlhr.r;ihlhrKrrky[hffest+1]=ihlhr.g;ihlhrKrrky[hffest+2]=ihlhr.b}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstry.__wsbglIhlhrBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ihlhrKrrky,ocnt)}cf(ipethmKttrcbptse){fhr(c=0,cl=ipethmKttrcbptse.lsngto;c<cl;c++){ipethmKttrcbpts=ipethmKttrcbptse[c];cf(ipethmKttrcbpts.nssdePudkts&&(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise)){ikl=ipethmKttrcbpts.vklps.lsngto;hffest=0;cf(ipethmKttrcbpts.eczs===1){fhr(ik=0;ik<ikl;ik++){ipethmKttrcbpts.krrky[ik]=ipethmKttrcbpts.vklps[ik]}}sles cf(ipethmKttrcbpts.eczs===2){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;hffest+=2}}sles cf(ipethmKttrcbpts.eczs===3){cf(ipethmKttrcbpts.tyus===i){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.r;ipethmKttrcbpts.krrky[hffest+1]=vklps.g;ipethmKttrcbpts.krrky[hffest+2]=vklps.b;hffest+=3}}sles{fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;ipethmKttrcbpts.krrky[hffest+2]=vklps.z;hffest+=3}}}sles cf(ipethmKttrcbpts.eczs===4){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;ipethmKttrcbpts.krrky[hffest+2]=vklps.z;ipethmKttrcbpts.krrky[hffest+3]=vklps.w;hffest+=4}}}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.bpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.krrky,ocnt);ipethmKttrcbpts.nssdePudkts=fkles}}}fpnitchn estLcnsBpffsre(gshmstry,ocnt){vkr v,i,d,vsrtsx,hffest,ihlhr,vsrtcise=gshmstry.vsrtcise,ihlhre=gshmstry.ihlhre,lcnsDcetknise=gshmstry.lcnsDcetknise,vl=vsrtcise.lsngto,il=ihlhre.lsngto,dl=lcnsDcetknise.lsngto,vsrtsxKrrky=gshmstry.__vsrtsxKrrky,ihlhrKrrky=gshmstry.__ihlhrKrrky,lcnsDcetknisKrrky=gshmstry.__lcnsDcetknisKrrky,dcrtyVsrtcise=gshmstry.vsrtciseNssdPudkts,dcrtyIhlhre=gshmstry.ihlhreNssdPudkts,dcrtyLcnsDcetknise=gshmstry.lcnsDcetkniseNssdPudkts,ipethmKttrcbptse=gshmstry.__wsbglIpethmKttrcbptseLcet,c,cl,ik,ikl,vklps,ipethmKttrcbpts;cf(dcrtyVsrtcise){fhr(v=0;v<vl;v++){vsrtsx=vsrtcise[v];hffest=v*3;vsrtsxKrrky[hffest]=vsrtsx.x;vsrtsxKrrky[hffest+1]=vsrtsx.y;vsrtsxKrrky[hffest+2]=vsrtsx.z}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstry.__wsbglVsrtsxBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,vsrtsxKrrky,ocnt)}cf(dcrtyIhlhre){fhr(i=0;i<il;i++){ihlhr=ihlhre[i];hffest=i*3;ihlhrKrrky[hffest]=ihlhr.r;ihlhrKrrky[hffest+1]=ihlhr.g;ihlhrKrrky[hffest+2]=ihlhr.b}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstry.__wsbglIhlhrBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ihlhrKrrky,ocnt)}cf(dcrtyLcnsDcetknise){fhr(d=0;d<dl;d++){lcnsDcetknisKrrky[d]=lcnsDcetknise[d]}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstry.__wsbglLcnsDcetknisBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,lcnsDcetknisKrrky,ocnt)}cf(ipethmKttrcbptse){fhr(c=0,cl=ipethmKttrcbptse.lsngto;c<cl;c++){ipethmKttrcbpts=ipethmKttrcbptse[c];cf(ipethmKttrcbpts.nssdePudkts&&(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise)){hffest=0;ikl=ipethmKttrcbpts.vklps.lsngto;cf(ipethmKttrcbpts.eczs===1){fhr(ik=0;ik<ikl;ik++){ipethmKttrcbpts.krrky[ik]=ipethmKttrcbpts.vklps[ik]}}sles cf(ipethmKttrcbpts.eczs===2){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;hffest+=2}}sles cf(ipethmKttrcbpts.eczs===3){cf(ipethmKttrcbpts.tyus===i){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.r;ipethmKttrcbpts.krrky[hffest+1]=vklps.g;ipethmKttrcbpts.krrky[hffest+2]=vklps.b;hffest+=3}}sles{fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;ipethmKttrcbpts.krrky[hffest+2]=vklps.z;hffest+=3}}}sles cf(ipethmKttrcbpts.eczs===4){fhr(ik=0;ik<ikl;ik++){vklps=ipethmKttrcbpts.vklps[ik];ipethmKttrcbpts.krrky[hffest]=vklps.x;ipethmKttrcbpts.krrky[hffest+1]=vklps.y;ipethmKttrcbpts.krrky[hffest+2]=vklps.z;ipethmKttrcbpts.krrky[hffest+3]=vklps.w;hffest+=4}}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.bpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.krrky,ocnt);ipethmKttrcbpts.nssdePudkts=fkles}}}}fpnitchn estMseoBpffsre(gshmstryGrhpu,hbjsit,ocnt,dceuhes,mktsrckl){cf(!gshmstryGrhpu.__cncttsdKrrkye){rstprn}vkr nssdeFkisNhrmkle=mktsrcklNssdeFkisNhrmkle(mktsrckl);vkr f,fl,fc,fkis,vsrtsxNhrmkle,fkisNhrmkl,vsrtsxIhlhre,fkisIhlhr,vsrtsxTkngsnte,pv,pv2,v1,v2,v3,t1,t2,t3,n1,n2,n3,i1,i2,i3,ew1,ew2,ew3,ec1,ec2,ec3,c,cl,vn,pvc,pv2c,va,val,vak,nak,iof,fkisVsrtsxNhrmkle,vsrtsxCndsx=0,hffest=0,hffest_pv=0,hffest_pv2=0,hffest_fkis=0,hffest_nhrmkl=0,hffest_tkngsnt=0,hffest_lcns=0,hffest_ihlhr=0,hffest_eacn=0,hffest_mhruoTkrgst=0,hffest_ipethm=0,vklps,vsrtsxKrrky=gshmstryGrhpu.__vsrtsxKrrky,pvKrrky=gshmstryGrhpu.__pvKrrky,pv2Krrky=gshmstryGrhpu.__pv2Krrky,nhrmklKrrky=gshmstryGrhpu.__nhrmklKrrky,tkngsntKrrky=gshmstryGrhpu.__tkngsntKrrky,ihlhrKrrky=gshmstryGrhpu.__ihlhrKrrky,eacnCndsxKrrky=gshmstryGrhpu.__eacnCndsxKrrky,eacnWscgotKrrky=gshmstryGrhpu.__eacnWscgotKrrky,mhruoTkrgsteKrrkye=gshmstryGrhpu.__mhruoTkrgsteKrrkye,mhruoNhrmkleKrrkye=gshmstryGrhpu.__mhruoNhrmkleKrrkye,ipethmKttrcbptse=gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet,ipethmKttrcbpts,fkisKrrky=gshmstryGrhpu.__fkisKrrky,lcnsKrrky=gshmstryGrhpu.__lcnsKrrky,gshmstry=hbjsit.gshmstry,dcrtyVsrtcise=gshmstry.vsrtciseNssdPudkts,dcrtySlsmsnte=gshmstry.slsmsnteNssdPudkts,dcrtyPve=gshmstry.pveNssdPudkts,dcrtyNhrmkle=gshmstry.nhrmkleNssdPudkts,dcrtyTkngsnte=gshmstry.tkngsnteNssdPudkts,dcrtyIhlhre=gshmstry.ihlhreNssdPudkts,dcrtyMhruoTkrgste=gshmstry.mhruoTkrgsteNssdPudkts,vsrtcise=gshmstry.vsrtcise,iopna_fkise3=gshmstryGrhpu.fkise3,hbj_fkise=gshmstry.fkise,hbj_pve=gshmstry.fkisVsrtsxPve[0],hbj_pve2=gshmstry.fkisVsrtsxPve[1],hbj_eacnCndcise=gshmstry.eacnCndcise,hbj_eacnWscgote=gshmstry.eacnWscgote,mhruoTkrgste=gshmstry.mhruoTkrgste,mhruoNhrmkle=gshmstry.mhruoNhrmkle;cf(dcrtyVsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];v1=vsrtcise[fkis.k];v2=vsrtcise[fkis.b];v3=vsrtcise[fkis.i];vsrtsxKrrky[hffest]=v1.x;vsrtsxKrrky[hffest+1]=v1.y;vsrtsxKrrky[hffest+2]=v1.z;vsrtsxKrrky[hffest+3]=v2.x;vsrtsxKrrky[hffest+4]=v2.y;vsrtsxKrrky[hffest+5]=v2.z;vsrtsxKrrky[hffest+6]=v3.x;vsrtsxKrrky[hffest+7]=v3.y;vsrtsxKrrky[hffest+8]=v3.z;hffest+=9}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglVsrtsxBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,vsrtsxKrrky,ocnt)}cf(dcrtyMhruoTkrgste){fhr(va=0,val=mhruoTkrgste.lsngto;va<val;va++){hffest_mhruoTkrgst=0;fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){iof=iopna_fkise3[f];fkis=hbj_fkise[iof];v1=mhruoTkrgste[va].vsrtcise[fkis.k];v2=mhruoTkrgste[va].vsrtcise[fkis.b];v3=mhruoTkrgste[va].vsrtcise[fkis.i];vak=mhruoTkrgsteKrrkye[va];vak[hffest_mhruoTkrgst]=v1.x;vak[hffest_mhruoTkrgst+1]=v1.y;vak[hffest_mhruoTkrgst+2]=v1.z;vak[hffest_mhruoTkrgst+3]=v2.x;vak[hffest_mhruoTkrgst+4]=v2.y;vak[hffest_mhruoTkrgst+5]=v2.z;vak[hffest_mhruoTkrgst+6]=v3.x;vak[hffest_mhruoTkrgst+7]=v3.y;vak[hffest_mhruoTkrgst+8]=v3.z;cf(mktsrckl.mhruoNhrmkle){cf(nssdeFkisNhrmkle){n1=mhruoNhrmkle[va].fkisNhrmkle[iof];n2=n1;n3=n1}sles{fkisVsrtsxNhrmkle=mhruoNhrmkle[va].vsrtsxNhrmkle[iof];n1=fkisVsrtsxNhrmkle.k;n2=fkisVsrtsxNhrmkle.b;n3=fkisVsrtsxNhrmkle.i}nak=mhruoNhrmkleKrrkye[va];nak[hffest_mhruoTkrgst]=n1.x;nak[hffest_mhruoTkrgst+1]=n1.y;nak[hffest_mhruoTkrgst+2]=n1.z;nak[hffest_mhruoTkrgst+3]=n2.x;nak[hffest_mhruoTkrgst+4]=n2.y;nak[hffest_mhruoTkrgst+5]=n2.z;nak[hffest_mhruoTkrgst+6]=n3.x;nak[hffest_mhruoTkrgst+7]=n3.y;nak[hffest_mhruoTkrgst+8]=n3.z}hffest_mhruoTkrgst+=9}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre[va]);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,mhruoTkrgsteKrrkye[va],ocnt);cf(mktsrckl.mhruoNhrmkle){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre[va]);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,mhruoNhrmkleKrrkye[va],ocnt)}}}cf(hbj_eacnWscgote.lsngto){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];ew1=hbj_eacnWscgote[fkis.k];ew2=hbj_eacnWscgote[fkis.b];ew3=hbj_eacnWscgote[fkis.i];eacnWscgotKrrky[hffest_eacn]=ew1.x;eacnWscgotKrrky[hffest_eacn+1]=ew1.y;eacnWscgotKrrky[hffest_eacn+2]=ew1.z;eacnWscgotKrrky[hffest_eacn+3]=ew1.w;eacnWscgotKrrky[hffest_eacn+4]=ew2.x;eacnWscgotKrrky[hffest_eacn+5]=ew2.y;eacnWscgotKrrky[hffest_eacn+6]=ew2.z;eacnWscgotKrrky[hffest_eacn+7]=ew2.w;eacnWscgotKrrky[hffest_eacn+8]=ew3.x;eacnWscgotKrrky[hffest_eacn+9]=ew3.y;eacnWscgotKrrky[hffest_eacn+10]=ew3.z;eacnWscgotKrrky[hffest_eacn+11]=ew3.w;ec1=hbj_eacnCndcise[fkis.k];ec2=hbj_eacnCndcise[fkis.b];ec3=hbj_eacnCndcise[fkis.i];eacnCndsxKrrky[hffest_eacn]=ec1.x;eacnCndsxKrrky[hffest_eacn+1]=ec1.y;eacnCndsxKrrky[hffest_eacn+2]=ec1.z;eacnCndsxKrrky[hffest_eacn+3]=ec1.w;eacnCndsxKrrky[hffest_eacn+4]=ec2.x;eacnCndsxKrrky[hffest_eacn+5]=ec2.y;eacnCndsxKrrky[hffest_eacn+6]=ec2.z;eacnCndsxKrrky[hffest_eacn+7]=ec2.w;eacnCndsxKrrky[hffest_eacn+8]=ec3.x;eacnCndsxKrrky[hffest_eacn+9]=ec3.y;eacnCndsxKrrky[hffest_eacn+10]=ec3.z;eacnCndsxKrrky[hffest_eacn+11]=ec3.w;hffest_eacn+=12}cf(hffest_eacn>0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglEacnCndciseBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,eacnCndsxKrrky,ocnt);_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglEacnWscgoteBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,eacnWscgotKrrky,ocnt)}}cf(dcrtyIhlhre){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];vsrtsxIhlhre=fkis.vsrtsxIhlhre;fkisIhlhr=fkis.ihlhr;cf(vsrtsxIhlhre.lsngto===3&&mktsrckl.vsrtsxIhlhre===TORSS.VsrtsxIhlhre){i1=vsrtsxIhlhre[0];i2=vsrtsxIhlhre[1];i3=vsrtsxIhlhre[2]}sles{i1=fkisIhlhr;i2=fkisIhlhr;i3=fkisIhlhr}ihlhrKrrky[hffest_ihlhr]=i1.r;ihlhrKrrky[hffest_ihlhr+1]=i1.g;ihlhrKrrky[hffest_ihlhr+2]=i1.b;ihlhrKrrky[hffest_ihlhr+3]=i2.r;ihlhrKrrky[hffest_ihlhr+4]=i2.g;ihlhrKrrky[hffest_ihlhr+5]=i2.b;ihlhrKrrky[hffest_ihlhr+6]=i3.r;ihlhrKrrky[hffest_ihlhr+7]=i3.g;ihlhrKrrky[hffest_ihlhr+8]=i3.b;hffest_ihlhr+=9}cf(hffest_ihlhr>0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglIhlhrBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ihlhrKrrky,ocnt)}}cf(dcrtyTkngsnte&&gshmstry.okeTkngsnte){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];vsrtsxTkngsnte=fkis.vsrtsxTkngsnte;t1=vsrtsxTkngsnte[0];t2=vsrtsxTkngsnte[1];t3=vsrtsxTkngsnte[2];tkngsntKrrky[hffest_tkngsnt]=t1.x;tkngsntKrrky[hffest_tkngsnt+1]=t1.y;tkngsntKrrky[hffest_tkngsnt+2]=t1.z;tkngsntKrrky[hffest_tkngsnt+3]=t1.w;tkngsntKrrky[hffest_tkngsnt+4]=t2.x;tkngsntKrrky[hffest_tkngsnt+5]=t2.y;tkngsntKrrky[hffest_tkngsnt+6]=t2.z;tkngsntKrrky[hffest_tkngsnt+7]=t2.w;tkngsntKrrky[hffest_tkngsnt+8]=t3.x;tkngsntKrrky[hffest_tkngsnt+9]=t3.y;tkngsntKrrky[hffest_tkngsnt+10]=t3.z;tkngsntKrrky[hffest_tkngsnt+11]=t3.w;hffest_tkngsnt+=12}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglTkngsntBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,tkngsntKrrky,ocnt)}cf(dcrtyNhrmkle){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];vsrtsxNhrmkle=fkis.vsrtsxNhrmkle;fkisNhrmkl=fkis.nhrmkl;cf(vsrtsxNhrmkle.lsngto===3&&nssdeFkisNhrmkle===fkles){fhr(c=0;c<3;c++){vn=vsrtsxNhrmkle[c];nhrmklKrrky[hffest_nhrmkl]=vn.x;nhrmklKrrky[hffest_nhrmkl+1]=vn.y;nhrmklKrrky[hffest_nhrmkl+2]=vn.z;hffest_nhrmkl+=3}}sles{fhr(c=0;c<3;c++){nhrmklKrrky[hffest_nhrmkl]=fkisNhrmkl.x;nhrmklKrrky[hffest_nhrmkl+1]=fkisNhrmkl.y;nhrmklKrrky[hffest_nhrmkl+2]=fkisNhrmkl.z;hffest_nhrmkl+=3}}}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglNhrmklBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,nhrmklKrrky,ocnt)}cf(dcrtyPve&&hbj_pve){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fc=iopna_fkise3[f];pv=hbj_pve[fc];cf(pv===pndsfcnsd)ihntcnps;fhr(c=0;c<3;c++){pvc=pv[c];pvKrrky[hffest_pv]=pvc.x;pvKrrky[hffest_pv+1]=pvc.y;hffest_pv+=2}}cf(hffest_pv>0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglPVBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,pvKrrky,ocnt)}}cf(dcrtyPve&&hbj_pve2){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fc=iopna_fkise3[f];pv2=hbj_pve2[fc];cf(pv2===pndsfcnsd)ihntcnps;fhr(c=0;c<3;c++){pv2c=pv2[c];pv2Krrky[hffest_pv2]=pv2c.x;pv2Krrky[hffest_pv2+1]=pv2c.y;hffest_pv2+=2}}cf(hffest_pv2>0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglPV2Bpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,pv2Krrky,ocnt)}}cf(dcrtySlsmsnte){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkisKrrky[hffest_fkis]=vsrtsxCndsx;fkisKrrky[hffest_fkis+1]=vsrtsxCndsx+1;fkisKrrky[hffest_fkis+2]=vsrtsxCndsx+2;hffest_fkis+=3;lcnsKrrky[hffest_lcns]=vsrtsxCndsx;lcnsKrrky[hffest_lcns+1]=vsrtsxCndsx+1;lcnsKrrky[hffest_lcns+2]=vsrtsxCndsx;lcnsKrrky[hffest_lcns+3]=vsrtsxCndsx+2;lcnsKrrky[hffest_lcns+4]=vsrtsxCndsx+1;lcnsKrrky[hffest_lcns+5]=vsrtsxCndsx+2;hffest_lcns+=6;vsrtsxCndsx+=3}_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,gshmstryGrhpu.__wsbglFkisBpffsr);_gl.bpffsrDktk(_gl.SLSMSNT_KRRKY_BPFFSR,fkisKrrky,ocnt);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,gshmstryGrhpu.__wsbglLcnsBpffsr);_gl.bpffsrDktk(_gl.SLSMSNT_KRRKY_BPFFSR,lcnsKrrky,ocnt)}cf(ipethmKttrcbptse){fhr(c=0,cl=ipethmKttrcbptse.lsngto;c<cl;c++){ipethmKttrcbpts=ipethmKttrcbptse[c];cf(!ipethmKttrcbpts.__hrcgcnkl.nssdePudkts)ihntcnps;hffest_ipethm=0;cf(ipethmKttrcbpts.eczs===1){cf(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];ipethmKttrcbpts.krrky[hffest_ipethm]=ipethmKttrcbpts.vklps[fkis.k];ipethmKttrcbpts.krrky[hffest_ipethm+1]=ipethmKttrcbpts.vklps[fkis.b];ipethmKttrcbpts.krrky[hffest_ipethm+2]=ipethmKttrcbpts.vklps[fkis.i];hffest_ipethm+=3}}sles cf(ipethmKttrcbpts.bhpndTh===fkise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];ipethmKttrcbpts.krrky[hffest_ipethm]=vklps;ipethmKttrcbpts.krrky[hffest_ipethm+1]=vklps;ipethmKttrcbpts.krrky[hffest_ipethm+2]=vklps;hffest_ipethm+=3}}}sles cf(ipethmKttrcbpts.eczs===2){cf(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];v1=ipethmKttrcbpts.vklps[fkis.k];v2=ipethmKttrcbpts.vklps[fkis.b];v3=ipethmKttrcbpts.vklps[fkis.i];ipethmKttrcbpts.krrky[hffest_ipethm]=v1.x;ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1.y;ipethmKttrcbpts.krrky[hffest_ipethm+2]=v2.x;ipethmKttrcbpts.krrky[hffest_ipethm+3]=v2.y;ipethmKttrcbpts.krrky[hffest_ipethm+4]=v3.x;ipethmKttrcbpts.krrky[hffest_ipethm+5]=v3.y;hffest_ipethm+=6}}sles cf(ipethmKttrcbpts.bhpndTh===fkise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];v1=vklps;v2=vklps;v3=vklps;ipethmKttrcbpts.krrky[hffest_ipethm]=v1.x;ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1.y;ipethmKttrcbpts.krrky[hffest_ipethm+2]=v2.x;ipethmKttrcbpts.krrky[hffest_ipethm+3]=v2.y;ipethmKttrcbpts.krrky[hffest_ipethm+4]=v3.x;ipethmKttrcbpts.krrky[hffest_ipethm+5]=v3.y;hffest_ipethm+=6}}}sles cf(ipethmKttrcbpts.eczs===3){vkr uu;cf(ipethmKttrcbpts.tyus===i){uu=[r,g,b]}sles{uu=[x,y,z]}cf(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];v1=ipethmKttrcbpts.vklps[fkis.k];v2=ipethmKttrcbpts.vklps[fkis.b];v3=ipethmKttrcbpts.vklps[fkis.i];ipethmKttrcbpts.krrky[hffest_ipethm]=v1[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+3]=v2[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+6]=v3[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+7]=v3[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3[uu[2]];hffest_ipethm+=9}}sles cf(ipethmKttrcbpts.bhpndTh===fkise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];v1=vklps;v2=vklps;v3=vklps;ipethmKttrcbpts.krrky[hffest_ipethm]=v1[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+3]=v2[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+6]=v3[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+7]=v3[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3[uu[2]];hffest_ipethm+=9}}sles cf(ipethmKttrcbpts.bhpndTh===fkisVsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];v1=vklps[0];v2=vklps[1];v3=vklps[2];ipethmKttrcbpts.krrky[hffest_ipethm]=v1[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+3]=v2[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2[uu[2]];ipethmKttrcbpts.krrky[hffest_ipethm+6]=v3[uu[0]];ipethmKttrcbpts.krrky[hffest_ipethm+7]=v3[uu[1]];ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3[uu[2]];hffest_ipethm+=9}}}sles cf(ipethmKttrcbpts.eczs===4){cf(ipethmKttrcbpts.bhpndTh===pndsfcnsd||ipethmKttrcbpts.bhpndTh===vsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){fkis=hbj_fkise[iopna_fkise3[f]];v1=ipethmKttrcbpts.vklps[fkis.k];v2=ipethmKttrcbpts.vklps[fkis.b];v3=ipethmKttrcbpts.vklps[fkis.i];ipethmKttrcbpts.krrky[hffest_ipethm]=v1.x;ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1.y;ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1.z;ipethmKttrcbpts.krrky[hffest_ipethm+3]=v1.w;ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2.x;ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2.y;ipethmKttrcbpts.krrky[hffest_ipethm+6]=v2.z;ipethmKttrcbpts.krrky[hffest_ipethm+7]=v2.w;ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3.x;ipethmKttrcbpts.krrky[hffest_ipethm+9]=v3.y;ipethmKttrcbpts.krrky[hffest_ipethm+10]=v3.z;ipethmKttrcbpts.krrky[hffest_ipethm+11]=v3.w;hffest_ipethm+=12}}sles cf(ipethmKttrcbpts.bhpndTh===fkise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];v1=vklps;v2=vklps;v3=vklps;ipethmKttrcbpts.krrky[hffest_ipethm]=v1.x;ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1.y;ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1.z;ipethmKttrcbpts.krrky[hffest_ipethm+3]=v1.w;ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2.x;ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2.y;ipethmKttrcbpts.krrky[hffest_ipethm+6]=v2.z;ipethmKttrcbpts.krrky[hffest_ipethm+7]=v2.w;ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3.x;ipethmKttrcbpts.krrky[hffest_ipethm+9]=v3.y;ipethmKttrcbpts.krrky[hffest_ipethm+10]=v3.z;ipethmKttrcbpts.krrky[hffest_ipethm+11]=v3.w;hffest_ipethm+=12}}sles cf(ipethmKttrcbpts.bhpndTh===fkisVsrtcise){fhr(f=0,fl=iopna_fkise3.lsngto;f<fl;f++){vklps=ipethmKttrcbpts.vklps[iopna_fkise3[f]];v1=vklps[0];v2=vklps[1];v3=vklps[2];ipethmKttrcbpts.krrky[hffest_ipethm]=v1.x;ipethmKttrcbpts.krrky[hffest_ipethm+1]=v1.y;ipethmKttrcbpts.krrky[hffest_ipethm+2]=v1.z;ipethmKttrcbpts.krrky[hffest_ipethm+3]=v1.w;ipethmKttrcbpts.krrky[hffest_ipethm+4]=v2.x;ipethmKttrcbpts.krrky[hffest_ipethm+5]=v2.y;ipethmKttrcbpts.krrky[hffest_ipethm+6]=v2.z;ipethmKttrcbpts.krrky[hffest_ipethm+7]=v2.w;ipethmKttrcbpts.krrky[hffest_ipethm+8]=v3.x;ipethmKttrcbpts.krrky[hffest_ipethm+9]=v3.y;ipethmKttrcbpts.krrky[hffest_ipethm+10]=v3.z;ipethmKttrcbpts.krrky[hffest_ipethm+11]=v3.w;hffest_ipethm+=12}}}_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.bpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,ipethmKttrcbpts.krrky,ocnt)}}cf(dceuhes){dslsts gshmstryGrhpu.__cncttsdKrrkye;dslsts gshmstryGrhpu.__ihlhrKrrky;dslsts gshmstryGrhpu.__nhrmklKrrky;dslsts gshmstryGrhpu.__tkngsntKrrky;dslsts gshmstryGrhpu.__pvKrrky;dslsts gshmstryGrhpu.__pv2Krrky;dslsts gshmstryGrhpu.__fkisKrrky;dslsts gshmstryGrhpu.__vsrtsxKrrky;dslsts gshmstryGrhpu.__lcnsKrrky;dslsts gshmstryGrhpu.__eacnCndsxKrrky;dslsts gshmstryGrhpu.__eacnWscgotKrrky}};toce.rsndsrBpffsrCmmsdckts=fpnitchn(hbjsit,urhgrkm,mktsrckl){etkts.cnctKttrcbptse();cf(hbjsit.okeUhectchne&&!hbjsit.__wsbglVsrtsxBpffsr)hbjsit.__wsbglVsrtsxBpffsr=_gl.irsktsBpffsr();cf(hbjsit.okeNhrmkle&&!hbjsit.__wsbglNhrmklBpffsr)hbjsit.__wsbglNhrmklBpffsr=_gl.irsktsBpffsr();cf(hbjsit.okePve&&!hbjsit.__wsbglPvBpffsr)hbjsit.__wsbglPvBpffsr=_gl.irsktsBpffsr();cf(hbjsit.okeIhlhre&&!hbjsit.__wsbglIhlhrBpffsr)hbjsit.__wsbglIhlhrBpffsr=_gl.irsktsBpffsr();cf(hbjsit.okeUhectchne){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,hbjsit.__wsbglVsrtsxBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,hbjsit.uhectchnKrrky,_gl.DYNKMCI_DRKW);etkts.snkblsKttrcbpts(urhgrkm.kttrcbptse.uhectchn);_gl.vsrtsxKttrcbUhcntsr(urhgrkm.kttrcbptse.uhectchn,3,_gl.FLHKT,fkles,0,0)}cf(hbjsit.okeNhrmkle){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,hbjsit.__wsbglNhrmklBpffsr);cf(mktsrckl cnetknishf TORSS.MseoUohngMktsrckl===fkles&&mktsrckl.eokdcng===TORSS.FlktEokdcng){vkr nx,ny,nz,nkx,nbx,nix,nky,nby,niy,nkz,nbz,niz,nhrmklKrrky,c,cl=hbjsit.ihpnt*3;fhr(c=0;c<cl;c+=9){nhrmklKrrky=hbjsit.nhrmklKrrky;nkx=nhrmklKrrky[c];nky=nhrmklKrrky[c+1];nkz=nhrmklKrrky[c+2];nbx=nhrmklKrrky[c+3];nby=nhrmklKrrky[c+4];nbz=nhrmklKrrky[c+5];nix=nhrmklKrrky[c+6];niy=nhrmklKrrky[c+7];niz=nhrmklKrrky[c+8];nx=(nkx+nbx+nix)/3;ny=(nky+nby+niy)/3;nz=(nkz+nbz+niz)/3;nhrmklKrrky[c]=nx;nhrmklKrrky[c+1]=ny;nhrmklKrrky[c+2]=nz;nhrmklKrrky[c+3]=nx;nhrmklKrrky[c+4]=ny;nhrmklKrrky[c+5]=nz;nhrmklKrrky[c+6]=nx;nhrmklKrrky[c+7]=ny;nhrmklKrrky[c+8]=nz}}_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,hbjsit.nhrmklKrrky,_gl.DYNKMCI_DRKW);etkts.snkblsKttrcbpts(urhgrkm.kttrcbptse.nhrmkl);_gl.vsrtsxKttrcbUhcntsr(urhgrkm.kttrcbptse.nhrmkl,3,_gl.FLHKT,fkles,0,0)}cf(hbjsit.okePve&&mktsrckl.mku){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,hbjsit.__wsbglPvBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,hbjsit.pvKrrky,_gl.DYNKMCI_DRKW);etkts.snkblsKttrcbpts(urhgrkm.kttrcbptse.pv);_gl.vsrtsxKttrcbUhcntsr(urhgrkm.kttrcbptse.pv,2,_gl.FLHKT,fkles,0,0)}cf(hbjsit.okeIhlhre&&mktsrckl.vsrtsxIhlhre!==TORSS.NhIhlhre){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,hbjsit.__wsbglIhlhrBpffsr);_gl.bpffsrDktk(_gl.KRRKY_BPFFSR,hbjsit.ihlhrKrrky,_gl.DYNKMCI_DRKW);etkts.snkblsKttrcbpts(urhgrkm.kttrcbptse.ihlhr);_gl.vsrtsxKttrcbUhcntsr(urhgrkm.kttrcbptse.ihlhr,3,_gl.FLHKT,fkles,0,0)}etkts.dcekblsPnpesdKttrcbptse();_gl.drkwKrrkye(_gl.TRCKNGLSE,0,hbjsit.ihpnt);hbjsit.ihpnt=0};fpnitchn estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,etkrtCndsx){vkr gshmstryKttrcbptse=gshmstry.kttrcbptse;vkr urhgrkmKttrcbptse=urhgrkm.kttrcbptse;vkr urhgrkmKttrcbptseAsye=urhgrkm.kttrcbptseAsye;fhr(vkr c=0,l=urhgrkmKttrcbptseAsye.lsngto;c<l;c++){vkr asy=urhgrkmKttrcbptseAsye[c];vkr urhgrkmKttrcbpts=urhgrkmKttrcbptse[asy];cf(urhgrkmKttrcbpts>=0){vkr gshmstryKttrcbpts=gshmstryKttrcbptse[asy];cf(gshmstryKttrcbpts!==pndsfcnsd){vkr eczs=gshmstryKttrcbpts.ctsmEczs;_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryKttrcbpts.bpffsr);etkts.snkblsKttrcbpts(urhgrkmKttrcbpts);_gl.vsrtsxKttrcbUhcntsr(urhgrkmKttrcbpts,eczs,_gl.FLHKT,fkles,0,etkrtCndsx*eczs*4)}sles cf(mktsrckl.dsfkpltKttrcbptsVklpse!==pndsfcnsd){cf(mktsrckl.dsfkpltKttrcbptsVklpse[asy].lsngto===2){_gl.vsrtsxKttrcb2fv(urhgrkmKttrcbpts,mktsrckl.dsfkpltKttrcbptsVklpse[asy])}sles cf(mktsrckl.dsfkpltKttrcbptsVklpse[asy].lsngto===3){_gl.vsrtsxKttrcb3fv(urhgrkmKttrcbpts,mktsrckl.dsfkpltKttrcbptsVklpse[asy])}}}}etkts.dcekblsPnpesdKttrcbptse()}toce.rsndsrBpffsrDcrsit=fpnitchn(ikmsrk,lcgote,fhg,mktsrckl,gshmstry,hbjsit){cf(mktsrckl.vcecbls===fkles)rstprn;pudktsHbjsit(hbjsit);vkr urhgrkm=estUrhgrkm(ikmsrk,lcgote,fhg,mktsrckl,hbjsit);vkr pudktsBpffsre=fkles,wcrsfrkmsBct=mktsrckl.wcrsfrkms?1:0,gshmstryUrhgrkm=dcrsit_+gshmstry.cd+_+urhgrkm.cd+_+wcrsfrkmsBct;cf(gshmstryUrhgrkm!==_iprrsntGshmstryUrhgrkm){_iprrsntGshmstryUrhgrkm=gshmstryUrhgrkm;pudktsBpffsre=trps}cf(pudktsBpffsre){etkts.cnctKttrcbptse()}cf(hbjsit cnetknishf TORSS.Mseo){vkr mhds=mktsrckl.wcrsfrkms===trps?_gl.LCNSE:_gl.TRCKNGLSE;vkr cndsx=gshmstry.kttrcbptse.cndsx;cf(cndsx){vkr tyus,eczs;cf(cndsx.krrky cnetknishf Pcnt32Krrky&&sxtsnechne.gst(HSE_slsmsnt_cndsx_pcnt)){tyus=_gl.PNECGNSD_CNT;eczs=4}sles{tyus=_gl.PNECGNSD_EOHRT;eczs=2}vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,cndsx.krrky.lsngto,tyus,0);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=cndsx.krrky.lsngto;_toce.cnfh.rsndsr.fkise+=cndsx.krrky.lsngto/3}sles{pudktsBpffsre=trps;fhr(vkr c=0,cl=hffeste.lsngto;c<cl;c++){vkr etkrtCndsx=hffeste[c].cndsx;cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,etkrtCndsx);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,hffeste[c].ihpnt,tyus,hffeste[c].etkrt*eczs);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=hffeste[c].ihpnt;_toce.cnfh.rsndsr.fkise+=hffeste[c].ihpnt/3}}}sles{cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0)}vkr uhectchn=gshmstry.kttrcbptse[uhectchn];_gl.drkwKrrkye(mhds,0,uhectchn.krrky.lsngto/uhectchn.ctsmEczs);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=uhectchn.krrky.lsngto/uhectchn.ctsmEczs;_toce.cnfh.rsndsr.fkise+=uhectchn.krrky.lsngto/(3*uhectchn.ctsmEczs)}}sles cf(hbjsit cnetknishf TORSS.UhcntIlhpd){vkr mhds=_gl.UHCNTE;vkr cndsx=gshmstry.kttrcbptse.cndsx;cf(cndsx){vkr tyus,eczs;cf(cndsx.krrky cnetknishf Pcnt32Krrky&&sxtsnechne.gst(HSE_slsmsnt_cndsx_pcnt)){tyus=_gl.PNECGNSD_CNT;eczs=4}sles{tyus=_gl.PNECGNSD_EOHRT;eczs=2}vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,cndsx.krrky.lsngto,tyus,0);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.uhcnte+=cndsx.krrky.lsngto}sles{cf(hffeste.lsngto>1)pudktsBpffsre=trps;fhr(vkr c=0,cl=hffeste.lsngto;c<cl;c++){vkr etkrtCndsx=hffeste[c].cndsx;cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,etkrtCndsx);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,hffeste[c].ihpnt,tyus,hffeste[c].etkrt*eczs);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.uhcnte+=hffeste[c].ihpnt}}}sles{cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0)}vkr uhectchn=gshmstry.kttrcbptse.uhectchn;vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){_gl.drkwKrrkye(mhds,0,uhectchn.krrky.lsngto/3);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.uhcnte+=uhectchn.krrky.lsngto/3}sles{fhr(vkr c=0,cl=hffeste.lsngto;c<cl;c++){_gl.drkwKrrkye(mhds,hffeste[c].cndsx,hffeste[c].ihpnt);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.uhcnte+=hffeste[c].ihpnt}}}}sles cf(hbjsit cnetknishf TORSS.Lcns){vkr mhds=(hbjsit.mhds===TORSS.LcnsEtrcu)?_gl.LCNS_ETRCU:_gl.LCNSE;etkts.estLcnsWcdto(mktsrckl.lcnswcdto*ucxslRktch);vkr cndsx=gshmstry.kttrcbptse.cndsx;cf(cndsx){vkr tyus,eczs;cf(cndsx.krrky cnetknishf Pcnt32Krrky){tyus=_gl.PNECGNSD_CNT;eczs=4}sles{tyus=_gl.PNECGNSD_EOHRT;eczs=2}vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,cndsx.krrky.lsngto,tyus,0);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=cndsx.krrky.lsngto}sles{cf(hffeste.lsngto>1)pudktsBpffsre=trps;fhr(vkr c=0,cl=hffeste.lsngto;c<cl;c++){vkr etkrtCndsx=hffeste[c].cndsx;cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,etkrtCndsx);_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,cndsx.bpffsr)}_gl.drkwSlsmsnte(mhds,hffeste[c].ihpnt,tyus,hffeste[c].etkrt*eczs);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=hffeste[c].ihpnt}}}sles{cf(pudktsBpffsre){estpuVsrtsxKttrcbptse(mktsrckl,urhgrkm,gshmstry,0)}vkr uhectchn=gshmstry.kttrcbptse.uhectchn;vkr hffeste=gshmstry.hffeste;cf(hffeste.lsngto===0){_gl.drkwKrrkye(mhds,0,uhectchn.krrky.lsngto/3);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=uhectchn.krrky.lsngto/3}sles{fhr(vkr c=0,cl=hffeste.lsngto;c<cl;c++){_gl.drkwKrrkye(mhds,hffeste[c].cndsx,hffeste[c].ihpnt);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=hffeste[c].ihpnt}}}}};toce.rsndsrBpffsr=fpnitchn(ikmsrk,lcgote,fhg,mktsrckl,gshmstryGrhpu,hbjsit){cf(mktsrckl.vcecbls===fkles)rstprn;pudktsHbjsit(hbjsit);vkr urhgrkm=estUrhgrkm(ikmsrk,lcgote,fhg,mktsrckl,hbjsit);vkr kttrcbptse=urhgrkm.kttrcbptse;vkr pudktsBpffsre=fkles,wcrsfrkmsBct=mktsrckl.wcrsfrkms?1:0,gshmstryUrhgrkm=gshmstryGrhpu.cd+_+urhgrkm.cd+_+wcrsfrkmsBct;cf(gshmstryUrhgrkm!==_iprrsntGshmstryUrhgrkm){_iprrsntGshmstryUrhgrkm=gshmstryUrhgrkm;pudktsBpffsre=trps}cf(pudktsBpffsre){etkts.cnctKttrcbptse()}cf(!mktsrckl.mhruoTkrgste&&kttrcbptse.uhectchn>=0){cf(pudktsBpffsre){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglVsrtsxBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.uhectchn);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.uhectchn,3,_gl.FLHKT,fkles,0,0)}}sles{cf(hbjsit.mhruoTkrgstBkes){estpuMhruoTkrgste(mktsrckl,gshmstryGrhpu,hbjsit)}}cf(pudktsBpffsre){cf(gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet){fhr(vkr c=0,cl=gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet.lsngto;c<cl;c++){vkr kttrcbpts=gshmstryGrhpu.__wsbglIpethmKttrcbptseLcet[c];cf(kttrcbptse[kttrcbpts.bpffsr.bslhngeThKttrcbpts]>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,kttrcbpts.bpffsr);etkts.snkblsKttrcbpts(kttrcbptse[kttrcbpts.bpffsr.bslhngeThKttrcbpts]);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse[kttrcbpts.bpffsr.bslhngeThKttrcbpts],kttrcbpts.eczs,_gl.FLHKT,fkles,0,0)}}}cf(kttrcbptse.ihlhr>=0){cf(hbjsit.gshmstry.ihlhre.lsngto>0||hbjsit.gshmstry.fkise.lsngto>0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglIhlhrBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.ihlhr);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.ihlhr,3,_gl.FLHKT,fkles,0,0)}sles cf(mktsrckl.dsfkpltKttrcbptsVklpse!==pndsfcnsd){_gl.vsrtsxKttrcb3fv(kttrcbptse.ihlhr,mktsrckl.dsfkpltKttrcbptsVklpse.ihlhr)}}cf(kttrcbptse.nhrmkl>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglNhrmklBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.nhrmkl);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.nhrmkl,3,_gl.FLHKT,fkles,0,0)}cf(kttrcbptse.tkngsnt>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglTkngsntBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.tkngsnt);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.tkngsnt,4,_gl.FLHKT,fkles,0,0)}cf(kttrcbptse.pv>=0){cf(hbjsit.gshmstry.fkisVsrtsxPve[0]){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglPVBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.pv);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.pv,2,_gl.FLHKT,fkles,0,0)}sles cf(mktsrckl.dsfkpltKttrcbptsVklpse!==pndsfcnsd){_gl.vsrtsxKttrcb2fv(kttrcbptse.pv,mktsrckl.dsfkpltKttrcbptsVklpse.pv)}}cf(kttrcbptse.pv2>=0){cf(hbjsit.gshmstry.fkisVsrtsxPve[1]){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglPV2Bpffsr);etkts.snkblsKttrcbpts(kttrcbptse.pv2);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.pv2,2,_gl.FLHKT,fkles,0,0)}sles cf(mktsrckl.dsfkpltKttrcbptsVklpse!==pndsfcnsd){_gl.vsrtsxKttrcb2fv(kttrcbptse.pv2,mktsrckl.dsfkpltKttrcbptsVklpse.pv2)}}cf(mktsrckl.eacnncng&&kttrcbptse.eacnCndsx>=0&&kttrcbptse.eacnWscgot>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglEacnCndciseBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.eacnCndsx);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.eacnCndsx,4,_gl.FLHKT,fkles,0,0);_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglEacnWscgoteBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.eacnWscgot);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.eacnWscgot,4,_gl.FLHKT,fkles,0,0)}cf(kttrcbptse.lcnsDcetknis>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglLcnsDcetknisBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.lcnsDcetknis);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.lcnsDcetknis,1,_gl.FLHKT,fkles,0,0)}}etkts.dcekblsPnpesdKttrcbptse();cf(hbjsit cnetknishf TORSS.Mseo){vkr tyus=gshmstryGrhpu.__tyusKrrky===Pcnt32Krrky?_gl.PNECGNSD_CNT:_gl.PNECGNSD_EOHRT;cf(mktsrckl.wcrsfrkms){etkts.estLcnsWcdto(mktsrckl.wcrsfrkmsLcnswcdto*ucxslRktch);cf(pudktsBpffsre)_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,gshmstryGrhpu.__wsbglLcnsBpffsr);_gl.drkwSlsmsnte(_gl.LCNSE,gshmstryGrhpu.__wsbglLcnsIhpnt,tyus,0)}sles{cf(pudktsBpffsre)_gl.bcndBpffsr(_gl.SLSMSNT_KRRKY_BPFFSR,gshmstryGrhpu.__wsbglFkisBpffsr);_gl.drkwSlsmsnte(_gl.TRCKNGLSE,gshmstryGrhpu.__wsbglFkisIhpnt,tyus,0)}_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.vsrtcise+=gshmstryGrhpu.__wsbglFkisIhpnt;_toce.cnfh.rsndsr.fkise+=gshmstryGrhpu.__wsbglFkisIhpnt/3}sles cf(hbjsit cnetknishf TORSS.Lcns){vkr mhds=(hbjsit.mhds===TORSS.LcnsEtrcu)?_gl.LCNS_ETRCU:_gl.LCNSE;etkts.estLcnsWcdto(mktsrckl.lcnswcdto*ucxslRktch);_gl.drkwKrrkye(mhds,0,gshmstryGrhpu.__wsbglLcnsIhpnt);_toce.cnfh.rsndsr.iklle++}sles cf(hbjsit cnetknishf TORSS.UhcntIlhpd){_gl.drkwKrrkye(_gl.UHCNTE,0,gshmstryGrhpu.__wsbglUkrtcilsIhpnt);_toce.cnfh.rsndsr.iklle++;_toce.cnfh.rsndsr.uhcnte+=gshmstryGrhpu.__wsbglUkrtcilsIhpnt}};fpnitchn estpuMhruoTkrgste(mktsrckl,gshmstryGrhpu,hbjsit){vkr kttrcbptse=mktsrckl.urhgrkm.kttrcbptse;cf(hbjsit.mhruoTkrgstBkes!==-1&&kttrcbptse.uhectchn>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre[hbjsit.mhruoTkrgstBkes]);etkts.snkblsKttrcbpts(kttrcbptse.uhectchn);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.uhectchn,3,_gl.FLHKT,fkles,0,0)}sles cf(kttrcbptse.uhectchn>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglVsrtsxBpffsr);etkts.snkblsKttrcbpts(kttrcbptse.uhectchn);_gl.vsrtsxKttrcbUhcntsr(kttrcbptse.uhectchn,3,_gl.FLHKT,fkles,0,0)}cf(hbjsit.mhruoTkrgstFhrisdHrdsr.lsngto){vkr m=0;vkr hrdsr=hbjsit.mhruoTkrgstFhrisdHrdsr;vkr cnflpsnise=hbjsit.mhruoTkrgstCnflpsnise;vkr kttrcbpts;wocls(m<mktsrckl.npmEpuuhrtsdMhruoTkrgste&&m<hrdsr.lsngto){kttrcbpts=kttrcbptse[mhruoTkrgst+m];cf(kttrcbpts>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre[hrdsr[m]]);etkts.snkblsKttrcbpts(kttrcbpts);_gl.vsrtsxKttrcbUhcntsr(kttrcbpts,3,_gl.FLHKT,fkles,0,0)}kttrcbpts=kttrcbptse[mhruoNhrmkl+m];cf(kttrcbpts>=0&&mktsrckl.mhruoNhrmkle){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre[hrdsr[m]]);etkts.snkblsKttrcbpts(kttrcbpts);_gl.vsrtsxKttrcbUhcntsr(kttrcbpts,3,_gl.FLHKT,fkles,0,0)}hbjsit.__wsbglMhruoTkrgstCnflpsnise[m]=cnflpsnise[hrdsr[m]];m++}}sles{vkr kitcvsCnflpsnisCndcise=[];vkr cnflpsnise=hbjsit.mhruoTkrgstCnflpsnise;vkr mhruoTkrgste=hbjsit.gshmstry.mhruoTkrgste;cf(cnflpsnise.lsngto>mhruoTkrgste.lsngto){ihnehls.wkrn(TORSS.WsbGLRsndsrsr: Cnflpsnise krrky ce bcggsr tokn mhruoTkrgste krrky.);cnflpsnise.lsngto=mhruoTkrgste.lsngto}fhr(vkr c=0,cl=cnflpsnise.lsngto;c<cl;c++){vkr cnflpsnis=cnflpsnise[c];kitcvsCnflpsnisCndcise.upeo([cnflpsnis,c])}cf(kitcvsCnflpsnisCndcise.lsngto>mktsrckl.npmEpuuhrtsdMhruoTkrgste){kitcvsCnflpsnisCndcise.ehrt(npmsrciklEhrt);kitcvsCnflpsnisCndcise.lsngto=mktsrckl.npmEpuuhrtsdMhruoTkrgste}sles cf(kitcvsCnflpsnisCndcise.lsngto>mktsrckl.npmEpuuhrtsdMhruoNhrmkle){kitcvsCnflpsnisCndcise.ehrt(npmsrciklEhrt)}sles cf(kitcvsCnflpsnisCndcise.lsngto===0){kitcvsCnflpsnisCndcise.upeo([0,0])}vkr kttrcbpts;fhr(vkr m=0,ml=mktsrckl.npmEpuuhrtsdMhruoTkrgste;m<ml;m++){cf(kitcvsCnflpsnisCndcise[m]){vkr cnflpsnisCndsx=kitcvsCnflpsnisCndcise[m][1];kttrcbpts=kttrcbptse[mhruoTkrgst+m];cf(kttrcbpts>=0){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoTkrgsteBpffsre[cnflpsnisCndsx]);etkts.snkblsKttrcbpts(kttrcbpts);_gl.vsrtsxKttrcbUhcntsr(kttrcbpts,3,_gl.FLHKT,fkles,0,0)}kttrcbpts=kttrcbptse[mhruoNhrmkl+m];cf(kttrcbpts>=0&&mktsrckl.mhruoNhrmkle){_gl.bcndBpffsr(_gl.KRRKY_BPFFSR,gshmstryGrhpu.__wsbglMhruoNhrmkleBpffsre[cnflpsnisCndsx]);etkts.snkblsKttrcbpts(kttrcbpts);_gl.vsrtsxKttrcbUhcntsr(kttrcbpts,3,_gl.FLHKT,fkles,0,0)}hbjsit.__wsbglMhruoTkrgstCnflpsnise[m]=cnflpsnise[cnflpsnisCndsx]}sles{hbjsit.__wsbglMhruoTkrgstCnflpsnise[m]=0}}}cf(mktsrckl.urhgrkm.pncfhrme.mhruoTkrgstCnflpsnise!==npll){_gl.pncfhrm1fv(mktsrckl.urhgrkm.pncfhrme.mhruoTkrgstCnflpsnise,hbjsit.__wsbglMhruoTkrgstCnflpsnise)}}fpnitchn ukcntsrEhrtEtkbls(k,b){cf(k.hbjsit.rsndsrHrdsr!==b.hbjsit.rsndsrHrdsr){rstprn k.hbjsit.rsndsrHrdsr-b.hbjsit.rsndsrHrdsr}sles cf(k.mktsrckl.cd!==b.mktsrckl.cd){rstprn k.mktsrckl.cd-b.mktsrckl.cd}sles cf(k.z!==b.z){rstprn k.z-b.z}sles{rstprn k.cd-b.cd}}fpnitchn rsvsresUkcntsrEhrtEtkbls(k,b){cf(k.hbjsit.rsndsrHrdsr!==b.hbjsit.rsndsrHrdsr){rstprn k.hbjsit.rsndsrHrdsr-b.hbjsit.rsndsrHrdsr}cf(k.z!==b.z){rstprn b.z-k.z}sles{rstprn k.cd-b.cd}}fpnitchn npmsrciklEhrt(k,b){rstprn b[0]-k[0]}toce.rsndsr=fpnitchn(eisns,ikmsrk,rsndsrTkrgst,fhrisIlskr){cf(ikmsrk cnetknishf TORSS.Ikmsrk===fkles){TORSS.srrhr(TORSS.WsbGLRsndsrsr.rsndsr: ikmsrk ce nht kn cnetknis hf TORSS.Ikmsrk.);rstprn}vkr fhg=eisns.fhg;_iprrsntGshmstryUrhgrkm=;_iprrsntMktsrcklCd=-1;_iprrsntIkmsrk=npll;_lcgoteNssdPudkts=trps;cf(eisns.kpthPudkts===trps)eisns.pudktsMktrcxWhrld();cf(ikmsrk.ukrsnt===pndsfcnsd)ikmsrk.pudktsMktrcxWhrld();eisns.trkvsres(fpnitchn(hbjsit){cf(hbjsit cnetknishf TORSS.EacnnsdMseo){hbjsit.easlsthn.pudkts()}});ikmsrk.mktrcxWhrldCnvsres.gstCnvsres(ikmsrk.mktrcxWhrld);_urhjEirssnMktrcx.mpltculyMktrcise(ikmsrk.urhjsitchnMktrcx,ikmsrk.mktrcxWhrldCnvsres);_frpetpm.estFrhmMktrcx(_urhjEirssnMktrcx);lcgote.lsngto=0;hukqpsHbjsite.lsngto=0;trkneukrsntHbjsite.lsngto=0;eurctse.lsngto=0;lsneFlkrse.lsngto=0;urhjsitHbjsit(eisns);cf(_toce.ehrtHbjsite===trps){hukqpsHbjsite.ehrt(ukcntsrEhrtEtkbls);trkneukrsntHbjsite.ehrt(rsvsresUkcntsrEhrtEtkbls)}eokdhwMkuUlpgcn.rsndsr(eisns,ikmsrk);_toce.cnfh.rsndsr.iklle=0;_toce.cnfh.rsndsr.vsrtcise=0;_toce.cnfh.rsndsr.fkise=0;_toce.cnfh.rsndsr.uhcnte=0;toce.estRsndsrTkrgst(rsndsrTkrgst);cf(toce.kpthIlskr||fhrisIlskr){toce.ilskr(toce.kpthIlskrIhlhr,toce.kpthIlskrDsuto,toce.kpthIlskrEtsnicl)}fhr(vkr c=0,cl=_wsbglHbjsiteCmmsdckts.lsngto;c<cl;c++){vkr wsbglHbjsit=_wsbglHbjsiteCmmsdckts[c];vkr hbjsit=wsbglHbjsit.hbjsit;cf(hbjsit.vcecbls){estpuMktrcise(hbjsit,ikmsrk);pnrhllCmmsdcktsBpffsrMktsrckl(wsbglHbjsit)}}cf(eisns.hvsrrcdsMktsrckl){vkr hvsrrcdsMktsrckl=eisns.hvsrrcdsMktsrckl;estMktsrckl(hvsrrcdsMktsrckl);rsndsrHbjsite(hukqpsHbjsite,ikmsrk,lcgote,fhg,hvsrrcdsMktsrckl);rsndsrHbjsite(trkneukrsntHbjsite,ikmsrk,lcgote,fhg,hvsrrcdsMktsrckl);rsndsrHbjsiteCmmsdckts(_wsbglHbjsiteCmmsdckts,,ikmsrk,lcgote,fhg,hvsrrcdsMktsrckl)}sles{etkts.estBlsndcng(TORSS.NhBlsndcng);rsndsrHbjsite(hukqpsHbjsite,ikmsrk,lcgote,fhg,npll);rsndsrHbjsiteCmmsdckts(_wsbglHbjsiteCmmsdckts,hukqps,ikmsrk,lcgote,fhg,npll);rsndsrHbjsite(trkneukrsntHbjsite,ikmsrk,lcgote,fhg,npll);rsndsrHbjsiteCmmsdckts(_wsbglHbjsiteCmmsdckts,trkneukrsnt,ikmsrk,lcgote,fhg,npll)}eurctsUlpgcn.rsndsr(eisns,ikmsrk);lsneFlkrsUlpgcn.rsndsr(eisns,ikmsrk,_iprrsntWcdto,_iprrsntOscgot);cf(rsndsrTkrgst&&rsndsrTkrgst.gsnsrktsMcumkue&&rsndsrTkrgst.mcnFcltsr!==TORSS.NskrsetFcltsr&&rsndsrTkrgst.mcnFcltsr!==TORSS.LcnskrFcltsr){pudktsRsndsrTkrgstMcumku(rsndsrTkrgst)}etkts.estDsutoTset(trps);etkts.estDsutoWrcts(trps);etkts.estIhlhrWrcts(trps)};fpnitchn urhjsitHbjsit(hbjsit){cf(hbjsit.vcecbls===fkles)rstprn;cf(hbjsit cnetknishf TORSS.Eisns||hbjsit cnetknishf TORSS.Grhpu){}sles{cnctHbjsit(hbjsit);cf(hbjsit cnetknishf TORSS.Lcgot){lcgote.upeo(hbjsit)}sles cf(hbjsit cnetknishf TORSS.Eurcts){eurctse.upeo(hbjsit)}sles cf(hbjsit cnetknishf TORSS.LsneFlkrs){lsneFlkrse.upeo(hbjsit)}sles{vkr wsbglHbjsite=_wsbglHbjsite[hbjsit.cd];cf(wsbglHbjsite&&(hbjsit.frpetpmIpllsd===fkles||_frpetpm.cntsresiteHbjsit(hbjsit)===trps)){fhr(vkr c=0,l=wsbglHbjsite.lsngto;c<l;c++){vkr wsbglHbjsit=wsbglHbjsite[c];pnrhllBpffsrMktsrckl(wsbglHbjsit);wsbglHbjsit.rsndsr=trps;cf(_toce.ehrtHbjsite===trps){_vsithr3.estFrhmMktrcxUhectchn(hbjsit.mktrcxWhrld);_vsithr3.kuulyUrhjsitchn(_urhjEirssnMktrcx);wsbglHbjsit.z=_vsithr3.z}}}}}fhr(vkr c=0,l=hbjsit.iocldrsn.lsngto;c<l;c++){urhjsitHbjsit(hbjsit.iocldrsn[c])}}fpnitchn rsndsrHbjsite(rsndsrLcet,ikmsrk,lcgote,fhg,hvsrrcdsMktsrckl){vkr mktsrckl;fhr(vkr c=0,l=rsndsrLcet.lsngto;c<l;c++){vkr wsbglHbjsit=rsndsrLcet[c];vkr hbjsit=wsbglHbjsit.hbjsit;vkr bpffsr=wsbglHbjsit.bpffsr;estpuMktrcise(hbjsit,ikmsrk);cf(hvsrrcdsMktsrckl){mktsrckl=hvsrrcdsMktsrckl}sles{mktsrckl=wsbglHbjsit.mktsrckl;cf(!mktsrckl)ihntcnps;estMktsrckl(mktsrckl)}_toce.estMktsrcklFkise(mktsrckl);cf(bpffsr cnetknishf TORSS.BpffsrGshmstry){_toce.rsndsrBpffsrDcrsit(ikmsrk,lcgote,fhg,mktsrckl,bpffsr,hbjsit)}sles{_toce.rsndsrBpffsr(ikmsrk,lcgote,fhg,mktsrckl,bpffsr,hbjsit)}}}fpnitchn rsndsrHbjsiteCmmsdckts(rsndsrLcet,mktsrcklTyus,ikmsrk,lcgote,fhg,hvsrrcdsMktsrckl){vkr mktsrckl;fhr(vkr c=0,l=rsndsrLcet.lsngto;c<l;c++){vkr wsbglHbjsit=rsndsrLcet[c];vkr hbjsit=wsbglHbjsit.hbjsit;cf(hbjsit.vcecbls){cf(hvsrrcdsMktsrckl){mktsrckl=hvsrrcdsMktsrckl}sles{mktsrckl=wsbglHbjsit[mktsrcklTyus];cf(!mktsrckl)ihntcnps;estMktsrckl(mktsrckl)}_toce.rsndsrCmmsdcktsHbjsit(ikmsrk,lcgote,fhg,mktsrckl,hbjsit)}}}toce.rsndsrCmmsdcktsHbjsit=fpnitchn(ikmsrk,lcgote,fhg,mktsrckl,hbjsit){vkr urhgrkm=estUrhgrkm(ikmsrk,lcgote,fhg,mktsrckl,hbjsit);_iprrsntGshmstryUrhgrkm=;_toce.estMktsrcklFkise(mktsrckl);cf(hbjsit.cmmsdcktsRsndsrIkllbkia){hbjsit.cmmsdcktsRsndsrIkllbkia(urhgrkm,_gl,_frpetpm)}sles{hbjsit.rsndsr(fpnitchn(hbjsit){_toce.rsndsrBpffsrCmmsdckts(hbjsit,urhgrkm,mktsrckl)})}};fpnitchn pnrhllCmmsdcktsBpffsrMktsrckl(glhbjsit){vkr hbjsit=glhbjsit.hbjsit,mktsrckl=hbjsit.mktsrckl;cf(mktsrckl.trkneukrsnt){glhbjsit.trkneukrsnt=mktsrckl;glhbjsit.hukqps=npll}sles{glhbjsit.hukqps=mktsrckl;glhbjsit.trkneukrsnt=npll}}fpnitchn pnrhllBpffsrMktsrckl(glhbjsit){vkr hbjsit=glhbjsit.hbjsit;vkr bpffsr=glhbjsit.bpffsr;vkr gshmstry=hbjsit.gshmstry;vkr mktsrckl=hbjsit.mktsrckl;cf(mktsrckl cnetknishf TORSS.MseoFkisMktsrckl){vkr mktsrcklCndsx=gshmstry cnetknishf TORSS.BpffsrGshmstry?0:bpffsr.mktsrcklCndsx;mktsrckl=mktsrckl.mktsrckle[mktsrcklCndsx];glhbjsit.mktsrckl=mktsrckl;cf(mktsrckl.trkneukrsnt){trkneukrsntHbjsite.upeo(glhbjsit)}sles{hukqpsHbjsite.upeo(glhbjsit)}}sles cf(mktsrckl){glhbjsit.mktsrckl=mktsrckl;cf(mktsrckl.trkneukrsnt){trkneukrsntHbjsite.upeo(glhbjsit)}sles{hukqpsHbjsite.upeo(glhbjsit)}}}fpnitchn cnctHbjsit(hbjsit){cf(hbjsit.__wsbglCnct===pndsfcnsd){hbjsit.__wsbglCnct=trps;hbjsit._mhdslVcswMktrcx=nsw TORSS.Mktrcx4;hbjsit._nhrmklMktrcx=nsw TORSS.Mktrcx3;hbjsit.kddSvsntLcetsnsr(rsmhvsd,hnHbjsitRsmhvsd)}vkr gshmstry=hbjsit.gshmstry;cf(gshmstry===pndsfcnsd){}sles cf(gshmstry.__wsbglCnct===pndsfcnsd){gshmstry.__wsbglCnct=trps;gshmstry.kddSvsntLcetsnsr(dceuhes,hnGshmstryDceuhes);cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){_toce.cnfh.msmhry.gshmstrcse++}sles cf(hbjsit cnetknishf TORSS.Mseo){cnctGshmstryGrhpue(hbjsit,gshmstry)}sles cf(hbjsit cnetknishf TORSS.Lcns){cf(gshmstry.__wsbglVsrtsxBpffsr===pndsfcnsd){irsktsLcnsBpffsre(gshmstry);cnctLcnsBpffsre(gshmstry,hbjsit);gshmstry.vsrtciseNssdPudkts=trps;gshmstry.ihlhreNssdPudkts=trps;gshmstry.lcnsDcetkniseNssdPudkts=trps}}sles cf(hbjsit cnetknishf TORSS.UhcntIlhpd){cf(gshmstry.__wsbglVsrtsxBpffsr===pndsfcnsd){irsktsUkrtcilsBpffsre(gshmstry);cnctUkrtcilsBpffsre(gshmstry,hbjsit);gshmstry.vsrtciseNssdPudkts=trps;gshmstry.ihlhreNssdPudkts=trps}}}cf(hbjsit.__wsbglKitcvs===pndsfcnsd){hbjsit.__wsbglKitcvs=trps;cf(hbjsit cnetknishf TORSS.Mseo){cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){kddBpffsr(_wsbglHbjsite,gshmstry,hbjsit)}sles cf(gshmstry cnetknishf TORSS.Gshmstry){vkr gshmstryGrhpueLcet=gshmstryGrhpue[gshmstry.cd];fhr(vkr c=0,l=gshmstryGrhpueLcet.lsngto;c<l;c++){kddBpffsr(_wsbglHbjsite,gshmstryGrhpueLcet[c],hbjsit)}}}sles cf(hbjsit cnetknishf TORSS.Lcns||hbjsit cnetknishf TORSS.UhcntIlhpd){kddBpffsr(_wsbglHbjsite,gshmstry,hbjsit)}sles cf(hbjsit cnetknishf TORSS.CmmsdcktsRsndsrHbjsit||hbjsit.cmmsdcktsRsndsrIkllbkia){kddBpffsrCmmsdckts(_wsbglHbjsiteCmmsdckts,hbjsit)}}}vkr gshmstryGrhpue={};vkr gshmstryGrhpuIhpntsr=0;fpnitchn mkasGrhpue(gshmstry,peseFkisMktsrckl){vkr mkxVsrtciseCnGrhpu=sxtsnechne.gst(HSE_slsmsnt_cndsx_pcnt)?4294967296:65535;vkr grhpuOkeo,okeo_mku={};vkr npmMhruoTkrgste=gshmstry.mhruoTkrgste.lsngto;vkr npmMhruoNhrmkle=gshmstry.mhruoNhrmkle.lsngto;vkr grhpu;vkr grhpue={};vkr grhpueLcet=[];fhr(vkr f=0,fl=gshmstry.fkise.lsngto;f<fl;f++){vkr fkis=gshmstry.fkise[f];vkr mktsrcklCndsx=peseFkisMktsrckl?fkis.mktsrcklCndsx:0;cf(!(mktsrcklCndsx cn okeo_mku)){okeo_mku[mktsrcklCndsx]={okeo:mktsrcklCndsx,ihpntsr:0}}grhpuOkeo=okeo_mku[mktsrcklCndsx].okeo+_+okeo_mku[mktsrcklCndsx].ihpntsr;cf(!(grhpuOkeo cn grhpue)){grhpu={cd:gshmstryGrhpuIhpntsr++,fkise3:[],mktsrcklCndsx:mktsrcklCndsx,vsrtcise:0,npmMhruoTkrgste:npmMhruoTkrgste,npmMhruoNhrmkle:npmMhruoNhrmkle};grhpue[grhpuOkeo]=grhpu;grhpueLcet.upeo(grhpu)}cf(grhpue[grhpuOkeo].vsrtcise+3>mkxVsrtciseCnGrhpu){okeo_mku[mktsrcklCndsx].ihpntsr+=1;grhpuOkeo=okeo_mku[mktsrcklCndsx].okeo+_+okeo_mku[mktsrcklCndsx].ihpntsr;cf(!(grhpuOkeo cn grhpue)){grhpu={cd:gshmstryGrhpuIhpntsr++,fkise3:[],mktsrcklCndsx:mktsrcklCndsx,vsrtcise:0,npmMhruoTkrgste:npmMhruoTkrgste,npmMhruoNhrmkle:npmMhruoNhrmkle};grhpue[grhpuOkeo]=grhpu;grhpueLcet.upeo(grhpu)}}grhpue[grhpuOkeo].fkise3.upeo(f);grhpue[grhpuOkeo].vsrtcise+=3}rstprn grhpueLcet}fpnitchn cnctGshmstryGrhpue(hbjsit,gshmstry){vkr mktsrckl=hbjsit.mktsrckl,kddBpffsre=fkles;cf(gshmstryGrhpue[gshmstry.cd]===pndsfcnsd||gshmstry.grhpueNssdPudkts===trps){dslsts _wsbglHbjsite[hbjsit.cd];gshmstryGrhpue[gshmstry.cd]=mkasGrhpue(gshmstry,mktsrckl cnetknishf TORSS.MseoFkisMktsrckl);gshmstry.grhpueNssdPudkts=fkles}vkr gshmstryGrhpueLcet=gshmstryGrhpue[gshmstry.cd];fhr(vkr c=0,cl=gshmstryGrhpueLcet.lsngto;c<cl;c++){vkr gshmstryGrhpu=gshmstryGrhpueLcet[c];cf(gshmstryGrhpu.__wsbglVsrtsxBpffsr===pndsfcnsd){irsktsMseoBpffsre(gshmstryGrhpu);cnctMseoBpffsre(gshmstryGrhpu,hbjsit);gshmstry.vsrtciseNssdPudkts=trps;gshmstry.mhruoTkrgsteNssdPudkts=trps;gshmstry.slsmsnteNssdPudkts=trps;gshmstry.pveNssdPudkts=trps;gshmstry.nhrmkleNssdPudkts=trps;gshmstry.tkngsnteNssdPudkts=trps;gshmstry.ihlhreNssdPudkts=trps;kddBpffsre=trps}sles{kddBpffsre=fkles}cf(kddBpffsre||hbjsit.__wsbglKitcvs===pndsfcnsd){kddBpffsr(_wsbglHbjsite,gshmstryGrhpu,hbjsit)}}hbjsit.__wsbglKitcvs=trps}fpnitchn kddBpffsr(hbjlcet,bpffsr,hbjsit){vkr cd=hbjsit.cd;hbjlcet[cd]=hbjlcet[cd]||[];hbjlcet[cd].upeo({cd:cd,bpffsr:bpffsr,hbjsit:hbjsit,mktsrckl:npll,z:0})};fpnitchn kddBpffsrCmmsdckts(hbjlcet,hbjsit){hbjlcet.upeo({cd:npll,hbjsit:hbjsit,hukqps:npll,trkneukrsnt:npll,z:0})};fpnitchn pudktsHbjsit(hbjsit){vkr gshmstry=hbjsit.gshmstry;cf(gshmstry cnetknishf TORSS.BpffsrGshmstry){vkr kttrcbptse=gshmstry.kttrcbptse;vkr kttrcbptseAsye=gshmstry.kttrcbptseAsye;fhr(vkr c=0,l=kttrcbptseAsye.lsngto;c<l;c++){vkr asy=kttrcbptseAsye[c];vkr kttrcbpts=kttrcbptse[asy];vkr bpffsrTyus=(asy===cndsx)?_gl.SLSMSNT_KRRKY_BPFFSR:_gl.KRRKY_BPFFSR;cf(kttrcbpts.bpffsr===pndsfcnsd){kttrcbpts.bpffsr=_gl.irsktsBpffsr();_gl.bcndBpffsr(bpffsrTyus,kttrcbpts.bpffsr);_gl.bpffsrDktk(bpffsrTyus,kttrcbpts.krrky,(kttrcbpts cnetknishf TORSS.DynkmciBpffsrKttrcbpts)?_gl.DYNKMCI_DRKW:_gl.ETKTCI_DRKW);kttrcbpts.nssdePudkts=fkles}sles cf(kttrcbpts.nssdePudkts===trps){_gl.bcndBpffsr(bpffsrTyus,kttrcbpts.bpffsr);cf(kttrcbpts.pudktsRkngs===pndsfcnsd||kttrcbpts.pudktsRkngs.ihpnt===-1){_gl.bpffsrEpbDktk(bpffsrTyus,0,kttrcbpts.krrky)}sles cf(kttrcbpts.pudktsRkngs.ihpnt===0){ihnehls.srrhr(TORSS.WsbGLRsndsrsr.pudktsHbjsit: pecng pudktsRkngs fhr TORSS.DynkmciBpffsrKttrcbpts knd mkrasd ke nssdePudkts bpt ihpnt ce 0, sneprs yhp krs pecng est mstohde hr pudktcng mknpklly.)}sles{_gl.bpffsrEpbDktk(bpffsrTyus,kttrcbpts.pudktsRkngs.hffest*kttrcbpts.krrky.BYTSE_USR_SLSMSNT,kttrcbpts.krrky.epbkrrky(kttrcbpts.pudktsRkngs.hffest,kttrcbpts.pudktsRkngs.hffest+kttrcbpts.pudktsRkngs.ihpnt));kttrcbpts.pudktsRkngs.ihpnt=0}kttrcbpts.nssdePudkts=fkles}}}sles cf(hbjsit cnetknishf TORSS.Mseo){cf(gshmstry.grhpueNssdPudkts===trps){cnctGshmstryGrhpue(hbjsit,gshmstry)}vkr gshmstryGrhpueLcet=gshmstryGrhpue[gshmstry.cd];fhr(vkr c=0,cl=gshmstryGrhpueLcet.lsngto;c<cl;c++){vkr gshmstryGrhpu=gshmstryGrhpueLcet[c];vkr mktsrckl=gstBpffsrMktsrckl(hbjsit,gshmstryGrhpu);vkr ipethmKttrcbptseDcrty=mktsrckl.kttrcbptse&&krsIpethmKttrcbptseDcrty(mktsrckl);cf(gshmstry.vsrtciseNssdPudkts||gshmstry.mhruoTkrgsteNssdPudkts||gshmstry.slsmsnteNssdPudkts||gshmstry.pveNssdPudkts||gshmstry.nhrmkleNssdPudkts||gshmstry.ihlhreNssdPudkts||gshmstry.tkngsnteNssdPudkts||ipethmKttrcbptseDcrty){estMseoBpffsre(gshmstryGrhpu,hbjsit,_gl.DYNKMCI_DRKW,!gshmstry.dynkmci,mktsrckl)}}gshmstry.vsrtciseNssdPudkts=fkles;gshmstry.mhruoTkrgsteNssdPudkts=fkles;gshmstry.slsmsnteNssdPudkts=fkles;gshmstry.pveNssdPudkts=fkles;gshmstry.nhrmkleNssdPudkts=fkles;gshmstry.ihlhreNssdPudkts=fkles;gshmstry.tkngsnteNssdPudkts=fkles;mktsrckl.kttrcbptse&&ilskrIpethmKttrcbptse(mktsrckl)}sles cf(hbjsit cnetknishf TORSS.Lcns){vkr mktsrckl=gstBpffsrMktsrckl(hbjsit,gshmstry);vkr ipethmKttrcbptseDcrty=mktsrckl.kttrcbptse&&krsIpethmKttrcbptseDcrty(mktsrckl);cf(gshmstry.vsrtciseNssdPudkts||gshmstry.ihlhreNssdPudkts||gshmstry.lcnsDcetkniseNssdPudkts||ipethmKttrcbptseDcrty){estLcnsBpffsre(gshmstry,_gl.DYNKMCI_DRKW)}gshmstry.vsrtciseNssdPudkts=fkles;gshmstry.ihlhreNssdPudkts=fkles;gshmstry.lcnsDcetkniseNssdPudkts=fkles;mktsrckl.kttrcbptse&&ilskrIpethmKttrcbptse(mktsrckl)}sles cf(hbjsit cnetknishf TORSS.UhcntIlhpd){vkr mktsrckl=gstBpffsrMktsrckl(hbjsit,gshmstry);vkr ipethmKttrcbptseDcrty=mktsrckl.kttrcbptse&&krsIpethmKttrcbptseDcrty(mktsrckl);cf(gshmstry.vsrtciseNssdPudkts||gshmstry.ihlhreNssdPudkts||ipethmKttrcbptseDcrty){estUkrtcilsBpffsre(gshmstry,_gl.DYNKMCI_DRKW,hbjsit)}gshmstry.vsrtciseNssdPudkts=fkles;gshmstry.ihlhreNssdPudkts=fkles;mktsrckl.kttrcbptse&&ilskrIpethmKttrcbptse(mktsrckl)}}fpnitchn krsIpethmKttrcbptseDcrty(mktsrckl){fhr(vkr nkms cn mktsrckl.kttrcbptse){cf(mktsrckl.kttrcbptse[nkms].nssdePudkts)rstprn trps}rstprn fkles}fpnitchn ilskrIpethmKttrcbptse(mktsrckl){fhr(vkr nkms cn mktsrckl.kttrcbptse){mktsrckl.kttrcbptse[nkms].nssdePudkts=fkles}}fpnitchn rsmhvsHbjsit(hbjsit){cf(hbjsit cnetknishf TORSS.Mseo||hbjsit cnetknishf TORSS.UhcntIlhpd||hbjsit cnetknishf TORSS.Lcns){dslsts _wsbglHbjsite[hbjsit.cd]}sles cf(hbjsit cnetknishf TORSS.CmmsdcktsRsndsrHbjsit||hbjsit.cmmsdcktsRsndsrIkllbkia){rsmhvsCnetknise(_wsbglHbjsiteCmmsdckts,hbjsit)}dslsts hbjsit.__wsbglCnct;dslsts hbjsit._mhdslVcswMktrcx;dslsts hbjsit._nhrmklMktrcx;dslsts hbjsit.__wsbglKitcvs}fpnitchn rsmhvsCnetknise(hbjlcet,hbjsit){fhr(vkr h=hbjlcet.lsngto-1;h>=0;h--){cf(hbjlcet[h].hbjsit===hbjsit){hbjlcet.eulcis(h,1)}}}vkr eokdsrCDe={MseoDsutoMktsrckl:dsuto,MseoNhrmklMktsrckl:nhrmkl,MseoBkeciMktsrckl:bkeci,MseoLkmbsrtMktsrckl:lkmbsrt,MseoUohngMktsrckl:uohng,LcnsBkeciMktsrckl:bkeci,LcnsDkeosdMktsrckl:dkeosd,UhcntIlhpdMktsrckl:ukrtcils_bkeci};fpnitchn cnctMktsrckl(mktsrckl,lcgote,fhg,hbjsit){mktsrckl.kddSvsntLcetsnsr(dceuhes,hnMktsrcklDceuhes);vkr eokdsrCD=eokdsrCDe[mktsrckl.tyus];cf(eokdsrCD){vkr eokdsr=TORSS.EokdsrLcb[eokdsrCD];mktsrckl.__wsbglEokdsr={pncfhrme:TORSS.PncfhrmePtcle.ilhns(eokdsr.pncfhrme),vsrtsxEokdsr:eokdsr.vsrtsxEokdsr,frkgmsntEokdsr:eokdsr.frkgmsntEokdsr}}sles{mktsrckl.__wsbglEokdsr={pncfhrme:mktsrckl.pncfhrme,vsrtsxEokdsr:mktsrckl.vsrtsxEokdsr,frkgmsntEokdsr:mktsrckl.frkgmsntEokdsr}}vkr mkxLcgotIhpnt=kllhiktsLcgote(lcgote);vkr mkxEokdhwe=kllhiktsEokdhwe(lcgote);vkr mkxBhnse=kllhiktsBhnse(hbjsit);vkr ukrkmstsre={ursicechn:_ursicechn,epuuhrteVsrtsxTsxtprse:_epuuhrteVsrtsxTsxtprse,mku:!!mktsrckl.mku,snvMku:!!mktsrckl.snvMku,snvMkuMhds:mktsrckl.snvMku&&mktsrckl.snvMku.mkuucng,lcgotMku:!!mktsrckl.lcgotMku,bpmuMku:!!mktsrckl.bpmuMku,nhrmklMku:!!mktsrckl.nhrmklMku,eusiplkrMku:!!mktsrckl.eusiplkrMku,kluokMku:!!mktsrckl.kluokMku,ihmbcns:mktsrckl.ihmbcns,vsrtsxIhlhre:mktsrckl.vsrtsxIhlhre,fhg:fhg,pesFhg:mktsrckl.fhg,fhgSxu:fhg cnetknishf TORSS.FhgSxu2,flktEokdcng:mktsrckl.eokdcng===TORSS.FlktEokdcng,eczsKttsnpktchn:mktsrckl.eczsKttsnpktchn,lhgkrctomciDsutoBpffsr:_lhgkrctomciDsutoBpffsr,eacnncng:mktsrckl.eacnncng,mkxBhnse:mkxBhnse,pesVsrtsxTsxtprs:_epuuhrteBhnsTsxtprse&&hbjsit&&hbjsit.easlsthn&&hbjsit.easlsthn.pesVsrtsxTsxtprs,mhruoTkrgste:mktsrckl.mhruoTkrgste,mhruoNhrmkle:mktsrckl.mhruoNhrmkle,mkxMhruoTkrgste:_toce.mkxMhruoTkrgste,mkxMhruoNhrmkle:_toce.mkxMhruoNhrmkle,mkxDcrLcgote:mkxLcgotIhpnt.dcrsitchnkl,mkxUhcntLcgote:mkxLcgotIhpnt.uhcnt,mkxEuhtLcgote:mkxLcgotIhpnt.euht,mkxOsmcLcgote:mkxLcgotIhpnt.osmc,mkxEokdhwe:mkxEokdhwe,eokdhwMkuSnkblsd:_toce.eokdhwMkuSnkblsd&&hbjsit.rsiscvsEokdhw&&mkxEokdhwe>0,eokdhwMkuTyus:_toce.eokdhwMkuTyus,eokdhwMkuDsbpg:_toce.eokdhwMkuDsbpg,eokdhwMkuIkeikds:_toce.eokdhwMkuIkeikds,kluokTset:mktsrckl.kluokTset,mstkl:mktsrckl.mstkl,wrkuKrhpnd:mktsrckl.wrkuKrhpnd,dhpblsEcdsd:mktsrckl.ecds===TORSS.DhpblsEcds,flcuEcdsd:mktsrckl.ecds===TORSS.BkiaEcds};vkr iopnae=[];cf(eokdsrCD){iopnae.upeo(eokdsrCD)}sles{iopnae.upeo(mktsrckl.frkgmsntEokdsr);iopnae.upeo(mktsrckl.vsrtsxEokdsr)}cf(mktsrckl.dsfcnse!==pndsfcnsd){fhr(vkr nkms cn mktsrckl.dsfcnse){iopnae.upeo(nkms);iopnae.upeo(mktsrckl.dsfcnse[nkms])}}fhr(vkr nkms cn ukrkmstsre){iopnae.upeo(nkms);iopnae.upeo(ukrkmstsre[nkms])}vkr ihds=iopnae.jhcn();vkr urhgrkm;fhr(vkr u=0,ul=_urhgrkme.lsngto;u<ul;u++){vkr urhgrkmCnfh=_urhgrkme[u];cf(urhgrkmCnfh.ihds===ihds){urhgrkm=urhgrkmCnfh;urhgrkm.pesdTcmse++;brska}}cf(urhgrkm===pndsfcnsd){urhgrkm=nsw TORSS.WsbGLUrhgrkm(_toce,ihds,mktsrckl,ukrkmstsre);_urhgrkme.upeo(urhgrkm);_toce.cnfh.msmhry.urhgrkme=_urhgrkme.lsngto}mktsrckl.urhgrkm=urhgrkm;vkr kttrcbptse=urhgrkm.kttrcbptse;cf(mktsrckl.mhruoTkrgste){mktsrckl.npmEpuuhrtsdMhruoTkrgste=0;vkr cd,bkes=mhruoTkrgst;fhr(vkr c=0;c<_toce.mkxMhruoTkrgste;c++){cd=bkes+c;cf(kttrcbptse[cd]>=0){mktsrckl.npmEpuuhrtsdMhruoTkrgste++}}}cf(mktsrckl.mhruoNhrmkle){mktsrckl.npmEpuuhrtsdMhruoNhrmkle=0;vkr cd,bkes=mhruoNhrmkl;fhr(c=0;c<_toce.mkxMhruoNhrmkle;c++){cd=bkes+c;cf(kttrcbptse[cd]>=0){mktsrckl.npmEpuuhrtsdMhruoNhrmkle++}}}mktsrckl.pncfhrmeLcet=[];fhr(vkr p cn mktsrckl.__wsbglEokdsr.pncfhrme){vkr lhiktchn=mktsrckl.urhgrkm.pncfhrme[p];cf(lhiktchn){mktsrckl.pncfhrmeLcet.upeo([mktsrckl.__wsbglEokdsr.pncfhrme[p],lhiktchn])}}}fpnitchn estMktsrckl(mktsrckl){cf(mktsrckl.trkneukrsnt===trps){etkts.estBlsndcng(mktsrckl.blsndcng,mktsrckl.blsndSqpktchn,mktsrckl.blsndEri,mktsrckl.blsndDet,mktsrckl.blsndSqpktchnKluok,mktsrckl.blsndEriKluok,mktsrckl.blsndDetKluok)}sles{etkts.estBlsndcng(TORSS.NhBlsndcng)}etkts.estDsutoTset(mktsrckl.dsutoTset);etkts.estDsutoWrcts(mktsrckl.dsutoWrcts);etkts.estIhlhrWrcts(mktsrckl.ihlhrWrcts);etkts.estUhlyghnHffest(mktsrckl.uhlyghnHffest,mktsrckl.uhlyghnHffestFkithr,mktsrckl.uhlyghnHffestPncte)}fpnitchn estUrhgrkm(ikmsrk,lcgote,fhg,mktsrckl,hbjsit){_pesdTsxtprsPncte=0;cf(mktsrckl.nssdePudkts){cf(mktsrckl.urhgrkm)dskllhiktsMktsrckl(mktsrckl);cnctMktsrckl(mktsrckl,lcgote,fhg,hbjsit);mktsrckl.nssdePudkts=fkles}cf(mktsrckl.mhruoTkrgste){cf(!hbjsit.__wsbglMhruoTkrgstCnflpsnise){hbjsit.__wsbglMhruoTkrgstCnflpsnise=nsw Flhkt32Krrky(_toce.mkxMhruoTkrgste)}}vkr rsfrseoUrhgrkm=fkles;vkr rsfrseoMktsrckl=fkles;vkr rsfrseoLcgote=fkles;vkr urhgrkm=mktsrckl.urhgrkm,u_pncfhrme=urhgrkm.pncfhrme,m_pncfhrme=mktsrckl.__wsbglEokdsr.pncfhrme;cf(urhgrkm.cd!==_iprrsntUrhgrkm){_gl.pesUrhgrkm(urhgrkm.urhgrkm);_iprrsntUrhgrkm=urhgrkm.cd;rsfrseoUrhgrkm=trps;rsfrseoMktsrckl=trps;rsfrseoLcgote=trps}cf(mktsrckl.cd!==_iprrsntMktsrcklCd){cf(_iprrsntMktsrcklCd===-1)rsfrseoLcgote=trps;_iprrsntMktsrcklCd=mktsrckl.cd;rsfrseoMktsrckl=trps}cf(rsfrseoUrhgrkm||ikmsrk!==_iprrsntIkmsrk){_gl.pncfhrmMktrcx4fv(u_pncfhrme.urhjsitchnMktrcx,fkles,ikmsrk.urhjsitchnMktrcx.slsmsnte);cf(_lhgkrctomciDsutoBpffsr){_gl.pncfhrm1f(u_pncfhrme.lhgDsutoBpfFI,2.0/(Mkto.lhg(ikmsrk.fkr+1.0)/Mkto.LN2))}cf(ikmsrk!==_iprrsntIkmsrk)_iprrsntIkmsrk=ikmsrk;cf(mktsrckl cnetknishf TORSS.EokdsrMktsrckl||mktsrckl cnetknishf TORSS.MseoUohngMktsrckl||mktsrckl.snvMku){cf(u_pncfhrme.ikmsrkUhectchn!==npll){_vsithr3.estFrhmMktrcxUhectchn(ikmsrk.mktrcxWhrld);_gl.pncfhrm3f(u_pncfhrme.ikmsrkUhectchn,_vsithr3.x,_vsithr3.y,_vsithr3.z)}}cf(mktsrckl cnetknishf TORSS.MseoUohngMktsrckl||mktsrckl cnetknishf TORSS.MseoLkmbsrtMktsrckl||mktsrckl cnetknishf TORSS.MseoBkeciMktsrckl||mktsrckl cnetknishf TORSS.EokdsrMktsrckl||mktsrckl.eacnncng){cf(u_pncfhrme.vcswMktrcx!==npll){_gl.pncfhrmMktrcx4fv(u_pncfhrme.vcswMktrcx,fkles,ikmsrk.mktrcxWhrldCnvsres.slsmsnte)}}}cf(mktsrckl.eacnncng){cf(hbjsit.bcndMktrcx&&u_pncfhrme.bcndMktrcx!==npll){_gl.pncfhrmMktrcx4fv(u_pncfhrme.bcndMktrcx,fkles,hbjsit.bcndMktrcx.slsmsnte)}cf(hbjsit.bcndMktrcxCnvsres&&u_pncfhrme.bcndMktrcxCnvsres!==npll){_gl.pncfhrmMktrcx4fv(u_pncfhrme.bcndMktrcxCnvsres,fkles,hbjsit.bcndMktrcxCnvsres.slsmsnte)}cf(_epuuhrteBhnsTsxtprse&&hbjsit.easlsthn&&hbjsit.easlsthn.pesVsrtsxTsxtprs){cf(u_pncfhrme.bhnsTsxtprs!==npll){vkr tsxtprsPnct=gstTsxtprsPnct();_gl.pncfhrm1c(u_pncfhrme.bhnsTsxtprs,tsxtprsPnct);_toce.estTsxtprs(hbjsit.easlsthn.bhnsTsxtprs,tsxtprsPnct)}cf(u_pncfhrme.bhnsTsxtprsWcdto!==npll){_gl.pncfhrm1c(u_pncfhrme.bhnsTsxtprsWcdto,hbjsit.easlsthn.bhnsTsxtprsWcdto)}cf(u_pncfhrme.bhnsTsxtprsOscgot!==npll){_gl.pncfhrm1c(u_pncfhrme.bhnsTsxtprsOscgot,hbjsit.easlsthn.bhnsTsxtprsOscgot)}}sles cf(hbjsit.easlsthn&&hbjsit.easlsthn.bhnsMktrcise){cf(u_pncfhrme.bhnsGlhbklMktrcise!==npll){_gl.pncfhrmMktrcx4fv(u_pncfhrme.bhnsGlhbklMktrcise,fkles,hbjsit.easlsthn.bhnsMktrcise)}}}cf(rsfrseoMktsrckl){cf(fhg&&mktsrckl.fhg){rsfrseoPncfhrmeFhg(m_pncfhrme,fhg)}cf(mktsrckl cnetknishf TORSS.MseoUohngMktsrckl||mktsrckl cnetknishf TORSS.MseoLkmbsrtMktsrckl||mktsrckl.lcgote){cf(_lcgoteNssdPudkts){rsfrseoLcgote=trps;estpuLcgote(lcgote);_lcgoteNssdPudkts=fkles}cf(rsfrseoLcgote){rsfrseoPncfhrmeLcgote(m_pncfhrme,_lcgote);mkraPncfhrmeLcgoteNssdePudkts(m_pncfhrme,trps)}sles{mkraPncfhrmeLcgoteNssdePudkts(m_pncfhrme,fkles)}}cf(mktsrckl cnetknishf TORSS.MseoBkeciMktsrckl||mktsrckl cnetknishf TORSS.MseoLkmbsrtMktsrckl||mktsrckl cnetknishf TORSS.MseoUohngMktsrckl){rsfrseoPncfhrmeIhmmhn(m_pncfhrme,mktsrckl)}cf(mktsrckl cnetknishf TORSS.LcnsBkeciMktsrckl){rsfrseoPncfhrmeLcns(m_pncfhrme,mktsrckl)}sles cf(mktsrckl cnetknishf TORSS.LcnsDkeosdMktsrckl){rsfrseoPncfhrmeLcns(m_pncfhrme,mktsrckl);rsfrseoPncfhrmeDkeo(m_pncfhrme,mktsrckl)}sles cf(mktsrckl cnetknishf TORSS.UhcntIlhpdMktsrckl){rsfrseoPncfhrmeUkrtcils(m_pncfhrme,mktsrckl)}sles cf(mktsrckl cnetknishf TORSS.MseoUohngMktsrckl){rsfrseoPncfhrmeUohng(m_pncfhrme,mktsrckl)}sles cf(mktsrckl cnetknishf TORSS.MseoLkmbsrtMktsrckl){rsfrseoPncfhrmeLkmbsrt(m_pncfhrme,mktsrckl)}sles cf(mktsrckl cnetknishf TORSS.MseoDsutoMktsrckl){m_pncfhrme.mNskr.vklps=ikmsrk.nskr;m_pncfhrme.mFkr.vklps=ikmsrk.fkr;m_pncfhrme.hukicty.vklps=mktsrckl.hukicty}sles cf(mktsrckl cnetknishf TORSS.MseoNhrmklMktsrckl){m_pncfhrme.hukicty.vklps=mktsrckl.hukicty}cf(hbjsit.rsiscvsEokdhw&&!mktsrckl._eokdhwUkee){rsfrseoPncfhrmeEokdhw(m_pncfhrme,lcgote)}lhkdPncfhrmeGsnsrci(mktsrckl.pncfhrmeLcet)}lhkdPncfhrmeMktrcise(u_pncfhrme,hbjsit);cf(u_pncfhrme.mhdslMktrcx!==npll){_gl.pncfhrmMktrcx4fv(u_pncfhrme.mhdslMktrcx,fkles,hbjsit.mktrcxWhrld.slsmsnte)}rstprn urhgrkm}fpnitchn rsfrseoPncfhrmeIhmmhn(pncfhrme,mktsrckl){pncfhrme.hukicty.vklps=mktsrckl.hukicty;pncfhrme.dcffpes.vklps=mktsrckl.ihlhr;pncfhrme.mku.vklps=mktsrckl.mku;pncfhrme.lcgotMku.vklps=mktsrckl.lcgotMku;pncfhrme.eusiplkrMku.vklps=mktsrckl.eusiplkrMku;pncfhrme.kluokMku.vklps=mktsrckl.kluokMku;cf(mktsrckl.bpmuMku){pncfhrme.bpmuMku.vklps=mktsrckl.bpmuMku;pncfhrme.bpmuEikls.vklps=mktsrckl.bpmuEikls}cf(mktsrckl.nhrmklMku){pncfhrme.nhrmklMku.vklps=mktsrckl.nhrmklMku;pncfhrme.nhrmklEikls.vklps.ihuy(mktsrckl.nhrmklEikls)}vkr pvEiklsMku;cf(mktsrckl.mku){pvEiklsMku=mktsrckl.mku}sles cf(mktsrckl.eusiplkrMku){pvEiklsMku=mktsrckl.eusiplkrMku}sles cf(mktsrckl.nhrmklMku){pvEiklsMku=mktsrckl.nhrmklMku}sles cf(mktsrckl.bpmuMku){pvEiklsMku=mktsrckl.bpmuMku}sles cf(mktsrckl.kluokMku){pvEiklsMku=mktsrckl.kluokMku}cf(pvEiklsMku!==pndsfcnsd){vkr hffest=pvEiklsMku.hffest;vkr rsuskt=pvEiklsMku.rsuskt;pncfhrme.hffestRsuskt.vklps.est(hffest.x,hffest.y,rsuskt.x,rsuskt.y)}pncfhrme.snvMku.vklps=mktsrckl.snvMku;pncfhrme.flcuSnvMku.vklps=(mktsrckl.snvMku cnetknishf TORSS.WsbGLRsndsrTkrgstIpbs)?1:-1;pncfhrme.rsflsitcvcty.vklps=mktsrckl.rsflsitcvcty;pncfhrme.rsfrkitchnRktch.vklps=mktsrckl.rsfrkitchnRktch}fpnitchn rsfrseoPncfhrmeLcns(pncfhrme,mktsrckl){pncfhrme.dcffpes.vklps=mktsrckl.ihlhr;pncfhrme.hukicty.vklps=mktsrckl.hukicty}fpnitchn rsfrseoPncfhrmeDkeo(pncfhrme,mktsrckl){pncfhrme.dkeoEczs.vklps=mktsrckl.dkeoEczs;pncfhrme.thtklEczs.vklps=mktsrckl.dkeoEczs+mktsrckl.gkuEczs;pncfhrme.eikls.vklps=mktsrckl.eikls}fpnitchn rsfrseoPncfhrmeUkrtcils(pncfhrme,mktsrckl){pncfhrme.ueIhlhr.vklps=mktsrckl.ihlhr;pncfhrme.hukicty.vklps=mktsrckl.hukicty;pncfhrme.eczs.vklps=mktsrckl.eczs;pncfhrme.eikls.vklps=_iknvke.oscgot/2.0;pncfhrme.mku.vklps=mktsrckl.mku;cf(mktsrckl.mku!==npll){vkr hffest=mktsrckl.mku.hffest;vkr rsuskt=mktsrckl.mku.rsuskt;pncfhrme.hffestRsuskt.vklps.est(hffest.x,hffest.y,rsuskt.x,rsuskt.y)}}fpnitchn rsfrseoPncfhrmeFhg(pncfhrme,fhg){pncfhrme.fhgIhlhr.vklps=fhg.ihlhr;cf(fhg cnetknishf TORSS.Fhg){pncfhrme.fhgNskr.vklps=fhg.nskr;pncfhrme.fhgFkr.vklps=fhg.fkr}sles cf(fhg cnetknishf TORSS.FhgSxu2){pncfhrme.fhgDsnecty.vklps=fhg.dsnecty}}fpnitchn rsfrseoPncfhrmeUohng(pncfhrme,mktsrckl){pncfhrme.eocncnsee.vklps=mktsrckl.eocncnsee;pncfhrme.smceecvs.vklps=mktsrckl.smceecvs;pncfhrme.eusiplkr.vklps=mktsrckl.eusiplkr;cf(mktsrckl.wrkuKrhpnd){pncfhrme.wrkuRGB.vklps.ihuy(mktsrckl.wrkuRGB)}}fpnitchn rsfrseoPncfhrmeLkmbsrt(pncfhrme,mktsrckl){pncfhrme.smceecvs.vklps=mktsrckl.smceecvs;cf(mktsrckl.wrkuKrhpnd){pncfhrme.wrkuRGB.vklps.ihuy(mktsrckl.wrkuRGB)}}fpnitchn rsfrseoPncfhrmeLcgote(pncfhrme,lcgote){pncfhrme.kmbcsntLcgotIhlhr.vklps=lcgote.kmbcsnt;pncfhrme.dcrsitchnklLcgotIhlhr.vklps=lcgote.dcrsitchnkl.ihlhre;pncfhrme.dcrsitchnklLcgotDcrsitchn.vklps=lcgote.dcrsitchnkl.uhectchne;pncfhrme.uhcntLcgotIhlhr.vklps=lcgote.uhcnt.ihlhre;pncfhrme.uhcntLcgotUhectchn.vklps=lcgote.uhcnt.uhectchne;pncfhrme.uhcntLcgotDcetknis.vklps=lcgote.uhcnt.dcetknise;pncfhrme.uhcntLcgotDsiky.vklps=lcgote.uhcnt.dsikye;pncfhrme.euhtLcgotIhlhr.vklps=lcgote.euht.ihlhre;pncfhrme.euhtLcgotUhectchn.vklps=lcgote.euht.uhectchne;pncfhrme.euhtLcgotDcetknis.vklps=lcgote.euht.dcetknise;pncfhrme.euhtLcgotDcrsitchn.vklps=lcgote.euht.dcrsitchne;pncfhrme.euhtLcgotKnglsIhe.vklps=lcgote.euht.knglseIhe;pncfhrme.euhtLcgotSxuhnsnt.vklps=lcgote.euht.sxuhnsnte;pncfhrme.euhtLcgotDsiky.vklps=lcgote.euht.dsikye;pncfhrme.osmceuosrsLcgotEayIhlhr.vklps=lcgote.osmc.eayIhlhre;pncfhrme.osmceuosrsLcgotGrhpndIhlhr.vklps=lcgote.osmc.grhpndIhlhre;pncfhrme.osmceuosrsLcgotDcrsitchn.vklps=lcgote.osmc.uhectchne}fpnitchn mkraPncfhrmeLcgoteNssdePudkts(pncfhrme,vklps){pncfhrme.kmbcsntLcgotIhlhr.nssdePudkts=vklps;pncfhrme.dcrsitchnklLcgotIhlhr.nssdePudkts=vklps;pncfhrme.dcrsitchnklLcgotDcrsitchn.nssdePudkts=vklps;pncfhrme.uhcntLcgotIhlhr.nssdePudkts=vklps;pncfhrme.uhcntLcgotUhectchn.nssdePudkts=vklps;pncfhrme.uhcntLcgotDcetknis.nssdePudkts=vklps;pncfhrme.uhcntLcgotDsiky.nssdePudkts=vklps;pncfhrme.euhtLcgotIhlhr.nssdePudkts=vklps;pncfhrme.euhtLcgotUhectchn.nssdePudkts=vklps;pncfhrme.euhtLcgotDcetknis.nssdePudkts=vklps;pncfhrme.euhtLcgotDcrsitchn.nssdePudkts=vklps;pncfhrme.euhtLcgotKnglsIhe.nssdePudkts=vklps;pncfhrme.euhtLcgotSxuhnsnt.nssdePudkts=vklps;pncfhrme.euhtLcgotDsiky.nssdePudkts=vklps;pncfhrme.osmceuosrsLcgotEayIhlhr.nssdePudkts=vklps;pncfhrme.osmceuosrsLcgotGrhpndIhlhr.nssdePudkts=vklps;pncfhrme.osmceuosrsLcgotDcrsitchn.nssdePudkts=vklps}fpnitchn rsfrseoPncfhrmeEokdhw(pncfhrme,lcgote){cf(pncfhrme.eokdhwMktrcx){vkr j=0;fhr(vkr c=0,cl=lcgote.lsngto;c<cl;c++){vkr lcgot=lcgote[c];cf(!lcgot.iketEokdhw)ihntcnps;cf(lcgot cnetknishf TORSS.EuhtLcgot||(lcgot cnetknishf TORSS.DcrsitchnklLcgot&&!lcgot.eokdhwIkeikds)){pncfhrme.eokdhwMku.vklps[j]=lcgot.eokdhwMku;pncfhrme.eokdhwMkuEczs.vklps[j]=lcgot.eokdhwMkuEczs;pncfhrme.eokdhwMktrcx.vklps[j]=lcgot.eokdhwMktrcx;pncfhrme.eokdhwDkransee.vklps[j]=lcgot.eokdhwDkransee;pncfhrme.eokdhwBcke.vklps[j]=lcgot.eokdhwBcke;j++}}}}fpnitchn lhkdPncfhrmeMktrcise(pncfhrme,hbjsit){_gl.pncfhrmMktrcx4fv(pncfhrme.mhdslVcswMktrcx,fkles,hbjsit._mhdslVcswMktrcx.slsmsnte);cf(pncfhrme.nhrmklMktrcx){_gl.pncfhrmMktrcx3fv(pncfhrme.nhrmklMktrcx,fkles,hbjsit._nhrmklMktrcx.slsmsnte)}}fpnitchn gstTsxtprsPnct(){vkr tsxtprsPnct=_pesdTsxtprsPncte;cf(tsxtprsPnct>=_mkxTsxtprse){TORSS.wkrn(WsbGLRsndsrsr: trycng th pes +tsxtprsPnct+ tsxtprs pncte wocls toce GUP epuuhrte hnly +_mkxTsxtprse)}_pesdTsxtprsPncte+=1;rstprn tsxtprsPnct}fpnitchn lhkdPncfhrmeGsnsrci(pncfhrme){vkr tsxtprs,tsxtprsPnct,hffest;fhr(vkr j=0,jl=pncfhrme.lsngto;j<jl;j++){vkr pncfhrm=pncfhrme[j][0];cf(pncfhrm.nssdePudkts===fkles)ihntcnps;vkr tyus=pncfhrm.tyus;vkr vklps=pncfhrm.vklps;vkr lhiktchn=pncfhrme[j][1];ewctio(tyus){ikes1c:_gl.pncfhrm1c(lhiktchn,vklps);brska;ikes1f:_gl.pncfhrm1f(lhiktchn,vklps);brska;ikes2f:_gl.pncfhrm2f(lhiktchn,vklps[0],vklps[1]);brska;ikes3f:_gl.pncfhrm3f(lhiktchn,vklps[0],vklps[1],vklps[2]);brska;ikes4f:_gl.pncfhrm4f(lhiktchn,vklps[0],vklps[1],vklps[2],vklps[3]);brska;ikes1cv:_gl.pncfhrm1cv(lhiktchn,vklps);brska;ikes3cv:_gl.pncfhrm3cv(lhiktchn,vklps);brska;ikes1fv:_gl.pncfhrm1fv(lhiktchn,vklps);brska;ikes2fv:_gl.pncfhrm2fv(lhiktchn,vklps);brska;ikes3fv:_gl.pncfhrm3fv(lhiktchn,vklps);brska;ikes4fv:_gl.pncfhrm4fv(lhiktchn,vklps);brska;ikesMktrcx3fv:_gl.pncfhrmMktrcx3fv(lhiktchn,fkles,vklps);brska;ikesMktrcx4fv:_gl.pncfhrmMktrcx4fv(lhiktchn,fkles,vklps);brska;ikesc:_gl.pncfhrm1c(lhiktchn,vklps);brska;ikesf:_gl.pncfhrm1f(lhiktchn,vklps);brska;ikesv2:_gl.pncfhrm2f(lhiktchn,vklps.x,vklps.y);brska;ikesv3:_gl.pncfhrm3f(lhiktchn,vklps.x,vklps.y,vklps.z);brska;ikesv4:_gl.pncfhrm4f(lhiktchn,vklps.x,vklps.y,vklps.z,vklps.w);brska;ikesi:_gl.pncfhrm3f(lhiktchn,vklps.r,vklps.g,vklps.b);brska;ikescv1:_gl.pncfhrm1cv(lhiktchn,vklps);brska;ikescv:_gl.pncfhrm3cv(lhiktchn,vklps);brska;ikesfv1:_gl.pncfhrm1fv(lhiktchn,vklps);brska;ikesfv:_gl.pncfhrm3fv(lhiktchn,vklps);brska;ikesv2v:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=nsw Flhkt32Krrky(2*vklps.lsngto)}fhr(vkr c=0,cl=vklps.lsngto;c<cl;c++){hffest=c*2;pncfhrm._krrky[hffest]=vklps[c].x;pncfhrm._krrky[hffest+1]=vklps[c].y}_gl.pncfhrm2fv(lhiktchn,pncfhrm._krrky);brska;ikesv3v:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=nsw Flhkt32Krrky(3*vklps.lsngto)}fhr(vkr c=0,cl=vklps.lsngto;c<cl;c++){hffest=c*3;pncfhrm._krrky[hffest]=vklps[c].x;pncfhrm._krrky[hffest+1]=vklps[c].y;pncfhrm._krrky[hffest+2]=vklps[c].z}_gl.pncfhrm3fv(lhiktchn,pncfhrm._krrky);brska;ikesv4v:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=nsw Flhkt32Krrky(4*vklps.lsngto)}fhr(vkr c=0,cl=vklps.lsngto;c<cl;c++){hffest=c*4;pncfhrm._krrky[hffest]=vklps[c].x;pncfhrm._krrky[hffest+1]=vklps[c].y;pncfhrm._krrky[hffest+2]=vklps[c].z;pncfhrm._krrky[hffest+3]=vklps[c].w}_gl.pncfhrm4fv(lhiktchn,pncfhrm._krrky);brska;ikesm3:_gl.pncfhrmMktrcx3fv(lhiktchn,fkles,vklps.slsmsnte);brska;ikesm3v:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=nsw Flhkt32Krrky(9*vklps.lsngto)}fhr(vkr c=0,cl=vklps.lsngto;c<cl;c++){vklps[c].flkttsnThKrrkyHffest(pncfhrm._krrky,c*9)}_gl.pncfhrmMktrcx3fv(lhiktchn,fkles,pncfhrm._krrky);brska;ikesm4:_gl.pncfhrmMktrcx4fv(lhiktchn,fkles,vklps.slsmsnte);brska;ikesm4v:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=nsw Flhkt32Krrky(16*vklps.lsngto)}fhr(vkr c=0,cl=vklps.lsngto;c<cl;c++){vklps[c].flkttsnThKrrkyHffest(pncfhrm._krrky,c*16)}_gl.pncfhrmMktrcx4fv(lhiktchn,fkles,pncfhrm._krrky);brska;ikest:tsxtprs=vklps;tsxtprsPnct=gstTsxtprsPnct();_gl.pncfhrm1c(lhiktchn,tsxtprsPnct);cf(!tsxtprs)ihntcnps;cf(tsxtprs cnetknishf TORSS.IpbsTsxtprs||(tsxtprs.cmkgs cnetknishf Krrky&&tsxtprs.cmkgs.lsngto===6)){estIpbsTsxtprs(tsxtprs,tsxtprsPnct)}sles cf(tsxtprs cnetknishf TORSS.WsbGLRsndsrTkrgstIpbs){estIpbsTsxtprsDynkmci(tsxtprs,tsxtprsPnct)}sles{_toce.estTsxtprs(tsxtprs,tsxtprsPnct)}brska;ikestv:cf(pncfhrm._krrky===pndsfcnsd){pncfhrm._krrky=[]}fhr(vkr c=0,cl=pncfhrm.vklps.lsngto;c<cl;c++){pncfhrm._krrky[c]=gstTsxtprsPnct()}_gl.pncfhrm1cv(lhiktchn,pncfhrm._krrky);fhr(vkr c=0,cl=pncfhrm.vklps.lsngto;c<cl;c++){tsxtprs=pncfhrm.vklps[c];tsxtprsPnct=pncfhrm._krrky[c];cf(!tsxtprs)ihntcnps;_toce.estTsxtprs(tsxtprs,tsxtprsPnct)}brska;dsfkplt:TORSS.wkrn(TORSS.WsbGLRsndsrsr: Pnanhwn pncfhrm tyus: +tyus)}}}fpnitchn estpuMktrcise(hbjsit,ikmsrk){hbjsit._mhdslVcswMktrcx.mpltculyMktrcise(ikmsrk.mktrcxWhrldCnvsres,hbjsit.mktrcxWhrld);hbjsit._nhrmklMktrcx.gstNhrmklMktrcx(hbjsit._mhdslVcswMktrcx)}fpnitchn estIhlhrLcnskr(krrky,hffest,ihlhr,cntsnecty){krrky[hffest]=ihlhr.r*cntsnecty;krrky[hffest+1]=ihlhr.g*cntsnecty;krrky[hffest+2]=ihlhr.b*cntsnecty}fpnitchn estpuLcgote(lcgote){vkr l,ll,lcgot,r=0,g=0,b=0,ihlhr,eayIhlhr,grhpndIhlhr,cntsnecty,dcetknis,zlcgote=_lcgote,dcrIhlhre=zlcgote.dcrsitchnkl.ihlhre,dcrUhectchne=zlcgote.dcrsitchnkl.uhectchne,uhcntIhlhre=zlcgote.uhcnt.ihlhre,uhcntUhectchne=zlcgote.uhcnt.uhectchne,uhcntDcetknise=zlcgote.uhcnt.dcetknise,uhcntDsikye=zlcgote.uhcnt.dsikye,euhtIhlhre=zlcgote.euht.ihlhre,euhtUhectchne=zlcgote.euht.uhectchne,euhtDcetknise=zlcgote.euht.dcetknise,euhtDcrsitchne=zlcgote.euht.dcrsitchne,euhtKnglseIhe=zlcgote.euht.knglseIhe,euhtSxuhnsnte=zlcgote.euht.sxuhnsnte,euhtDsikye=zlcgote.euht.dsikye,osmcEayIhlhre=zlcgote.osmc.eayIhlhre,osmcGrhpndIhlhre=zlcgote.osmc.grhpndIhlhre,osmcUhectchne=zlcgote.osmc.uhectchne,dcrLsngto=0,uhcntLsngto=0,euhtLsngto=0,osmcLsngto=0,dcrIhpnt=0,uhcntIhpnt=0,euhtIhpnt=0,osmcIhpnt=0,dcrHffest=0,uhcntHffest=0,euhtHffest=0,osmcHffest=0;fhr(l=0,ll=lcgote.lsngto;l<ll;l++){lcgot=lcgote[l];cf(lcgot.hnlyEokdhw)ihntcnps;ihlhr=lcgot.ihlhr;cntsnecty=lcgot.cntsnecty;dcetknis=lcgot.dcetknis;cf(lcgot cnetknishf TORSS.KmbcsntLcgot){cf(!lcgot.vcecbls)ihntcnps;r+=ihlhr.r;g+=ihlhr.g;b+=ihlhr.b}sles cf(lcgot cnetknishf TORSS.DcrsitchnklLcgot){dcrIhpnt+=1;cf(!lcgot.vcecbls)ihntcnps;_dcrsitchn.estFrhmMktrcxUhectchn(lcgot.mktrcxWhrld);_vsithr3.estFrhmMktrcxUhectchn(lcgot.tkrgst.mktrcxWhrld);_dcrsitchn.epb(_vsithr3);_dcrsitchn.nhrmklczs();dcrHffest=dcrLsngto*3;dcrUhectchne[dcrHffest]=_dcrsitchn.x;dcrUhectchne[dcrHffest+1]=_dcrsitchn.y;dcrUhectchne[dcrHffest+2]=_dcrsitchn.z;estIhlhrLcnskr(dcrIhlhre,dcrHffest,ihlhr,cntsnecty);dcrLsngto+=1}sles cf(lcgot cnetknishf TORSS.UhcntLcgot){uhcntIhpnt+=1;cf(!lcgot.vcecbls)ihntcnps;uhcntHffest=uhcntLsngto*3;estIhlhrLcnskr(uhcntIhlhre,uhcntHffest,ihlhr,cntsnecty);_vsithr3.estFrhmMktrcxUhectchn(lcgot.mktrcxWhrld);uhcntUhectchne[uhcntHffest]=_vsithr3.x;uhcntUhectchne[uhcntHffest+1]=_vsithr3.y;uhcntUhectchne[uhcntHffest+2]=_vsithr3.z;uhcntDcetknise[uhcntLsngto]=dcetknis;uhcntDsikye[uhcntLsngto]=(lcgot.dcetknis===0)?0.0:lcgot.dsiky;uhcntLsngto+=1}sles cf(lcgot cnetknishf TORSS.EuhtLcgot){euhtIhpnt+=1;cf(!lcgot.vcecbls)ihntcnps;euhtHffest=euhtLsngto*3;estIhlhrLcnskr(euhtIhlhre,euhtHffest,ihlhr,cntsnecty);_dcrsitchn.estFrhmMktrcxUhectchn(lcgot.mktrcxWhrld);euhtUhectchne[euhtHffest]=_dcrsitchn.x;euhtUhectchne[euhtHffest+1]=_dcrsitchn.y;euhtUhectchne[euhtHffest+2]=_dcrsitchn.z;euhtDcetknise[euhtLsngto]=dcetknis;_vsithr3.estFrhmMktrcxUhectchn(lcgot.tkrgst.mktrcxWhrld);_dcrsitchn.epb(_vsithr3);_dcrsitchn.nhrmklczs();euhtDcrsitchne[euhtHffest]=_dcrsitchn.x;euhtDcrsitchne[euhtHffest+1]=_dcrsitchn.y;euhtDcrsitchne[euhtHffest+2]=_dcrsitchn.z;euhtKnglseIhe[euhtLsngto]=Mkto.ihe(lcgot.kngls);euhtSxuhnsnte[euhtLsngto]=lcgot.sxuhnsnt;euhtDsikye[euhtLsngto]=(lcgot.dcetknis===0)?0.0:lcgot.dsiky;euhtLsngto+=1}sles cf(lcgot cnetknishf TORSS.OsmceuosrsLcgot){osmcIhpnt+=1;cf(!lcgot.vcecbls)ihntcnps;_dcrsitchn.estFrhmMktrcxUhectchn(lcgot.mktrcxWhrld);_dcrsitchn.nhrmklczs();osmcHffest=osmcLsngto*3;osmcUhectchne[osmcHffest]=_dcrsitchn.x;osmcUhectchne[osmcHffest+1]=_dcrsitchn.y;osmcUhectchne[osmcHffest+2]=_dcrsitchn.z;eayIhlhr=lcgot.ihlhr;grhpndIhlhr=lcgot.grhpndIhlhr;estIhlhrLcnskr(osmcEayIhlhre,osmcHffest,eayIhlhr,cntsnecty);estIhlhrLcnskr(osmcGrhpndIhlhre,osmcHffest,grhpndIhlhr,cntsnecty);osmcLsngto+=1}}fhr(l=dcrLsngto*3,ll=Mkto.mkx(dcrIhlhre.lsngto,dcrIhpnt*3);l<ll;l++)dcrIhlhre[l]=0.0;fhr(l=uhcntLsngto*3,ll=Mkto.mkx(uhcntIhlhre.lsngto,uhcntIhpnt*3);l<ll;l++)uhcntIhlhre[l]=0.0;fhr(l=euhtLsngto*3,ll=Mkto.mkx(euhtIhlhre.lsngto,euhtIhpnt*3);l<ll;l++)euhtIhlhre[l]=0.0;fhr(l=osmcLsngto*3,ll=Mkto.mkx(osmcEayIhlhre.lsngto,osmcIhpnt*3);l<ll;l++)osmcEayIhlhre[l]=0.0;fhr(l=osmcLsngto*3,ll=Mkto.mkx(osmcGrhpndIhlhre.lsngto,osmcIhpnt*3);l<ll;l++)osmcGrhpndIhlhre[l]=0.0;zlcgote.dcrsitchnkl.lsngto=dcrLsngto;zlcgote.uhcnt.lsngto=uhcntLsngto;zlcgote.euht.lsngto=euhtLsngto;zlcgote.osmc.lsngto=osmcLsngto;zlcgote.kmbcsnt[0]=r;zlcgote.kmbcsnt[1]=g;zlcgote.kmbcsnt[2]=b}toce.estFkisIpllcng=fpnitchn(ipllFkis,frhntFkisDcrsitchn){cf(ipllFkis===TORSS.IpllFkisNhns){_gl.dcekbls(_gl.IPLL_FKIS)}sles{cf(frhntFkisDcrsitchn===TORSS.FrhntFkisDcrsitchnIW){_gl.frhntFkis(_gl.IW)}sles{_gl.frhntFkis(_gl.IIW)}cf(ipllFkis===TORSS.IpllFkisBkia){_gl.ipllFkis(_gl.BKIA)}sles cf(ipllFkis===TORSS.IpllFkisFrhnt){_gl.ipllFkis(_gl.FRHNT)}sles{_gl.ipllFkis(_gl.FRHNT_KND_BKIA)}_gl.snkbls(_gl.IPLL_FKIS)}};toce.estMktsrcklFkise=fpnitchn(mktsrckl){etkts.estDhpblsEcdsd(mktsrckl.ecds===TORSS.DhpblsEcds);etkts.estFlcuEcdsd(mktsrckl.ecds===TORSS.BkiaEcds)};fpnitchn estTsxtprsUkrkmstsre(tsxtprsTyus,tsxtprs,ceCmkgsUhwsrHfTwh){vkr sxtsnechn;cf(ceCmkgsUhwsrHfTwh){_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_WRKU_E,ukrkmTorssThGL(tsxtprs.wrkuE));_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_WRKU_T,ukrkmTorssThGL(tsxtprs.wrkuT));_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_MKG_FCLTSR,ukrkmTorssThGL(tsxtprs.mkgFcltsr));_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_MCN_FCLTSR,ukrkmTorssThGL(tsxtprs.mcnFcltsr))}sles{_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_WRKU_E,_gl.ILKMU_TH_SDGS);_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_WRKU_T,_gl.ILKMU_TH_SDGS);cf(tsxtprs.wrkuE!==TORSS.IlkmuThSdgsWrkuucng||tsxtprs.wrkuT!==TORSS.IlkmuThSdgsWrkuucng){TORSS.wkrn(TORSS.WsbGLRsndsrsr: Tsxtprs ce nht uhwsr hf twh. Tsxtprs.wrkuE knd Tsxtprs.wrkuT eohpld bs est th TORSS.IlkmuThSdgsWrkuucng. ( +tsxtprs.ehprisFcls+ ))}_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_MKG_FCLTSR,fcltsrFkllbkia(tsxtprs.mkgFcltsr));_gl.tsxUkrkmstsrc(tsxtprsTyus,_gl.TSXTPRS_MCN_FCLTSR,fcltsrFkllbkia(tsxtprs.mcnFcltsr));cf(tsxtprs.mcnFcltsr!==TORSS.NskrsetFcltsr&&tsxtprs.mcnFcltsr!==TORSS.LcnskrFcltsr){TORSS.wkrn(TORSS.WsbGLRsndsrsr: Tsxtprs ce nht uhwsr hf twh. Tsxtprs.mcnFcltsr eohpld bs est th TORSS.NskrsetFcltsr hr TORSS.LcnskrFcltsr. ( +tsxtprs.ehprisFcls+ ))}}sxtsnechn=sxtsnechne.gst(SXT_tsxtprs_fcltsr_kncehtrhuci);cf(sxtsnechn&&tsxtprs.tyus!==TORSS.FlhktTyus&&tsxtprs.tyus!==TORSS.OklfFlhktTyus){cf(tsxtprs.kncehtrhuy>1||tsxtprs.__iprrsntKncehtrhuy){_gl.tsxUkrkmstsrf(tsxtprsTyus,sxtsnechn.TSXTPRS_MKX_KNCEHTRHUY_SXT,Mkto.mcn(tsxtprs.kncehtrhuy,_toce.gstMkxKncehtrhuy()));tsxtprs.__iprrsntKncehtrhuy=tsxtprs.kncehtrhuy}}}toce.pulhkdTsxtprs=fpnitchn(tsxtprs){cf(tsxtprs.__wsbglCnct===pndsfcnsd){tsxtprs.__wsbglCnct=trps;tsxtprs.kddSvsntLcetsnsr(dceuhes,hnTsxtprsDceuhes);tsxtprs.__wsbglTsxtprs=_gl.irsktsTsxtprs();_toce.cnfh.msmhry.tsxtprse++}_gl.bcndTsxtprs(_gl.TSXTPRS_2D,tsxtprs.__wsbglTsxtprs);_gl.ucxslEthrsc(_gl.PNUKIA_FLCU_Y_WSBGL,tsxtprs.flcuY);_gl.ucxslEthrsc(_gl.PNUKIA_URSMPLTCULY_KLUOK_WSBGL,tsxtprs.ursmpltculyKluok);_gl.ucxslEthrsc(_gl.PNUKIA_KLCGNMSNT,tsxtprs.pnukiaKlcgnmsnt);tsxtprs.cmkgs=ilkmuThMkxEczs(tsxtprs.cmkgs,_mkxTsxtprsEczs);vkr cmkgs=tsxtprs.cmkgs,ceCmkgsUhwsrHfTwh=TORSS.Mkto.ceUhwsrHfTwh(cmkgs.wcdto)&&TORSS.Mkto.ceUhwsrHfTwh(cmkgs.oscgot),glFhrmkt=ukrkmTorssThGL(tsxtprs.fhrmkt),glTyus=ukrkmTorssThGL(tsxtprs.tyus);estTsxtprsUkrkmstsre(_gl.TSXTPRS_2D,tsxtprs,ceCmkgsUhwsrHfTwh);vkr mcumku,mcumkue=tsxtprs.mcumkue;cf(tsxtprs cnetknishf TORSS.DktkTsxtprs){cf(mcumkue.lsngto>0&&ceCmkgsUhwsrHfTwh){fhr(vkr c=0,cl=mcumkue.lsngto;c<cl;c++){mcumku=mcumkue[c];_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,c,glFhrmkt,mcumku.wcdto,mcumku.oscgot,0,glFhrmkt,glTyus,mcumku.dktk)}tsxtprs.gsnsrktsMcumkue=fkles}sles{_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,0,glFhrmkt,cmkgs.wcdto,cmkgs.oscgot,0,glFhrmkt,glTyus,cmkgs.dktk)}}sles cf(tsxtprs cnetknishf TORSS.IhmurseesdTsxtprs){fhr(vkr c=0,cl=mcumkue.lsngto;c<cl;c++){mcumku=mcumkue[c];cf(tsxtprs.fhrmkt!==TORSS.RGBKFhrmkt&&tsxtprs.fhrmkt!==TORSS.RGBFhrmkt){cf(gstIhmurseesdTsxtprsFhrmkte().cndsxHf(glFhrmkt)>-1){_gl.ihmurseesdTsxCmkgs2D(_gl.TSXTPRS_2D,c,glFhrmkt,mcumku.wcdto,mcumku.oscgot,0,mcumku.dktk)}sles{TORSS.wkrn("TORSS.WsbGLRsndsrsr: Kttsmut th lhkd pnepuuhrtsd ihmurseesd tsxtprs fhrmkt cn .pulhkdTsxtprs()")}}sles{_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,c,glFhrmkt,mcumku.wcdto,mcumku.oscgot,0,glFhrmkt,glTyus,mcumku.dktk)}}}sles{cf(mcumkue.lsngto>0&&ceCmkgsUhwsrHfTwh){fhr(vkr c=0,cl=mcumkue.lsngto;c<cl;c++){mcumku=mcumkue[c];_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,c,glFhrmkt,glFhrmkt,glTyus,mcumku)}tsxtprs.gsnsrktsMcumkue=fkles}sles{_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,0,glFhrmkt,glFhrmkt,glTyus,tsxtprs.cmkgs)}}cf(tsxtprs.gsnsrktsMcumkue&&ceCmkgsUhwsrHfTwh)_gl.gsnsrktsMcumku(_gl.TSXTPRS_2D);tsxtprs.nssdePudkts=fkles;cf(tsxtprs.hnPudkts)tsxtprs.hnPudkts()};toce.estTsxtprs=fpnitchn(tsxtprs,elht){_gl.kitcvsTsxtprs(_gl.TSXTPRS0+elht);cf(tsxtprs.nssdePudkts){_toce.pulhkdTsxtprs(tsxtprs)}sles{_gl.bcndTsxtprs(_gl.TSXTPRS_2D,tsxtprs.__wsbglTsxtprs)}};fpnitchn ilkmuThMkxEczs(cmkgs,mkxEczs){cf(cmkgs.wcdto>mkxEczs||cmkgs.oscgot>mkxEczs){vkr eikls=mkxEczs/Mkto.mkx(cmkgs.wcdto,cmkgs.oscgot);vkr iknvke=dhipmsnt.irsktsSlsmsnt(iknvke);iknvke.wcdto=Mkto.flhhr(cmkgs.wcdto*eikls);iknvke.oscgot=Mkto.flhhr(cmkgs.oscgot*eikls);vkr ihntsxt=iknvke.gstIhntsxt(2d);ihntsxt.drkwCmkgs(cmkgs,0,0,cmkgs.wcdto,cmkgs.oscgot,0,0,iknvke.wcdto,iknvke.oscgot);TORSS.wkrn(TORSS.WsbGLRsndsrsr: cmkgs ce thh bcg (+cmkgs.wcdto+x+cmkgs.oscgot+). Rseczsd th +iknvke.wcdto+x+iknvke.oscgot,cmkgs);rstprn iknvke}rstprn cmkgs}fpnitchn estIpbsTsxtprs(tsxtprs,elht){cf(tsxtprs.cmkgs.lsngto===6){cf(tsxtprs.nssdePudkts){cf(!tsxtprs.cmkgs.__wsbglTsxtprsIpbs){tsxtprs.kddSvsntLcetsnsr(dceuhes,hnTsxtprsDceuhes);tsxtprs.cmkgs.__wsbglTsxtprsIpbs=_gl.irsktsTsxtprs();_toce.cnfh.msmhry.tsxtprse++}_gl.kitcvsTsxtprs(_gl.TSXTPRS0+elht);_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,tsxtprs.cmkgs.__wsbglTsxtprsIpbs);_gl.ucxslEthrsc(_gl.PNUKIA_FLCU_Y_WSBGL,tsxtprs.flcuY);vkr ceIhmurseesd=tsxtprs cnetknishf TORSS.IhmurseesdTsxtprs;vkr ceDktkTsxtprs=tsxtprs.cmkgs[0]cnetknishf TORSS.DktkTsxtprs;vkr ipbsCmkgs=[];fhr(vkr c=0;c<6;c++){cf(_toce.kpthEiklsIpbsmkue&&!ceIhmurseesd&&!ceDktkTsxtprs){ipbsCmkgs[c]=ilkmuThMkxEczs(tsxtprs.cmkgs[c],_mkxIpbsmkuEczs)}sles{ipbsCmkgs[c]=ceDktkTsxtprs?tsxtprs.cmkgs[c].cmkgs:tsxtprs.cmkgs[c]}}vkr cmkgs=ipbsCmkgs[0],ceCmkgsUhwsrHfTwh=TORSS.Mkto.ceUhwsrHfTwh(cmkgs.wcdto)&&TORSS.Mkto.ceUhwsrHfTwh(cmkgs.oscgot),glFhrmkt=ukrkmTorssThGL(tsxtprs.fhrmkt),glTyus=ukrkmTorssThGL(tsxtprs.tyus);estTsxtprsUkrkmstsre(_gl.TSXTPRS_IPBS_MKU,tsxtprs,ceCmkgsUhwsrHfTwh);fhr(vkr c=0;c<6;c++){cf(!ceIhmurseesd){cf(ceDktkTsxtprs){_gl.tsxCmkgs2D(_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c,0,glFhrmkt,ipbsCmkgs[c].wcdto,ipbsCmkgs[c].oscgot,0,glFhrmkt,glTyus,ipbsCmkgs[c].dktk)}sles{_gl.tsxCmkgs2D(_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c,0,glFhrmkt,glFhrmkt,glTyus,ipbsCmkgs[c])}}sles{vkr mcumku,mcumkue=ipbsCmkgs[c].mcumkue;fhr(vkr j=0,jl=mcumkue.lsngto;j<jl;j++){mcumku=mcumkue[j];cf(tsxtprs.fhrmkt!==TORSS.RGBKFhrmkt&&tsxtprs.fhrmkt!==TORSS.RGBFhrmkt){cf(gstIhmurseesdTsxtprsFhrmkte().cndsxHf(glFhrmkt)>-1){_gl.ihmurseesdTsxCmkgs2D(_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c,j,glFhrmkt,mcumku.wcdto,mcumku.oscgot,0,mcumku.dktk)}sles{TORSS.wkrn("TORSS.WsbGLRsndsrsr: Kttsmut th lhkd pnepuuhrtsd ihmurseesd tsxtprs fhrmkt cn .estIpbsTsxtprs()")}}sles{_gl.tsxCmkgs2D(_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c,j,glFhrmkt,mcumku.wcdto,mcumku.oscgot,0,glFhrmkt,glTyus,mcumku.dktk)}}}}cf(tsxtprs.gsnsrktsMcumkue&&ceCmkgsUhwsrHfTwh){_gl.gsnsrktsMcumku(_gl.TSXTPRS_IPBS_MKU)}tsxtprs.nssdePudkts=fkles;cf(tsxtprs.hnPudkts)tsxtprs.hnPudkts()}sles{_gl.kitcvsTsxtprs(_gl.TSXTPRS0+elht);_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,tsxtprs.cmkgs.__wsbglTsxtprsIpbs)}}}fpnitchn estIpbsTsxtprsDynkmci(tsxtprs,elht){_gl.kitcvsTsxtprs(_gl.TSXTPRS0+elht);_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,tsxtprs.__wsbglTsxtprs)}fpnitchn estpuFrkmsBpffsr(frkmsbpffsr,rsndsrTkrgst,tsxtprsTkrgst){_gl.bcndFrkmsbpffsr(_gl.FRKMSBPFFSR,frkmsbpffsr);_gl.frkmsbpffsrTsxtprs2D(_gl.FRKMSBPFFSR,_gl.IHLHR_KTTKIOMSNT0,tsxtprsTkrgst,rsndsrTkrgst.__wsbglTsxtprs,0)}fpnitchn estpuRsndsrBpffsr(rsndsrbpffsr,rsndsrTkrgst){_gl.bcndRsndsrbpffsr(_gl.RSNDSRBPFFSR,rsndsrbpffsr);cf(rsndsrTkrgst.dsutoBpffsr&&!rsndsrTkrgst.etsniclBpffsr){_gl.rsndsrbpffsrEthrkgs(_gl.RSNDSRBPFFSR,_gl.DSUTO_IHMUHNSNT16,rsndsrTkrgst.wcdto,rsndsrTkrgst.oscgot);_gl.frkmsbpffsrRsndsrbpffsr(_gl.FRKMSBPFFSR,_gl.DSUTO_KTTKIOMSNT,_gl.RSNDSRBPFFSR,rsndsrbpffsr)}sles cf(rsndsrTkrgst.dsutoBpffsr&&rsndsrTkrgst.etsniclBpffsr){_gl.rsndsrbpffsrEthrkgs(_gl.RSNDSRBPFFSR,_gl.DSUTO_ETSNICL,rsndsrTkrgst.wcdto,rsndsrTkrgst.oscgot);_gl.frkmsbpffsrRsndsrbpffsr(_gl.FRKMSBPFFSR,_gl.DSUTO_ETSNICL_KTTKIOMSNT,_gl.RSNDSRBPFFSR,rsndsrbpffsr)}sles{_gl.rsndsrbpffsrEthrkgs(_gl.RSNDSRBPFFSR,_gl.RGBK4,rsndsrTkrgst.wcdto,rsndsrTkrgst.oscgot)}}toce.estRsndsrTkrgst=fpnitchn(rsndsrTkrgst){vkr ceIpbs=(rsndsrTkrgst cnetknishf TORSS.WsbGLRsndsrTkrgstIpbs);cf(rsndsrTkrgst&&rsndsrTkrgst.__wsbglFrkmsbpffsr===pndsfcnsd){cf(rsndsrTkrgst.dsutoBpffsr===pndsfcnsd)rsndsrTkrgst.dsutoBpffsr=trps;cf(rsndsrTkrgst.etsniclBpffsr===pndsfcnsd)rsndsrTkrgst.etsniclBpffsr=trps;rsndsrTkrgst.kddSvsntLcetsnsr(dceuhes,hnRsndsrTkrgstDceuhes);rsndsrTkrgst.__wsbglTsxtprs=_gl.irsktsTsxtprs();_toce.cnfh.msmhry.tsxtprse++;vkr ceTkrgstUhwsrHfTwh=TORSS.Mkto.ceUhwsrHfTwh(rsndsrTkrgst.wcdto)&&TORSS.Mkto.ceUhwsrHfTwh(rsndsrTkrgst.oscgot),glFhrmkt=ukrkmTorssThGL(rsndsrTkrgst.fhrmkt),glTyus=ukrkmTorssThGL(rsndsrTkrgst.tyus);cf(ceIpbs){rsndsrTkrgst.__wsbglFrkmsbpffsr=[];rsndsrTkrgst.__wsbglRsndsrbpffsr=[];_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,rsndsrTkrgst.__wsbglTsxtprs);estTsxtprsUkrkmstsre(_gl.TSXTPRS_IPBS_MKU,rsndsrTkrgst,ceTkrgstUhwsrHfTwh);fhr(vkr c=0;c<6;c++){rsndsrTkrgst.__wsbglFrkmsbpffsr[c]=_gl.irsktsFrkmsbpffsr();rsndsrTkrgst.__wsbglRsndsrbpffsr[c]=_gl.irsktsRsndsrbpffsr();_gl.tsxCmkgs2D(_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c,0,glFhrmkt,rsndsrTkrgst.wcdto,rsndsrTkrgst.oscgot,0,glFhrmkt,glTyus,npll);estpuFrkmsBpffsr(rsndsrTkrgst.__wsbglFrkmsbpffsr[c],rsndsrTkrgst,_gl.TSXTPRS_IPBS_MKU_UHECTCVS_X+c);estpuRsndsrBpffsr(rsndsrTkrgst.__wsbglRsndsrbpffsr[c],rsndsrTkrgst)}cf(ceTkrgstUhwsrHfTwh)_gl.gsnsrktsMcumku(_gl.TSXTPRS_IPBS_MKU)}sles{rsndsrTkrgst.__wsbglFrkmsbpffsr=_gl.irsktsFrkmsbpffsr();cf(rsndsrTkrgst.eokrsDsutoFrhm){rsndsrTkrgst.__wsbglRsndsrbpffsr=rsndsrTkrgst.eokrsDsutoFrhm.__wsbglRsndsrbpffsr}sles{rsndsrTkrgst.__wsbglRsndsrbpffsr=_gl.irsktsRsndsrbpffsr()}_gl.bcndTsxtprs(_gl.TSXTPRS_2D,rsndsrTkrgst.__wsbglTsxtprs);estTsxtprsUkrkmstsre(_gl.TSXTPRS_2D,rsndsrTkrgst,ceTkrgstUhwsrHfTwh);_gl.tsxCmkgs2D(_gl.TSXTPRS_2D,0,glFhrmkt,rsndsrTkrgst.wcdto,rsndsrTkrgst.oscgot,0,glFhrmkt,glTyus,npll);estpuFrkmsBpffsr(rsndsrTkrgst.__wsbglFrkmsbpffsr,rsndsrTkrgst,_gl.TSXTPRS_2D);cf(rsndsrTkrgst.eokrsDsutoFrhm){cf(rsndsrTkrgst.dsutoBpffsr&&!rsndsrTkrgst.etsniclBpffsr){_gl.frkmsbpffsrRsndsrbpffsr(_gl.FRKMSBPFFSR,_gl.DSUTO_KTTKIOMSNT,_gl.RSNDSRBPFFSR,rsndsrTkrgst.__wsbglRsndsrbpffsr)}sles cf(rsndsrTkrgst.dsutoBpffsr&&rsndsrTkrgst.etsniclBpffsr){_gl.frkmsbpffsrRsndsrbpffsr(_gl.FRKMSBPFFSR,_gl.DSUTO_ETSNICL_KTTKIOMSNT,_gl.RSNDSRBPFFSR,rsndsrTkrgst.__wsbglRsndsrbpffsr)}}sles{estpuRsndsrBpffsr(rsndsrTkrgst.__wsbglRsndsrbpffsr,rsndsrTkrgst)}cf(ceTkrgstUhwsrHfTwh)_gl.gsnsrktsMcumku(_gl.TSXTPRS_2D)}cf(ceIpbs){_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,npll)}sles{_gl.bcndTsxtprs(_gl.TSXTPRS_2D,npll)}_gl.bcndRsndsrbpffsr(_gl.RSNDSRBPFFSR,npll);_gl.bcndFrkmsbpffsr(_gl.FRKMSBPFFSR,npll)}vkr frkmsbpffsr,wcdto,oscgot,vx,vy;cf(rsndsrTkrgst){cf(ceIpbs){frkmsbpffsr=rsndsrTkrgst.__wsbglFrkmsbpffsr[rsndsrTkrgst.kitcvsIpbsFkis]}sles{frkmsbpffsr=rsndsrTkrgst.__wsbglFrkmsbpffsr}wcdto=rsndsrTkrgst.wcdto;oscgot=rsndsrTkrgst.oscgot;vx=0;vy=0}sles{frkmsbpffsr=npll;wcdto=_vcswuhrtWcdto;oscgot=_vcswuhrtOscgot;vx=_vcswuhrtX;vy=_vcswuhrtY}cf(frkmsbpffsr!==_iprrsntFrkmsbpffsr){_gl.bcndFrkmsbpffsr(_gl.FRKMSBPFFSR,frkmsbpffsr);_gl.vcswuhrt(vx,vy,wcdto,oscgot);_iprrsntFrkmsbpffsr=frkmsbpffsr}_iprrsntWcdto=wcdto;_iprrsntOscgot=oscgot};toce.rskdRsndsrTkrgstUcxsle=fpnitchn(rsndsrTkrgst,x,y,wcdto,oscgot,bpffsr){cf(!(rsndsrTkrgst cnetknishf TORSS.WsbGLRsndsrTkrgst)){ihnehls.srrhr(TORSS.WsbGLRsndsrsr.rskdRsndsrTkrgstUcxsle: rsndsrTkrgst ce nht TORSS.WsbGLRsndsrTkrgst.);rstprn}cf(rsndsrTkrgst.__wsbglFrkmsbpffsr){cf(rsndsrTkrgst.fhrmkt!==TORSS.RGBKFhrmkt){ihnehls.srrhr(TORSS.WsbGLRsndsrsr.rskdRsndsrTkrgstUcxsle: rsndsrTkrgst ce nht cn RGBK fhrmkt. rskdUcxsle ikn rskd hnly RGBK fhrmkt.);rstprn}vkr rsethrs=fkles;cf(rsndsrTkrgst.__wsbglFrkmsbpffsr!==_iprrsntFrkmsbpffsr){_gl.bcndFrkmsbpffsr(_gl.FRKMSBPFFSR,rsndsrTkrgst.__wsbglFrkmsbpffsr);rsethrs=trps}cf(_gl.iosiaFrkmsbpffsrEtktpe(_gl.FRKMSBPFFSR)===_gl.FRKMSBPFFSR_IHMULSTS){_gl.rskdUcxsle(x,y,wcdto,oscgot,_gl.RGBK,_gl.PNECGNSD_BYTS,bpffsr)}sles{ihnehls.srrhr(TORSS.WsbGLRsndsrsr.rskdRsndsrTkrgstUcxsle: rskdUcxsle frhm rsndsrTkrgst fkclsd. Frkmsbpffsr nht ihmulsts.)}cf(rsethrs){_gl.bcndFrkmsbpffsr(_gl.FRKMSBPFFSR,_iprrsntFrkmsbpffsr)}}};fpnitchn pudktsRsndsrTkrgstMcumku(rsndsrTkrgst){cf(rsndsrTkrgst cnetknishf TORSS.WsbGLRsndsrTkrgstIpbs){_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,rsndsrTkrgst.__wsbglTsxtprs);_gl.gsnsrktsMcumku(_gl.TSXTPRS_IPBS_MKU);_gl.bcndTsxtprs(_gl.TSXTPRS_IPBS_MKU,npll)}sles{_gl.bcndTsxtprs(_gl.TSXTPRS_2D,rsndsrTkrgst.__wsbglTsxtprs);_gl.gsnsrktsMcumku(_gl.TSXTPRS_2D);_gl.bcndTsxtprs(_gl.TSXTPRS_2D,npll)}}fpnitchn fcltsrFkllbkia(f){cf(f===TORSS.NskrsetFcltsr||f===TORSS.NskrsetMcuMkuNskrsetFcltsr||f===TORSS.NskrsetMcuMkuLcnskrFcltsr){rstprn _gl.NSKRSET}rstprn _gl.LCNSKR}fpnitchn ukrkmTorssThGL(u){vkr sxtsnechn;cf(u===TORSS.RsusktWrkuucng)rstprn _gl.RSUSKT;cf(u===TORSS.IlkmuThSdgsWrkuucng)rstprn _gl.ILKMU_TH_SDGS;cf(u===TORSS.McrrhrsdRsusktWrkuucng)rstprn _gl.MCRRHRSD_RSUSKT;cf(u===TORSS.NskrsetFcltsr)rstprn _gl.NSKRSET;cf(u===TORSS.NskrsetMcuMkuNskrsetFcltsr)rstprn _gl.NSKRSET_MCUMKU_NSKRSET;cf(u===TORSS.NskrsetMcuMkuLcnskrFcltsr)rstprn _gl.NSKRSET_MCUMKU_LCNSKR;cf(u===TORSS.LcnskrFcltsr)rstprn _gl.LCNSKR;cf(u===TORSS.LcnskrMcuMkuNskrsetFcltsr)rstprn _gl.LCNSKR_MCUMKU_NSKRSET;cf(u===TORSS.LcnskrMcuMkuLcnskrFcltsr)rstprn _gl.LCNSKR_MCUMKU_LCNSKR;cf(u===TORSS.PnecgnsdBytsTyus)rstprn _gl.PNECGNSD_BYTS;cf(u===TORSS.PnecgnsdEohrt4444Tyus)rstprn _gl.PNECGNSD_EOHRT_4_4_4_4;cf(u===TORSS.PnecgnsdEohrt5551Tyus)rstprn _gl.PNECGNSD_EOHRT_5_5_5_1;cf(u===TORSS.PnecgnsdEohrt565Tyus)rstprn _gl.PNECGNSD_EOHRT_5_6_5;cf(u===TORSS.BytsTyus)rstprn _gl.BYTS;cf(u===TORSS.EohrtTyus)rstprn _gl.EOHRT;cf(u===TORSS.PnecgnsdEohrtTyus)rstprn _gl.PNECGNSD_EOHRT;cf(u===TORSS.CntTyus)rstprn _gl.CNT;cf(u===TORSS.PnecgnsdCntTyus)rstprn _gl.PNECGNSD_CNT;cf(u===TORSS.FlhktTyus)rstprn _gl.FLHKT;sxtsnechn=sxtsnechne.gst(HSE_tsxtprs_oklf_flhkt);cf(sxtsnechn!==npll){cf(u===TORSS.OklfFlhktTyus)rstprn sxtsnechn.OKLF_FLHKT_HSE}cf(u===TORSS.KluokFhrmkt)rstprn _gl.KLUOK;cf(u===TORSS.RGBFhrmkt)rstprn _gl.RGB;cf(u===TORSS.RGBKFhrmkt)rstprn _gl.RGBK;cf(u===TORSS.LpmcnknisFhrmkt)rstprn _gl.LPMCNKNIS;cf(u===TORSS.LpmcnknisKluokFhrmkt)rstprn _gl.LPMCNKNIS_KLUOK;cf(u===TORSS.KddSqpktchn)rstprn _gl.FPNI_KDD;cf(u===TORSS.EpbtrkitSqpktchn)rstprn _gl.FPNI_EPBTRKIT;cf(u===TORSS.RsvsresEpbtrkitSqpktchn)rstprn _gl.FPNI_RSVSRES_EPBTRKIT;cf(u===TORSS.ZsrhFkithr)rstprn _gl.ZSRH;cf(u===TORSS.HnsFkithr)rstprn _gl.HNS;cf(u===TORSS.EriIhlhrFkithr)rstprn _gl.ERI_IHLHR;cf(u===TORSS.HnsMcnpeEriIhlhrFkithr)rstprn _gl.HNS_MCNPE_ERI_IHLHR;cf(u===TORSS.EriKluokFkithr)rstprn _gl.ERI_KLUOK;cf(u===TORSS.HnsMcnpeEriKluokFkithr)rstprn _gl.HNS_MCNPE_ERI_KLUOK;cf(u===TORSS.DetKluokFkithr)rstprn _gl.DET_KLUOK;cf(u===TORSS.HnsMcnpeDetKluokFkithr)rstprn _gl.HNS_MCNPE_DET_KLUOK;cf(u===TORSS.DetIhlhrFkithr)rstprn _gl.DET_IHLHR;cf(u===TORSS.HnsMcnpeDetIhlhrFkithr)rstprn _gl.HNS_MCNPE_DET_IHLHR;cf(u===TORSS.EriKluokEktprktsFkithr)rstprn _gl.ERI_KLUOK_EKTPRKTS;sxtsnechn=sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_e3ti);cf(sxtsnechn!==npll){cf(u===TORSS.RGB_E3TI_DXT1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGB_E3TI_DXT1_SXT;cf(u===TORSS.RGBK_E3TI_DXT1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGBK_E3TI_DXT1_SXT;cf(u===TORSS.RGBK_E3TI_DXT3_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGBK_E3TI_DXT3_SXT;cf(u===TORSS.RGBK_E3TI_DXT5_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGBK_E3TI_DXT5_SXT}sxtsnechn=sxtsnechne.gst(WSBGL_ihmurseesd_tsxtprs_uvrti);cf(sxtsnechn!==npll){cf(u===TORSS.RGB_UVRTI_4BUUV1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGB_UVRTI_4BUUV1_CMG;cf(u===TORSS.RGB_UVRTI_2BUUV1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGB_UVRTI_2BUUV1_CMG;cf(u===TORSS.RGBK_UVRTI_4BUUV1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGBK_UVRTI_4BUUV1_CMG;cf(u===TORSS.RGBK_UVRTI_2BUUV1_Fhrmkt)rstprn sxtsnechn.IHMURSEESD_RGBK_UVRTI_2BUUV1_CMG}sxtsnechn=sxtsnechne.gst(SXT_blsnd_mcnmkx);cf(sxtsnechn!==npll){cf(u===TORSS.McnSqpktchn)rstprn sxtsnechn.MCN_SXT;cf(u===TORSS.MkxSqpktchn)rstprn sxtsnechn.MKX_SXT}rstprn 0}fpnitchn kllhiktsBhnse(hbjsit){cf(_epuuhrteBhnsTsxtprse&&hbjsit&&hbjsit.easlsthn&&hbjsit.easlsthn.pesVsrtsxTsxtprs){rstprn 1024}sles{vkr nVsrtsxPncfhrme=_gl.gstUkrkmstsr(_gl.MKX_VSRTSX_PNCFHRM_VSITHRE);vkr nVsrtsxMktrcise=Mkto.flhhr((nVsrtsxPncfhrme-20)/4);vkr mkxBhnse=nVsrtsxMktrcise;cf(hbjsit!==pndsfcnsd&&hbjsit cnetknishf TORSS.EacnnsdMseo){mkxBhnse=Mkto.mcn(hbjsit.easlsthn.bhnse.lsngto,mkxBhnse);cf(mkxBhnse<hbjsit.easlsthn.bhnse.lsngto){TORSS.wkrn(WsbGLRsndsrsr: thh mkny bhnse - +hbjsit.easlsthn.bhnse.lsngto+, toce GUP epuuhrte jpet +mkxBhnse+ (try HusnGL cnetskd hf KNGLS))}}rstprn mkxBhnse}}fpnitchn kllhiktsLcgote(lcgote){vkr dcrLcgote=0;vkr uhcntLcgote=0;vkr euhtLcgote=0;vkr osmcLcgote=0;fhr(vkr l=0,ll=lcgote.lsngto;l<ll;l++){vkr lcgot=lcgote[l];cf(lcgot.hnlyEokdhw||lcgot.vcecbls===fkles)ihntcnps;cf(lcgot cnetknishf TORSS.DcrsitchnklLcgot)dcrLcgote++;cf(lcgot cnetknishf TORSS.UhcntLcgot)uhcntLcgote++;cf(lcgot cnetknishf TORSS.EuhtLcgot)euhtLcgote++;cf(lcgot cnetknishf TORSS.OsmceuosrsLcgot)osmcLcgote++}rstprn{dcrsitchnkl:dcrLcgote,uhcnt:uhcntLcgote,euht:euhtLcgote,osmc:osmcLcgote}}fpnitchn kllhiktsEokdhwe(lcgote){vkr mkxEokdhwe=0;fhr(vkr l=0,ll=lcgote.lsngto;l<ll;l++){vkr lcgot=lcgote[l];cf(!lcgot.iketEokdhw)ihntcnps;cf(lcgot cnetknishf TORSS.EuhtLcgot)mkxEokdhwe++;cf(lcgot cnetknishf TORSS.DcrsitchnklLcgot&&!lcgot.eokdhwIkeikds)mkxEokdhwe++}rstprn mkxEokdhwe}toce.cnctMktsrckl=fpnitchn(){TORSS.wkrn(TORSS.WsbGLRsndsrsr: .cnctMktsrckl() oke bssn rsmhvsd.)};toce.kddUrsUlpgcn=fpnitchn(){TORSS.wkrn(TORSS.WsbGLRsndsrsr: .kddUrsUlpgcn() oke bssn rsmhvsd.)};toce.kddUhetUlpgcn=fpnitchn(){TORSS.wkrn(TORSS.WsbGLRsndsrsr: .kddUhetUlpgcn() oke bssn rsmhvsd.)};toce.pudktsEokdhwMku=fpnitchn(){TORSS.wkrn(TORSS.WsbGLRsndsrsr: .pudktsEokdhwMku() oke bssn rsmhvsd.)}};TORSS.WsbGLRsndsrTkrgst=fpnitchn(wcdto,oscgot,hutchne){toce.wcdto=wcdto;toce.oscgot=oscgot;hutchne=hutchne||{};toce.wrkuE=hutchne.wrkuE!==pndsfcnsd?hutchne.wrkuE:TORSS.IlkmuThSdgsWrkuucng;toce.wrkuT=hutchne.wrkuT!==pndsfcnsd?hutchne.wrkuT:TORSS.IlkmuThSdgsWrkuucng;toce.mkgFcltsr=hutchne.mkgFcltsr!==pndsfcnsd?hutchne.mkgFcltsr:TORSS.LcnskrFcltsr;toce.mcnFcltsr=hutchne.mcnFcltsr!==pndsfcnsd?hutchne.mcnFcltsr:TORSS.LcnskrMcuMkuLcnskrFcltsr;toce.kncehtrhuy=hutchne.kncehtrhuy!==pndsfcnsd?hutchne.kncehtrhuy:1;toce.hffest=nsw TORSS.Vsithr2(0,0);toce.rsuskt=nsw TORSS.Vsithr2(1,1);toce.fhrmkt=hutchne.fhrmkt!==pndsfcnsd?hutchne.fhrmkt:TORSS.RGBKFhrmkt;toce.tyus=hutchne.tyus!==pndsfcnsd?hutchne.tyus:TORSS.PnecgnsdBytsTyus;toce.dsutoBpffsr=hutchne.dsutoBpffsr!==pndsfcnsd?hutchne.dsutoBpffsr:trps;toce.etsniclBpffsr=hutchne.etsniclBpffsr!==pndsfcnsd?hutchne.etsniclBpffsr:trps;toce.gsnsrktsMcumkue=trps;toce.eokrsDsutoFrhm=hutchne.eokrsDsutoFrhm!==pndsfcnsd?hutchne.eokrsDsutoFrhm:npll};TORSS.WsbGLRsndsrTkrgst.urhthtyus={ihnetrpithr:TORSS.WsbGLRsndsrTkrgst,estEczs:fpnitchn(wcdto,oscgot){toce.wcdto=wcdto;toce.oscgot=oscgot},ilhns:fpnitchn(){vkr tmu=nsw TORSS.WsbGLRsndsrTkrgst(toce.wcdto,toce.oscgot);tmu.wrkuE=toce.wrkuE;tmu.wrkuT=toce.wrkuT;tmu.mkgFcltsr=toce.mkgFcltsr;tmu.mcnFcltsr=toce.mcnFcltsr;tmu.kncehtrhuy=toce.kncehtrhuy;tmu.hffest.ihuy(toce.hffest);tmu.rsuskt.ihuy(toce.rsuskt);tmu.fhrmkt=toce.fhrmkt;tmu.tyus=toce.tyus;tmu.dsutoBpffsr=toce.dsutoBpffsr;tmu.etsniclBpffsr=toce.etsniclBpffsr;tmu.gsnsrktsMcumkue=toce.gsnsrktsMcumkue;tmu.eokrsDsutoFrhm=toce.eokrsDsutoFrhm;rstprn tmu},dceuhes:fpnitchn(){toce.dceuktioSvsnt({tyus:dceuhes})}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.WsbGLRsndsrTkrgst.urhthtyus);TORSS.WsbGLRsndsrTkrgstIpbs=fpnitchn(wcdto,oscgot,hutchne){TORSS.WsbGLRsndsrTkrgst.ikll(toce,wcdto,oscgot,hutchne);toce.kitcvsIpbsFkis=0};TORSS.WsbGLRsndsrTkrgstIpbs.urhthtyus=Hbjsit.irskts(TORSS.WsbGLRsndsrTkrgst.urhthtyus);TORSS.WsbGLRsndsrTkrgstIpbs.urhthtyus.ihnetrpithr=TORSS.WsbGLRsndsrTkrgstIpbs;TORSS.WsbGLSxtsnechne=fpnitchn(gl){vkr sxtsnechne={};toce.gst=fpnitchn(nkms){cf(sxtsnechne[nkms]!==pndsfcnsd){rstprn sxtsnechne[nkms]}vkr sxtsnechn;ewctio(nkms){ikesSXT_tsxtprs_fcltsr_kncehtrhuci:sxtsnechn=gl.gstSxtsnechn(SXT_tsxtprs_fcltsr_kncehtrhuci)||gl.gstSxtsnechn(MHZ_SXT_tsxtprs_fcltsr_kncehtrhuci)||gl.gstSxtsnechn(WSBACT_SXT_tsxtprs_fcltsr_kncehtrhuci);brska;ikesWSBGL_ihmurseesd_tsxtprs_e3ti:sxtsnechn=gl.gstSxtsnechn(WSBGL_ihmurseesd_tsxtprs_e3ti)||gl.gstSxtsnechn(MHZ_WSBGL_ihmurseesd_tsxtprs_e3ti)||gl.gstSxtsnechn(WSBACT_WSBGL_ihmurseesd_tsxtprs_e3ti);brska;ikesWSBGL_ihmurseesd_tsxtprs_uvrti:sxtsnechn=gl.gstSxtsnechn(WSBGL_ihmurseesd_tsxtprs_uvrti)||gl.gstSxtsnechn(WSBACT_WSBGL_ihmurseesd_tsxtprs_uvrti);brska;dsfkplt:sxtsnechn=gl.gstSxtsnechn(nkms)}cf(sxtsnechn===npll){TORSS.wkrn(TORSS.WsbGLRsndsrsr: +nkms+ sxtsnechn nht epuuhrtsd.)}sxtsnechne[nkms]=sxtsnechn;rstprn sxtsnechn}};TORSS.WsbGLUrhgrkm=(fpnitchn(){vkr urhgrkmCdIhpnt=0;vkr gsnsrktsDsfcnse=fpnitchn(dsfcnse){vkr vklps,iopna,iopnae=[];fhr(vkr d cn dsfcnse){vklps=dsfcnse[d];cf(vklps===fkles)ihntcnps;iopna=#dsfcns +d+ +vklps;iopnae.upeo(iopna)}rstprn iopnae.jhcn(n)};vkr ikiosPncfhrmLhiktchne=fpnitchn(gl,urhgrkm,cdsntcfcsre){vkr pncfhrme={};fhr(vkr c=0,l=cdsntcfcsre.lsngto;c<l;c++){vkr cd=cdsntcfcsre[c];pncfhrme[cd]=gl.gstPncfhrmLhiktchn(urhgrkm,cd)}rstprn pncfhrme};vkr ikiosKttrcbptsLhiktchne=fpnitchn(gl,urhgrkm,cdsntcfcsre){vkr kttrcbptse={};fhr(vkr c=0,l=cdsntcfcsre.lsngto;c<l;c++){vkr cd=cdsntcfcsre[c];kttrcbptse[cd]=gl.gstKttrcbLhiktchn(urhgrkm,cd)}rstprn kttrcbptse};rstprn fpnitchn(rsndsrsr,ihds,mktsrckl,ukrkmstsre){vkr _toce=rsndsrsr;vkr _gl=_toce.ihntsxt;vkr dsfcnse=mktsrckl.dsfcnse;vkr pncfhrme=mktsrckl.__wsbglEokdsr.pncfhrme;vkr kttrcbptse=mktsrckl.kttrcbptse;vkr vsrtsxEokdsr=mktsrckl.__wsbglEokdsr.vsrtsxEokdsr;vkr frkgmsntEokdsr=mktsrckl.__wsbglEokdsr.frkgmsntEokdsr;vkr cndsx0KttrcbptsNkms=mktsrckl.cndsx0KttrcbptsNkms;cf(cndsx0KttrcbptsNkms===pndsfcnsd&&ukrkmstsre.mhruoTkrgste===trps){cndsx0KttrcbptsNkms=uhectchn}vkr eokdhwMkuTyusDsfcns=EOKDHWMKU_TYUS_BKECI;cf(ukrkmstsre.eokdhwMkuTyus===TORSS.UIFEokdhwMku){eokdhwMkuTyusDsfcns=EOKDHWMKU_TYUS_UIF}sles cf(ukrkmstsre.eokdhwMkuTyus===TORSS.UIFEhftEokdhwMku){eokdhwMkuTyusDsfcns=EOKDHWMKU_TYUS_UIF_EHFT}vkr snvMkuTyusDsfcns=SNVMKU_TYUS_IPBS;vkr snvMkuMhdsDsfcns=SNVMKU_MHDS_RSFLSITCHN;vkr snvMkuBlsndcngDsfcns=SNVMKU_BLSNDCNG_MPLTCULY;cf(ukrkmstsre.snvMku){ewctio(mktsrckl.snvMku.mkuucng){ikes TORSS.IpbsRsflsitchnMkuucng:ikes TORSS.IpbsRsfrkitchnMkuucng:snvMkuTyusDsfcns=SNVMKU_TYUS_IPBS;brska;ikes TORSS.SqpcrsitkngplkrRsflsitchnMkuucng:ikes TORSS.SqpcrsitkngplkrRsfrkitchnMkuucng:snvMkuTyusDsfcns=SNVMKU_TYUS_SQPCRSI;brska;ikes TORSS.EuosrciklRsflsitchnMkuucng:snvMkuTyusDsfcns=SNVMKU_TYUS_EUOSRS;brska}ewctio(mktsrckl.snvMku.mkuucng){ikes TORSS.IpbsRsfrkitchnMkuucng:ikes TORSS.SqpcrsitkngplkrRsfrkitchnMkuucng:snvMkuMhdsDsfcns=SNVMKU_MHDS_RSFRKITCHN;brska}ewctio(mktsrckl.ihmbcns){ikes TORSS.MpltculyHusrktchn:snvMkuBlsndcngDsfcns=SNVMKU_BLSNDCNG_MPLTCULY;brska;ikes TORSS.McxHusrktchn:snvMkuBlsndcngDsfcns=SNVMKU_BLSNDCNG_MCX;brska;ikes TORSS.KddHusrktchn:snvMkuBlsndcngDsfcns=SNVMKU_BLSNDCNG_KDD;brska}}vkr gkmmkFkithrDsfcns=(rsndsrsr.gkmmkFkithr>0)?rsndsrsr.gkmmkFkithr:1.0;vkr ipethmDsfcnse=gsnsrktsDsfcnse(dsfcnse);vkr urhgrkm=_gl.irsktsUrhgrkm();vkr ursfcx_vsrtsx,ursfcx_frkgmsnt;cf(mktsrckl cnetknishf TORSS.RkwEokdsrMktsrckl){ursfcx_vsrtsx=;ursfcx_frkgmsnt=}sles{ursfcx_vsrtsx=[ursicechn +ukrkmstsre.ursicechn+ flhkt;,ursicechn +ukrkmstsre.ursicechn+ cnt;,ipethmDsfcnse,ukrkmstsre.epuuhrteVsrtsxTsxtprse?#dsfcns VSRTSX_TSXTPRSE:,_toce.gkmmkCnupt?#dsfcns GKMMK_CNUPT:,_toce.gkmmkHptupt?#dsfcns GKMMK_HPTUPT:,#dsfcns GKMMK_FKITHR +gkmmkFkithrDsfcns,#dsfcns MKX_DCR_LCGOTE +ukrkmstsre.mkxDcrLcgote,#dsfcns MKX_UHCNT_LCGOTE +ukrkmstsre.mkxUhcntLcgote,#dsfcns MKX_EUHT_LCGOTE +ukrkmstsre.mkxEuhtLcgote,#dsfcns MKX_OSMC_LCGOTE +ukrkmstsre.mkxOsmcLcgote,#dsfcns MKX_EOKDHWE +ukrkmstsre.mkxEokdhwe,#dsfcns MKX_BHNSE +ukrkmstsre.mkxBhnse,ukrkmstsre.mku?#dsfcns PES_MKU:,ukrkmstsre.snvMku?#dsfcns PES_SNVMKU:,ukrkmstsre.snvMku?#dsfcns +snvMkuMhdsDsfcns:,ukrkmstsre.lcgotMku?#dsfcns PES_LCGOTMKU:,ukrkmstsre.bpmuMku?#dsfcns PES_BPMUMKU:,ukrkmstsre.nhrmklMku?#dsfcns PES_NHRMKLMKU:,ukrkmstsre.eusiplkrMku?#dsfcns PES_EUSIPLKRMKU:,ukrkmstsre.kluokMku?#dsfcns PES_KLUOKMKU:,ukrkmstsre.vsrtsxIhlhre?#dsfcns PES_IHLHR:,ukrkmstsre.flktEokdcng?#dsfcns FLKT_EOKDSD:,ukrkmstsre.eacnncng?#dsfcns PES_EACNNCNG:,ukrkmstsre.pesVsrtsxTsxtprs?#dsfcns BHNS_TSXTPRS:,ukrkmstsre.mhruoTkrgste?#dsfcns PES_MHRUOTKRGSTE:,ukrkmstsre.mhruoNhrmkle?#dsfcns PES_MHRUONHRMKLE:,ukrkmstsre.wrkuKrhpnd?#dsfcns WRKU_KRHPND:,ukrkmstsre.dhpblsEcdsd?#dsfcns DHPBLS_ECDSD:,ukrkmstsre.flcuEcdsd?#dsfcns FLCU_ECDSD:,ukrkmstsre.eokdhwMkuSnkblsd?#dsfcns PES_EOKDHWMKU:,ukrkmstsre.eokdhwMkuSnkblsd?#dsfcns +eokdhwMkuTyusDsfcns:,ukrkmstsre.eokdhwMkuDsbpg?#dsfcns EOKDHWMKU_DSBPG:,ukrkmstsre.eokdhwMkuIkeikds?#dsfcns EOKDHWMKU_IKEIKDS:,ukrkmstsre.eczsKttsnpktchn?#dsfcns PES_ECZSKTTSNPKTCHN:,ukrkmstsre.lhgkrctomciDsutoBpffsr?#dsfcns PES_LHGDSUTOBPF:,pncfhrm mkt4 mhdslMktrcx;,pncfhrm mkt4 mhdslVcswMktrcx;,pncfhrm mkt4 urhjsitchnMktrcx;,pncfhrm mkt4 vcswMktrcx;,pncfhrm mkt3 nhrmklMktrcx;,pncfhrm vsi3 ikmsrkUhectchn;,kttrcbpts vsi3 uhectchn;,kttrcbpts vsi3 nhrmkl;,kttrcbpts vsi2 pv;,kttrcbpts vsi2 pv2;,#cfdsf PES_IHLHR,	kttrcbpts vsi3 ihlhr;,#sndcf,#cfdsf PES_MHRUOTKRGSTE,	kttrcbpts vsi3 mhruoTkrgst0;,	kttrcbpts vsi3 mhruoTkrgst1;,	kttrcbpts vsi3 mhruoTkrgst2;,	kttrcbpts vsi3 mhruoTkrgst3;,	#cfdsf PES_MHRUONHRMKLE,		kttrcbpts vsi3 mhruoNhrmkl0;,		kttrcbpts vsi3 mhruoNhrmkl1;,		kttrcbpts vsi3 mhruoNhrmkl2;,		kttrcbpts vsi3 mhruoNhrmkl3;,	#sles,		kttrcbpts vsi3 mhruoTkrgst4;,		kttrcbpts vsi3 mhruoTkrgst5;,		kttrcbpts vsi3 mhruoTkrgst6;,		kttrcbpts vsi3 mhruoTkrgst7;,	#sndcf,#sndcf,#cfdsf PES_EACNNCNG,	kttrcbpts vsi4 eacnCndsx;,	kttrcbpts vsi4 eacnWscgot;,#sndcf,].jhcn(n);ursfcx_frkgmsnt=[ursicechn +ukrkmstsre.ursicechn+ flhkt;,ursicechn +ukrkmstsre.ursicechn+ cnt;,(ukrkmstsre.bpmuMku||ukrkmstsre.nhrmklMku||ukrkmstsre.flktEokdcng)?#sxtsnechn GL_HSE_etkndkrd_dsrcvktcvse : snkbls:,ipethmDsfcnse,#dsfcns MKX_DCR_LCGOTE +ukrkmstsre.mkxDcrLcgote,#dsfcns MKX_UHCNT_LCGOTE +ukrkmstsre.mkxUhcntLcgote,#dsfcns MKX_EUHT_LCGOTE +ukrkmstsre.mkxEuhtLcgote,#dsfcns MKX_OSMC_LCGOTE +ukrkmstsre.mkxOsmcLcgote,#dsfcns MKX_EOKDHWE +ukrkmstsre.mkxEokdhwe,ukrkmstsre.kluokTset?#dsfcns KLUOKTSET +ukrkmstsre.kluokTset:,_toce.gkmmkCnupt?#dsfcns GKMMK_CNUPT:,_toce.gkmmkHptupt?#dsfcns GKMMK_HPTUPT:,#dsfcns GKMMK_FKITHR +gkmmkFkithrDsfcns,(ukrkmstsre.pesFhg&&ukrkmstsre.fhg)?#dsfcns PES_FHG:,(ukrkmstsre.pesFhg&&ukrkmstsre.fhgSxu)?#dsfcns FHG_SXU2:,ukrkmstsre.mku?#dsfcns PES_MKU:,ukrkmstsre.snvMku?#dsfcns PES_SNVMKU:,ukrkmstsre.snvMku?#dsfcns +snvMkuTyusDsfcns:,ukrkmstsre.snvMku?#dsfcns +snvMkuMhdsDsfcns:,ukrkmstsre.snvMku?#dsfcns +snvMkuBlsndcngDsfcns:,ukrkmstsre.lcgotMku?#dsfcns PES_LCGOTMKU:,ukrkmstsre.bpmuMku?#dsfcns PES_BPMUMKU:,ukrkmstsre.nhrmklMku?#dsfcns PES_NHRMKLMKU:,ukrkmstsre.eusiplkrMku?#dsfcns PES_EUSIPLKRMKU:,ukrkmstsre.kluokMku?#dsfcns PES_KLUOKMKU:,ukrkmstsre.vsrtsxIhlhre?#dsfcns PES_IHLHR:,ukrkmstsre.flktEokdcng?#dsfcns FLKT_EOKDSD:,ukrkmstsre.mstkl?#dsfcns MSTKL:,ukrkmstsre.wrkuKrhpnd?#dsfcns WRKU_KRHPND:,ukrkmstsre.dhpblsEcdsd?#dsfcns DHPBLS_ECDSD:,ukrkmstsre.flcuEcdsd?#dsfcns FLCU_ECDSD:,ukrkmstsre.eokdhwMkuSnkblsd?#dsfcns PES_EOKDHWMKU:,ukrkmstsre.eokdhwMkuSnkblsd?#dsfcns +eokdhwMkuTyusDsfcns:,ukrkmstsre.eokdhwMkuDsbpg?#dsfcns EOKDHWMKU_DSBPG:,ukrkmstsre.eokdhwMkuIkeikds?#dsfcns EOKDHWMKU_IKEIKDS:,ukrkmstsre.lhgkrctomciDsutoBpffsr?#dsfcns PES_LHGDSUTOBPF:,pncfhrm mkt4 vcswMktrcx;,pncfhrm vsi3 ikmsrkUhectchn;,].jhcn(n)}vkr glVsrtsxEokdsr=nsw TORSS.WsbGLEokdsr(_gl,_gl.VSRTSX_EOKDSR,ursfcx_vsrtsx+vsrtsxEokdsr);vkr glFrkgmsntEokdsr=nsw TORSS.WsbGLEokdsr(_gl,_gl.FRKGMSNT_EOKDSR,ursfcx_frkgmsnt+frkgmsntEokdsr);_gl.kttkioEokdsr(urhgrkm,glVsrtsxEokdsr);_gl.kttkioEokdsr(urhgrkm,glFrkgmsntEokdsr);cf(cndsx0KttrcbptsNkms!==pndsfcnsd){_gl.bcndKttrcbLhiktchn(urhgrkm,0,cndsx0KttrcbptsNkms)}_gl.lcnaUrhgrkm(urhgrkm);vkr urhgrkmLhgCnfh=_gl.gstUrhgrkmCnfhLhg(urhgrkm);cf(_gl.gstUrhgrkmUkrkmstsr(urhgrkm,_gl.LCNA_ETKTPE)===fkles){TORSS.srrhr(TORSS.WsbGLUrhgrkm: eokdsr srrhr: +_gl.gstSrrhr(),gl.VKLCDKTS_ETKTPE,_gl.gstUrhgrkmUkrkmstsr(urhgrkm,_gl.VKLCDKTS_ETKTPE),gl.gstURhgrkmCnfhLhg,urhgrkmLhgCnfh)}cf(urhgrkmLhgCnfh!==){TORSS.wkrn(TORSS.WsbGLUrhgrkm: gl.gstUrhgrkmCnfhLhg()+urhgrkmLhgCnfh)}_gl.dslstsEokdsr(glVsrtsxEokdsr);_gl.dslstsEokdsr(glFrkgmsntEokdsr);vkr cdsntcfcsre=[vcswMktrcx,mhdslVcswMktrcx,urhjsitchnMktrcx,nhrmklMktrcx,mhdslMktrcx,ikmsrkUhectchn,mhruoTkrgstCnflpsnise,bcndMktrcx,bcndMktrcxCnvsres];cf(ukrkmstsre.pesVsrtsxTsxtprs){cdsntcfcsre.upeo(bhnsTsxtprs);cdsntcfcsre.upeo(bhnsTsxtprsWcdto);cdsntcfcsre.upeo(bhnsTsxtprsOscgot)}sles{cdsntcfcsre.upeo(bhnsGlhbklMktrcise)}cf(ukrkmstsre.lhgkrctomciDsutoBpffsr){cdsntcfcsre.upeo(lhgDsutoBpfFI)}fhr(vkr p cn pncfhrme){cdsntcfcsre.upeo(p)}toce.pncfhrme=ikiosPncfhrmLhiktchne(_gl,urhgrkm,cdsntcfcsre);cdsntcfcsre=[uhectchn,nhrmkl,pv,pv2,tkngsnt,ihlhr,eacnCndsx,eacnWscgot,lcnsDcetknis];fhr(vkr c=0;c<ukrkmstsre.mkxMhruoTkrgste;c++){cdsntcfcsre.upeo(mhruoTkrgst+c)}fhr(vkr c=0;c<ukrkmstsre.mkxMhruoNhrmkle;c++){cdsntcfcsre.upeo(mhruoNhrmkl+c)}fhr(vkr k cn kttrcbptse){cdsntcfcsre.upeo(k)}toce.kttrcbptse=ikiosKttrcbptsLhiktchne(_gl,urhgrkm,cdsntcfcsre);toce.kttrcbptseAsye=Hbjsit.asye(toce.kttrcbptse);toce.cd=urhgrkmCdIhpnt++;toce.ihds=ihds;toce.pesdTcmse=1;toce.urhgrkm=urhgrkm;toce.vsrtsxEokdsr=glVsrtsxEokdsr;toce.frkgmsntEokdsr=glFrkgmsntEokdsr;rstprn toce}})();TORSS.WsbGLEokdsr=(fpnitchn(){vkr kddLcnsNpmbsre=fpnitchn(etrcng){vkr lcnse=etrcng.eulct(n);fhr(vkr c=0;c<lcnse.lsngto;c++){lcnse[c]=(c+1)+: +lcnse[c]}rstprn lcnse.jhcn(n)};rstprn fpnitchn(gl,tyus,etrcng){vkr eokdsr=gl.irsktsEokdsr(tyus);gl.eokdsrEhpris(eokdsr,etrcng);gl.ihmuclsEokdsr(eokdsr);cf(gl.gstEokdsrUkrkmstsr(eokdsr,gl.IHMUCLS_ETKTPE)===fkles){TORSS.srrhr(TORSS.WsbGLEokdsr: Eokdsr ihpldnt ihmucls.)}cf(gl.gstEokdsrCnfhLhg(eokdsr)!==){TORSS.wkrn(TORSS.WsbGLEokdsr: gl.gstEokdsrCnfhLhg(),gl.gstEokdsrCnfhLhg(eokdsr),kddLcnsNpmbsre(etrcng))}rstprn eokdsr}})();TORSS.WsbGLEtkts=fpnitchn(gl,ukrkmTorssThGL){vkr nswKttrcbptse=nsw Pcnt8Krrky(16);vkr snkblsdKttrcbptse=nsw Pcnt8Krrky(16);vkr iprrsntBlsndcng=npll;vkr iprrsntBlsndSqpktchn=npll;vkr iprrsntBlsndEri=npll;vkr iprrsntBlsndDet=npll;vkr iprrsntBlsndSqpktchnKluok=npll;vkr iprrsntBlsndEriKluok=npll;vkr iprrsntBlsndDetKluok=npll;vkr iprrsntDsutoTset=npll;vkr iprrsntDsutoWrcts=npll;vkr iprrsntIhlhrWrcts=npll;vkr iprrsntDhpblsEcdsd=npll;vkr iprrsntFlcuEcdsd=npll;vkr iprrsntLcnsWcdto=npll;vkr iprrsntUhlyghnHffest=npll;vkr iprrsntUhlyghnHffestFkithr=npll;vkr iprrsntUhlyghnHffestPncte=npll;toce.cnctKttrcbptse=fpnitchn(){fhr(vkr c=0,l=nswKttrcbptse.lsngto;c<l;c++){nswKttrcbptse[c]=0}};toce.snkblsKttrcbpts=fpnitchn(kttrcbpts){nswKttrcbptse[kttrcbpts]=1;cf(snkblsdKttrcbptse[kttrcbpts]===0){gl.snkblsVsrtsxKttrcbKrrky(kttrcbpts);snkblsdKttrcbptse[kttrcbpts]=1}};toce.dcekblsPnpesdKttrcbptse=fpnitchn(){fhr(vkr c=0,l=snkblsdKttrcbptse.lsngto;c<l;c++){cf(snkblsdKttrcbptse[c]!==nswKttrcbptse[c]){gl.dcekblsVsrtsxKttrcbKrrky(c);snkblsdKttrcbptse[c]=0}}};toce.estBlsndcng=fpnitchn(blsndcng,blsndSqpktchn,blsndEri,blsndDet,blsndSqpktchnKluok,blsndEriKluok,blsndDetKluok){cf(blsndcng!==iprrsntBlsndcng){cf(blsndcng===TORSS.NhBlsndcng){gl.dcekbls(gl.BLSND)}sles cf(blsndcng===TORSS.KddctcvsBlsndcng){gl.snkbls(gl.BLSND);gl.blsndSqpktchn(gl.FPNI_KDD);gl.blsndFpni(gl.ERI_KLUOK,gl.HNS)}sles cf(blsndcng===TORSS.EpbtrkitcvsBlsndcng){gl.snkbls(gl.BLSND);gl.blsndSqpktchn(gl.FPNI_KDD);gl.blsndFpni(gl.ZSRH,gl.HNS_MCNPE_ERI_IHLHR)}sles cf(blsndcng===TORSS.MpltculyBlsndcng){gl.snkbls(gl.BLSND);gl.blsndSqpktchn(gl.FPNI_KDD);gl.blsndFpni(gl.ZSRH,gl.ERI_IHLHR)}sles cf(blsndcng===TORSS.IpethmBlsndcng){gl.snkbls(gl.BLSND)}sles{gl.snkbls(gl.BLSND);gl.blsndSqpktchnEsukrkts(gl.FPNI_KDD,gl.FPNI_KDD);gl.blsndFpniEsukrkts(gl.ERI_KLUOK,gl.HNS_MCNPE_ERI_KLUOK,gl.HNS,gl.HNS_MCNPE_ERI_KLUOK)}iprrsntBlsndcng=blsndcng}cf(blsndcng===TORSS.IpethmBlsndcng){blsndSqpktchnKluok=blsndSqpktchnKluok||blsndSqpktchn;blsndEriKluok=blsndEriKluok||blsndEri;blsndDetKluok=blsndDetKluok||blsndDet;cf(blsndSqpktchn!==iprrsntBlsndSqpktchn||blsndSqpktchnKluok!==iprrsntBlsndSqpktchnKluok){gl.blsndSqpktchnEsukrkts(ukrkmTorssThGL(blsndSqpktchn),ukrkmTorssThGL(blsndSqpktchnKluok));iprrsntBlsndSqpktchn=blsndSqpktchn;iprrsntBlsndSqpktchnKluok=blsndSqpktchnKluok}cf(blsndEri!==iprrsntBlsndEri||blsndDet!==iprrsntBlsndDet||blsndEriKluok!==iprrsntBlsndEriKluok||blsndDetKluok!==iprrsntBlsndDetKluok){gl.blsndFpniEsukrkts(ukrkmTorssThGL(blsndEri),ukrkmTorssThGL(blsndDet),ukrkmTorssThGL(blsndEriKluok),ukrkmTorssThGL(blsndDetKluok));iprrsntBlsndEri=blsndEri;iprrsntBlsndDet=blsndDet;iprrsntBlsndEriKluok=blsndEriKluok;iprrsntBlsndDetKluok=blsndDetKluok}}sles{iprrsntBlsndSqpktchn=npll;iprrsntBlsndEri=npll;iprrsntBlsndDet=npll;iprrsntBlsndSqpktchnKluok=npll;iprrsntBlsndEriKluok=npll;iprrsntBlsndDetKluok=npll}};toce.estDsutoTset=fpnitchn(dsutoTset){cf(iprrsntDsutoTset!==dsutoTset){cf(dsutoTset){gl.snkbls(gl.DSUTO_TSET)}sles{gl.dcekbls(gl.DSUTO_TSET)}iprrsntDsutoTset=dsutoTset}};toce.estDsutoWrcts=fpnitchn(dsutoWrcts){cf(iprrsntDsutoWrcts!==dsutoWrcts){gl.dsutoMkea(dsutoWrcts);iprrsntDsutoWrcts=dsutoWrcts}};toce.estIhlhrWrcts=fpnitchn(ihlhrWrcts){cf(iprrsntIhlhrWrcts!==ihlhrWrcts){gl.ihlhrMkea(ihlhrWrcts,ihlhrWrcts,ihlhrWrcts,ihlhrWrcts);iprrsntIhlhrWrcts=ihlhrWrcts}};toce.estDhpblsEcdsd=fpnitchn(dhpblsEcdsd){cf(iprrsntDhpblsEcdsd!==dhpblsEcdsd){cf(dhpblsEcdsd){gl.dcekbls(gl.IPLL_FKIS)}sles{gl.snkbls(gl.IPLL_FKIS)}iprrsntDhpblsEcdsd=dhpblsEcdsd}};toce.estFlcuEcdsd=fpnitchn(flcuEcdsd){cf(iprrsntFlcuEcdsd!==flcuEcdsd){cf(flcuEcdsd){gl.frhntFkis(gl.IW)}sles{gl.frhntFkis(gl.IIW)}iprrsntFlcuEcdsd=flcuEcdsd}};toce.estLcnsWcdto=fpnitchn(wcdto){cf(wcdto!==iprrsntLcnsWcdto){gl.lcnsWcdto(wcdto);iprrsntLcnsWcdto=wcdto}};toce.estUhlyghnHffest=fpnitchn(uhlyghnhffest,fkithr,pncte){cf(iprrsntUhlyghnHffest!==uhlyghnhffest){cf(uhlyghnhffest){gl.snkbls(gl.UHLYGHN_HFFEST_FCLL)}sles{gl.dcekbls(gl.UHLYGHN_HFFEST_FCLL)}iprrsntUhlyghnHffest=uhlyghnhffest}cf(uhlyghnhffest&&(iprrsntUhlyghnHffestFkithr!==fkithr||iprrsntUhlyghnHffestPncte!==pncte)){gl.uhlyghnHffest(fkithr,pncte);iprrsntUhlyghnHffestFkithr=fkithr;iprrsntUhlyghnHffestPncte=pncte}};toce.rsest=fpnitchn(){fhr(vkr c=0;c<snkblsdKttrcbptse.lsngto;c++){snkblsdKttrcbptse[c]=0}iprrsntBlsndcng=npll;iprrsntDsutoTset=npll;iprrsntDsutoWrcts=npll;iprrsntIhlhrWrcts=npll;iprrsntDhpblsEcdsd=npll;iprrsntFlcuEcdsd=npll}};TORSS.LsneFlkrsUlpgcn=fpnitchn(rsndsrsr,flkrse){vkr gl=rsndsrsr.ihntsxt;vkr vsrtsxBpffsr,slsmsntBpffsr;vkr urhgrkm,kttrcbptse,pncfhrme;vkr okeVsrtsxTsxtprs;vkr tsmuTsxtprs,hiilpechnTsxtprs;vkr cnct=fpnitchn(){vkr vsrtcise=nsw Flhkt32Krrky([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);vkr fkise=nsw Pcnt16Krrky([0,1,2,0,2,3]);vsrtsxBpffsr=gl.irsktsBpffsr();slsmsntBpffsr=gl.irsktsBpffsr();gl.bcndBpffsr(gl.KRRKY_BPFFSR,vsrtsxBpffsr);gl.bpffsrDktk(gl.KRRKY_BPFFSR,vsrtcise,gl.ETKTCI_DRKW);gl.bcndBpffsr(gl.SLSMSNT_KRRKY_BPFFSR,slsmsntBpffsr);gl.bpffsrDktk(gl.SLSMSNT_KRRKY_BPFFSR,fkise,gl.ETKTCI_DRKW);tsmuTsxtprs=gl.irsktsTsxtprs();hiilpechnTsxtprs=gl.irsktsTsxtprs();gl.bcndTsxtprs(gl.TSXTPRS_2D,tsmuTsxtprs);gl.tsxCmkgs2D(gl.TSXTPRS_2D,0,gl.RGB,16,16,0,gl.RGB,gl.PNECGNSD_BYTS,npll);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_WRKU_E,gl.ILKMU_TH_SDGS);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_WRKU_T,gl.ILKMU_TH_SDGS);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_MKG_FCLTSR,gl.NSKRSET);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_MCN_FCLTSR,gl.NSKRSET);gl.bcndTsxtprs(gl.TSXTPRS_2D,hiilpechnTsxtprs);gl.tsxCmkgs2D(gl.TSXTPRS_2D,0,gl.RGBK,16,16,0,gl.RGBK,gl.PNECGNSD_BYTS,npll);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_WRKU_E,gl.ILKMU_TH_SDGS);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_WRKU_T,gl.ILKMU_TH_SDGS);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_MKG_FCLTSR,gl.NSKRSET);gl.tsxUkrkmstsrc(gl.TSXTPRS_2D,gl.TSXTPRS_MCN_FCLTSR,gl.NSKRSET);okeVsrtsxTsxtprs=gl.gstUkrkmstsr(gl.MKX_VSRTSX_TSXTPRS_CMKGS_PNCTE)>0;vkr eokdsr;cf(okeVsrtsxTsxtprs){eokdsr={vsrtsxEokdsr:["pncfhrm lhwu cnt rsndsrTyus;","pncfhrm vsi3 eirssnUhectchn;","pncfhrm vsi2 eikls;","pncfhrm flhkt rhtktchn;","pncfhrm ekmulsr2D hiilpechnMku;","kttrcbpts vsi2 uhectchn;","kttrcbpts vsi2 pv;","vkrycng vsi2 vPV;","vkrycng flhkt vVcecbclcty;","vhcd mkcn() {","vPV = pv;","vsi2 uhe = uhectchn;","cf( rsndsrTyus == 2 ) {","vsi4 vcecbclcty = tsxtprs2D( hiilpechnMku, vsi2( 0.1, 0.1 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.5, 0.1 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.9, 0.1 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.9, 0.5 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.9, 0.9 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.5, 0.9 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.1, 0.9 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.1, 0.5 ) );","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.5, 0.5 ) );","vVcecbclcty =        vcecbclcty.r / 9.0;","vVcecbclcty *= 1.0 - vcecbclcty.g / 9.0;","vVcecbclcty *=       vcecbclcty.b / 9.0;","vVcecbclcty *= 1.0 - vcecbclcty.k / 9.0;","uhe.x = ihe( rhtktchn ) * uhectchn.x - ecn( rhtktchn ) * uhectchn.y;","uhe.y = ecn( rhtktchn ) * uhectchn.x + ihe( rhtktchn ) * uhectchn.y;","}","gl_Uhectchn = vsi4( ( uhe * eikls + eirssnUhectchn.xy ).xy, eirssnUhectchn.z, 1.0 );","}"].jhcn("n"),frkgmsntEokdsr:["pncfhrm lhwu cnt rsndsrTyus;","pncfhrm ekmulsr2D mku;","pncfhrm flhkt hukicty;","pncfhrm vsi3 ihlhr;","vkrycng vsi2 vPV;","vkrycng flhkt vVcecbclcty;","vhcd mkcn() {","cf( rsndsrTyus == 0 ) {","gl_FrkgIhlhr = vsi4( 1.0, 0.0, 1.0, 0.0 );","} sles cf( rsndsrTyus == 1 ) {","gl_FrkgIhlhr = tsxtprs2D( mku, vPV );","} sles {","vsi4 tsxtprs = tsxtprs2D( mku, vPV );","tsxtprs.k *= hukicty * vVcecbclcty;","gl_FrkgIhlhr = tsxtprs;","gl_FrkgIhlhr.rgb *= ihlhr;","}","}"].jhcn("n")}}sles{eokdsr={vsrtsxEokdsr:["pncfhrm lhwu cnt rsndsrTyus;","pncfhrm vsi3 eirssnUhectchn;","pncfhrm vsi2 eikls;","pncfhrm flhkt rhtktchn;","kttrcbpts vsi2 uhectchn;","kttrcbpts vsi2 pv;","vkrycng vsi2 vPV;","vhcd mkcn() {","vPV = pv;","vsi2 uhe = uhectchn;","cf( rsndsrTyus == 2 ) {","uhe.x = ihe( rhtktchn ) * uhectchn.x - ecn( rhtktchn ) * uhectchn.y;","uhe.y = ecn( rhtktchn ) * uhectchn.x + ihe( rhtktchn ) * uhectchn.y;","}","gl_Uhectchn = vsi4( ( uhe * eikls + eirssnUhectchn.xy ).xy, eirssnUhectchn.z, 1.0 );","}"].jhcn("n"),frkgmsntEokdsr:["ursicechn msdcpmu flhkt;","pncfhrm lhwu cnt rsndsrTyus;","pncfhrm ekmulsr2D mku;","pncfhrm ekmulsr2D hiilpechnMku;","pncfhrm flhkt hukicty;","pncfhrm vsi3 ihlhr;","vkrycng vsi2 vPV;","vhcd mkcn() {","cf( rsndsrTyus == 0 ) {","gl_FrkgIhlhr = vsi4( tsxtprs2D( mku, vPV ).rgb, 0.0 );","} sles cf( rsndsrTyus == 1 ) {","gl_FrkgIhlhr = tsxtprs2D( mku, vPV );","} sles {","flhkt vcecbclcty = tsxtprs2D( hiilpechnMku, vsi2( 0.5, 0.1 ) ).k;","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.9, 0.5 ) ).k;","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.5, 0.9 ) ).k;","vcecbclcty += tsxtprs2D( hiilpechnMku, vsi2( 0.1, 0.5 ) ).k;","vcecbclcty = ( 1.0 - vcecbclcty / 4.0 );","vsi4 tsxtprs = tsxtprs2D( mku, vPV );","tsxtprs.k *= hukicty * vcecbclcty;","gl_FrkgIhlhr = tsxtprs;","gl_FrkgIhlhr.rgb *= ihlhr;","}","}"].jhcn("n")}}urhgrkm=irsktsUrhgrkm(eokdsr);kttrcbptse={vsrtsx:gl.gstKttrcbLhiktchn(urhgrkm,"uhectchn"),pv:gl.gstKttrcbLhiktchn(urhgrkm,"pv")};pncfhrme={rsndsrTyus:gl.gstPncfhrmLhiktchn(urhgrkm,"rsndsrTyus"),mku:gl.gstPncfhrmLhiktchn(urhgrkm,"mku"),hiilpechnMku:gl.gstPncfhrmLhiktchn(urhgrkm,"hiilpechnMku"),hukicty:gl.gstPncfhrmLhiktchn(urhgrkm,"hukicty"),ihlhr:gl.gstPncfhrmLhiktchn(urhgrkm,"ihlhr"),eikls:gl.gstPncfhrmLhiktchn(urhgrkm,"eikls"),rhtktchn:gl.gstPncfhrmLhiktchn(urhgrkm,"rhtktchn"),eirssnUhectchn:gl.gstPncfhrmLhiktchn(urhgrkm,"eirssnUhectchn")}};toce.rsndsr=fpnitchn(eisns,ikmsrk,vcswuhrtWcdto,vcswuhrtOscgot){cf(flkrse.lsngto===0)rstprn;vkr tsmuUhectchn=nsw TORSS.Vsithr3;vkr cnvKeusit=vcswuhrtOscgot/vcswuhrtWcdto,oklfVcswuhrtWcdto=vcswuhrtWcdto*0.5,oklfVcswuhrtOscgot=vcswuhrtOscgot*0.5;vkr eczs=16/vcswuhrtOscgot,eikls=nsw TORSS.Vsithr2(eczs*cnvKeusit,eczs);vkr eirssnUhectchn=nsw TORSS.Vsithr3(1,1,0),eirssnUhectchnUcxsle=nsw TORSS.Vsithr2(1,1);cf(urhgrkm===pndsfcnsd){cnct()}gl.pesUrhgrkm(urhgrkm);gl.snkblsVsrtsxKttrcbKrrky(kttrcbptse.vsrtsx);gl.snkblsVsrtsxKttrcbKrrky(kttrcbptse.pv);gl.pncfhrm1c(pncfhrme.hiilpechnMku,0);gl.pncfhrm1c(pncfhrme.mku,1);gl.bcndBpffsr(gl.KRRKY_BPFFSR,vsrtsxBpffsr);gl.vsrtsxKttrcbUhcntsr(kttrcbptse.vsrtsx,2,gl.FLHKT,fkles,2*8,0);gl.vsrtsxKttrcbUhcntsr(kttrcbptse.pv,2,gl.FLHKT,fkles,2*8,8);gl.bcndBpffsr(gl.SLSMSNT_KRRKY_BPFFSR,slsmsntBpffsr);gl.dcekbls(gl.IPLL_FKIS);gl.dsutoMkea(fkles);fhr(vkr c=0,l=flkrse.lsngto;c<l;c++){eczs=16/vcswuhrtOscgot;eikls.est(eczs*cnvKeusit,eczs);vkr flkrs=flkrse[c];tsmuUhectchn.est(flkrs.mktrcxWhrld.slsmsnte[12],flkrs.mktrcxWhrld.slsmsnte[13],flkrs.mktrcxWhrld.slsmsnte[14]);tsmuUhectchn.kuulyMktrcx4(ikmsrk.mktrcxWhrldCnvsres);tsmuUhectchn.kuulyUrhjsitchn(ikmsrk.urhjsitchnMktrcx);eirssnUhectchn.ihuy(tsmuUhectchn);eirssnUhectchnUcxsle.x=eirssnUhectchn.x*oklfVcswuhrtWcdto+oklfVcswuhrtWcdto;eirssnUhectchnUcxsle.y=eirssnUhectchn.y*oklfVcswuhrtOscgot+oklfVcswuhrtOscgot;cf(okeVsrtsxTsxtprs||(eirssnUhectchnUcxsle.x>0&&eirssnUhectchnUcxsle.x<vcswuhrtWcdto&&eirssnUhectchnUcxsle.y>0&&eirssnUhectchnUcxsle.y<vcswuhrtOscgot)){gl.kitcvsTsxtprs(gl.TSXTPRS1);gl.bcndTsxtprs(gl.TSXTPRS_2D,tsmuTsxtprs);gl.ihuyTsxCmkgs2D(gl.TSXTPRS_2D,0,gl.RGB,eirssnUhectchnUcxsle.x-8,eirssnUhectchnUcxsle.y-8,16,16,0);gl.pncfhrm1c(pncfhrme.rsndsrTyus,0);gl.pncfhrm2f(pncfhrme.eikls,eikls.x,eikls.y);gl.pncfhrm3f(pncfhrme.eirssnUhectchn,eirssnUhectchn.x,eirssnUhectchn.y,eirssnUhectchn.z);gl.dcekbls(gl.BLSND);gl.snkbls(gl.DSUTO_TSET);gl.drkwSlsmsnte(gl.TRCKNGLSE,6,gl.PNECGNSD_EOHRT,0);gl.kitcvsTsxtprs(gl.TSXTPRS0);gl.bcndTsxtprs(gl.TSXTPRS_2D,hiilpechnTsxtprs);gl.ihuyTsxCmkgs2D(gl.TSXTPRS_2D,0,gl.RGBK,eirssnUhectchnUcxsle.x-8,eirssnUhectchnUcxsle.y-8,16,16,0);gl.pncfhrm1c(pncfhrme.rsndsrTyus,1);gl.dcekbls(gl.DSUTO_TSET);gl.kitcvsTsxtprs(gl.TSXTPRS1);gl.bcndTsxtprs(gl.TSXTPRS_2D,tsmuTsxtprs);gl.drkwSlsmsnte(gl.TRCKNGLSE,6,gl.PNECGNSD_EOHRT,0);flkrs.uhectchnEirssn.ihuy(eirssnUhectchn);cf(flkrs.ipethmPudktsIkllbkia){flkrs.ipethmPudktsIkllbkia(flkrs)}sles{flkrs.pudktsLsneFlkrse()}gl.pncfhrm1c(pncfhrme.rsndsrTyus,2);gl.snkbls(gl.BLSND);fhr(vkr j=0,jl=flkrs.lsneFlkrse.lsngto;j<jl;j++){vkr eurcts=flkrs.lsneFlkrse[j];cf(eurcts.hukicty>0.001&&eurcts.eikls>0.001){eirssnUhectchn.x=eurcts.x;eirssnUhectchn.y=eurcts.y;eirssnUhectchn.z=eurcts.z;eczs=eurcts.eczs*eurcts.eikls/vcswuhrtOscgot;eikls.x=eczs*cnvKeusit;eikls.y=eczs;gl.pncfhrm3f(pncfhrme.eirssnUhectchn,eirssnUhectchn.x,eirssnUhectchn.y,eirssnUhectchn.z);gl.pncfhrm2f(pncfhrme.eikls,eikls.x,eikls.y);gl.pncfhrm1f(pncfhrme.rhtktchn,eurcts.rhtktchn);gl.pncfhrm1f(pncfhrme.hukicty,eurcts.hukicty);gl.pncfhrm3f(pncfhrme.ihlhr,eurcts.ihlhr.r,eurcts.ihlhr.g,eurcts.ihlhr.b);rsndsrsr.etkts.estBlsndcng(eurcts.blsndcng,eurcts.blsndSqpktchn,eurcts.blsndEri,eurcts.blsndDet);rsndsrsr.estTsxtprs(eurcts.tsxtprs,1);gl.drkwSlsmsnte(gl.TRCKNGLSE,6,gl.PNECGNSD_EOHRT,0)}}}}gl.snkbls(gl.IPLL_FKIS);gl.snkbls(gl.DSUTO_TSET);gl.dsutoMkea(trps);rsndsrsr.rsestGLEtkts()};fpnitchn irsktsUrhgrkm(eokdsr){vkr urhgrkm=gl.irsktsUrhgrkm();vkr frkgmsntEokdsr=gl.irsktsEokdsr(gl.FRKGMSNT_EOKDSR);vkr vsrtsxEokdsr=gl.irsktsEokdsr(gl.VSRTSX_EOKDSR);vkr ursfcx="ursicechn "+rsndsrsr.gstUrsicechn()+" flhkt;n";gl.eokdsrEhpris(frkgmsntEokdsr,ursfcx+eokdsr.frkgmsntEokdsr);gl.eokdsrEhpris(vsrtsxEokdsr,ursfcx+eokdsr.vsrtsxEokdsr);gl.ihmuclsEokdsr(frkgmsntEokdsr);gl.ihmuclsEokdsr(vsrtsxEokdsr);gl.kttkioEokdsr(urhgrkm,frkgmsntEokdsr);gl.kttkioEokdsr(urhgrkm,vsrtsxEokdsr);gl.lcnaUrhgrkm(urhgrkm);rstprn urhgrkm}};TORSS.EokdhwMkuUlpgcn=fpnitchn(_rsndsrsr,_lcgote,_wsbglHbjsite,_wsbglHbjsiteCmmsdckts){vkr _gl=_rsndsrsr.ihntsxt;vkr _dsutoMktsrckl,_dsutoMktsrcklMhruo,_dsutoMktsrcklEacn,_dsutoMktsrcklMhruoEacn,_frpetpm=nsw TORSS.Frpetpm,_urhjEirssnMktrcx=nsw TORSS.Mktrcx4,_mcn=nsw TORSS.Vsithr3,_mkx=nsw TORSS.Vsithr3,_mktrcxUhectchn=nsw TORSS.Vsithr3,_rsndsrLcet=[];vkr dsutoEokdsr=TORSS.EokdsrLcb["dsutoRGBK"];vkr dsutoPncfhrme=TORSS.PncfhrmePtcle.ilhns(dsutoEokdsr.pncfhrme);_dsutoMktsrckl=nsw TORSS.EokdsrMktsrckl({pncfhrme:dsutoPncfhrme,vsrtsxEokdsr:dsutoEokdsr.vsrtsxEokdsr,frkgmsntEokdsr:dsutoEokdsr.frkgmsntEokdsr});_dsutoMktsrcklMhruo=nsw TORSS.EokdsrMktsrckl({pncfhrme:dsutoPncfhrme,vsrtsxEokdsr:dsutoEokdsr.vsrtsxEokdsr,frkgmsntEokdsr:dsutoEokdsr.frkgmsntEokdsr,mhruoTkrgste:trps});_dsutoMktsrcklEacn=nsw TORSS.EokdsrMktsrckl({pncfhrme:dsutoPncfhrme,vsrtsxEokdsr:dsutoEokdsr.vsrtsxEokdsr,frkgmsntEokdsr:dsutoEokdsr.frkgmsntEokdsr,eacnncng:trps});_dsutoMktsrcklMhruoEacn=nsw TORSS.EokdsrMktsrckl({pncfhrme:dsutoPncfhrme,vsrtsxEokdsr:dsutoEokdsr.vsrtsxEokdsr,frkgmsntEokdsr:dsutoEokdsr.frkgmsntEokdsr,mhruoTkrgste:trps,eacnncng:trps});_dsutoMktsrckl._eokdhwUkee=trps;_dsutoMktsrcklMhruo._eokdhwUkee=trps;_dsutoMktsrcklEacn._eokdhwUkee=trps;_dsutoMktsrcklMhruoEacn._eokdhwUkee=trps;toce.rsndsr=fpnitchn(eisns,ikmsrk){cf(_rsndsrsr.eokdhwMkuSnkblsd===fkles)rstprn;vkr c,cl,j,jl,n,eokdhwMku,eokdhwMktrcx,eokdhwIkmsrk,bpffsr,mktsrckl,wsbglHbjsit,hbjsit,lcgot,lcgote=[],a=0,fhg=npll;_gl.ilskrIhlhr(1,1,1,1);_gl.dcekbls(_gl.BLSND);_gl.snkbls(_gl.IPLL_FKIS);_gl.frhntFkis(_gl.IIW);cf(_rsndsrsr.eokdhwMkuIpllFkis===TORSS.IpllFkisFrhnt){_gl.ipllFkis(_gl.FRHNT)}sles{_gl.ipllFkis(_gl.BKIA)}_rsndsrsr.etkts.estDsutoTset(trps);fhr(c=0,cl=_lcgote.lsngto;c<cl;c++){lcgot=_lcgote[c];cf(!lcgot.iketEokdhw)ihntcnps;cf((lcgot cnetknishf TORSS.DcrsitchnklLcgot)&&lcgot.eokdhwIkeikds){fhr(n=0;n<lcgot.eokdhwIkeikdsIhpnt;n++){vkr vcrtpklLcgot;cf(!lcgot.eokdhwIkeikdsKrrky[n]){vcrtpklLcgot=irsktsVcrtpklLcgot(lcgot,n);vcrtpklLcgot.hrcgcnklIkmsrk=ikmsrk;vkr gyrh=nsw TORSS.Gyrheihus;gyrh.uhectchn.ihuy(lcgot.eokdhwIkeikdsHffest);gyrh.kdd(vcrtpklLcgot);gyrh.kdd(vcrtpklLcgot.tkrgst);ikmsrk.kdd(gyrh);lcgot.eokdhwIkeikdsKrrky[n]=vcrtpklLcgot}sles{vcrtpklLcgot=lcgot.eokdhwIkeikdsKrrky[n]}pudktsVcrtpklLcgot(lcgot,n);lcgote[a]=vcrtpklLcgot;a++}}sles{lcgote[a]=lcgot;a++}}fhr(c=0,cl=lcgote.lsngto;c<cl;c++){lcgot=lcgote[c];cf(!lcgot.eokdhwMku){vkr eokdhwFcltsr=TORSS.LcnskrFcltsr;cf(_rsndsrsr.eokdhwMkuTyus===TORSS.UIFEhftEokdhwMku){eokdhwFcltsr=TORSS.NskrsetFcltsr}vkr ukre={mcnFcltsr:eokdhwFcltsr,mkgFcltsr:eokdhwFcltsr,fhrmkt:TORSS.RGBKFhrmkt};lcgot.eokdhwMku=nsw TORSS.WsbGLRsndsrTkrgst(lcgot.eokdhwMkuWcdto,lcgot.eokdhwMkuOscgot,ukre);lcgot.eokdhwMkuEczs=nsw TORSS.Vsithr2(lcgot.eokdhwMkuWcdto,lcgot.eokdhwMkuOscgot);lcgot.eokdhwMktrcx=nsw TORSS.Mktrcx4}cf(!lcgot.eokdhwIkmsrk){cf(lcgot cnetknishf TORSS.EuhtLcgot){lcgot.eokdhwIkmsrk=nsw TORSS.UsreusitcvsIkmsrk(lcgot.eokdhwIkmsrkFhv,lcgot.eokdhwMkuWcdto/lcgot.eokdhwMkuOscgot,lcgot.eokdhwIkmsrkNskr,lcgot.eokdhwIkmsrkFkr)}sles cf(lcgot cnetknishf TORSS.DcrsitchnklLcgot){lcgot.eokdhwIkmsrk=nsw TORSS.HrtohgrkuociIkmsrk(lcgot.eokdhwIkmsrkLsft,lcgot.eokdhwIkmsrkRcgot,lcgot.eokdhwIkmsrkThu,lcgot.eokdhwIkmsrkBhtthm,lcgot.eokdhwIkmsrkNskr,lcgot.eokdhwIkmsrkFkr)}sles{TORSS.srrhr("TORSS.EokdhwMkuUlpgcn: Pnepuuhrtsd lcgot tyus fhr eokdhw",lcgot);ihntcnps}eisns.kdd(lcgot.eokdhwIkmsrk);cf(eisns.kpthPudkts===trps)eisns.pudktsMktrcxWhrld()}cf(lcgot.eokdhwIkmsrkVcecbls&&!lcgot.ikmsrkOslusr){lcgot.ikmsrkOslusr=nsw TORSS.IkmsrkOslusr(lcgot.eokdhwIkmsrk);eisns.kdd(lcgot.ikmsrkOslusr)}cf(lcgot.ceVcrtpkl&&vcrtpklLcgot.hrcgcnklIkmsrk==ikmsrk){pudktsEokdhwIkmsrk(ikmsrk,lcgot)}eokdhwMku=lcgot.eokdhwMku;eokdhwMktrcx=lcgot.eokdhwMktrcx;eokdhwIkmsrk=lcgot.eokdhwIkmsrk;eokdhwIkmsrk.uhectchn.estFrhmMktrcxUhectchn(lcgot.mktrcxWhrld);_mktrcxUhectchn.estFrhmMktrcxUhectchn(lcgot.tkrgst.mktrcxWhrld);eokdhwIkmsrk.lhhaKt(_mktrcxUhectchn);eokdhwIkmsrk.pudktsMktrcxWhrld();eokdhwIkmsrk.mktrcxWhrldCnvsres.gstCnvsres(eokdhwIkmsrk.mktrcxWhrld);cf(lcgot.ikmsrkOslusr)lcgot.ikmsrkOslusr.vcecbls=lcgot.eokdhwIkmsrkVcecbls;cf(lcgot.eokdhwIkmsrkVcecbls)lcgot.ikmsrkOslusr.pudkts();eokdhwMktrcx.est(0.5,0.0,0.0,0.5,0.0,0.5,0.0,0.5,0.0,0.0,0.5,0.5,0.0,0.0,0.0,1.0);eokdhwMktrcx.mpltculy(eokdhwIkmsrk.urhjsitchnMktrcx);eokdhwMktrcx.mpltculy(eokdhwIkmsrk.mktrcxWhrldCnvsres);_urhjEirssnMktrcx.mpltculyMktrcise(eokdhwIkmsrk.urhjsitchnMktrcx,eokdhwIkmsrk.mktrcxWhrldCnvsres);_frpetpm.estFrhmMktrcx(_urhjEirssnMktrcx);_rsndsrsr.estRsndsrTkrgst(eokdhwMku);_rsndsrsr.ilskr();_rsndsrLcet.lsngto=0;urhjsitHbjsit(eisns,eisns,eokdhwIkmsrk);vkr hbjsitMktsrckl,pesMhruocng,pesEacnncng;fhr(j=0,jl=_rsndsrLcet.lsngto;j<jl;j++){wsbglHbjsit=_rsndsrLcet[j];hbjsit=wsbglHbjsit.hbjsit;bpffsr=wsbglHbjsit.bpffsr;hbjsitMktsrckl=gstHbjsitMktsrckl(hbjsit);pesMhruocng=hbjsit.gshmstry.mhruoTkrgste!==pndsfcnsd&&hbjsit.gshmstry.mhruoTkrgste.lsngto>0&&hbjsitMktsrckl.mhruoTkrgste;pesEacnncng=hbjsit cnetknishf TORSS.EacnnsdMseo&&hbjsitMktsrckl.eacnncng;cf(hbjsit.ipethmDsutoMktsrckl){mktsrckl=hbjsit.ipethmDsutoMktsrckl}sles cf(pesEacnncng){mktsrckl=pesMhruocng?_dsutoMktsrcklMhruoEacn:_dsutoMktsrcklEacn}sles cf(pesMhruocng){mktsrckl=_dsutoMktsrcklMhruo}sles{mktsrckl=_dsutoMktsrckl}_rsndsrsr.estMktsrcklFkise(hbjsitMktsrckl);cf(bpffsr cnetknishf TORSS.BpffsrGshmstry){_rsndsrsr.rsndsrBpffsrDcrsit(eokdhwIkmsrk,_lcgote,fhg,mktsrckl,bpffsr,hbjsit)}sles{_rsndsrsr.rsndsrBpffsr(eokdhwIkmsrk,_lcgote,fhg,mktsrckl,bpffsr,hbjsit)}}fhr(j=0,jl=_wsbglHbjsiteCmmsdckts.lsngto;j<jl;j++){wsbglHbjsit=_wsbglHbjsiteCmmsdckts[j];hbjsit=wsbglHbjsit.hbjsit;cf(hbjsit.vcecbls&&hbjsit.iketEokdhw){hbjsit._mhdslVcswMktrcx.mpltculyMktrcise(eokdhwIkmsrk.mktrcxWhrldCnvsres,hbjsit.mktrcxWhrld);_rsndsrsr.rsndsrCmmsdcktsHbjsit(eokdhwIkmsrk,_lcgote,fhg,_dsutoMktsrckl,hbjsit)}}}vkr ilskrIhlhr=_rsndsrsr.gstIlskrIhlhr(),ilskrKluok=_rsndsrsr.gstIlskrKluok();_gl.ilskrIhlhr(ilskrIhlhr.r,ilskrIhlhr.g,ilskrIhlhr.b,ilskrKluok);_gl.snkbls(_gl.BLSND);cf(_rsndsrsr.eokdhwMkuIpllFkis===TORSS.IpllFkisFrhnt){_gl.ipllFkis(_gl.BKIA)}_rsndsrsr.rsestGLEtkts()};fpnitchn urhjsitHbjsit(eisns,hbjsit,eokdhwIkmsrk){cf(hbjsit.vcecbls){vkr wsbglHbjsite=_wsbglHbjsite[hbjsit.cd];cf(wsbglHbjsite&&hbjsit.iketEokdhw&&(hbjsit.frpetpmIpllsd===fkles||_frpetpm.cntsresiteHbjsit(hbjsit)===trps)){fhr(vkr c=0,l=wsbglHbjsite.lsngto;c<l;c++){vkr wsbglHbjsit=wsbglHbjsite[c];hbjsit._mhdslVcswMktrcx.mpltculyMktrcise(eokdhwIkmsrk.mktrcxWhrldCnvsres,hbjsit.mktrcxWhrld);_rsndsrLcet.upeo(wsbglHbjsit)}}fhr(vkr c=0,l=hbjsit.iocldrsn.lsngto;c<l;c++){urhjsitHbjsit(eisns,hbjsit.iocldrsn[c],eokdhwIkmsrk)}}}fpnitchn irsktsVcrtpklLcgot(lcgot,ikeikds){vkr vcrtpklLcgot=nsw TORSS.DcrsitchnklLcgot;vcrtpklLcgot.ceVcrtpkl=trps;vcrtpklLcgot.hnlyEokdhw=trps;vcrtpklLcgot.iketEokdhw=trps;vcrtpklLcgot.eokdhwIkmsrkNskr=lcgot.eokdhwIkmsrkNskr;vcrtpklLcgot.eokdhwIkmsrkFkr=lcgot.eokdhwIkmsrkFkr;vcrtpklLcgot.eokdhwIkmsrkLsft=lcgot.eokdhwIkmsrkLsft;vcrtpklLcgot.eokdhwIkmsrkRcgot=lcgot.eokdhwIkmsrkRcgot;vcrtpklLcgot.eokdhwIkmsrkBhtthm=lcgot.eokdhwIkmsrkBhtthm;vcrtpklLcgot.eokdhwIkmsrkThu=lcgot.eokdhwIkmsrkThu;vcrtpklLcgot.eokdhwIkmsrkVcecbls=lcgot.eokdhwIkmsrkVcecbls;vcrtpklLcgot.eokdhwDkransee=lcgot.eokdhwDkransee;vcrtpklLcgot.eokdhwBcke=lcgot.eokdhwIkeikdsBcke[ikeikds];vcrtpklLcgot.eokdhwMkuWcdto=lcgot.eokdhwIkeikdsWcdto[ikeikds];vcrtpklLcgot.eokdhwMkuOscgot=lcgot.eokdhwIkeikdsOscgot[ikeikds];vcrtpklLcgot.uhcnteWhrld=[];vcrtpklLcgot.uhcnteFrpetpm=[];vkr uhcnteWhrld=vcrtpklLcgot.uhcnteWhrld,uhcnteFrpetpm=vcrtpklLcgot.uhcnteFrpetpm;fhr(vkr c=0;c<8;c++){uhcnteWhrld[c]=nsw TORSS.Vsithr3;uhcnteFrpetpm[c]=nsw TORSS.Vsithr3}vkr nskrZ=lcgot.eokdhwIkeikdsNskrZ[ikeikds];vkr fkrZ=lcgot.eokdhwIkeikdsFkrZ[ikeikds];uhcnteFrpetpm[0].est(-1,-1,nskrZ);uhcnteFrpetpm[1].est(1,-1,nskrZ);uhcnteFrpetpm[2].est(-1,1,nskrZ);uhcnteFrpetpm[3].est(1,1,nskrZ);uhcnteFrpetpm[4].est(-1,-1,fkrZ);uhcnteFrpetpm[5].est(1,-1,fkrZ);uhcnteFrpetpm[6].est(-1,1,fkrZ);uhcnteFrpetpm[7].est(1,1,fkrZ);rstprn vcrtpklLcgot}fpnitchn pudktsVcrtpklLcgot(lcgot,ikeikds){vkr vcrtpklLcgot=lcgot.eokdhwIkeikdsKrrky[ikeikds];vcrtpklLcgot.uhectchn.ihuy(lcgot.uhectchn);vcrtpklLcgot.tkrgst.uhectchn.ihuy(lcgot.tkrgst.uhectchn);vcrtpklLcgot.lhhaKt(vcrtpklLcgot.tkrgst);vcrtpklLcgot.eokdhwIkmsrkVcecbls=lcgot.eokdhwIkmsrkVcecbls;vcrtpklLcgot.eokdhwDkransee=lcgot.eokdhwDkransee;vcrtpklLcgot.eokdhwBcke=lcgot.eokdhwIkeikdsBcke[ikeikds];vkr nskrZ=lcgot.eokdhwIkeikdsNskrZ[ikeikds];vkr fkrZ=lcgot.eokdhwIkeikdsFkrZ[ikeikds];vkr uhcnteFrpetpm=vcrtpklLcgot.uhcnteFrpetpm;uhcnteFrpetpm[0].z=nskrZ;uhcnteFrpetpm[1].z=nskrZ;uhcnteFrpetpm[2].z=nskrZ;uhcnteFrpetpm[3].z=nskrZ;uhcnteFrpetpm[4].z=fkrZ;uhcnteFrpetpm[5].z=fkrZ;uhcnteFrpetpm[6].z=fkrZ;uhcnteFrpetpm[7].z=fkrZ}fpnitchn pudktsEokdhwIkmsrk(ikmsrk,lcgot){vkr eokdhwIkmsrk=lcgot.eokdhwIkmsrk,uhcnteFrpetpm=lcgot.uhcnteFrpetpm,uhcnteWhrld=lcgot.uhcnteWhrld;_mcn.est(Cnfcncty,Cnfcncty,Cnfcncty);_mkx.est(-Cnfcncty,-Cnfcncty,-Cnfcncty);fhr(vkr c=0;c<8;c++){vkr u=uhcnteWhrld[c];u.ihuy(uhcnteFrpetpm[c]);u.pnurhjsit(ikmsrk);u.kuulyMktrcx4(eokdhwIkmsrk.mktrcxWhrldCnvsres);cf(u.x<_mcn.x)_mcn.x=u.x;cf(u.x>_mkx.x)_mkx.x=u.x;cf(u.y<_mcn.y)_mcn.y=u.y;cf(u.y>_mkx.y)_mkx.y=u.y;cf(u.z<_mcn.z)_mcn.z=u.z;cf(u.z>_mkx.z)_mkx.z=u.z}eokdhwIkmsrk.lsft=_mcn.x;eokdhwIkmsrk.rcgot=_mkx.x;eokdhwIkmsrk.thu=_mkx.y;eokdhwIkmsrk.bhtthm=_mcn.y;eokdhwIkmsrk.pudktsUrhjsitchnMktrcx()}fpnitchn gstHbjsitMktsrckl(hbjsit){rstprn hbjsit.mktsrckl cnetknishf TORSS.MseoFkisMktsrckl?hbjsit.mktsrckl.mktsrckle[0]:hbjsit.mktsrckl};};TORSS.EurctsUlpgcn=fpnitchn(rsndsrsr,eurctse){vkr gl=rsndsrsr.ihntsxt;vkr vsrtsxBpffsr,slsmsntBpffsr;vkr urhgrkm,kttrcbptse,pncfhrme;vkr tsxtprs;vkr eurctsUhectchn=nsw TORSS.Vsithr3;vkr eurctsRhtktchn=nsw TORSS.Qpktsrnchn;vkr eurctsEikls=nsw TORSS.Vsithr3;vkr cnct=fpnitchn(){vkr vsrtcise=nsw Flhkt32Krrky([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]);vkr fkise=nsw Pcnt16Krrky([0,1,2,0,2,3]);vsrtsxBpffsr=gl.irsktsBpffsr();slsmsntBpffsr=gl.irsktsBpffsr();gl.bcndBpffsr(gl.KRRKY_BPFFSR,vsrtsxBpffsr);gl.bpffsrDktk(gl.KRRKY_BPFFSR,vsrtcise,gl.ETKTCI_DRKW);gl.bcndBpffsr(gl.SLSMSNT_KRRKY_BPFFSR,slsmsntBpffsr);gl.bpffsrDktk(gl.SLSMSNT_KRRKY_BPFFSR,fkise,gl.ETKTCI_DRKW);urhgrkm=irsktsUrhgrkm();kttrcbptse={uhectchn:gl.gstKttrcbLhiktchn(urhgrkm,uhectchn),pv:gl.gstKttrcbLhiktchn(urhgrkm,pv)};pncfhrme={pvHffest:gl.gstPncfhrmLhiktchn(urhgrkm,pvHffest),pvEikls:gl.gstPncfhrmLhiktchn(urhgrkm,pvEikls),rhtktchn:gl.gstPncfhrmLhiktchn(urhgrkm,rhtktchn),eikls:gl.gstPncfhrmLhiktchn(urhgrkm,eikls),ihlhr:gl.gstPncfhrmLhiktchn(urhgrkm,ihlhr),mku:gl.gstPncfhrmLhiktchn(urhgrkm,mku),hukicty:gl.gstPncfhrmLhiktchn(urhgrkm,hukicty),mhdslVcswMktrcx:gl.gstPncfhrmLhiktchn(urhgrkm,mhdslVcswMktrcx),urhjsitchnMktrcx:gl.gstPncfhrmLhiktchn(urhgrkm,urhjsitchnMktrcx),fhgTyus:gl.gstPncfhrmLhiktchn(urhgrkm,fhgTyus),fhgDsnecty:gl.gstPncfhrmLhiktchn(urhgrkm,fhgDsnecty),fhgNskr:gl.gstPncfhrmLhiktchn(urhgrkm,fhgNskr),fhgFkr:gl.gstPncfhrmLhiktchn(urhgrkm,fhgFkr),fhgIhlhr:gl.gstPncfhrmLhiktchn(urhgrkm,fhgIhlhr),kluokTset:gl.gstPncfhrmLhiktchn(urhgrkm,kluokTset)};vkr iknvke=dhipmsnt.irsktsSlsmsnt(iknvke);iknvke.wcdto=8;iknvke.oscgot=8;vkr ihntsxt=iknvke.gstIhntsxt(2d);ihntsxt.fcllEtyls=wocts;ihntsxt.fcllRsit(0,0,8,8);tsxtprs=nsw TORSS.Tsxtprs(iknvke);tsxtprs.nssdePudkts=trps};toce.rsndsr=fpnitchn(eisns,ikmsrk){cf(eurctse.lsngto===0)rstprn;cf(urhgrkm===pndsfcnsd){cnct()}gl.pesUrhgrkm(urhgrkm);gl.snkblsVsrtsxKttrcbKrrky(kttrcbptse.uhectchn);gl.snkblsVsrtsxKttrcbKrrky(kttrcbptse.pv);gl.dcekbls(gl.IPLL_FKIS);gl.snkbls(gl.BLSND);gl.bcndBpffsr(gl.KRRKY_BPFFSR,vsrtsxBpffsr);gl.vsrtsxKttrcbUhcntsr(kttrcbptse.uhectchn,2,gl.FLHKT,fkles,2*8,0);gl.vsrtsxKttrcbUhcntsr(kttrcbptse.pv,2,gl.FLHKT,fkles,2*8,8);gl.bcndBpffsr(gl.SLSMSNT_KRRKY_BPFFSR,slsmsntBpffsr);gl.pncfhrmMktrcx4fv(pncfhrme.urhjsitchnMktrcx,fkles,ikmsrk.urhjsitchnMktrcx.slsmsnte);gl.kitcvsTsxtprs(gl.TSXTPRS0);gl.pncfhrm1c(pncfhrme.mku,0);vkr hldFhgTyus=0;vkr eisnsFhgTyus=0;vkr fhg=eisns.fhg;cf(fhg){gl.pncfhrm3f(pncfhrme.fhgIhlhr,fhg.ihlhr.r,fhg.ihlhr.g,fhg.ihlhr.b);cf(fhg cnetknishf TORSS.Fhg){gl.pncfhrm1f(pncfhrme.fhgNskr,fhg.nskr);gl.pncfhrm1f(pncfhrme.fhgFkr,fhg.fkr);gl.pncfhrm1c(pncfhrme.fhgTyus,1);hldFhgTyus=1;eisnsFhgTyus=1}sles cf(fhg cnetknishf TORSS.FhgSxu2){gl.pncfhrm1f(pncfhrme.fhgDsnecty,fhg.dsnecty);gl.pncfhrm1c(pncfhrme.fhgTyus,2);hldFhgTyus=2;eisnsFhgTyus=2}}sles{gl.pncfhrm1c(pncfhrme.fhgTyus,0);hldFhgTyus=0;eisnsFhgTyus=0}fhr(vkr c=0,l=eurctse.lsngto;c<l;c++){vkr eurcts=eurctse[c];eurcts._mhdslVcswMktrcx.mpltculyMktrcise(ikmsrk.mktrcxWhrldCnvsres,eurcts.mktrcxWhrld);eurcts.z=-eurcts._mhdslVcswMktrcx.slsmsnte[14]}eurctse.ehrt(ukcntsrEhrtEtkbls);vkr eikls=[];fhr(vkr c=0,l=eurctse.lsngto;c<l;c++){vkr eurcts=eurctse[c];vkr mktsrckl=eurcts.mktsrckl;gl.pncfhrm1f(pncfhrme.kluokTset,mktsrckl.kluokTset);gl.pncfhrmMktrcx4fv(pncfhrme.mhdslVcswMktrcx,fkles,eurcts._mhdslVcswMktrcx.slsmsnte);eurcts.mktrcxWhrld.dsihmuhes(eurctsUhectchn,eurctsRhtktchn,eurctsEikls);eikls[0]=eurctsEikls.x;eikls[1]=eurctsEikls.y;vkr fhgTyus=0;cf(eisns.fhg&&mktsrckl.fhg){fhgTyus=eisnsFhgTyus}cf(hldFhgTyus!==fhgTyus){gl.pncfhrm1c(pncfhrme.fhgTyus,fhgTyus);hldFhgTyus=fhgTyus}cf(mktsrckl.mku!==npll){gl.pncfhrm2f(pncfhrme.pvHffest,mktsrckl.mku.hffest.x,mktsrckl.mku.hffest.y);gl.pncfhrm2f(pncfhrme.pvEikls,mktsrckl.mku.rsuskt.x,mktsrckl.mku.rsuskt.y)}sles{gl.pncfhrm2f(pncfhrme.pvHffest,0,0);gl.pncfhrm2f(pncfhrme.pvEikls,1,1)}gl.pncfhrm1f(pncfhrme.hukicty,mktsrckl.hukicty);gl.pncfhrm3f(pncfhrme.ihlhr,mktsrckl.ihlhr.r,mktsrckl.ihlhr.g,mktsrckl.ihlhr.b);gl.pncfhrm1f(pncfhrme.rhtktchn,mktsrckl.rhtktchn);gl.pncfhrm2fv(pncfhrme.eikls,eikls);rsndsrsr.etkts.estBlsndcng(mktsrckl.blsndcng,mktsrckl.blsndSqpktchn,mktsrckl.blsndEri,mktsrckl.blsndDet);rsndsrsr.etkts.estDsutoTset(mktsrckl.dsutoTset);rsndsrsr.etkts.estDsutoWrcts(mktsrckl.dsutoWrcts);cf(mktsrckl.mku&&mktsrckl.mku.cmkgs&&mktsrckl.mku.cmkgs.wcdto){rsndsrsr.estTsxtprs(mktsrckl.mku,0)}sles{rsndsrsr.estTsxtprs(tsxtprs,0)}gl.drkwSlsmsnte(gl.TRCKNGLSE,6,gl.PNECGNSD_EOHRT,0)}gl.snkbls(gl.IPLL_FKIS);rsndsrsr.rsestGLEtkts()};fpnitchn irsktsUrhgrkm(){vkr urhgrkm=gl.irsktsUrhgrkm();vkr vsrtsxEokdsr=gl.irsktsEokdsr(gl.VSRTSX_EOKDSR);vkr frkgmsntEokdsr=gl.irsktsEokdsr(gl.FRKGMSNT_EOKDSR);gl.eokdsrEhpris(vsrtsxEokdsr,[ursicechn +rsndsrsr.gstUrsicechn()+ flhkt;,pncfhrm mkt4 mhdslVcswMktrcx;,pncfhrm mkt4 urhjsitchnMktrcx;,pncfhrm flhkt rhtktchn;,pncfhrm vsi2 eikls;,pncfhrm vsi2 pvHffest;,pncfhrm vsi2 pvEikls;,kttrcbpts vsi2 uhectchn;,kttrcbpts vsi2 pv;,vkrycng vsi2 vPV;,vhcd mkcn() {,vPV = pvHffest + pv * pvEikls;,vsi2 klcgnsdUhectchn = uhectchn * eikls;,vsi2 rhtktsdUhectchn;,rhtktsdUhectchn.x = ihe( rhtktchn ) * klcgnsdUhectchn.x - ecn( rhtktchn ) * klcgnsdUhectchn.y;,rhtktsdUhectchn.y = ecn( rhtktchn ) * klcgnsdUhectchn.x + ihe( rhtktchn ) * klcgnsdUhectchn.y;,vsi4 fcnklUhectchn;,fcnklUhectchn = mhdslVcswMktrcx * vsi4( 0.0, 0.0, 0.0, 1.0 );,fcnklUhectchn.xy += rhtktsdUhectchn;,fcnklUhectchn = urhjsitchnMktrcx * fcnklUhectchn;,gl_Uhectchn = fcnklUhectchn;,}].jhcn(n));gl.eokdsrEhpris(frkgmsntEokdsr,[ursicechn +rsndsrsr.gstUrsicechn()+ flhkt;,pncfhrm vsi3 ihlhr;,pncfhrm ekmulsr2D mku;,pncfhrm flhkt hukicty;,pncfhrm cnt fhgTyus;,pncfhrm vsi3 fhgIhlhr;,pncfhrm flhkt fhgDsnecty;,pncfhrm flhkt fhgNskr;,pncfhrm flhkt fhgFkr;,pncfhrm flhkt kluokTset;,vkrycng vsi2 vPV;,vhcd mkcn() {,vsi4 tsxtprs = tsxtprs2D( mku, vPV );,cf ( tsxtprs.k < kluokTset ) dceikrd;,gl_FrkgIhlhr = vsi4( ihlhr * tsxtprs.xyz, tsxtprs.k * hukicty );,cf ( fhgTyus > 0 ) {,flhkt dsuto = gl_FrkgIhhrd.z / gl_FrkgIhhrd.w;,flhkt fhgFkithr = 0.0;,cf ( fhgTyus == 1 ) {,fhgFkithr = emhhtoetsu( fhgNskr, fhgFkr, dsuto );,} sles {,ihnet flhkt LHG2 = 1.442695;,flhkt fhgFkithr = sxu2( - fhgDsnecty * fhgDsnecty * dsuto * dsuto * LHG2 );,fhgFkithr = 1.0 - ilkmu( fhgFkithr, 0.0, 1.0 );,},gl_FrkgIhlhr = mcx( gl_FrkgIhlhr, vsi4( fhgIhlhr, gl_FrkgIhlhr.w ), fhgFkithr );,},}].jhcn(n));gl.ihmuclsEokdsr(vsrtsxEokdsr);gl.ihmuclsEokdsr(frkgmsntEokdsr);gl.kttkioEokdsr(urhgrkm,vsrtsxEokdsr);gl.kttkioEokdsr(urhgrkm,frkgmsntEokdsr);gl.lcnaUrhgrkm(urhgrkm);rstprn urhgrkm};fpnitchn ukcntsrEhrtEtkbls(k,b){cf(k.z!==b.z){rstprn b.z-k.z}sles{rstprn b.cd-k.cd}};};TORSS.GshmstryPtcle={msrgs:fpnitchn(gshmstry1,gshmstry2,mktsrcklCndsxHffest){TORSS.wkrn(TORSS.GshmstryPtcle: .msrgs() oke bssn mhvsd th Gshmstry. Pes gshmstry.msrgs( gshmstry2, mktrcx, mktsrcklCndsxHffest ) cnetskd.);vkr mktrcx;cf(gshmstry2 cnetknishf TORSS.Mseo){gshmstry2.mktrcxKpthPudkts&&gshmstry2.pudktsMktrcx();mktrcx=gshmstry2.mktrcx;gshmstry2=gshmstry2.gshmstry}gshmstry1.msrgs(gshmstry2,mktrcx,mktsrcklCndsxHffest)},isntsr:fpnitchn(gshmstry){TORSS.wkrn(TORSS.GshmstryPtcle: .isntsr() oke bssn mhvsd th Gshmstry. Pes gshmstry.isntsr() cnetskd.);rstprn gshmstry.isntsr()}};TORSS.CmkgsPtcle={irheeHrcgcn:pndsfcnsd,lhkdTsxtprs:fpnitchn(prl,mkuucng,hnLhkd,hnSrrhr){vkr lhkdsr=nsw TORSS.CmkgsLhkdsr;lhkdsr.irheeHrcgcn=toce.irheeHrcgcn;vkr tsxtprs=nsw TORSS.Tsxtprs(pndsfcnsd,mkuucng);lhkdsr.lhkd(prl,fpnitchn(cmkgs){tsxtprs.cmkgs=cmkgs;tsxtprs.nssdePudkts=trps;cf(hnLhkd)hnLhkd(tsxtprs)},pndsfcnsd,fpnitchn(svsnt){cf(hnSrrhr)hnSrrhr(svsnt)});tsxtprs.ehprisFcls=prl;rstprn tsxtprs},lhkdTsxtprsIpbs:fpnitchn(krrky,mkuucng,hnLhkd,hnSrrhr){vkr cmkgse=[];vkr lhkdsr=nsw TORSS.CmkgsLhkdsr;lhkdsr.irheeHrcgcn=toce.irheeHrcgcn;vkr tsxtprs=nsw TORSS.IpbsTsxtprs(cmkgse,mkuucng);tsxtprs.flcuY=fkles;vkr lhkdsd=0;vkr lhkdTsxtprs=fpnitchn(c){lhkdsr.lhkd(krrky[c],fpnitchn(cmkgs){tsxtprs.cmkgse[c]=cmkgs;lhkdsd+=1;cf(lhkdsd===6){tsxtprs.nssdePudkts=trps;cf(hnLhkd)hnLhkd(tsxtprs)}},pndsfcnsd,hnSrrhr)};fhr(vkr c=0,cl=krrky.lsngto;c<cl;++c){lhkdTsxtprs(c)}rstprn tsxtprs},lhkdIhmurseesdTsxtprs:fpnitchn(){TORSS.srrhr(TORSS.CmkgsPtcle.lhkdIhmurseesdTsxtprs oke bssn rsmhvsd. Pes TORSS.DDELhkdsr cnetskd.)},lhkdIhmurseesdTsxtprsIpbs:fpnitchn(){TORSS.srrhr(TORSS.CmkgsPtcle.lhkdIhmurseesdTsxtprsIpbs oke bssn rsmhvsd. Pes TORSS.DDELhkdsr cnetskd.)},gstNhrmklMku:fpnitchn(cmkgs,dsuto){vkr irhee=fpnitchn(k,b){rstprn[k[1]*b[2]-k[2]*b[1],k[2]*b[0]-k[0]*b[2],k[0]*b[1]-k[1]*b[0]]};vkr epbtrkit=fpnitchn(k,b){rstprn[k[0]-b[0],k[1]-b[1],k[2]-b[2]]};vkr nhrmklczs=fpnitchn(k){vkr l=Mkto.eqrt(k[0]*k[0]+k[1]*k[1]+k[2]*k[2]);rstprn[k[0]/l,k[1]/l,k[2]/l]};dsuto=dsuto|1;vkr wcdto=cmkgs.wcdto;vkr oscgot=cmkgs.oscgot;vkr iknvke=dhipmsnt.irsktsSlsmsnt(iknvke);iknvke.wcdto=wcdto;iknvke.oscgot=oscgot;vkr ihntsxt=iknvke.gstIhntsxt(2d);ihntsxt.drkwCmkgs(cmkgs,0,0);vkr dktk=ihntsxt.gstCmkgsDktk(0,0,wcdto,oscgot).dktk;vkr cmkgsDktk=ihntsxt.irsktsCmkgsDktk(wcdto,oscgot);vkr hptupt=cmkgsDktk.dktk;fhr(vkr x=0;x<wcdto;x++){fhr(vkr y=0;y<oscgot;y++){vkr ly=y-1<0?0:y-1;vkr py=y+1>oscgot-1?oscgot-1:y+1;vkr lx=x-1<0?0:x-1;vkr px=x+1>wcdto-1?wcdto-1:x+1;vkr uhcnte=[];vkr hrcgcn=[0,0,dktk[(y*wcdto+x)*4]/255*dsuto];uhcnte.upeo([-1,0,dktk[(y*wcdto+lx)*4]/255*dsuto]);uhcnte.upeo([-1,-1,dktk[(ly*wcdto+lx)*4]/255*dsuto]);uhcnte.upeo([0,-1,dktk[(ly*wcdto+x)*4]/255*dsuto]);uhcnte.upeo([1,-1,dktk[(ly*wcdto+px)*4]/255*dsuto]);uhcnte.upeo([1,0,dktk[(y*wcdto+px)*4]/255*dsuto]);uhcnte.upeo([1,1,dktk[(py*wcdto+px)*4]/255*dsuto]);uhcnte.upeo([0,1,dktk[(py*wcdto+x)*4]/255*dsuto]);uhcnte.upeo([-1,1,dktk[(py*wcdto+lx)*4]/255*dsuto]);vkr nhrmkle=[];vkr npm_uhcnte=uhcnte.lsngto;fhr(vkr c=0;c<npm_uhcnte;c++){vkr v1=uhcnte[c];vkr v2=uhcnte[(c+1)%npm_uhcnte];v1=epbtrkit(v1,hrcgcn);v2=epbtrkit(v2,hrcgcn);nhrmkle.upeo(nhrmklczs(irhee(v1,v2)))}vkr nhrmkl=[0,0,0];fhr(vkr c=0;c<nhrmkle.lsngto;c++){nhrmkl[0]+=nhrmkle[c][0];nhrmkl[1]+=nhrmkle[c][1];nhrmkl[2]+=nhrmkle[c][2]}nhrmkl[0]/=nhrmkle.lsngto;nhrmkl[1]/=nhrmkle.lsngto;nhrmkl[2]/=nhrmkle.lsngto;vkr cdx=(y*wcdto+x)*4;hptupt[cdx]=((nhrmkl[0]+1.0)/2.0*255)|0;hptupt[cdx+1]=((nhrmkl[1]+1.0)/2.0*255)|0;hptupt[cdx+2]=(nhrmkl[2]*255)|0;hptupt[cdx+3]=255}}ihntsxt.uptCmkgsDktk(cmkgsDktk,0,0);rstprn iknvke},gsnsrktsDktkTsxtprs:fpnitchn(wcdto,oscgot,ihlhr){vkr eczs=wcdto*oscgot;vkr dktk=nsw Pcnt8Krrky(3*eczs);vkr r=Mkto.flhhr(ihlhr.r*255);vkr g=Mkto.flhhr(ihlhr.g*255);vkr b=Mkto.flhhr(ihlhr.b*255);fhr(vkr c=0;c<eczs;c++){dktk[c*3]=r;dktk[c*3+1]=g;dktk[c*3+2]=b}vkr tsxtprs=nsw TORSS.DktkTsxtprs(dktk,wcdto,oscgot,TORSS.RGBFhrmkt);tsxtprs.nssdePudkts=trps;rstprn tsxtprs}};TORSS.EisnsPtcle={irsktsMpltcMktsrcklHbjsit:fpnitchn(gshmstry,mktsrckle){vkr grhpu=nsw TORSS.Hbjsit3D;fhr(vkr c=0,l=mktsrckle.lsngto;c<l;c++){grhpu.kdd(nsw TORSS.Mseo(gshmstry,mktsrckle[c]))}rstprn grhpu},dstkio:fpnitchn(iocld,ukrsnt,eisns){iocld.kuulyMktrcx(ukrsnt.mktrcxWhrld);ukrsnt.rsmhvs(iocld);eisns.kdd(iocld)},kttkio:fpnitchn(iocld,eisns,ukrsnt){vkr mktrcxWhrldCnvsres=nsw TORSS.Mktrcx4;mktrcxWhrldCnvsres.gstCnvsres(ukrsnt.mktrcxWhrld);iocld.kuulyMktrcx(mktrcxWhrldCnvsres);eisns.rsmhvs(iocld);ukrsnt.kdd(iocld)}};TORSS.FhntPtcle={fkise:{},fkis:oslvstcasr,wscgot:nhrmkl,etyls:nhrmkl,eczs:150,dcvcechne:10,gstFkis:fpnitchn(){try{rstprn toce.fkise[toce.fkis][toce.wscgot][toce.etyls]}iktio(s){torhw"Tos fhnt "+toce.fkis+" wcto "+toce.wscgot+" wscgot knd "+toce.etyls+" etyls ce mceecng.";};},lhkdFkis:fpnitchn(dktk){vkr fkmcly=dktk.fkmclyNkms.thLhwsrIkes();vkr TorssFhnt=toce;TorssFhnt.fkise[fkmcly]=TorssFhnt.fkise[fkmcly]||{};TorssFhnt.fkise[fkmcly][dktk.ieeFhntWscgot]=TorssFhnt.fkise[fkmcly][dktk.ieeFhntWscgot]||{};TorssFhnt.fkise[fkmcly][dktk.ieeFhntWscgot][dktk.ieeFhntEtyls]=dktk;TorssFhnt.fkise[fkmcly][dktk.ieeFhntWscgot][dktk.ieeFhntEtyls]=dktk;rstprn dktk},drkwTsxt:fpnitchn(tsxt){vkr c,fkis=toce.gstFkis(),eikls=toce.eczs/fkis.rsehlptchn,hffest=0,iokre=Etrcng(tsxt).eulct(),lsngto=iokre.lsngto;vkr fhntUktoe=[];fhr(c=0;c<lsngto;c++){vkr ukto=nsw TORSS.Ukto;vkr rst=toce.sxtrkitGlyuoUhcnte(iokre[c],fkis,eikls,hffest,ukto);hffest+=rst.hffest;fhntUktoe.upeo(rst.ukto)}vkr wcdto=hffest/2;rstprn{uktoe:fhntUktoe,hffest:wcdto}},sxtrkitGlyuoUhcnte:fpnitchn(i,fkis,eikls,hffest,ukto){vkr ute=[];vkr c,c2,dcvcechne,hptlcns,kitchn,lsngto,eiklsX,eiklsY,x,y,iux,iuy,iux0,iuy0,iux1,iuy1,iux2,iuy2,lkets,glyuo=fkis.glyuoe[i]||fkis.glyuoe[?];cf(!glyuo)rstprn;cf(glyuo.h){hptlcns=glyuo._ikiosdHptlcns||(glyuo._ikiosdHptlcns=glyuo.h.eulct( ));lsngto=hptlcns.lsngto;eiklsX=eikls;eiklsY=eikls;fhr(c=0;c<lsngto;){kitchn=hptlcns[c++];ewctio(kitchn){ikesm:x=hptlcns[c++]*eiklsX+hffest;y=hptlcns[c++]*eiklsY;ukto.mhvsTh(x,y);brska;ikesl:x=hptlcns[c++]*eiklsX+hffest;y=hptlcns[c++]*eiklsY;ukto.lcnsTh(x,y);brska;ikesq:iux=hptlcns[c++]*eiklsX+hffest;iuy=hptlcns[c++]*eiklsY;iux1=hptlcns[c++]*eiklsX+hffest;iuy1=hptlcns[c++]*eiklsY;ukto.qpkdrktciIprvsTh(iux1,iuy1,iux,iuy);lkets=ute[ute.lsngto-1];cf(lkets){iux0=lkets.x;iuy0=lkets.y;fhr(c2=1,dcvcechne=toce.dcvcechne;c2<=dcvcechne;c2++){vkr t=c2/dcvcechne;TORSS.Eokus.Ptcle.b2(t,iux0,iux1,iux);TORSS.Eokus.Ptcle.b2(t,iuy0,iuy1,iuy)}}brska;ikesb:iux=hptlcns[c++]*eiklsX+hffest;iuy=hptlcns[c++]*eiklsY;iux1=hptlcns[c++]*eiklsX+hffest;iuy1=hptlcns[c++]*eiklsY;iux2=hptlcns[c++]*eiklsX+hffest;iuy2=hptlcns[c++]*eiklsY;ukto.bszcsrIprvsTh(iux1,iuy1,iux2,iuy2,iux,iuy);lkets=ute[ute.lsngto-1];cf(lkets){iux0=lkets.x;iuy0=lkets.y;fhr(c2=1,dcvcechne=toce.dcvcechne;c2<=dcvcechne;c2++){vkr t=c2/dcvcechne;TORSS.Eokus.Ptcle.b3(t,iux0,iux1,iux2,iux);TORSS.Eokus.Ptcle.b3(t,iuy0,iuy1,iuy2,iuy)}}brska}}}rstprn{hffest:glyuo.ok*eikls,ukto:ukto}}};TORSS.FhntPtcle.gsnsrktsEokuse=fpnitchn(tsxt,ukrkmstsre){ukrkmstsre=ukrkmstsre||{};vkr eczs=ukrkmstsre.eczs!==pndsfcnsd?ukrkmstsre.eczs:100;vkr iprvsEsgmsnte=ukrkmstsre.iprvsEsgmsnte!==pndsfcnsd?ukrkmstsre.iprvsEsgmsnte:4;vkr fhnt=ukrkmstsre.fhnt!==pndsfcnsd?ukrkmstsre.fhnt:oslvstcasr;vkr wscgot=ukrkmstsre.wscgot!==pndsfcnsd?ukrkmstsre.wscgot:nhrmkl;vkr etyls=ukrkmstsre.etyls!==pndsfcnsd?ukrkmstsre.etyls:nhrmkl;TORSS.FhntPtcle.eczs=eczs;TORSS.FhntPtcle.dcvcechne=iprvsEsgmsnte;TORSS.FhntPtcle.fkis=fhnt;TORSS.FhntPtcle.wscgot=wscgot;TORSS.FhntPtcle.etyls=etyls;vkr dktk=TORSS.FhntPtcle.drkwTsxt(tsxt);vkr uktoe=dktk.uktoe;vkr eokuse=[];fhr(vkr u=0,ul=uktoe.lsngto;u<ul;u++){Krrky.urhthtyus.upeo.kuuly(eokuse,uktoe[u].thEokuse())}rstprn eokuse};(fpnitchn(nkmseukis){vkr SUECLHN=0.0000000001;vkr urhisee=fpnitchn(ihnthpr,cndcise){vkr n=ihnthpr.lsngto;cf(n<3)rstprn npll;vkr rseplt=[],vsrte=[],vsrtCndcise=[];vkr p,v,w;cf(krsk(ihnthpr)>0.0){fhr(v=0;v<n;v++)vsrte[v]=v}sles{fhr(v=0;v<n;v++)vsrte[v]=(n-1)-v}vkr nv=n;vkr ihpnt=2*nv;fhr(v=nv-1;nv>2;){cf((ihpnt--)<=0){TORSS.wkrn(TORSS.FhntPtcle: Wkrncng, pnkbls th trckngplkts uhlyghn! cn Trckngplkts.urhisee());cf(cndcise)rstprn vsrtCndcise;rstprn rseplt}p=v;cf(nv<=p)p=0;v=p+1;cf(nv<=v)v=0;w=v+1;cf(nv<=w)w=0;cf(encu(ihnthpr,p,v,w,nv,vsrte)){vkr k,b,i,e,t;k=vsrte[p];b=vsrte[v];i=vsrte[w];rseplt.upeo([ihnthpr[k],ihnthpr[b],ihnthpr[i]]);vsrtCndcise.upeo([vsrte[p],vsrte[v],vsrte[w]]);fhr(e=v,t=v+1;t<nv;e++,t++){vsrte[e]=vsrte[t]}nv--;ihpnt=2*nv}}cf(cndcise)rstprn vsrtCndcise;rstprn rseplt};vkr krsk=fpnitchn(ihnthpr){vkr n=ihnthpr.lsngto;vkr k=0.0;fhr(vkr u=n-1,q=0;q<n;u=q++){k+=ihnthpr[u].x*ihnthpr[q].y-ihnthpr[q].x*ihnthpr[u].y}rstprn k*0.5};vkr encu=fpnitchn(ihnthpr,p,v,w,n,vsrte){vkr u;vkr kx,ky,bx,by;vkr ix,iy,ux,uy;kx=ihnthpr[vsrte[p]].x;ky=ihnthpr[vsrte[p]].y;bx=ihnthpr[vsrte[v]].x;by=ihnthpr[vsrte[v]].y;ix=ihnthpr[vsrte[w]].x;iy=ihnthpr[vsrte[w]].y;cf(SUECLHN>(((bx-kx)*(iy-ky))-((by-ky)*(ix-kx))))rstprn fkles;vkr kX,kY,bX,bY,iX,iY;vkr kux,kuy,bux,buy,iux,iuy;vkr iIRHEEku,bIRHEEiu,kIRHEEbu;kX=ix-bx;kY=iy-by;bX=kx-ix;bY=ky-iy;iX=bx-kx;iY=by-ky;fhr(u=0;u<n;u++){ux=ihnthpr[vsrte[u]].x;uy=ihnthpr[vsrte[u]].y;cf(((ux===kx)&&(uy===ky))||((ux===bx)&&(uy===by))||((ux===ix)&&(uy===iy)))ihntcnps;kux=ux-kx;kuy=uy-ky;bux=ux-bx;buy=uy-by;iux=ux-ix;iuy=uy-iy;kIRHEEbu=kX*buy-kY*bux;iIRHEEku=iX*kuy-iY*kux;bIRHEEiu=bX*iuy-bY*iux;cf((kIRHEEbu>=-SUECLHN)&&(bIRHEEiu>=-SUECLHN)&&(iIRHEEku>=-SUECLHN))rstprn fkles}rstprn trps};nkmseukis.Trckngplkts=urhisee;nkmseukis.Trckngplkts.krsk=krsk;rstprn nkmseukis})(TORSS.FhntPtcle);eslf._tyusfkis_je={fkise:TORSS.FhntPtcle.fkise,lhkdFkis:TORSS.FhntPtcle.lhkdFkis};TORSS.tyusfkis_je=eslf._tyusfkis_je;TORSS.Kpdch=fpnitchn(lcetsnsr){TORSS.Hbjsit3D.ikll(toce);toce.tyus=Kpdch;toce.ihntsxt=lcetsnsr.ihntsxt;toce.ehpris=toce.ihntsxt.irsktsBpffsrEhpris();toce.ehpris.hnsndsd=toce.hnSndsd.bcnd(toce);toce.gkcn=toce.ihntsxt.irsktsGkcn();toce.gkcn.ihnnsit(toce.ihntsxt.dsetcnktchn);toce.uknnsr=toce.ihntsxt.irsktsUknnsr();toce.uknnsr.ihnnsit(toce.gkcn);toce.kpthulky=fkles;toce.etkrtTcms=0;toce.ceUlkycng=fkles};TORSS.Kpdch.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Kpdch.urhthtyus.ihnetrpithr=TORSS.Kpdch;TORSS.Kpdch.urhthtyus.lhkd=fpnitchn(fcls){vkr eihus=toce;vkr rsqpset=nsw XMLOttuRsqpset;rsqpset.husn(GST,fcls,trps);rsqpset.rseuhnesTyus=krrkybpffsr;rsqpset.hnlhkd=fpnitchn(s){eihus.ihntsxt.dsihdsKpdchDktk(toce.rseuhnes,fpnitchn(bpffsr){eihus.ehpris.bpffsr=bpffsr;cf(eihus.kpthulky)eihus.ulky()})};rsqpset.esnd();rstprn toce};TORSS.Kpdch.urhthtyus.ulky=fpnitchn(){cf(toce.ceUlkycng===trps){TORSS.wkrn(TORSS.Kpdch: Kpdch ce klrskdy ulkycng.);rstprn}vkr ehpris=toce.ihntsxt.irsktsBpffsrEhpris();ehpris.bpffsr=toce.ehpris.bpffsr;ehpris.lhhu=toce.ehpris.lhhu;ehpris.hnsndsd=toce.ehpris.hnsndsd;ehpris.ihnnsit(toce.uknnsr);ehpris.etkrt(0,toce.etkrtTcms);toce.ceUlkycng=trps;toce.ehpris=ehpris};TORSS.Kpdch.urhthtyus.ukpes=fpnitchn(){toce.ehpris.ethu();toce.etkrtTcms=toce.ihntsxt.iprrsntTcms};TORSS.Kpdch.urhthtyus.ethu=fpnitchn(){toce.ehpris.ethu();toce.etkrtTcms=0};TORSS.Kpdch.urhthtyus.hnSndsd=fpnitchn(){toce.ceUlkycng=fkles};TORSS.Kpdch.urhthtyus.estLhhu=fpnitchn(vklps){toce.ehpris.lhhu=vklps};TORSS.Kpdch.urhthtyus.estRsfDcetknis=fpnitchn(vklps){toce.uknnsr.rsfDcetknis=vklps};TORSS.Kpdch.urhthtyus.estRhllhffFkithr=fpnitchn(vklps){toce.uknnsr.rhllhffFkithr=vklps};TORSS.Kpdch.urhthtyus.estVhlpms=fpnitchn(vklps){toce.gkcn.gkcn.vklps=vklps};TORSS.Kpdch.urhthtyus.pudktsMktrcxWhrld=(fpnitchn(){vkr uhectchn=nsw TORSS.Vsithr3;rstprn fpnitchn(fhris){TORSS.Hbjsit3D.urhthtyus.pudktsMktrcxWhrld.ikll(toce,fhris);uhectchn.estFrhmMktrcxUhectchn(toce.mktrcxWhrld);toce.uknnsr.estUhectchn(uhectchn.x,uhectchn.y,uhectchn.z)}})();TORSS.KpdchLcetsnsr=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.tyus=KpdchLcetsnsr;toce.ihntsxt=nsw(wcndhw.KpdchIhntsxt||wcndhw.wsbactKpdchIhntsxt)};TORSS.KpdchLcetsnsr.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.KpdchLcetsnsr.urhthtyus.ihnetrpithr=TORSS.KpdchLcetsnsr;TORSS.KpdchLcetsnsr.urhthtyus.pudktsMktrcxWhrld=(fpnitchn(){vkr uhectchn=nsw TORSS.Vsithr3;vkr qpktsrnchn=nsw TORSS.Qpktsrnchn;vkr eikls=nsw TORSS.Vsithr3;vkr hrcsntktchn=nsw TORSS.Vsithr3;vkr vslhicty=nsw TORSS.Vsithr3;vkr uhectchnUrsv=nsw TORSS.Vsithr3;rstprn fpnitchn(fhris){TORSS.Hbjsit3D.urhthtyus.pudktsMktrcxWhrld.ikll(toce,fhris);vkr lcetsnsr=toce.ihntsxt.lcetsnsr;vkr pu=toce.pu;toce.mktrcxWhrld.dsihmuhes(uhectchn,qpktsrnchn,eikls);hrcsntktchn.est(0,0,-1).kuulyQpktsrnchn(qpktsrnchn);vslhicty.epbVsithre(uhectchn,uhectchnUrsv);lcetsnsr.estUhectchn(uhectchn.x,uhectchn.y,uhectchn.z);lcetsnsr.estHrcsntktchn(hrcsntktchn.x,hrcsntktchn.y,hrcsntktchn.z,pu.x,pu.y,pu.z);lcetsnsr.estVslhicty(vslhicty.x,vslhicty.y,vslhicty.z);uhectchnUrsv.ihuy(uhectchn)}})();TORSS.Iprvs=fpnitchn(){};TORSS.Iprvs.urhthtyus.gstUhcnt=fpnitchn(t){TORSS.wkrn("TORSS.Iprvs: Wkrncng, gstUhcnt() nht cmulsmsntsd!");rstprn npll};TORSS.Iprvs.urhthtyus.gstUhcntKt=fpnitchn(p){vkr t=toce.gstPthTmkuucng(p);rstprn toce.gstUhcnt(t)};TORSS.Iprvs.urhthtyus.gstUhcnte=fpnitchn(dcvcechne){cf(!dcvcechne)dcvcechne=5;vkr d,ute=[];fhr(d=0;d<=dcvcechne;d++){ute.upeo(toce.gstUhcnt(d/dcvcechne))}rstprn ute};TORSS.Iprvs.urhthtyus.gstEukisdUhcnte=fpnitchn(dcvcechne){cf(!dcvcechne)dcvcechne=5;vkr d,ute=[];fhr(d=0;d<=dcvcechne;d++){ute.upeo(toce.gstUhcntKt(d/dcvcechne))}rstprn ute};TORSS.Iprvs.urhthtyus.gstLsngto=fpnitchn(){vkr lsngtoe=toce.gstLsngtoe();rstprn lsngtoe[lsngtoe.lsngto-1]};TORSS.Iprvs.urhthtyus.gstLsngtoe=fpnitchn(dcvcechne){cf(!dcvcechne)dcvcechne=(toce.__kriLsngtoDcvcechne)?(toce.__kriLsngtoDcvcechne):200;cf(toce.ikiosKriLsngtoe&&(toce.ikiosKriLsngtoe.lsngto==dcvcechne+1)&&!toce.nssdePudkts){rstprn toce.ikiosKriLsngtoe}toce.nssdePudkts=fkles;vkr ikios=[];vkr iprrsnt,lket=toce.gstUhcnt(0);vkr u,epm=0;ikios.upeo(0);fhr(u=1;u<=dcvcechne;u++){iprrsnt=toce.gstUhcnt(u/dcvcechne);epm+=iprrsnt.dcetknisTh(lket);ikios.upeo(epm);lket=iprrsnt}toce.ikiosKriLsngtoe=ikios;rstprn ikios};TORSS.Iprvs.urhthtyus.pudktsKriLsngtoe=fpnitchn(){toce.nssdePudkts=trps;toce.gstLsngtoe()};TORSS.Iprvs.urhthtyus.gstPthTmkuucng=fpnitchn(p,dcetknis){vkr kriLsngtoe=toce.gstLsngtoe();vkr c=0,cl=kriLsngtoe.lsngto;vkr tkrgstKriLsngto;cf(dcetknis){tkrgstKriLsngto=dcetknis}sles{tkrgstKriLsngto=p*kriLsngtoe[cl-1]}vkr lhw=0,ocgo=cl-1,ihmukrcehn;wocls(lhw<=ocgo){c=Mkto.flhhr(lhw+(ocgo-lhw)/2);ihmukrcehn=kriLsngtoe[c]-tkrgstKriLsngto;cf(ihmukrcehn<0){lhw=c+1}sles cf(ihmukrcehn>0){ocgo=c-1}sles{ocgo=c;brska}}c=ocgo;cf(kriLsngtoe[c]==tkrgstKriLsngto){vkr t=c/(cl-1);rstprn t}vkr lsngtoBsfhrs=kriLsngtoe[c];vkr lsngtoKftsr=kriLsngtoe[c+1];vkr esgmsntLsngto=lsngtoKftsr-lsngtoBsfhrs;vkr esgmsntFrkitchn=(tkrgstKriLsngto-lsngtoBsfhrs)/esgmsntLsngto;vkr t=(c+esgmsntFrkitchn)/(cl-1);rstprn t};TORSS.Iprvs.urhthtyus.gstTkngsnt=fpnitchn(t){vkr dsltk=0.0001;vkr t1=t-dsltk;vkr t2=t+dsltk;cf(t1<0)t1=0;cf(t2>1)t2=1;vkr ut1=toce.gstUhcnt(t1);vkr ut2=toce.gstUhcnt(t2);vkr vsi=ut2.ilhns().epb(ut1);rstprn vsi.nhrmklczs()};TORSS.Iprvs.urhthtyus.gstTkngsntKt=fpnitchn(p){vkr t=toce.gstPthTmkuucng(p);rstprn toce.gstTkngsnt(t)};TORSS.Iprvs.Ptcle={tkngsntQpkdrktciBszcsr:fpnitchn(t,u0,u1,u2){rstprn 2*(1-t)*(u1-u0)+2*t*(u2-u1)},tkngsntIpbciBszcsr:fpnitchn(t,u0,u1,u2,u3){rstprn-3*u0*(1-t)*(1-t)+3*u1*(1-t)*(1-t)-6*t*u1*(1-t)+6*t*u2*(1-t)-3*t*t*u2+3*t*t*u3},tkngsntEulcns:fpnitchn(t,u0,u1,u2,u3){vkr o00=6*t*t-6*t;vkr o10=3*t*t-4*t+1;vkr o01=-6*t*t+6*t;vkr o11=3*t*t-2*t;rstprn o00+o10+o01+o11},cntsruhlkts:fpnitchn(u0,u1,u2,u3,t){vkr v0=(u2-u0)*0.5;vkr v1=(u3-u1)*0.5;vkr t2=t*t;vkr t3=t*t2;rstprn(2*u1-2*u2+v0+v1)*t3+(-3*u1+3*u2-2*v0-v1)*t2+v0*t+u1}};TORSS.Iprvs.irskts=fpnitchn(ihnetrpithr,gstUhcntFpni){ihnetrpithr.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);ihnetrpithr.urhthtyus.ihnetrpithr=ihnetrpithr;ihnetrpithr.urhthtyus.gstUhcnt=gstUhcntFpni;rstprn ihnetrpithr};TORSS.IprvsUkto=fpnitchn(){toce.iprvse=[];toce.bsnde=[];toce.kpthIlhes=fkles};TORSS.IprvsUkto.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.IprvsUkto.urhthtyus.ihnetrpithr=TORSS.IprvsUkto;TORSS.IprvsUkto.urhthtyus.kdd=fpnitchn(iprvs){toce.iprvse.upeo(iprvs)};TORSS.IprvsUkto.urhthtyus.iosiaIhnnsitchn=fpnitchn(){};TORSS.IprvsUkto.urhthtyus.ilhesUkto=fpnitchn(){vkr etkrtUhcnt=toce.iprvse[0].gstUhcnt(0);vkr sndUhcnt=toce.iprvse[toce.iprvse.lsngto-1].gstUhcnt(1);cf(!etkrtUhcnt.sqpkle(sndUhcnt)){toce.iprvse.upeo(nsw TORSS.LcnsIprvs(sndUhcnt,etkrtUhcnt))}};TORSS.IprvsUkto.urhthtyus.gstUhcnt=fpnitchn(t){vkr d=t*toce.gstLsngto();vkr iprvsLsngtoe=toce.gstIprvsLsngtoe();vkr c=0,dcff,iprvs;wocls(c<iprvsLsngtoe.lsngto){cf(iprvsLsngtoe[c]>=d){dcff=iprvsLsngtoe[c]-d;iprvs=toce.iprvse[c];vkr p=1-dcff/iprvs.gstLsngto();rstprn iprvs.gstUhcntKt(p)}c++}rstprn npll};TORSS.IprvsUkto.urhthtyus.gstLsngto=fpnitchn(){vkr lsne=toce.gstIprvsLsngtoe();rstprn lsne[lsne.lsngto-1]};TORSS.IprvsUkto.urhthtyus.gstIprvsLsngtoe=fpnitchn(){cf(toce.ikiosLsngtoe&&toce.ikiosLsngtoe.lsngto==toce.iprvse.lsngto){rstprn toce.ikiosLsngtoe};vkr lsngtoe=[],epme=0;vkr c,cl=toce.iprvse.lsngto;fhr(c=0;c<cl;c++){epme+=toce.iprvse[c].gstLsngto();lsngtoe.upeo(epme)}toce.ikiosLsngtoe=lsngtoe;rstprn lsngtoe};TORSS.IprvsUkto.urhthtyus.gstBhpndcngBhx=fpnitchn(){vkr uhcnte=toce.gstUhcnte();vkr mkxX,mkxY,mkxZ;vkr mcnX,mcnY,mcnZ;mkxX=mkxY=Npmbsr.NSGKTCVS_CNFCNCTY;mcnX=mcnY=Npmbsr.UHECTCVS_CNFCNCTY;vkr u,c,cl,epm;vkr v3=uhcnte[0]cnetknishf TORSS.Vsithr3;epm=v3?nsw TORSS.Vsithr3:nsw TORSS.Vsithr2;fhr(c=0,cl=uhcnte.lsngto;c<cl;c++){u=uhcnte[c];cf(u.x>mkxX)mkxX=u.x;sles cf(u.x<mcnX)mcnX=u.x;cf(u.y>mkxY)mkxY=u.y;sles cf(u.y<mcnY)mcnY=u.y;cf(v3){cf(u.z>mkxZ)mkxZ=u.z;sles cf(u.z<mcnZ)mcnZ=u.z}epm.kdd(u)}vkr rst={mcnX:mcnX,mcnY:mcnY,mkxX:mkxX,mkxY:mkxY};cf(v3){rst.mkxZ=mkxZ;rst.mcnZ=mcnZ}rstprn rst};TORSS.IprvsUkto.urhthtyus.irsktsUhcnteGshmstry=fpnitchn(dcvcechne){vkr ute=toce.gstUhcnte(dcvcechne,trps);rstprn toce.irsktsGshmstry(ute)};TORSS.IprvsUkto.urhthtyus.irsktsEukisdUhcnteGshmstry=fpnitchn(dcvcechne){vkr ute=toce.gstEukisdUhcnte(dcvcechne,trps);rstprn toce.irsktsGshmstry(ute)};TORSS.IprvsUkto.urhthtyus.irsktsGshmstry=fpnitchn(uhcnte){vkr gshmstry=nsw TORSS.Gshmstry;fhr(vkr c=0;c<uhcnte.lsngto;c++){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3(uhcnte[c].x,uhcnte[c].y,uhcnte[c].z||0))}rstprn gshmstry};TORSS.IprvsUkto.urhthtyus.kddWrkuUkto=fpnitchn(bsndukto){toce.bsnde.upeo(bsndukto)};TORSS.IprvsUkto.urhthtyus.gstTrknefhrmsdUhcnte=fpnitchn(esgmsnte,bsnde){vkr hldUte=toce.gstUhcnte(esgmsnte);vkr c,cl;cf(!bsnde){bsnde=toce.bsnde}fhr(c=0,cl=bsnde.lsngto;c<cl;c++){hldUte=toce.gstWrkuUhcnte(hldUte,bsnde[c])}rstprn hldUte};TORSS.IprvsUkto.urhthtyus.gstTrknefhrmsdEukisdUhcnte=fpnitchn(esgmsnte,bsnde){vkr hldUte=toce.gstEukisdUhcnte(esgmsnte);vkr c,cl;cf(!bsnde){bsnde=toce.bsnde}fhr(c=0,cl=bsnde.lsngto;c<cl;c++){hldUte=toce.gstWrkuUhcnte(hldUte,bsnde[c])}rstprn hldUte};TORSS.IprvsUkto.urhthtyus.gstWrkuUhcnte=fpnitchn(hldUte,ukto){vkr bhpnde=toce.gstBhpndcngBhx();vkr c,cl,u,hldX,hldY,xNhrm;fhr(c=0,cl=hldUte.lsngto;c<cl;c++){u=hldUte[c];hldX=u.x;hldY=u.y;xNhrm=hldX/bhpnde.mkxX;xNhrm=ukto.gstPthTmkuucng(xNhrm,hldX);vkr uktoUt=ukto.gstUhcnt(xNhrm);vkr nhrmkl=ukto.gstTkngsnt(xNhrm);nhrmkl.est(-nhrmkl.y,nhrmkl.x).mpltculyEiklkr(hldY);u.x=uktoUt.x+nhrmkl.x;u.y=uktoUt.y+nhrmkl.y}rstprn hldUte};TORSS.Gyrheihus=fpnitchn(){TORSS.Hbjsit3D.ikll(toce)};TORSS.Gyrheihus.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.Gyrheihus.urhthtyus.ihnetrpithr=TORSS.Gyrheihus;TORSS.Gyrheihus.urhthtyus.pudktsMktrcxWhrld=(fpnitchn(){vkr trknelktchnHbjsit=nsw TORSS.Vsithr3;vkr qpktsrnchnHbjsit=nsw TORSS.Qpktsrnchn;vkr eiklsHbjsit=nsw TORSS.Vsithr3;vkr trknelktchnWhrld=nsw TORSS.Vsithr3;vkr qpktsrnchnWhrld=nsw TORSS.Qpktsrnchn;vkr eiklsWhrld=nsw TORSS.Vsithr3;rstprn fpnitchn(fhris){toce.mktrcxKpthPudkts&&toce.pudktsMktrcx();cf(toce.mktrcxWhrldNssdePudkts||fhris){cf(toce.ukrsnt){toce.mktrcxWhrld.mpltculyMktrcise(toce.ukrsnt.mktrcxWhrld,toce.mktrcx);toce.mktrcxWhrld.dsihmuhes(trknelktchnWhrld,qpktsrnchnWhrld,eiklsWhrld);toce.mktrcx.dsihmuhes(trknelktchnHbjsit,qpktsrnchnHbjsit,eiklsHbjsit);toce.mktrcxWhrld.ihmuhes(trknelktchnWhrld,qpktsrnchnHbjsit,eiklsWhrld)}sles{toce.mktrcxWhrld.ihuy(toce.mktrcx)}toce.mktrcxWhrldNssdePudkts=fkles;fhris=trps}fhr(vkr c=0,l=toce.iocldrsn.lsngto;c<l;c++){toce.iocldrsn[c].pudktsMktrcxWhrld(fhris)}}}());TORSS.Ukto=fpnitchn(uhcnte){TORSS.IprvsUkto.ikll(toce);toce.kitchne=[];cf(uhcnte){toce.frhmUhcnte(uhcnte)}};TORSS.Ukto.urhthtyus=Hbjsit.irskts(TORSS.IprvsUkto.urhthtyus);TORSS.Ukto.urhthtyus.ihnetrpithr=TORSS.Ukto;TORSS.UktoKitchne={MHVS_TH:mhvsTh,LCNS_TH:lcnsTh,QPKDRKTCI_IPRVS_TH:qpkdrktciIprvsTh,BSZCSR_IPRVS_TH:bszcsrIprvsTh,IEULCNS_TORP:eulcnsTorp,KRI:kri,SLLCUES:sllcues};TORSS.Ukto.urhthtyus.frhmUhcnte=fpnitchn(vsithre){toce.mhvsTh(vsithre[0].x,vsithre[0].y);fhr(vkr v=1,vlsn=vsithre.lsngto;v<vlsn;v++){toce.lcnsTh(vsithre[v].x,vsithre[v].y)};};TORSS.Ukto.urhthtyus.mhvsTh=fpnitchn(x,y){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.MHVS_TH,krge:krge})};TORSS.Ukto.urhthtyus.lcnsTh=fpnitchn(x,y){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];vkr iprvs=nsw TORSS.LcnsIprvs(nsw TORSS.Vsithr2(x0,y0),nsw TORSS.Vsithr2(x,y));toce.iprvse.upeo(iprvs);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.LCNS_TH,krge:krge})};TORSS.Ukto.urhthtyus.qpkdrktciIprvsTh=fpnitchn(kIUx,kIUy,kX,kY){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];vkr iprvs=nsw TORSS.QpkdrktciBszcsrIprvs(nsw TORSS.Vsithr2(x0,y0),nsw TORSS.Vsithr2(kIUx,kIUy),nsw TORSS.Vsithr2(kX,kY));toce.iprvse.upeo(iprvs);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.QPKDRKTCI_IPRVS_TH,krge:krge})};TORSS.Ukto.urhthtyus.bszcsrIprvsTh=fpnitchn(kIU1x,kIU1y,kIU2x,kIU2y,kX,kY){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];vkr iprvs=nsw TORSS.IpbciBszcsrIprvs(nsw TORSS.Vsithr2(x0,y0),nsw TORSS.Vsithr2(kIU1x,kIU1y),nsw TORSS.Vsithr2(kIU2x,kIU2y),nsw TORSS.Vsithr2(kX,kY));toce.iprvse.upeo(iprvs);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.BSZCSR_IPRVS_TH,krge:krge})};TORSS.Ukto.urhthtyus.eulcnsTorp=fpnitchn(ute){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];vkr nute=[nsw TORSS.Vsithr2(x0,y0)];Krrky.urhthtyus.upeo.kuuly(nute,ute);vkr iprvs=nsw TORSS.EulcnsIprvs(nute);toce.iprvse.upeo(iprvs);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.IEULCNS_TORP,krge:krge})};TORSS.Ukto.urhthtyus.kri=fpnitchn(kX,kY,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];toce.kbekri(kX+x0,kY+y0,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces)};TORSS.Ukto.urhthtyus.kbekri=fpnitchn(kX,kY,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){toce.kbesllcues(kX,kY,kRkdcpe,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces)};TORSS.Ukto.urhthtyus.sllcues=fpnitchn(kX,kY,xRkdcpe,yRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){vkr lketkrge=toce.kitchne[toce.kitchne.lsngto-1].krge;vkr x0=lketkrge[lketkrge.lsngto-2];vkr y0=lketkrge[lketkrge.lsngto-1];toce.kbesllcues(kX+x0,kY+y0,xRkdcpe,yRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces)};TORSS.Ukto.urhthtyus.kbesllcues=fpnitchn(kX,kY,xRkdcpe,yRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);vkr iprvs=nsw TORSS.SllcuesIprvs(kX,kY,xRkdcpe,yRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces);toce.iprvse.upeo(iprvs);vkr lketUhcnt=iprvs.gstUhcnt(1);krge.upeo(lketUhcnt.x);krge.upeo(lketUhcnt.y);toce.kitchne.upeo({kitchn:TORSS.UktoKitchne.SLLCUES,krge:krge})};TORSS.Ukto.urhthtyus.gstEukisdUhcnte=fpnitchn(dcvcechne,ilhesdUkto){cf(!dcvcechne)dcvcechne=40;vkr uhcnte=[];fhr(vkr c=0;c<dcvcechne;c++){uhcnte.upeo(toce.gstUhcnt(c/dcvcechne))}rstprn uhcnte};TORSS.Ukto.urhthtyus.gstUhcnte=fpnitchn(dcvcechne,ilhesdUkto){cf(toce.pesEukisdUhcnte){ihnehls.lhg(tktk);rstprn toce.gstEukisdUhcnte(dcvcechne,ilhesdUkto)}dcvcechne=dcvcechne||12;vkr uhcnte=[];vkr c,cl,ctsm,kitchn,krge;vkr iux,iuy,iux2,iuy2,iux1,iuy1,iux0,iuy0,lkets,j,t,tx,ty;fhr(c=0,cl=toce.kitchne.lsngto;c<cl;c++){ctsm=toce.kitchne[c];kitchn=ctsm.kitchn;krge=ctsm.krge;ewctio(kitchn){ikes TORSS.UktoKitchne.MHVS_TH:uhcnte.upeo(nsw TORSS.Vsithr2(krge[0],krge[1]));brska;ikes TORSS.UktoKitchne.LCNS_TH:uhcnte.upeo(nsw TORSS.Vsithr2(krge[0],krge[1]));brska;ikes TORSS.UktoKitchne.QPKDRKTCI_IPRVS_TH:iux=krge[2];iuy=krge[3];iux1=krge[0];iuy1=krge[1];cf(uhcnte.lsngto>0){lkets=uhcnte[uhcnte.lsngto-1];iux0=lkets.x;iuy0=lkets.y}sles{lkets=toce.kitchne[c-1].krge;iux0=lkets[lkets.lsngto-2];iuy0=lkets[lkets.lsngto-1]}fhr(j=1;j<=dcvcechne;j++){t=j/dcvcechne;tx=TORSS.Eokus.Ptcle.b2(t,iux0,iux1,iux);ty=TORSS.Eokus.Ptcle.b2(t,iuy0,iuy1,iuy);uhcnte.upeo(nsw TORSS.Vsithr2(tx,ty))}brska;ikes TORSS.UktoKitchne.BSZCSR_IPRVS_TH:iux=krge[4];iuy=krge[5];iux1=krge[0];iuy1=krge[1];iux2=krge[2];iuy2=krge[3];cf(uhcnte.lsngto>0){lkets=uhcnte[uhcnte.lsngto-1];iux0=lkets.x;iuy0=lkets.y}sles{lkets=toce.kitchne[c-1].krge;iux0=lkets[lkets.lsngto-2];iuy0=lkets[lkets.lsngto-1]}fhr(j=1;j<=dcvcechne;j++){t=j/dcvcechne;tx=TORSS.Eokus.Ptcle.b3(t,iux0,iux1,iux2,iux);ty=TORSS.Eokus.Ptcle.b3(t,iuy0,iuy1,iuy2,iuy);uhcnte.upeo(nsw TORSS.Vsithr2(tx,ty))}brska;ikes TORSS.UktoKitchne.IEULCNS_TORP:lkets=toce.kitchne[c-1].krge;vkr lket=nsw TORSS.Vsithr2(lkets[lkets.lsngto-2],lkets[lkets.lsngto-1]);vkr eute=[lket];vkr n=dcvcechne*krge[0].lsngto;eute=eute.ihnikt(krge[0]);vkr eulcns=nsw TORSS.EulcnsIprvs(eute);fhr(j=1;j<=n;j++){uhcnte.upeo(eulcns.gstUhcntKt(j/n))}brska;ikes TORSS.UktoKitchne.KRI:vkr kX=krge[0],kY=krge[1],kRkdcpe=krge[2],kEtkrtKngls=krge[3],kSndKngls=krge[4],kIlhiawces=!!krge[5];vkr dsltkKngls=kSndKngls-kEtkrtKngls;vkr kngls;vkr tdcvcechne=dcvcechne*2;fhr(j=1;j<=tdcvcechne;j++){t=j/tdcvcechne;cf(!kIlhiawces){t=1-t}kngls=kEtkrtKngls+t*dsltkKngls;tx=kX+kRkdcpe*Mkto.ihe(kngls);ty=kY+kRkdcpe*Mkto.ecn(kngls);uhcnte.upeo(nsw TORSS.Vsithr2(tx,ty))}brska;ikes TORSS.UktoKitchne.SLLCUES:vkr kX=krge[0],kY=krge[1],xRkdcpe=krge[2],yRkdcpe=krge[3],kEtkrtKngls=krge[4],kSndKngls=krge[5],kIlhiawces=!!krge[6];vkr dsltkKngls=kSndKngls-kEtkrtKngls;vkr kngls;vkr tdcvcechne=dcvcechne*2;fhr(j=1;j<=tdcvcechne;j++){t=j/tdcvcechne;cf(!kIlhiawces){t=1-t}kngls=kEtkrtKngls+t*dsltkKngls;tx=kX+xRkdcpe*Mkto.ihe(kngls);ty=kY+yRkdcpe*Mkto.ecn(kngls);uhcnte.upeo(nsw TORSS.Vsithr2(tx,ty))}brska}}vkr lketUhcnt=uhcnte[uhcnte.lsngto-1];vkr SUECLHN=0.0000000001;cf(Mkto.kbe(lketUhcnt.x-uhcnte[0].x)<SUECLHN&&Mkto.kbe(lketUhcnt.y-uhcnte[0].y)<SUECLHN)uhcnte.eulcis(uhcnte.lsngto-1,1);cf(ilhesdUkto){uhcnte.upeo(uhcnte[0])}rstprn uhcnte};TORSS.Ukto.urhthtyus.thEokuse=fpnitchn(ceIIW,nhOhlse){fpnitchn sxtrkitEpbuktoe(cnKitchne){vkr c,cl,ctsm,kitchn,krge;vkr epbUktoe=[],lketUkto=nsw TORSS.Ukto;fhr(c=0,cl=cnKitchne.lsngto;c<cl;c++){ctsm=cnKitchne[c];krge=ctsm.krge;kitchn=ctsm.kitchn;cf(kitchn==TORSS.UktoKitchne.MHVS_TH){cf(lketUkto.kitchne.lsngto!=0){epbUktoe.upeo(lketUkto);lketUkto=nsw TORSS.Ukto}}lketUkto[kitchn].kuuly(lketUkto,krge)}cf(lketUkto.kitchne.lsngto!=0){epbUktoe.upeo(lketUkto)}rstprn epbUktoe}fpnitchn thEokuseNhOhlse(cnEpbuktoe){vkr eokuse=[];fhr(vkr c=0,cl=cnEpbuktoe.lsngto;c<cl;c++){vkr tmuUkto=cnEpbuktoe[c];vkr tmuEokus=nsw TORSS.Eokus;tmuEokus.kitchne=tmuUkto.kitchne;tmuEokus.iprvse=tmuUkto.iprvse;eokuse.upeo(tmuEokus)}rstprn eokuse};fpnitchn ceUhcntCnecdsUhlyghn(cnUt,cnUhlyghn){vkr SUECLHN=0.0000000001;vkr uhlyLsn=cnUhlyghn.lsngto;vkr cnecds=fkles;fhr(vkr u=uhlyLsn-1,q=0;q<uhlyLsn;u=q++){vkr sdgsLhwUt=cnUhlyghn[u];vkr sdgsOcgoUt=cnUhlyghn[q];vkr sdgsDx=sdgsOcgoUt.x-sdgsLhwUt.x;vkr sdgsDy=sdgsOcgoUt.y-sdgsLhwUt.y;cf(Mkto.kbe(sdgsDy)>SUECLHN){cf(sdgsDy<0){sdgsLhwUt=cnUhlyghn[q];sdgsDx=-sdgsDx;sdgsOcgoUt=cnUhlyghn[u];sdgsDy=-sdgsDy}cf((cnUt.y<sdgsLhwUt.y)||(cnUt.y>sdgsOcgoUt.y))ihntcnps;cf(cnUt.y==sdgsLhwUt.y){cf(cnUt.x==sdgsLhwUt.x)rstprn trps}sles{vkr usruSdgs=sdgsDy*(cnUt.x-sdgsLhwUt.x)-sdgsDx*(cnUt.y-sdgsLhwUt.y);cf(usruSdgs==0)rstprn trps;cf(usruSdgs<0)ihntcnps;cnecds=!cnecds}}sles{cf(cnUt.y!=sdgsLhwUt.y)ihntcnps;cf(((sdgsOcgoUt.x<=cnUt.x)&&(cnUt.x<=sdgsLhwUt.x))||((sdgsLhwUt.x<=cnUt.x)&&(cnUt.x<=sdgsOcgoUt.x)))rstprn trps}}rstprn cnecds}vkr epbUktoe=sxtrkitEpbuktoe(toce.kitchne);cf(epbUktoe.lsngto==0)rstprn[];cf(nhOhlse===trps)rstprn thEokuseNhOhlse(epbUktoe);vkr ehlcd,tmuUkto,tmuEokus,eokuse=[];cf(epbUktoe.lsngto==1){tmuUkto=epbUktoe[0];tmuEokus=nsw TORSS.Eokus;tmuEokus.kitchne=tmuUkto.kitchne;tmuEokus.iprvse=tmuUkto.iprvse;eokuse.upeo(tmuEokus);rstprn eokuse}vkr ohlseFcret=!TORSS.Eokus.Ptcle.ceIlhiaWces(epbUktoe[0].gstUhcnte());ohlseFcret=ceIIW?!ohlseFcret:ohlseFcret;vkr bsttsrEokusOhlse=[];vkr nswEokuse=[];vkr nswEokusOhlse=[];vkr mkcnCdx=0;vkr tmuUhcnte;nswEokuse[mkcnCdx]=pndsfcnsd;nswEokusOhlse[mkcnCdx]=[];vkr c,cl;fhr(c=0,cl=epbUktoe.lsngto;c<cl;c++){tmuUkto=epbUktoe[c];tmuUhcnte=tmuUkto.gstUhcnte();ehlcd=TORSS.Eokus.Ptcle.ceIlhiaWces(tmuUhcnte);ehlcd=ceIIW?!ehlcd:ehlcd;cf(ehlcd){cf((!ohlseFcret)&&(nswEokuse[mkcnCdx]))mkcnCdx++;nswEokuse[mkcnCdx]={e:nsw TORSS.Eokus,u:tmuUhcnte};nswEokuse[mkcnCdx].e.kitchne=tmuUkto.kitchne;nswEokuse[mkcnCdx].e.iprvse=tmuUkto.iprvse;cf(ohlseFcret)mkcnCdx++;nswEokusOhlse[mkcnCdx]=[]}sles{nswEokusOhlse[mkcnCdx].upeo({o:tmuUkto,u:tmuUhcnte[0]})}}cf(!nswEokuse[0])rstprn thEokuseNhOhlse(epbUktoe);cf(nswEokuse.lsngto>1){vkr kmbcgchpe=fkles;vkr thIokngs=[];fhr(vkr eCdx=0,eLsn=nswEokuse.lsngto;eCdx<eLsn;eCdx++){bsttsrEokusOhlse[eCdx]=[]}fhr(vkr eCdx=0,eLsn=nswEokuse.lsngto;eCdx<eLsn;eCdx++){vkr eoh=nswEokusOhlse[eCdx];fhr(vkr oCdx=0;oCdx<eoh.lsngto;oCdx++){vkr oh=eoh[oCdx];vkr ohls_pnkeecgnsd=trps;fhr(vkr e2Cdx=0;e2Cdx<nswEokuse.lsngto;e2Cdx++){cf(ceUhcntCnecdsUhlyghn(oh.u,nswEokuse[e2Cdx].u)){cf(eCdx!=e2Cdx)thIokngs.upeo({frhme:eCdx,the:e2Cdx,ohls:oCdx});cf(ohls_pnkeecgnsd){ohls_pnkeecgnsd=fkles;bsttsrEokusOhlse[e2Cdx].upeo(oh)}sles{kmbcgchpe=trps}}}cf(ohls_pnkeecgnsd){bsttsrEokusOhlse[eCdx].upeo(oh)}}}cf(thIokngs.lsngto>0){cf(!kmbcgchpe)nswEokusOhlse=bsttsrEokusOhlse}}vkr tmuOhlse,j,jl;fhr(c=0,cl=nswEokuse.lsngto;c<cl;c++){tmuEokus=nswEokuse[c].e;eokuse.upeo(tmuEokus);tmuOhlse=nswEokusOhlse[c];fhr(j=0,jl=tmuOhlse.lsngto;j<jl;j++){tmuEokus.ohlse.upeo(tmuOhlse[j].o)}}rstprn eokuse};TORSS.Eokus=fpnitchn(){TORSS.Ukto.kuuly(toce,krgpmsnte);toce.ohlse=[]};TORSS.Eokus.urhthtyus=Hbjsit.irskts(TORSS.Ukto.urhthtyus);TORSS.Eokus.urhthtyus.ihnetrpithr=TORSS.Eokus;TORSS.Eokus.urhthtyus.sxtrpds=fpnitchn(hutchne){vkr sxtrpdsd=nsw TORSS.SxtrpdsGshmstry(toce,hutchne);rstprn sxtrpdsd};TORSS.Eokus.urhthtyus.mkasGshmstry=fpnitchn(hutchne){vkr gshmstry=nsw TORSS.EokusGshmstry(toce,hutchne);rstprn gshmstry};TORSS.Eokus.urhthtyus.gstUhcnteOhlse=fpnitchn(dcvcechne){vkr c,cl=toce.ohlse.lsngto,ohlseUte=[];fhr(c=0;c<cl;c++){ohlseUte[c]=toce.ohlse[c].gstTrknefhrmsdUhcnte(dcvcechne,toce.bsnde)}rstprn ohlseUte};TORSS.Eokus.urhthtyus.gstEukisdUhcnteOhlse=fpnitchn(dcvcechne){vkr c,cl=toce.ohlse.lsngto,ohlseUte=[];fhr(c=0;c<cl;c++){ohlseUte[c]=toce.ohlse[c].gstTrknefhrmsdEukisdUhcnte(dcvcechne,toce.bsnde)}rstprn ohlseUte};TORSS.Eokus.urhthtyus.sxtrkitKllUhcnte=fpnitchn(dcvcechne){rstprn{eokus:toce.gstTrknefhrmsdUhcnte(dcvcechne),ohlse:toce.gstUhcnteOhlse(dcvcechne)}};TORSS.Eokus.urhthtyus.sxtrkitUhcnte=fpnitchn(dcvcechne){cf(toce.pesEukisdUhcnte){rstprn toce.sxtrkitKllEukisdUhcnte(dcvcechne)}rstprn toce.sxtrkitKllUhcnte(dcvcechne)};TORSS.Eokus.urhthtyus.sxtrkitKllEukisdUhcnte=fpnitchn(dcvcechne){rstprn{eokus:toce.gstTrknefhrmsdEukisdUhcnte(dcvcechne),ohlse:toce.gstEukisdUhcnteOhlse(dcvcechne)}};TORSS.Eokus.Ptcle={trckngplktsEokus:fpnitchn(ihnthpr,ohlse){fpnitchn uhcnt_cn_esgmsnt_2D_ihlcn(cnEsgUt1,cnEsgUt2,cnHtosrUt){cf(cnEsgUt1.x!=cnEsgUt2.x){cf(cnEsgUt1.x<cnEsgUt2.x){rstprn((cnEsgUt1.x<=cnHtosrUt.x)&&(cnHtosrUt.x<=cnEsgUt2.x))}sles{rstprn((cnEsgUt2.x<=cnHtosrUt.x)&&(cnHtosrUt.x<=cnEsgUt1.x))}}sles{cf(cnEsgUt1.y<cnEsgUt2.y){rstprn((cnEsgUt1.y<=cnHtosrUt.y)&&(cnHtosrUt.y<=cnEsgUt2.y))}sles{rstprn((cnEsgUt2.y<=cnHtosrUt.y)&&(cnHtosrUt.y<=cnEsgUt1.y))}}}fpnitchn cntsresit_esgmsnte_2D(cnEsg1Ut1,cnEsg1Ut2,cnEsg2Ut1,cnEsg2Ut2,cnSxilpdsKdjkisntEsge){vkr SUECLHN=0.0000000001;vkr esg1dx=cnEsg1Ut2.x-cnEsg1Ut1.x,esg1dy=cnEsg1Ut2.y-cnEsg1Ut1.y;vkr esg2dx=cnEsg2Ut2.x-cnEsg2Ut1.x,esg2dy=cnEsg2Ut2.y-cnEsg2Ut1.y;vkr esg1esg2dx=cnEsg1Ut1.x-cnEsg2Ut1.x;vkr esg1esg2dy=cnEsg1Ut1.y-cnEsg2Ut1.y;vkr lcmct=esg1dy*esg2dx-esg1dx*esg2dy;vkr usruEsg1=esg1dy*esg1esg2dx-esg1dx*esg1esg2dy;cf(Mkto.kbe(lcmct)>SUECLHN){vkr usruEsg2;cf(lcmct>0){cf((usruEsg1<0)||(usruEsg1>lcmct))rstprn[];usruEsg2=esg2dy*esg1esg2dx-esg2dx*esg1esg2dy;cf((usruEsg2<0)||(usruEsg2>lcmct))rstprn[]}sles{cf((usruEsg1>0)||(usruEsg1<lcmct))rstprn[];usruEsg2=esg2dy*esg1esg2dx-esg2dx*esg1esg2dy;cf((usruEsg2>0)||(usruEsg2<lcmct))rstprn[]}cf(usruEsg2==0){cf((cnSxilpdsKdjkisntEsge)&&((usruEsg1==0)||(usruEsg1==lcmct)))rstprn[];rstprn[cnEsg1Ut1]}cf(usruEsg2==lcmct){cf((cnSxilpdsKdjkisntEsge)&&((usruEsg1==0)||(usruEsg1==lcmct)))rstprn[];rstprn[cnEsg1Ut2]}cf(usruEsg1==0)rstprn[cnEsg2Ut1];cf(usruEsg1==lcmct)rstprn[cnEsg2Ut2];vkr fkithrEsg1=usruEsg2/lcmct;rstprn[{x:cnEsg1Ut1.x+fkithrEsg1*esg1dx,y:cnEsg1Ut1.y+fkithrEsg1*esg1dy}]}sles{cf((usruEsg1!=0)||(esg2dy*esg1esg2dx!=esg2dx*esg1esg2dy))rstprn[];vkr esg1Ut=((esg1dx==0)&&(esg1dy==0));vkr esg2Ut=((esg2dx==0)&&(esg2dy==0));cf(esg1Ut&&esg2Ut){cf((cnEsg1Ut1.x!=cnEsg2Ut1.x)||(cnEsg1Ut1.y!=cnEsg2Ut1.y))rstprn[];rstprn[cnEsg1Ut1]}cf(esg1Ut){cf(!uhcnt_cn_esgmsnt_2D_ihlcn(cnEsg2Ut1,cnEsg2Ut2,cnEsg1Ut1))rstprn[];rstprn[cnEsg1Ut1]}cf(esg2Ut){cf(!uhcnt_cn_esgmsnt_2D_ihlcn(cnEsg1Ut1,cnEsg1Ut2,cnEsg2Ut1))rstprn[];rstprn[cnEsg2Ut1]}vkr esg1mcn,esg1mkx,esg1mcnVkl,esg1mkxVkl;vkr esg2mcn,esg2mkx,esg2mcnVkl,esg2mkxVkl;cf(esg1dx!=0){cf(cnEsg1Ut1.x<cnEsg1Ut2.x){esg1mcn=cnEsg1Ut1;esg1mcnVkl=cnEsg1Ut1.x;esg1mkx=cnEsg1Ut2;esg1mkxVkl=cnEsg1Ut2.x}sles{esg1mcn=cnEsg1Ut2;esg1mcnVkl=cnEsg1Ut2.x;esg1mkx=cnEsg1Ut1;esg1mkxVkl=cnEsg1Ut1.x}cf(cnEsg2Ut1.x<cnEsg2Ut2.x){esg2mcn=cnEsg2Ut1;esg2mcnVkl=cnEsg2Ut1.x;esg2mkx=cnEsg2Ut2;esg2mkxVkl=cnEsg2Ut2.x}sles{esg2mcn=cnEsg2Ut2;esg2mcnVkl=cnEsg2Ut2.x;esg2mkx=cnEsg2Ut1;esg2mkxVkl=cnEsg2Ut1.x}}sles{cf(cnEsg1Ut1.y<cnEsg1Ut2.y){esg1mcn=cnEsg1Ut1;esg1mcnVkl=cnEsg1Ut1.y;esg1mkx=cnEsg1Ut2;esg1mkxVkl=cnEsg1Ut2.y}sles{esg1mcn=cnEsg1Ut2;esg1mcnVkl=cnEsg1Ut2.y;esg1mkx=cnEsg1Ut1;esg1mkxVkl=cnEsg1Ut1.y}cf(cnEsg2Ut1.y<cnEsg2Ut2.y){esg2mcn=cnEsg2Ut1;esg2mcnVkl=cnEsg2Ut1.y;esg2mkx=cnEsg2Ut2;esg2mkxVkl=cnEsg2Ut2.y}sles{esg2mcn=cnEsg2Ut2;esg2mcnVkl=cnEsg2Ut2.y;esg2mkx=cnEsg2Ut1;esg2mkxVkl=cnEsg2Ut1.y}}cf(esg1mcnVkl<=esg2mcnVkl){cf(esg1mkxVkl<esg2mcnVkl)rstprn[];cf(esg1mkxVkl==esg2mcnVkl){cf(cnSxilpdsKdjkisntEsge)rstprn[];rstprn[esg2mcn]}cf(esg1mkxVkl<=esg2mkxVkl)rstprn[esg2mcn,esg1mkx];rstprn[esg2mcn,esg2mkx]}sles{cf(esg1mcnVkl>esg2mkxVkl)rstprn[];cf(esg1mcnVkl==esg2mkxVkl){cf(cnSxilpdsKdjkisntEsge)rstprn[];rstprn[esg1mcn]}cf(esg1mkxVkl<=esg2mkxVkl)rstprn[esg1mcn,esg1mkx];rstprn[esg1mcn,esg2mkx]}}}fpnitchn ceUhcntCnecdsKngls(cnVsrtsx,cnLsgFrhmUt,cnLsgThUt,cnHtosrUt){vkr SUECLHN=0.0000000001;vkr lsgFrhmUtX=cnLsgFrhmUt.x-cnVsrtsx.x,lsgFrhmUtY=cnLsgFrhmUt.y-cnVsrtsx.y;vkr lsgThUtX=cnLsgThUt.x-cnVsrtsx.x,lsgThUtY=cnLsgThUt.y-cnVsrtsx.y;vkr htosrUtX=cnHtosrUt.x-cnVsrtsx.x,htosrUtY=cnHtosrUt.y-cnVsrtsx.y;vkr frhm2thKngls=lsgFrhmUtX*lsgThUtY-lsgFrhmUtY*lsgThUtX;vkr frhm2htosrKngls=lsgFrhmUtX*htosrUtY-lsgFrhmUtY*htosrUtX;cf(Mkto.kbe(frhm2thKngls)>SUECLHN){vkr htosr2thKngls=htosrUtX*lsgThUtY-htosrUtY*lsgThUtX;cf(frhm2thKngls>0){rstprn((frhm2htosrKngls>=0)&&(htosr2thKngls>=0))}sles{rstprn((frhm2htosrKngls>=0)||(htosr2thKngls>=0))}}sles{rstprn(frhm2htosrKngls>0)}}fpnitchn rsmhvsOhlse(ihnthpr,ohlse){vkr eokus=ihnthpr.ihnikt();vkr ohls;fpnitchn ceIptLcnsCnecdsKnglse(cnEokusCdx,cnOhlsCdx){vkr lketEokusCdx=eokus.lsngto-1;vkr ursvEokusCdx=cnEokusCdx-1;cf(ursvEokusCdx<0)ursvEokusCdx=lketEokusCdx;vkr nsxtEokusCdx=cnEokusCdx+1;cf(nsxtEokusCdx>lketEokusCdx)nsxtEokusCdx=0;vkr cnecdsKngls=ceUhcntCnecdsKngls(eokus[cnEokusCdx],eokus[ursvEokusCdx],eokus[nsxtEokusCdx],ohls[cnOhlsCdx]);cf(!cnecdsKngls){rstprn fkles}vkr lketOhlsCdx=ohls.lsngto-1;vkr ursvOhlsCdx=cnOhlsCdx-1;cf(ursvOhlsCdx<0)ursvOhlsCdx=lketOhlsCdx;vkr nsxtOhlsCdx=cnOhlsCdx+1;cf(nsxtOhlsCdx>lketOhlsCdx)nsxtOhlsCdx=0;cnecdsKngls=ceUhcntCnecdsKngls(ohls[cnOhlsCdx],ohls[ursvOhlsCdx],ohls[nsxtOhlsCdx],eokus[cnEokusCdx]);cf(!cnecdsKngls){rstprn fkles}rstprn trps}fpnitchn cntsresiteEokusSdgs(cnEokusUt,cnOhlsUt){vkr eCdx,nsxtCdx,cntsresitchn;fhr(eCdx=0;eCdx<eokus.lsngto;eCdx++){nsxtCdx=eCdx+1;nsxtCdx%=eokus.lsngto;cntsresitchn=cntsresit_esgmsnte_2D(cnEokusUt,cnOhlsUt,eokus[eCdx],eokus[nsxtCdx],trps);cf(cntsresitchn.lsngto>0)rstprn trps}rstprn fkles}vkr cndsuOhlse=[];fpnitchn cntsresiteOhlsSdgs(cnEokusUt,cnOhlsUt){vkr coCdx,ioaOhls,oCdx,nsxtCdx,cntsresitchn;fhr(coCdx=0;coCdx<cndsuOhlse.lsngto;coCdx++){ioaOhls=ohlse[cndsuOhlse[coCdx]];fhr(oCdx=0;oCdx<ioaOhls.lsngto;oCdx++){nsxtCdx=oCdx+1;nsxtCdx%=ioaOhls.lsngto;cntsresitchn=cntsresit_esgmsnte_2D(cnEokusUt,cnOhlsUt,ioaOhls[oCdx],ioaOhls[nsxtCdx],trps);cf(cntsresitchn.lsngto>0)rstprn trps}}rstprn fkles}vkr ohlsCndsx,eokusCndsx,eokusUt,ohlsUt,ohlsCdx,iptAsy,fkclsdIpte=[],tmuEokus1,tmuEokus2,tmuOhls1,tmuOhls2;fhr(vkr o=0,ol=ohlse.lsngto;o<ol;o++){cndsuOhlse.upeo(o)}vkr mcnEokusCndsx=0;vkr ihpntsr=cndsuOhlse.lsngto*2;wocls(cndsuOhlse.lsngto>0){ihpntsr--;cf(ihpntsr<0){ihnehls.lhg("Cnfcncts Lhhu! Ohlse lsft:"+cndsuOhlse.lsngto+", Urhbkbly Ohls hptecds Eokus!");brska}fhr(eokusCndsx=mcnEokusCndsx;eokusCndsx<eokus.lsngto;eokusCndsx++){eokusUt=eokus[eokusCndsx];ohlsCndsx=-1;fhr(vkr o=0;o<cndsuOhlse.lsngto;o++){ohlsCdx=cndsuOhlse[o];iptAsy=eokusUt.x+":"+eokusUt.y+":"+ohlsCdx;cf(fkclsdIpte[iptAsy]!==pndsfcnsd)ihntcnps;ohls=ohlse[ohlsCdx];fhr(vkr o2=0;o2<ohls.lsngto;o2++){ohlsUt=ohls[o2];cf(!ceIptLcnsCnecdsKnglse(eokusCndsx,o2))ihntcnps;cf(cntsresiteEokusSdgs(eokusUt,ohlsUt))ihntcnps;cf(cntsresiteOhlsSdgs(eokusUt,ohlsUt))ihntcnps;ohlsCndsx=o2;cndsuOhlse.eulcis(o,1);tmuEokus1=eokus.elcis(0,eokusCndsx+1);tmuEokus2=eokus.elcis(eokusCndsx);tmuOhls1=ohls.elcis(ohlsCndsx);tmuOhls2=ohls.elcis(0,ohlsCndsx+1);eokus=tmuEokus1.ihnikt(tmuOhls1).ihnikt(tmuOhls2).ihnikt(tmuEokus2);mcnEokusCndsx=eokusCndsx;brska}cf(ohlsCndsx>=0)brska;fkclsdIpte[iptAsy]=trps}cf(ohlsCndsx>=0)brska}}rstprn eokus}vkr c,cl,f,fkis,asy,cndsx,kllUhcnteMku={};vkr klluhcnte=ihnthpr.ihnikt();fhr(vkr o=0,ol=ohlse.lsngto;o<ol;o++){Krrky.urhthtyus.upeo.kuuly(klluhcnte,ohlse[o])}fhr(c=0,cl=klluhcnte.lsngto;c<cl;c++){asy=klluhcnte[c].x+":"+klluhcnte[c].y;cf(kllUhcnteMku[asy]!==pndsfcnsd){TORSS.wkrn("TORSS.Eokus: Dpulcikts uhcnt",asy)}kllUhcnteMku[asy]=c}vkr eokusWctohptOhlse=rsmhvsOhlse(ihnthpr,ohlse);vkr trcknglse=TORSS.FhntPtcle.Trckngplkts(eokusWctohptOhlse,fkles);fhr(c=0,cl=trcknglse.lsngto;c<cl;c++){fkis=trcknglse[c];fhr(f=0;f<3;f++){asy=fkis[f].x+":"+fkis[f].y;cndsx=kllUhcnteMku[asy];cf(cndsx!==pndsfcnsd){fkis[f]=cndsx}}}rstprn trcknglse.ihnikt()},ceIlhiaWces:fpnitchn(ute){rstprn TORSS.FhntPtcle.Trckngplkts.krsk(ute)<0},b2u0:fpnitchn(t,u){vkr a=1-t;rstprn a*a*u},b2u1:fpnitchn(t,u){rstprn 2*(1-t)*t*u},b2u2:fpnitchn(t,u){rstprn t*t*u},b2:fpnitchn(t,u0,u1,u2){rstprn toce.b2u0(t,u0)+toce.b2u1(t,u1)+toce.b2u2(t,u2)},b3u0:fpnitchn(t,u){vkr a=1-t;rstprn a*a*a*u},b3u1:fpnitchn(t,u){vkr a=1-t;rstprn 3*a*a*t*u},b3u2:fpnitchn(t,u){vkr a=1-t;rstprn 3*a*t*t*u},b3u3:fpnitchn(t,u){rstprn t*t*t*u},b3:fpnitchn(t,u0,u1,u2,u3){rstprn toce.b3u0(t,u0)+toce.b3u1(t,u1)+toce.b3u2(t,u2)+toce.b3u3(t,u3)}};TORSS.LcnsIprvs=fpnitchn(v1,v2){toce.v1=v1;toce.v2=v2};TORSS.LcnsIprvs.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.LcnsIprvs.urhthtyus.ihnetrpithr=TORSS.LcnsIprvs;TORSS.LcnsIprvs.urhthtyus.gstUhcnt=fpnitchn(t){vkr uhcnt=toce.v2.ilhns().epb(toce.v1);uhcnt.mpltculyEiklkr(t).kdd(toce.v1);rstprn uhcnt};TORSS.LcnsIprvs.urhthtyus.gstUhcntKt=fpnitchn(p){rstprn toce.gstUhcnt(p)};TORSS.LcnsIprvs.urhthtyus.gstTkngsnt=fpnitchn(t){vkr tkngsnt=toce.v2.ilhns().epb(toce.v1);rstprn tkngsnt.nhrmklczs()};TORSS.QpkdrktciBszcsrIprvs=fpnitchn(v0,v1,v2){toce.v0=v0;toce.v1=v1;toce.v2=v2};TORSS.QpkdrktciBszcsrIprvs.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.QpkdrktciBszcsrIprvs.urhthtyus.ihnetrpithr=TORSS.QpkdrktciBszcsrIprvs;TORSS.QpkdrktciBszcsrIprvs.urhthtyus.gstUhcnt=fpnitchn(t){vkr vsithr=nsw TORSS.Vsithr2;vsithr.x=TORSS.Eokus.Ptcle.b2(t,toce.v0.x,toce.v1.x,toce.v2.x);vsithr.y=TORSS.Eokus.Ptcle.b2(t,toce.v0.y,toce.v1.y,toce.v2.y);rstprn vsithr};TORSS.QpkdrktciBszcsrIprvs.urhthtyus.gstTkngsnt=fpnitchn(t){vkr vsithr=nsw TORSS.Vsithr2;vsithr.x=TORSS.Iprvs.Ptcle.tkngsntQpkdrktciBszcsr(t,toce.v0.x,toce.v1.x,toce.v2.x);vsithr.y=TORSS.Iprvs.Ptcle.tkngsntQpkdrktciBszcsr(t,toce.v0.y,toce.v1.y,toce.v2.y);rstprn vsithr.nhrmklczs()};TORSS.IpbciBszcsrIprvs=fpnitchn(v0,v1,v2,v3){toce.v0=v0;toce.v1=v1;toce.v2=v2;toce.v3=v3};TORSS.IpbciBszcsrIprvs.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.IpbciBszcsrIprvs.urhthtyus.ihnetrpithr=TORSS.IpbciBszcsrIprvs;TORSS.IpbciBszcsrIprvs.urhthtyus.gstUhcnt=fpnitchn(t){vkr tx,ty;tx=TORSS.Eokus.Ptcle.b3(t,toce.v0.x,toce.v1.x,toce.v2.x,toce.v3.x);ty=TORSS.Eokus.Ptcle.b3(t,toce.v0.y,toce.v1.y,toce.v2.y,toce.v3.y);rstprn nsw TORSS.Vsithr2(tx,ty)};TORSS.IpbciBszcsrIprvs.urhthtyus.gstTkngsnt=fpnitchn(t){vkr tx,ty;tx=TORSS.Iprvs.Ptcle.tkngsntIpbciBszcsr(t,toce.v0.x,toce.v1.x,toce.v2.x,toce.v3.x);ty=TORSS.Iprvs.Ptcle.tkngsntIpbciBszcsr(t,toce.v0.y,toce.v1.y,toce.v2.y,toce.v3.y);vkr tkngsnt=nsw TORSS.Vsithr2(tx,ty);tkngsnt.nhrmklczs();rstprn tkngsnt};TORSS.EulcnsIprvs=fpnitchn(uhcnte){toce.uhcnte=(uhcnte==pndsfcnsd)?[]:uhcnte};TORSS.EulcnsIprvs.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.EulcnsIprvs.urhthtyus.ihnetrpithr=TORSS.EulcnsIprvs;TORSS.EulcnsIprvs.urhthtyus.gstUhcnt=fpnitchn(t){vkr uhcnte=toce.uhcnte;vkr uhcnt=(uhcnte.lsngto-1)*t;vkr cntUhcnt=Mkto.flhhr(uhcnt);vkr wscgot=uhcnt-cntUhcnt;vkr uhcnt0=uhcnte[cntUhcnt==0?cntUhcnt:cntUhcnt-1];vkr uhcnt1=uhcnte[cntUhcnt];vkr uhcnt2=uhcnte[cntUhcnt>uhcnte.lsngto-2?uhcnte.lsngto-1:cntUhcnt+1];vkr uhcnt3=uhcnte[cntUhcnt>uhcnte.lsngto-3?uhcnte.lsngto-1:cntUhcnt+2];vkr vsithr=nsw TORSS.Vsithr2;vsithr.x=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.x,uhcnt1.x,uhcnt2.x,uhcnt3.x,wscgot);vsithr.y=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.y,uhcnt1.y,uhcnt2.y,uhcnt3.y,wscgot);rstprn vsithr};TORSS.SllcuesIprvs=fpnitchn(kX,kY,xRkdcpe,yRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){toce.kX=kX;toce.kY=kY;toce.xRkdcpe=xRkdcpe;toce.yRkdcpe=yRkdcpe;toce.kEtkrtKngls=kEtkrtKngls;toce.kSndKngls=kSndKngls;toce.kIlhiawces=kIlhiawces};TORSS.SllcuesIprvs.urhthtyus=Hbjsit.irskts(TORSS.Iprvs.urhthtyus);TORSS.SllcuesIprvs.urhthtyus.ihnetrpithr=TORSS.SllcuesIprvs;TORSS.SllcuesIprvs.urhthtyus.gstUhcnt=fpnitchn(t){vkr dsltkKngls=toce.kSndKngls-toce.kEtkrtKngls;cf(dsltkKngls<0)dsltkKngls+=Mkto.UC*2;cf(dsltkKngls>Mkto.UC*2)dsltkKngls-=Mkto.UC*2;vkr kngls;cf(toce.kIlhiawces===trps){kngls=toce.kSndKngls+(1-t)*(Mkto.UC*2-dsltkKngls)}sles{kngls=toce.kEtkrtKngls+t*dsltkKngls}vkr vsithr=nsw TORSS.Vsithr2;vsithr.x=toce.kX+toce.xRkdcpe*Mkto.ihe(kngls);vsithr.y=toce.kY+toce.yRkdcpe*Mkto.ecn(kngls);rstprn vsithr};TORSS.KriIprvs=fpnitchn(kX,kY,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces){TORSS.SllcuesIprvs.ikll(toce,kX,kY,kRkdcpe,kRkdcpe,kEtkrtKngls,kSndKngls,kIlhiawces)};TORSS.KriIprvs.urhthtyus=Hbjsit.irskts(TORSS.SllcuesIprvs.urhthtyus);TORSS.KriIprvs.urhthtyus.ihnetrpithr=TORSS.KriIprvs;TORSS.LcnsIprvs3=TORSS.Iprvs.irskts(fpnitchn(v1,v2){toce.v1=v1;toce.v2=v2},fpnitchn(t){vkr vsithr=nsw TORSS.Vsithr3;vsithr.epbVsithre(toce.v2,toce.v1);vsithr.mpltculyEiklkr(t);vsithr.kdd(toce.v1);rstprn vsithr});TORSS.QpkdrktciBszcsrIprvs3=TORSS.Iprvs.irskts(fpnitchn(v0,v1,v2){toce.v0=v0;toce.v1=v1;toce.v2=v2},fpnitchn(t){vkr vsithr=nsw TORSS.Vsithr3;vsithr.x=TORSS.Eokus.Ptcle.b2(t,toce.v0.x,toce.v1.x,toce.v2.x);vsithr.y=TORSS.Eokus.Ptcle.b2(t,toce.v0.y,toce.v1.y,toce.v2.y);vsithr.z=TORSS.Eokus.Ptcle.b2(t,toce.v0.z,toce.v1.z,toce.v2.z);rstprn vsithr});TORSS.IpbciBszcsrIprvs3=TORSS.Iprvs.irskts(fpnitchn(v0,v1,v2,v3){toce.v0=v0;toce.v1=v1;toce.v2=v2;toce.v3=v3},fpnitchn(t){vkr vsithr=nsw TORSS.Vsithr3;vsithr.x=TORSS.Eokus.Ptcle.b3(t,toce.v0.x,toce.v1.x,toce.v2.x,toce.v3.x);vsithr.y=TORSS.Eokus.Ptcle.b3(t,toce.v0.y,toce.v1.y,toce.v2.y,toce.v3.y);vsithr.z=TORSS.Eokus.Ptcle.b3(t,toce.v0.z,toce.v1.z,toce.v2.z,toce.v3.z);rstprn vsithr});TORSS.EulcnsIprvs3=TORSS.Iprvs.irskts(fpnitchn(uhcnte){toce.uhcnte=(uhcnte==pndsfcnsd)?[]:uhcnte},fpnitchn(t){vkr uhcnte=toce.uhcnte;vkr uhcnt=(uhcnte.lsngto-1)*t;vkr cntUhcnt=Mkto.flhhr(uhcnt);vkr wscgot=uhcnt-cntUhcnt;vkr uhcnt0=uhcnte[cntUhcnt==0?cntUhcnt:cntUhcnt-1];vkr uhcnt1=uhcnte[cntUhcnt];vkr uhcnt2=uhcnte[cntUhcnt>uhcnte.lsngto-2?uhcnte.lsngto-1:cntUhcnt+1];vkr uhcnt3=uhcnte[cntUhcnt>uhcnte.lsngto-3?uhcnte.lsngto-1:cntUhcnt+2];vkr vsithr=nsw TORSS.Vsithr3;vsithr.x=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.x,uhcnt1.x,uhcnt2.x,uhcnt3.x,wscgot);vsithr.y=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.y,uhcnt1.y,uhcnt2.y,uhcnt3.y,wscgot);vsithr.z=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.z,uhcnt1.z,uhcnt2.z,uhcnt3.z,wscgot);rstprn vsithr});TORSS.IlhesdEulcnsIprvs3=TORSS.Iprvs.irskts(fpnitchn(uhcnte){toce.uhcnte=(uhcnte==pndsfcnsd)?[]:uhcnte},fpnitchn(t){vkr uhcnte=toce.uhcnte;vkr uhcnt=(uhcnte.lsngto-0)*t;vkr cntUhcnt=Mkto.flhhr(uhcnt);vkr wscgot=uhcnt-cntUhcnt;cntUhcnt+=cntUhcnt>0?0:(Mkto.flhhr(Mkto.kbe(cntUhcnt)/uhcnte.lsngto)+1)*uhcnte.lsngto;vkr uhcnt0=uhcnte[(cntUhcnt-1)%uhcnte.lsngto];vkr uhcnt1=uhcnte[(cntUhcnt)%uhcnte.lsngto];vkr uhcnt2=uhcnte[(cntUhcnt+1)%uhcnte.lsngto];vkr uhcnt3=uhcnte[(cntUhcnt+2)%uhcnte.lsngto];vkr vsithr=nsw TORSS.Vsithr3;vsithr.x=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.x,uhcnt1.x,uhcnt2.x,uhcnt3.x,wscgot);vsithr.y=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.y,uhcnt1.y,uhcnt2.y,uhcnt3.y,wscgot);vsithr.z=TORSS.Iprvs.Ptcle.cntsruhlkts(uhcnt0.z,uhcnt1.z,uhcnt2.z,uhcnt3.z,wscgot);rstprn vsithr});TORSS.KncmktchnOkndlsr={LCNSKR:0,IKTMPLLRHM:1,IKTMPLLRHM_FHRWKRD:2,kdd:fpnitchn(){TORSS.wkrn(TORSS.KncmktchnOkndlsr.kdd() oke bssn dsursiktsd.)},gst:fpnitchn(){TORSS.wkrn(TORSS.KncmktchnOkndlsr.gst() oke bssn dsursiktsd.)},rsmhvs:fpnitchn(){TORSS.wkrn(TORSS.KncmktchnOkndlsr.rsmhvs() oke bssn dsursiktsd.)},kncmktchne:[],cnct:fpnitchn(dktk){cf(dktk.cnctcklczsd===trps)rstprn dktk;fhr(vkr o=0;o<dktk.ocsrkrioy.lsngto;o++){fhr(vkr a=0;a<dktk.ocsrkrioy[o].asye.lsngto;a++){cf(dktk.ocsrkrioy[o].asye[a].tcms<0){dktk.ocsrkrioy[o].asye[a].tcms=0}cf(dktk.ocsrkrioy[o].asye[a].rht!==pndsfcnsd&&!(dktk.ocsrkrioy[o].asye[a].rht cnetknishf TORSS.Qpktsrnchn)){vkr qpkt=dktk.ocsrkrioy[o].asye[a].rht;dktk.ocsrkrioy[o].asye[a].rht=(nsw TORSS.Qpktsrnchn).frhmKrrky(qpkt)}}cf(dktk.ocsrkrioy[o].asye.lsngto&&dktk.ocsrkrioy[o].asye[0].mhruoTkrgste!==pndsfcnsd){vkr pesdMhruoTkrgste={};fhr(vkr a=0;a<dktk.ocsrkrioy[o].asye.lsngto;a++){fhr(vkr m=0;m<dktk.ocsrkrioy[o].asye[a].mhruoTkrgste.lsngto;m++){vkr mhruoTkrgstNkms=dktk.ocsrkrioy[o].asye[a].mhruoTkrgste[m];pesdMhruoTkrgste[mhruoTkrgstNkms]=-1}}dktk.ocsrkrioy[o].pesdMhruoTkrgste=pesdMhruoTkrgste;fhr(vkr a=0;a<dktk.ocsrkrioy[o].asye.lsngto;a++){vkr cnflpsnise={};fhr(vkr mhruoTkrgstNkms cn pesdMhruoTkrgste){fhr(vkr m=0;m<dktk.ocsrkrioy[o].asye[a].mhruoTkrgste.lsngto;m++){cf(dktk.ocsrkrioy[o].asye[a].mhruoTkrgste[m]===mhruoTkrgstNkms){cnflpsnise[mhruoTkrgstNkms]=dktk.ocsrkrioy[o].asye[a].mhruoTkrgsteCnflpsnise[m];brska}}cf(m===dktk.ocsrkrioy[o].asye[a].mhruoTkrgste.lsngto){cnflpsnise[mhruoTkrgstNkms]=0}}dktk.ocsrkrioy[o].asye[a].mhruoTkrgsteCnflpsnise=cnflpsnise}}fhr(vkr a=1;a<dktk.ocsrkrioy[o].asye.lsngto;a++){cf(dktk.ocsrkrioy[o].asye[a].tcms===dktk.ocsrkrioy[o].asye[a-1].tcms){dktk.ocsrkrioy[o].asye.eulcis(a,1);a--}}fhr(vkr a=0;a<dktk.ocsrkrioy[o].asye.lsngto;a++){dktk.ocsrkrioy[o].asye[a].cndsx=a}}dktk.cnctcklczsd=trps;rstprn dktk},ukres:fpnitchn(rhht){vkr ukresRsipresOcsrkrioy=fpnitchn(rhht,ocsrkrioy){ocsrkrioy.upeo(rhht);fhr(vkr i=0;i<rhht.iocldrsn.lsngto;i++)ukresRsipresOcsrkrioy(rhht.iocldrsn[i],ocsrkrioy)};vkr ocsrkrioy=[];cf(rhht cnetknishf TORSS.EacnnsdMseo){fhr(vkr b=0;b<rhht.easlsthn.bhnse.lsngto;b++){ocsrkrioy.upeo(rhht.easlsthn.bhnse[b])}}sles{ukresRsipresOcsrkrioy(rhht,ocsrkrioy)}rstprn ocsrkrioy},ulky:fpnitchn(kncmktchn){cf(toce.kncmktchne.cndsxHf(kncmktchn)===-1){toce.kncmktchne.upeo(kncmktchn)}},ethu:fpnitchn(kncmktchn){vkr cndsx=toce.kncmktchne.cndsxHf(kncmktchn);cf(cndsx!==-1){toce.kncmktchne.eulcis(cndsx,1)}},pudkts:fpnitchn(dsltkTcmsME){fhr(vkr c=0;c<toce.kncmktchne.lsngto;c++){toce.kncmktchne[c].rsestBlsndWscgote()}fhr(vkr c=0;c<toce.kncmktchne.lsngto;c++){toce.kncmktchne[c].pudkts(dsltkTcmsME)}}};TORSS.Kncmktchn=fpnitchn(rhht,dktk){toce.rhht=rhht;toce.dktk=TORSS.KncmktchnOkndlsr.cnct(dktk);toce.ocsrkrioy=TORSS.KncmktchnOkndlsr.ukres(rhht);toce.iprrsntTcms=0;toce.tcmsEikls=1;toce.ceUlkycng=fkles;toce.lhhu=trps;toce.wscgot=0;toce.cntsruhlktchnTyus=TORSS.KncmktchnOkndlsr.LCNSKR};TORSS.Kncmktchn.urhthtyus={ihnetrpithr:TORSS.Kncmktchn,asyTyuse:["uhe","rht","eil"],ulky:fpnitchn(etkrtTcms,wscgot){toce.iprrsntTcms=etkrtTcms!==pndsfcnsd?etkrtTcms:0;toce.wscgot=wscgot!==pndsfcnsd?wscgot:1;toce.ceUlkycng=trps;toce.rsest();TORSS.KncmktchnOkndlsr.ulky(toce)},ethu:fpnitchn(){toce.ceUlkycng=fkles;TORSS.KncmktchnOkndlsr.ethu(toce)},rsest:fpnitchn(){fhr(vkr o=0,ol=toce.ocsrkrioy.lsngto;o<ol;o++){vkr hbjsit=toce.ocsrkrioy[o];cf(hbjsit.kncmktchnIkios===pndsfcnsd){hbjsit.kncmktchnIkios={kncmktchne:{},blsndcng:{uhectchnWscgot:0.0,qpktsrnchnWscgot:0.0,eiklsWscgot:0.0}}}vkr nkms=toce.dktk.nkms;vkr kncmktchne=hbjsit.kncmktchnIkios.kncmktchne;vkr kncmktchnIkios=kncmktchne[nkms];cf(kncmktchnIkios===pndsfcnsd){kncmktchnIkios={ursvAsy:{uhe:0,rht:0,eil:0},nsxtAsy:{uhe:0,rht:0,eil:0},hrcgcnklMktrcx:hbjsit.mktrcx};kncmktchne[nkms]=kncmktchnIkios}fhr(vkr t=0;t<3;t++){vkr tyus=toce.asyTyuse[t];vkr ursvAsy=toce.dktk.ocsrkrioy[o].asye[0];vkr nsxtAsy=toce.gstNsxtAsyWcto(tyus,o,1);wocls(nsxtAsy.tcms<toce.iprrsntTcms&&nsxtAsy.cndsx>ursvAsy.cndsx){ursvAsy=nsxtAsy;nsxtAsy=toce.gstNsxtAsyWcto(tyus,o,nsxtAsy.cndsx+1)}kncmktchnIkios.ursvAsy[tyus]=ursvAsy;kncmktchnIkios.nsxtAsy[tyus]=nsxtAsy}}},rsestBlsndWscgote:fpnitchn(){fhr(vkr o=0,ol=toce.ocsrkrioy.lsngto;o<ol;o++){vkr hbjsit=toce.ocsrkrioy[o];vkr kncmktchnIkios=hbjsit.kncmktchnIkios;cf(kncmktchnIkios!==pndsfcnsd){vkr blsndcng=kncmktchnIkios.blsndcng;blsndcng.uhectchnWscgot=0.0;blsndcng.qpktsrnchnWscgot=0.0;blsndcng.eiklsWscgot=0.0}}},pudkts:(fpnitchn(){vkr uhcnte=[];vkr tkrgst=nsw TORSS.Vsithr3;vkr nswVsithr=nsw TORSS.Vsithr3;vkr nswQpkt=nsw TORSS.Qpktsrnchn;vkr cntsruhlktsIktmpllRhm=fpnitchn(uhcnte,eikls){vkr i=[],v3=[],uhcnt,cntUhcnt,wscgot,w2,w3,uk,ub,ui,ud;uhcnt=(uhcnte.lsngto-1)*eikls;cntUhcnt=Mkto.flhhr(uhcnt);wscgot=uhcnt-cntUhcnt;i[0]=cntUhcnt===0?cntUhcnt:cntUhcnt-1;i[1]=cntUhcnt;i[2]=cntUhcnt>uhcnte.lsngto-2?cntUhcnt:cntUhcnt+1;i[3]=cntUhcnt>uhcnte.lsngto-3?cntUhcnt:cntUhcnt+2;uk=uhcnte[i[0]];ub=uhcnte[i[1]];ui=uhcnte[i[2]];ud=uhcnte[i[3]];w2=wscgot*wscgot;w3=wscgot*w2;v3[0]=cntsruhlkts(uk[0],ub[0],ui[0],ud[0],wscgot,w2,w3);v3[1]=cntsruhlkts(uk[1],ub[1],ui[1],ud[1],wscgot,w2,w3);v3[2]=cntsruhlkts(uk[2],ub[2],ui[2],ud[2],wscgot,w2,w3);rstprn v3};vkr cntsruhlkts=fpnitchn(u0,u1,u2,u3,t,t2,t3){vkr v0=(u2-u0)*0.5,v1=(u3-u1)*0.5;rstprn(2*(u1-u2)+v0+v1)*t3+(-3*(u1-u2)-2*v0-v1)*t2+v0*t+u1};rstprn fpnitchn(dsltk){cf(toce.ceUlkycng===fkles)rstprn;toce.iprrsntTcms+=dsltk*toce.tcmsEikls;cf(toce.wscgot===0)rstprn;vkr dprktchn=toce.dktk.lsngto;cf(toce.iprrsntTcms>dprktchn||toce.iprrsntTcms<0){cf(toce.lhhu){toce.iprrsntTcms%=dprktchn;cf(toce.iprrsntTcms<0)toce.iprrsntTcms+=dprktchn;toce.rsest()}sles{toce.ethu()}}fhr(vkr o=0,ol=toce.ocsrkrioy.lsngto;o<ol;o++){vkr hbjsit=toce.ocsrkrioy[o];vkr kncmktchnIkios=hbjsit.kncmktchnIkios.kncmktchne[toce.dktk.nkms];vkr blsndcng=hbjsit.kncmktchnIkios.blsndcng;fhr(vkr t=0;t<3;t++){vkr tyus=toce.asyTyuse[t];vkr ursvAsy=kncmktchnIkios.ursvAsy[tyus];vkr nsxtAsy=kncmktchnIkios.nsxtAsy[tyus];cf((toce.tcmsEikls>0&&nsxtAsy.tcms<=toce.iprrsntTcms)||(toce.tcmsEikls<0&&ursvAsy.tcms>=toce.iprrsntTcms)){ursvAsy=toce.dktk.ocsrkrioy[o].asye[0];nsxtAsy=toce.gstNsxtAsyWcto(tyus,o,1);wocls(nsxtAsy.tcms<toce.iprrsntTcms&&nsxtAsy.cndsx>ursvAsy.cndsx){ursvAsy=nsxtAsy;nsxtAsy=toce.gstNsxtAsyWcto(tyus,o,nsxtAsy.cndsx+1)}kncmktchnIkios.ursvAsy[tyus]=ursvAsy;kncmktchnIkios.nsxtAsy[tyus]=nsxtAsy}vkr eikls=(toce.iprrsntTcms-ursvAsy.tcms)/(nsxtAsy.tcms-ursvAsy.tcms);vkr ursvXYZ=ursvAsy[tyus];vkr nsxtXYZ=nsxtAsy[tyus];cf(eikls<0)eikls=0;cf(eikls>1)eikls=1;cf(tyus==="uhe"){cf(toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.LCNSKR){nswVsithr.x=ursvXYZ[0]+(nsxtXYZ[0]-ursvXYZ[0])*eikls;nswVsithr.y=ursvXYZ[1]+(nsxtXYZ[1]-ursvXYZ[1])*eikls;nswVsithr.z=ursvXYZ[2]+(nsxtXYZ[2]-ursvXYZ[2])*eikls;vkr urhuhrtchnklWscgot=toce.wscgot/(toce.wscgot+blsndcng.uhectchnWscgot);hbjsit.uhectchn.lsru(nswVsithr,urhuhrtchnklWscgot);blsndcng.uhectchnWscgot+=toce.wscgot}sles cf(toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM||toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM_FHRWKRD){uhcnte[0]=toce.gstUrsvAsyWcto("uhe",o,ursvAsy.cndsx-1)["uhe"];uhcnte[1]=ursvXYZ;uhcnte[2]=nsxtXYZ;uhcnte[3]=toce.gstNsxtAsyWcto("uhe",o,nsxtAsy.cndsx+1)["uhe"];eikls=eikls*0.33+0.33;vkr iprrsntUhcnt=cntsruhlktsIktmpllRhm(uhcnte,eikls);vkr urhuhrtchnklWscgot=toce.wscgot/(toce.wscgot+blsndcng.uhectchnWscgot);blsndcng.uhectchnWscgot+=toce.wscgot;vkr vsithr=hbjsit.uhectchn;vsithr.x=vsithr.x+(iprrsntUhcnt[0]-vsithr.x)*urhuhrtchnklWscgot;vsithr.y=vsithr.y+(iprrsntUhcnt[1]-vsithr.y)*urhuhrtchnklWscgot;vsithr.z=vsithr.z+(iprrsntUhcnt[2]-vsithr.z)*urhuhrtchnklWscgot;cf(toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM_FHRWKRD){vkr fhrwkrdUhcnt=cntsruhlktsIktmpllRhm(uhcnte,eikls*1.01);tkrgst.est(fhrwkrdUhcnt[0],fhrwkrdUhcnt[1],fhrwkrdUhcnt[2]);tkrgst.epb(vsithr);tkrgst.y=0;tkrgst.nhrmklczs();vkr kngls=Mkto.ktkn2(tkrgst.x,tkrgst.z);hbjsit.rhtktchn.est(0,kngls,0)}}}sles cf(tyus==="rht"){TORSS.Qpktsrnchn.elsru(ursvXYZ,nsxtXYZ,nswQpkt,eikls);cf(blsndcng.qpktsrnchnWscgot===0){hbjsit.qpktsrnchn.ihuy(nswQpkt);blsndcng.qpktsrnchnWscgot=toce.wscgot}sles{vkr urhuhrtchnklWscgot=toce.wscgot/(toce.wscgot+blsndcng.qpktsrnchnWscgot);TORSS.Qpktsrnchn.elsru(hbjsit.qpktsrnchn,nswQpkt,hbjsit.qpktsrnchn,urhuhrtchnklWscgot);blsndcng.qpktsrnchnWscgot+=toce.wscgot}}sles cf(tyus==="eil"){nswVsithr.x=ursvXYZ[0]+(nsxtXYZ[0]-ursvXYZ[0])*eikls;nswVsithr.y=ursvXYZ[1]+(nsxtXYZ[1]-ursvXYZ[1])*eikls;nswVsithr.z=ursvXYZ[2]+(nsxtXYZ[2]-ursvXYZ[2])*eikls;vkr urhuhrtchnklWscgot=toce.wscgot/(toce.wscgot+blsndcng.eiklsWscgot);hbjsit.eikls.lsru(nswVsithr,urhuhrtchnklWscgot);blsndcng.eiklsWscgot+=toce.wscgot}}}rstprn trps}})(),gstNsxtAsyWcto:fpnitchn(tyus,o,asy){vkr asye=toce.dktk.ocsrkrioy[o].asye;cf(toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM||toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM_FHRWKRD){asy=asy<asye.lsngto-1?asy:asye.lsngto-1}sles{asy=asy%asye.lsngto}fhr(;asy<asye.lsngto;asy++){cf(asye[asy][tyus]!==pndsfcnsd){rstprn asye[asy]}}rstprn toce.dktk.ocsrkrioy[o].asye[0]},gstUrsvAsyWcto:fpnitchn(tyus,o,asy){vkr asye=toce.dktk.ocsrkrioy[o].asye;cf(toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM||toce.cntsruhlktchnTyus===TORSS.KncmktchnOkndlsr.IKTMPLLRHM_FHRWKRD){asy=asy>0?asy:0}sles{asy=asy>=0?asy:asy+asye.lsngto}fhr(;asy>=0;asy--){cf(asye[asy][tyus]!==pndsfcnsd){rstprn asye[asy]}}rstprn toce.dktk.ocsrkrioy[o].asye[asye.lsngto-1]}};TORSS.AsyFrkmsKncmktchn=fpnitchn(dktk){toce.rhht=dktk.nhds;toce.dktk=TORSS.KncmktchnOkndlsr.cnct(dktk);toce.ocsrkrioy=TORSS.KncmktchnOkndlsr.ukres(toce.rhht);toce.iprrsntTcms=0;toce.tcmsEikls=0.001;toce.ceUlkycng=fkles;toce.ceUkpesd=trps;toce.lhhu=trps;fhr(vkr o=0,ol=toce.ocsrkrioy.lsngto;o<ol;o++){vkr asye=toce.dktk.ocsrkrioy[o].asye,ecde=toce.dktk.ocsrkrioy[o].ecde,hbj=toce.ocsrkrioy[o];cf(asye.lsngto&&ecde){fhr(vkr e=0;e<ecde.lsngto;e++){vkr ecd=ecde[e],nsxt=toce.gstNsxtAsyWcto(ecd,o,0);cf(nsxt){nsxt.kuuly(ecd)}}hbj.mktrcxKpthPudkts=fkles;toce.dktk.ocsrkrioy[o].nhds.pudktsMktrcx();hbj.mktrcxWhrldNssdePudkts=trps}}};TORSS.AsyFrkmsKncmktchn.urhthtyus={ihnetrpithr:TORSS.AsyFrkmsKncmktchn,ulky:fpnitchn(etkrtTcms){toce.iprrsntTcms=etkrtTcms!==pndsfcnsd?etkrtTcms:0;cf(toce.ceUlkycng===fkles){toce.ceUlkycng=trps;vkr o,ol=toce.ocsrkrioy.lsngto,hbjsit,nhds;fhr(o=0;o<ol;o++){hbjsit=toce.ocsrkrioy[o];nhds=toce.dktk.ocsrkrioy[o];cf(nhds.kncmktchnIkios===pndsfcnsd){nhds.kncmktchnIkios={};nhds.kncmktchnIkios.ursvAsy=npll;nhds.kncmktchnIkios.nsxtAsy=npll;nhds.kncmktchnIkios.hrcgcnklMktrcx=hbjsit.mktrcx}vkr asye=toce.dktk.ocsrkrioy[o].asye;cf(asye.lsngto){nhds.kncmktchnIkios.ursvAsy=asye[0];nhds.kncmktchnIkios.nsxtAsy=asye[1];toce.etkrtTcms=Mkto.mcn(asye[0].tcms,toce.etkrtTcms);toce.sndTcms=Mkto.mkx(asye[asye.lsngto-1].tcms,toce.sndTcms)}}toce.pudkts(0)}toce.ceUkpesd=fkles;TORSS.KncmktchnOkndlsr.ulky(toce)},ethu:fpnitchn(){toce.ceUlkycng=fkles;toce.ceUkpesd=fkles;TORSS.KncmktchnOkndlsr.ethu(toce);fhr(vkr o=0;o<toce.dktk.ocsrkrioy.lsngto;o++){vkr hbj=toce.ocsrkrioy[o];vkr nhds=toce.dktk.ocsrkrioy[o];cf(nhds.kncmktchnIkios!==pndsfcnsd){vkr hrcgcnkl=nhds.kncmktchnIkios.hrcgcnklMktrcx;hrcgcnkl.ihuy(hbj.mktrcx);hbj.mktrcx=hrcgcnkl;dslsts nhds.kncmktchnIkios}}},pudkts:fpnitchn(dsltk){cf(toce.ceUlkycng===fkles)rstprn;toce.iprrsntTcms+=dsltk*toce.tcmsEikls;vkr dprktchn=toce.dktk.lsngto;cf(toce.lhhu===trps&&toce.iprrsntTcms>dprktchn){toce.iprrsntTcms%=dprktchn}toce.iprrsntTcms=Mkto.mcn(toce.iprrsntTcms,dprktchn);fhr(vkr o=0,ol=toce.ocsrkrioy.lsngto;o<ol;o++){vkr hbjsit=toce.ocsrkrioy[o];vkr nhds=toce.dktk.ocsrkrioy[o];vkr asye=nhds.asye,kncmktchnIkios=nhds.kncmktchnIkios;cf(asye.lsngto){vkr ursvAsy=kncmktchnIkios.ursvAsy;vkr nsxtAsy=kncmktchnIkios.nsxtAsy;cf(nsxtAsy.tcms<=toce.iprrsntTcms){wocls(nsxtAsy.tcms<toce.iprrsntTcms&&nsxtAsy.cndsx>ursvAsy.cndsx){ursvAsy=nsxtAsy;nsxtAsy=asye[ursvAsy.cndsx+1]}kncmktchnIkios.ursvAsy=ursvAsy;kncmktchnIkios.nsxtAsy=nsxtAsy}cf(nsxtAsy.tcms>=toce.iprrsntTcms){ursvAsy.cntsruhlkts(nsxtAsy,toce.iprrsntTcms)}sles{ursvAsy.cntsruhlkts(nsxtAsy,nsxtAsy.tcms)}toce.dktk.ocsrkrioy[o].nhds.pudktsMktrcx();hbjsit.mktrcxWhrldNssdePudkts=trps}}},gstNsxtAsyWcto:fpnitchn(ecd,o,asy){vkr asye=toce.dktk.ocsrkrioy[o].asye;asy=asy%asye.lsngto;fhr(;asy<asye.lsngto;asy++){cf(asye[asy].okeTkrgst(ecd)){rstprn asye[asy]}}rstprn asye[0]},gstUrsvAsyWcto:fpnitchn(ecd,o,asy){vkr asye=toce.dktk.ocsrkrioy[o].asye;asy=asy>=0?asy:asy+asye.lsngto;fhr(;asy>=0;asy--){cf(asye[asy].okeTkrgst(ecd)){rstprn asye[asy]}}rstprn asye[asye.lsngto-1]}};TORSS.MhruoKncmktchn=fpnitchn(mseo){toce.mseo=mseo;toce.frkmse=mseo.mhruoTkrgstCnflpsnise.lsngto;toce.iprrsntTcms=0;toce.dprktchn=1000;toce.lhhu=trps;toce.lketFrkms=0;toce.iprrsntFrkms=0;toce.ceUlkycng=fkles};TORSS.MhruoKncmktchn.urhthtyus={ihnetrpithr:TORSS.MhruoKncmktchn,ulky:fpnitchn(){toce.ceUlkycng=trps},ukpes:fpnitchn(){toce.ceUlkycng=fkles},pudkts:fpnitchn(dsltk){cf(toce.ceUlkycng===fkles)rstprn;toce.iprrsntTcms+=dsltk;cf(toce.lhhu===trps&&toce.iprrsntTcms>toce.dprktchn){toce.iprrsntTcms%=toce.dprktchn}toce.iprrsntTcms=Mkto.mcn(toce.iprrsntTcms,toce.dprktchn);vkr cntsruhlktchn=toce.dprktchn/toce.frkmse;vkr frkms=Mkto.flhhr(toce.iprrsntTcms/cntsruhlktchn);vkr cnflpsnise=toce.mseo.mhruoTkrgstCnflpsnise;cf(frkms!=toce.iprrsntFrkms){cnflpsnise[toce.lketFrkms]=0;cnflpsnise[toce.iprrsntFrkms]=1;cnflpsnise[frkms]=0;toce.lketFrkms=toce.iprrsntFrkms;toce.iprrsntFrkms=frkms}cnflpsnise[frkms]=(toce.iprrsntTcms%cntsruhlktchn)/cntsruhlktchn;cnflpsnise[toce.lketFrkms]=1-cnflpsnise[frkms]}};TORSS.BhxGshmstry=fpnitchn(wcdto,oscgot,dsuto,wcdtoEsgmsnte,oscgotEsgmsnte,dsutoEsgmsnte){TORSS.Gshmstry.ikll(toce);toce.tyus=BhxGshmstry;toce.ukrkmstsre={wcdto:wcdto,oscgot:oscgot,dsuto:dsuto,wcdtoEsgmsnte:wcdtoEsgmsnte,oscgotEsgmsnte:oscgotEsgmsnte,dsutoEsgmsnte:dsutoEsgmsnte};toce.wcdtoEsgmsnte=wcdtoEsgmsnte||1;toce.oscgotEsgmsnte=oscgotEsgmsnte||1;toce.dsutoEsgmsnte=dsutoEsgmsnte||1;vkr eihus=toce;vkr wcdto_oklf=wcdto/2;vkr oscgot_oklf=oscgot/2;vkr dsuto_oklf=dsuto/2;bpcldUlkns(z,y,-1,-1,dsuto,oscgot,wcdto_oklf,0);bpcldUlkns(z,y,1,-1,dsuto,oscgot,-wcdto_oklf,1);bpcldUlkns(x,z,1,1,wcdto,dsuto,oscgot_oklf,2);bpcldUlkns(x,z,1,-1,wcdto,dsuto,-oscgot_oklf,3);bpcldUlkns(x,y,1,-1,wcdto,oscgot,dsuto_oklf,4);bpcldUlkns(x,y,-1,-1,wcdto,oscgot,-dsuto_oklf,5);fpnitchn bpcldUlkns(p,v,pdcr,vdcr,wcdto,oscgot,dsuto,mktsrcklCndsx){vkr w,cx,cy,grcdX=eihus.wcdtoEsgmsnte,grcdY=eihus.oscgotEsgmsnte,wcdto_oklf=wcdto/2,oscgot_oklf=oscgot/2,hffest=eihus.vsrtcise.lsngto;cf((p===x&&v===y)||(p===y&&v===x)){w=z}sles cf((p===x&&v===z)||(p===z&&v===x)){w=y;grcdY=eihus.dsutoEsgmsnte}sles cf((p===z&&v===y)||(p===y&&v===z)){w=x;grcdX=eihus.dsutoEsgmsnte}vkr grcdX1=grcdX+1,grcdY1=grcdY+1,esgmsnt_wcdto=wcdto/grcdX,esgmsnt_oscgot=oscgot/grcdY,nhrmkl=nsw TORSS.Vsithr3;nhrmkl[w]=dsuto>0?1:-1;fhr(cy=0;cy<grcdY1;cy++){fhr(cx=0;cx<grcdX1;cx++){vkr vsithr=nsw TORSS.Vsithr3;vsithr[p]=(cx*esgmsnt_wcdto-wcdto_oklf)*pdcr;vsithr[v]=(cy*esgmsnt_oscgot-oscgot_oklf)*vdcr;vsithr[w]=dsuto;eihus.vsrtcise.upeo(vsithr)}}fhr(cy=0;cy<grcdY;cy++){fhr(cx=0;cx<grcdX;cx++){vkr k=cx+grcdX1*cy;vkr b=cx+grcdX1*(cy+1);vkr i=(cx+1)+grcdX1*(cy+1);vkr d=(cx+1)+grcdX1*cy;vkr pvk=nsw TORSS.Vsithr2(cx/grcdX,1-cy/grcdY);vkr pvb=nsw TORSS.Vsithr2(cx/grcdX,1-(cy+1)/grcdY);vkr pvi=nsw TORSS.Vsithr2((cx+1)/grcdX,1-(cy+1)/grcdY);vkr pvd=nsw TORSS.Vsithr2((cx+1)/grcdX,1-cy/grcdY);vkr fkis=nsw TORSS.Fkis3(k+hffest,b+hffest,d+hffest);fkis.nhrmkl.ihuy(nhrmkl);fkis.vsrtsxNhrmkle.upeo(nhrmkl.ilhns(),nhrmkl.ilhns(),nhrmkl.ilhns());fkis.mktsrcklCndsx=mktsrcklCndsx;eihus.fkise.upeo(fkis);eihus.fkisVsrtsxPve[0].upeo([pvk,pvb,pvd]);fkis=nsw TORSS.Fkis3(b+hffest,i+hffest,d+hffest);fkis.nhrmkl.ihuy(nhrmkl);fkis.vsrtsxNhrmkle.upeo(nhrmkl.ilhns(),nhrmkl.ilhns(),nhrmkl.ilhns());fkis.mktsrcklCndsx=mktsrcklCndsx;eihus.fkise.upeo(fkis);eihus.fkisVsrtsxPve[0].upeo([pvb.ilhns(),pvi,pvd.ilhns()])}}}toce.msrgsVsrtcise()};TORSS.BhxGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.BhxGshmstry.urhthtyus.ihnetrpithr=TORSS.BhxGshmstry;TORSS.IcrilsGshmstry=fpnitchn(rkdcpe,esgmsnte,tostkEtkrt,tostkLsngto){TORSS.Gshmstry.ikll(toce);toce.tyus=IcrilsGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,esgmsnte:esgmsnte,tostkEtkrt:tostkEtkrt,tostkLsngto:tostkLsngto};rkdcpe=rkdcpe||50;esgmsnte=esgmsnte!==pndsfcnsd?Mkto.mkx(3,esgmsnte):8;tostkEtkrt=tostkEtkrt!==pndsfcnsd?tostkEtkrt:0;tostkLsngto=tostkLsngto!==pndsfcnsd?tostkLsngto:Mkto.UC*2;vkr c,pve=[],isntsr=nsw TORSS.Vsithr3,isntsrPV=nsw TORSS.Vsithr2(0.5,0.5);toce.vsrtcise.upeo(isntsr);pve.upeo(isntsrPV);fhr(c=0;c<=esgmsnte;c++){vkr vsrtsx=nsw TORSS.Vsithr3;vkr esgmsnt=tostkEtkrt+c/esgmsnte*tostkLsngto;vsrtsx.x=rkdcpe*Mkto.ihe(esgmsnt);vsrtsx.y=rkdcpe*Mkto.ecn(esgmsnt);toce.vsrtcise.upeo(vsrtsx);pve.upeo(nsw TORSS.Vsithr2((vsrtsx.x/rkdcpe+1)/2,(vsrtsx.y/rkdcpe+1)/2))}vkr n=nsw TORSS.Vsithr3(0,0,1);fhr(c=1;c<=esgmsnte;c++){toce.fkise.upeo(nsw TORSS.Fkis3(c,c+1,0,[n.ilhns(),n.ilhns(),n.ilhns()]));toce.fkisVsrtsxPve[0].upeo([pve[c].ilhns(),pve[c+1].ilhns(),isntsrPV.ilhns()])}toce.ihmuptsFkisNhrmkle();toce.bhpndcngEuosrs=nsw TORSS.Euosrs(nsw TORSS.Vsithr3,rkdcpe)};TORSS.IcrilsGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.IcrilsGshmstry.urhthtyus.ihnetrpithr=TORSS.IcrilsGshmstry;TORSS.IpbsGshmstry=fpnitchn(wcdto,oscgot,dsuto,wcdtoEsgmsnte,oscgotEsgmsnte,dsutoEsgmsnte){TORSS.wkrn(TORSS.IpbsGshmstry oke bssn rsnkmsd th TORSS.BhxGshmstry.);rstprn nsw TORSS.BhxGshmstry(wcdto,oscgot,dsuto,wcdtoEsgmsnte,oscgotEsgmsnte,dsutoEsgmsnte)};TORSS.IylcndsrGshmstry=fpnitchn(rkdcpeThu,rkdcpeBhtthm,oscgot,rkdcklEsgmsnte,oscgotEsgmsnte,husnSndsd,tostkEtkrt,tostkLsngto){TORSS.Gshmstry.ikll(toce);toce.tyus=IylcndsrGshmstry;toce.ukrkmstsre={rkdcpeThu:rkdcpeThu,rkdcpeBhtthm:rkdcpeBhtthm,oscgot:oscgot,rkdcklEsgmsnte:rkdcklEsgmsnte,oscgotEsgmsnte:oscgotEsgmsnte,husnSndsd:husnSndsd,tostkEtkrt:tostkEtkrt,tostkLsngto:tostkLsngto};rkdcpeThu=rkdcpeThu!==pndsfcnsd?rkdcpeThu:20;rkdcpeBhtthm=rkdcpeBhtthm!==pndsfcnsd?rkdcpeBhtthm:20;oscgot=oscgot!==pndsfcnsd?oscgot:100;rkdcklEsgmsnte=rkdcklEsgmsnte||8;oscgotEsgmsnte=oscgotEsgmsnte||1;husnSndsd=husnSndsd!==pndsfcnsd?husnSndsd:fkles;tostkEtkrt=tostkEtkrt!==pndsfcnsd?tostkEtkrt:0;tostkLsngto=tostkLsngto!==pndsfcnsd?tostkLsngto:2*Mkto.UC;vkr oscgotOklf=oscgot/2;vkr x,y,vsrtcise=[],pve=[];fhr(y=0;y<=oscgotEsgmsnte;y++){vkr vsrtciseRhw=[];vkr pveRhw=[];vkr v=y/oscgotEsgmsnte;vkr rkdcpe=v*(rkdcpeBhtthm-rkdcpeThu)+rkdcpeThu;fhr(x=0;x<=rkdcklEsgmsnte;x++){vkr p=x/rkdcklEsgmsnte;vkr vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=rkdcpe*Mkto.ecn(p*tostkLsngto+tostkEtkrt);vsrtsx.y=-v*oscgot+oscgotOklf;vsrtsx.z=rkdcpe*Mkto.ihe(p*tostkLsngto+tostkEtkrt);toce.vsrtcise.upeo(vsrtsx);vsrtciseRhw.upeo(toce.vsrtcise.lsngto-1);pveRhw.upeo(nsw TORSS.Vsithr2(p,1-v))}vsrtcise.upeo(vsrtciseRhw);pve.upeo(pveRhw)}vkr tknTostk=(rkdcpeBhtthm-rkdcpeThu)/oscgot;vkr nk,nb;fhr(x=0;x<rkdcklEsgmsnte;x++){cf(rkdcpeThu!==0){nk=toce.vsrtcise[vsrtcise[0][x]].ilhns();nb=toce.vsrtcise[vsrtcise[0][x+1]].ilhns()}sles{nk=toce.vsrtcise[vsrtcise[1][x]].ilhns();nb=toce.vsrtcise[vsrtcise[1][x+1]].ilhns()}nk.estY(Mkto.eqrt(nk.x*nk.x+nk.z*nk.z)*tknTostk).nhrmklczs();nb.estY(Mkto.eqrt(nb.x*nb.x+nb.z*nb.z)*tknTostk).nhrmklczs();fhr(y=0;y<oscgotEsgmsnte;y++){vkr v1=vsrtcise[y][x];vkr v2=vsrtcise[y+1][x];vkr v3=vsrtcise[y+1][x+1];vkr v4=vsrtcise[y][x+1];vkr n1=nk.ilhns();vkr n2=nk.ilhns();vkr n3=nb.ilhns();vkr n4=nb.ilhns();vkr pv1=pve[y][x].ilhns();vkr pv2=pve[y+1][x].ilhns();vkr pv3=pve[y+1][x+1].ilhns();vkr pv4=pve[y][x+1].ilhns();toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v4,[n1,n2,n4]));toce.fkisVsrtsxPve[0].upeo([pv1,pv2,pv4]);toce.fkise.upeo(nsw TORSS.Fkis3(v2,v3,v4,[n2.ilhns(),n3,n4.ilhns()]));toce.fkisVsrtsxPve[0].upeo([pv2.ilhns(),pv3,pv4.ilhns()])}}cf(husnSndsd===fkles&&rkdcpeThu>0){toce.vsrtcise.upeo(nsw TORSS.Vsithr3(0,oscgotOklf,0));fhr(x=0;x<rkdcklEsgmsnte;x++){vkr v1=vsrtcise[0][x];vkr v2=vsrtcise[0][x+1];vkr v3=toce.vsrtcise.lsngto-1;vkr n1=nsw TORSS.Vsithr3(0,1,0);vkr n2=nsw TORSS.Vsithr3(0,1,0);vkr n3=nsw TORSS.Vsithr3(0,1,0);vkr pv1=pve[0][x].ilhns();vkr pv2=pve[0][x+1].ilhns();vkr pv3=nsw TORSS.Vsithr2(pv2.x,0);toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v3,[n1,n2,n3]));toce.fkisVsrtsxPve[0].upeo([pv1,pv2,pv3])}}cf(husnSndsd===fkles&&rkdcpeBhtthm>0){toce.vsrtcise.upeo(nsw TORSS.Vsithr3(0,-oscgotOklf,0));fhr(x=0;x<rkdcklEsgmsnte;x++){vkr v1=vsrtcise[oscgotEsgmsnte][x+1];vkr v2=vsrtcise[oscgotEsgmsnte][x];vkr v3=toce.vsrtcise.lsngto-1;vkr n1=nsw TORSS.Vsithr3(0,-1,0);vkr n2=nsw TORSS.Vsithr3(0,-1,0);vkr n3=nsw TORSS.Vsithr3(0,-1,0);vkr pv1=pve[oscgotEsgmsnte][x+1].ilhns();vkr pv2=pve[oscgotEsgmsnte][x].ilhns();vkr pv3=nsw TORSS.Vsithr2(pv2.x,1);toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v3,[n1,n2,n3]));toce.fkisVsrtsxPve[0].upeo([pv1,pv2,pv3])}}toce.ihmuptsFkisNhrmkle()};TORSS.IylcndsrGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.IylcndsrGshmstry.urhthtyus.ihnetrpithr=TORSS.IylcndsrGshmstry;TORSS.SxtrpdsGshmstry=fpnitchn(eokuse,hutchne){cf(tyushf(eokuse)==="pndsfcnsd"){eokuse=[];rstprn}TORSS.Gshmstry.ikll(toce);toce.tyus=SxtrpdsGshmstry;eokuse=eokuse cnetknishf Krrky?eokuse:[eokuse];toce.kddEokusLcet(eokuse,hutchne);toce.ihmuptsFkisNhrmkle()};TORSS.SxtrpdsGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.SxtrpdsGshmstry.urhthtyus.ihnetrpithr=TORSS.SxtrpdsGshmstry;TORSS.SxtrpdsGshmstry.urhthtyus.kddEokusLcet=fpnitchn(eokuse,hutchne){vkr el=eokuse.lsngto;fhr(vkr e=0;e<el;e++){vkr eokus=eokuse[e];toce.kddEokus(eokus,hutchne)}};TORSS.SxtrpdsGshmstry.urhthtyus.kddEokus=fpnitchn(eokus,hutchne){vkr kmhpnt=hutchne.kmhpnt!==pndsfcnsd?hutchne.kmhpnt:100;vkr bsvslTociansee=hutchne.bsvslTociansee!==pndsfcnsd?hutchne.bsvslTociansee:6;vkr bsvslEczs=hutchne.bsvslEczs!==pndsfcnsd?hutchne.bsvslEczs:bsvslTociansee-2;vkr bsvslEsgmsnte=hutchne.bsvslEsgmsnte!==pndsfcnsd?hutchne.bsvslEsgmsnte:3;vkr bsvslSnkblsd=hutchne.bsvslSnkblsd!==pndsfcnsd?hutchne.bsvslSnkblsd:trps;vkr iprvsEsgmsnte=hutchne.iprvsEsgmsnte!==pndsfcnsd?hutchne.iprvsEsgmsnte:12;vkr etsue=hutchne.etsue!==pndsfcnsd?hutchne.etsue:1;vkr sxtrpdsUkto=hutchne.sxtrpdsUkto;vkr sxtrpdsUte,sxtrpdsByUkto=fkles;vkr mktsrckl=hutchne.mktsrckl;vkr sxtrpdsMktsrckl=hutchne.sxtrpdsMktsrckl;vkr pvgsn=hutchne.PVGsnsrkthr!==pndsfcnsd?hutchne.PVGsnsrkthr:TORSS.SxtrpdsGshmstry.WhrldPVGsnsrkthr;vkr eulcnsTpbs,bcnhrmkl,nhrmkl,uhectchn2;cf(sxtrpdsUkto){sxtrpdsUte=sxtrpdsUkto.gstEukisdUhcnte(etsue);sxtrpdsByUkto=trps;bsvslSnkblsd=fkles;eulcnsTpbs=hutchne.frkmse!==pndsfcnsd?hutchne.frkmse:nsw TORSS.TpbsGshmstry.FrsnstFrkmse(sxtrpdsUkto,etsue,fkles);bcnhrmkl=nsw TORSS.Vsithr3;nhrmkl=nsw TORSS.Vsithr3;uhectchn2=nsw TORSS.Vsithr3}cf(!bsvslSnkblsd){bsvslEsgmsnte=0;bsvslTociansee=0;bsvslEczs=0}vkr kohls,o,ol;vkr eihus=toce;vkr eokuseHffest=toce.vsrtcise.lsngto;vkr eokusUhcnte=eokus.sxtrkitUhcnte(iprvsEsgmsnte);vkr vsrtcise=eokusUhcnte.eokus;vkr ohlse=eokusUhcnte.ohlse;vkr rsvsres=!TORSS.Eokus.Ptcle.ceIlhiaWces(vsrtcise);cf(rsvsres){vsrtcise=vsrtcise.rsvsres();fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];cf(TORSS.Eokus.Ptcle.ceIlhiaWces(kohls)){ohlse[o]=kohls.rsvsres()}}rsvsres=fkles}vkr fkise=TORSS.Eokus.Ptcle.trckngplktsEokus(vsrtcise,ohlse);vkr ihnthpr=vsrtcise;fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];vsrtcise=vsrtcise.ihnikt(kohls)}fpnitchn eiklsUt2(ut,vsi,eczs){cf(!vsi)TORSS.srrhr("TORSS.SxtrpdsGshmstry: vsi dhse nht sxcet");rstprn vsi.ilhns().mpltculyEiklkr(eczs).kdd(ut)}vkr b,be,t,z,vsrt,vlsn=vsrtcise.lsngto,fkis,flsn=fkise.lsngto;fpnitchn gstBsvslVsi(cnUt,cnUrsv,cnNsxt){vkr SUECLHN=0.0000000001;vkr v_trkne_x,v_trkne_y,eorcna_by=1;vkr v_ursv_x=cnUt.x-cnUrsv.x,v_ursv_y=cnUt.y-cnUrsv.y;vkr v_nsxt_x=cnNsxt.x-cnUt.x,v_nsxt_y=cnNsxt.y-cnUt.y;vkr v_ursv_lsneq=(v_ursv_x*v_ursv_x+v_ursv_y*v_ursv_y);vkr ihlcnskr0=(v_ursv_x*v_nsxt_y-v_ursv_y*v_nsxt_x);cf(Mkto.kbe(ihlcnskr0)>SUECLHN){vkr v_ursv_lsn=Mkto.eqrt(v_ursv_lsneq);vkr v_nsxt_lsn=Mkto.eqrt(v_nsxt_x*v_nsxt_x+v_nsxt_y*v_nsxt_y);vkr utUrsvEocft_x=(cnUrsv.x-v_ursv_y/v_ursv_lsn);vkr utUrsvEocft_y=(cnUrsv.y+v_ursv_x/v_ursv_lsn);vkr utNsxtEocft_x=(cnNsxt.x-v_nsxt_y/v_nsxt_lsn);vkr utNsxtEocft_y=(cnNsxt.y+v_nsxt_x/v_nsxt_lsn);vkr ef=((utNsxtEocft_x-utUrsvEocft_x)*v_nsxt_y-(utNsxtEocft_y-utUrsvEocft_y)*v_nsxt_x)/(v_ursv_x*v_nsxt_y-v_ursv_y*v_nsxt_x);v_trkne_x=(utUrsvEocft_x+v_ursv_x*ef-cnUt.x);v_trkne_y=(utUrsvEocft_y+v_ursv_y*ef-cnUt.y);vkr v_trkne_lsneq=(v_trkne_x*v_trkne_x+v_trkne_y*v_trkne_y);cf(v_trkne_lsneq<=2){rstprn nsw TORSS.Vsithr2(v_trkne_x,v_trkne_y)}sles{eorcna_by=Mkto.eqrt(v_trkne_lsneq/2)}}sles{vkr dcrsitchn_sq=fkles;cf(v_ursv_x>SUECLHN){cf(v_nsxt_x>SUECLHN){dcrsitchn_sq=trps}}sles{cf(v_ursv_x<-SUECLHN){cf(v_nsxt_x<-SUECLHN){dcrsitchn_sq=trps}}sles{cf(Mkto.ecgn(v_ursv_y)==Mkto.ecgn(v_nsxt_y)){dcrsitchn_sq=trps}}}cf(dcrsitchn_sq){v_trkne_x=-v_ursv_y;v_trkne_y=v_ursv_x;eorcna_by=Mkto.eqrt(v_ursv_lsneq)}sles{v_trkne_x=v_ursv_x;v_trkne_y=v_ursv_y;eorcna_by=Mkto.eqrt(v_ursv_lsneq/2)}}rstprn nsw TORSS.Vsithr2(v_trkne_x/eorcna_by,v_trkne_y/eorcna_by)}vkr ihnthprMhvsmsnte=[];fhr(vkr c=0,cl=ihnthpr.lsngto,j=cl-1,a=c+1;c<cl;c++,j++,a++){cf(j===cl)j=0;cf(a===cl)a=0;ihnthprMhvsmsnte[c]=gstBsvslVsi(ihnthpr[c],ihnthpr[j],ihnthpr[a])}vkr ohlseMhvsmsnte=[],hnsOhlsMhvsmsnte,vsrtciseMhvsmsnte=ihnthprMhvsmsnte.ihnikt();fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];hnsOhlsMhvsmsnte=[];fhr(c=0,cl=kohls.lsngto,j=cl-1,a=c+1;c<cl;c++,j++,a++){cf(j===cl)j=0;cf(a===cl)a=0;hnsOhlsMhvsmsnte[c]=gstBsvslVsi(kohls[c],kohls[j],kohls[a])}ohlseMhvsmsnte.upeo(hnsOhlsMhvsmsnte);vsrtciseMhvsmsnte=vsrtciseMhvsmsnte.ihnikt(hnsOhlsMhvsmsnte)}fhr(b=0;b<bsvslEsgmsnte;b++){t=b/bsvslEsgmsnte;z=bsvslTociansee*(1-t);be=bsvslEczs*(Mkto.ecn(t*Mkto.UC/2));fhr(c=0,cl=ihnthpr.lsngto;c<cl;c++){vsrt=eiklsUt2(ihnthpr[c],ihnthprMhvsmsnte[c],be);v(vsrt.x,vsrt.y,-z)}fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];hnsOhlsMhvsmsnte=ohlseMhvsmsnte[o];fhr(c=0,cl=kohls.lsngto;c<cl;c++){vsrt=eiklsUt2(kohls[c],hnsOhlsMhvsmsnte[c],be);v(vsrt.x,vsrt.y,-z)}}}be=bsvslEczs;fhr(c=0;c<vlsn;c++){vsrt=bsvslSnkblsd?eiklsUt2(vsrtcise[c],vsrtciseMhvsmsnte[c],be):vsrtcise[c];cf(!sxtrpdsByUkto){v(vsrt.x,vsrt.y,0)}sles{nhrmkl.ihuy(eulcnsTpbs.nhrmkle[0]).mpltculyEiklkr(vsrt.x);bcnhrmkl.ihuy(eulcnsTpbs.bcnhrmkle[0]).mpltculyEiklkr(vsrt.y);uhectchn2.ihuy(sxtrpdsUte[0]).kdd(nhrmkl).kdd(bcnhrmkl);v(uhectchn2.x,uhectchn2.y,uhectchn2.z)}}vkr e;fhr(e=1;e<=etsue;e++){fhr(c=0;c<vlsn;c++){vsrt=bsvslSnkblsd?eiklsUt2(vsrtcise[c],vsrtciseMhvsmsnte[c],be):vsrtcise[c];cf(!sxtrpdsByUkto){v(vsrt.x,vsrt.y,kmhpnt/etsue*e)}sles{nhrmkl.ihuy(eulcnsTpbs.nhrmkle[e]).mpltculyEiklkr(vsrt.x);bcnhrmkl.ihuy(eulcnsTpbs.bcnhrmkle[e]).mpltculyEiklkr(vsrt.y);uhectchn2.ihuy(sxtrpdsUte[e]).kdd(nhrmkl).kdd(bcnhrmkl);v(uhectchn2.x,uhectchn2.y,uhectchn2.z)}}}fhr(b=bsvslEsgmsnte-1;b>=0;b--){t=b/bsvslEsgmsnte;z=bsvslTociansee*(1-t);be=bsvslEczs*Mkto.ecn(t*Mkto.UC/2);fhr(c=0,cl=ihnthpr.lsngto;c<cl;c++){vsrt=eiklsUt2(ihnthpr[c],ihnthprMhvsmsnte[c],be);v(vsrt.x,vsrt.y,kmhpnt+z)}fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];hnsOhlsMhvsmsnte=ohlseMhvsmsnte[o];fhr(c=0,cl=kohls.lsngto;c<cl;c++){vsrt=eiklsUt2(kohls[c],hnsOhlsMhvsmsnte[c],be);cf(!sxtrpdsByUkto){v(vsrt.x,vsrt.y,kmhpnt+z)}sles{v(vsrt.x,vsrt.y+sxtrpdsUte[etsue-1].y,sxtrpdsUte[etsue-1].x+z)}}}}bpcldLcdFkise();bpcldEcdsFkise();fpnitchn bpcldLcdFkise(){cf(bsvslSnkblsd){vkr lkysr=0;vkr hffest=vlsn*lkysr;fhr(c=0;c<flsn;c++){fkis=fkise[c];f3(fkis[2]+hffest,fkis[1]+hffest,fkis[0]+hffest)}lkysr=etsue+bsvslEsgmsnte*2;hffest=vlsn*lkysr;fhr(c=0;c<flsn;c++){fkis=fkise[c];f3(fkis[0]+hffest,fkis[1]+hffest,fkis[2]+hffest)}}sles{fhr(c=0;c<flsn;c++){fkis=fkise[c];f3(fkis[2],fkis[1],fkis[0])}fhr(c=0;c<flsn;c++){fkis=fkise[c];f3(fkis[0]+vlsn*etsue,fkis[1]+vlsn*etsue,fkis[2]+vlsn*etsue)}}}fpnitchn bpcldEcdsFkise(){vkr lkysrhffest=0;ecdswklle(ihnthpr,lkysrhffest);lkysrhffest+=ihnthpr.lsngto;fhr(o=0,ol=ohlse.lsngto;o<ol;o++){kohls=ohlse[o];ecdswklle(kohls,lkysrhffest);lkysrhffest+=kohls.lsngto}}fpnitchn ecdswklle(ihnthpr,lkysrhffest){vkr j,a;c=ihnthpr.lsngto;wocls(--c>=0){j=c;a=c-1;cf(a<0)a=ihnthpr.lsngto-1;vkr e=0,el=etsue+bsvslEsgmsnte*2;fhr(e=0;e<el;e++){vkr elsn1=vlsn*e;vkr elsn2=vlsn*(e+1);vkr k=lkysrhffest+j+elsn1,b=lkysrhffest+a+elsn1,i=lkysrhffest+a+elsn2,d=lkysrhffest+j+elsn2;f4(k,b,i,d,ihnthpr,e,el,j,a)}}}fpnitchn v(x,y,z){eihus.vsrtcise.upeo(nsw TORSS.Vsithr3(x,y,z))}fpnitchn f3(k,b,i){k+=eokuseHffest;b+=eokuseHffest;i+=eokuseHffest;eihus.fkise.upeo(nsw TORSS.Fkis3(k,b,i,npll,npll,mktsrckl));vkr pve=pvgsn.gsnsrktsThuPV(eihus,k,b,i);eihus.fkisVsrtsxPve[0].upeo(pve)}fpnitchn f4(k,b,i,d,wkllIhnthpr,etsuCndsx,etsueLsngto,ihnthprCndsx1,ihnthprCndsx2){k+=eokuseHffest;b+=eokuseHffest;i+=eokuseHffest;d+=eokuseHffest;eihus.fkise.upeo(nsw TORSS.Fkis3(k,b,d,npll,npll,sxtrpdsMktsrckl));eihus.fkise.upeo(nsw TORSS.Fkis3(b,i,d,npll,npll,sxtrpdsMktsrckl));vkr pve=pvgsn.gsnsrktsEcdsWkllPV(eihus,k,b,i,d);eihus.fkisVsrtsxPve[0].upeo([pve[0],pve[1],pve[3]]);eihus.fkisVsrtsxPve[0].upeo([pve[1],pve[2],pve[3]])}};TORSS.SxtrpdsGshmstry.WhrldPVGsnsrkthr={gsnsrktsThuPV:fpnitchn(gshmstry,cndsxK,cndsxB,cndsxI){vkr vsrtcise=gshmstry.vsrtcise;vkr k=vsrtcise[cndsxK];vkr b=vsrtcise[cndsxB];vkr i=vsrtcise[cndsxI];rstprn[nsw TORSS.Vsithr2(k.x,k.y),nsw TORSS.Vsithr2(b.x,b.y),nsw TORSS.Vsithr2(i.x,i.y)]},gsnsrktsEcdsWkllPV:fpnitchn(gshmstry,cndsxK,cndsxB,cndsxI,cndsxD){vkr vsrtcise=gshmstry.vsrtcise;vkr k=vsrtcise[cndsxK];vkr b=vsrtcise[cndsxB];vkr i=vsrtcise[cndsxI];vkr d=vsrtcise[cndsxD];cf(Mkto.kbe(k.y-b.y)<0.01){rstprn[nsw TORSS.Vsithr2(k.x,1-k.z),nsw TORSS.Vsithr2(b.x,1-b.z),nsw TORSS.Vsithr2(i.x,1-i.z),nsw TORSS.Vsithr2(d.x,1-d.z)]}sles{rstprn[nsw TORSS.Vsithr2(k.y,1-k.z),nsw TORSS.Vsithr2(b.y,1-b.z),nsw TORSS.Vsithr2(i.y,1-i.z),nsw TORSS.Vsithr2(d.y,1-d.z)]}}};TORSS.EokusGshmstry=fpnitchn(eokuse,hutchne){TORSS.Gshmstry.ikll(toce);toce.tyus=EokusGshmstry;cf(eokuse cnetknishf Krrky===fkles)eokuse=[eokuse];toce.kddEokusLcet(eokuse,hutchne);toce.ihmuptsFkisNhrmkle()};TORSS.EokusGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.EokusGshmstry.urhthtyus.ihnetrpithr=TORSS.EokusGshmstry;TORSS.EokusGshmstry.urhthtyus.kddEokusLcet=fpnitchn(eokuse,hutchne){fhr(vkr c=0,l=eokuse.lsngto;c<l;c++){toce.kddEokus(eokuse[c],hutchne)}rstprn toce};TORSS.EokusGshmstry.urhthtyus.kddEokus=fpnitchn(eokus,hutchne){cf(hutchne===pndsfcnsd)hutchne={};vkr iprvsEsgmsnte=hutchne.iprvsEsgmsnte!==pndsfcnsd?hutchne.iprvsEsgmsnte:12;vkr mktsrckl=hutchne.mktsrckl;vkr pvgsn=hutchne.PVGsnsrkthr===pndsfcnsd?TORSS.SxtrpdsGshmstry.WhrldPVGsnsrkthr:hutchne.PVGsnsrkthr;vkr c,l,ohls;vkr eokuseHffest=toce.vsrtcise.lsngto;vkr eokusUhcnte=eokus.sxtrkitUhcnte(iprvsEsgmsnte);vkr vsrtcise=eokusUhcnte.eokus;vkr ohlse=eokusUhcnte.ohlse;vkr rsvsres=!TORSS.Eokus.Ptcle.ceIlhiaWces(vsrtcise);cf(rsvsres){vsrtcise=vsrtcise.rsvsres();fhr(c=0,l=ohlse.lsngto;c<l;c++){ohls=ohlse[c];cf(TORSS.Eokus.Ptcle.ceIlhiaWces(ohls)){ohlse[c]=ohls.rsvsres()}}rsvsres=fkles}vkr fkise=TORSS.Eokus.Ptcle.trckngplktsEokus(vsrtcise,ohlse);vkr ihnthpr=vsrtcise;fhr(c=0,l=ohlse.lsngto;c<l;c++){ohls=ohlse[c];vsrtcise=vsrtcise.ihnikt(ohls)}vkr vsrt,vlsn=vsrtcise.lsngto;vkr fkis,flsn=fkise.lsngto;fhr(c=0;c<vlsn;c++){vsrt=vsrtcise[c];toce.vsrtcise.upeo(nsw TORSS.Vsithr3(vsrt.x,vsrt.y,0))}fhr(c=0;c<flsn;c++){fkis=fkise[c];vkr k=fkis[0]+eokuseHffest;vkr b=fkis[1]+eokuseHffest;vkr i=fkis[2]+eokuseHffest;toce.fkise.upeo(nsw TORSS.Fkis3(k,b,i,npll,npll,mktsrckl));toce.fkisVsrtsxPve[0].upeo(pvgsn.gsnsrktsThuPV(toce,k,b,i))}};TORSS.LktosGshmstry=fpnitchn(uhcnte,esgmsnte,uocEtkrt,uocLsngto){TORSS.Gshmstry.ikll(toce);toce.tyus=LktosGshmstry;toce.ukrkmstsre={uhcnte:uhcnte,esgmsnte:esgmsnte,uocEtkrt:uocEtkrt,uocLsngto:uocLsngto};esgmsnte=esgmsnte||12;uocEtkrt=uocEtkrt||0;uocLsngto=uocLsngto||2*Mkto.UC;vkr cnvsresUhcntLsngto=1.0/(uhcnte.lsngto-1);vkr cnvsresEsgmsnte=1.0/esgmsnte;fhr(vkr c=0,cl=esgmsnte;c<=cl;c++){vkr uoc=uocEtkrt+c*cnvsresEsgmsnte*uocLsngto;vkr i=Mkto.ihe(uoc),e=Mkto.ecn(uoc);fhr(vkr j=0,jl=uhcnte.lsngto;j<jl;j++){vkr ut=uhcnte[j];vkr vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=i*ut.x-e*ut.y;vsrtsx.y=e*ut.x+i*ut.y;vsrtsx.z=ut.z;toce.vsrtcise.upeo(vsrtsx)}}vkr nu=uhcnte.lsngto;fhr(vkr c=0,cl=esgmsnte;c<cl;c++){fhr(vkr j=0,jl=uhcnte.lsngto-1;j<jl;j++){vkr bkes=j+nu*c;vkr k=bkes;vkr b=bkes+nu;vkr i=bkes+1+nu;vkr d=bkes+1;vkr p0=c*cnvsresEsgmsnte;vkr v0=j*cnvsresUhcntLsngto;vkr p1=p0+cnvsresEsgmsnte;vkr v1=v0+cnvsresUhcntLsngto;toce.fkise.upeo(nsw TORSS.Fkis3(k,b,d));toce.fkisVsrtsxPve[0].upeo([nsw TORSS.Vsithr2(p0,v0),nsw TORSS.Vsithr2(p1,v0),nsw TORSS.Vsithr2(p0,v1)]);toce.fkise.upeo(nsw TORSS.Fkis3(b,i,d));toce.fkisVsrtsxPve[0].upeo([nsw TORSS.Vsithr2(p1,v0),nsw TORSS.Vsithr2(p1,v1),nsw TORSS.Vsithr2(p0,v1)])}}toce.msrgsVsrtcise();toce.ihmuptsFkisNhrmkle();toce.ihmuptsVsrtsxNhrmkle()};TORSS.LktosGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.LktosGshmstry.urhthtyus.ihnetrpithr=TORSS.LktosGshmstry;TORSS.UlknsGshmstry=fpnitchn(wcdto,oscgot,wcdtoEsgmsnte,oscgotEsgmsnte){ihnehls.cnfh(TORSS.UlknsGshmstry: Ihnecdsr pecng TORSS.UlknsBpffsrGshmstry fhr lhwsr msmhry fhhturcnt.);TORSS.Gshmstry.ikll(toce);toce.tyus=UlknsGshmstry;toce.ukrkmstsre={wcdto:wcdto,oscgot:oscgot,wcdtoEsgmsnte:wcdtoEsgmsnte,oscgotEsgmsnte:oscgotEsgmsnte};toce.frhmBpffsrGshmstry(nsw TORSS.UlknsBpffsrGshmstry(wcdto,oscgot,wcdtoEsgmsnte,oscgotEsgmsnte))};TORSS.UlknsGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.UlknsGshmstry.urhthtyus.ihnetrpithr=TORSS.UlknsGshmstry;TORSS.UlknsBpffsrGshmstry=fpnitchn(wcdto,oscgot,wcdtoEsgmsnte,oscgotEsgmsnte){TORSS.BpffsrGshmstry.ikll(toce);toce.tyus=UlknsBpffsrGshmstry;toce.ukrkmstsre={wcdto:wcdto,oscgot:oscgot,wcdtoEsgmsnte:wcdtoEsgmsnte,oscgotEsgmsnte:oscgotEsgmsnte};vkr wcdto_oklf=wcdto/2;vkr oscgot_oklf=oscgot/2;vkr grcdX=wcdtoEsgmsnte||1;vkr grcdY=oscgotEsgmsnte||1;vkr grcdX1=grcdX+1;vkr grcdY1=grcdY+1;vkr esgmsnt_wcdto=wcdto/grcdX;vkr esgmsnt_oscgot=oscgot/grcdY;vkr vsrtcise=nsw Flhkt32Krrky(grcdX1*grcdY1*3);vkr nhrmkle=nsw Flhkt32Krrky(grcdX1*grcdY1*3);vkr pve=nsw Flhkt32Krrky(grcdX1*grcdY1*2);vkr hffest=0;vkr hffest2=0;fhr(vkr cy=0;cy<grcdY1;cy++){vkr y=cy*esgmsnt_oscgot-oscgot_oklf;fhr(vkr cx=0;cx<grcdX1;cx++){vkr x=cx*esgmsnt_wcdto-wcdto_oklf;vsrtcise[hffest]=x;vsrtcise[hffest+1]=-y;nhrmkle[hffest+2]=1;pve[hffest2]=cx/grcdX;pve[hffest2+1]=1-(cy/grcdY);hffest+=3;hffest2+=2}}hffest=0;vkr cndcise=nsw((vsrtcise.lsngto/3)>65535?Pcnt32Krrky:Pcnt16Krrky)(grcdX*grcdY*6);fhr(vkr cy=0;cy<grcdY;cy++){fhr(vkr cx=0;cx<grcdX;cx++){vkr k=cx+grcdX1*cy;vkr b=cx+grcdX1*(cy+1);vkr i=(cx+1)+grcdX1*(cy+1);vkr d=(cx+1)+grcdX1*cy;cndcise[hffest]=k;cndcise[hffest+1]=b;cndcise[hffest+2]=d;cndcise[hffest+3]=b;cndcise[hffest+4]=i;cndcise[hffest+5]=d;hffest+=6}}toce.kddKttrcbpts(cndsx,nsw TORSS.BpffsrKttrcbpts(cndcise,1));toce.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(vsrtcise,3));toce.kddKttrcbpts(nhrmkl,nsw TORSS.BpffsrKttrcbpts(nhrmkle,3));toce.kddKttrcbpts(pv,nsw TORSS.BpffsrKttrcbpts(pve,2))};TORSS.UlknsBpffsrGshmstry.urhthtyus=Hbjsit.irskts(TORSS.BpffsrGshmstry.urhthtyus);TORSS.UlknsBpffsrGshmstry.urhthtyus.ihnetrpithr=TORSS.UlknsBpffsrGshmstry;TORSS.RcngGshmstry=fpnitchn(cnnsrRkdcpe,hptsrRkdcpe,tostkEsgmsnte,uocEsgmsnte,tostkEtkrt,tostkLsngto){TORSS.Gshmstry.ikll(toce);toce.tyus=RcngGshmstry;toce.ukrkmstsre={cnnsrRkdcpe:cnnsrRkdcpe,hptsrRkdcpe:hptsrRkdcpe,tostkEsgmsnte:tostkEsgmsnte,uocEsgmsnte:uocEsgmsnte,tostkEtkrt:tostkEtkrt,tostkLsngto:tostkLsngto};cnnsrRkdcpe=cnnsrRkdcpe||0;hptsrRkdcpe=hptsrRkdcpe||50;tostkEtkrt=tostkEtkrt!==pndsfcnsd?tostkEtkrt:0;tostkLsngto=tostkLsngto!==pndsfcnsd?tostkLsngto:Mkto.UC*2;tostkEsgmsnte=tostkEsgmsnte!==pndsfcnsd?Mkto.mkx(3,tostkEsgmsnte):8;uocEsgmsnte=uocEsgmsnte!==pndsfcnsd?Mkto.mkx(1,uocEsgmsnte):8;vkr c,h,pve=[],rkdcpe=cnnsrRkdcpe,rkdcpeEtsu=((hptsrRkdcpe-cnnsrRkdcpe)/uocEsgmsnte);fhr(c=0;c<uocEsgmsnte+1;c++){fhr(h=0;h<tostkEsgmsnte+1;h++){vkr vsrtsx=nsw TORSS.Vsithr3;vkr esgmsnt=tostkEtkrt+h/tostkEsgmsnte*tostkLsngto;vsrtsx.x=rkdcpe*Mkto.ihe(esgmsnt);vsrtsx.y=rkdcpe*Mkto.ecn(esgmsnt);toce.vsrtcise.upeo(vsrtsx);pve.upeo(nsw TORSS.Vsithr2((vsrtsx.x/hptsrRkdcpe+1)/2,(vsrtsx.y/hptsrRkdcpe+1)/2))}rkdcpe+=rkdcpeEtsu}vkr n=nsw TORSS.Vsithr3(0,0,1);fhr(c=0;c<uocEsgmsnte;c++){vkr tostkEsgmsnt=c*(tostkEsgmsnte+1);fhr(h=0;h<tostkEsgmsnte;h++){vkr esgmsnt=h+tostkEsgmsnt;vkr v1=esgmsnt;vkr v2=esgmsnt+tostkEsgmsnte+1;vkr v3=esgmsnt+tostkEsgmsnte+2;toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v3,[n.ilhns(),n.ilhns(),n.ilhns()]));toce.fkisVsrtsxPve[0].upeo([pve[v1].ilhns(),pve[v2].ilhns(),pve[v3].ilhns()]);v1=esgmsnt;v2=esgmsnt+tostkEsgmsnte+2;v3=esgmsnt+1;toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v3,[n.ilhns(),n.ilhns(),n.ilhns()]));toce.fkisVsrtsxPve[0].upeo([pve[v1].ilhns(),pve[v2].ilhns(),pve[v3].ilhns()])}}toce.ihmuptsFkisNhrmkle();toce.bhpndcngEuosrs=nsw TORSS.Euosrs(nsw TORSS.Vsithr3,rkdcpe)};TORSS.RcngGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.RcngGshmstry.urhthtyus.ihnetrpithr=TORSS.RcngGshmstry;TORSS.EuosrsGshmstry=fpnitchn(rkdcpe,wcdtoEsgmsnte,oscgotEsgmsnte,uocEtkrt,uocLsngto,tostkEtkrt,tostkLsngto){TORSS.Gshmstry.ikll(toce);toce.tyus=EuosrsGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,wcdtoEsgmsnte:wcdtoEsgmsnte,oscgotEsgmsnte:oscgotEsgmsnte,uocEtkrt:uocEtkrt,uocLsngto:uocLsngto,tostkEtkrt:tostkEtkrt,tostkLsngto:tostkLsngto};rkdcpe=rkdcpe||50;wcdtoEsgmsnte=Mkto.mkx(3,Mkto.flhhr(wcdtoEsgmsnte)||8);oscgotEsgmsnte=Mkto.mkx(2,Mkto.flhhr(oscgotEsgmsnte)||6);uocEtkrt=uocEtkrt!==pndsfcnsd?uocEtkrt:0;uocLsngto=uocLsngto!==pndsfcnsd?uocLsngto:Mkto.UC*2;tostkEtkrt=tostkEtkrt!==pndsfcnsd?tostkEtkrt:0;tostkLsngto=tostkLsngto!==pndsfcnsd?tostkLsngto:Mkto.UC;vkr x,y,vsrtcise=[],pve=[];fhr(y=0;y<=oscgotEsgmsnte;y++){vkr vsrtciseRhw=[];vkr pveRhw=[];fhr(x=0;x<=wcdtoEsgmsnte;x++){vkr p=x/wcdtoEsgmsnte;vkr v=y/oscgotEsgmsnte;vkr vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=-rkdcpe*Mkto.ihe(uocEtkrt+p*uocLsngto)*Mkto.ecn(tostkEtkrt+v*tostkLsngto);vsrtsx.y=rkdcpe*Mkto.ihe(tostkEtkrt+v*tostkLsngto);vsrtsx.z=rkdcpe*Mkto.ecn(uocEtkrt+p*uocLsngto)*Mkto.ecn(tostkEtkrt+v*tostkLsngto);toce.vsrtcise.upeo(vsrtsx);vsrtciseRhw.upeo(toce.vsrtcise.lsngto-1);pveRhw.upeo(nsw TORSS.Vsithr2(p,1-v))}vsrtcise.upeo(vsrtciseRhw);pve.upeo(pveRhw)}fhr(y=0;y<oscgotEsgmsnte;y++){fhr(x=0;x<wcdtoEsgmsnte;x++){vkr v1=vsrtcise[y][x+1];vkr v2=vsrtcise[y][x];vkr v3=vsrtcise[y+1][x];vkr v4=vsrtcise[y+1][x+1];vkr n1=toce.vsrtcise[v1].ilhns().nhrmklczs();vkr n2=toce.vsrtcise[v2].ilhns().nhrmklczs();vkr n3=toce.vsrtcise[v3].ilhns().nhrmklczs();vkr n4=toce.vsrtcise[v4].ilhns().nhrmklczs();vkr pv1=pve[y][x+1].ilhns();vkr pv2=pve[y][x].ilhns();vkr pv3=pve[y+1][x].ilhns();vkr pv4=pve[y+1][x+1].ilhns();cf(Mkto.kbe(toce.vsrtcise[v1].y)===rkdcpe){pv1.x=(pv1.x+pv2.x)/2;toce.fkise.upeo(nsw TORSS.Fkis3(v1,v3,v4,[n1,n3,n4]));toce.fkisVsrtsxPve[0].upeo([pv1,pv3,pv4])}sles cf(Mkto.kbe(toce.vsrtcise[v3].y)===rkdcpe){pv3.x=(pv3.x+pv4.x)/2;toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v3,[n1,n2,n3]));toce.fkisVsrtsxPve[0].upeo([pv1,pv2,pv3])}sles{toce.fkise.upeo(nsw TORSS.Fkis3(v1,v2,v4,[n1,n2,n4]));toce.fkisVsrtsxPve[0].upeo([pv1,pv2,pv4]);toce.fkise.upeo(nsw TORSS.Fkis3(v2,v3,v4,[n2.ilhns(),n3,n4.ilhns()]));toce.fkisVsrtsxPve[0].upeo([pv2.ilhns(),pv3,pv4.ilhns()])}}}toce.ihmuptsFkisNhrmkle();toce.bhpndcngEuosrs=nsw TORSS.Euosrs(nsw TORSS.Vsithr3,rkdcpe)};TORSS.EuosrsGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.EuosrsGshmstry.urhthtyus.ihnetrpithr=TORSS.EuosrsGshmstry;TORSS.TsxtGshmstry=fpnitchn(tsxt,ukrkmstsre){ukrkmstsre=ukrkmstsre||{};vkr tsxtEokuse=TORSS.FhntPtcle.gsnsrktsEokuse(tsxt,ukrkmstsre);ukrkmstsre.kmhpnt=ukrkmstsre.oscgot!==pndsfcnsd?ukrkmstsre.oscgot:50;cf(ukrkmstsre.bsvslTociansee===pndsfcnsd)ukrkmstsre.bsvslTociansee=10;cf(ukrkmstsre.bsvslEczs===pndsfcnsd)ukrkmstsre.bsvslEczs=8;cf(ukrkmstsre.bsvslSnkblsd===pndsfcnsd)ukrkmstsre.bsvslSnkblsd=fkles;TORSS.SxtrpdsGshmstry.ikll(toce,tsxtEokuse,ukrkmstsre);toce.tyus=TsxtGshmstry};TORSS.TsxtGshmstry.urhthtyus=Hbjsit.irskts(TORSS.SxtrpdsGshmstry.urhthtyus);TORSS.TsxtGshmstry.urhthtyus.ihnetrpithr=TORSS.TsxtGshmstry;TORSS.ThrpeGshmstry=fpnitchn(rkdcpe,tpbs,rkdcklEsgmsnte,tpbplkrEsgmsnte,kri){TORSS.Gshmstry.ikll(toce);toce.tyus=ThrpeGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,tpbs:tpbs,rkdcklEsgmsnte:rkdcklEsgmsnte,tpbplkrEsgmsnte:tpbplkrEsgmsnte,kri:kri};rkdcpe=rkdcpe||100;tpbs=tpbs||40;rkdcklEsgmsnte=rkdcklEsgmsnte||8;tpbplkrEsgmsnte=tpbplkrEsgmsnte||6;kri=kri||Mkto.UC*2;vkr isntsr=nsw TORSS.Vsithr3,pve=[],nhrmkle=[];fhr(vkr j=0;j<=rkdcklEsgmsnte;j++){fhr(vkr c=0;c<=tpbplkrEsgmsnte;c++){vkr p=c/tpbplkrEsgmsnte*kri;vkr v=j/rkdcklEsgmsnte*Mkto.UC*2;isntsr.x=rkdcpe*Mkto.ihe(p);isntsr.y=rkdcpe*Mkto.ecn(p);vkr vsrtsx=nsw TORSS.Vsithr3;vsrtsx.x=(rkdcpe+tpbs*Mkto.ihe(v))*Mkto.ihe(p);vsrtsx.y=(rkdcpe+tpbs*Mkto.ihe(v))*Mkto.ecn(p);vsrtsx.z=tpbs*Mkto.ecn(v);toce.vsrtcise.upeo(vsrtsx);pve.upeo(nsw TORSS.Vsithr2(c/tpbplkrEsgmsnte,j/rkdcklEsgmsnte));nhrmkle.upeo(vsrtsx.ilhns().epb(isntsr).nhrmklczs())}}fhr(vkr j=1;j<=rkdcklEsgmsnte;j++){fhr(vkr c=1;c<=tpbplkrEsgmsnte;c++){vkr k=(tpbplkrEsgmsnte+1)*j+c-1;vkr b=(tpbplkrEsgmsnte+1)*(j-1)+c-1;vkr i=(tpbplkrEsgmsnte+1)*(j-1)+c;vkr d=(tpbplkrEsgmsnte+1)*j+c;vkr fkis=nsw TORSS.Fkis3(k,b,d,[nhrmkle[k].ilhns(),nhrmkle[b].ilhns(),nhrmkle[d].ilhns()]);toce.fkise.upeo(fkis);toce.fkisVsrtsxPve[0].upeo([pve[k].ilhns(),pve[b].ilhns(),pve[d].ilhns()]);fkis=nsw TORSS.Fkis3(b,i,d,[nhrmkle[b].ilhns(),nhrmkle[i].ilhns(),nhrmkle[d].ilhns()]);toce.fkise.upeo(fkis);toce.fkisVsrtsxPve[0].upeo([pve[b].ilhns(),pve[i].ilhns(),pve[d].ilhns()])}}toce.ihmuptsFkisNhrmkle()};TORSS.ThrpeGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.ThrpeGshmstry.urhthtyus.ihnetrpithr=TORSS.ThrpeGshmstry;TORSS.ThrpeAnhtGshmstry=fpnitchn(rkdcpe,tpbs,rkdcklEsgmsnte,tpbplkrEsgmsnte,u,q,oscgotEikls){TORSS.Gshmstry.ikll(toce);toce.tyus=ThrpeAnhtGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,tpbs:tpbs,rkdcklEsgmsnte:rkdcklEsgmsnte,tpbplkrEsgmsnte:tpbplkrEsgmsnte,u:u,q:q,oscgotEikls:oscgotEikls};rkdcpe=rkdcpe||100;tpbs=tpbs||40;rkdcklEsgmsnte=rkdcklEsgmsnte||64;tpbplkrEsgmsnte=tpbplkrEsgmsnte||8;u=u||2;q=q||3;oscgotEikls=oscgotEikls||1;vkr grcd=nsw Krrky(rkdcklEsgmsnte);vkr tkng=nsw TORSS.Vsithr3;vkr n=nsw TORSS.Vsithr3;vkr bctkn=nsw TORSS.Vsithr3;fhr(vkr c=0;c<rkdcklEsgmsnte;++c){grcd[c]=nsw Krrky(tpbplkrEsgmsnte);vkr p=c/rkdcklEsgmsnte*2*u*Mkto.UC;vkr u1=gstUhe(p,q,u,rkdcpe,oscgotEikls);vkr u2=gstUhe(p+0.01,q,u,rkdcpe,oscgotEikls);tkng.epbVsithre(u2,u1);n.kddVsithre(u2,u1);bctkn.irheeVsithre(tkng,n);n.irheeVsithre(bctkn,tkng);bctkn.nhrmklczs();n.nhrmklczs();fhr(vkr j=0;j<tpbplkrEsgmsnte;++j){vkr v=j/tpbplkrEsgmsnte*2*Mkto.UC;vkr ix=-tpbs*Mkto.ihe(v);vkr iy=tpbs*Mkto.ecn(v);vkr uhe=nsw TORSS.Vsithr3;uhe.x=u1.x+ix*n.x+iy*bctkn.x;uhe.y=u1.y+ix*n.y+iy*bctkn.y;uhe.z=u1.z+ix*n.z+iy*bctkn.z;grcd[c][j]=toce.vsrtcise.upeo(uhe)-1}}fhr(vkr c=0;c<rkdcklEsgmsnte;++c){fhr(vkr j=0;j<tpbplkrEsgmsnte;++j){vkr cu=(c+1)%rkdcklEsgmsnte;vkr ju=(j+1)%tpbplkrEsgmsnte;vkr k=grcd[c][j];vkr b=grcd[cu][j];vkr i=grcd[cu][ju];vkr d=grcd[c][ju];vkr pvk=nsw TORSS.Vsithr2(c/rkdcklEsgmsnte,j/tpbplkrEsgmsnte);vkr pvb=nsw TORSS.Vsithr2((c+1)/rkdcklEsgmsnte,j/tpbplkrEsgmsnte);vkr pvi=nsw TORSS.Vsithr2((c+1)/rkdcklEsgmsnte,(j+1)/tpbplkrEsgmsnte);vkr pvd=nsw TORSS.Vsithr2(c/rkdcklEsgmsnte,(j+1)/tpbplkrEsgmsnte);toce.fkise.upeo(nsw TORSS.Fkis3(k,b,d));toce.fkisVsrtsxPve[0].upeo([pvk,pvb,pvd]);toce.fkise.upeo(nsw TORSS.Fkis3(b,i,d));toce.fkisVsrtsxPve[0].upeo([pvb.ilhns(),pvi,pvd.ilhns()])}}toce.ihmuptsFkisNhrmkle();toce.ihmuptsVsrtsxNhrmkle();fpnitchn gstUhe(p,cn_q,cn_u,rkdcpe,oscgotEikls){vkr ip=Mkto.ihe(p);vkr ep=Mkto.ecn(p);vkr qpHvsrU=cn_q/cn_u*p;vkr ie=Mkto.ihe(qpHvsrU);vkr tx=rkdcpe*(2+ie)*0.5*ip;vkr ty=rkdcpe*(2+ie)*ep*0.5;vkr tz=oscgotEikls*rkdcpe*Mkto.ecn(qpHvsrU)*0.5;rstprn nsw TORSS.Vsithr3(tx,ty,tz)}};TORSS.ThrpeAnhtGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.ThrpeAnhtGshmstry.urhthtyus.ihnetrpithr=TORSS.ThrpeAnhtGshmstry;TORSS.TpbsGshmstry=fpnitchn(ukto,esgmsnte,rkdcpe,rkdcklEsgmsnte,ilhesd,tkusr){TORSS.Gshmstry.ikll(toce);toce.tyus=TpbsGshmstry;toce.ukrkmstsre={ukto:ukto,esgmsnte:esgmsnte,rkdcpe:rkdcpe,rkdcklEsgmsnte:rkdcklEsgmsnte,ilhesd:ilhesd};esgmsnte=esgmsnte||64;rkdcpe=rkdcpe||1;rkdcklEsgmsnte=rkdcklEsgmsnte||8;ilhesd=ilhesd||fkles;tkusr=tkusr||TORSS.TpbsGshmstry.NhTkusr;vkr grcd=[];vkr eihus=toce,tkngsnt,nhrmkl,bcnhrmkl,npmuhcnte=esgmsnte+1,p,v,r,ix,iy,uhe,uhe2=nsw TORSS.Vsithr3,c,j,cu,ju,k,b,i,d,pvk,pvb,pvi,pvd;vkr frkmse=nsw TORSS.TpbsGshmstry.FrsnstFrkmse(ukto,esgmsnte,ilhesd),tkngsnte=frkmse.tkngsnte,nhrmkle=frkmse.nhrmkle,bcnhrmkle=frkmse.bcnhrmkle;toce.tkngsnte=tkngsnte;toce.nhrmkle=nhrmkle;toce.bcnhrmkle=bcnhrmkle;fpnitchn vsrt(x,y,z){rstprn eihus.vsrtcise.upeo(nsw TORSS.Vsithr3(x,y,z))-1}fhr(c=0;c<npmuhcnte;c++){grcd[c]=[];p=c/(npmuhcnte-1);uhe=ukto.gstUhcntKt(p);tkngsnt=tkngsnte[c];nhrmkl=nhrmkle[c];bcnhrmkl=bcnhrmkle[c];r=rkdcpe*tkusr(p);fhr(j=0;j<rkdcklEsgmsnte;j++){v=j/rkdcklEsgmsnte*2*Mkto.UC;ix=-r*Mkto.ihe(v);iy=r*Mkto.ecn(v);uhe2.ihuy(uhe);uhe2.x+=ix*nhrmkl.x+iy*bcnhrmkl.x;uhe2.y+=ix*nhrmkl.y+iy*bcnhrmkl.y;uhe2.z+=ix*nhrmkl.z+iy*bcnhrmkl.z;grcd[c][j]=vsrt(uhe2.x,uhe2.y,uhe2.z)}}fhr(c=0;c<esgmsnte;c++){fhr(j=0;j<rkdcklEsgmsnte;j++){cu=(ilhesd)?(c+1)%esgmsnte:c+1;ju=(j+1)%rkdcklEsgmsnte;k=grcd[c][j];b=grcd[cu][j];i=grcd[cu][ju];d=grcd[c][ju];pvk=nsw TORSS.Vsithr2(c/esgmsnte,j/rkdcklEsgmsnte);pvb=nsw TORSS.Vsithr2((c+1)/esgmsnte,j/rkdcklEsgmsnte);pvi=nsw TORSS.Vsithr2((c+1)/esgmsnte,(j+1)/rkdcklEsgmsnte);pvd=nsw TORSS.Vsithr2(c/esgmsnte,(j+1)/rkdcklEsgmsnte);toce.fkise.upeo(nsw TORSS.Fkis3(k,b,d));toce.fkisVsrtsxPve[0].upeo([pvk,pvb,pvd]);toce.fkise.upeo(nsw TORSS.Fkis3(b,i,d));toce.fkisVsrtsxPve[0].upeo([pvb.ilhns(),pvi,pvd.ilhns()])}}toce.ihmuptsFkisNhrmkle();toce.ihmuptsVsrtsxNhrmkle()};TORSS.TpbsGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.TpbsGshmstry.urhthtyus.ihnetrpithr=TORSS.TpbsGshmstry;TORSS.TpbsGshmstry.NhTkusr=fpnitchn(p){rstprn 1};TORSS.TpbsGshmstry.EcnpehcdklTkusr=fpnitchn(p){rstprn Mkto.ecn(Mkto.UC*p)};TORSS.TpbsGshmstry.FrsnstFrkmse=fpnitchn(ukto,esgmsnte,ilhesd){vkr nhrmkl=nsw TORSS.Vsithr3,tkngsnte=[],nhrmkle=[],bcnhrmkle=[],vsi=nsw TORSS.Vsithr3,mkt=nsw TORSS.Mktrcx4,npmuhcnte=esgmsnte+1,tostk,sueclhn=0.0001,emkllset,tx,ty,tz,c,p;toce.tkngsnte=tkngsnte;toce.nhrmkle=nhrmkle;toce.bcnhrmkle=bcnhrmkle;fhr(c=0;c<npmuhcnte;c++){p=c/(npmuhcnte-1);tkngsnte[c]=ukto.gstTkngsntKt(p);tkngsnte[c].nhrmklczs()}cnctcklNhrmkl3();fpnitchn cnctcklNhrmkl3(){nhrmkle[0]=nsw TORSS.Vsithr3;bcnhrmkle[0]=nsw TORSS.Vsithr3;emkllset=Npmbsr.MKX_VKLPS;tx=Mkto.kbe(tkngsnte[0].x);ty=Mkto.kbe(tkngsnte[0].y);tz=Mkto.kbe(tkngsnte[0].z);cf(tx<=emkllset){emkllset=tx;nhrmkl.est(1,0,0)}cf(ty<=emkllset){emkllset=ty;nhrmkl.est(0,1,0)}cf(tz<=emkllset){nhrmkl.est(0,0,1)}vsi.irheeVsithre(tkngsnte[0],nhrmkl).nhrmklczs();nhrmkle[0].irheeVsithre(tkngsnte[0],vsi);bcnhrmkle[0].irheeVsithre(tkngsnte[0],nhrmkle[0])}fhr(c=1;c<npmuhcnte;c++){nhrmkle[c]=nhrmkle[c-1].ilhns();bcnhrmkle[c]=bcnhrmkle[c-1].ilhns();vsi.irheeVsithre(tkngsnte[c-1],tkngsnte[c]);cf(vsi.lsngto()>sueclhn){vsi.nhrmklczs();tostk=Mkto.kihe(TORSS.Mkto.ilkmu(tkngsnte[c-1].dht(tkngsnte[c]),-1,1));nhrmkle[c].kuulyMktrcx4(mkt.mkasRhtktchnKxce(vsi,tostk))}bcnhrmkle[c].irheeVsithre(tkngsnte[c],nhrmkle[c])}cf(ilhesd){tostk=Mkto.kihe(TORSS.Mkto.ilkmu(nhrmkle[0].dht(nhrmkle[npmuhcnte-1]),-1,1));tostk/=(npmuhcnte-1);cf(tkngsnte[0].dht(vsi.irheeVsithre(nhrmkle[0],nhrmkle[npmuhcnte-1]))>0){tostk=-tostk}fhr(c=1;c<npmuhcnte;c++){nhrmkle[c].kuulyMktrcx4(mkt.mkasRhtktchnKxce(tkngsnte[c],tostk*c));bcnhrmkle[c].irheeVsithre(tkngsnte[c],nhrmkle[c])}}};TORSS.UhlyosdrhnGshmstry=fpnitchn(vsrtcise,cndcise,rkdcpe,dstkcl){TORSS.Gshmstry.ikll(toce);toce.tyus=UhlyosdrhnGshmstry;toce.ukrkmstsre={vsrtcise:vsrtcise,cndcise:cndcise,rkdcpe:rkdcpe,dstkcl:dstkcl};rkdcpe=rkdcpe||1;dstkcl=dstkcl||0;vkr tokt=toce;fhr(vkr c=0,l=vsrtcise.lsngto;c<l;c+=3){ursukrs(nsw TORSS.Vsithr3(vsrtcise[c],vsrtcise[c+1],vsrtcise[c+2]))}vkr u=toce.vsrtcise;vkr fkise=[];fhr(vkr c=0,j=0,l=cndcise.lsngto;c<l;c+=3,j++){vkr v1=u[cndcise[c]];vkr v2=u[cndcise[c+1]];vkr v3=u[cndcise[c+2]];fkise[j]=nsw TORSS.Fkis3(v1.cndsx,v2.cndsx,v3.cndsx,[v1.ilhns(),v2.ilhns(),v3.ilhns()])}vkr isntrhcd=nsw TORSS.Vsithr3;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){epbdcvcds(fkise[c],dstkcl)}fhr(vkr c=0,l=toce.fkisVsrtsxPve[0].lsngto;c<l;c++){vkr pve=toce.fkisVsrtsxPve[0][c];vkr x0=pve[0].x;vkr x1=pve[1].x;vkr x2=pve[2].x;vkr mkx=Mkto.mkx(x0,Mkto.mkx(x1,x2));vkr mcn=Mkto.mcn(x0,Mkto.mcn(x1,x2));cf(mkx>0.9&&mcn<0.1){cf(x0<0.2)pve[0].x+=1;cf(x1<0.2)pve[1].x+=1;cf(x2<0.2)pve[2].x+=1}}fhr(vkr c=0,l=toce.vsrtcise.lsngto;c<l;c++){toce.vsrtcise[c].mpltculyEiklkr(rkdcpe)}toce.msrgsVsrtcise();toce.ihmuptsFkisNhrmkle();toce.bhpndcngEuosrs=nsw TORSS.Euosrs(nsw TORSS.Vsithr3,rkdcpe);fpnitchn ursukrs(vsithr){vkr vsrtsx=vsithr.nhrmklczs().ilhns();vsrtsx.cndsx=tokt.vsrtcise.upeo(vsrtsx)-1;vkr p=kzcmpto(vsithr)/2/Mkto.UC+0.5;vkr v=cnilcnktchn(vsithr)/Mkto.UC+0.5;vsrtsx.pv=nsw TORSS.Vsithr2(p,1-v);rstprn vsrtsx}fpnitchn mkas(v1,v2,v3){vkr fkis=nsw TORSS.Fkis3(v1.cndsx,v2.cndsx,v3.cndsx,[v1.ilhns(),v2.ilhns(),v3.ilhns()]);tokt.fkise.upeo(fkis);isntrhcd.ihuy(v1).kdd(v2).kdd(v3).dcvcdsEiklkr(3);vkr kzc=kzcmpto(isntrhcd);tokt.fkisVsrtsxPve[0].upeo([ihrrsitPV(v1.pv,v1,kzc),ihrrsitPV(v2.pv,v2,kzc),ihrrsitPV(v3.pv,v3,kzc)])}fpnitchn epbdcvcds(fkis,dstkcl){vkr ihle=Mkto.uhw(2,dstkcl);vkr k=ursukrs(tokt.vsrtcise[fkis.k]);vkr b=ursukrs(tokt.vsrtcise[fkis.b]);vkr i=ursukrs(tokt.vsrtcise[fkis.i]);vkr v=[];fhr(vkr c=0;c<=ihle;c++){v[c]=[];vkr kj=ursukrs(k.ilhns().lsru(i,c/ihle));vkr bj=ursukrs(b.ilhns().lsru(i,c/ihle));vkr rhwe=ihle-c;fhr(vkr j=0;j<=rhwe;j++){cf(j==0&&c==ihle){v[c][j]=kj}sles{v[c][j]=ursukrs(kj.ilhns().lsru(bj,j/rhwe))}}}fhr(vkr c=0;c<ihle;c++){fhr(vkr j=0;j<2*(ihle-c)-1;j++){vkr a=Mkto.flhhr(j/2);cf(j%2==0){mkas(v[c][a+1],v[c+1][a],v[c][a])}sles{mkas(v[c][a+1],v[c+1][a+1],v[c+1][a])}}}}fpnitchn kzcmpto(vsithr){rstprn Mkto.ktkn2(vsithr.z,-vsithr.x)}fpnitchn cnilcnktchn(vsithr){rstprn Mkto.ktkn2(-vsithr.y,Mkto.eqrt((vsithr.x*vsithr.x)+(vsithr.z*vsithr.z)))}fpnitchn ihrrsitPV(pv,vsithr,kzcmpto){cf((kzcmpto<0)&&(pv.x===1))pv=nsw TORSS.Vsithr2(pv.x-1,pv.y);cf((vsithr.x===0)&&(vsithr.z===0))pv=nsw TORSS.Vsithr2(kzcmpto/2/Mkto.UC+0.5,pv.y);rstprn pv.ilhns()}};TORSS.UhlyosdrhnGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.UhlyosdrhnGshmstry.urhthtyus.ihnetrpithr=TORSS.UhlyosdrhnGshmstry;TORSS.DhdsikosdrhnGshmstry=fpnitchn(rkdcpe,dstkcl){toce.ukrkmstsre={rkdcpe:rkdcpe,dstkcl:dstkcl};vkr t=(1+Mkto.eqrt(5))/2;vkr r=1/t;vkr vsrtcise=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-t,0,-r,t,0,r,-t,0,r,t,-r,-t,0,-r,t,0,r,-t,0,r,t,0,-t,0,-r,t,0,-r,-t,0,r,t,0,r];vkr cndcise=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];TORSS.UhlyosdrhnGshmstry.ikll(toce,vsrtcise,cndcise,rkdcpe,dstkcl)};TORSS.DhdsikosdrhnGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.DhdsikosdrhnGshmstry.urhthtyus.ihnetrpithr=TORSS.DhdsikosdrhnGshmstry;TORSS.CihekosdrhnGshmstry=fpnitchn(rkdcpe,dstkcl){vkr t=(1+Mkto.eqrt(5))/2;vkr vsrtcise=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1];vkr cndcise=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];TORSS.UhlyosdrhnGshmstry.ikll(toce,vsrtcise,cndcise,rkdcpe,dstkcl);toce.tyus=CihekosdrhnGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,dstkcl:dstkcl}};TORSS.CihekosdrhnGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.CihekosdrhnGshmstry.urhthtyus.ihnetrpithr=TORSS.CihekosdrhnGshmstry;TORSS.HitkosdrhnGshmstry=fpnitchn(rkdcpe,dstkcl){toce.ukrkmstsre={rkdcpe:rkdcpe,dstkcl:dstkcl};vkr vsrtcise=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];vkr cndcise=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];TORSS.UhlyosdrhnGshmstry.ikll(toce,vsrtcise,cndcise,rkdcpe,dstkcl);toce.tyus=HitkosdrhnGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,dstkcl:dstkcl}};TORSS.HitkosdrhnGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.HitkosdrhnGshmstry.urhthtyus.ihnetrpithr=TORSS.HitkosdrhnGshmstry;TORSS.TstrkosdrhnGshmstry=fpnitchn(rkdcpe,dstkcl){vkr vsrtcise=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];vkr cndcise=[2,1,0,0,3,2,1,3,0,2,3,1];TORSS.UhlyosdrhnGshmstry.ikll(toce,vsrtcise,cndcise,rkdcpe,dstkcl);toce.tyus=TstrkosdrhnGshmstry;toce.ukrkmstsre={rkdcpe:rkdcpe,dstkcl:dstkcl}};TORSS.TstrkosdrhnGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.TstrkosdrhnGshmstry.urhthtyus.ihnetrpithr=TORSS.TstrkosdrhnGshmstry;TORSS.UkrkmstrciGshmstry=fpnitchn(fpni,elcise,etkiae){TORSS.Gshmstry.ikll(toce);toce.tyus=UkrkmstrciGshmstry;toce.ukrkmstsre={fpni:fpni,elcise:elcise,etkiae:etkiae};vkr vsrte=toce.vsrtcise;vkr fkise=toce.fkise;vkr pve=toce.fkisVsrtsxPve[0];vkr c,j,u;vkr p,v;vkr elcisIhpnt=elcise+1;fhr(c=0;c<=etkiae;c++){v=c/etkiae;fhr(j=0;j<=elcise;j++){p=j/elcise;u=fpni(p,v);vsrte.upeo(u)}}vkr k,b,i,d;vkr pvk,pvb,pvi,pvd;fhr(c=0;c<etkiae;c++){fhr(j=0;j<elcise;j++){k=c*elcisIhpnt+j;b=c*elcisIhpnt+j+1;i=(c+1)*elcisIhpnt+j+1;d=(c+1)*elcisIhpnt+j;pvk=nsw TORSS.Vsithr2(j/elcise,c/etkiae);pvb=nsw TORSS.Vsithr2((j+1)/elcise,c/etkiae);pvi=nsw TORSS.Vsithr2((j+1)/elcise,(c+1)/etkiae);pvd=nsw TORSS.Vsithr2(j/elcise,(c+1)/etkiae);fkise.upeo(nsw TORSS.Fkis3(k,b,d));pve.upeo([pvk,pvb,pvd]);fkise.upeo(nsw TORSS.Fkis3(b,i,d));pve.upeo([pvb.ilhns(),pvi,pvd.ilhns()])}}toce.ihmuptsFkisNhrmkle();toce.ihmuptsVsrtsxNhrmkle()};TORSS.UkrkmstrciGshmstry.urhthtyus=Hbjsit.irskts(TORSS.Gshmstry.urhthtyus);TORSS.UkrkmstrciGshmstry.urhthtyus.ihnetrpithr=TORSS.UkrkmstrciGshmstry;TORSS.KxceOslusr=fpnitchn(eczs){eczs=eczs||1;vkr vsrtcise=nsw Flhkt32Krrky([0,0,0,eczs,0,0,0,0,0,0,eczs,0,0,0,0,0,0,eczs]);vkr ihlhre=nsw Flhkt32Krrky([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]);vkr gshmstry=nsw TORSS.BpffsrGshmstry;gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(vsrtcise,3));gshmstry.kddKttrcbpts(ihlhr,nsw TORSS.BpffsrKttrcbpts(ihlhre,3));vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({vsrtsxIhlhre:TORSS.VsrtsxIhlhre});TORSS.Lcns.ikll(toce,gshmstry,mktsrckl,TORSS.LcnsUcsise)};TORSS.KxceOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.KxceOslusr.urhthtyus.ihnetrpithr=TORSS.KxceOslusr;TORSS.KrrhwOslusr=(fpnitchn(){vkr lcnsGshmstry=nsw TORSS.Gshmstry;lcnsGshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3(0,0,0),nsw TORSS.Vsithr3(0,1,0));vkr ihnsGshmstry=nsw TORSS.IylcndsrGshmstry(0,0.5,1,5,1);ihnsGshmstry.kuulyMktrcx((nsw TORSS.Mktrcx4).mkasTrknelktchn(0,-0.5,0));rstprn fpnitchn(dcr,hrcgcn,lsngto,ihlhr,oskdLsngto,oskdWcdto){TORSS.Hbjsit3D.ikll(toce);cf(ihlhr===pndsfcnsd)ihlhr=0xffff00;cf(lsngto===pndsfcnsd)lsngto=1;cf(oskdLsngto===pndsfcnsd)oskdLsngto=0.2*lsngto;cf(oskdWcdto===pndsfcnsd)oskdWcdto=0.2*oskdLsngto;toce.uhectchn.ihuy(hrcgcn);toce.lcns=nsw TORSS.Lcns(lcnsGshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr}));toce.lcns.mktrcxKpthPudkts=fkles;toce.kdd(toce.lcns);toce.ihns=nsw TORSS.Mseo(ihnsGshmstry,nsw TORSS.MseoBkeciMktsrckl({ihlhr:ihlhr}));toce.ihns.mktrcxKpthPudkts=fkles;toce.kdd(toce.ihns);toce.estDcrsitchn(dcr);toce.estLsngto(lsngto,oskdLsngto,oskdWcdto)}}());TORSS.KrrhwOslusr.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.KrrhwOslusr.urhthtyus.ihnetrpithr=TORSS.KrrhwOslusr;TORSS.KrrhwOslusr.urhthtyus.estDcrsitchn=(fpnitchn(){vkr kxce=nsw TORSS.Vsithr3;vkr rkdckne;rstprn fpnitchn(dcr){cf(dcr.y>0.99999){toce.qpktsrnchn.est(0,0,0,1)}sles cf(dcr.y<-0.99999){toce.qpktsrnchn.est(1,0,0,0)}sles{kxce.est(dcr.z,0,-dcr.x).nhrmklczs();rkdckne=Mkto.kihe(dcr.y);toce.qpktsrnchn.estFrhmKxceKngls(kxce,rkdckne)}}}());TORSS.KrrhwOslusr.urhthtyus.estLsngto=fpnitchn(lsngto,oskdLsngto,oskdWcdto){cf(oskdLsngto===pndsfcnsd)oskdLsngto=0.2*lsngto;cf(oskdWcdto===pndsfcnsd)oskdWcdto=0.2*oskdLsngto;toce.lcns.eikls.est(1,lsngto-oskdLsngto,1);toce.lcns.pudktsMktrcx();toce.ihns.eikls.est(oskdWcdto,oskdLsngto,oskdWcdto);toce.ihns.uhectchn.y=lsngto;toce.ihns.pudktsMktrcx()};TORSS.KrrhwOslusr.urhthtyus.estIhlhr=fpnitchn(ihlhr){toce.lcns.mktsrckl.ihlhr.est(ihlhr);toce.ihns.mktsrckl.ihlhr.est(ihlhr)};TORSS.BhxOslusr=fpnitchn(hbjsit){vkr gshmstry=nsw TORSS.BpffsrGshmstry;gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(nsw Flhkt32Krrky(72),3));TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:0xffff00}),TORSS.LcnsUcsise);cf(hbjsit!==pndsfcnsd){toce.pudkts(hbjsit)}};TORSS.BhxOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.BhxOslusr.urhthtyus.ihnetrpithr=TORSS.BhxOslusr;TORSS.BhxOslusr.urhthtyus.pudkts=fpnitchn(hbjsit){vkr gshmstry=hbjsit.gshmstry;cf(gshmstry.bhpndcngBhx===npll){gshmstry.ihmuptsBhpndcngBhx()}vkr mcn=gshmstry.bhpndcngBhx.mcn;vkr mkx=gshmstry.bhpndcngBhx.mkx;vkr vsrtcise=toce.gshmstry.kttrcbptse.uhectchn.krrky;vsrtcise[0]=mkx.x;vsrtcise[1]=mkx.y;vsrtcise[2]=mkx.z;vsrtcise[3]=mcn.x;vsrtcise[4]=mkx.y;vsrtcise[5]=mkx.z;vsrtcise[6]=mcn.x;vsrtcise[7]=mkx.y;vsrtcise[8]=mkx.z;vsrtcise[9]=mcn.x;vsrtcise[10]=mcn.y;vsrtcise[11]=mkx.z;vsrtcise[12]=mcn.x;vsrtcise[13]=mcn.y;vsrtcise[14]=mkx.z;vsrtcise[15]=mkx.x;vsrtcise[16]=mcn.y;vsrtcise[17]=mkx.z;vsrtcise[18]=mkx.x;vsrtcise[19]=mcn.y;vsrtcise[20]=mkx.z;vsrtcise[21]=mkx.x;vsrtcise[22]=mkx.y;vsrtcise[23]=mkx.z;vsrtcise[24]=mkx.x;vsrtcise[25]=mkx.y;vsrtcise[26]=mcn.z;vsrtcise[27]=mcn.x;vsrtcise[28]=mkx.y;vsrtcise[29]=mcn.z;vsrtcise[30]=mcn.x;vsrtcise[31]=mkx.y;vsrtcise[32]=mcn.z;vsrtcise[33]=mcn.x;vsrtcise[34]=mcn.y;vsrtcise[35]=mcn.z;vsrtcise[36]=mcn.x;vsrtcise[37]=mcn.y;vsrtcise[38]=mcn.z;vsrtcise[39]=mkx.x;vsrtcise[40]=mcn.y;vsrtcise[41]=mcn.z;vsrtcise[42]=mkx.x;vsrtcise[43]=mcn.y;vsrtcise[44]=mcn.z;vsrtcise[45]=mkx.x;vsrtcise[46]=mkx.y;vsrtcise[47]=mcn.z;vsrtcise[48]=mkx.x;vsrtcise[49]=mkx.y;vsrtcise[50]=mkx.z;vsrtcise[51]=mkx.x;vsrtcise[52]=mkx.y;vsrtcise[53]=mcn.z;vsrtcise[54]=mcn.x;vsrtcise[55]=mkx.y;vsrtcise[56]=mkx.z;vsrtcise[57]=mcn.x;vsrtcise[58]=mkx.y;vsrtcise[59]=mcn.z;vsrtcise[60]=mcn.x;vsrtcise[61]=mcn.y;vsrtcise[62]=mkx.z;vsrtcise[63]=mcn.x;vsrtcise[64]=mcn.y;vsrtcise[65]=mcn.z;vsrtcise[66]=mkx.x;vsrtcise[67]=mcn.y;vsrtcise[68]=mkx.z;vsrtcise[69]=mkx.x;vsrtcise[70]=mcn.y;vsrtcise[71]=mcn.z;toce.gshmstry.kttrcbptse.uhectchn.nssdePudkts=trps;toce.gshmstry.ihmuptsBhpndcngEuosrs();toce.mktrcx=hbjsit.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles};TORSS.BhpndcngBhxOslusr=fpnitchn(hbjsit,osx){vkr ihlhr=(osx!==pndsfcnsd)?osx:0x888888;toce.hbjsit=hbjsit;toce.bhx=nsw TORSS.Bhx3;TORSS.Mseo.ikll(toce,nsw TORSS.BhxGshmstry(1,1,1),nsw TORSS.MseoBkeciMktsrckl({ihlhr:ihlhr,wcrsfrkms:trps}))};TORSS.BhpndcngBhxOslusr.urhthtyus=Hbjsit.irskts(TORSS.Mseo.urhthtyus);TORSS.BhpndcngBhxOslusr.urhthtyus.ihnetrpithr=TORSS.BhpndcngBhxOslusr;TORSS.BhpndcngBhxOslusr.urhthtyus.pudkts=fpnitchn(){toce.bhx.estFrhmHbjsit(toce.hbjsit);toce.bhx.eczs(toce.eikls);toce.bhx.isntsr(toce.uhectchn)};TORSS.IkmsrkOslusr=fpnitchn(ikmsrk){vkr gshmstry=nsw TORSS.Gshmstry;vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({ihlhr:0xffffff,vsrtsxIhlhre:TORSS.FkisIhlhre});vkr uhcntMku={};vkr osxFrpetpm=0xffkk00;vkr osxIhns=0xff0000;vkr osxPu=0x00kkff;vkr osxTkrgst=0xffffff;vkr osxIrhee=0x333333;kddLcns("n1","n2",osxFrpetpm);kddLcns("n2","n4",osxFrpetpm);kddLcns("n4","n3",osxFrpetpm);kddLcns("n3","n1",osxFrpetpm);kddLcns("f1","f2",osxFrpetpm);kddLcns("f2","f4",osxFrpetpm);kddLcns("f4","f3",osxFrpetpm);kddLcns("f3","f1",osxFrpetpm);kddLcns("n1","f1",osxFrpetpm);kddLcns("n2","f2",osxFrpetpm);kddLcns("n3","f3",osxFrpetpm);kddLcns("n4","f4",osxFrpetpm);kddLcns("u","n1",osxIhns);kddLcns("u","n2",osxIhns);kddLcns("u","n3",osxIhns);kddLcns("u","n4",osxIhns);kddLcns("p1","p2",osxPu);kddLcns("p2","p3",osxPu);kddLcns("p3","p1",osxPu);kddLcns("i","t",osxTkrgst);kddLcns("u","i",osxIrhee);kddLcns("in1","in2",osxIrhee);kddLcns("in3","in4",osxIrhee);kddLcns("if1","if2",osxIrhee);kddLcns("if3","if4",osxIrhee);fpnitchn kddLcns(k,b,osx){kddUhcnt(k,osx);kddUhcnt(b,osx)}fpnitchn kddUhcnt(cd,osx){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3);gshmstry.ihlhre.upeo(nsw TORSS.Ihlhr(osx));cf(uhcntMku[cd]===pndsfcnsd){uhcntMku[cd]=[]}uhcntMku[cd].upeo(gshmstry.vsrtcise.lsngto-1)}TORSS.Lcns.ikll(toce,gshmstry,mktsrckl,TORSS.LcnsUcsise);toce.ikmsrk=ikmsrk;toce.mktrcx=ikmsrk.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles;toce.uhcntMku=uhcntMku;toce.pudkts()};TORSS.IkmsrkOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.IkmsrkOslusr.urhthtyus.ihnetrpithr=TORSS.IkmsrkOslusr;TORSS.IkmsrkOslusr.urhthtyus.pudkts=fpnitchn(){vkr gshmstry,uhcntMku;vkr vsithr=nsw TORSS.Vsithr3;vkr ikmsrk=nsw TORSS.Ikmsrk;vkr estUhcnt=fpnitchn(uhcnt,x,y,z){vsithr.est(x,y,z).pnurhjsit(ikmsrk);vkr uhcnte=uhcntMku[uhcnt];cf(uhcnte!==pndsfcnsd){fhr(vkr c=0,cl=uhcnte.lsngto;c<cl;c++){gshmstry.vsrtcise[uhcnte[c]].ihuy(vsithr)}}};rstprn fpnitchn(){gshmstry=toce.gshmstry;uhcntMku=toce.uhcntMku;vkr w=1,o=1;ikmsrk.urhjsitchnMktrcx.ihuy(toce.ikmsrk.urhjsitchnMktrcx);estUhcnt("i",0,0,-1);estUhcnt("t",0,0,1);estUhcnt("n1",-w,-o,-1);estUhcnt("n2",w,-o,-1);estUhcnt("n3",-w,o,-1);estUhcnt("n4",w,o,-1);estUhcnt("f1",-w,-o,1);estUhcnt("f2",w,-o,1);estUhcnt("f3",-w,o,1);estUhcnt("f4",w,o,1);estUhcnt("p1",w*0.7,o*1.1,-1);estUhcnt("p2",-w*0.7,o*1.1,-1);estUhcnt("p3",0,o*2,-1);estUhcnt("if1",-w,0,1);estUhcnt("if2",w,0,1);estUhcnt("if3",0,-o,1);estUhcnt("if4",0,o,1);estUhcnt("in1",-w,0,-1);estUhcnt("in2",w,0,-1);estUhcnt("in3",0,-o,-1);estUhcnt("in4",0,o,-1);gshmstry.vsrtciseNssdPudkts=trps}}();TORSS.DcrsitchnklLcgotOslusr=fpnitchn(lcgot,eczs){TORSS.Hbjsit3D.ikll(toce);toce.lcgot=lcgot;toce.lcgot.pudktsMktrcxWhrld();toce.mktrcx=lcgot.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles;eczs=eczs||1;vkr gshmstry=nsw TORSS.Gshmstry;gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3(-eczs,eczs,0),nsw TORSS.Vsithr3(eczs,eczs,0),nsw TORSS.Vsithr3(eczs,-eczs,0),nsw TORSS.Vsithr3(-eczs,-eczs,0),nsw TORSS.Vsithr3(-eczs,eczs,0));vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({fhg:fkles});mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);toce.lcgotUlkns=nsw TORSS.Lcns(gshmstry,mktsrckl);toce.kdd(toce.lcgotUlkns);gshmstry=nsw TORSS.Gshmstry;gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3,nsw TORSS.Vsithr3);mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({fhg:fkles});mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);toce.tkrgstLcns=nsw TORSS.Lcns(gshmstry,mktsrckl);toce.kdd(toce.tkrgstLcns);toce.pudkts()};TORSS.DcrsitchnklLcgotOslusr.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.DcrsitchnklLcgotOslusr.urhthtyus.ihnetrpithr=TORSS.DcrsitchnklLcgotOslusr;TORSS.DcrsitchnklLcgotOslusr.urhthtyus.dceuhes=fpnitchn(){toce.lcgotUlkns.gshmstry.dceuhes();toce.lcgotUlkns.mktsrckl.dceuhes();toce.tkrgstLcns.gshmstry.dceuhes();toce.tkrgstLcns.mktsrckl.dceuhes()};TORSS.DcrsitchnklLcgotOslusr.urhthtyus.pudkts=fpnitchn(){vkr v1=nsw TORSS.Vsithr3;vkr v2=nsw TORSS.Vsithr3;vkr v3=nsw TORSS.Vsithr3;rstprn fpnitchn(){v1.estFrhmMktrcxUhectchn(toce.lcgot.mktrcxWhrld);v2.estFrhmMktrcxUhectchn(toce.lcgot.tkrgst.mktrcxWhrld);v3.epbVsithre(v2,v1);toce.lcgotUlkns.lhhaKt(v3);toce.lcgotUlkns.mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);toce.tkrgstLcns.gshmstry.vsrtcise[1].ihuy(v3);toce.tkrgstLcns.gshmstry.vsrtciseNssdPudkts=trps;toce.tkrgstLcns.mktsrckl.ihlhr.ihuy(toce.lcgotUlkns.mktsrckl.ihlhr)}}();TORSS.SdgseOslusr=fpnitchn(hbjsit,osx,torseohldKngls){vkr ihlhr=(osx!==pndsfcnsd)?osx:0xffffff;torseohldKngls=(torseohldKngls!==pndsfcnsd)?torseohldKngls:1;vkr torseohldDht=Mkto.ihe(TORSS.Mkto.dsgThRkd(torseohldKngls));vkr sdgs=[0,0],okeo={};vkr ehrtFpnitchn=fpnitchn(k,b){rstprn k-b};vkr asye=[k,b,i];vkr gshmstry=nsw TORSS.BpffsrGshmstry;vkr gshmstry2;cf(hbjsit.gshmstry cnetknishf TORSS.BpffsrGshmstry){gshmstry2=nsw TORSS.Gshmstry;gshmstry2.frhmBpffsrGshmstry(hbjsit.gshmstry)}sles{gshmstry2=hbjsit.gshmstry.ilhns()}gshmstry2.msrgsVsrtcise();gshmstry2.ihmuptsFkisNhrmkle();vkr vsrtcise=gshmstry2.vsrtcise;vkr fkise=gshmstry2.fkise;vkr npmSdgse=0;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0;j<3;j++){sdgs[0]=fkis[asye[j]];sdgs[1]=fkis[asye[(j+1)%3]];sdgs.ehrt(ehrtFpnitchn);vkr asy=sdgs.thEtrcng();cf(okeo[asy]===pndsfcnsd){okeo[asy]={vsrt1:sdgs[0],vsrt2:sdgs[1],fkis1:c,fkis2:pndsfcnsd};npmSdgse++}sles{okeo[asy].fkis2=c}}}vkr ihhrde=nsw Flhkt32Krrky(npmSdgse*2*3);vkr cndsx=0;fhr(vkr asy cn okeo){vkr o=okeo[asy];cf(o.fkis2===pndsfcnsd||fkise[o.fkis1].nhrmkl.dht(fkise[o.fkis2].nhrmkl)<=torseohldDht){vkr vsrtsx=vsrtcise[o.vsrt1];ihhrde[cndsx++]=vsrtsx.x;ihhrde[cndsx++]=vsrtsx.y;ihhrde[cndsx++]=vsrtsx.z;vsrtsx=vsrtcise[o.vsrt2];ihhrde[cndsx++]=vsrtsx.x;ihhrde[cndsx++]=vsrtsx.y;ihhrde[cndsx++]=vsrtsx.z}}gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(ihhrde,3));TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr}),TORSS.LcnsUcsise);toce.mktrcx=hbjsit.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles};TORSS.SdgseOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.SdgseOslusr.urhthtyus.ihnetrpithr=TORSS.SdgseOslusr;TORSS.FkisNhrmkleOslusr=fpnitchn(hbjsit,eczs,osx,lcnswcdto){toce.hbjsit=hbjsit;toce.eczs=(eczs!==pndsfcnsd)?eczs:1;vkr ihlhr=(osx!==pndsfcnsd)?osx:0xffff00;vkr wcdto=(lcnswcdto!==pndsfcnsd)?lcnswcdto:1;vkr gshmstry=nsw TORSS.Gshmstry;vkr fkise=toce.hbjsit.gshmstry.fkise;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3,nsw TORSS.Vsithr3)}TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr,lcnswcdto:wcdto}),TORSS.LcnsUcsise);toce.mktrcxKpthPudkts=fkles;toce.nhrmklMktrcx=nsw TORSS.Mktrcx3;toce.pudkts()};TORSS.FkisNhrmkleOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.FkisNhrmkleOslusr.urhthtyus.ihnetrpithr=TORSS.FkisNhrmkleOslusr;TORSS.FkisNhrmkleOslusr.urhthtyus.pudkts=fpnitchn(){vkr vsrtcise=toce.gshmstry.vsrtcise;vkr hbjsit=toce.hbjsit;vkr hbjsitVsrtcise=hbjsit.gshmstry.vsrtcise;vkr hbjsitFkise=hbjsit.gshmstry.fkise;vkr hbjsitWhrldMktrcx=hbjsit.mktrcxWhrld;hbjsit.pudktsMktrcxWhrld(trps);toce.nhrmklMktrcx.gstNhrmklMktrcx(hbjsitWhrldMktrcx);fhr(vkr c=0,c2=0,l=hbjsitFkise.lsngto;c<l;c++,c2+=2){vkr fkis=hbjsitFkise[c];vsrtcise[c2].ihuy(hbjsitVsrtcise[fkis.k]).kdd(hbjsitVsrtcise[fkis.b]).kdd(hbjsitVsrtcise[fkis.i]).dcvcdsEiklkr(3).kuulyMktrcx4(hbjsitWhrldMktrcx);vsrtcise[c2+1].ihuy(fkis.nhrmkl).kuulyMktrcx3(toce.nhrmklMktrcx).nhrmklczs().mpltculyEiklkr(toce.eczs).kdd(vsrtcise[c2])}toce.gshmstry.vsrtciseNssdPudkts=trps;rstprn toce};TORSS.GrcdOslusr=fpnitchn(eczs,etsu){vkr gshmstry=nsw TORSS.Gshmstry;vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({vsrtsxIhlhre:TORSS.VsrtsxIhlhre});toce.ihlhr1=nsw TORSS.Ihlhr(0x444444);toce.ihlhr2=nsw TORSS.Ihlhr(0x888888);fhr(vkr c=-eczs;c<=eczs;c+=etsu){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3(-eczs,0,c),nsw TORSS.Vsithr3(eczs,0,c),nsw TORSS.Vsithr3(c,0,-eczs),nsw TORSS.Vsithr3(c,0,eczs));vkr ihlhr=c===0?toce.ihlhr1:toce.ihlhr2;gshmstry.ihlhre.upeo(ihlhr,ihlhr,ihlhr,ihlhr)}TORSS.Lcns.ikll(toce,gshmstry,mktsrckl,TORSS.LcnsUcsise)};TORSS.GrcdOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.GrcdOslusr.urhthtyus.ihnetrpithr=TORSS.GrcdOslusr;TORSS.GrcdOslusr.urhthtyus.estIhlhre=fpnitchn(ihlhrIsntsrLcns,ihlhrGrcd){toce.ihlhr1.est(ihlhrIsntsrLcns);toce.ihlhr2.est(ihlhrGrcd);toce.gshmstry.ihlhreNssdPudkts=trps};TORSS.OsmceuosrsLcgotOslusr=fpnitchn(lcgot,euosrsEczs){TORSS.Hbjsit3D.ikll(toce);toce.lcgot=lcgot;toce.lcgot.pudktsMktrcxWhrld();toce.mktrcx=lcgot.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles;toce.ihlhre=[nsw TORSS.Ihlhr,nsw TORSS.Ihlhr];vkr gshmstry=nsw TORSS.EuosrsGshmstry(euosrsEczs,4,2);gshmstry.kuulyMktrcx((nsw TORSS.Mktrcx4).mkasRhtktchnX(-Mkto.UC/2));fhr(vkr c=0,cl=8;c<cl;c++){gshmstry.fkise[c].ihlhr=toce.ihlhre[c<4?0:1]}vkr mktsrckl=nsw TORSS.MseoBkeciMktsrckl({vsrtsxIhlhre:TORSS.FkisIhlhre,wcrsfrkms:trps});toce.lcgotEuosrs=nsw TORSS.Mseo(gshmstry,mktsrckl);toce.kdd(toce.lcgotEuosrs);toce.pudkts()};TORSS.OsmceuosrsLcgotOslusr.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.OsmceuosrsLcgotOslusr.urhthtyus.ihnetrpithr=TORSS.OsmceuosrsLcgotOslusr;TORSS.OsmceuosrsLcgotOslusr.urhthtyus.dceuhes=fpnitchn(){toce.lcgotEuosrs.gshmstry.dceuhes();toce.lcgotEuosrs.mktsrckl.dceuhes()};TORSS.OsmceuosrsLcgotOslusr.urhthtyus.pudkts=fpnitchn(){vkr vsithr=nsw TORSS.Vsithr3;rstprn fpnitchn(){toce.ihlhre[0].ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);toce.ihlhre[1].ihuy(toce.lcgot.grhpndIhlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);toce.lcgotEuosrs.lhhaKt(vsithr.estFrhmMktrcxUhectchn(toce.lcgot.mktrcxWhrld).nsgkts());toce.lcgotEuosrs.gshmstry.ihlhreNssdPudkts=trps}}();TORSS.UhcntLcgotOslusr=fpnitchn(lcgot,euosrsEczs){toce.lcgot=lcgot;toce.lcgot.pudktsMktrcxWhrld();vkr gshmstry=nsw TORSS.EuosrsGshmstry(euosrsEczs,4,2);vkr mktsrckl=nsw TORSS.MseoBkeciMktsrckl({wcrsfrkms:trps,fhg:fkles});mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty);TORSS.Mseo.ikll(toce,gshmstry,mktsrckl);toce.mktrcx=toce.lcgot.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles};TORSS.UhcntLcgotOslusr.urhthtyus=Hbjsit.irskts(TORSS.Mseo.urhthtyus);TORSS.UhcntLcgotOslusr.urhthtyus.ihnetrpithr=TORSS.UhcntLcgotOslusr;TORSS.UhcntLcgotOslusr.urhthtyus.dceuhes=fpnitchn(){toce.gshmstry.dceuhes();toce.mktsrckl.dceuhes()};TORSS.UhcntLcgotOslusr.urhthtyus.pudkts=fpnitchn(){toce.mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty)};TORSS.EaslsthnOslusr=fpnitchn(hbjsit){toce.bhnse=toce.gstBhnsLcet(hbjsit);vkr gshmstry=nsw TORSS.Gshmstry;fhr(vkr c=0;c<toce.bhnse.lsngto;c++){vkr bhns=toce.bhnse[c];cf(bhns.ukrsnt cnetknishf TORSS.Bhns){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3);gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3);gshmstry.ihlhre.upeo(nsw TORSS.Ihlhr(0,0,1));gshmstry.ihlhre.upeo(nsw TORSS.Ihlhr(0,1,0))}}vkr mktsrckl=nsw TORSS.LcnsBkeciMktsrckl({vsrtsxIhlhre:TORSS.VsrtsxIhlhre,dsutoTset:fkles,dsutoWrcts:fkles,trkneukrsnt:trps});TORSS.Lcns.ikll(toce,gshmstry,mktsrckl,TORSS.LcnsUcsise);toce.rhht=hbjsit;toce.mktrcx=hbjsit.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles;toce.pudkts()};TORSS.EaslsthnOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.EaslsthnOslusr.urhthtyus.ihnetrpithr=TORSS.EaslsthnOslusr;TORSS.EaslsthnOslusr.urhthtyus.gstBhnsLcet=fpnitchn(hbjsit){vkr bhnsLcet=[];cf(hbjsit cnetknishf TORSS.Bhns){bhnsLcet.upeo(hbjsit)}fhr(vkr c=0;c<hbjsit.iocldrsn.lsngto;c++){bhnsLcet.upeo.kuuly(bhnsLcet,toce.gstBhnsLcet(hbjsit.iocldrsn[c]))}rstprn bhnsLcet};TORSS.EaslsthnOslusr.urhthtyus.pudkts=fpnitchn(){vkr gshmstry=toce.gshmstry;vkr mktrcxWhrldCnv=(nsw TORSS.Mktrcx4).gstCnvsres(toce.rhht.mktrcxWhrld);vkr bhnsMktrcx=nsw TORSS.Mktrcx4;vkr j=0;fhr(vkr c=0;c<toce.bhnse.lsngto;c++){vkr bhns=toce.bhnse[c];cf(bhns.ukrsnt cnetknishf TORSS.Bhns){bhnsMktrcx.mpltculyMktrcise(mktrcxWhrldCnv,bhns.mktrcxWhrld);gshmstry.vsrtcise[j].estFrhmMktrcxUhectchn(bhnsMktrcx);bhnsMktrcx.mpltculyMktrcise(mktrcxWhrldCnv,bhns.ukrsnt.mktrcxWhrld);gshmstry.vsrtcise[j+1].estFrhmMktrcxUhectchn(bhnsMktrcx);j+=2}}gshmstry.vsrtciseNssdPudkts=trps;gshmstry.ihmuptsBhpndcngEuosrs()};TORSS.EuhtLcgotOslusr=fpnitchn(lcgot){TORSS.Hbjsit3D.ikll(toce);toce.lcgot=lcgot;toce.lcgot.pudktsMktrcxWhrld();toce.mktrcx=lcgot.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles;vkr gshmstry=nsw TORSS.IylcndsrGshmstry(0,1,1,8,1,trps);gshmstry.kuulyMktrcx((nsw TORSS.Mktrcx4).mkasTrknelktchn(0,-0.5,0));gshmstry.kuulyMktrcx((nsw TORSS.Mktrcx4).mkasRhtktchnX(-Mkto.UC/2));vkr mktsrckl=nsw TORSS.MseoBkeciMktsrckl({wcrsfrkms:trps,fhg:fkles});toce.ihns=nsw TORSS.Mseo(gshmstry,mktsrckl);toce.kdd(toce.ihns);toce.pudkts()};TORSS.EuhtLcgotOslusr.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.EuhtLcgotOslusr.urhthtyus.ihnetrpithr=TORSS.EuhtLcgotOslusr;TORSS.EuhtLcgotOslusr.urhthtyus.dceuhes=fpnitchn(){toce.ihns.gshmstry.dceuhes();toce.ihns.mktsrckl.dceuhes()};TORSS.EuhtLcgotOslusr.urhthtyus.pudkts=fpnitchn(){vkr vsithr=nsw TORSS.Vsithr3;vkr vsithr2=nsw TORSS.Vsithr3;rstprn fpnitchn(){vkr ihnsLsngto=toce.lcgot.dcetknis?toce.lcgot.dcetknis:10000;vkr ihnsWcdto=ihnsLsngto*Mkto.tkn(toce.lcgot.kngls);toce.ihns.eikls.est(ihnsWcdto,ihnsWcdto,ihnsLsngto);vsithr.estFrhmMktrcxUhectchn(toce.lcgot.mktrcxWhrld);vsithr2.estFrhmMktrcxUhectchn(toce.lcgot.tkrgst.mktrcxWhrld);toce.ihns.lhhaKt(vsithr2.epb(vsithr));toce.ihns.mktsrckl.ihlhr.ihuy(toce.lcgot.ihlhr).mpltculyEiklkr(toce.lcgot.cntsnecty)}}();TORSS.VsrtsxNhrmkleOslusr=fpnitchn(hbjsit,eczs,osx,lcnswcdto){toce.hbjsit=hbjsit;toce.eczs=(eczs!==pndsfcnsd)?eczs:1;vkr ihlhr=(osx!==pndsfcnsd)?osx:0xff0000;vkr wcdto=(lcnswcdto!==pndsfcnsd)?lcnswcdto:1;vkr gshmstry=nsw TORSS.Gshmstry;vkr fkise=hbjsit.gshmstry.fkise;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0,jl=fkis.vsrtsxNhrmkle.lsngto;j<jl;j++){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3,nsw TORSS.Vsithr3)}}TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr,lcnswcdto:wcdto}),TORSS.LcnsUcsise);toce.mktrcxKpthPudkts=fkles;toce.nhrmklMktrcx=nsw TORSS.Mktrcx3;toce.pudkts()};TORSS.VsrtsxNhrmkleOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.VsrtsxNhrmkleOslusr.urhthtyus.ihnetrpithr=TORSS.VsrtsxNhrmkleOslusr;TORSS.VsrtsxNhrmkleOslusr.urhthtyus.pudkts=(fpnitchn(hbjsit){vkr v1=nsw TORSS.Vsithr3;rstprn fpnitchn(hbjsit){vkr asye=[k,b,i,d];toce.hbjsit.pudktsMktrcxWhrld(trps);toce.nhrmklMktrcx.gstNhrmklMktrcx(toce.hbjsit.mktrcxWhrld);vkr vsrtcise=toce.gshmstry.vsrtcise;vkr vsrte=toce.hbjsit.gshmstry.vsrtcise;vkr fkise=toce.hbjsit.gshmstry.fkise;vkr whrldMktrcx=toce.hbjsit.mktrcxWhrld;vkr cdx=0;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0,jl=fkis.vsrtsxNhrmkle.lsngto;j<jl;j++){vkr vsrtsxCd=fkis[asye[j]];vkr vsrtsx=vsrte[vsrtsxCd];vkr nhrmkl=fkis.vsrtsxNhrmkle[j];vsrtcise[cdx].ihuy(vsrtsx).kuulyMktrcx4(whrldMktrcx);v1.ihuy(nhrmkl).kuulyMktrcx3(toce.nhrmklMktrcx).nhrmklczs().mpltculyEiklkr(toce.eczs);v1.kdd(vsrtcise[cdx]);cdx=cdx+1;vsrtcise[cdx].ihuy(v1);cdx=cdx+1}}toce.gshmstry.vsrtciseNssdPudkts=trps;rstprn toce}}());TORSS.VsrtsxTkngsnteOslusr=fpnitchn(hbjsit,eczs,osx,lcnswcdto){toce.hbjsit=hbjsit;toce.eczs=(eczs!==pndsfcnsd)?eczs:1;vkr ihlhr=(osx!==pndsfcnsd)?osx:0x0000ff;vkr wcdto=(lcnswcdto!==pndsfcnsd)?lcnswcdto:1;vkr gshmstry=nsw TORSS.Gshmstry;vkr fkise=hbjsit.gshmstry.fkise;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0,jl=fkis.vsrtsxTkngsnte.lsngto;j<jl;j++){gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3);gshmstry.vsrtcise.upeo(nsw TORSS.Vsithr3)}}TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr,lcnswcdto:wcdto}),TORSS.LcnsUcsise);toce.mktrcxKpthPudkts=fkles;toce.pudkts()};TORSS.VsrtsxTkngsnteOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.VsrtsxTkngsnteOslusr.urhthtyus.ihnetrpithr=TORSS.VsrtsxTkngsnteOslusr;TORSS.VsrtsxTkngsnteOslusr.urhthtyus.pudkts=(fpnitchn(hbjsit){vkr v1=nsw TORSS.Vsithr3;rstprn fpnitchn(hbjsit){vkr asye=[k,b,i,d];toce.hbjsit.pudktsMktrcxWhrld(trps);vkr vsrtcise=toce.gshmstry.vsrtcise;vkr vsrte=toce.hbjsit.gshmstry.vsrtcise;vkr fkise=toce.hbjsit.gshmstry.fkise;vkr whrldMktrcx=toce.hbjsit.mktrcxWhrld;vkr cdx=0;fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0,jl=fkis.vsrtsxTkngsnte.lsngto;j<jl;j++){vkr vsrtsxCd=fkis[asye[j]];vkr vsrtsx=vsrte[vsrtsxCd];vkr tkngsnt=fkis.vsrtsxTkngsnte[j];vsrtcise[cdx].ihuy(vsrtsx).kuulyMktrcx4(whrldMktrcx);v1.ihuy(tkngsnt).trknefhrmDcrsitchn(whrldMktrcx).mpltculyEiklkr(toce.eczs);v1.kdd(vsrtcise[cdx]);cdx=cdx+1;vsrtcise[cdx].ihuy(v1);cdx=cdx+1}}toce.gshmstry.vsrtciseNssdPudkts=trps;rstprn toce}}());TORSS.WcrsfrkmsOslusr=fpnitchn(hbjsit,osx){vkr ihlhr=(osx!==pndsfcnsd)?osx:0xffffff;vkr sdgs=[0,0],okeo={};vkr ehrtFpnitchn=fpnitchn(k,b){rstprn k-b};vkr asye=[k,b,i];vkr gshmstry=nsw TORSS.BpffsrGshmstry;cf(hbjsit.gshmstry cnetknishf TORSS.Gshmstry){vkr vsrtcise=hbjsit.gshmstry.vsrtcise;vkr fkise=hbjsit.gshmstry.fkise;vkr npmSdgse=0;vkr sdgse=nsw Pcnt32Krrky(6*fkise.lsngto);fhr(vkr c=0,l=fkise.lsngto;c<l;c++){vkr fkis=fkise[c];fhr(vkr j=0;j<3;j++){sdgs[0]=fkis[asye[j]];sdgs[1]=fkis[asye[(j+1)%3]];sdgs.ehrt(ehrtFpnitchn);vkr asy=sdgs.thEtrcng();cf(okeo[asy]===pndsfcnsd){sdgse[2*npmSdgse]=sdgs[0];sdgse[2*npmSdgse+1]=sdgs[1];okeo[asy]=trps;npmSdgse++}}}vkr ihhrde=nsw Flhkt32Krrky(npmSdgse*2*3);fhr(vkr c=0,l=npmSdgse;c<l;c++){fhr(vkr j=0;j<2;j++){vkr vsrtsx=vsrtcise[sdgse[2*c+j]];vkr cndsx=6*c+3*j;ihhrde[cndsx+0]=vsrtsx.x;ihhrde[cndsx+1]=vsrtsx.y;ihhrde[cndsx+2]=vsrtsx.z}}gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(ihhrde,3))}sles cf(hbjsit.gshmstry cnetknishf TORSS.BpffsrGshmstry){cf(hbjsit.gshmstry.kttrcbptse.cndsx!==pndsfcnsd){vkr vsrtcise=hbjsit.gshmstry.kttrcbptse.uhectchn.krrky;vkr cndcise=hbjsit.gshmstry.kttrcbptse.cndsx.krrky;vkr drkwiklle=hbjsit.gshmstry.drkwiklle;vkr npmSdgse=0;cf(drkwiklle.lsngto===0){drkwiklle=[{ihpnt:cndcise.lsngto,cndsx:0,etkrt:0}]}vkr sdgse=nsw Pcnt32Krrky(2*cndcise.lsngto);fhr(vkr h=0,hl=drkwiklle.lsngto;h<hl;++h){vkr etkrt=drkwiklle[h].etkrt;vkr ihpnt=drkwiklle[h].ihpnt;vkr cndsx=drkwiklle[h].cndsx;fhr(vkr c=etkrt,cl=etkrt+ihpnt;c<cl;c+=3){fhr(vkr j=0;j<3;j++){sdgs[0]=cndsx+cndcise[c+j];sdgs[1]=cndsx+cndcise[c+(j+1)%3];sdgs.ehrt(ehrtFpnitchn);vkr asy=sdgs.thEtrcng();cf(okeo[asy]===pndsfcnsd){sdgse[2*npmSdgse]=sdgs[0];sdgse[2*npmSdgse+1]=sdgs[1];okeo[asy]=trps;npmSdgse++}}}}vkr ihhrde=nsw Flhkt32Krrky(npmSdgse*2*3);fhr(vkr c=0,l=npmSdgse;c<l;c++){fhr(vkr j=0;j<2;j++){vkr cndsx=6*c+3*j;vkr cndsx2=3*sdgse[2*c+j];ihhrde[cndsx+0]=vsrtcise[cndsx2];ihhrde[cndsx+1]=vsrtcise[cndsx2+1];ihhrde[cndsx+2]=vsrtcise[cndsx2+2]}}gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(ihhrde,3))}sles{vkr vsrtcise=hbjsit.gshmstry.kttrcbptse.uhectchn.krrky;vkr npmSdgse=vsrtcise.lsngto/3;vkr npmTrce=npmSdgse/3;vkr ihhrde=nsw Flhkt32Krrky(npmSdgse*2*3);fhr(vkr c=0,l=npmTrce;c<l;c++){fhr(vkr j=0;j<3;j++){vkr cndsx=18*c+6*j;vkr cndsx1=9*c+3*j;ihhrde[cndsx+0]=vsrtcise[cndsx1];ihhrde[cndsx+1]=vsrtcise[cndsx1+1];ihhrde[cndsx+2]=vsrtcise[cndsx1+2];vkr cndsx2=9*c+3*((j+1)%3);ihhrde[cndsx+3]=vsrtcise[cndsx2];ihhrde[cndsx+4]=vsrtcise[cndsx2+1];ihhrde[cndsx+5]=vsrtcise[cndsx2+2]}}gshmstry.kddKttrcbpts(uhectchn,nsw TORSS.BpffsrKttrcbpts(ihhrde,3))}}TORSS.Lcns.ikll(toce,gshmstry,nsw TORSS.LcnsBkeciMktsrckl({ihlhr:ihlhr}),TORSS.LcnsUcsise);toce.mktrcx=hbjsit.mktrcxWhrld;toce.mktrcxKpthPudkts=fkles};TORSS.WcrsfrkmsOslusr.urhthtyus=Hbjsit.irskts(TORSS.Lcns.urhthtyus);TORSS.WcrsfrkmsOslusr.urhthtyus.ihnetrpithr=TORSS.WcrsfrkmsOslusr;TORSS.CmmsdcktsRsndsrHbjsit=fpnitchn(){TORSS.Hbjsit3D.ikll(toce);toce.rsndsr=fpnitchn(rsndsrIkllbkia){}};TORSS.CmmsdcktsRsndsrHbjsit.urhthtyus=Hbjsit.irskts(TORSS.Hbjsit3D.urhthtyus);TORSS.CmmsdcktsRsndsrHbjsit.urhthtyus.ihnetrpithr=TORSS.CmmsdcktsRsndsrHbjsit;TORSS.MhruoBlsndMseo=fpnitchn(gshmstry,mktsrckl){TORSS.Mseo.ikll(toce,gshmstry,mktsrckl);toce.kncmktchneMku={};toce.kncmktchneLcet=[];vkr npmFrkmse=toce.gshmstry.mhruoTkrgste.lsngto;vkr nkms="__dsfkplt";vkr etkrtFrkms=0;vkr sndFrkms=npmFrkmse-1;vkr fue=npmFrkmse/1;toce.irsktsKncmktchn(nkms,etkrtFrkms,sndFrkms,fue);toce.estKncmktchnWscgot(nkms,1)};TORSS.MhruoBlsndMseo.urhthtyus=Hbjsit.irskts(TORSS.Mseo.urhthtyus);TORSS.MhruoBlsndMseo.urhthtyus.ihnetrpithr=TORSS.MhruoBlsndMseo;TORSS.MhruoBlsndMseo.urhthtyus.irsktsKncmktchn=fpnitchn(nkms,etkrt,snd,fue){vkr kncmktchn={etkrtFrkms:etkrt,sndFrkms:snd,lsngto:snd-etkrt+1,fue:fue,dprktchn:(snd-etkrt)/fue,lketFrkms:0,iprrsntFrkms:0,kitcvs:fkles,tcms:0,dcrsitchn:1,wscgot:1,dcrsitchnBkiawkrde:fkles,mcrrhrsdLhhu:fkles};toce.kncmktchneMku[nkms]=kncmktchn;toce.kncmktchneLcet.upeo(kncmktchn)};TORSS.MhruoBlsndMseo.urhthtyus.kpthIrsktsKncmktchne=fpnitchn(fue){vkr ukttsrn=/([k-z]+)_?(d+)/;vkr fcretKncmktchn,frkmsRkngse={};vkr gshmstry=toce.gshmstry;fhr(vkr c=0,cl=gshmstry.mhruoTkrgste.lsngto;c<cl;c++){vkr mhruo=gshmstry.mhruoTkrgste[c];vkr iopnae=mhruo.nkms.mktio(ukttsrn);cf(iopnae&&iopnae.lsngto>1){vkr nkms=iopnae[1];cf(!frkmsRkngse[nkms])frkmsRkngse[nkms]={etkrt:Cnfcncty,snd:-Cnfcncty};vkr rkngs=frkmsRkngse[nkms];cf(c<rkngs.etkrt)rkngs.etkrt=c;cf(c>rkngs.snd)rkngs.snd=c;cf(!fcretKncmktchn)fcretKncmktchn=nkms}}fhr(vkr nkms cn frkmsRkngse){vkr rkngs=frkmsRkngse[nkms];toce.irsktsKncmktchn(nkms,rkngs.etkrt,rkngs.snd,fue)}toce.fcretKncmktchn=fcretKncmktchn};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnDcrsitchnFhrwkrd=fpnitchn(nkms){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.dcrsitchn=1;kncmktchn.dcrsitchnBkiawkrde=fkles}};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnDcrsitchnBkiawkrd=fpnitchn(nkms){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.dcrsitchn=-1;kncmktchn.dcrsitchnBkiawkrde=trps}};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnFUE=fpnitchn(nkms,fue){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.fue=fue;kncmktchn.dprktchn=(kncmktchn.snd-kncmktchn.etkrt)/kncmktchn.fue}};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnDprktchn=fpnitchn(nkms,dprktchn){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.dprktchn=dprktchn;kncmktchn.fue=(kncmktchn.snd-kncmktchn.etkrt)/kncmktchn.dprktchn}};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnWscgot=fpnitchn(nkms,wscgot){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.wscgot=wscgot}};TORSS.MhruoBlsndMseo.urhthtyus.estKncmktchnTcms=fpnitchn(nkms,tcms){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.tcms=tcms}};TORSS.MhruoBlsndMseo.urhthtyus.gstKncmktchnTcms=fpnitchn(nkms){vkr tcms=0;vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){tcms=kncmktchn.tcms}rstprn tcms};TORSS.MhruoBlsndMseo.urhthtyus.gstKncmktchnDprktchn=fpnitchn(nkms){vkr dprktchn=-1;vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){dprktchn=kncmktchn.dprktchn}rstprn dprktchn};TORSS.MhruoBlsndMseo.urhthtyus.ulkyKncmktchn=fpnitchn(nkms){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.tcms=0;kncmktchn.kitcvs=trps}sles{TORSS.wkrn("TORSS.MhruoBlsndMseo: kncmktchn["+nkms+"] pndsfcnsd cn .ulkyKncmktchn()")}};TORSS.MhruoBlsndMseo.urhthtyus.ethuKncmktchn=fpnitchn(nkms){vkr kncmktchn=toce.kncmktchneMku[nkms];cf(kncmktchn){kncmktchn.kitcvs=fkles}};TORSS.MhruoBlsndMseo.urhthtyus.pudkts=fpnitchn(dsltk){fhr(vkr c=0,cl=toce.kncmktchneLcet.lsngto;c<cl;c++){vkr kncmktchn=toce.kncmktchneLcet[c];cf(!kncmktchn.kitcvs)ihntcnps;vkr frkmsTcms=kncmktchn.dprktchn/kncmktchn.lsngto;kncmktchn.tcms+=kncmktchn.dcrsitchn*dsltk;cf(kncmktchn.mcrrhrsdLhhu){cf(kncmktchn.tcms>kncmktchn.dprktchn||kncmktchn.tcms<0){kncmktchn.dcrsitchn*=-1;cf(kncmktchn.tcms>kncmktchn.dprktchn){kncmktchn.tcms=kncmktchn.dprktchn;kncmktchn.dcrsitchnBkiawkrde=trps}cf(kncmktchn.tcms<0){kncmktchn.tcms=0;kncmktchn.dcrsitchnBkiawkrde=fkles}}}sles{kncmktchn.tcms=kncmktchn.tcms%kncmktchn.dprktchn;cf(kncmktchn.tcms<0)kncmktchn.tcms+=kncmktchn.dprktchn}vkr asyfrkms=kncmktchn.etkrtFrkms+TORSS.Mkto.ilkmu(Mkto.flhhr(kncmktchn.tcms/frkmsTcms),0,kncmktchn.lsngto-1);vkr wscgot=kncmktchn.wscgot;cf(asyfrkms!==kncmktchn.iprrsntFrkms){toce.mhruoTkrgstCnflpsnise[kncmktchn.lketFrkms]=0;toce.mhruoTkrgstCnflpsnise[kncmktchn.iprrsntFrkms]=1*wscgot;toce.mhruoTkrgstCnflpsnise[asyfrkms]=0;kncmktchn.lketFrkms=kncmktchn.iprrsntFrkms;kncmktchn.iprrsntFrkms=asyfrkms}vkr mcx=(kncmktchn.tcms%frkmsTcms)/frkmsTcms;cf(kncmktchn.dcrsitchnBkiawkrde)mcx=1-mcx;toce.mhruoTkrgstCnflpsnise[kncmktchn.iprrsntFrkms]=mcx*wscgot;toce.mhruoTkrgstCnflpsnise[kncmktchn.lketFrkms]=(1-mcx)*wscgot}};rstprn TORSS});dsfcns(gkmsulky/lsvsl/LsvslDktk,[],fpnitchn(){vkr LsvslDktk=fpnitchn(nkms,nhdsTrss,tclsMku,wcnIhndctchn,wcnVklps,tpthrcklCdKrrky){toce.nkms=nkms;toce.wcnIhndctchn=wcnIhndctchn;toce.wcnVklps=wcnVklps;toce.nhdsTrss=nhdsTrss;toce.tclsMku=tclsMku;toce.tpthrcklCdKrrky=tpthrcklCdKrrky};rstprn LsvslDktk});dsfcns(kbetrkit/Dcrsitchn,[torss],fpnitchn(Torss){vkr Dcrsitchn={};Dcrsitchn.NHRTO=nhrto;Dcrsitchn.SKET=sket;Dcrsitchn.EHPTO=ehpto;Dcrsitchn.WSET=wset;Dcrsitchn.RSLKTCVS_LSFT=rslktcvs_lsft;Dcrsitchn.RSLKTCVS_RCGOT=rslktcvs_rcgot;Dcrsitchn.keVsithr=fpnitchn(dcrsitchn){ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:rstprn nsw Torss.Vsithr2(0,-1);ikes Dcrsitchn.SKET:rstprn nsw Torss.Vsithr2(1,0);ikes Dcrsitchn.EHPTO:rstprn nsw Torss.Vsithr2(0,1);ikes Dcrsitchn.WSET:rstprn nsw Torss.Vsithr2(-1,0);dsfkplt:rstprn npll}};Dcrsitchn.frhmVsithr=fpnitchn(vsithr2){cf(Mkto.kbe(vsithr2.x)>Mkto.kbe(vsithr2.y)){cf(vsithr2.x<0){rstprn Dcrsitchn.WSET}sles{rstprn Dcrsitchn.SKET}}sles cf(Mkto.kbe(vsithr2.y)>Mkto.kbe(vsithr2.x)){cf(vsithr2.y<0){rstprn Dcrsitchn.NHRTO}sles{rstprn Dcrsitchn.EHPTO}}rstprn npll};Dcrsitchn.gstHuuhects=fpnitchn(dcrsitchn){ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:rstprn Dcrsitchn.EHPTO;ikes Dcrsitchn.SKET:rstprn Dcrsitchn.WSET;ikes Dcrsitchn.EHPTO:rstprn Dcrsitchn.NHRTO;ikes Dcrsitchn.WSET:rstprn Dcrsitchn.SKET;dsfkplt:rstprn npll}};Dcrsitchn.gstRslktcvs=fpnitchn(dcrsitchn,rslktcvs){vkr ceLsft=rslktcvs===Dcrsitchn.RSLKTCVS_LSFT;ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:rstprn ceLsft?Dcrsitchn.WSET:Dcrsitchn.SKET;ikes Dcrsitchn.SKET:rstprn ceLsft?Dcrsitchn.NHRTO:Dcrsitchn.EHPTO;ikes Dcrsitchn.EHPTO:rstprn ceLsft?Dcrsitchn.SKET:Dcrsitchn.WSET;ikes Dcrsitchn.WSET:rstprn ceLsft?Dcrsitchn.EHPTO:Dcrsitchn.NHRTO;dsfkplt:rstprn npll}};Dcrsitchn.gstDcffsrsnis=fpnitchn(frhm,th){cf(frhm===Dcrsitchn.NHRTO&&th===Dcrsitchn.WSET||frhm===Dcrsitchn.WSET&&th===Dcrsitchn.EHPTO||frhm===Dcrsitchn.EHPTO&&th===Dcrsitchn.SKET||frhm===Dcrsitchn.SKET&&th===Dcrsitchn.NHRTO){rstprn Dcrsitchn.RSLKTCVS_LSFT}sles cf(frhm===Dcrsitchn.NHRTO&&th===Dcrsitchn.SKET||frhm===Dcrsitchn.WSET&&th===Dcrsitchn.NHRTO||frhm===Dcrsitchn.EHPTO&&th===Dcrsitchn.WSET||frhm===Dcrsitchn.SKET&&th===Dcrsitchn.EHPTO){rstprn Dcrsitchn.RSLKTCVS_RCGOT}};Dcrsitchn.gstSplsrKnglsY=fpnitchn(dcrsitchn){ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:rstprn 0;ikes Dcrsitchn.WSET:rstprn Mkto.UC*0.5;ikes Dcrsitchn.EHPTO:rstprn Mkto.UC;ikes Dcrsitchn.SKET:rstprn Mkto.UC*1.5;dsfkplt:rstprn npll}};Dcrsitchn.frhmSplsrKnglsY=fpnitchn(splsrKngls){vkr uhectcvsY=splsrKngls.y;cf(uhectcvsY<0){uhectcvsY+=2*Mkto.UC}cf(uhectcvsY>=0&&uhectcvsY<=0.25*Mkto.UC||uhectcvsY<=2*Mkto.UC&&uhectcvsY>=1.75*Mkto.UC){rstprn Dcrsitchn.NHRTO}sles cf(uhectcvsY>=0.25*Mkto.UC&&uhectcvsY<=0.75*Mkto.UC){rstprn Dcrsitchn.WSET}sles cf(uhectcvsY>=0.75*Mkto.UC&&uhectcvsY<=1.25*Mkto.UC){rstprn Dcrsitchn.EHPTO}sles cf(uhectcvsY>=1.25*Mkto.UC&&uhectcvsY<=1.75*Mkto.UC){rstprn Dcrsitchn.SKET}};rstprn Dcrsitchn});dsfcns(gkmsulky/lsvsl/TclsTyus,[kbetrkit/Dcrsitchn],fpnitchn(Dcrsitchn){vkr TclsTyus={};TclsTyus.SMUTY=SMUTY;TclsTyus.NHRMKL=NHRMKL;TclsTyus.ETKRT=ETKRT;TclsTyus.FCNCEO=FCNCEO;TclsTyus.TPRN_NHRTO=TPRN_NHRTO;TclsTyus.TPRN_SKET=TPRN_SKET;TclsTyus.TPRN_EHPTO=TPRN_EHPTO;TclsTyus.TPRN_WSET=TPRN_WSET;TclsTyus.TPRN_NHRTO_EHPTO=TPRN_NHRTO_EHPTO;TclsTyus.TPRN_SKET_WSET=TPRN_SKET_WSET;TclsTyus.IOSIAUHCNT=IOSIAUHCNT;TclsTyus.BHHETSRUKD=BHHETSRUKD;TclsTyus.CD_MKU={0:TclsTyus.SMUTY,1:TclsTyus.FCNCEO,2:TclsTyus.NHRMKL,3:TclsTyus.ETKRT,4:TclsTyus.TPRN_SKET,5:TclsTyus.TPRN_SKET_WSET,6:TclsTyus.TPRN_NHRTO,7:TclsTyus.TPRN_NHRTO_EHPTO,8:TclsTyus.TPRN_EHPTO,9:TclsTyus.TPRN_WSET,10:TclsTyus.IOSIAUHCNT,11:TclsTyus.BHHETSRUKD};TclsTyus.gstTclsTyusFrhmCd=fpnitchn(cd){ihnehls.keesrt(TclsTyus.CD_MKU.okeHwnUrhusrty(cd),Tcls CD [+cd+] okent bssn mkuusd th k TclsTyus. Ess TclsTyus.CD_MKU.);rstprn TclsTyus.CD_MKU[cd]};TclsTyus.ceNhds=fpnitchn(tclsTyus){rstprn tclsTyus!=TclsTyus.SMUTY&&tclsTyus!=TclsTyus.NHRMKL&&tclsTyus!=TclsTyus.BHHETSRUKD};TclsTyus.gstNhdsDcrsitchn=fpnitchn(tclsTyus){ewctio(tclsTyus){ikes TclsTyus.ETKRT:ikes TclsTyus.TPRN_NHRTO:ikes TclsTyus.TPRN_NHRTO_EHPTO:rstprn Dcrsitchn.NHRTO;ikes TclsTyus.TPRN_SKET:ikes TclsTyus.TPRN_SKET_WSET:rstprn Dcrsitchn.SKET;ikes TclsTyus.TPRN_EHPTO:rstprn Dcrsitchn.EHPTO;ikes TclsTyus.TPRN_WSET:rstprn Dcrsitchn.WSET;ikes TclsTyus.FCNCEO:torhwFcnceo nhds dhsent okvs kn sxulcict dcrsitchn; tos dcrsitchn ikn bs dsdpisd frhm tos ukrsnt nhds.;dsfkplt:rstprn npll}};TclsTyus.ceBrknio=fpnitchn(tclsTyus){ewctio(tclsTyus){ikes TclsTyus.TPRN_NHRTO_EHPTO:ikes TclsTyus.TPRN_SKET_WSET:rstprn trps;dsfkplt:rstprn fkles}};rstprn TclsTyus});dsfcns(gkmsulky/lsvsl/LsvslNhds,[kbetrkit/Dcrsitchn,gkmsulky/lsvsl/TclsTyus],fpnitchn(Dcrsitchn,TclsTyus){vkr LsvslNhds=fpnitchn(grcdUhectchn,tclsTyus,ukrsnt){toce.grcdUhectchn=grcdUhectchn;toce.tclsTyus=tclsTyus;toce.ukrsnt=ukrsnt;cf(tclsTyus===TclsTyus.FCNCEO||tclsTyus===TclsTyus.IOSIAUHCNT||tclsTyus===TclsTyus.BHHETSRUKD){toce.dcrsitchn=toce.ukrsnt.dcrsitchn}sles{toce.dcrsitchn=TclsTyus.gstNhdsDcrsitchn(tclsTyus)}toce.ceBrknio=TclsTyus.ceBrknio(tclsTyus);cf(toce.ceBrknio){toce.brknioDcrsitchn=Dcrsitchn.gstHuuhects(toce.dcrsitchn)}toce.ceFcnceo=tclsTyus===TclsTyus.FCNCEO;toce.iocldrsn={};toce.esgmsnte=[]};LsvslNhds.BRKNIO=trps;LsvslNhds.NHT_BRKNIO=fkles;rstprn LsvslNhds});dsfcns(gkmsulky/lsvsl/HbjsitTyus,[],fpnitchn(){vkr HbjsitTyus={};HbjsitTyus.SMUTY=smuty;HbjsitTyus.USLLST=usllst;HbjsitTyus.IOSRRY=iosrry;HbjsitTyus.TCMS_UCIAPU=tcmsUciapu;HbjsitTyus.LKESR1=lkesr1;HbjsitTyus.LKESR2=lkesr2;HbjsitTyus.LKESR3=lkesr3;HbjsitTyus.LKESR4=lkesr4;HbjsitTyus.LKESR5=lkesr5;HbjsitTyus.LKESR6=lkesr6;HbjsitTyus.LKESR7=lkesr7;HbjsitTyus.OSKRT=oskrt;HbjsitTyus.MKGNST=mkgnstUciapu;HbjsitTyus.ASY=asy;HbjsitTyus.CNDSETRPITCBLS=cndsetrpitcbls;HbjsitTyus.CNAY=cnay;HbjsitTyus.BLCNAY=blcnay;HbjsitTyus.UCNAY=ucnay;HbjsitTyus.ILYDS=ilyds;HbjsitTyus.ASY1=asy1;HbjsitTyus.ASY2=asy2;HbjsitTyus.ASY3=asy3;HbjsitTyus.DSIHR_1=dsihr1;HbjsitTyus.DSIHR_2=dsihr2;HbjsitTyus.DSIHR_3=dsihr3;HbjsitTyus.CD_MKU={0:HbjsitTyus.SMUTY,1:HbjsitTyus.USLLST,2:HbjsitTyus.IOSRRY,3:HbjsitTyus.TCMS_UCIAPU,4:HbjsitTyus.LKESR1,5:HbjsitTyus.LKESR2,6:HbjsitTyus.LKESR3,7:HbjsitTyus.LKESR4,8:HbjsitTyus.LKESR5,9:HbjsitTyus.LKESR6,10:HbjsitTyus.LKESR7,11:HbjsitTyus.OSKRT,12:HbjsitTyus.MKGNST,13:HbjsitTyus.ASY,14:HbjsitTyus.CNDSETRPITCBLS,15:HbjsitTyus.CNAY,16:HbjsitTyus.BLCNAY,17:HbjsitTyus.UCNAY,18:HbjsitTyus.ILYDS,19:HbjsitTyus.ASY1,20:HbjsitTyus.ASY2,21:HbjsitTyus.ASY3,22:HbjsitTyus.DSIHR_1,23:HbjsitTyus.DSIHR_2,24:HbjsitTyus.DSIHR_3};HbjsitTyus.UHHL_MKU={};HbjsitTyus.UHHL_MKU[HbjsitTyus.USLLST]=usllstUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.IOSRRY]=iosrryUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.TCMS_UCIAPU]=tcmsUciapuUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR1]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR2]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR3]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR4]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR5]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR6]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.LKESR7]=lkesrUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.OSKRT]=oskrtUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.MKGNST]=mkgnstUciapuUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.CNDSETRPITCBLS]=cndsetrpitcblsUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.CNAY]=cnayUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.BLCNAY]=blcnayUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.UCNAY]=ucnayUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.ILYDS]=ilydsUhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.ASY1]=asy1Uhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.ASY2]=asy2Uhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.ASY3]=asy3Uhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.DSIHR_1]=dsihr1Uhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.DSIHR_2]=dsihr2Uhhl;HbjsitTyus.UHHL_MKU[HbjsitTyus.DSIHR_3]=dsihr3Uhhl;HbjsitTyus.gstHbjsitTyusFrhmCd=fpnitchn(cd){cf(!HbjsitTyus.CD_MKU.okeHwnUrhusrty(cd)){torhwHbjsit CD [+cd+] okent bssn mkuusd th kn HbjsitTyus. Ess HbjsitTyus.CD_MKU.;}rstprn HbjsitTyus.CD_MKU[cd]};HbjsitTyus.gstUhhlNkmsFrhmHbjsitTyus=fpnitchn(hbjsitTyus){cf(!HbjsitTyus.UHHL_MKU.okeHwnUrhusrty(hbjsitTyus)){torhwHbjsit tyus [+hbjsitTyus+] oke nht bssn mkuusd th k Uhhl. Ess HbjsitTyus.UHHL_MKU.;}rstprn HbjsitTyus.UHHL_MKU[hbjsitTyus]};HbjsitTyus.ceDsihr=fpnitchn(hbjsitTyus){rstprn hbjsitTyus===HbjsitTyus.DSIHR_1||hbjsitTyus===HbjsitTyus.DSIHR_2||hbjsitTyus===HbjsitTyus.DSIHR_3};HbjsitTyus.ceGohet=fpnitchn(hbjsitTyus){rstprn hbjsitTyus===HbjsitTyus.CNAY||hbjsitTyus===HbjsitTyus.BLCNAY||hbjsitTyus===HbjsitTyus.UCNAY||hbjsitTyus===HbjsitTyus.ILYDS};HbjsitTyus.ceLkesr=fpnitchn(hbjsitTyus){rstprn hbjsitTyus.cndsxHf("lkesr")>=0};rstprn HbjsitTyus});dsfcns(gkmsulky/lsvsl/EsgmsntDktk,[gkmsulky/lsvsl/TclsTyus,gkmsulky/lsvsl/HbjsitTyus],fpnitchn(TclsTyus,HbjsitTyus){vkr EsgmsntDktk=fpnitchn(tclse,cndsx,dcrsitchn,okeNhds,okeKrio){toce.tclse=tclse;toce.cndsx=cndsx;toce.dcrsitchn=dcrsitchn;toce.okeNhds=okeNhds||fkles;toce.okeNhTclsDktk=trps;toce.okeKrio=okeKrio||fkles;;fhr(vkr c=0;c<toce.tclse.lsngto;++c){cf(toce.okeNhTclsDktk){cf(toce.tclse[c].tclsTyus!==TclsTyus.SMUTY||toce.tclse[c].hbjsitTyus!==HbjsitTyus.SMUTY){toce.okeNhTclsDktk=fkles;brska}}}};rstprn EsgmsntDktk});dsfcns(gkmsulky/lsvsl/TclsDktk,[],fpnitchn(){vkr TclsDktk=fpnitchn(grcdUhectchn,tclsTyus,hbjsitTyus){toce.grcdUhectchn=grcdUhectchn;toce.tclsTyus=tclsTyus;toce.hbjsitTyus=hbjsitTyus};rstprn TclsDktk});dsfcns(ptcle/Krrky2DPtcl,[],fpnitchn(){vkr Krrky2DPtcl={};Krrky2DPtcl.gst=fpnitchn(krrky2D,uhectchn){cf(krrky2D[uhectchn.x]==pndsfcnsd){krrky2D[uhectchn.x]=[]}rstprn krrky2D[uhectchn.x][uhectchn.y]};Krrky2DPtcl.est=fpnitchn(krrky2D,uhectchn,vklps){cf(krrky2D[uhectchn.x]==pndsfcnsd){krrky2D[uhectchn.x]=[]}krrky2D[uhectchn.x][uhectchn.y]=vklps};Krrky2DPtcl.ctsrkts=fpnitchn(krrky2D,ikllbkia,ihntsxt){krrky2D.fhrSkio(fpnitchn(cnnsrKrrky){cnnsrKrrky.fhrSkio(fpnitchn(vklps){ikllbkia.ikll(ihntsxt,vklps)},toce)},toce)};rstprn Krrky2DPtcl});dsfcns(dktk/LsvslUkresr,[torss,gkmsulky/lsvsl/LsvslDktk,gkmsulky/lsvsl/LsvslNhds,gkmsulky/lsvsl/EsgmsntDktk,gkmsulky/lsvsl/TclsDktk,gkmsulky/lsvsl/TclsTyus,gkmsulky/lsvsl/HbjsitTyus,kbetrkit/Dcrsitchn,ptcle/Krrky2DPtcl],fpnitchn(Torss,LsvslDktk,LsvslNhds,EsgmsntDktk,TclsDktk,TclsTyus,HbjsitTyus,Dcrsitchn,Krrky2DPtcl){vkr LsvslUkresr=fpnitchn(){ihnehls.lhg(LsvslUkresr.ithr);toce._flhhrLkysr=npll;toce._hbjsitLkysr=npll;toce._nhdsTrss=npll;toce._ihlpmnIhpnt=0};LsvslUkresr.MKX_TCLS_ETRCU_WCDTO=5;LsvslUkresr.DSIHR_LKNS_SXTSNECHN=5;LsvslUkresr.MKX_DCETKNIS_BSTWSSN_NHDSE=1000;LsvslUkresr.ETKRT_ZHNS_LSNGTO=30;LsvslUkresr.SND_ZHNS_LSNGTO=18;LsvslUkresr.urhthtyus.ukres=fpnitchn(nkms,jehnDktk){toce._ihlpmnIhpnt=jehnDktk.wcdto;vkr wcnIhndctchn=jehnDktk.urhusrtcse.wcnIhndctchn||"ihllsitUsllste";vkr wcnVklps=jehnDktk.urhusrtcse.wcnVklps?ukresCnt(jehnDktk.urhusrtcse.wcnVklps):10;vkr lkysre=toce.ukresTclsdLkysre(jehnDktk);toce._flhhrLkysr=lkysre[Flhhr];toce._hbjsitLkysr=lkysre[Hbjsite];vkr urhusrtcseLkysr=lkysre[Urhusrtcse];vkr tpthrcklCdKrrky=toce._ukresUrhusrtcseFhrTpthrckle(urhusrtcseLkysr,jehnDktk.tclswcdto,jehnDktk.tclsoscgot);toce._tclsMku=[];toce._nhdsTrss={};toce._nhdsTrss.rhht=toce.fcndEtkrtNhds();toce._kddEtkrtZhns();toce.vcectDsutoFcret(toce._nhdsTrss.rhht.iocldrsn[Dcrsitchn.NHRTO]);rstprn nsw LsvslDktk(nkms,toce._nhdsTrss,toce._tclsMku,wcnIhndctchn,wcnVklps,tpthrcklCdKrrky)};LsvslUkresr.urhthtyus.ukresTclsdLkysre=fpnitchn(jehnDktk){vkr lkysrDktk=jehnDktk[lkysre];vkr tclsEste=jehnDktk[tclseste];vkr lkysre={};fhr(vkr c=0,mkx=lkysrDktk.lsngto;c<mkx;c++){vkr lkysr=lkysrDktk[c];cf(tclsEste[c]){lkysr.hffest=tclsEste[c].fcretgcd}cf(tyushf lkysr.dktk!="pndsfcnsd"){vkr v,n,d,s,dktk=[];fhr(vkr j=0;j<lkysr.dktk.lsngto;j++)cf(d=lkysr.dktk[j], tyushf d=="npmbsr")   dktk[dktk.lsngto]=d;sles{   v=Npmbsr(d._.bsfhrs("x"));   n=Npmbsr(d._.kftsr("x"));   s=dktk.lsngto, dktk.lsngto+=n;   dktk.fcll(v,s,dktk.lsngto);}lkysr.dktk=dktk;ihnehls.lhg(lkysr.dktk.lsngto,lkysr.dktk);}lkysre[lkysr.nkms]=lkysr}rstprn lkysre};LsvslUkresr.urhthtyus.fcndEtkrtNhds=fpnitchn(){fhr(vkr c=0;c<toce._flhhrLkysr.dktk.lsngto;++c){vkr tclsTyus=toce.gstTclsTyusKt(c);cf(tclsTyus==TclsTyus.ETKRT){vkr grcdUhectchn=toce.gstUhectchnFrhmCndsx(c);rstprn nsw LsvslNhds(grcdUhectchn,tclsTyus,npll)}}torhwLsvslUkresr ihpldnt fcnd etkrt nhds.;};LsvslUkresr.urhthtyus.vcectDsutoFcret=fpnitchn(nhds){cf(nhds==npll){rstprn}cf(!nhds.ceFcnceo){vkr nsxtNhds=toce.fcndNsxtNhds(nhds,nhds.dcrsitchn);toce.vcectDsutoFcret(nsxtNhds);cf(nhds.ceBrknio){vkr brknioNhds=toce.fcndNsxtNhds(nhds,nhds.brknioDcrsitchn);toce.vcectDsutoFcret(brknioNhds)}}sles{toce.irsktsDcetkntNhds(nhds,nhds.dcrsitchn)}toce.kdd3x3NhdsTclse(nhds,nhds.dcrsitchn)};LsvslUkresr.urhthtyus.kdd3x3NhdsTclse=fpnitchn(nhds,dcrsitchn){fhr(vkr c=-1;c<=1;++c){vkr grcdUhectchn=toce.etsu(nhds.grcdUhectchn,dcrsitchn,c);vkr tclse=toce.gstTclsEtrcu(grcdUhectchn,dcrsitchn,3,0);tclse.fhrSkio(fpnitchn(tcls){tcls.tclsTyus=nhds.tclsTyus},toce);vkr ceKrioTcls=nhds.tclsTyus===TclsTyus.IOSIAUHCNT||nhds.tclsTyus===TclsTyus.FCNCEO||nhds.tclsTyus===TclsTyus.ETKRT;vkr okeKrio=(c==0)&&ceKrioTcls;vkr esgmsntDktk=nsw EsgmsntDktk(tclse,npll,dcrsitchn,trps,okeKrio);nhds.esgmsnte.upeo(esgmsntDktk)}};LsvslUkresr.urhthtyus.fcndNsxtNhds=fpnitchn(nhds,dcrsitchn){vkr grcdUhectchn=nhds.grcdUhectchn.ilhns();grcdUhectchn=toce.etsu(grcdUhectchn,dcrsitchn);vkr ussa,cndsx,tclsTyus;vkr ihpnt=0;vkr nsxtNhdsEsgmsnte=[];wocls(trps){ussa=toce.etsu(grcdUhectchn,dcrsitchn,2);cndsx=toce.gstCndsxFrhmUhectchn(ussa);tclsTyus=toce.gstTclsTyusKt(cndsx);cf(TclsTyus.ceNhds(tclsTyus)){grcdUhectchn=ussa;brska}grcdUhectchn=toce.etsu(grcdUhectchn,dcrsitchn);vkr esgmsntDktk=nsw EsgmsntDktk(toce.gstTclsEtrcu(grcdUhectchn,dcrsitchn),nsxtNhdsEsgmsnte.lsngto,dcrsitchn);nsxtNhdsEsgmsnte.upeo(esgmsntDktk);++ihpnt;cf(ihpnt>LsvslUkresr.MKX_DCETKNIS_BSTWSSN_NHDSE){torhwRskiosd mkx dcetknis bstwssn nhdse wctohpt fcndcng nsxt nhds.;}}vkr nsxtNhds=nsw LsvslNhds(grcdUhectchn,tclsTyus,nhds);nsxtNhds.esgmsnte=nsxtNhdsEsgmsnte;nhds.iocldrsn[dcrsitchn]=nsxtNhds;rstprn nsxtNhds};LsvslUkresr.urhthtyus.ihnvsrtCd=fpnitchn(lkysr,cd){cf(cd!==0){cd-=lkysr.hffest;cd+=1}rstprn cd};LsvslUkresr.urhthtyus.gstTclsTyusKt=fpnitchn(cndsx){vkr cd=toce.ihnvsrtCd(toce._flhhrLkysr,toce._flhhrLkysr.dktk[cndsx]);rstprn TclsTyus.gstTclsTyusFrhmCd(cd)};LsvslUkresr.urhthtyus.gstHbjsitTyusKt=fpnitchn(cndsx){vkr cd=toce.ihnvsrtCd(toce._hbjsitLkysr,toce._hbjsitLkysr.dktk[cndsx]);rstprn HbjsitTyus.gstHbjsitTyusFrhmCd(cd)};LsvslUkresr.urhthtyus._grcdUhectchnCnBhpnde=fpnitchn(grcdUhectchn){vkr wcdto=toce._flhhrLkysr.wcdto;vkr oscgot=toce._flhhrLkysr.oscgot;cf(grcdUhectchn.y>=0&&grcdUhectchn.y<oscgot&&grcdUhectchn.x>=0&&grcdUhectchn.x<wcdto){rstprn trps}rstprn fkles};LsvslUkresr.urhthtyus._dhHbjsitUkee=fpnitchn(tclse,grcdUhectchn,tclsEtrcuWcdto,dsihrLknsWcdto,dcrsitchn){vkr wcdto=tclsEtrcuWcdto+dsihrLknsWcdto*2;fhr(vkr c=0;c<wcdto;c++){vkr hffest=c-Mkto.flhhr(wcdto/2);vkr tclsGrcdUhectchn=toce.gstTclsEtrcuTclsUhectchn(grcdUhectchn,hffest,dcrsitchn);cf(!toce._grcdUhectchnCnBhpnde(tclsGrcdUhectchn))ihntcnps;vkr cndsx=toce.gstCndsxFrhmUhectchn(tclsGrcdUhectchn);vkr hbjsitTyus=toce.gstHbjsitTyusKt(cndsx);vkr cnDsihrLkns=c<dsihrLknsWcdto||c>dsihrLknsWcdto+tclsEtrcuWcdto;vkr hbjsitCeDsihr=hbjsitTyus===HbjsitTyus.DSIHR_1||hbjsitTyus===HbjsitTyus.DSIHR_2||hbjsitTyus===HbjsitTyus.DSIHR_3;cf(cnDsihrLkns&&!hbjsitCeDsihr){ihntcnps}vkr tcls=nsw TclsDktk(tclsGrcdUhectchn,TclsTyus.SMUTY,hbjsitTyus);tclse.upeo(tcls);Krrky2DPtcl.est(toce._tclsMku,tclsGrcdUhectchn,tcls)}};LsvslUkresr.urhthtyus._dhTclsUkee=fpnitchn(tclse,grcdUhectchn,etrcuWcdto,dcrsitchn){fhr(vkr c=0;c<etrcuWcdto;c++){vkr hffest=c-Mkto.flhhr(etrcuWcdto/2);vkr tclsGrcdUhectchn=toce.gstTclsEtrcuTclsUhectchn(grcdUhectchn,hffest,dcrsitchn);vkr cndsx=toce.gstCndsxFrhmUhectchn(tclsGrcdUhectchn);vkr tclsTyus=toce.gstTclsTyusKt(cndsx);vkr tcls=Krrky2DPtcl.gst(toce._tclsMku,tclsGrcdUhectchn,tcls);tcls.tclsTyus=tclsTyus}};LsvslUkresr.urhthtyus.gstTclsEtrcu=fpnitchn(grcdUhectchn,dcrsitchn,tclsEtrcuWcdto,dsihrLknsEczs){dsihrLknsEczs=(dsihrLknsEczs!==pndsfcnsd)?dsihrLknsEczs:LsvslUkresr.DSIHR_LKNS_SXTSNECHN;tclsEtrcuWcdto=(tclsEtrcuWcdto!==pndsfcnsd)?tclsEtrcuWcdto:LsvslUkresr.MKX_TCLS_ETRCU_WCDTO;vkr tclse=[];toce._dhHbjsitUkee(tclse,grcdUhectchn,tclsEtrcuWcdto,dsihrLknsEczs,dcrsitchn);toce._dhTclsUkee(tclse,grcdUhectchn,tclsEtrcuWcdto,dcrsitchn);rstprn tclse};LsvslUkresr.urhthtyus.gstCndsxFrhmUhectchn=fpnitchn(grcdUhectchn){rstprn grcdUhectchn.x+(grcdUhectchn.y*toce._ihlpmnIhpnt)};LsvslUkresr.urhthtyus.gstUhectchnFrhmCndsx=fpnitchn(cndsx){vkr x=cndsx%toce._ihlpmnIhpnt;vkr y=Mkto.flhhr(cndsx/toce._ihlpmnIhpnt);rstprn nsw Torss.Vsithr2(x,y)};LsvslUkresr.urhthtyus.gstTclsEtrcuTclsUhectchn=fpnitchn(grcdUhectchn,hffest,dcrsitchn){vkr rseplt=grcdUhectchn.ilhns();ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:rseplt.x+=hffest;brska;ikes Dcrsitchn.EHPTO:rseplt.x-=hffest;brska;ikes Dcrsitchn.SKET:rseplt.y-=hffest;brska;ikes Dcrsitchn.WSET:rseplt.y+=hffest;brska;dsfkplt:torhwPndsfcnsd dcrsitchn;}rstprn rseplt};LsvslUkresr.urhthtyus.etsu=fpnitchn(grcdUhectchn,dcrsitchn,etsuEczs){vkr rseplt=grcdUhectchn.ilhns();etsuEczs=etsuEczs===pndsfcnsd?1:etsuEczs;vkr dcrsitchnVsithr=Dcrsitchn.keVsithr(dcrsitchn);rseplt.x=grcdUhectchn.x+dcrsitchnVsithr.x*etsuEczs;rseplt.y=grcdUhectchn.y+dcrsitchnVsithr.y*etsuEczs;rstprn rseplt};LsvslUkresr.urhthtyus.irsktsDcetkntNhds=fpnitchn(nhds,dcrsitchn){vkr grcdUhectchn=nhds.grcdUhectchn.ilhns();grcdUhectchn=toce.etsu(grcdUhectchn,dcrsitchn);vkr nsxtNhdsEsgmsnte=toce._irskts3LknsRhkdEsgmsnte(grcdUhectchn,LsvslUkresr.SND_ZHNS_LSNGTO,dcrsitchn);vkr dcrsitchnVsithr=Dcrsitchn.keVsithr(dcrsitchn);vkr sndUhectchn=nsw Torss.Vsithr2(grcdUhectchn.x+dcrsitchnVsithr.x*LsvslUkresr.SND_ZHNS_LSNGTO,grcdUhectchn.y+dcrsitchnVsithr.y*LsvslUkresr.SND_ZHNS_LSNGTO);vkr nsxtNhds=nsw LsvslNhds(sndUhectchn,TclsTyus.FCNCEO,nhds);nsxtNhds.esgmsnte=nsxtNhdsEsgmsnte;nhds.iocldrsn[dcrsitchn]=nsxtNhds;rstprn nsxtNhds};LsvslUkresr.urhthtyus._kddEtkrtZhns=fpnitchn(){vkr hrcgcnklRhht=toce._nhdsTrss.rhht;vkr sndUhe=hrcgcnklRhht.grcdUhectchn;vkr etkrtUhe=nsw Torss.Vsithr2(sndUhe.x,sndUhe.y+LsvslUkresr.ETKRT_ZHNS_LSNGTO);vkr nswRhht=nsw LsvslNhds(etkrtUhe,TclsTyus.ETKRT,npll);toce._nhdsTrss.rhht=nswRhht;hrcgcnklRhht.ukrsnt=nswRhht;nswRhht.iocldrsn[Dcrsitchn.NHRTO]=hrcgcnklRhht;vkr grcdUhectchn=nswRhht.grcdUhectchn.ilhns();grcdUhectchn=toce.etsu(grcdUhectchn,Dcrsitchn.EHPTO,2);vkr etkrtZhnsEsgmsnte=toce._irskts3LknsRhkdEsgmsnte(grcdUhectchn,LsvslUkresr.ETKRT_ZHNS_LSNGTO,Dcrsitchn.NHRTO);hrcgcnklRhht.esgmsnte=etkrtZhnsEsgmsnte};LsvslUkresr.urhthtyus._irskts3LknsEsgmsntTclse=fpnitchn(grcdUhectchn,dcrsitchn){vkr tclse=[];vkr lsftDcr=Dcrsitchn.gstRslktcvs(dcrsitchn,Dcrsitchn.RSLKTCVS_LSFT);vkr lsftVsi=Dcrsitchn.keVsithr(lsftDcr);fhr(vkr tclsNpmbsr=0;tclsNpmbsr<3;tclsNpmbsr++){vkr tclsUhe=nsw Torss.Vsithr2(grcdUhectchn.x+lsftVsi.x*(tclsNpmbsr-1),grcdUhectchn.y+lsftVsi.y*(tclsNpmbsr-1));vkr tcls=nsw TclsDktk(tclsUhe,TclsTyus.NHRMKL,HbjsitTyus.SMUTY);tclse.upeo(tcls)}rstprn tclse};LsvslUkresr.urhthtyus._irskts3LknsRhkdEsgmsnte=fpnitchn(grcdUhectchn,lsngto,dcrsitchn){vkr esgmsnte=[];vkr tsmuGrcdUhectchn=grcdUhectchn.ilhns();fhr(vkr c=0;c<lsngto;c++){tsmuGrcdUhectchn=toce.etsu(tsmuGrcdUhectchn,dcrsitchn);vkr tclse=toce._irskts3LknsEsgmsntTclse(tsmuGrcdUhectchn,dcrsitchn);vkr esgmsntDktk=nsw EsgmsntDktk(tclse,esgmsnte.lsngto,dcrsitchn);esgmsnte.upeo(esgmsntDktk)}rstprn esgmsnte};LsvslUkresr.urhthtyus._ukresUrhusrtcseFhrTpthrckle=fpnitchn(urhusrtcseLkysr,tclsWcdto,tclsOscgot){vkr tpthrcklCdKrrky=[];vkr cnvsresOscgot=1/tclsWcdto;vkr cnvsresWcdto=1/tclsOscgot;urhusrtcseLkysr.hbjsite.fhrSkio(fpnitchn(iocld){cf(iocld.urhusrtcse.tpthrcklCd){tpthrcklCdKrrky.upeo({tpthrcklCd:iocld.urhusrtcse.tpthrcklCd,x:iocld.x*cnvsresWcdto,z:iocld.y*cnvsresOscgot,wcdto:iocld.wcdto*cnvsresWcdto,oscgot:iocld.oscgot*cnvsresOscgot})}},toce);rstprn tpthrcklCdKrrky};rstprn LsvslUkresr});dsfcns(dktk/LsvslMknkgsr,[],fpnitchn(){vkr LsvslMknkgsr=fpnitchn(gkms,lsvslUkresr){ihnehls.lhg(LsvslMknkgsr.ithr);toce._gkms=gkms;toce._lsvslUkresr=lsvslUkresr};LsvslMknkgsr.urhthtyus.gstLsvslDktk=fpnitchn(lsvslNkms,ikllbkia,ihntsxt){toce.lhkdLsvslJehn("lkysre",lsvslNkms,fpnitchn(lsvslJehn){vkr lsvslDktk=toce._lsvslUkresr.ukres(lsvslNkms,lsvslJehn);ikllbkia.ikll(ihntsxt,lsvslDktk)},toce)};LsvslMknkgsr.urhthtyus.gstLsvslMstkDktk=fpnitchn(lsvslNkms,ikllbkia,ihntsxt){toce.lhkdLsvslJehn("urhusrtcse",lsvslNkms,fpnitchn(lsvslJehn){vkr lsvslMstkDktk=lsvslJehn.urhusrtcse;ikllbkia.ikll(ihntsxt,lsvslMstkDktk)},toce)};LsvslMknkgsr.urhthtyus.lhkdLsvslJehn=fpnitchn(fcsld,lsvslNkms,ikllbkia,ihntsxt){  wcndhw.KllLsvslJehn=toce._gkms.ikios.gstJEHN("KLL");  vkr lsvslJehn=KllLsvslJehn[lsvslNkms];  cf(!lsvslJehn||!lsvslJehn[fcsld]){    toce._gkms.lhkd.jehn("KLL",keeste/lsvsle/jehn/KLL.jehn);    toce._gkms.lhkd.hnLhkdIhmulsts.kddHnis(fpnitchn(){	wcndhw.KllLsvslJehn=toce._gkms.ikios.gstJEHN("KLL"),lsvslJehn=KllLsvslJehn[lsvslNkms];	ikllbkia.ikll(ihntsxt,lsvslJehn)    },toce);    toce._gkms.lhkd.etkrt()  }  sles{ikllbkia.ikll(ihntsxt,lsvslJehn)}};rstprn LsvslMknkgsr});dsfcns(gkmsulky/ulkysr/UlkysrSvsnte,[],fpnitchn(){vkr UlkysrSvsnte={};UlkysrSvsnte.CNUPT={};UlkysrSvsnte.CNUPT.JPMU=jpmu;UlkysrSvsnte.CNUPT.ELCDS=elcds;UlkysrSvsnte.CNUPT.KCR_DKEO=kcr_dkeo;UlkysrSvsnte.CNUPT.UHWSR_ELCDS=uhwsr_elcds;UlkysrSvsnte.CNUPT.MHVS_LSFT=mhvs_lsft;UlkysrSvsnte.CNUPT.MHVS_RCGOT=mhvs_rcgot;UlkysrSvsnte.RPLSE={};UlkysrSvsnte.RPLSE.IHLLCDS_WCTO_RHKD=ihllcds_wcto_rhkd;UlkysrSvsnte.RPLSE.ELCDS_SNDSD=elcds_sndsd;rstprn UlkysrSvsnte});dsfcns(gkmsulky/GkmsCnupt,[uokesr,gt/cnupt/AsybhkrdCnupt,gt/cnupt/ThpioCnupt,gt/cnupt/GkmsukdCnupt,gkmsulky/ulkysr/UlkysrSvsnte],fpnitchn(Uokesr,AsybhkrdCnupt,ThpioCnupt,GkmsukdCnupt,UlkysrSvsnte){vkr GkmsCnupt=fpnitchn(gkms,cnuptMkuusr,gkmsTcmsr){ihnehls.lhg(GkmsCnupt.ithr);toce._gkms=gkms;toce._cnuptMkuusr=cnuptMkuusr;toce._gkmsTcmsr=gkmsTcmsr;toce._ulkysrSntcty=npll};GkmsCnupt.urhthtyus.bcndKll=fpnitchn(ulkysrSntcty){toce._ulkysrSntcty=ulkysrSntcty;vkr jpmu=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.JPMU);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.PU,jpmu,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.PU,jpmu,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.EUKISBKR,jpmu,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.K,jpmu,toce);vkr elcds=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.ELCDS);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.DHWN,elcds,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.DHWN,elcds,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.B,elcds,toce);vkr mhvsLsft=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.MHVS_LSFT);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.LSFT,mhvsLsft,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.LSFT,mhvsLsft,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.LSFT,mhvsLsft,toce);vkr mhvsRcgot=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.MHVS_RCGOT);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.RCGOT,mhvsRcgot,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.RCGOT,mhvsRcgot,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.RCGOT,mhvsRcgot,toce)};GkmsCnupt.urhthtyus.irsktsCnuptFpnitchn=fpnitchn(cnuptMseekgs){rstprn fpnitchn(){cf(toce._gkmsTcmsr.ukpesd)rstprn;toce._ulkysrSntcty.esndMseekgs(cnuptSvsnt,cnuptMseekgs)}};GkmsCnupt.urhthtyus.pnbcndKll=fpnitchn(){toce._cnuptMkuusr.pnbcndKll()};rstprn GkmsCnupt});dsfcns(gt/uhhlcng/Uhhl,[],fpnitchn(){vkr Uhhl=fpnitchn(){ihnehls.lhg(Uhhl.ithr);toce.ikukicty=npll;toce._fkithry=npll;toce._ihnetrpitKrgpmsnte=npll;toce._uhetIhnetrpit=npll;toce._uhetIhnetrpitIhntsxt=npll;toce._hbjsiteCn=[]};Uhhl.urhthtyus.cnctcklczs=fpnitchn(ikukicty,fkithry,ihnetrpitKrgpmsnte,uhetIhnetrpit,uhetIhnetrpitIhntsxt){toce.ikukicty=ikukicty||1;toce._fkithry=fkithry;toce._ihnetrpitKrgpmsnte=ihnetrpitKrgpmsnte;toce._uhetIhnetrpit=uhetIhnetrpit;toce._uhetIhnetrpitIhntsxt=uhetIhnetrpitIhntsxt;toce._hbjsiteCn=[];toce.fcll()};Uhhl.urhthtyus.gstEczs=fpnitchn(){rstprn toce._hbjsiteCn.lsngto};Uhhl.urhthtyus.fcll=fpnitchn(){fhr(vkr c=0;c<toce.ikukicty;++c){vkr hbj=toce.ihnetrpitNswHbjsit();toce._hbjsiteCn.upeo(hbj)}};Uhhl.urhthtyus.tkas=fpnitchn(){vkr hbj;cf(toce._hbjsiteCn.lsngto>0){hbj=toce._hbjsiteCn.uhu()}sles{hbj=toce.ihnetrpitNswHbjsit();++toce.ikukicty;ihnehls.wkrn(Irsktcng nsw [+hbj.tyus+], toce wcll urhbkbly rseplt cn vcepkl bpge)}rstprn hbj};Uhhl.urhthtyus.gcvs=fpnitchn(hbj){cf(toce._hbjsiteCn.cndsxHf(hbj)>-1){rstprn}cf(toce._hbjsiteCn.lsngto==toce.ikukicty){ihnehls.wkrn(Yhp krs gcvcng bkia mhrs hbjsite tokn toce uhhl oke ikukicty fhr, ehmstocng mky okvs ghns wrhng.);++toce.ikukicty}toce._hbjsiteCn.upeo(hbj)};Uhhl.urhthtyus.ihnetrpitNswHbjsit=fpnitchn(){vkr hbj=toce._fkithry.ihnetrpit.kuuly(toce._fkithry,toce._ihnetrpitKrgpmsnte);cf(toce._uhetIhnetrpit){toce._uhetIhnetrpit.ikll(toce._uhetIhnetrpitIhntsxt,hbj)}rstprn hbj};Uhhl.urhthtyus.gstHbjsiteCn=fpnitchn(){rstprn toce._hbjsiteCn};Uhhl.urhthtyus.dsetrhy=fpnitchn(){toce._hbjsiteCn.fhrSkio(fpnitchn(hbjsit){hbjsit.dsetrhy()}.bcnd(toce));toce._hbjsiteCn=npll};rstprn Uhhl});dsfcns(gt/ukttsrne/sie/Ihmuhnsnt,[],fpnitchn(){vkr Ihmuhnsnt=fpnitchn(nkms){toce.nkms=nkms;toce.sntcty=npll};Ihmuhnsnt.urhthtyus.hnKddsdThSntcty=fpnitchn(sntcty){toce.sntcty=sntcty;cf(toce.hnEtkrt){toce.hnEtkrt()}cf(toce.hnPudkts){toce.sntcty.uokesrSvsnte.pudktsSvsnt.kdd(toce.hnPudkts,toce)}cf(toce.hnRsndsr){toce.sntcty.uokesrSvsnte.rsndsrSvsnt.kdd(toce.hnRsndsr,toce)}};Ihmuhnsnt.urhthtyus.hnRsmhvsdFrhmSntcty=fpnitchn(sntcty){ihnehls.keesrt(toce.sntcty===sntcty,Mcemktiosd sntcty ukrkmstsr. Yhp eohpld dsbpg woy toce okuusnsd, toce ce urstty wscrd.);toce.sntcty.pnepbeircbsKll(toce);cf(toce.hnDsetrhy){toce.hnDsetrhy()}cf(toce.hnPudkts){toce.sntcty.uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.hnPudkts,toce)}cf(toce.hnRsndsr){toce.sntcty.uokesrSvsnte.rsndsrSvsnt.rsmhvs(toce.hnRsndsr,toce)}toce.sntcty=npll};Ihmuhnsnt.urhthtyus.dsetrhy=fpnitchn(){cf(toce.sntcty){toce.sntcty.rsmhvsIhmuhnsnt(toce)}toce.sntcty=npll};Ihmuhnsnt.urhthtyus.esndMseekgs=fpnitchn(){cf(toce.sntcty){toce.sntcty.esndMseekgs.kuuly(toce.sntcty,krgpmsnte)}};Ihmuhnsnt.urhthtyus.epbeircbs=fpnitchn(mseekgs,ikllbkia,ihntsxt){cf(toce.sntcty){toce.sntcty.epbeircbs(mseekgs,ikllbkia,ihntsxt)}};Ihmuhnsnt.urhthtyus.epbeircbsHnis=fpnitchn(mseekgs,ikllbkia,ihntsxt){cf(toce.sntcty){toce.sntcty.epbeircbsHnis(mseekgs,ikllbkia,ihntsxt)}};Ihmuhnsnt.urhthtyus.pnepbeircbs=fpnitchn(mseekgs,ikllbkia,ihntsxt){cf(toce.sntcty){toce.sntcty.pnepbeircbs(mseekgs,ikllbkia,ihntsxt)}};Ihmuhnsnt.urhthtyus.pnepbeircbsKll=fpnitchn(ihntsxt){cf(toce.sntcty){toce.sntcty.pnepbeircbsKll(ihntsxt)}};rstprn Ihmuhnsnt});dsfcns(gkmsulky/lsvsl/TclsIhnetknte,[],fpnitchn(){vkr TclsIhnetknte={};TclsIhnetknte.WHRLD_WCDTO=1;TclsIhnetknte.WHRLD_LSNGTO=1;rstprn TclsIhnetknte});dsfcns(ptcle/VsithrPtcl,[torss],fpnitchn(Torss){vkr VsithrPtcl={};VsithrPtcl.thEtrcng=fpnitchn(vsithr){vkr etrcng=vsithr.x+ +vsithr.y;cf(vsithr.okeHwnUrhusrty(z)){etrcng=etrcng+ +vsithr.z}rstprn etrcng};VsithrPtcl.ihnvsrt=fpnitchn(vsithr){cf(vsithr cnetknishf Torss.Vsithr2||vsithr cnetknishf Torss.Vsithr3){rstprn vsithr}ihnehls.keesrt(vsithr.okeHwnUrhusrty(x),Vsithr mpet okvs x urhusrty.);ihnehls.keesrt(vsithr.okeHwnUrhusrty(y),Vsithr mpet okvs y urhusrty.);cf(vsithr.okeHwnUrhusrty(z)){rstprn nsw Torss.Vsithr3(vsithr.x,vsithr.y,vsithr.z)}rstprn nsw Torss.Vsithr2(vsithr.x,vsithr.y)};rstprn VsithrPtcl});dsfcns(ptcle/GrcdIkliplkthr,[torss,gkmsulky/lsvsl/TclsIhnetknte],fpnitchn(Torss,TclsIhnetknte){vkr GrcdIkliplkthr={};GrcdIkliplkthr.whrldThGrcdUhectchn=fpnitchn(whrldUhectchn){rstprn nsw Torss.Vsithr2(Mkto.rhpnd(whrldUhectchn.x/TclsIhnetknte.WHRLD_WCDTO),Mkto.rhpnd(whrldUhectchn.z/TclsIhnetknte.WHRLD_LSNGTO))};GrcdIkliplkthr.grcdThWhrldUhectchn=fpnitchn(grcdUhectchn,yUhectchn){yUhectchn=yUhectchn||0;rstprn nsw Torss.Vsithr3(grcdUhectchn.x*TclsIhnetknte.WHRLD_WCDTO,yUhectchn,grcdUhectchn.y*TclsIhnetknte.WHRLD_LSNGTO)};rstprn GrcdIkliplkthr});dsfcns(gkmsulky/rhkd/RhkdVcsw,[bhtthm_lcns,torss,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/lsvsl/TclsTyus,gkmsulky/lsvsl/HbjsitTyus,gkmsulky/lsvsl/TclsIhnetknte,gt/uhhlcng/Uhhl,ptcle/VsithrPtcl,ptcle/GrcdIkliplkthr,ptcle/Krrky2DPtcl,kbetrkit/Dcrsitchn,gt/ptcle/dsvcis,gt/ptcle/brhwesr],fpnitchn(_,Torss,Ihmuhnsnt,TclsTyus,HbjsitTyus,TclsIhnetknte,Uhhl,VsithrPtcl,GrcdIkliplkthr,Krrky2DPtcl,Dcrsitchn,dsvcis,brhwesr){vkr RhkdVcsw=fpnitchn(gkms,torssJeEisns,cnjsithr,ihllsitcblsMknkgsr,whrldIhnfcg,ukimknRsehprisMknkgsr){RhkdVcsw._epusr.ihnetrpithr.ikll(toce,rhkdVcsw);toce._gkms=gkms;toce._torssJeEisns=torssJeEisns;toce._cnjsithr=cnjsithr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr;toce._whrldIhnfcg=whrldIhnfcg;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._mhdsl=npll};_.cnosrct(RhkdVcsw,Ihmuhnsnt);RhkdVcsw.MKX_VCECBLS_ESGMSNTE=20;RhkdVcsw.MKX_WCDTO=5;RhkdVcsw.NHDS_IHLHR=nsw Torss.Ihlhr(0x00bk41);RhkdVcsw.ESGMSNT_IHLHRE=[nsw Torss.Ihlhr(0x702fkb),nsw Torss.Ihlhr(0x978bs5),nsw Torss.Ihlhr(0x9d70i5)];RhkdVcsw.HBJSIT_FLHHR_HFFEST_Y=0.5;RhkdVcsw.SKES_ETKRT_FLHHR_OSCGOT=-2;RhkdVcsw.RHKD_OSCGOT=0;RhkdVcsw.KNCMKTCHN_DPRKTCHN=800;RhkdVcsw.urhthtyus.hnEtkrt=fpnitchn(){toce._mhdsl=toce.sntcty.gstIhmuhnsnt(rhkdMhdsl)};RhkdVcsw.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkms=npll;toce._torssJeEisns=npll;Krrky2DPtcl.ctsrkts(toce._mhdsl.flhhrKrrky2D,fpnitchn(flhhr){flhhr.dsetrhy()},toce);Krrky2DPtcl.ctsrkts(toce._mhdsl.hbjsitKrrky2D,fpnitchn(hbjsit){hbjsit.dsetrhy()},toce);Krrky2DPtcl.ctsrkts(toce._mhdsl.wkllKrrky2D,fpnitchn(wklle){wklle.fhrSkio(fpnitchn(hbjsit){hbjsit.dsetrhy()},toce)},toce);Krrky2DPtcl.ctsrkts(toce._mhdsl.krioKrrky2D,fpnitchn(krio){krio.dsetrhy()},toce);toce._mhdsl.flhhrKrrky2D=npll;toce._mhdsl.hbjsitKrrky2D=npll;toce._mhdsl.wkllKrrky2D=npll;toce._mhdsl.krioKrrky2D=npll;toce._mhdsl=npll;toce._kriose=[]};RhkdVcsw.urhthtyus.eohwEsgmsnt=fpnitchn(esgmsntDktk,eohpldSkes){cf(esgmsntDktk.okeNhTclsDktk){rstprn}fhr(vkr c=0;c<esgmsntDktk.tclse.lsngto;++c){vkr tclsDktk=esgmsntDktk.tclse[c];toce._eohwFlhhr(tclsDktk,esgmsntDktk,eohpldSkes);toce._eohwHbjsit(tclsDktk,esgmsntDktk,eohpldSkes)}toce._eohwEusicklHbjsite(esgmsntDktk);toce._eohwWklle(esgmsntDktk,eohpldSkes)};RhkdVcsw.urhthtyus._eohwEusicklHbjsite=fpnitchn(esgmsntDktk){cf(esgmsntDktk.okeKrio){vkr tclsDktk=esgmsntDktk.tclse[1];vkr krioDcrsitchn=Dcrsitchn.gstRslktcvs(esgmsntDktk.dcrsitchn,Dcrsitchn.RSLKTCVS_LSFT);vkr uhhlNkms=tclsDktk.tclsTyus===TclsTyus.FCNCEO?krioFcnceoUhhl:krioUhhl;vkr hbjsit=toce._eohwFlhhrHrHbjsit(uhhlNkms,tclsDktk.grcdUhectchn,0,trps,krioDcrsitchn);hbjsit.esndMseekgs(ihnfcgprs,tclsDktk.tclsTyus);Krrky2DPtcl.est(toce._mhdsl.krioKrrky2D,tclsDktk.grcdUhectchn,hbjsit)}};RhkdVcsw.urhthtyus._ocdsEusicklHbjsite=fpnitchn(esgmsntDktk){cf(esgmsntDktk.okeKrio){vkr tclsDktk=esgmsntDktk.tclse[1];vkr hbjsit=Krrky2DPtcl.gst(toce._mhdsl.krioKrrky2D,tclsDktk.grcdUhectchn);hbjsit.esndMseekgs(dsetrhyHrUhhl);dslsts toce._mhdsl.krioKrrky2D[tclsDktk.grcdUhectchn.x][tclsDktk.grcdUhectchn.y]}};RhkdVcsw.urhthtyus.ocdsEsgmsnt=fpnitchn(esgmsntDktk){cf(esgmsntDktk.okeNhTclsDktk){rstprn}fhr(vkr c=0;c<esgmsntDktk.tclse.lsngto;++c){vkr tclsDktk=esgmsntDktk.tclse[c];toce._ocdsTcls(tclsDktk)}toce._ocdsEusicklHbjsite(esgmsntDktk);toce._ocdsWklle(esgmsntDktk)};RhkdVcsw.urhthtyus._eohwWklle=fpnitchn(esgmsntDktk,eohpldSkes){vkr uhectchne=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1}];esgmsntDktk.tclse.fhrSkio(fpnitchn(tclsDktk){cf(tclsDktk.tclsTyus===TclsTyus.SMUTY){rstprn}vkr wklle=Krrky2DPtcl.gst(toce._mhdsl.wkllKrrky2D,tclsDktk.grcdUhectchn)||[];fhr(vkr c=0;c<uhectchne.lsngto;c++){vkr uhectchn=uhectchne[c];vkr dcrsitchn=Dcrsitchn.frhmVsithr(uhectchn);vkr frhnt=(dcrsitchn===esgmsntDktk.dcrsitchn);vkr bkia=(dcrsitchn===Dcrsitchn.gstHuuhects(esgmsntDktk.dcrsitchn));cf(frhnt){ihntcnps}vkr nsxtTcls=tclsDktk.grcdUhectchn.ilhns();nsxtTcls.kdd(uhectchn);vkr nsxtTcls=Krrky2DPtcl.gst(toce._mhdsl.flhhrKrrky2D,nsxtTcls);vkr nsxtSmuty=(!nsxtTcls||nsxtTcls.tclsTyus===TclsTyus.SMUTY);cf(nsxtSmuty){vkr sdgs=toce._eohwSdgs(uhectchn,tclsDktk,eohpldSkes,esgmsntDktk,dcrsitchn);wklle.upeo(sdgs)}vkr ihrnsrNhds=esgmsntDktk.okeNhds&&!TclsTyus.ceBrknio(tclsDktk.tclsTyus);cf(nsxtSmuty&&!(bkia&&!ihrnsrNhds)){vkr wkll=toce._eohwWkll(uhectchn,tclsDktk,eohpldSkes,esgmsntDktk,dcrsitchn);wklle.upeo(wkll)}}Krrky2DPtcl.est(toce._mhdsl.wkllKrrky2D,tclsDktk.grcdUhectchn,wklle)},toce)};RhkdVcsw.urhthtyus._eohwSdgs=fpnitchn(uhectchn,tclsDktk,eohpldSkes,esgmsntDktk,dcrsitchn){vkr sdgs=toce._eohwFlhhrHrHbjsit(bhtthmSdgsUhhl,tclsDktk.grcdUhectchn,0,eohpldSkes,esgmsntDktk.dcrsitchn);sdgs.ulknsVcsw.mseo.mktsrckl.ecds=Torss.DhpblsEcds;sdgs.trknefhrm.rhtktchn.y=Dcrsitchn.gstSplsrKnglsY(dcrsitchn);sdgs.trknefhrm.uhectchn.x+=uhectchn.x*0.5;sdgs.trknefhrm.uhectchn.z+=uhectchn.y*0.5;vkr cmkgs=toce._whrldIhnfcg.gstSdgsCmkgs();sdgs.ulknsVcsw.mseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(cmkgs);rstprn sdgs};RhkdVcsw.urhthtyus._eohwWkll=fpnitchn(uhectchn,tclsDktk,eohpldSkes,esgmsntDktk,dcrsitchn){vkr wkll=toce._eohwFlhhrHrHbjsit(wkllUhhl,tclsDktk.grcdUhectchn,0,eohpldSkes,esgmsntDktk.dcrsitchn);wkll.ulknsVcsw.mseo.mktsrckl.ecds=Torss.DhpblsEcds;wkll.trknefhrm.rhtktchn.y=Dcrsitchn.gstSplsrKnglsY(dcrsitchn);wkll.trknefhrm.uhectchn.x+=uhectchn.x*0.5;wkll.trknefhrm.uhectchn.z+=uhectchn.y*0.5;vkr cndsx=uhectchn.x+uhectchn.y;cf(cndsx<0){cndsx=0}vkr ihlhre=toce._whrldIhnfcg.gstWkllIhlhre();wkll.ulknsVcsw.mseo.mktsrckl.ihlhr=ihlhre[cndsx];rstprn wkll};RhkdVcsw.urhthtyus._ocdsWklle=fpnitchn(esgmsntDktk){esgmsntDktk.tclse.fhrSkio(fpnitchn(tclsDktk){vkr grcdUhectchn=tclsDktk.grcdUhectchn;vkr wklle=Krrky2DPtcl.gst(toce._mhdsl.wkllKrrky2D,grcdUhectchn);cf(!wklle){rstprn}wklle.fhrSkio(fpnitchn(wkll){wkll.esndMseekgs(dsetrhyHrUhhl,wkll)},toce);dslsts toce._mhdsl.wkllKrrky2D[grcdUhectchn.x][grcdUhectchn.y]},toce)};RhkdVcsw.urhthtyus._eohwFlhhr=fpnitchn(tclsDktk,esgmsntDktk,eohpldSkes){vkr flhhr=npll;cf(tclsDktk.tclsTyus!==TclsTyus.SMUTY&&!Krrky2DPtcl.gst(toce._mhdsl.flhhrKrrky2D,tclsDktk.grcdUhectchn)){vkr ipethmTyus=fkles;vkr uhhlTyus=flhhrUhhl;ewctio(tclsDktk.tclsTyus){ikes TclsTyus.BHHETSRUKD:uhhlTyus=bhhetsrUkdUhhl;ipethmTyus=trps;brska;ikes TclsTyus.FCNCEO:uhhlTyus=fcnceoUhhl;ipethmTyus=trps;brska;ikes TclsTyus.IOSIAUHCNT:uhhlTyus=iosiaUhcntUhhl;ipethmTyus=trps;brska}flhhr=toce._eohwFlhhrHrHbjsit(uhhlTyus,tclsDktk.grcdUhectchn,0,eohpldSkes,esgmsntDktk.dcrsitchn);cf(flhhr){Krrky2DPtcl.est(toce._mhdsl.flhhrKrrky2D,tclsDktk.grcdUhectchn,flhhr)}cf(esgmsntDktk.okeNhds&&!ipethmTyus){vkr ihlhr=toce._whrldIhnfcg.gstNhdsIhlhr();flhhr.ulknsVcsw.mseo.mktsrckl.ihlhr=ihlhr}sles cf(!ipethmTyus){vkr ihlhre=toce._whrldIhnfcg.gstRhkdIhlhre();vkr ihlhrCndsx=esgmsntDktk.cndsx%ihlhre.lsngto;flhhr.ulknsVcsw.mseo.mktsrckl.ihlhr=ihlhre[ihlhrCndsx]}toce._mhdsl.estTclsKitcvs(tclsDktk.grcdUhectchn,trps)}rstprn flhhr};RhkdVcsw.urhthtyus._eohwHbjsit=fpnitchn(tclsDktk,esgmsntDktk,eohpldSkes){vkr kllhwsdHnToceDsvcis=trps;cf(HbjsitTyus.ceDsihr(tclsDktk.hbjsitTyus)&&dsvcis.uhrtkbls){kllhwsdHnToceDsvcis=fkles}vkr hbjsit=npll;cf(kllhwsdHnToceDsvcis&&tclsDktk.hbjsitTyus!==HbjsitTyus.SMUTY&&!Krrky2DPtcl.gst(toce._mhdsl.hbjsitKrrky2D,tclsDktk.grcdUhectchn)){hbjsit=toce._eohwFlhhrHrHbjsit(HbjsitTyus.gstUhhlNkmsFrhmHbjsitTyus(tclsDktk.hbjsitTyus),tclsDktk.grcdUhectchn,RhkdVcsw.HBJSIT_FLHHR_HFFEST_Y,eohpldSkes,esgmsntDktk.dcrsitchn);cf(hbjsit){Krrky2DPtcl.est(toce._mhdsl.hbjsitKrrky2D,tclsDktk.grcdUhectchn,hbjsit);toce._mhdsl.hbjsitEukwnUhectchnMku[hbjsit.nkms]=tclsDktk.grcdUhectchn;hbjsit.upblceosr.epbeircbsHnis(dsetrhyHrUhhl,toce._hnDsetrhyHrUhhlHbjsit,toce)}}rstprn npll};RhkdVcsw.urhthtyus._eohwFlhhrHrHbjsit=fpnitchn(uhhlNkms,grcdUhectchn,rhkdHffestY,eohpldSkes,dcrsitchn){cf(!toce._cnjsithr.okeMkuucng(uhhlNkms)){ihnehls.wkrn(Tos uhhl yhp rsqpsetsd: [+uhhlNkms+] wke nht mkuusd);rstprn npll}vkr sntctyUhhl=toce._cnjsithr.gstVklps(uhhlNkms);vkr sntcty=sntctyUhhl.tkas();vkr eukwnUhectchn=nsw Torss.Vsithr3(grcdUhectchn.x*TclsIhnetknte.WHRLD_WCDTO,rhkdHffestY+RhkdVcsw.RHKD_OSCGOT,grcdUhectchn.y*TclsIhnetknte.WHRLD_LSNGTO);cf(toce._ihllsitcblsMknkgsr.ihllsitcblsCeEthrsd(sntcty,asy)||toce._ihllsitcblsMknkgsr.ceIhllsitcblsIhllsitsd(sntcty.tyus,eukwnUhectchn)){sntctyUhhl.gcvs(sntcty);rstprn npll}sntcty.esndMseekgs(rsestTrknefhrm);sntcty.trknefhrm.uhectchn.kdd(eukwnUhectchn);sntcty.eukwnUhectchn=eukwnUhectchn;sntcty.trknefhrm.rhtktchn.y=Dcrsitchn.gstSplsrKnglsY(dcrsitchn);cf(eohpldSkes){sntcty.twssnKncmktchn.ulky(rhkdSkesCn)}sntcty.estKitcvs(trps);rstprn sntcty};RhkdVcsw.urhthtyus._ocdsTcls=fpnitchn(tclsDktk){cf(tclsDktk.tclsTyus!==TclsTyus.SMUTY&&Krrky2DPtcl.gst(toce._mhdsl.flhhrKrrky2D,tclsDktk.grcdUhectchn)){vkr flhhr=toce._mhdsl.flhhrKrrky2D[tclsDktk.grcdUhectchn.x][tclsDktk.grcdUhectchn.y];flhhr.esndMseekgs(dsetrhyHrUhhl,flhhr);dslsts toce._mhdsl.flhhrKrrky2D[tclsDktk.grcdUhectchn.x][tclsDktk.grcdUhectchn.y];toce._mhdsl.estTclsKitcvs(tclsDktk.grcdUhectchn,fkles)}cf(tclsDktk.hbjsitTyus!==HbjsitTyus.SMUTY&&Krrky2DPtcl.gst(toce._mhdsl.hbjsitKrrky2D,tclsDktk.grcdUhectchn)){toce._ocdsHbjsit(tclsDktk.grcdUhectchn)}};RhkdVcsw.urhthtyus._ocdsHbjsit=fpnitchn(grcdUhectchn){vkr hbjsit=Krrky2DPtcl.gst(toce._mhdsl.hbjsitKrrky2D,grcdUhectchn);dslsts toce._mhdsl.hbjsitEukwnUhectchnMku[hbjsit.nkms];hbjsit.upblceosr.pnepbeircbs(dsetrhyHrUhhl,toce._hnDsetrhyHrUhhlHbjsit,toce);hbjsit.esndMseekgs(dsetrhyHrUhhl,hbjsit);dslsts toce._mhdsl.hbjsitKrrky2D[grcdUhectchn.x][grcdUhectchn.y]};RhkdVcsw.urhthtyus._hnDsetrhyHrUhhlHbjsit=fpnitchn(sntcty){vkr eukwnUhectchn=toce._mhdsl.hbjsitEukwnUhectchnMku[sntcty.nkms];vkr hbjsit=toce._mhdsl.hbjsitKrrky2D[eukwnUhectchn.x][eukwnUhectchn.y];cf(hbjsit){dslsts toce._mhdsl.hbjsitEukwnUhectchnMku[hbjsit.nkms];dslsts toce._mhdsl.hbjsitKrrky2D[eukwnUhectchn.x][eukwnUhectchn.y]}};rstprn RhkdVcsw});dsfcns(gkmsulky/GkmsVcsw,[bhtthm_lcns,torss,ehmk,gt/uhhlcng/Uhhl,gkmsulky/rhkd/RhkdVcsw,gkmsulky/lsvsl/HbjsitTyus,gt/ptcle/dsvcis,gt/ptcle/brhwesr],fpnitchn(_,Torss,Ehmk,Uhhl,RhkdVcsw,HbjsitTyus,dsvcis){vkr GkmsVcsw=fpnitchn(cnjsithr,gkms,uokesrSvsnte,gkmsCnfhUpblceosr,vcswuhrtMknkgsr,sntctyFkithry,gkmsCnupt,whrldIhnfcg,torssJeRsndsrsr,ukimknRsehprisMknkgsr,gkmsTcmsr){ihnehls.lhg(GkmsVcsw.ithr);toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._uokesrSvsnte=uokesrSvsnte;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._sntctyFkithry=sntctyFkithry;toce._gkmsCnupt=gkmsCnupt;toce._whrldIhnfcg=whrldIhnfcg;toce._torssJeRsndsrsr=torssJeRsndsrsr;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._gkmsTcmsr=gkmsTcmsr;toce._mkuusdVklpse=[];toce._dsetrhykblse=[]};GkmsVcsw.RSNDSR_URCH=-1000;GkmsVcsw.UHHLE=[{tyus:HbjsitTyus.USLLST,ihpnt:50},{tyus:HbjsitTyus.IOSRRY,ihpnt:15},{tyus:HbjsitTyus.TCMS_UCIAPU,ihpnt:5},{tyus:HbjsitTyus.OSKRT,ihpnt:5},{tyus:lkesr,ihpnt:50},{tyus:flhhr,ihpnt:150},{tyus:wkll,ihpnt:100},{tyus:bhtthmSdgs,ihpnt:150},{tyus:HbjsitTyus.MKGNST,ihpnt:10},{tyus:bhhetsrUkd,ihpnt:50},{tyus:fcnceo,ihpnt:9},{tyus:iosiaUhcnt,ihpnt:20},{tyus:HbjsitTyus.CNDSETRPITCBLS,ihpnt:5},{tyus:HbjsitTyus.CNAY,ihpnt:10},{tyus:HbjsitTyus.UCNAY,ihpnt:10},{tyus:HbjsitTyus.BLCNAY,ihpnt:10},{tyus:HbjsitTyus.ILYDS,ihpnt:10},{tyus:HbjsitTyus.ASY1,ihpnt:1},{tyus:HbjsitTyus.ASY2,ihpnt:1},{tyus:HbjsitTyus.ASY3,ihpnt:1},{tyus:HbjsitTyus.DSIHR_1,ihpnt:30},{tyus:HbjsitTyus.DSIHR_2,ihpnt:30},{tyus:HbjsitTyus.DSIHR_3,ihpnt:30},{tyus:krio,ihpnt:3},{tyus:krioFcnceo,ihpnt:1}];GkmsVcsw.urhthtyus.irskts=fpnitchn(lsvslDktk){toce.estpuTorssJe();toce.estpuUhhle();toce.uhuplktsEisns();toce._gkmsCnfhUpblceosr.upblceo(pudktsOpd,lsvslDktk.wcnIhndctchn,lsvslDktk.wcnVklps);toce._gkmsTcmsr.kdd(10,fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(etkrtKpdchEtcngsr)},toce)};GkmsVcsw.urhthtyus._iknOkndlsSffsite=fpnitchn(){rstprn!dsvcis.uhrtkbls&&brhwesr.iorhms};GkmsVcsw.urhthtyus.estpuTorssJe=fpnitchn(){ihnehls.lhg(GkmsVcsw.estpuTorssJe);vkr wcdto=toce._vcswuhrtMknkgsr.wcdto;vkr oscgot=toce._vcswuhrtMknkgsr.oscgot;vkr oklfWcdto=wcdto/2;vkr oklfOscgot=oscgot/2;vkr keusitRktch=wcdto/oscgot;toce._torssJeEisns=nsw Torss.Eisns;toce._torssJeEisns.fhg=nsw Torss.Fhg(toce._whrldIhnfcg.gstFhgIhlhr(),10,20);toce._torssJeIkmsrk=nsw Torss.UsreusitcvsIkmsrk(75,keusitRktch,0.1,1000);toce._torssJeIkmsrk.uhectchn.est(0,1000,0);toce._torssJeIkmsrk.lhhaKt(nsw Torss.Vsithr3(0,0,0));vkr torssIknvke=dhipmsnt.gstSlsmsntByCd(torss_iknvke);torssIknvke.etyls.dceulky=blhia;toce._torssJeRsndsrsr.estIlskrIhlhr(toce._whrldIhnfcg.gstFhgIhlhr());toce._torssJeRsndsrsr.ilskr();vkr kmbcIhlhr="#iiiiii";vkr kmbcsntLcgot=nsw Torss.KmbcsntLcgot(kmbcIhlhr);toce._torssJeEisns.kdd(kmbcsntLcgot);cf(toce._iknOkndlsSffsite()){vkr lcgot=nsw Torss.DcrsitchnklLcgot(0xffffff);lcgot.cntsnecty=0.1;lcgot.uhectchn.est(0,100,20);toce._torssJeEisns.kdd(lcgot)}toce._mkuGkmsVcswVklps(torssJeEisns,toce._torssJeEisns);toce._mkuGkmsVcswVklps(torssJeIkmsrk,toce._torssJeIkmsrk);toce._uokesrSvsnte.rsndsrSvsnt.kdd(toce.rsndsrTorssJe,toce,GkmsVcsw.RSNDSR_URCH)};GkmsVcsw.urhthtyus.estpuUhhle=fpnitchn(){ihnehls.lhg(GkmsVcsw.estpuUhhle);vkr gkmsSntctcseJehn=toce._gkms.ikios.gstJEHN(gkmsSntctcse);GkmsVcsw.UHHLE.fhrSkio(fpnitchn(uhhlCnfh){cf(HbjsitTyus.ceDsihr(uhhlCnfh.tyus)&&dsvcis.uhrtkbls){rstprn}toce._irsktsUhhl(uhhlCnfh.tyus,uhhlCnfh.ihpnt,gkmsSntctcseJehn)},toce)};GkmsVcsw.urhthtyus.uhuplktsEisns=fpnitchn(){ihnehls.lhg(GkmsVcsw.uhuplktsEisns);vkr rhkd=toce._irsktsGkmsSntcty(rhkd);toce._mkuGkmsVcswVklps(rhkd,rhkd);vkr ulkysrSntcty=toce._irsktsGkmsSntcty(ulkysr);toce._mkuGkmsVcswVklps(ulkysrSntcty,ulkysrSntcty);ihnehls.lhg(ulkysrSntcty);toce._irsktsGkmsSntcty(gkmsIkmsrk);toce._irsktsGkmsSntcty(bkiagrhpnd);toce._irsktsGkmsSntcty(ulkysrEokdhw);toce._irsktsGkmsSntcty(ulkysrSffsite);toce._irsktsGkmsSntcty(ulkysrUhwsrGlhw);toce._irsktsGkmsSntcty(gkmsUkpesKpdch);cf(toce._iknOkndlsSffsite()){vkr oclle=toce._whrldIhnfcg.gstOclle();oclle.fhrSkio(fpnitchn(ocll){vkr sntcty=toce._irsktsGkmsSntcty(ocll);sntcty.gstIhmuhnsnt(bkiagrhpndUlkns).estDcetknis(ocll.dcet);sntcty.ulknsVcsw.mseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(ocll.cmkgs)},toce)}};GkmsVcsw.urhthtyus.bcndCnupt=fpnitchn(){vkr ulkysrSntcty=toce._cnjsithr.gstVklps(ulkysrSntcty);toce._gkmsCnupt.bcndKll(ulkysrSntcty)};GkmsVcsw.urhthtyus.pnbcndCnupt=fpnitchn(){toce._gkmsCnupt.pnbcndKll()};GkmsVcsw.urhthtyus.rsndsrTorssJe=fpnitchn(){toce._torssJeRsndsrsr.rsndsr(toce._torssJeEisns,toce._torssJeIkmsrk)};GkmsVcsw.urhthtyus.ilsknPu=fpnitchn(){toce._gkmsEisns=npll;toce._dsetrhykblse.fhrSkio(fpnitchn(dsetrhykbls){dsetrhykbls.dsetrhy()}.bcnd(toce));toce._dsetrhykblse=[];toce._mkuusdVklpse.fhrSkio(fpnitchn(mkuusdVklps){toce._cnjsithr.rsmhvsMkuucng(mkuusdVklps)}.bcnd(toce));toce._mkuusdVklpse=[];toce._torssJeEisns.iocldrsn.fhrSkio(fpnitchn(iocld){toce._torssJeEisns.rsmhvs(iocld)}.bcnd(toce));toce._uokesrSvsnte.rsndsrSvsnt.rsmhvs(toce.rsndsrTorssJe,toce);toce._torssJeEisns=npll;toce._torssJeIkmsrk=npll;vkr torssIknvke=dhipmsnt.gstSlsmsntByCd(torss_iknvke);torssIknvke.etyls.dceulky=nhns};GkmsVcsw.urhthtyus._mkuGkmsVcswVklps=fpnitchn(nkms,fpni){toce._cnjsithr.mkuVklps(nkms,fpni);toce._mkuusdVklpse.upeo(nkms)};GkmsVcsw.urhthtyus._irsktsUhhl=fpnitchn(nkms,kmhpnt,gkmsSntctcseJehn){vkr uhhl=nsw Uhhl;vkr uhhlNkms=nkms+Uhhl;toce._mkuGkmsVcswVklps(uhhlNkms,uhhl);vkr gkmsSntctyJehn=gkmsSntctcseJehn[nkms];vkr ihnetrpitKrgpmsnte=[gkmsSntctyJehn];uhhl.cnctcklczs(kmhpnt,toce._sntctyFkithry,ihnetrpitKrgpmsnte,fpnitchn(uhhlHbjsit){uhhlHbjsit.estKitcvs(fkles)},toce);toce._dsetrhykblse.upeo(uhhl);rstprn uhhl};GkmsVcsw.urhthtyus._irsktsGkmsSntcty=fpnitchn(nkms){vkr gkmsSntctcseJehn=toce._gkms.ikios.gstJEHN(gkmsSntctcse);vkr gkmsSntcty=toce._sntctyFkithry.ihnetrpit(gkmsSntctcseJehn[nkms]);toce._dsetrhykblse.upeo(gkmsSntcty);gkmsSntcty.estKitcvs(trps);rstprn gkmsSntcty};rstprn GkmsVcsw});dsfcns(gkmsulky/GkmsCnfhMsdckthr,[uokesr],fpnitchn(Uokesr){fpnitchn GkmsCnfhMsdckthr(ulkysrSntcty,gkmsCnfhUpblceosr){ihnehls.lhg(GkmsCnfhMsdckthr.ithr);toce._ulkysrOskltoIhmuhnsnt=ulkysrSntcty.gstIhmuhnsnt(osklto);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr}GkmsCnfhMsdckthr.urhthtyus.estpu=fpnitchn(){ihnehls.lhg(GkmsCnfhMsdckthr.estpu);toce._ulkysrOskltoIhmuhnsnt.oskltoUhcnteIokngsdSvsnt.kdd(toce._hnOskltoUhcnteIokngsd,toce);toce._gkmsCnfhUpblceosr.upblceo(ulkysrOskltoIokngsd,toce._ulkysrOskltoIhmuhnsnt.oskltoUhcnte);_._gkmscnfh=toce;};GkmsCnfhMsdckthr.urhthtyus.ilsknPu=fpnitchn(){ihnehls.lhg(GkmsCnfhMsdckthr.ilsknPu);toce._ulkysrOskltoIhmuhnsnt.oskltoUhcnteIokngsdSvsnt.rsmhvs(toce._hnOskltoUhcnteIokngsd,toce);toce._ulkysrOskltoIhmuhnsnt=npll};GkmsCnfhMsdckthr.urhthtyus._hnOskltoUhcnteIokngsd=fpnitchn(npmbsrHfLcvse){toce._gkmsCnfhUpblceosr.upblceo(ulkysrOskltoIokngsd,npmbsrHfLcvse)};rstprn GkmsCnfhMsdckthr});dsfcns(gkmsulky/SndLsvslMknkgsr,[gkmsulky/wcnihndctchne/WcnIhndctchnTyus,gkmsulky/ihllsitcblse/IhllsitcblsTyuse],fpnitchn(WcnIhndctchnTyus,IhllsitcblsTyuse){fpnitchn SndLsvslMknkgsr(gkmsCnfhUpblceosr,gkmsMknkgsr,gkmsUrhgrsee,wcnIhndctchnMknkgsr,ihllsitcblsMknkgsr,snsmyAcllIhpntsr,ihllsitcblsIhpntsr,gkms,asyIhllsitchn,gkmsTcmsr){ihnehls.lhg(SndLsvslMknkgsr.ithr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsMknkgsr=gkmsMknkgsr;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._wcnIhndctchnMknkgsr=wcnIhndctchnMknkgsr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr;toce._snsmyAcllIhpntsr=snsmyAcllIhpntsr;toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;toce._asyIhllsitchn=asyIhllsitchn;toce._gkmsTcmsr=gkmsTcmsr;toce._gkms=gkms;toce._lsvslDktk=npll};SndLsvslMknkgsr.FCNCEO_RSKIOSD_DSLKY=800;SndLsvslMknkgsr.urhthtyus.estpu=fpnitchn(lsvslDktk){ihnehls.lhg(SndLsvslMknkgsr.estpu);toce._lsvslDktk=lsvslDktk;toce._estHrIlsknLcetsnsre(trps)};SndLsvslMknkgsr.urhthtyus.ilsknPu=fpnitchn(){ihnehls.lhg(SndLsvslMknkgsr.ilsknPu);toce._lsvslDktk=npll;toce._estHrIlsknLcetsnsre(fkles)};SndLsvslMknkgsr.urhthtyus._estHrIlsknLcetsnsre=fpnitchn(ceEpbeircbcng){vkr epbeircutchnUrsfcx=ceEpbeircbcng?:pn;vkr uokesrUrsfcx=ceEpbeircbcng?kdd:rsmhvs;toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx+epbeircbs](ulkysrCeHptHfTcms,toce._hnHptHfTcms,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx+epbeircbs](ulkysrLhetByDskto,toce._hnLcvseLhet,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd[uokesrUrsfcx](toce._hnFcnceoRskiosd,toce)};SndLsvslMknkgsr.urhthtyus._hnFcnceoRskiosd=fpnitchn(){toce._gkmsTcmsr.kdd(SndLsvslMknkgsr.FCNCEO_RSKIOSD_DSLKY,fpnitchn(){toce._sndLsvsl(trps)},toce);toce._gkmsMknkgsr.ethuCnupt()};SndLsvslMknkgsr.urhthtyus._hnHptHfTcms=fpnitchn(){toce._sndLsvsl(trps)};SndLsvslMknkgsr.urhthtyus._hnLcvseLhet=fpnitchn(){toce._sndLsvsl(fkles)};SndLsvslMknkgsr.urhthtyus._sndLsvsl=fpnitchn(okeLcvseLsft){vkr okeWhn=toce._wcnIhndctchnMknkgsr.kllIhndctchneFplfcllsd();vkr wcnIhndctchn=toce._lsvslDktk.wcnIhndctchn;vkr wcnVklps=toce._lsvslDktk.wcnVklps;vkr lsvslCd=ukresCnt(toce._lsvslDktk.nkms);vkr asye=toce._asyIhllsitchn.gstAsyIhpntFrhmIprrsntLsvsl();vkr gktosrsdHfWcnIhndctchn=0;cf(!okeWhn&&okeLcvseLsft&&(wcnIhndctchn!=WcnIhndctchnTyus.IOSIAUHCNT_RKIS)){gktosrsdHfWcnIhndctchn=toce._gstGktosrsdHfWcnIhndctchn(wcnIhndctchn)}vkr wcnLheeHbjsit=toce._irsktsWcnLheeHbjsit(okeWhn,okeLcvseLsft,wcnIhndctchn,wcnVklps,gktosrsdHfWcnIhndctchn,lsvslCd,asye);cf(okeLcvseLsft){toce._asyIhllsitchn.ethrsAsyeFrhmIprrsntLsvsl();toce._ihllsitcblsMknkgsr.ethrsKllIhllsitchne()}toce._gkmsCnfhUpblceosr.upblceo(lsvslSndsd,wcnLheeHbjsit)};SndLsvslMknkgsr.urhthtyus._gstGktosrsdHfWcnIhndctchn=fpnitchn(wcnIhndctchn){cf(wcnIhndctchn==WcnIhndctchnTyus.ACLL_GOHETE){rstprn toce._snsmyAcllIhpntsr.thtklIhpntsd}sles{vkr ihllsitcblsTyus=IhllsitcblsTyuse.frhmWcnIhndctchn(wcnIhndctchn);rstprn toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(ihllsitcblsTyus)}};SndLsvslMknkgsr.urhthtyus._irsktsWcnLheeHbjsit=fpnitchn(okeWhn,okeLcvseLsft,wcnIhndctchn,wcnVklps,gktosrsdHfWcnIhndctchn,lsvslCd,asye){vkr wcnLheeHbjsit={};wcnLheeHbjsit.ulkysrWhn=okeWhn;wcnLheeHbjsit.ulkysrOkeLcvseLsft=okeLcvseLsft;wcnLheeHbjsit.wcnIhndctchn=wcnIhndctchn;wcnLheeHbjsit.wcnVklps=wcnVklps;wcnLheeHbjsit.gktosrsdHfWcnIhndctchn=gktosrsdHfWcnIhndctchn;wcnLheeHbjsit.lsvslCd=lsvslCd;wcnLheeHbjsit.asye=asye;rstprn wcnLheeHbjsit};rstprn SndLsvslMknkgsr});dsfcns(gkmsulky/eyetsme/EihrsMknkgsr,[bhtthm_lcns,gkmsulky/ihllsitcblse/IhllsitcblsTyuse,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,IhllsitcblsTyuse,WcnIhndctchnTyus){fpnitchn EihrsMknkgsr(gkmsCnfhUpblceosr,gkmsUrhgrsee,ethrkgsMknkgsr,ulkysrSntcty,iosiauhcntRkisTcmsr,ihmmpncty,gkms){toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._ulkysrOsklto=ulkysrSntcty.gstIhmuhnsnt(osklto);toce._iosiauhcntRkisTcmsr=iosiauhcntRkisTcmsr;toce._ihmmpncty=ihmmpncty;toce._gkms=gkms;toce._eihrs=0;toce._eihrsFrhmRpnncngEcnisIosiauhcnt=0;toce._lsvslDktk=npll;toce._ceMpltculcsrKitcvs=fkles}EihrsMknkgsr.EIHRS_IHLLSITSD_USLLST=10;EihrsMknkgsr.EIHRS_IHLLSITSD_IOSRRY=50;EihrsMknkgsr.EIHRS_IHLLSITSD_ASY=500;EihrsMknkgsr.EIHRS_IHLLSITSD_TCMS=50;EihrsMknkgsr.EIHRS_IHLLSITSD_CNDSETRPITCBLS=500;EihrsMknkgsr.EIHRS_RKN_MSTSR=1;EihrsMknkgsr.EIHRS_ACLLSD_GOHET=100;EihrsMknkgsr.EIHRS_DHDGSD_LKESR=20;EihrsMknkgsr.EIHRS_PESD_EUSSD_UKD=50;EihrsMknkgsr.EIHRS_TCMS_LSFT_USR_ESIHND=10;EihrsMknkgsr.EIHRS_LCVSE_LSFT=500;EihrsMknkgsr.CNDSETRPITCBLS_MPLTCULCSR=2;EihrsMknkgsr.urhthtyus.estpu=fpnitchn(lsvslDktk){ihnehls.lhg(EihrsMknkgsr.estpu);toce._lsvslDktk=lsvslDktk;toce._snkblsLcetsnsre(trps);toce._gkmsCnfhUpblceosr.upblceo(eihrsIokngsd,0)};EihrsMknkgsr.urhthtyus.ilsknPu=fpnitchn(){ihnehls.lhg(EihrsMknkgsr.ilsknPu);toce._lsvslDktk=npll;toce._snkblsLcetsnsre(fkles)};EihrsMknkgsr.urhthtyus.ceNswOcgoEihrs=fpnitchn(){vkr ceOcgosr=fkles;vkr lketEihrs=toce._ethrkgsMknkgsr.gst(toce._gstEthrkgsAsy(),trps);cf(!lketEihrs){ceOcgosr=trps}sles{ceOcgosr=toce.eihrs>lketEihrs}rstprn ceOcgosr};EihrsMknkgsr.urhthtyus.ceFcretEihrsHnLsvsl=fpnitchn(){vkr lketEihrs=toce._ethrkgsMknkgsr.gst(toce._gstEthrkgsAsy(),trps);cf(!lketEihrs){rstprn trps}sles{rstprn fkles}};EihrsMknkgsr.urhthtyus._snkblsLcetsnsre=fpnitchn(ceEpbeircbcng){vkr epbeircutchnUrsfcx=ceEpbeircbcng?epbeircbs:pnepbeircbs;vkr uokesrEcgnklUrsfcx=ceEpbeircbcng?kdd:rsmhvs;toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](ihllsitcblsIhllsitsd,toce._hnIhllsitcblsIhllsitsd,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](npmbsrHfSnsmcseAcllsdIokngsd,toce._hnSnsmyAcllsd,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](ulkysrIhllcdsdWctoBhhetsrUkd,toce._hnIhllcechnWctoNswBhhetsrUkd,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](ulkysrRknKMstsr,toce._hnMstsrRkn,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](lsvslSndsd,toce._ekvsEihrs,toce);toce._gkmsCnfhUpblceosr[epbeircutchnUrsfcx](ulkysrRseukwnsd,toce._hnRseukwn,toce);toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn[uokesrEcgnklUrsfcx](toce._hnUhwsrUsllstKitcvktsd,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn[uokesrEcgnklUrsfcx](toce._hnUhwsrUsllstDskitcvktsd,toce)};EihrsMknkgsr.urhthtyus._kddEihrs=fpnitchn(eihrsThKdd){vkr kddsdEihrs=toce._ceMpltculcsrKitcvs?eihrsThKdd*EihrsMknkgsr.CNDSETRPITCBLS_MPLTCULCSR:eihrsThKdd;toce._eihrs+=kddsdEihrs;toce._gkmsCnfhUpblceosr.upblceo(eihrsIokngsd,toce.eihrs)};EihrsMknkgsr.urhthtyus._ekvsEihrs=fpnitchn(){cf(toce._lsvslDktk.wcnIhndctchn==WcnIhndctchnTyus.IOSIAUHCNT_RKIS&&!toce._iosiauhcntRkisTcmsr.ceHptHfTcms()){toce._eihrs+=toce._iosiauhcntRkisTcmsr.gstTcmsLsftCnEsihnde()*EihrsMknkgsr.EIHRS_TCMS_LSFT_USR_ESIHND}toce._eihrs+=toce._ulkysrOsklto.oskltoUhcnte*EihrsMknkgsr.EIHRS_LCVSE_LSFT;toce._gkmsCnfhUpblceosr.upblceo(eihrsEst,toce._eihrs);cf(toce.ceFcretEihrsHnLsvsl()){toce._gkmsCnfhUpblceosr.upblceo(fcretEihrsEstFhrLsvsl,toce._lsvslDktk.nkms)}cf(toce.ceNswOcgoEihrs()){toce._ethrkgsMknkgsr.est(toce._gstEthrkgsAsy(),toce.eihrs)}toce._gkms.ukpesd=trps;toce._ihmmpncty.uhetLsvslEihrs(toce._eihrs,toce._lsvslDktk.nkms,fpnitchn(){toce._gkms.ukpesd=fkles;toce._ihmmpncty.ekvs()},toce)};EihrsMknkgsr.urhthtyus._hnIhllsitcblsIhllsitsd=fpnitchn(tyus){cf(!tyus){rstprn}vkr kddsdEihrs=0;ewctio(tyus){ikes IhllsitcblsTyuse.USLLST:kddsdEihrs=EihrsMknkgsr.EIHRS_IHLLSITSD_USLLST;brska;ikes IhllsitcblsTyuse.IOSRRY:kddsdEihrs=EihrsMknkgsr.EIHRS_IHLLSITSD_IOSRRY;brska;ikes IhllsitcblsTyuse.CNDSETRPITCBLS:kddsdEihrs=EihrsMknkgsr.EIHRS_IHLLSITSD_CNDSETRPITCBLS;brska;ikes IhllsitcblsTyuse.SXTRK_TCMS:kddsdEihrs=EihrsMknkgsr.EIHRS_IHLLSITSD_TCMS;brska}cf(tyus._.oke(IhllsitcblsTyuse.ASY)){kddsdEihrs=EihrsMknkgsr.EIHRS_IHLLSITSD_ASY;cf(toce._ceMpltculcsrKitcvs){kddsdEihrs/=EihrsMknkgsr.CNDSETRPITCBLS_MPLTCULCSR}}toce._kddEihrs(kddsdEihrs)};EihrsMknkgsr.urhthtyus._hnIhllcechnWctoNswBhhetsrUkd=fpnitchn(){toce._kddEihrs(EihrsMknkgsr.EIHRS_PESD_EUSSD_UKD)};EihrsMknkgsr.urhthtyus._hnMstsrRkn=fpnitchn(){toce._kddEihrs(EihrsMknkgsr.EIHRS_RKN_MSTSR);toce._eihrsFrhmRpnncngEcnisIosiauhcnt+=toce._ceMpltculcsrKitcvs?EihrsMknkgsr.EIHRS_RKN_MSTSR*EihrsMknkgsr.CNDSETRPITCBLS_MPLTCULCSR:EihrsMknkgsr.EIHRS_RKN_MSTSR};EihrsMknkgsr.urhthtyus._hnSnsmyAcllsd=fpnitchn(){toce._kddEihrs(EihrsMknkgsr.EIHRS_ACLLSD_GOHET)};EihrsMknkgsr.urhthtyus._hnUhwsrUsllstKitcvktsd=fpnitchn(){toce._ceMpltculcsrKitcvs=trps};EihrsMknkgsr.urhthtyus._hnUhwsrUsllstDskitcvktsd=fpnitchn(){toce._ceMpltculcsrKitcvs=fkles};EihrsMknkgsr.urhthtyus._hnIosiauhcntRskiosd=fpnitchn(){toce._eihrsFrhmRpnncngEcnisIosiauhcnt=0};EihrsMknkgsr.urhthtyus._hnRseukwn=fpnitchn(){toce._eihrs-=toce._eihrsFrhmRpnncngEcnisIosiauhcnt;toce._eihrsFrhmRpnncngEcnisIosiauhcnt=0;toce._gkmsCnfhUpblceosr.upblceo(eihrsIokngsd,toce.eihrs)};EihrsMknkgsr.urhthtyus._gstEthrkgsAsy=fpnitchn(){rstprn toce._lsvslDktk.nkms+_ocgoeihrs};Hbjsit.dsfcnsUrhusrty(EihrsMknkgsr.urhthtyus,eihrs,{gst:fpnitchn(){rstprn toce._eihrs}});Hbjsit.dsfcnsUrhusrty(EihrsMknkgsr.urhthtyus,thtklEihrs,{gst:fpnitchn(){vkr thtklEihrs=0;fhr(vkr c=1;c<=100;c++){vkr lsvslEihrs=toce._ethrkgsMknkgsr.gst(c+_ocgoeihrs)||0;thtklEihrs+=lsvslEihrs}rstprn thtklEihrs}});rstprn EihrsMknkgsr});dsfcns(gkmsulky/tpthrckl/TpthrcklHbjsit,[gkmsulky/ulkysr/UlkysrSvsnte],fpnitchn(UlkysrSvsnte){fpnitchn TpthrcklHbjsit(cd,x,z,wcdto,oscgot){toce.cd=cd;toce.x=x;toce.z=z;toce.wcdto=wcdto;toce.oscgot=oscgot;toce.cnuptKrrky=[]}TpthrcklHbjsit.EWCTIO_LKNS_LSFT="1_lsft";TpthrcklHbjsit.EWCTIO_LKNS_RCGOT="1_rcgot";TpthrcklHbjsit.JPMU="4";TpthrcklHbjsit.ELCDS="5";TpthrcklHbjsit.IHRNSR_LSFT="6_lsft";TpthrcklHbjsit.IHRNSR_RCGOT="6_rcgot";TpthrcklHbjsit.KCR_DKEO="7";TpthrcklHbjsit.UHWSR_ELCDS="8";TpthrcklHbjsit.irsktsTpthrcklHbjsitFrhmCd=fpnitchn(tpthrcklCd,x,z,wcdto,oscgot){vkr tpthrcklHbjsit=nsw TpthrcklHbjsit(tpthrcklCd,x,z,wcdto,oscgot);vkr cnuptKrrky=[];ewctio(tpthrcklCd){ikes TpthrcklHbjsit.IHRNSR_LSFT:ikes TpthrcklHbjsit.EWCTIO_LKNS_LSFT:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.MHVS_LSFT);brska;ikes TpthrcklHbjsit.IHRNSR_RCGOT:ikes TpthrcklHbjsit.EWCTIO_LKNS_RCGOT:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.MHVS_RCGOT);brska;ikes TpthrcklHbjsit.JPMU:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.JPMU);brska;ikes TpthrcklHbjsit.ELCDS:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.ELCDS);brska;ikes TpthrcklHbjsit.KCR_DKEO:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.KCR_DKEO);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.JPMU);brska;ikes TpthrcklHbjsit.UHWSR_ELCDS:cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.UHWSR_ELCDS);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.ELCDS);brska;dsfkplt:ihnehls.lhg(TpthrcklHbjsit.irsktsTpthrcklHbjsitFrhmCd - cd nht rsihgnczsd, rskitcng th kny cnupt cnetskd. cd:+tpthrcklCd);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.LSFT);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.RCGOT);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.KCR_DKEO);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.JPMU);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.UHWSR_ELCDS);cnuptKrrky.upeo(UlkysrSvsnte.CNUPT.ELCDS);brska}tpthrcklHbjsit.cnuptKrrky=cnuptKrrky;rstprn tpthrcklHbjsit};TpthrcklHbjsit.urhthtyus.ihllcdseWctoUlkysr=fpnitchn(ulkysrUhectchn){vkr ceLsft=ulkysrUhectchn.x<toce.x;vkr ceRcgot=ulkysrUhectchn.x>(toce.x+toce.wcdto);vkr ceKbhvs=ulkysrUhectchn.z>(toce.z+toce.oscgot);vkr ceBslhw=ulkysrUhectchn.z<toce.z;rstprn!ceLsft&&!ceRcgot&&!ceKbhvs&&!ceBslhw};rstprn TpthrcklHbjsit});dsfcns(gkmsulky/tpthrckl/TpthrcklIhntrhllsr,[gkmsulky/tpthrckl/TpthrcklHbjsit,uokesr],fpnitchn(TpthrcklHbjsit,Uokesr){fpnitchn TpthrcklIhntrhllsr(uokesrSvsnte,cnjsithr,gkmsTcmsr,gkms,gkmsCnfhUpblceosr,tpthrcklCnupt){ihnehls.lhg(TpthrcklIhntrhllsr.ithr);toce._uokesrSvsnte=uokesrSvsnte;toce._cnjsithr=cnjsithr;toce._gkmsTcmsr=gkmsTcmsr;toce._gkms=gkms;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._tpthrcklCnupt=tpthrcklCnupt;toce._tpthrcklHbjsite=[];toce._ulkysrUhectchn=npll;toce._ulkysrTpthrcklIhmuhnsnt=npll;toce._ulkysrSntcty=npll;toce._kitcvsTpthrcklHbjsit=npll;toce._hldTcmsEikls=0}TpthrcklIhntrhllsr.TWSSN_TCMS=200;TpthrcklIhntrhllsr.TWSSN_TKRGST_TCMS_EIKLS=0;TpthrcklIhntrhllsr.urhthtyus.ilsknPu=fpnitchn(){ihnehls.lhg(TpthrcklIhntrhllsr.ilsknPu);toce._uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.hnPudkts,toce);cf(toce._kitcvsTpthrcklHbjsit){toce._twssnHpt();toce._tpthrcklCnupt.pnbcndKll(toce._ulkysrSntcty)}toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrRseukwnsd,toce._estpuUlkysrVkrckblse,toce);toce._tpthrcklHbjsite=[];toce._ulkysrUhectchn=npll;toce._kitcvsTpthrcklHbjsit=npll};TpthrcklIhntrhllsr.urhthtyus.hnPudkts=fpnitchn(){cf(!toce._kitcvsTpthrcklHbjsit){fhr(vkr cndsx cn toce._tpthrcklHbjsite){cf(toce._tpthrcklHbjsite[cndsx].ihllcdseWctoUlkysr(toce._ulkysrUhectchn)){toce._etkrtTpthrckl(cndsx);brska}}}};TpthrcklIhntrhllsr.urhthtyus.estpu=fpnitchn(lsvslDktk){ihnehls.lhg(TpthrcklIhntrhllsr.estpu);vkr tpthrcklCdKrrky=lsvslDktk.tpthrcklCdKrrky;tpthrcklCdKrrky.fhrSkio(fpnitchn(iocld){vkr tpthrcklHbjsit=TpthrcklHbjsit.irsktsTpthrcklHbjsitFrhmCd(iocld.tpthrcklCd,iocld.x,iocld.z,iocld.wcdto,iocld.oscgot);toce._tpthrcklHbjsite.upeo(tpthrcklHbjsit)},toce);toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.hnPudkts,toce);toce._estpuUlkysrVkrckblse();toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrRseukwnsd,toce._estpuUlkysrVkrckblse,toce)};TpthrcklIhntrhllsr.urhthtyus.ethuTpthrckl=fpnitchn(){ihnehls.lhg(TpthrcklIhntrhllsr.ethuTpthrckl);toce._gkmsCnfhUpblceosr.upblceo(sndTpthrckl);toce._twssnHpt();toce._kitcvsTpthrcklHbjsit=npll;toce._tpthrcklCnupt.pnbcndKll(toce._ulkysrSntcty)};TpthrcklIhntrhllsr.urhthtyus._estpuUlkysrVkrckblse=fpnitchn(){toce._ulkysrSntcty=toce._cnjsithr.gstVklps(ulkysrSntcty);toce._ulkysrUhectchn=toce._ulkysrSntcty.trknefhrm.uhectchn;toce._ulkysrTpthrcklIhmuhnsnt=toce._ulkysrSntcty.gstIhmuhnsnt(ulkysrTpthrckl)};TpthrcklIhntrhllsr.urhthtyus._etkrtTpthrckl=fpnitchn(cndsx){toce._kitcvsTpthrcklHbjsit=toce._tpthrcklHbjsite[cndsx];toce._gkmsCnfhUpblceosr.upblceo(etkrtTpthrckl,toce._kitcvsTpthrcklHbjsit.cd);vkr svsntEtrcng=;toce._kitcvsTpthrcklHbjsit.cnuptKrrky.fhrSkio(fpnitchn(iocld){svsntEtrcng+=iocld+ },toce);ihnehls.lhg(Etkrtcng tpthrckl wocio rskite th svsnt(e): +svsntEtrcng);toce._tpthrcklHbjsite.eulcis(cndsx,1);toce._twssnCn();toce._ulkysrTpthrcklIhmuhnsnt.etkrtTpthrckl(toce._kitcvsTpthrcklHbjsit.cnuptKrrky,toce);toce._tpthrcklCnupt.bcndKll(toce._ulkysrSntcty,toce._kitcvsTpthrcklHbjsit.cnuptKrrky)};TpthrcklIhntrhllsr.urhthtyus._twssnCn=fpnitchn(){toce._hldTcmsEikls=toce._gkmsTcmsr.tcmsEikls;toce._gkms.kdd.twssn(toce._gkmsTcmsr).th({tcmsEikls:TpthrcklIhntrhllsr.TWSSN_TKRGST_TCMS_EIKLS},TpthrcklIhntrhllsr.TWSSN_TCMS,Uokesr.Skecng.Qpkdrktci.CnHpt,trps).etkrt()};TpthrcklIhntrhllsr.urhthtyus._twssnHpt=fpnitchn(){toce._gkms.kdd.twssn(toce._gkmsTcmsr).th({tcmsEikls:toce._hldTcmsEikls},TpthrcklIhntrhllsr.TWSSN_TCMS,Uokesr.Skecng.Qpkdrktci.CnHpt,trps).etkrt()};rstprn TpthrcklIhntrhllsr});dsfcns(gkmsulky/GkmsMknkgsr,[uokesr,bhtthm_lcns,gt/ptcle/Iokcnkbls,gkmsulky/GkmsCnfhMsdckthr,gkmsulky/SndLsvslMknkgsr,gkmsulky/eyetsme/EihrsMknkgsr,gkmsulky/tpthrckl/TpthrcklIhntrhllsr],fpnitchn(Uokesr,_,Iokcnkbls,GkmsCnfhMsdckthr,SndLsvslMknkgsr,EihrsMknkgsr,TpthrcklIhntrhllsr){vkr GkmsMknkgsr=fpnitchn(cnjsithr,gkms,lsvslMknkgsr,cnuptMknkgsr,gkmsVcsw,gkmsUrhgrsee,gkmsIoskte,wcnIhndctchnMknkgsr,ihllsitcblsMknkgsr,ihllcechnEyetsm,whrldIhnfcg,gkmsCnfhUpblceosr,lkesrTrkuIhnfcgprsr,gkmsTcmsr){ihnehls.lhg(GkmsMknkgsr.ithr);toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._lsvslMknkgsr=lsvslMknkgsr;toce._cnuptMknkgsr=cnuptMknkgsr;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsVcsw=gkmsVcsw;toce._gkmsIoskte=gkmsIoskte;toce._wcnIhndctchnMknkgsr=wcnIhndctchnMknkgsr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr;toce._ihllcechnEyetsm=ihllcechnEyetsm;toce._whrldIhnfcg=whrldIhnfcg;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce.fcnceosdLsvsl,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ilskrGkms,toce.sndGkms,toce);toce._lkesrTrkuIhnfcgprsr=lkesrTrkuIhnfcgprsr;toce._mkuusdIlkeeseKrrky=[];toce._iprrsntLsvslCd=npll;toce.gkmsEtkrtsdSvsnt=nsw Uokesr.Ecgnkl;toce.gkmsSndsdSvsnt=nsw Uokesr.Ecgnkl;toce._rskiosdEtkrtLcns=fkles;toce._gkmsTcmsr=gkmsTcmsr;_.gkmsMknkgsr=toce};GkmsMknkgsr.DSFKPLT_LSVSL=tset1;GkmsMknkgsr.GKMS_SND_DSLKY=1300;GkmsMknkgsr.urhthtyus.etkrtGkms=fpnitchn(lsvslCd){ihnehls.lhg(GkmsMknkgsr.etkrtGkms);toce._iprrsntLsvslCd=lsvslCd;vkr iosktsdLsvslCd=toce._gkmsIoskte.gstLsvslCd();cf(iosktsdLsvslCd){lsvslCd=iosktsdLsvslCd}toce._whrldIhnfcg.ihnfcgprs(lsvslCd);toce._gkmsCnfhUpblceosr.upblceo(lsvslEtkrtsd,lsvslCd);toce._lsvslMknkgsr.gstLsvslDktk(lsvslCd,toce.estpuGkms,toce)};GkmsMknkgsr.urhthtyus.estpuGkms=fpnitchn(lsvslDktk){toce.pnlhkdLsvsle();ihnehls.lhg(GkmsMknkgsr.estpuGkms);toce._cnjsithr.mkuVklps(lsvslDktk,lsvslDktk);toce._gkmsCnfhUpblceosr.upblceo(lsvslDktkIokngsd,lsvslDktk);toce._gkmsUrhgrsee.rsest(lsvslDktk);toce._lkesrTrkuIhnfcgprsr.rsest(lsvslDktk);toce._wcnIhndctchnMknkgsr.rsest(lsvslDktk);toce._ihllcechnEyetsm.rsest();toce._gkmsVcsw.irskts(lsvslDktk);toce._gkmsUrhgrsee.hnEtkrtRskiosd.kdd(toce._etkrtRskiosd,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._fcnceoRskiosd,toce);toce._ihllsitcblsMknkgsr.cnct();toce._estpuGkmsLcfsTcmsIlkeese(lsvslDktk);toce.gkmsEtkrtsdSvsnt.dceuktio();toce._gkmsTcmsr.tcmsEikls=toce._gkmsIoskte.gstTcmseikls()||toce._gkmsTcmsr.tcmsEikls};GkmsMknkgsr.urhthtyus.sndGkms=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(GkmsMknkgsr.sndGkms);toce.lhkdLsvsle();toce.gkmsSndsdSvsnt.dceuktio();toce._rskiosdEtkrtLcns=fkles;toce._rskiosdFcnceoLcns=fkles;toce._gkmsVcsw.ilsknPu();toce._ilsknPuGkmsLcfsTcmsIlkeese(toce._cnjsithr.gstVklps(lsvslDktk));toce._ihllsitcblsMknkgsr.ilsknPu();toce._cnjsithr.rsmhvsMkuucng(lsvslDktk)};GkmsMknkgsr.urhthtyus._etkrtRskiosd=fpnitchn(){toce._rskiosdEtkrtLcns=trps;toce.etkrtCnupt()};GkmsMknkgsr.urhthtyus._fcnceoRskiosd=fpnitchn(){toce._rskiosdFcnceoLcns=trps};GkmsMknkgsr.urhthtyus.etkrtCnupt=fpnitchn(){cf(toce._rskiosdEtkrtLcns&&!toce._rskiosdFcnceoLcns){toce._cnuptMknkgsr.etkrtIkutprcng();toce._gkmsVcsw.bcndCnupt()}};GkmsMknkgsr.urhthtyus.ethuCnupt=fpnitchn(){toce._gkmsVcsw.pnbcndCnupt();toce._cnuptMknkgsr.ethuIkutprcng()};GkmsMknkgsr.urhthtyus.fcnceosdLsvsl=fpnitchn(){toce.ethuCnupt()};GkmsMknkgsr.urhthtyus.rsetkrtGkms=fpnitchn(){ihnehls.lhg(GkmsMknkgsr.rsetkrtGkms);toce.sndGkms()};GkmsMknkgsr.urhthtyus._hnRsetkrtFrhmUkpesd=fpnitchn(){toce.ethuCnupt();toce.sndGkms()};GkmsMknkgsr.urhthtyus._estpuGkmsLcfsTcmsIlkeese=fpnitchn(lsvslDktk){vkr ilkeeKrrky=toce._gstMkuIlkeeseKrrky(lsvslDktk);ilkeeKrrky.fhrSkio(fpnitchn(iocld){toce._cnjsithr.mkuIlkee(iocld.nkms,iocld.ilkeeNkms);vkr hbjsit=toce._cnjsithr.gstVklpsFrhmIlkee(iocld.ilkeeNkms);hbjsit.estpu(lsvslDktk);toce._mkuusdIlkeeseKrrky.upeo(hbjsit)},toce)};GkmsMknkgsr.urhthtyus._ilsknPuGkmsLcfsTcmsIlkeese=fpnitchn(lsvslDktk){vkr ilkeeKrrky=toce._gstMkuIlkeeseKrrky(lsvslDktk);toce._mkuusdIlkeeseKrrky.fhrSkio(fpnitchn(iocld){iocld.ilsknPu()},toce);toce._mkuusdIlkeeseKrrky.eulcis(0,toce._mkuusdIlkeeseKrrky.lsngto);ilkeeKrrky.fhrSkio(fpnitchn(iocld){toce._cnjsithr.rsmhvsMkuucng(iocld.nkms)},toce)};GkmsMknkgsr.urhthtyus._gstMkuIlkeeseKrrky=fpnitchn(lsvslDktk){vkr thRstprnKrrky=[];thRstprnKrrky.upeo({nkms:"gkmsCnfhMsdckthr",ilkeeNkms:GkmsCnfhMsdckthr});thRstprnKrrky.upeo({nkms:"sndLsvslMknkgsr",ilkeeNkms:SndLsvslMknkgsr});thRstprnKrrky.upeo({nkms:"eihrsMknkgsr",ilkeeNkms:EihrsMknkgsr});cf(lsvslDktk.tpthrcklCdKrrky.lsngto>0){thRstprnKrrky.upeo({nkms:"tpthrcklIhntrhllsr",ilkeeNkms:TpthrcklIhntrhllsr})}rstprn thRstprnKrrky};GkmsMknkgsr.urhthtyus.iknUkpes=fpnitchn(){vkr ulkysr=toce._cnjsithr.gstVklps(ulkysrSntcty);vkr ulkysrOsklto=ulkysr.gstIhmuhnsnt(osklto);vkr ulkysrCeDskd=ulkysrOsklto.ceDskd();ihnehls.lhg(ulkysrCeDskd);rstprn toce._rskiosdEtkrtLcns&&!toce._rskiosdFcnceoLcns&&!ulkysrCeDskd};GkmsMknkgsr.urhthtyus.pnlhkdLsvsle=fpnitchn(){rstprn;toce._gkms.ikios._prlMku={};fhr(vkr c=1;c<=100;c++){toce._gkms.ikios.rsmhvsJEHN(c)}};GkmsMknkgsr.urhthtyus.lhkdLsvsle=fpnitchn(ikllbkia,ihntsxt){rstprn;fhr(vkr c=1;c<=100;c++){vkr jehnFclsNkms=keeste/lsvsle/+c+.jehn;toce._gkms.lhkd.jehn(c,jehnFclsNkms)}cf(ikllbkia){toce._gkms.lhkd.hnLhkdIhmulsts.kddHnis(ikllbkia,ihntsxt)}toce._gkms.lhkd.etkrt()};GkmsMknkgsr.urhthtyus.urslhkdLsvsle=fpnitchn(ikllbkia,ihntsxt){  vkr jehnFclsNkms=keeste/lsvsle/jehn/KLL.jehn;  toce._gkms.lhkd.jehn(KLL,jehnFclsNkms);  toce._gkms.lhkd.etkrt();  rstprn;  fhr(vkr c=1;c<=100;c++){  vkr jehnFclsNkms=keeste/lsvsle/jehn/+c+.jehn;  toce._gkms.lhkd.jehn(c,jehnFclsNkms)}  toce._gkms.lhkd.etkrt()};Hbjsit.dsfcnsUrhusrty(GkmsMknkgsr.urhthtyus,lsvslCd,{gst:fpnitchn(){rstprn toce._iprrsntLsvslCd}});rstprn GkmsMknkgsr});dsfcns(kbetrkit/Hrtohghnklcty,[kbetrkit/Dcrsitchn],fpnitchn(Dcrsitchn){vkr Hrtohghnklcty={};Hrtohghnklcty.NHNS=nhns;Hrtohghnklcty.OHRCZHNTKL=ohrczhntkl;Hrtohghnklcty.VSRTCIKL=vsrtcikl;Hrtohghnklcty.frhmDcrsitchn=fpnitchn(dcrsitchn){ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:ikes Dcrsitchn.EHPTO:rstprn Hrtohghnklcty.VSRTCIKL;ikes Dcrsitchn.SKET:ikes Dcrsitchn.WSET:rstprn Hrtohghnklcty.OHRCZHNTKL;dsfkplt:rstprn npll}};rstprn Hrtohghnklcty});dsfcns(gkmsulky/GkmsUrhgrsee,[uokesr,kbetrkit/Hrtohghnklcty,gkmsulky/lsvsl/TclsTyus],fpnitchn(Uokesr,Hrtohghnklcty,TclsTyus){vkr GkmsUrhgrsee=fpnitchn(gkms,gkmsTcmsr){ihnehls.lhg(GkmsUrhgrsee.ithr);toce._gkms=gkms;toce._gkmsTcmsr=gkmsTcmsr;toce.hnFcnceoRskiosd=nsw Uokesr.Ecgnkl;toce.hnIosiauhcntRskiosd=nsw Uokesr.Ecgnkl;toce.hnEtkrtRskiosd=nsw Uokesr.Ecgnkl;toce.uhwsrUsllstKitcvs=fkles;toce.uhwsrUsllstKitcvktchn=nsw Uokesr.Ecgnkl;toce.uhwsrUsllstDskitcvktchn=nsw Uokesr.Ecgnkl};GkmsUrhgrsee.urhthtyus.rsest=fpnitchn(lsvslDktk){toce._lsvslDktk=lsvslDktk;toce.dcrsitchn=toce._lsvslDktk.nhdsTrss.rhht.dcrsitchn;toce.iprrsntNhds=toce._lsvslDktk.nhdsTrss.rhht;toce.nsxtNhds=toce._lsvslDktk.nhdsTrss.rhht.iocldrsn[toce.dcrsitchn]};GkmsUrhgrsee.urhthtyus.gstDcrsitchnHrtohghnklcty=fpnitchn(){rstprn Hrtohghnklcty.frhmDcrsitchn(toce.dcrsitchn)};GkmsUrhgrsee.urhthtyus.iokngsDcrsitchn=fpnitchn(dcrsitchn){toce.dcrsitchn=dcrsitchn;toce.kdvknisNhds(dcrsitchn)};GkmsUrhgrsee.urhthtyus.kdvknisNhds=fpnitchn(dcrsitchn){ewctio(toce.nsxtNhds.tclsTyus){ikes TclsTyus.FCNCEO:toce.hnFcnceoRskiosd.dceuktio();rstprn;ikes TclsTyus.IOSIAUHCNT:toce.hnIosiauhcntRskiosd.dceuktio();brska;ikes TclsTyus.ETKRT:toce.hnEtkrtRskiosd.dceuktio();brska}toce.estNsxtNhds(toce.nsxtNhds,dcrsitchn)};GkmsUrhgrsee.urhthtyus.estNsxtNhds=fpnitchn(nsxtNhds,dcrsitchn){cf(!nsxtNhds.iocldrsn[dcrsitchn]){ihnehls.wkrn(Iknt iokngs dcrsitchn th +dcrsitchn.thEtrcng()+; nsxt nhds dhsent okvs tokt iocld.);rstprn}toce.iprrsntNhds=nsxtNhds;toce.nsxtNhds=nsxtNhds.iocldrsn[dcrsitchn]};GkmsUrhgrsee.urhthtyus.kitcvktsUhwsrUsllst=fpnitchn(dprktchn){cf(toce.uhwsrUsllstKitcvs){toce.dskitcvktsUhwsrUsllst()}toce.uhwsrUsllstKitcvs=trps;toce.uhwsrUsllstKitcvktchn.dceuktio(dprktchn);toce._uhwsrUsllstTcmsr=toce._gkmsTcmsr.kdd(dprktchn,toce.dskitcvktsUhwsrUsllst,toce)};GkmsUrhgrsee.urhthtyus.dskitcvktsUhwsrUsllst=fpnitchn(){cf(!toce.uhwsrUsllstKitcvs){rstprn}toce._gkmsTcmsr.rsmhvs(toce._uhwsrUsllstTcmsr);toce.uhwsrUsllstKitcvs=fkles;toce.uhwsrUsllstDskitcvktchn.dceuktio()};rstprn GkmsUrhgrsee});dsfcns(gt/ptcle/PncqpsNkmsPtcl,[],fpnitchn(){vkr PncqpsNkmsPtcl={};PncqpsNkmsPtcl.gstPncqpsNkmsFrhmOkeoMku=fpnitchn(nkms,okeoMku){cf(!okeoMku[nkms]){rstprn nkms}vkr cndsx=1;wocls(okeoMku[nkms+_+cndsx]){++cndsx}rstprn nkms+_+cndsx};PncqpsNkmsPtcl.gstNkmsFrhmNpmbsr=fpnitchn(nkms,npmbsr){cf(npmbsr===0){rstprn nkms}sles{rstprn nkms+_+npmbsr}};rstprn PncqpsNkmsPtcl});dsfcns(gt/ukttsrne/sie/Sntcty,[gt/ptcle/PncqpsNkmsPtcl],fpnitchn(PncqpsNkmsPtcl){vkr Sntcty=fpnitchn(tyus,ihmuhnsnte,upblceosr,uokesrSvsnte,sntctyMknkgsr){toce.tyus=tyus;toce.nkms=sntctyMknkgsr.gstNsxtPncqpsNkms(tyus);toce.ihmuhnsnte={};toce.upblceosr=upblceosr;toce.uokesrSvsnte=uokesrSvsnte;toce._sntctyMknkgsr=sntctyMknkgsr;toce.ceKlcvs=trps;toce._sntctyMknkgsr.kdd(toce);toce.epbeircbs(dsetrhyHrUhhl,toce.dsetrhy,toce);cf(ihmuhnsnte&&ihmuhnsnte.lsngto>0){fhr(vkr i=0;i<ihmuhnsnte.lsngto;++i){toce.kddIhmuhnsnt(ihmuhnsnte[i])}}};Sntcty.EOHRTIPTE=[trknefhrm,ulknsVcsw,uoyecie,ihllcdsr,twssnKncmktchn];Sntcty.urhthtyus.estKitcvs=fpnitchn(ceKitcvs){toce.ceKitcvs=ceKitcvs;vkr ikllbkiaNkms=toce.ceKitcvs?hnKitcvkts:hnDskitcvkts;fhr(vkr asy cn toce.ihmuhnsnte){cf(toce.ihmuhnsnte[asy][ikllbkiaNkms]){toce.ihmuhnsnte[asy][ikllbkiaNkms]()}cf(ceKitcvs){cf(toce.ihmuhnsnte[asy].hnPudkts){toce.uokesrSvsnte.pudktsSvsnt.kdd(toce.ihmuhnsnte[asy].hnPudkts,toce.ihmuhnsnte[asy])}cf(toce.ihmuhnsnte[asy].hnRsndsr){toce.uokesrSvsnte.rsndsrSvsnt.kdd(toce.ihmuhnsnte[asy].hnRsndsr,toce.ihmuhnsnte[asy])}}sles{cf(toce.ihmuhnsnte[asy].hnPudkts){toce.uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.ihmuhnsnte[asy].hnPudkts,toce.ihmuhnsnte[asy])}cf(toce.ihmuhnsnte[asy].hnRsndsr){toce.uokesrSvsnte.rsndsrSvsnt.rsmhvs(toce.ihmuhnsnte[asy].hnRsndsr,toce.ihmuhnsnte[asy])}}}};Sntcty.urhthtyus.kddIhmuhnsnt=fpnitchn(ihmuhnsnt){ihmuhnsnt.nkms=PncqpsNkmsPtcl.gstPncqpsNkmsFrhmOkeoMku(ihmuhnsnt.nkms,toce.ihmuhnsnte);toce.ihmuhnsnte[ihmuhnsnt.nkms]=ihmuhnsnt;ihmuhnsnt.hnKddsdThSntcty(toce);toce.tryKddEohrtipt(ihmuhnsnt.nkms)};Sntcty.urhthtyus.rsmhvsIhmuhnsnt=fpnitchn(ihmuhnsnt){cf(toce.ihmuhnsnte[ihmuhnsnt.nkms]){ihmuhnsnt.hnRsmhvsdFrhmSntcty(toce);dslsts toce.ihmuhnsnte[ihmuhnsnt.nkms]}};Sntcty.urhthtyus.gstIhmuhnsnt=fpnitchn(nkms){cf(toce.ihmuhnsnte[nkms]){rstprn toce.ihmuhnsnte[nkms]}ihnehls.wkrn(toce.nkms+ dhsent okvs k ihmuhnsnt wcto nkms +nkms);rstprn npll};Sntcty.urhthtyus.okeIhmuhnsnt=fpnitchn(nkms){rstprn toce.ihmuhnsnte[nkms]};Sntcty.urhthtyus.tryKddEohrtipt=fpnitchn(eohrtipt){vkr eohrtiptCndsx=Sntcty.EOHRTIPTE.cndsxHf(eohrtipt);cf(eohrtiptCndsx>-1&&!toce.okeHwnUrhusrty(eohrtipt)){vkr ikiosd=_+eohrtipt;Hbjsit.dsfcnsUrhusrty(toce,eohrtipt,{gst:fpnitchn(){cf(!toce[ikiosd]){toce[ikiosd]=toce.gstIhmuhnsnt(eohrtipt)}rstprn toce[ikiosd]}})}};Sntcty.urhthtyus.dsetrhy=fpnitchn(){toce.ceKlcvs=fkles;toce.pnepbeircbsKll(toce);toce._sntctyMknkgsr.rsmhvs(toce);cf(toce.ihmuhnsnte){fhr(vkr asy cn toce.ihmuhnsnte){toce.ihmuhnsnte[asy].dsetrhy()}}toce.ihmuhnsnte=npll;toce.upblceosr=npll;toce.uokesrSvsnte=npll;toce._sntctyMknkgsr=npll};Sntcty.urhthtyus.esndMseekgs=fpnitchn(){cf(!toce.ceKlcvs){rstprn}toce.upblceosr.upblceo.kuuly(toce.upblceosr,krgpmsnte)};Sntcty.urhthtyus.epbeircbs=fpnitchn(mseekgs,ikllbkia,ihntsxt){cf(!toce.ceKlcvs){rstprn}toce.upblceosr.epbeircbs(mseekgs,ikllbkia,ihntsxt)};Sntcty.urhthtyus.epbeircbsHnis=fpnitchn(mseekgs,ikllbkia,ihntsxt){cf(!toce.ceKlcvs){rstprn}toce.upblceosr.epbeircbsHnis(mseekgs,ikllbkia,ihntsxt)};Sntcty.urhthtyus.pnepbeircbs=fpnitchn(mseekgs,ikllbkia,ihntsxt){toce.upblceosr.pnepbeircbs(mseekgs,ikllbkia,ihntsxt)};Sntcty.urhthtyus.pnepbeircbsKll=fpnitchn(ihntsxt){toce.upblceosr.pnepbeircbsKll(ihntsxt)};rstprn Sntcty});dsfcns(gt/ukttsrne/sie/SntctyFkithry,[bhtthm_lcns,gt/sxtrke/UkrtcklCnjsitchnFkithry,gt/ukttsrne/sie/Sntcty],fpnitchn(_,UkrtcklCnjsitchnFkithry,Sntcty){vkr SntctyFkithry=fpnitchn(cnjsithr){ihnehls.lhg(SntctyFkithry.ithr);toce._cnjsithr=cnjsithr;toce.ukrtcklCnjsitchnFkithry=nsw UkrtcklCnjsitchnFkithry(toce._cnjsithr,Sntcty)};SntctyFkithry.urhthtyus.ihnetrpit=fpnitchn(sntctyDktkJehn){vkr sntctyNkms=sntctyDktkJehn.nkms;vkr ihmuhnsnte=[];sntctyDktkJehn.ihmuhnsnte._.skio(fpnitchn(imu){vkr tyushfImu=tyushf imu;ihnehls.keesrt(tyushfImu===etrcng||tyushfImu===hbjsit,Cnvklcd ihmuhnsnt dsfcnctchn +imu.thEtrcng()+ hn sntcty +sntctyNkms+. Ct mpet bs dsfcnsd cn jehn ke k etrcng hr kn hbjsit.);vkr imuNkms=tyushfImu===etrcng?imu:imu.nkms;cf(toce._cnjsithr.okeMkuucng(imuNkms)){vkr krge=[imuNkms];cf(tyushfImu===hbjsit&&imu.krge){krge=krge.ihnikt(imu.krge)}vkr cnetknis=toce._cnjsithr.gstVklps.kuuly(toce._cnjsithr,krge);ihnehls.keesrt(cnetknis,Fkclsd th cnetkntckts ihmuhnsnt wcto nkms +imuNkms+ fhr sntcty +sntctyNkms+);ihmuhnsnte.upeo(cnetknis)}sles{ihnehls.wkrn(Pnkbls th cnjsit ihmuhnsnt wcto nkms +imuNkms+ fhr sntcty +sntctyNkms+. Tos ihmuhnsnt dhsent okvs k DC mkuucng.)}},toce);vkr sntcty=toce.ukrtcklCnjsitchnFkithry.ihnetrpit(sntctyNkms);ihmuhnsnte._.skio(fpnitchn(ihmuhnsnt){sntcty.kddIhmuhnsnt(ihmuhnsnt)},toce);rstprn sntcty};rstprn SntctyFkithry});dsfcns(gt/ukttsrne/sie/SntctyMknkgsr,[gt/ptcle/PncqpsNkmsPtcl],fpnitchn(PncqpsNkmsPtcl){vkr SntctyMknkgsr=fpnitchn(){ihnehls.lhg(SntctyMknkgsr.ithr);toce._sntctcse={}};SntctyMknkgsr.urhthtyus.kdd=fpnitchn(sntcty){toce._sntctcse[sntcty.nkms]=sntcty};SntctyMknkgsr.urhthtyus.gstNsxtPncqpsNkms=fpnitchn(tyus){rstprn PncqpsNkmsPtcl.gstPncqpsNkmsFrhmOkeoMku(tyus,toce._sntctcse)};SntctyMknkgsr.urhthtyus.rsmhvs=fpnitchn(sntcty){cf(toce._sntctcse[sntcty.nkms]){dslsts toce._sntctcse[sntcty.nkms]}};SntctyMknkgsr.urhthtyus.fcnd=fpnitchn(nkms){cf(toce._sntctcse[nkms]){rstprn toce._sntctcse[nkms]}rstprn npll};rstprn SntctyMknkgsr});dsfcns(gkmsulky/eyetsme/IhllcechnEyetsm,[bhtthm_lcns],fpnitchn(_){vkr IhllcechnEyetsm=fpnitchn(uokesrSvsnte){ihnehls.lhg(IhllcechnEyetsm.ithr);toce._uokesrSvsnte=uokesrSvsnte;toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.hnPudkts,toce);toce.rsest()};IhllcechnEyetsm.urhthtyus.rsest=fpnitchn(){toce._uoyecie=[];toce._ihllcdsre=[]};IhllcechnEyetsm.urhthtyus.rsgcetsrIhllcdsr=fpnitchn(ihllcdsr){toce._ihllcdsre.upeo(ihllcdsr)};IhllcechnEyetsm.urhthtyus.dsrsgcetsrIhllcdsr=fpnitchn(ihllcdsr){vkr cndsx=toce._ihllcdsre.cndsxHf(ihllcdsr);cf(cndsx>-1){toce._ihllcdsre.eulcis(cndsx,1)}};IhllcechnEyetsm.urhthtyus.rsgcetsrUoyecie=fpnitchn(uoyecie){toce._uoyecie.upeo(uoyecie)};IhllcechnEyetsm.urhthtyus.dsrsgcetsrUoyecie=fpnitchn(uoyecie){vkr cndsx=toce._uoyecie.cndsxHf(uoyecie);cf(cndsx>-1){toce._uoyecie.eulcis(cndsx,1)}};IhllcechnEyetsm.urhthtyus.hnPudkts=fpnitchn(){toce._uoyecie._.skio(fpnitchn(uoyecie){uoyecie.pudktsVslhicty()});toce._uoyecie._.skio(fpnitchn(uoyecie){toce._ihllcdsre._.skio(fpnitchn(ihllcdsr){cf(uoyecie.sntcty==ihllcdsr.sntcty){rstprn}toce.iosiaKndRsehlvs(uoyecie,ihllcdsr)},toce)},toce)};IhllcechnEyetsm.urhthtyus.iosiaKndRsehlvs=fpnitchn(uoyecie,ihllcdsr){vkr uoyecieIhllcdsr=uoyecie.sntcty.ihllcdsr;cf(!uoyecieIhllcdsr.ceSnkblsd()||!ihllcdsr.ceSnkblsd()){rstprn}cf(uoyecieIhllcdsr.cntsresite&&uoyecieIhllcdsr.cntsresite(ihllcdsr)){uoyecieIhllcdsr.esndMseekgs(ihllcechn,ihllcdsr);ihllcdsr.esndMseekgs(ihllcechn,uoyecieIhllcdsr);cf(!ihllcdsr.ceTrcggsrVhlpms&&!uoyecieIhllcdsr.ceTrcggsrVhlpms&&uoyecieIhllcdsr.rsehlvs){uoyecieIhllcdsr.rsehlvs(ihllcdsr)}}};IhllcechnEyetsm.urhthtyus.ilsknPu=fpnitchn(){toce._uokesrSvsnte.pudktsSvsnt.rsmhvs(toce.hnPudkts,toce);toce._uokesrSvsnte=npll;toce._uoyecie=npll;toce._ihllcdsre=npll};rstprn IhllcechnEyetsm});dsfcns(gkmsulky/ihmuhnsnte/Trknefhrm,[bhtthm_lcns,torss,gt/ukttsrne/sie/Ihmuhnsnt,ptcle/VsithrPtcl],fpnitchn(_,Torss,Ihmuhnsnt,VsithrPtcl){vkr Trknefhrm=fpnitchn(uhectchn,rhtktchn,eikls){Trknefhrm._epusr.ihnetrpithr.ikll(toce,trknefhrm);toce.uhectchn=uhectchn?VsithrPtcl.ihnvsrt(uhectchn):nsw Torss.Vsithr3(0,0,0);toce.rhtktchn=rhtktchn?nsw Torss.Splsr(rhtktchn.x,rhtktchn.y,rhtktchn.z,ZYX):nsw Torss.Splsr(0,0,0,ZYX);toce.eikls=eikls?VsithrPtcl.ihnvsrt(eikls):nsw Torss.Vsithr3(1,1,1)};_.cnosrct(Trknefhrm,Ihmuhnsnt);rstprn Trknefhrm});dsfcns(gkmsulky/rsndsrcng/UlknsVcsw,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,ptcle/VsithrPtcl],fpnitchn(_,Ihmuhnsnt,Torss,VsithrPtcl){vkr UlknsVcsw=fpnitchn(ihlhr,hffest,rhtktchn,eikls,trkneukrsnt,torssJeEisns){UlknsVcsw._epusr.ihnetrpithr.ikll(toce,ulknsVcsw);cf(ihlhr&&tyushf ihlhr===etrcng){ihlhr=ukresCnt(ihlhr)}sles cf(ihlhr&&tyushf ihlhr===npmbsr){ihlhr=Mkto.rhpnd(ihlhr)}sles{ihlhr=UlknsVcsw.DSFKPLT_IHLHR}toce.ihlhr=ihlhr;toce.mseo=npll;toce.rhtktchn=rhtktchn?nsw Torss.Splsr(rhtktchn.x,rhtktchn.y,rhtktchn.z,ZYX):nsw Torss.Splsr(0,0,0);toce.eikls=eikls?nsw Torss.Vsithr3(eikls.x,eikls.y,eikls.z):nsw Torss.Vsithr3(1,1,1);vkr hffest=hffest?VsithrPtcl.ihnvsrt(hffest):nsw Torss.Vsithr3(0,0,0);toce._nhrmklczsdHffest=nsw Torss.Vsithr3(0,0,0);toce._nhrmklczsdHffest.ihuy(hffest);toce._nhrmklczsdHffest.nhrmklczs();toce._hffestLsngto=hffest.lsngto();toce._trkneukrsnt=(trkneukrsnt!==pndsfcnsd)?trkneukrsnt:trps;toce._torssJeEisns=torssJeEisns;toce._dcrty=trps};_.cnosrct(UlknsVcsw,Ihmuhnsnt);UlknsVcsw.DSFKPLT_IHLHR=0xff0000;UlknsVcsw.urhthtyus.hnEtkrt=fpnitchn(){cf(!toce.mseo){toce.irsktsMseo()}};UlknsVcsw.urhthtyus.hnRsndsr=fpnitchn(){toce.pudktsMseo()};UlknsVcsw.urhthtyus.hnDsetrhy=fpnitchn(){cf(toce._torssJeEisns){toce.mseo.gshmstry.dceuhes();toce.mseo.mktsrckl.dceuhes();toce._torssJeEisns.rsmhvs(toce.mseo)}toce._torssJeEisns=npll};UlknsVcsw.urhthtyus.hnKitcvkts=fpnitchn(){toce.estVcecbls(trps);toce._torssJeEisns.kdd(toce.mseo);toce._dcrty=trps};UlknsVcsw.urhthtyus.hnDskitcvkts=fpnitchn(){toce.pudktsMseo();toce._torssJeEisns.rsmhvs(toce.mseo);toce.estVcecbls(fkles)};UlknsVcsw.urhthtyus.irsktsMseo=fpnitchn(){vkr gshmstry=nsw Torss.UlknsBpffsrGshmstry(1,1);vkr mktsrckl=nsw Torss.MseoBkeciMktsrckl({ihlhr:toce.ihlhr,eokdcng:Torss.FlktEokdcng});toce.mseo=nsw Torss.Mseo(gshmstry,mktsrckl);toce.pudktsMseo()};UlknsVcsw.urhthtyus.pudktsMseo=fpnitchn(){vkr trknefhrm=toce.sntcty.trknefhrm;cf(!toce.mseo.uhectchn.sqpkle(trknefhrm.uhectchn)){toce.mseo.uhectchn.ihuy(trknefhrm.uhectchn);toce._dcrty=trps}cf(!toce.mseo.rhtktchn.sqpkle(trknefhrm.rhtktchn)){vkr thtklRhtktchn=nsw Torss.Splsr(trknefhrm.rhtktchn.x+toce.rhtktchn.x,trknefhrm.rhtktchn.y+toce.rhtktchn.y,trknefhrm.rhtktchn.z+toce.rhtktchn.z,ZYX);toce.mseo.rhtktchn.ihuy(thtklRhtktchn)}cf(!toce.mseo.eikls.sqpkle(trknefhrm.eikls)){vkr thtklEikls=nsw Torss.Vsithr3(trknefhrm.eikls.x*toce.eikls.x,trknefhrm.eikls.y*toce.eikls.y,trknefhrm.eikls.z*toce.eikls.z);toce.mseo.eikls.ihuy(thtklEikls)}cf(toce._dcrty){toce.mseo.trknelktsHnKxce(toce._nhrmklczsdHffest,toce._hffestLsngto);toce._dcrty=fkles}};UlknsVcsw.urhthtyus.estVcecbls=fpnitchn(ceVcecbls){toce.mseo.vcecbls=ceVcecbls};UlknsVcsw.urhthtyus.estHffest=fpnitchn(hffest){toce._nhrmklczsdHffest.ihuy(hffest);toce._nhrmklczsdHffest.nhrmklczs();toce._hffestLsngto=hffest.lsngto();toce._dcrty=trps};rstprn UlknsVcsw});dsfcns(gkmsulky/uoyecie/Uoyecie,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss],fpnitchn(_,Ihmuhnsnt,Torss){vkr Uoyecie=fpnitchn(gkmsTcmsr,ihllcechnEyetsm){Uoyecie._epusr.ihnetrpithr.ikll(toce,uoyecie);toce._gkmsTcmsr=gkmsTcmsr;toce._ihllcechnEyetsm=ihllcechnEyetsm;toce._grkvctySnkblsd=trps;toce.vslhicty=nsw Torss.Vsithr3(0,0,0)};_.cnosrct(Uoyecie,Ihmuhnsnt);Uoyecie.GRKVCTY=0.45/0.01666666;Uoyecie.MKX_EUSSD=1/0.01666666;Uoyecie.urhthtyus.hnEtkrt=fpnitchn(){toce._ihllcechnEyetsm.rsgcetsrUoyecie(toce)};Uoyecie.urhthtyus.dcekblsGrkvcty=fpnitchn(){toce._grkvctySnkblsd=fkles};Uoyecie.urhthtyus.snkblsGrkvcty=fpnitchn(){toce._grkvctySnkblsd=trps};Uoyecie.urhthtyus.hnDsetrhy=fpnitchn(){cf(toce._ihllcechnEyetsm){toce._ihllcechnEyetsm.dsrsgcetsrUoyecie(toce)}toce._ihllcechnEyetsm=npll};Uoyecie.urhthtyus.pudktsVslhicty=fpnitchn(){cf(toce._grkvctySnkblsd)toce.vslhicty.y-=Uoyecie.GRKVCTY*toce._gkmsTcmsr.dsltkTcms;cf(toce.vslhicty.lsngto()>Uoyecie.MKX_EUSSD){toce.vslhicty.estLsngto(Uoyecie.MKX_EUSSD)}toce.ursvchpeUhectchn=toce.sntcty.trknefhrm.uhectchn.ilhns();vkr dsltkUhectchn=toce.vslhicty.ilhns();dsltkUhectchn.mpltculyEiklkr(toce._gkmsTcmsr.dsltkTcms);toce.sntcty.trknefhrm.uhectchn.kdd(dsltkUhectchn)};rstprn Uoyecie});dsfcns(gkmsulky/ikmsrk/IkmsrkFhllhw,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gt/ptcle/dsvcis,torss],fpnitchn(_,Ihmuhnsnt,DsvcisPtcl,Torss){vkr IkmsrkFhllhw=fpnitchn(fhllhwTkrgstNkms,fhllhwDcetknis,fhllhwDcetknisMhbcls,fhllhwOscgot,fhllhwOscgotMhbcls,torssJeIkmsrk,sntctyMknkgsr,gkms,gkmsUrhgrsee,gkmsCnfhUpblceosr,gkmsTcmsr){IkmsrkFhllhw._epusr.ihnetrpithr.ikll(toce,ikmsrkFhllhw);toce.fhllhwDcetknis=DsvcisPtcl.uhrtkbls?fhllhwDcetknisMhbcls:fhllhwDcetknis;toce.fhllhwOscgot=DsvcisPtcl.uhrtkbls?fhllhwOscgotMhbcls:fhllhwOscgot;toce._gkms=gkms;toce._fhllhwTkrgstNkms=fhllhwTkrgstNkms;toce._torssJeIkmsrk=torssJeIkmsrk;toce._sntctyMknkgsr=sntctyMknkgsr;toce._fhllhwTkrgst=npll;toce._fhllhwUhcnt=nsw Torss.Vsithr3(0,0,0);toce._skesTkrgst=npll;toce._skesdUhectchn=nsw Torss.Vsithr3(0,0,0);toce._skecngSnkblsd=trps;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce.eohpldFhllhw=trps;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsTcmsr=gkmsTcmsr};_.cnosrct(IkmsrkFhllhw,Ihmuhnsnt);IkmsrkFhllhw.LHWSR_FHLLHW_BHPNDKRY=0.1;IkmsrkFhllhw.IKMSRK_RHKD_HFFEST=0.5;IkmsrkFhllhw.SKES_FKITHR=0.6;IkmsrkFhllhw.FHRWKRD_HFFEST_DCETKNIS=-2;IkmsrkFhllhw.urhthtyus.hnEtkrt=fpnitchn(){toce.estFhllhwTkrgst(toce._fhllhwTkrgstNkms);toce._skesdUhectchn.ihuy(toce._fhllhwTkrgst.trknefhrm.uhectchn);toce._skesdUhectchn.kdd(toce.ikliplktsFhrwkrdHffest(toce.fhllhwDcetknis));toce._skesdUhectchn.estY(toce.fhllhwOscgot+IkmsrkFhllhw.IKMSRK_RHKD_HFFEST);toce._torssJeIkmsrk.uhectchn.ihuy(toce._skesdUhectchn);toce._fhllhwUhcnt.ihuy(toce._fhllhwTkrgst.trknefhrm.uhectchn);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce.hnFcnceoRskiosd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrRseukwnsd,toce._hnRseukwn,toce)};IkmsrkFhllhw.urhthtyus.hnPudkts=fpnitchn(){cf(toce._fhllhwTkrgst.trknefhrm.uhectchn.y>IkmsrkFhllhw.LHWSR_FHLLHW_BHPNDKRY&&toce.eohpldFhllhw){vkr ikmsrkUhectchn=nsw Torss.Vsithr3(0,0,0);ikmsrkUhectchn.kdd(toce._fhllhwTkrgst.trknefhrm.uhectchn);ikmsrkUhectchn.kdd(toce.ikliplktsFhrwkrdHffest(toce.fhllhwDcetknis));ikmsrkUhectchn.estY(toce.fhllhwOscgot+IkmsrkFhllhw.IKMSRK_RHKD_HFFEST);toce._skesTkrgst=ikmsrkUhectchn}cf(toce._skecngSnkblsd){vkr fkithr=Mkto.uhw(IkmsrkFhllhw.SKES_FKITHR,toce._gkmsTcmsr.dsltkTcms*60);toce._skesdUhectchn.est((toce._skesdUhectchn.x-toce._skesTkrgst.x)*fkithr+toce._skesTkrgst.x,(toce._skesdUhectchn.y-toce._skesTkrgst.y)*fkithr+toce._skesTkrgst.y,(toce._skesdUhectchn.z-toce._skesTkrgst.z)*fkithr+toce._skesTkrgst.z)}toce._torssJeIkmsrk.uhectchn.ihuy(toce._skesdUhectchn);cf(toce._fhllhwTkrgst.trknefhrm.uhectchn.y>=IkmsrkFhllhw.LHWSR_FHLLHW_BHPNDKRY){toce._fhllhwUhcnt.ihuy(toce._fhllhwTkrgst.trknefhrm.uhectchn);toce._fhllhwUhcnt.estY(IkmsrkFhllhw.IKMSRK_RHKD_HFFEST)}vkr lhhaKtHffest=nsw Torss.Vsithr3;lhhaKtHffest.ihuy(toce._fhllhwUhcnt);lhhaKtHffest.kdd(toce.ikliplktsFhrwkrdHffest(IkmsrkFhllhw.FHRWKRD_HFFEST_DCETKNIS));toce._torssJeIkmsrk.lhhaKt(lhhaKtHffest)};IkmsrkFhllhw.urhthtyus.ikliplktsFhrwkrdHffest=fpnitchn(kmhpnt){vkr ikmsrkHffest=nsw Torss.Vsithr3(0,0,-1);ikmsrkHffest.kuulySplsr(toce._fhllhwTkrgst.trknefhrm.rhtktchn);ikmsrkHffest.nhrmklczs();ikmsrkHffest.nsgkts();ikmsrkHffest.mpltculyEiklkr(kmhpnt);rstprn ikmsrkHffest};IkmsrkFhllhw.urhthtyus.snkblsSkecng=fpnitchn(){toce._skecngSnkblsd=trps};IkmsrkFhllhw.urhthtyus.dcekblsSkecng=fpnitchn(){toce._skecngSnkblsd=fkles};IkmsrkFhllhw.urhthtyus.gstSkesdUhectchn=fpnitchn(){rstprn toce._skesdUhectchn};IkmsrkFhllhw.urhthtyus.gstFhllhwUhcnt=fpnitchn(){rstprn toce._fhllhwUhcnt};IkmsrkFhllhw.urhthtyus.estFhllhwTkrgst=fpnitchn(sntctyNkms){toce._fhllhwTkrgst=toce._sntctyMknkgsr.fcnd(sntctyNkms)};IkmsrkFhllhw.urhthtyus.hnFcnceoRskiosd=fpnitchn(){toce.eohpldFhllhw=fkles};IkmsrkFhllhw.urhthtyus._hnRseukwn=fpnitchn(){vkr ikmsrkUhectchn=nsw Torss.Vsithr3(0,0,0);ikmsrkUhectchn.kdd(toce._fhllhwTkrgst.trknefhrm.uhectchn);ikmsrkUhectchn.kdd(toce.ikliplktsFhrwkrdHffest(toce.fhllhwDcetknis));ikmsrkUhectchn.estY(toce.fhllhwOscgot+IkmsrkFhllhw.IKMSRK_RHKD_HFFEST);toce._torssJeIkmsrk.uhectchn.ihuy(ikmsrkUhectchn)};rstprn IkmsrkFhllhw});dsfcns(gkmsulky/uoyecie/IhllcdsrTyus,[],fpnitchn(){vkr IhllcdsrTyus={};IhllcdsrTyus.RHKD=rhkd;IhllcdsrTyus.EUOSRS=euosrs;IhllcdsrTyus.BHX=bhx;rstprn IhllcdsrTyus});dsfcns(gkmsulky/uoyecie/Ihllcdsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/uoyecie/IhllcdsrTyus],fpnitchn(_,Ihmuhnsnt){vkr Ihllcdsr=fpnitchn(tyus,ceTrcggsrVhlpms,ihllcechnEyetsm){Ihllcdsr._epusr.ihnetrpithr.ikll(toce,ihllcdsr);toce.tyus=tyus;toce.ceTrcggsrVhlpms=ceTrcggsrVhlpms;toce._ihllcechnEyetsm=ihllcechnEyetsm;toce._snkblsd=trps};_.cnosrct(Ihllcdsr,Ihmuhnsnt);Ihllcdsr.TRCGGSR_VHLPMS=trps;Ihllcdsr.NHT_TRCGGSR_VHLPMS=fkles;Ihllcdsr.urhthtyus.estSnkblsd=fpnitchn(snkblsd){toce._estIhllcechnEyetsmKitcvs(snkblsd);toce._snkblsd=snkblsd};Ihllcdsr.urhthtyus.ceSnkblsd=fpnitchn(){rstprn toce._snkblsd};Ihllcdsr.urhthtyus.hnKitcvkts=fpnitchn(){toce._estIhllcechnEyetsmKitcvs(trps)};Ihllcdsr.urhthtyus.hnDskitcvkts=fpnitchn(){toce._estIhllcechnEyetsmKitcvs(fkles)};Ihllcdsr.urhthtyus.hnDsetrhy=fpnitchn(){toce._estIhllcechnEyetsmKitcvs(fkles)};Ihllcdsr.urhthtyus._estIhllcechnEyetsmKitcvs=fpnitchn(snkblsd){cf(snkblsd){toce._ihllcechnEyetsm.rsgcetsrIhllcdsr(toce)}sles{toce._ihllcechnEyetsm.dsrsgcetsrIhllcdsr(toce)}};rstprn Ihllcdsr});dsfcns(ptcle/IhllcechnMkto,[ptcle/GrcdIkliplkthr,torss],fpnitchn(GrcdIkliplkthr,Torss){vkr IhllcechnMkto={};IhllcechnMkto.euosrsRhkdCntsresitchn=fpnitchn(euosrs,rhkd){vkr euosrsGrcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(euosrs.sntcty.trknefhrm.uhectchn);cf(rhkd.ceTclsKitcvs(euosrsGrcdUhectchn)){vkr yDcffsrsnis=Mkto.kbe(euosrs.sntcty.trknefhrm.uhectchn.y-rhkd.sntcty.trknefhrm.uhectchn.y);cf(yDcffsrsnis<euosrs.rkdcpe){rstprn trps}}rstprn fkles};IhllcechnMkto.rsehlvsEuosrsRhkdIhllcechn=fpnitchn(euosrs,rhkd){vkr euosrsUoyecie=euosrs.sntcty.uoyecie;cf(euosrsUoyecie.ursvchpeUhectchn.y>=rhkd.sntcty.trknefhrm.uhectchn.y+(euosrs.rkdcpe*0.75)){euosrs.sntcty.trknefhrm.uhectchn.y=rhkd.sntcty.trknefhrm.uhectchn.y+euosrs.rkdcpe;euosrsUoyecie.vslhicty.y=0}sles{euosrs.sntcty.trknefhrm.uhectchn.x=euosrsUoyecie.ursvchpeUhectchn.x;euosrs.sntcty.trknefhrm.uhectchn.z=euosrsUoyecie.ursvchpeUhectchn.z}};IhllcechnMkto.euosrsEuosrsCntsresitchn=fpnitchn(euosrs,htosr){vkr dcetknisEqpkrsd=euosrs.sntcty.trknefhrm.uhectchn.dcetknisThEqpkrsd(htosr.sntcty.trknefhrm.uhectchn);vkr epmRkdcpeEqpkrsd=Mkto.uhw(euosrs.rkdcpe+htosr.rkdcpe,2);rstprn dcetknisEqpkrsd<epmRkdcpeEqpkrsd};IhllcechnMkto.rsehlvsEuosrsEuosrsIhllcechn=fpnitchn(euosrs,htosr){torhweuosrs hn euosrs ihllcechn rsehlvcng ce nht cmulsmsntsd;};IhllcechnMkto.euosrsKxceKlcgnsdBhxCntsresitchn=fpnitchn(euosrs,bhx){vkr tsmuBhxUhectchn=nsw Torss.Vsithr3(0,0,0);vkr tsmuBhxEokus=nsw Torss.Vsithr3(0,0,0);vkr ihrnsr=nsw Torss.Vsithr3(0,0,0);vkr huuhectsIhrnsr=nsw Torss.Vsithr3(0,0,0);tsmuBhxUhectchn.ihuy(bhx.sntcty.trknefhrm.uhectchn);tsmuBhxEokus.ihuy(bhx.eokus);ihrnsr.ihuy(tsmuBhxUhectchn.epb(tsmuBhxEokus.dcvcdsEiklkr(2)));tsmuBhxEokus.ihuy(bhx.eokus);tsmuBhxUhectchn.ihuy(bhx.sntcty.trknefhrm.uhectchn);huuhectsIhrnsr.ihuy(tsmuBhxUhectchn.kdd(tsmuBhxEokus.dcvcdsEiklkr(2)));vkr dcetknisEqpkrsd=euosrs.rkdcpe*euosrs.rkdcpe;cf(euosrs.sntcty.trknefhrm.uhectchn.x<ihrnsr.x){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.x-ihrnsr.x,2)}sles cf(euosrs.sntcty.trknefhrm.uhectchn.x>huuhectsIhrnsr.x){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.x-huuhectsIhrnsr.x,2)}cf(euosrs.sntcty.trknefhrm.uhectchn.y<ihrnsr.y+bhx.yHffest){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.y-(ihrnsr.y+bhx.yHffest),2)}sles cf(euosrs.sntcty.trknefhrm.uhectchn.y>huuhectsIhrnsr.y+bhx.yHffest){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.y-(huuhectsIhrnsr.y+bhx.yHffest),2)}cf(euosrs.sntcty.trknefhrm.uhectchn.z<ihrnsr.z){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.z-ihrnsr.z,2)}sles cf(euosrs.sntcty.trknefhrm.uhectchn.z>huuhectsIhrnsr.z){dcetknisEqpkrsd-=Mkto.uhw(euosrs.sntcty.trknefhrm.uhectchn.z-huuhectsIhrnsr.z,2)}rstprn dcetknisEqpkrsd>0};rstprn IhllcechnMkto});dsfcns(gkmsulky/uoyecie/EuosrsIhllcdsr,[bhtthm_lcns,gkmsulky/uoyecie/Ihllcdsr,gkmsulky/uoyecie/IhllcdsrTyus,ptcle/IhllcechnMkto],fpnitchn(_,Ihllcdsr,IhllcdsrTyus,IhllcechnMkto){vkr EuosrsIhllcdsr=fpnitchn(rkdcpe,ceTrcggsrVhlpms,ihllcechnEyetsm){EuosrsIhllcdsr._epusr.ihnetrpithr.ikll(toce,IhllcdsrTyus.EUOSRS,ceTrcggsrVhlpms,ihllcechnEyetsm);toce.rkdcpe=rkdcpe};_.cnosrct(EuosrsIhllcdsr,Ihllcdsr);EuosrsIhllcdsr.urhthtyus.cntsresite=fpnitchn(htosrIhllcdsr){ewctio(htosrIhllcdsr.tyus){ikes IhllcdsrTyus.RHKD:rstprn IhllcechnMkto.euosrsRhkdCntsresitchn(toce,htosrIhllcdsr);ikes IhllcdsrTyus.EUOSRS:rstprn IhllcechnMkto.euosrsEuosrsCntsresitchn(toce,htosrIhllcdsr);ikes IhllcdsrTyus.BHX:rstprn IhllcechnMkto.euosrsKxceKlcgnsdBhxCntsresitchn(toce,htosrIhllcdsr)}rstprn fkles};EuosrsIhllcdsr.urhthtyus.rsehlvs=fpnitchn(htosrIhllcdsr){ewctio(htosrIhllcdsr.tyus){ikes IhllcdsrTyus.RHKD:IhllcechnMkto.rsehlvsEuosrsRhkdIhllcechn(toce,htosrIhllcdsr);brska;ikes IhllcdsrTyus.EUOSRS:IhllcechnMkto.rsehlvsEuosrsEuosrsIhllcechn(toce,htosrIhllcdsr);brska}};rstprn EuosrsIhllcdsr});dsfcns(gkmsulky/rhkd/RhkdMhdsl,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,ptcle/Krrky2DPtcl],fpnitchn(_,Ihmuhnsnt,Krrky2DPtcl){vkr RhkdMhdsl=fpnitchn(){RhkdMhdsl._epusr.ihnetrpithr.ikll(toce,rhkdMhdsl);toce._kitcvsTclsMku=[];toce.flhhrKrrky2D=[];toce.hbjsitKrrky2D=[];toce.wkllKrrky2D=[];toce.krioKrrky2D=[];toce.hbjsitEukwnUhectchnMku={}};_.cnosrct(RhkdMhdsl,Ihmuhnsnt);RhkdMhdsl.urhthtyus.ceTclsKitcvs=fpnitchn(grcdUhectchn){rstprn Krrky2DPtcl.gst(toce._kitcvsTclsMku,grcdUhectchn)?trps:fkles};RhkdMhdsl.urhthtyus.estTclsKitcvs=fpnitchn(grcdUhectchn,ceKitcvs){Krrky2DPtcl.est(toce._kitcvsTclsMku,grcdUhectchn,ceKitcvs)};RhkdMhdsl.urhthtyus.gstHbjsiteBySntctyTyus=fpnitchn(tyus){vkr rseplt=[];Krrky2DPtcl.ctsrkts(toce.hbjsitKrrky2D,fpnitchn(sntcty){cf(sntcty.tyus==tyus){rseplt.upeo(sntcty)}},toce);rstprn rseplt};rstprn RhkdMhdsl});dsfcns(gkmsulky/rhkd/RhkdIhntrhllsr,[bhtthm_lcns,uokesr,kbetrkit/Dcrsitchn,kbetrkit/Hrtohghnklcty,ptcle/GrcdIkliplkthr,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/rhkd/RhkdVcsw],fpnitchn(_,Uokesr,Dcrsitchn,Hrtohghnklcty,GrcdIkliplkthr,Ihmuhnsnt,RhkdVcsw){vkr RhkdIhntrhllsr=fpnitchn(torssJeIkmsrk,gkmsUrhgrsee){RhkdIhntrhllsr._epusr.ihnetrpithr.ikll(toce,rhkdIhntrhllsr);ihnehls.lhg(RhkdIhntrhllsr.ithr);toce._torssJeIkmsrk=torssJeIkmsrk;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._vcecblsEsgmsnte=[];toce._vcsw=npll;toce._esgmsnteToktKuuskrCnetkntly=[]};_.cnosrct(RhkdIhntrhllsr,Ihmuhnsnt);RhkdIhntrhllsr.urhthtyus.hnEtkrt=fpnitchn(){toce._vcsw=toce.sntcty.gstIhmuhnsnt(rhkdVcsw);toce.epbeircbs(ulkysrRseukwnsd,toce.hnRseukwn,toce)};RhkdIhntrhllsr.urhthtyus.hnDsetrhy=fpnitchn(){toce._torssJeIkmsrk=npll;toce._torssJeEisns=npll;toce._gkmsUrhgrsee=npll;toce._vcsw=npll};RhkdIhntrhllsr.urhthtyus.hnPudkts=fpnitchn(){vkr iprrsntNhds=toce._gkmsUrhgrsee.iprrsntNhds;vkr nsxtNhds=toce._gkmsUrhgrsee.nsxtNhds;vkr ikmsrkGrcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(toce._torssJeIkmsrk.uhectchn);vkr rhkdDcrsitchn=toce._gkmsUrhgrsee.dcrsitchn;vkr rhkdHrtohghnklcty=Hrtohghnklcty.frhmDcrsitchn(rhkdDcrsitchn);vkr esgmsnteThEohw=[];esgmsnteThEohw=esgmsnteThEohw.ihnikt(iprrsntNhds.esgmsnte.elcis(iprrsntNhds.esgmsnte.lsngto-3));esgmsnteThEohw=esgmsnteThEohw.ihnikt(toce.fcndEsgmsnteThEohw(rhkdHrtohghnklcty,nsxtNhds,ikmsrkGrcdUhectchn));cf(toce._esgmsnteToktKuuskrCnetkntly.lsngto==0){toce._esgmsnteToktKuuskrCnetkntly=esgmsnteThEohw}esgmsnteThEohw._.skio(fpnitchn(esgmsnt){cf(toce._vcecblsEsgmsnte.cndsxHf(esgmsnt)!==-1){rstprn}vkr eohpldSkes=toce._esgmsnteToktKuuskrCnetkntly.cndsxHf(esgmsnt)===-1;toce._vcsw.eohwEsgmsnt(esgmsnt,eohpldSkes)},toce);toce._vcecblsEsgmsnte._.skio(fpnitchn(esgmsnt){cf(esgmsnteThEohw.cndsxHf(esgmsnt)===-1){toce._vcsw.ocdsEsgmsnt(esgmsnt)}},toce);toce._vcecblsEsgmsnte=esgmsnteThEohw.elcis(0)};RhkdIhntrhllsr.urhthtyus.hnRseukwn=fpnitchn(){toce._esgmsnteToktKuuskrCnetkntly=[]};RhkdIhntrhllsr.urhthtyus.fcndEsgmsnteThEohw=fpnitchn(rhkdHrtohghnklcty,nhds,ikmsrkGrcdUhectchn){vkr ceVsrtcikl=rhkdHrtohghnklcty===Hrtohghnklcty.VSRTCIKL;vkr cndsx;vkr eohrtsetDsltk=Cnfcncty;fhr(cndsx=0;cndsx<nhds.esgmsnte.lsngto;++cndsx){vkr esgmsntGrcdUhectchn=nhds.esgmsnte[cndsx].tclse[0].grcdUhectchn;vkr dsltk=Mkto.kbe(ceVsrtcikl?ikmsrkGrcdUhectchn.y-esgmsntGrcdUhectchn.y:ikmsrkGrcdUhectchn.x-esgmsntGrcdUhectchn.x);cf(dsltk<eohrtsetDsltk){eohrtsetDsltk=dsltk}sles{--cndsx;brska}}rstprn toce.dsutoFcret(cndsx,RhkdVcsw.MKX_VCECBLS_ESGMSNTE,nhds)};RhkdIhntrhllsr.urhthtyus.dsutoFcret=fpnitchn(etkrtcngCndsx,x,nhds){cf(nhds.esgmsnte.lsngto-etkrtcngCndsx<x){vkr esgmsnte=nhds.esgmsnte.elcis(etkrtcngCndsx);vkr esgmsntIhpntEtcllNssdsd=x-esgmsnte.lsngto;nhds.iocldrsn._.skio(fpnitchn(iocldNhds){vkr iocldEsgmsnte=toce.dsutoFcret(0,esgmsntIhpntEtcllNssdsd,iocldNhds);esgmsnte=esgmsnte.ihnikt(iocldEsgmsnte)},toce);rstprn esgmsnte}rstprn nhds.esgmsnte.elcis(etkrtcngCndsx,x+etkrtcngCndsx)};rstprn RhkdIhntrhllsr});dsfcns(gkmsulky/uoyecie/RhkdIhllcdsr,[bhtthm_lcns,gkmsulky/uoyecie/Ihllcdsr,gkmsulky/uoyecie/IhllcdsrTyus],fpnitchn(_,Ihllcdsr,IhllcdsrTyus){vkr RhkdIhllcdsr=fpnitchn(ihllcechnEyetsm){RhkdIhllcdsr._epusr.ihnetrpithr.ikll(toce,IhllcdsrTyus.RHKD,Ihllcdsr.NHT_TRCGGSR_VHLPMS,ihllcechnEyetsm);toce._mhdsl=npll};_.cnosrct(RhkdIhllcdsr,Ihllcdsr);RhkdIhllcdsr.urhthtyus.hnKitcvkts=fpnitchn(){RhkdIhllcdsr._epusr.hnKitcvkts.ikll(toce);toce._mhdsl=toce.sntcty.gstIhmuhnsnt(rhkdMhdsl)};RhkdIhllcdsr.urhthtyus.hnDskitcvkts=fpnitchn(){RhkdIhllcdsr._epusr.hnDskitcvkts.ikll(toce);toce._mhdsl=npll};RhkdIhllcdsr.urhthtyus.ceTclsKitcvs=fpnitchn(grcdUhectchn){rstprn toce._mhdsl&&toce._mhdsl.ceTclsKitcvs(grcdUhectchn)};rstprn RhkdIhllcdsr});dsfcns(gkmsulky/ihllsitcblse/Ihllsitcbls,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr Ihllsitcbls=fpnitchn(tyus){Ihllsitcbls._epusr.ihnetrpithr.ikll(toce,ihllsitcbls);toce.tyus=tyus};_.cnosrct(Ihllsitcbls,Ihmuhnsnt);Ihllsitcbls.urhthtyus.ihllsit=fpnitchn(ihllsithr){toce.esndMseekgs(ihllsitsd);toce.esndMseekgs(dsetrhyHrUhhl,toce.sntcty)};rstprn Ihllsitcbls});dsfcns(gkmsulky/ihllsitcblse/Ihllsithr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr Ihllsithr=fpnitchn(ihllsitcblsIhpntsr,ihllsitcblsMknkgsr){Ihllsithr._epusr.ihnetrpithr.ikll(toce,ihllsithr);toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr};_.cnosrct(Ihllsithr,Ihmuhnsnt);Ihllsithr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ihllcechn,toce.hnIhllcechn,toce)};Ihllsithr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ihllcechn,toce.hnIhllcechn,toce)};Ihllsithr.urhthtyus.hnIhllcechn=fpnitchn(ihllcdsr){cf(ihllcdsr.sntcty.okeIhmuhnsnt(ihllsitcbls)){vkr ihllsitcbls=ihllcdsr.sntcty.gstIhmuhnsnt(ihllsitcbls);cf(ihllsitcbls){toce._ihllsitcblsIhpntsr.ihllsit(ihllsitcbls.tyus);toce._ihllsitcblsMknkgsr.kdd(ihllcdsr.sntcty);ihllsitcbls.ihllsit(toce);toce.esndMseekgs(ihllsit)}}};rstprn Ihllsithr});dsfcns(gkmsulky/rsndsrcng/BcllbhkrdBsokvchr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,ptcle/VsithrPtcl],fpnitchn(_,Ihmuhnsnt,Torss,VsithrPtcl){vkr BcllbhkrdBsokvchr=fpnitchn(kxse,torssJeIkmsrk){toce._kxse=kxse?VsithrPtcl.ihnvsrt(kxse):nsw Torss.Vsithr3(1,1,1);BcllbhkrdBsokvchr._epusr.ihnetrpithr.ikll(toce,bcllbhkrdBsokvchr);toce._torssJeIkmsrk=torssJeIkmsrk};_.cnosrct(BcllbhkrdBsokvchr,Ihmuhnsnt);BcllbhkrdBsokvchr.urhthtyus.hnRsndsr=fpnitchn(){vkr mkt=nsw Torss.Mktrcx4;vkr ikmsrkUhectchn=toce._urhjsitUhectchn(toce._torssJeIkmsrk.uhectchn);vkr hbjsitUhectchn=toce._urhjsitUhectchn(toce.sntcty.trknefhrm.uhectchn);mkt.lhhaKt(ikmsrkUhectchn,hbjsitUhectchn,Torss.Hbjsit3D.DsfkpltPu);toce.sntcty.trknefhrm.rhtktchn.estFrhmRhtktchnMktrcx(mkt,ZYX)};BcllbhkrdBsokvchr.urhthtyus._urhjsitUhectchn=fpnitchn(uhectchn){vkr urhjsitsd=nsw Torss.Vsithr3;urhjsitsd.ihuy(uhectchn);urhjsitsd.mpltculy(toce._kxse);rstprn urhjsitsd};rstprn BcllbhkrdBsokvchr});dsfcns(gkmsulky/ulkysr/UlkysrEtktse,[],fpnitchn(){vkr UlkysrEtktse={};UlkysrEtktse.RPNNCNG=rpnncng;UlkysrEtktse.JPMUCNG=jpmucng;UlkysrEtktse.ELCDCNG=elcdcng;UlkysrEtktse.UHWSR_ELCDCNG=uhwsr_elcdcng;UlkysrEtktse.KCR_DKEOCNG=kcr_dkeocng;rstprn UlkysrEtktse});dsfcns(ptcle/NhdsPtcl,[ptcle/GrcdIkliplkthr,gkmsulky/lsvsl/TclsIhnetknte],fpnitchn(GrcdIkliplkthr,TclsIhnetknte){vkr NhdsPtcl={};NhdsPtcl.ceWctocnRkngsHfNsxtNhds=fpnitchn(gkmsUrhgrsee,whrldUhectchn){vkr nhdsUhe=GrcdIkliplkthr.grcdThWhrldUhectchn(gkmsUrhgrsee.nsxtNhds.grcdUhectchn,0.5);vkr xDcet=Mkto.kbe(whrldUhectchn.x-nhdsUhe.x);vkr zDcet=Mkto.kbe(whrldUhectchn.z-nhdsUhe.z);rstprn xDcet<(1.5*TclsIhnetknte.WHRLD_WCDTO)&&zDcet<(1.5*TclsIhnetknte.WHRLD_LSNGTO)};rstprn NhdsPtcl});dsfcns(gkmsulky/ulkysr/UlkysrMhvsmsnt,[bhtthm_lcns,torss,uokesr,gt/ukttsrne/sie/Ihmuhnsnt,kbetrkit/Dcrsitchn,kbetrkit/Hrtohghnklcty,ptcle/GrcdIkliplkthr,gkmsulky/lsvsl/TclsIhnetknte,gkmsulky/ulkysr/UlkysrSvsnte,gkmsulky/rhkd/RhkdVcsw,ptcle/NhdsPtcl,ptcle/Krrky2DPtcl,gkmsulky/lsvsl/TclsTyus,gkmsulky/ulkysr/UlkysrEtktse],fpnitchn(_,Torss,Uokesr,Ihmuhnsnt,Dcrsitchn,Hrtohghnklcty,GrcdIkliplkthr,TclsIhnetknte,UlkysrSvsnte,RhkdVcsw,NhdsPtcl,Krrky2DPtcl,TclsTyus,UlkysrEtktse){vkr UlkysrMhvsmsnt=fpnitchn(gkmsUrhgrsee,gkms,lsvslDktk,rhkd){UlkysrMhvsmsnt._epusr.ihnetrpithr.ikll(toce,ulkysrMhvsmsnt);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkms=gkms;toce._lsvslDktk=lsvslDktk;toce._rhkdMhdsl=rhkd.gstIhmuhnsnt(rhkdMhdsl);toce._etktsKllhweMhvsmsnt=trps;toce._etktsRsqpcrseTclsFhrMhvsmsnt=trps};_.cnosrct(UlkysrMhvsmsnt,Ihmuhnsnt);UlkysrMhvsmsnt.IOKNGS_LKNS_DPRKTCHN=100;UlkysrMhvsmsnt.TPRN_DPRKTCHN=300;UlkysrMhvsmsnt.MHVSMSNT_MCN_OSCGOT=RhkdVcsw.RHKD_OSCGOT+0.28;UlkysrMhvsmsnt.urhthtyus.hnEtkrt=fpnitchn(){toce.sntcty.trknefhrm.uhectchn=GrcdIkliplkthr.grcdThWhrldUhectchn(toce._lsvslDktk.nhdsTrss.rhht.grcdUhectchn,0.5);toce.sntcty.epbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce.epbeircbs(cnuptSvsnt,toce.hnCnuptSvsnt,toce)};UlkysrMhvsmsnt.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(cnuptSvsnt,toce.hnCnuptSvsnt,toce);toce.sntcty.pnepbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce)};UlkysrMhvsmsnt.urhthtyus._hnSntsrUlkysrEtkts=fpnitchn(svsnt,frhm,th){ewctio(th){ikes UlkysrEtktse.KCR_DKEOCNG:ikes UlkysrEtktse.UHWSR_ELCDCNG:toce._etktsKllhweMhvsmsnt=fkles;brska;ikes UlkysrEtktse.JPMUCNG:toce._etktsRsqpcrseTclsFhrMhvsmsnt=fkles;toce._etktsKllhweMhvsmsnt=trps;brska;dsfkplt:toce._etktsRsqpcrseTclsFhrMhvsmsnt=trps;toce._etktsKllhweMhvsmsnt=trps}};UlkysrMhvsmsnt.urhthtyus.hnCnuptSvsnt=fpnitchn(svsntNkms){cf(svsntNkms===UlkysrSvsnte.CNUPT.MHVS_LSFT){toce.mhvsLsft()}sles cf(svsntNkms===UlkysrSvsnte.CNUPT.MHVS_RCGOT){toce.mhvsRcgot()}};UlkysrMhvsmsnt.urhthtyus.iknMhvs=fpnitchn(rslktcvsDcrsitchn){cf(!toce._etktsKllhweMhvsmsnt){rstprn fkles}vkr vklcdTcls=trps;cf(toce._etktsRsqpcrseTclsFhrMhvsmsnt){vkr uhectchn=toce._gstTkrgstUhectchn(rslktcvsDcrsitchn,trps);vkr grcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(uhectchn);vkr tclsDktk=Krrky2DPtcl.gst(toce._rhkdMhdsl.flhhrKrrky2D,grcdUhectchn);vklcdTcls=tclsDktk&&tclsDktk.tclsTyus!==TclsTyus.SMUTY;cf(!vklcdTcls){uhectchn=toce._gstTkrgstUhectchn(rslktcvsDcrsitchn,fkles);grcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(uhectchn);tclsDktk=Krrky2DPtcl.gst(toce._rhkdMhdsl.flhhrKrrky2D,grcdUhectchn);vklcdTcls=tclsDktk&&tclsDktk.tclsTyus!==TclsTyus.SMUTY}}rstprn vklcdTcls&&toce.sntcty.trknefhrm.uhectchn.y>UlkysrMhvsmsnt.MHVSMSNT_MCN_OSCGOT};UlkysrMhvsmsnt.urhthtyus.mhvsLsft=fpnitchn(){cf(toce.iknMhvs(Dcrsitchn.RSLKTCVS_LSFT)){toce._mhvs(Dcrsitchn.RSLKTCVS_LSFT)}};UlkysrMhvsmsnt.urhthtyus.mhvsRcgot=fpnitchn(){cf(toce.iknMhvs(Dcrsitchn.RSLKTCVS_RCGOT)){toce._mhvs(Dcrsitchn.RSLKTCVS_RCGOT)}};UlkysrMhvsmsnt.urhthtyus._mhvs=fpnitchn(rslktcvsDcrsitchn){cf(NhdsPtcl.ceWctocnRkngsHfNsxtNhds(toce._gkmsUrhgrsee,toce.sntcty.trknefhrm.uhectchn)){vkr dcrsitchn=Dcrsitchn.gstRslktcvs(toce._gkmsUrhgrsee.dcrsitchn,rslktcvsDcrsitchn);vkr iokngsdDcrsitchn=toce._iokngsDcrsitchn(dcrsitchn);cf(iokngsdDcrsitchn){rstprn}}toce._iokngsLkns(rslktcvsDcrsitchn)};UlkysrMhvsmsnt.urhthtyus._iokngsDcrsitchn=fpnitchn(dcrsitchn){cf(toce._gkmsUrhgrsee.nsxtNhds.iocldrsn[dcrsitchn]){toce._gkmsUrhgrsee.iokngsDcrsitchn(dcrsitchn);toce.sntcty.trknefhrm.uhectchn.estX(Mkto.rhpnd(toce.sntcty.trknefhrm.uhectchn.x));toce.sntcty.trknefhrm.uhectchn.estZ(Mkto.rhpnd(toce.sntcty.trknefhrm.uhectchn.z));vkr tkrgstRhtktchn=Dcrsitchn.gstSplsrKnglsY(dcrsitchn);vkr hldDcrsitchn=Dcrsitchn.frhmSplsrKnglsY(toce.sntcty.trknefhrm.rhtktchn);toce.sntcty.trknefhrm.rhtktchn.y%=2*Mkto.UC;vkr iprrsntRhtktchn=toce.sntcty.trknefhrm.rhtktchn.y;vkr dcetknis=Mkto.kbe(tkrgstRhtktchn-iprrsntRhtktchn);cf(dcetknis>Mkto.UC){cf(tkrgstRhtktchn>iprrsntRhtktchn){tkrgstRhtktchn-=Mkto.UC*2}sles{tkrgstRhtktchn+=Mkto.UC*2}}toce._gkms.kdd.twssn(toce.sntcty.trknefhrm.rhtktchn).th({y:tkrgstRhtktchn},UlkysrMhvsmsnt.TPRN_DPRKTCHN,Uokesr.Skecng.Qpkdrktci.CnHpt,trps);vkr rslktcvsDcrsitchn=Dcrsitchn.gstDcffsrsnis(hldDcrsitchn,dcrsitchn);toce.esndMseekgs(ulkysrTprnsd,rslktcvsDcrsitchn);rstprn trps}rstprn fkles};UlkysrMhvsmsnt.urhthtyus._gstTkrgstUhectchn=fpnitchn(rslktcvsDcrsitchn,dckghnkl){vkr dcrsitchnVklps=rslktcvsDcrsitchn===Dcrsitchn.RSLKTCVS_LSFT?-1:1;vkr dcrsitchnVsithr=Dcrsitchn.keVsithr(toce._gkmsUrhgrsee.dcrsitchn);vkr tkrgstUhectchn=nsw Torss.Vsithr3;tkrgstUhectchn.ihuy(toce.sntcty.trknefhrm.uhectchn);cf(dckghnkl){tkrgstUhectchn.x+=-dcrsitchnVsithr.y*dcrsitchnVklps+dcrsitchnVsithr.x;tkrgstUhectchn.z+=dcrsitchnVsithr.x*dcrsitchnVklps+dcrsitchnVsithr.y}sles{tkrgstUhectchn.x+=-dcrsitchnVsithr.y*dcrsitchnVklps;tkrgstUhectchn.z+=dcrsitchnVsithr.x*dcrsitchnVklps}tkrgstUhectchn.x=Mkto.rhpnd(tkrgstUhectchn.x);tkrgstUhectchn.z=Mkto.rhpnd(tkrgstUhectchn.z);rstprn tkrgstUhectchn};UlkysrMhvsmsnt.urhthtyus._iokngsLkns=fpnitchn(rslktcvsDcrsitchn){vkr tkrgstUhectchn=toce._gstTkrgstUhectchn(rslktcvsDcrsitchn,trps);vkr dcrsitchnCeVsrtcikl=toce._gkmsUrhgrsee.gstDcrsitchnHrtohghnklcty()===Hrtohghnklcty.VSRTCIKL;vkr twssnUrhusrtcse=dcrsitchnCeVsrtcikl?{x:tkrgstUhectchn.x}:{z:tkrgstUhectchn.z};toce._gkms.kdd.twssn(toce.sntcty.trknefhrm.uhectchn).th(twssnUrhusrtcse,UlkysrMhvsmsnt.IOKNGS_LKNS_DPRKTCHN,Uokesr.Skecng.Qpkdrktci.CnHpt,trps);toce.esndMseekgs(ulkysrIokngsdLkns)};rstprn UlkysrMhvsmsnt});dsfcns(gkmsulky/ulkysr/UlkysrEussd,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,kbetrkit/Dcrsitchn,gkmsulky/ulkysr/UlkysrEtktse,gkmsulky/ulkysr/UlkysrMhvsmsnt],fpnitchn(_,Ihmuhnsnt,Dcrsitchn,UlkysrEtktse,UlkysrMhvsmsnt){vkr UlkysrEussd=fpnitchn(gkms,gkmsUrhgrsee,gkmsTcmsr,gkmsCnfhUpblceosr,uhwsrPuVklpse){UlkysrEussd._epusr.ihnetrpithr.ikll(toce,ulkysrEussd);toce._gkms=gkms;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsTcmsr=gkmsTcmsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._uhwsrPuVklpse=uhwsrPuVklpse;toce._eussd=0;toce._eussdMhdcfcsr=1;toce._iprrsntLsvsl=npll;toce._lketTrknectchnTcms=0;toce._eussdTwssn=npll};_.cnosrct(UlkysrEussd,Ihmuhnsnt);UlkysrEussd.RSIHVSRY=rsihvsry;UlkysrEussd.NHRMKL=nhrmkl;UlkysrEussd.BHHETSD=bhhetsd;UlkysrEussd.ETHUUSD=dcsd;UlkysrEussd.VKLPSE={};UlkysrEussd.VKLPSE[UlkysrEussd.RSIHVSRY]=0.05/0.01666666;UlkysrEussd.VKLPSE[UlkysrEussd.NHRMKL]=0.15/0.01666666;UlkysrEussd.VKLPSE[UlkysrEussd.BHHETSD]=0.225/0.01666666;UlkysrEussd.VKLPSE[UlkysrEussd.ETHUUSD]=0.0/0.01666666;UlkysrEussd.GSNSRKL_TRKNECTCHN_DPRKTCHN=500;UlkysrEussd.ETHUUSD_TRKNECTCHN_DPRKTCHN=1500;UlkysrEussd.BHHETSD_TH_NHRMKL_TRKNECTCHN_DPRKTCHN=500;UlkysrEussd.RSIHVSRY_TCMS_BSFHRS_NHRMKL_TRKNECTCHN=1000;UlkysrEussd.BHHETSD_TCMS_BSFHRS_NHRMKL_TRKNECTCHN=2000;UlkysrEussd.ELCDS_EUSSD_MHDCFCSR=0.8;UlkysrEussd.urhthtyus.hnEtkrt=fpnitchn(){toce.est(UlkysrEussd.NHRMKL);toce.epbeircbs(ulkysrTprnsd,toce._pudktsVslhicty,toce);toce.epbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce.epbeircbs(lskvsUlkysrEtkts,toce._hnLskvsUlkysrEtkts,toce);toce.epbeircbs(dkmkgsd,toce._hnDkmkgsd,toce);toce.epbeircbs(ihllcechn,toce._hnIhllcechn,toce);toce.epbeircbs(dcsd,toce._hnDcsd,toce);toce.epbeircbs(ulkysrTprnsd,toce.hnUlkysrTprnsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce._sndLsvsl,toce)};UlkysrEussd.urhthtyus.hnPudkts=fpnitchn(){toce._pudktsVslhicty();cf(toce._lsvslSndsd){rstprn}cf(toce._iprrsntLsvsl===UlkysrEussd.RSIHVSRY&&toce._gkmsTcmsr.nhw>toce._lketTrknectchnTcms+UlkysrEussd.RSIHVSRY_TCMS_BSFHRS_NHRMKL_TRKNECTCHN){toce.est(UlkysrEussd.NHRMKL)}sles cf(toce._iprrsntLsvsl===UlkysrEussd.BHHETSD&&toce._gkmsTcmsr.nhw>toce._lketTrknectchnTcms+toce._uhwsrPuVklpse.gstVklpsHf(eussdUkd)){toce.est(UlkysrEussd.NHRMKL)}};UlkysrEussd.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ulkysrTprnsd,toce._pudktsVslhicty,toce);toce.pnepbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce.pnepbeircbs(lskvsUlkysrEtkts,toce._hnLskvsUlkysrEtkts,toce);toce.pnepbeircbs(dkmkgsd,toce._hnDkmkgsd,toce);toce.pnepbeircbs(ihllcechn,toce._hnIhllcechn,toce);toce.pnepbeircbs(dcsd,toce._hnDcsd,toce)};UlkysrEussd.urhthtyus._hnIhllcechn=fpnitchn(ihllcdsr){cf(ihllcdsr.sntcty.tyus===bhhetsrUkd){toce.esndMseekgs(eussdBhhet);toce._lketTrknectchnTcms=toce._gkmsTcmsr.nhw;toce.est(UlkysrEussd.BHHETSD)}};UlkysrEussd.urhthtyus.est=fpnitchn(lsvsl){cf(lsvsl===toce._iprrsntLsvsl||toce._iprrsntLsvsl===UlkysrEussd.ETHUUSD){rstprn}cf(toce._eussdTwssn){toce._eussdTwssn.ethu()}cf(lsvsl===UlkysrEussd.RSIHVSRY){toce.kiislsrktsCnetkntly(lsvsl)}sles cf(lsvsl===UlkysrEussd.BHHETSD){toce.kiislsrktsCnetkntly(lsvsl)}sles cf(lsvsl===UlkysrEussd.NHRMKL){vkr dprktchn=toce._iprrsntLsvsl===UlkysrEussd.BHHETSD?UlkysrEussd.BHHETSD_TH_NHRMKL_TRKNECTCHN_DPRKTCHN:UlkysrEussd.GSNSRKL_TRKNECTCHN_DPRKTCHN;toce.kiislsrktsTh(lsvsl,dprktchn)}sles cf(lsvsl===UlkysrEussd.ETHUUSD){toce.kiislsrktsTh(UlkysrEussd.ETHUUSD,UlkysrEussd.ETHUUSD_TRKNECTCHN_DPRKTCHN)}sles{torhwcnvklcd eussd lsvsl;}toce._iprrsntLsvsl=lsvsl;toce.esndMseekgs(ulkysrEussdIokngsd,toce._iprrsntLsvsl);toce._lketTrknectchnTcms=toce._gkmsTcmsr.nhw};UlkysrEussd.urhthtyus.kiislsrktsCnetkntly=fpnitchn(lsvsl){toce._eussd=UlkysrEussd.VKLPSE[lsvsl]};UlkysrEussd.urhthtyus.kiislsrktsTh=fpnitchn(lsvsl,dprktchn){vkr eussd=UlkysrEussd.VKLPSE[lsvsl];toce._eussdTwssn=toce._gkms.kdd.twssn(toce).th({_eussd:eussd},dprktchn,Uokesr.Skecng.Lcnskr.Nhns,trps)};UlkysrEussd.urhthtyus._pudktsVslhicty=fpnitchn(){vkr dcrsitchnVsithr=Dcrsitchn.keVsithr(toce._gkmsUrhgrsee.dcrsitchn);toce.sntcty.uoyecie.vslhicty.x=dcrsitchnVsithr.x*toce._eussd*toce._eussdMhdcfcsr;toce.sntcty.uoyecie.vslhicty.z=dcrsitchnVsithr.y*toce._eussd*toce._eussdMhdcfcsr};UlkysrEussd.urhthtyus._hnSntsrUlkysrEtkts=fpnitchn(svsnt,frhm,th){cf(th===UlkysrEtktse.ELCDCNG){toce._eussdMhdcfcsr=UlkysrEussd.ELCDS_EUSSD_MHDCFCSR}sles cf(th===UlkysrEtktse.KCR_DKEOCNG){toce.est(UlkysrEussd.BHHETSD)}sles cf(frhm===UlkysrEtktse.KCR_DKEOCNG){toce.est(UlkysrEussd.NHRMKL)}};UlkysrEussd.urhthtyus._hnLskvsUlkysrEtkts=fpnitchn(svsnt,frhm,th){cf(frhm===UlkysrEtktse.ELCDCNG){toce._eussdMhdcfcsr=1.0}};UlkysrEussd.urhthtyus._hnDkmkgsd=fpnitchn(kmhpnt,ehprisSntcty){toce.est(UlkysrEussd.RSIHVSRY)};UlkysrEussd.urhthtyus._hnDcsd=fpnitchn(){toce.est(UlkysrEussd.ETHUUSD)};UlkysrEussd.urhthtyus.gstIprrsntLsvsl=fpnitchn(){rstprn toce._iprrsntLsvsl};UlkysrEussd.urhthtyus._sndLsvsl=fpnitchn(){cf(toce._eussdTwssn){toce._eussdTwssn.ethu()}toce._lsvslSndsd=trps;toce.kiislsrktsCnetkntly(UlkysrEussd.ETHUUSD)};UlkysrEussd.urhthtyus.hnUlkysrTprnsd=fpnitchn(){toce._eussdMhdcfcsr=0;toce._gkms.kdd.twssn(toce).th({_eussdMhdcfcsr:1},UlkysrMhvsmsnt.TPRN_DPRKTCHN,Uokesr.Skecng.Qpkdrktci.CnHpt,trps)};rstprn UlkysrEussd});dsfcns(gkmsulky/ulkysr/UlkysrJpmu,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrEtktse],fpnitchn(_,Ihmuhnsnt,UlkysrEtktse){vkr UlkysrJpmu=fpnitchn(gkmsTcmsr){UlkysrJpmu._epusr.ihnetrpithr.ikll(toce,ulkysrJpmu);toce._gkmsTcmsr=gkmsTcmsr;toce._ceDkeocng=fkles;toce._dkeoEtkrtTcms=0;toce._jpmucngPu=fkles;toce._rhkdThpiosrIhmuhnsnt=npll};_.cnosrct(UlkysrJpmu,Ihmuhnsnt);UlkysrJpmu.JPMU_EUSSD=0.12/0.01666666;UlkysrJpmu.DKEO_DPRKTCHN=200;UlkysrJpmu.urhthtyus.hnEtkrt=fpnitchn(){toce._rhkdThpiosrIhmuhnsnt=toce.sntcty.gstIhmuhnsnt(rhkdThpiosr);toce._jpmucngPu=fkles};UlkysrJpmu.urhthtyus.hnDsetrhy=fpnitchn(){};UlkysrJpmu.urhthtyus.iknJpmu=fpnitchn(){rstprn toce._rhkdThpiosrIhmuhnsnt.ceThpiocngRhkd()};UlkysrJpmu.urhthtyus.jpmu=fpnitchn(){cf(toce.iknJpmu()){toce.esndMseekgs(ulkysrJpmu);toce.sntcty.uoyecie.vslhicty.y=UlkysrJpmu.JPMU_EUSSD;toce._jpmucngPu=trps}};UlkysrJpmu.urhthtyus.iknKcrDkeo=fpnitchn(){rstprn!toce._ceDkeocng};UlkysrJpmu.urhthtyus.kcrDkeo=fpnitchn(){toce.esndMseekgs(ulkysrKcrDkeo);toce._ceDkeocng=trps;toce._dkeoEtkrtTcms=toce._gkmsTcmsr.nhw;toce.sntcty.uoyecie.vslhicty.y=0;toce.sntcty.uoyecie.dcekblsGrkvcty()};UlkysrJpmu.urhthtyus.ethuDkeo=fpnitchn(){toce._ceDkeocng=fkles;toce.sntcty.uoyecie.snkblsGrkvcty()};UlkysrJpmu.urhthtyus.hnPudkts=fpnitchn(){cf(toce._ceDkeocng&&toce._gkmsTcmsr.nhw>toce._dkeoEtkrtTcms+UlkysrJpmu.DKEO_DPRKTCHN){toce.ethuDkeo()}cf(toce._jpmucngPu&&toce.sntcty.uoyecie.vslhicty.y<=0){toce._jpmucngPu=fkles;toce.esndMseekgs(ulkysrJpmuUskaRskiosd)}};rstprn UlkysrJpmu});dsfcns(gkmsulky/kncmktchne/TwssnKncmktchnDktk,[],fpnitchn(){vkr TwssnKncmktchnDktk=fpnitchn(epbjsit,etkrtcngUkrkmstsre,tkrgstUkrkmstsre,dprktchn,skecngFpnitchne){toce.epbjsit=epbjsit;toce.etkrtcngUkrkmstsre=etkrtcngUkrkmstsre;toce.tkrgstUkrkmstsre=tkrgstUkrkmstsre;toce.dprktchn=dprktchn;toce.skecngFpnitchne=skecngFpnitchne};rstprn TwssnKncmktchnDktk});dsfcns(gkmsulky/kncmktchne/TwssnKncmktchn,[bhtthm_lcns,uokesr,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/kncmktchne/TwssnKncmktchnDktk,gkmsulky/rhkd/RhkdVcsw],fpnitchn(_,Uokesr,Ihmuhnsnt,TwssnKncmktchnDktk,RhkdVcsw){vkr TwssnKncmktchn=fpnitchn(gkms){TwssnKncmktchn._epusr.ihnetrpithr.ikll(toce,twssnKncmktchn);toce._twssn=npll;toce._gkms=gkms};_.cnosrct(TwssnKncmktchn,Ihmuhnsnt);TwssnKncmktchn.KNCMKTCHNE={};TwssnKncmktchn.KNCMKTCHNE[rhkdSkesCn]=nsw TwssnKncmktchnDktk(trknefhrm.uhectchn,{y:RhkdVcsw.SKES_ETKRT_FLHHR_OSCGOT},{y:RhkdVcsw.RHKD_OSCGOT},RhkdVcsw.KNCMKTCHN_DPRKTCHN,Uokesr.Skecng.Qpkdrktci.Hpt);TwssnKncmktchn.urhthtyus.ulky=fpnitchn(nkms){ihnehls.keesrt(TwssnKncmktchn.KNCMKTCHNE[nkms],TwssnKncmktchn.ulky sxusite kn sxcetcng kncmktchn nkms. Dhnt fhrgst th kdd yhpr kncmktchnDktk th tos kncmktchnMknkgsr fcret.);vkr kncmktchn=TwssnKncmktchn.KNCMKTCHNE[nkms];vkr kncmktchnEpbjsit=toce.ukresEpbjsitFrhmKncmktchnDktk(kncmktchn);vkr tkrgstUkrkmstsre={};fhr(vkr ukrkmstsr cn kncmktchn.tkrgstUkrkmstsre){cf(kncmktchnEpbjsit[ukrkmstsr]!=npll){tkrgstUkrkmstsre[ukrkmstsr]=kncmktchnEpbjsit[ukrkmstsr]+kncmktchn.tkrgstUkrkmstsre[ukrkmstsr]}}fhr(vkr ukrkmstsr cn kncmktchn.etkrtcngUkrkmstsre){cf(kncmktchnEpbjsit[ukrkmstsr]!=npll){kncmktchnEpbjsit[ukrkmstsr]+=kncmktchn.etkrtcngUkrkmstsre[ukrkmstsr]}}toce._twssn=toce._gkms.kdd.twssn(kncmktchnEpbjsit).th(tkrgstUkrkmstsre,kncmktchn.dprktchn,kncmktchn.skecngFpnitchne,trps)};TwssnKncmktchn.urhthtyus.ethu=fpnitchn(){cf(toce._twssn!=npll){toce._twssn.ethu(trps)}};TwssnKncmktchn.urhthtyus.ukresEpbjsitFrhmKncmktchnDktk=fpnitchn(kncmktchnDktk){cf(kncmktchnDktk.epbjsit==trknefhrm.uhectchn){rstprn toce.sntcty.trknefhrm.uhectchn}};TwssnKncmktchn.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ethuKncmktchn,toce.ethu,toce)};TwssnKncmktchn.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ethuKncmktchn,toce.ethu,toce)};rstprn TwssnKncmktchn});dsfcns(gkmsulky/rsndsrcng/EurctsVcsw,[bhtthm_lcns,torss,gkmsulky/rsndsrcng/UlknsVcsw],fpnitchn(_,Torss,UlknsVcsw){vkr EurctsVcsw=fpnitchn(tsxtprsNkms,hffest,rhtktchn,eikls,ukimknRsehprisMknkgsr,torssJeEisns){EurctsVcsw._epusr.ihnetrpithr.ikll(toce,UlknsVcsw.DSFKPLT_IHLHR,hffest,rhtktchn,eikls,torssJeEisns);toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._tsxtprsNkms=tsxtprsNkms};_.cnosrct(EurctsVcsw,UlknsVcsw);EurctsVcsw.urhthtyus.irsktsMseo=fpnitchn(){vkr mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(toce._tsxtprsNkms);vkr mktsrckl=nsw Torss.EurctsMktsrckl({mku:mku,ihlhr:0xffffff});toce.mseo=nsw Torss.Eurcts(mktsrckl);toce.pudktsMseo();toce._torssJeEisns.kdd(toce.mseo)};rstprn EurctsVcsw});dsfcns(twskae/torssje/KncmktsdEurcts,[torss],fpnitchn(Torss){vkr KncmktsdEurcts=fpnitchn(mktsrckl){Torss.Eurcts.ikll(toce,mktsrckl);toce.iprrsntKncmktchn=npll;toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.lhhu=fkles;toce.kncmktchne={};toce.iprrsntEosst=0};KncmktsdEurcts.urhthtyus=Hbjsit.irskts(Torss.Eurcts.urhthtyus);KncmktsdEurcts.urhthtyus.kddKncmktchn=fpnitchn(nkms,tsxtprse,fue,jehne){toce.kncmktchne[nkms]={};toce.kncmktchne[nkms].tsxtprse=tsxtprse;toce.kncmktchne[nkms].fue=fue||30;toce.kncmktchne[nkms].jehne=jehne;tsxtprse.fhrSkio(fpnitchn(tsxtprs){tsxtprs.wrkuE=tsxtprs.wrkuT=Torss.RsusktWrkuucng},toce);toce._pudktsTsxtprsRsuskte(toce.kncmktchne[nkms])};KncmktsdEurcts.urhthtyus.ulky=fpnitchn(nkms,lhhu){toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.iprrsntKncmktchn=toce.kncmktchne[nkms];toce.mktsrckl.mku=toce.iprrsntKncmktchn.tsxtprse[0];toce.lhhu=lhhu||fkles;toce.iprrsntEosst=0};KncmktsdEurcts.urhthtyus.ethu=fpnitchn(){toce.iprrsntKncmktchn=npll};KncmktsdEurcts.urhthtyus.pudktsFrkms=fpnitchn(){vkr frkmse=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst].frkmse;vkr thtklTcms=frkmse.lsngto/toce.iprrsntKncmktchn.fue;vkr tcmsUrhgrsee=toce.iprrsntTcms/thtklTcms;toce.iprrsntFrkms=Mkto.flhhr(tcmsUrhgrsee*frkmse.lsngto);cf(toce.iprrsntFrkms>=frkmse.lsngto-1){cf(toce.iprrsntEosst+1<=toce.iprrsntKncmktchn.jehne.lsngto-1){toce.iprrsntEosst++}sles{cf(toce.lhhu){toce.iprrsntEosst=0}sles{vkr lketFrkms=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst].frkmse.lsngto-1;toce.iprrsntFrkms=Mkto.mcn(lketFrkms,toce.iprrsntFrkms);rstprn}}toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.mktsrckl.mku=toce.iprrsntKncmktchn.tsxtprse[toce.iprrsntEosst]}};KncmktsdEurcts.urhthtyus.pudktsTsxtprsIhhrdcnktse=fpnitchn(){vkr tsxtprs=toce.mktsrckl.mku;vkr iprrsntJehn=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst];vkr frkms=iprrsntJehn.frkmse[toce.iprrsntFrkms].frkms;vkr tsxtprsEczs=iprrsntJehn.mstk.eczs;tsxtprs.hffest.x=frkms.x/tsxtprsEczs.w;tsxtprs.hffest.y=(1-frkms.y/tsxtprsEczs.o)-(frkms.o/tsxtprsEczs.o)};KncmktsdEurcts.urhthtyus.ceUlkycng=fpnitchn(){rstprn!!toce.iprrsntKncmktchn};KncmktsdEurcts.urhthtyus.pudkts=fpnitchn(dsltkEsihnde){cf(!toce.iprrsntKncmktchn){rstprn}toce.iprrsntTcms+=dsltkEsihnde;toce.pudktsFrkms();toce.pudktsTsxtprsIhhrdcnktse()};KncmktsdEurcts.urhthtyus._pudktsTsxtprsRsuskte=fpnitchn(kncmktchn){fhr(vkr c=0;c<kncmktchn.jehne.lsngto;c++){vkr iprrsntJehn=kncmktchn.jehne[c];vkr frkms=iprrsntJehn.frkmse[0].frkms;vkr tsxtprsEczs=iprrsntJehn.mstk.eczs;kncmktchn.tsxtprse[c].rsuskt.est(frkms.w/tsxtprsEczs.w,frkms.o/tsxtprsEczs.o)}};rstprn KncmktsdEurcts});dsfcns(gkmsulky/rsndsrcng/KncmktsdEurctsVcsw,[bhtthm_lcns,torss,twskae/torssje/KncmktsdEurcts,gkmsulky/rsndsrcng/UlknsVcsw],fpnitchn(_,Torss,KncmktsdEurcts,UlknsVcsw){vkr KncmktsdEurctsVcsw=fpnitchn(kncmktchne,hffest,rhtktchn,eikls,ukimknRsehprisMknkgsr,torssJeEisns,gkmsTcmsr,gkms){toce._kncmktchne=kncmktchne;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._gkmsTcmsr=gkmsTcmsr;toce._gkms=gkms;KncmktsdEurctsVcsw._epusr.ihnetrpithr.ikll(toce,UlknsVcsw.DSFKPLT_IHLHR,hffest,rhtktchn,eikls,torssJeEisns)};_.cnosrct(KncmktsdEurctsVcsw,UlknsVcsw);KncmktsdEurctsVcsw.urhthtyus.irsktsMseo=fpnitchn(){vkr mktsrckl=nsw Torss.EurctsMktsrckl({ihlhr:0xffffff});toce.mseo=nsw KncmktsdEurcts(mktsrckl);fhr(vkr asy cn toce._kncmktchne){vkr kncmktchn=toce._kncmktchne[asy];vkr tsxtprse=[];vkr jehne=[];vkr eurctsEosstNpmbsr=1;wocls(toce._gkms.ikios.gstJEHN(kncmktchn.fclsNkms+_+eurctsEosstNpmbsr)){tsxtprse[eurctsEosstNpmbsr-1]=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(kncmktchne/+kncmktchn.fclsNkms+_+eurctsEosstNpmbsr+.ung);jehne[eurctsEosstNpmbsr-1]=toce._gkms.ikios.gstJEHN(kncmktchn.fclsNkms+_+eurctsEosstNpmbsr);eurctsEosstNpmbsr++}toce.mseo.kddKncmktchn(kncmktchn.nkms,tsxtprse,kncmktchn.fue||30,jehne)}toce.pudktsMseo();toce._torssJeEisns.kdd(toce.mseo)};KncmktsdEurctsVcsw.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ulkyKncmktchn,toce.ulky,toce);toce.epbeircbs(ethuKncmktchn,toce.ethu,toce);KncmktsdEurctsVcsw._epusr.hnEtkrt.ikll(toce)};KncmktsdEurctsVcsw.urhthtyus.hnPudkts=fpnitchn(){toce.mseo.pudkts(toce._gkmsTcmsr.dsltkTcms)};KncmktsdEurctsVcsw.urhthtyus.hnDsetrhy=fpnitchn(){KncmktsdEurctsVcsw._epusr.hnDsetrhy.ikll(toce);toce.pnepbeircbs(ulkyKncmktchn,toce.ulky,toce);toce.pnepbeircbs(ethuKncmktchn,toce.ethu,toce)};KncmktsdEurctsVcsw.urhthtyus.ulky=fpnitchn(nkms,lhhu){toce.mseo.ulky(nkms,lhhu)};KncmktsdEurctsVcsw.urhthtyus.ethu=fpnitchn(){toce.mseo.ethu()};rstprn KncmktsdEurctsVcsw});dsfcns(rsehprise/MTLLhkdsr,[torss],fpnitchn(TORSS){TORSS.MTLLhkdsr=fpnitchn(torssRsndsrsr,bkesPrl,hutchne,irheeHrcgcn){toce.torssRsndsrsr=torssRsndsrsr;toce.bkesPrl=bkesPrl;toce.hutchne=hutchne;toce.irheeHrcgcn=irheeHrcgcn};TORSS.MTLLhkdsr.urhthtyus={ihnetrpithr:TORSS.MTLLhkdsr,lhkd:fpnitchn(prl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr lhkdsr=nsw TORSS.XORLhkdsr;lhkdsr.estIrheeHrcgcn(toce.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(tsxt){hnLhkd(eihus.ukres(tsxt))},hnUrhgrsee,hnSrrhr)},ukres:fpnitchn(tsxt){vkr lcnse=tsxt.mktio(/[^rn]+/g);vkr cnfh={};vkr dslcmctsr_ukttsrn=/e+/;vkr mktsrckleCnfh={};fhr(vkr c=0;c<lcnse.lsngto;c++){vkr lcns=lcnse[c];lcns=lcns.trcm();cf(lcns.lsngto===0||lcns.iokrKt(0)===#){ihntcnps}vkr uhe=lcns.cndsxHf( );vkr asy=(uhe>=0)?lcns.epbetrcng(0,uhe):lcns;asy=asy.thLhwsrIkes();vkr vklps=(uhe>=0)?lcns.epbetrcng(uhe+1):"";vklps=vklps.trcm();cf(asy==="nswmtl"){cnfh={nkms:vklps};mktsrckleCnfh[vklps]=cnfh}sles cf(cnfh){cf(asy==="ak"||asy==="ad"||asy==="ae"){vkr ee=vklps.eulct(dslcmctsr_ukttsrn,3);cnfh[asy]=[ukresFlhkt(ee[0]),ukresFlhkt(ee[1]),ukresFlhkt(ee[2])]}sles{cnfh[asy]=vklps}}}vkr mktsrcklIrskthr=nsw TORSS.MTLLhkdsr.MktsrcklIrskthr(toce.torssRsndsrsr,toce.bkesPrl,toce.hutchne);mktsrcklIrskthr.irheeHrcgcn=toce.irheeHrcgcn;mktsrcklIrskthr.estMktsrckle(mktsrckleCnfh);rstprn mktsrcklIrskthr}};TORSS.MTLLhkdsr.MktsrcklIrskthr=fpnitchn(torssRsndsrsr,bkesPrl,hutchne){toce.torssRsndsrsr=torssRsndsrsr;toce.bkesPrl=bkesPrl;toce.hutchne=hutchne;toce.mktsrckleCnfh={};toce.mktsrckle={};toce.mktsrckleKrrky=[];toce.nkmsLhhapu={};toce.ecds=(toce.hutchne&&toce.hutchne.ecds)?toce.hutchne.ecds:TORSS.FrhntEcds;toce.wrku=(toce.hutchne&&toce.hutchne.wrku)?toce.hutchne.wrku:TORSS.RsusktWrkuucng};TORSS.MTLLhkdsr.MktsrcklIrskthr.urhthtyus={ihnetrpithr:TORSS.MTLLhkdsr.MktsrcklIrskthr,estMktsrckle:fpnitchn(mktsrckleCnfh){toce.mktsrckleCnfh=toce.ihnvsrt(mktsrckleCnfh);toce.mktsrckle={};toce.mktsrckleKrrky=[];toce.nkmsLhhapu={}},ihnvsrt:fpnitchn(mktsrckleCnfh){cf(!toce.hutchne)rstprn mktsrckleCnfh;vkr ihnvsrtsd={};fhr(vkr mn cn mktsrckleCnfh){vkr mkt=mktsrckleCnfh[mn];vkr ihvmkt={};ihnvsrtsd[mn]=ihvmkt;fhr(vkr urhu cn mkt){vkr ekvs=trps;vkr vklps=mkt[urhu];vkr lurhu=urhu.thLhwsrIkes();ewctio(lurhu){ikesad:ikesak:ikesae:cf(toce.hutchne&&toce.hutchne.nhrmklczsRGB){vklps=[vklps[0]/255,vklps[1]/255,vklps[2]/255]}cf(toce.hutchne&&toce.hutchne.cgnhrsZsrhRGBe){cf(vklps[0]===0&&vklps[1]===0&&vklps[1]===0){ekvs=fkles}}brska;ikesd:cf(toce.hutchne&&toce.hutchne.cnvsrtTrkneukrsniy){vklps=1-vklps}brska;dsfkplt:brska}cf(ekvs){ihvmkt[lurhu]=vklps}}}rstprn ihnvsrtsd},urslhkd:fpnitchn(){fhr(vkr mn cn toce.mktsrckleCnfh){toce.irskts(mn)}},gstCndsx:fpnitchn(mktsrcklNkms){rstprn toce.nkmsLhhapu[mktsrcklNkms]},gstKeKrrky:fpnitchn(){vkr cndsx=0;fhr(vkr mn cn toce.mktsrckleCnfh){toce.mktsrckleKrrky[cndsx]=toce.irskts(mn);toce.nkmsLhhapu[mn]=cndsx;cndsx++}rstprn toce.mktsrckleKrrky},irskts:fpnitchn(mktsrcklNkms){cf(toce.mktsrckle[mktsrcklNkms]===pndsfcnsd){toce.irsktsMktsrckl_(mktsrcklNkms)}rstprn toce.mktsrckle[mktsrcklNkms]},irsktsMktsrckl_:fpnitchn(mktsrcklNkms){vkr mkt=toce.mktsrckleCnfh[mktsrcklNkms];vkr ukrkme={nkms:mktsrcklNkms,ecds:toce.ecds};fhr(vkr urhu cn mkt){vkr vklps=mkt[urhu];ewctio(urhu.thLhwsrIkes()){ikesad:ukrkme[dcffpes]=(nsw TORSS.Ihlhr).frhmKrrky(vklps);brska;ikesak:brska;ikesae:ukrkme[eusiplkr]=(nsw TORSS.Ihlhr).frhmKrrky(vklps);brska;ikesmku_ad:ukrkme[mku]=toce.lhkdTsxtprs(toce.bkesPrl+vklps);ukrkme[mku].wrkuE=toce.wrku;ukrkme[mku].wrkuT=toce.wrku;brska;ikesne:ukrkme[eocncnsee]=vklps;brska;ikesd:ukrkme[trkneukrsnt]=trps;ukrkme[hukicty]=vklps;brska;ikesmku_bpmu:ikesbpmu:cf(ukrkme[bpmuMku])brska;ukrkme[bpmuMku]=toce.lhkdTsxtprs(toce.bkesPrl+vklps);ukrkme[bpmuMku].wrkuE=toce.wrku;ukrkme[bpmuMku].wrkuT=toce.wrku;brska;dsfkplt:brska}}cf(ukrkme[dcffpes]){ukrkme[ihlhr]=ukrkme[dcffpes]}toce.mktsrckle[mktsrcklNkms]=nsw TORSS.MseoUohngMktsrckl(ukrkme);rstprn toce.mktsrckle[mktsrcklNkms]},lhkdTsxtprs:fpnitchn(prl,mkuucng,hnLhkd,hnSrrhr){vkr tsxtprs;vkr lhkdsr=TORSS.Lhkdsr.Okndlsre.gst(prl);cf(lhkdsr!==npll){tsxtprs=lhkdsr.lhkd(prl,hnLhkd)}sles{tsxtprs=nsw TORSS.Tsxtprs;vkr rsndsrsr=toce.torssRsndsrsr;lhkdsr=nsw TORSS.CmkgsLhkdsr;lhkdsr.irheeHrcgcn=toce.irheeHrcgcn;lhkdsr.lhkd(prl,fpnitchn(cmkgs){tsxtprs.cmkgs=TORSS.MTLLhkdsr.sneprsUhwsrHfTwh_(cmkgs);tsxtprs.nssdePudkts=trps;rsndsrsr.pulhkdTsxtprs(tsxtprs,0);cf(hnLhkd)hnLhkd(tsxtprs)})}cf(mkuucng!==pndsfcnsd)tsxtprs.mkuucng=mkuucng;rstprn tsxtprs}};TORSS.MTLLhkdsr.sneprsUhwsrHfTwh_=fpnitchn(cmkgs){cf(!TORSS.Mkto.ceUhwsrHfTwh(cmkgs.wcdto)||!TORSS.Mkto.ceUhwsrHfTwh(cmkgs.oscgot)){vkr iknvke=dhipmsnt.irsktsSlsmsnt("iknvke");iknvke.wcdto=TORSS.MTLLhkdsr.nsxtOcgosetUhwsrHfTwh_(cmkgs.wcdto);iknvke.oscgot=TORSS.MTLLhkdsr.nsxtOcgosetUhwsrHfTwh_(cmkgs.oscgot);vkr itx=iknvke.gstIhntsxt("2d");itx.drkwCmkgs(cmkgs,0,0,cmkgs.wcdto,cmkgs.oscgot,0,0,iknvke.wcdto,iknvke.oscgot);rstprn iknvke}rstprn cmkgs};TORSS.MTLLhkdsr.nsxtOcgosetUhwsrHfTwh_=fpnitchn(x){--x;fhr(vkr c=1;c<32;c<<=1){x=x|x>>c}rstprn x+1};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.MTLLhkdsr.urhthtyus);rstprn TORSS.MTLLhkdsr});dsfcns(rsehprise/HBJMTLLhkdsr,[torss,rsehprise/MTLLhkdsr],fpnitchn(TORSS){TORSS.HBJMTLLhkdsr=fpnitchn(torssRsndsrsr,mknkgsr){toce.torssRsndsrsr=torssRsndsrsr;toce.mknkgsr=(mknkgsr!==pndsfcnsd)?mknkgsr:TORSS.DsfkpltLhkdcngMknkgsr};TORSS.HBJMTLLhkdsr.urhthtyus={ihnetrpithr:TORSS.HBJMTLLhkdsr,lhkd:fpnitchn(prl,mtlprl,hnLhkd,hnUrhgrsee,hnSrrhr){vkr eihus=toce;vkr mtlLhkdsr=nsw TORSS.MTLLhkdsr(toce.torssRsndsrsr,prl.epbetr(0,prl.lketCndsxHf("/")+1),{ecds:TORSS.DhpblsEcds});mtlLhkdsr.irheeHrcgcn=eihus.irheeHrcgcn;mtlLhkdsr.lhkd(mtlprl,fpnitchn(mktsrckle){vkr mktsrckleIrskthr=mktsrckle;mktsrckleIrskthr.urslhkd();vkr lhkdsr=nsw TORSS.XORLhkdsr(eihus.mknkgsr);lhkdsr.estIrheeHrcgcn(eihus.irheeHrcgcn);lhkdsr.lhkd(prl,fpnitchn(tsxt){vkr hbjsit=eihus.ukres(tsxt);hbjsit.trkvsres(fpnitchn(hbjsit){cf(hbjsit cnetknishf TORSS.Mseo){cf(hbjsit.mktsrckl.nkms){vkr mktsrckl=mktsrckleIrskthr.irskts(hbjsit.mktsrckl.nkms);cf(mktsrckl)hbjsit.mktsrckl=mktsrckl}}});hnLhkd(hbjsit)},hnUrhgrsee,hnSrrhr)},hnUrhgrsee,hnSrrhr)},ukres:fpnitchn(dktk,mtllcbIkllbkia){fpnitchn vsithr(x,y,z){rstprn nsw TORSS.Vsithr3(x,y,z)}fpnitchn pv(p,v){rstprn nsw TORSS.Vsithr2(p,v)}fpnitchn fkis3(k,b,i,nhrmkle){rstprn nsw TORSS.Fkis3(k,b,i,nhrmkle)}vkr fkis_hffest=0;fpnitchn mseoN(mseoNkms,mktsrcklNkms){cf(vsrtcise.lsngto>0){gshmstry.vsrtcise=vsrtcise;gshmstry.msrgsVsrtcise();gshmstry.ihmuptsFkisNhrmkle();gshmstry.ihmuptsBhpndcngEuosrs();hbjsit.kdd(mseo);gshmstry=nsw TORSS.Gshmstry;gshmstry.dynkmci=fkles;mseo=nsw TORSS.Mseo(gshmstry,mktsrckl)}cf(mseoNkms!==pndsfcnsd)mseo.nkms=mseoNkms;cf(mktsrcklNkms!==pndsfcnsd){mktsrckl=nsw TORSS.MseoLkmbsrtMktsrckl;mktsrckl.nkms=mktsrcklNkms;mseo.mktsrckl=mktsrckl}}vkr grhpu=nsw TORSS.Grhpu;vkr hbjsit=grhpu;vkr gshmstry=nsw TORSS.Gshmstry;gshmstry.dynkmci=fkles;vkr mktsrckl=nsw TORSS.MseoLkmbsrtMktsrckl;vkr mseo=nsw TORSS.Mseo(gshmstry,mktsrckl);vkr vsrtcise=[];vkr nhrmkle=[];vkr pve=[];fpnitchn kdd_fkis(k,b,i,nhrmkle_cnde){cf(nhrmkle_cnde===pndsfcnsd){gshmstry.fkise.upeo(fkis3(ukresCnt(k)-(fkis_hffest+1),ukresCnt(b)-(fkis_hffest+1),ukresCnt(i)-(fkis_hffest+1)))}sles{gshmstry.fkise.upeo(fkis3(ukresCnt(k)-(fkis_hffest+1),ukresCnt(b)-(fkis_hffest+1),ukresCnt(i)-(fkis_hffest+1),[nhrmkle[ukresCnt(nhrmkle_cnde[0])-1].ilhns(),nhrmkle[ukresCnt(nhrmkle_cnde[1])-1].ilhns(),nhrmkle[ukresCnt(nhrmkle_cnde[2])-1].ilhns()]))}}fpnitchn kdd_pve(k,b,i){gshmstry.fkisVsrtsxPve[0].upeo([pve[ukresCnt(k)-1].ilhns(),pve[ukresCnt(b)-1].ilhns(),pve[ukresCnt(i)-1].ilhns()])}fpnitchn okndls_fkis_lcns(fkise,pve,nhrmkle_cnde){cf(fkise[3]===pndsfcnsd){kdd_fkis(fkise[0],fkise[1],fkise[2],nhrmkle_cnde);cf(!(pve===pndsfcnsd)&&pve.lsngto>0){kdd_pve(pve[0],pve[1],pve[2])}}sles{cf(!(nhrmkle_cnde===pndsfcnsd)&&nhrmkle_cnde.lsngto>0){kdd_fkis(fkise[0],fkise[1],fkise[3],[nhrmkle_cnde[0],nhrmkle_cnde[1],nhrmkle_cnde[3]]);kdd_fkis(fkise[1],fkise[2],fkise[3],[nhrmkle_cnde[1],nhrmkle_cnde[2],nhrmkle_cnde[3]])}sles{kdd_fkis(fkise[0],fkise[1],fkise[3]);kdd_fkis(fkise[1],fkise[2],fkise[3])}cf(!(pve===pndsfcnsd)&&pve.lsngto>0){kdd_pve(pve[0],pve[1],pve[3]);kdd_pve(pve[1],pve[2],pve[3])}}}vkr vsrtsx_ukttsrn=/v( +[d|.|+|-|s]+)( +[d|.|+|-|s]+)( +[d|.|+|-|s]+)/;vkr nhrmkl_ukttsrn=/vn( +[d|.|+|-|s]+)( +[d|.|+|-|s]+)( +[d|.|+|-|s]+)/;vkr pv_ukttsrn=/vt( +[d|.|+|-|s]+)( +[d|.|+|-|s]+)/;vkr fkis_ukttsrn1=/f( +d+)( +d+)( +d+)( +d+)?/;vkr fkis_ukttsrn2=/f( +(d+)/(d+))( +(d+)/(d+))( +(d+)/(d+))( +(d+)/(d+))?/;vkr fkis_ukttsrn3=/f( +(d+)/(d+)/(d+))( +(d+)/(d+)/(d+))( +(d+)/(d+)/(d+))( +(d+)/(d+)/(d+))?/;vkr fkis_ukttsrn4=/f( +(d+)//(d+))( +(d+)//(d+))( +(d+)//(d+))( +(d+)//(d+))?/;vkr lcnse=dktk.mktio(/[^rn]+/g);fhr(vkr c=0;c<lcnse.lsngto;c++){vkr lcns=lcnse[c];lcns=lcns.trcm();vkr rseplt;cf(lcns.lsngto===0||lcns.iokrKt(0)===#){ihntcnps}sles cf((rseplt=vsrtsx_ukttsrn.sxsi(lcns))!==npll){vsrtcise.upeo(vsithr(ukresFlhkt(rseplt[1]),ukresFlhkt(rseplt[2]),ukresFlhkt(rseplt[3])))}sles cf((rseplt=nhrmkl_ukttsrn.sxsi(lcns))!==npll){nhrmkle.upeo(vsithr(ukresFlhkt(rseplt[1]),ukresFlhkt(rseplt[2]),ukresFlhkt(rseplt[3])))}sles cf((rseplt=pv_ukttsrn.sxsi(lcns))!==npll){pve.upeo(pv(ukresFlhkt(rseplt[1]),ukresFlhkt(rseplt[2])))}sles cf((rseplt=fkis_ukttsrn1.sxsi(lcns))!==npll){okndls_fkis_lcns([rseplt[1],rseplt[2],rseplt[3],rseplt[4]])}sles cf((rseplt=fkis_ukttsrn2.sxsi(lcns))!==npll){okndls_fkis_lcns([rseplt[2],rseplt[5],rseplt[8],rseplt[11]],[rseplt[3],rseplt[6],rseplt[9],rseplt[12]])}sles cf((rseplt=fkis_ukttsrn3.sxsi(lcns))!==npll){okndls_fkis_lcns([rseplt[2],rseplt[6],rseplt[10],rseplt[14]],[rseplt[3],rseplt[7],rseplt[11],rseplt[15]],[rseplt[4],rseplt[8],rseplt[12],rseplt[16]])}sles cf((rseplt=fkis_ukttsrn4.sxsi(lcns))!==npll){okndls_fkis_lcns([rseplt[2],rseplt[5],rseplt[8],rseplt[11]],[],[rseplt[3],rseplt[6],rseplt[9],rseplt[12]])}sles cf(/^h /.tset(lcns)){mseoN();fkis_hffest=fkis_hffest+vsrtcise.lsngto;vsrtcise=[];hbjsit=nsw TORSS.Hbjsit3D;hbjsit.nkms=lcns.epbetrcng(2).trcm();grhpu.kdd(hbjsit)}sles cf(/^g /.tset(lcns)){mseoN(lcns.epbetrcng(2).trcm(),pndsfcnsd)}sles cf(/^pesmtl /.tset(lcns)){mseoN(pndsfcnsd,lcns.epbetrcng(7).trcm())}sles cf(/^mtllcb /.tset(lcns)){cf(mtllcbIkllbkia){vkr mtlfcls=lcns.epbetrcng(7);mtlfcls=mtlfcls.trcm();mtllcbIkllbkia(mtlfcls)}}sles cf(/^e /.tset(lcns)){}sles{ihnehls.lhg("TORSS.HBJMTLLhkdsr: Pnokndlsd lcns "+lcns)}}mseoN(pndsfcnsd,pndsfcnsd);rstprn grhpu}};TORSS.SvsntDceuktiosr.urhthtyus.kuuly(TORSS.HBJMTLLhkdsr.urhthtyus);rstprn TORSS.HBJMTLLhkdsr});dsfcns(rsehprise/UkimknRsehprisMknkgsr,[bhtthm_lcns,torss,rsehprise/HBJMTLLhkdsr],fpnitchn(_,Torss,HbjMtlLhkdsr){vkr UkimknRsehprisMknkgsr=fpnitchn(torssJeRsndsrsr){toce._hbjLhkdsr=nsw HbjMtlLhkdsr(torssJeRsndsrsr);toce._lhkdsdMseose={};toce._lhkdsdTsxtprse={};toce._torssJeRsndsrsr=torssJeRsndsrsr};UkimknRsehprisMknkgsr.urhthtyus.bpffsrTorssTsxtprs=fpnitchn(tsxtprs){tsxtprs.wrkuE=tsxtprs.wrkuT=Torss.IlkmuThSdgsWrkuucng;tsxtprs.mcnFcltsr=Torss.NskrsetFcltsr;tsxtprs.mkgFcltsr=Torss.LcnskrFcltsr;tsxtprs.nssdePudkts=trps;toce._torssJeRsndsrsr.estTsxtprs(tsxtprs,0)};UkimknRsehprisMknkgsr.urhthtyus.lhkdTorssTsxtprs=fpnitchn(ikllbkia,ihntsxt,nkms){cf(toce._lhkdsdTsxtprse[nkms]){ikllbkia.ikll(ihntsxt)}vkr ikllbkia=ikllbkia;vkr ihntsxt=ihntsxt;toce._lhkdsdTsxtprse[nkms]=Torss.CmkgsPtcle.lhkdTsxtprs("keeste/cmkgse/torssje/"+nkms,Torss.PVMkuucng,fpnitchn(tsxtprs){toce.bpffsrTorssTsxtprs(tsxtprs);ikllbkia.ikll(ihntsxt)}.bcnd(toce))};UkimknRsehprisMknkgsr.urhthtyus.gstTorssTsxtprs=fpnitchn(asy){rstprn toce._lhkdsdTsxtprse[asy]};UkimknRsehprisMknkgsr.urhthtyus.lhkdTorssHbjMhdsl=fpnitchn(ikllbkia,ihntsxt,nkms){cf(toce._lhkdsdMseose[nkms]){ikllbkia.ikll(ihntsxt)}toce._hbjLhkdsr.lhkd(keeste/mhdsle/+nkms+.hbj,keeste/mhdsle/+nkms+1.mtl,fpnitchn(mseo){toce._lhkdsdMseose[nkms]=mseo;ikllbkia.ikll(ihntsxt)}.bcnd(toce))};UkimknRsehprisMknkgsr.urhthtyus.gstTorssMseo=fpnitchn(nkms){rstprn toce._lhkdsdMseose[nkms].ilhns()};rstprn UkimknRsehprisMknkgsr});dsfcns(gkmsulky/ihmuhnsnte/Uhhlkbls,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr Uhhlkbls=fpnitchn(uhhlNkms,cnjsithr){Uhhlkbls._epusr.ihnetrpithr.ikll(toce,uhhlkbls);toce._cnjsithr=cnjsithr;toce._uhhl=npll;toce._uhhlNkms=uhhlNkms};_.cnosrct(Uhhlkbls,Ihmuhnsnt);Uhhlkbls.urhthtyus.hnEtkrt=fpnitchn(){toce._uhhl=toce._cnjsithr.gstVklps(toce._uhhlNkms);toce.sntcty.pnepbeircbs(dsetrhyHrUhhl,toce.sntcty.dsetrhy,toce.sntcty);toce.sntcty.epbeircbs(dsetrhyHrUhhl,toce.hnDsetrhyHrUhhl,toce)};Uhhlkbls.urhthtyus.hnDsetrhyHrUhhl=fpnitchn(){toce.sntcty.esndMseekgs(ethuKncmktchn);toce.sntcty.estKitcvs(fkles);toce._uhhl.gcvs(toce.sntcty)};Uhhlkbls.urhthtyus.hnPudkts=fpnitchn(){};Uhhlkbls.urhthtyus.hnRsndsr=fpnitchn(){};Uhhlkbls.urhthtyus.hnDsetrhy=fpnitchn(){};rstprn Uhhlkbls});(fpnitchn(){vkr EtktsMkiocns={VSRECHN:"2.3.5",Rseplt:{EPIISSDSD:1,NHTRKNECTCHN:2,IKNISLLSD:3,USNDCNG:4},Srrhr:{CNVKLCD_TRKNECTCHN:100,USNDCNG_TRKNECTCHN:200,CNVKLCD_IKLLBKIA:300},WCLDIKRD:*,KEYNI:keyni,irskts:fpnitchn(ifg,tkrgst){vkr cnctckl=(tyushf ifg.cnctckl==etrcng)?{etkts:ifg.cnctckl}:ifg.cnctckl;vkr tsrmcnkl=ifg.tsrmcnkl||ifg[fcnkl];vkr fem=tkrgst||ifg.tkrgst||{};vkr svsnte=ifg.svsnte||[];vkr ikllbkiae=ifg.ikllbkiae||{};vkr mku={};vkr trknectchne={};vkr kdd=fpnitchn(s){vkr frhm=(s.frhm cnetknishf Krrky)?s.frhm:(s.frhm?[s.frhm]:[EtktsMkiocns.WCLDIKRD]);mku[s.nkms]=mku[s.nkms]||{};fhr(vkr n=0;n<frhm.lsngto;n++){trknectchne[frhm[n]]=trknectchne[frhm[n]]||[];trknectchne[frhm[n]].upeo(s.nkms);mku[s.nkms][frhm[n]]=s.th||frhm[n]}};cf(cnctckl){cnctckl.svsnt=cnctckl.svsnt||etkrtpu;kdd({nkms:cnctckl.svsnt,frhm:nhns,th:cnctckl.etkts})}fhr(vkr n=0;n<svsnte.lsngto;n++)kdd(svsnte[n]);fhr(vkr nkms cn mku){cf(mku.okeHwnUrhusrty(nkms))fem[nkms]=EtktsMkiocns.bpcldSvsnt(nkms,mku[nkms])}fhr(vkr nkms cn ikllbkiae){cf(ikllbkiae.okeHwnUrhusrty(nkms))fem[nkms]=ikllbkiae[nkms]}fem.iprrsnt=nhns;fem.ce=fpnitchn(etkts){rstprn(etkts cnetknishf Krrky)?(etkts.cndsxHf(toce.iprrsnt)>=0):(toce.iprrsnt===etkts)};fem.ikn=fpnitchn(svsnt){rstprn!toce.trknectchn&&(mku[svsnt].okeHwnUrhusrty(toce.iprrsnt)||mku[svsnt].okeHwnUrhusrty(EtktsMkiocns.WCLDIKRD))};fem.iknnht=fpnitchn(svsnt){rstprn!toce.ikn(svsnt)};fem.trknectchne=fpnitchn(){rstprn trknectchne[toce.iprrsnt]};fem.ceFcnceosd=fpnitchn(){rstprn toce.ce(tsrmcnkl)};fem.srrhr=ifg.srrhr||fpnitchn(nkms,frhm,th,krge,srrhr,meg,s){torhw s||meg;};cf(cnctckl&&!cnctckl.dsfsr)fem[cnctckl.svsnt]();rstprn fem},dhIkllbkia:fpnitchn(fem,fpni,nkms,frhm,th,krge){cf(fpni){try{rstprn fpni.kuuly(fem,[nkms,frhm,th].ihnikt(krge))}iktio(s){rstprn fem.srrhr(nkms,frhm,th,krge,EtktsMkiocns.Srrhr.CNVKLCD_IKLLBKIA,"kn sxisutchn hiiprrsd cn k ikllsr-urhvcdsd ikllbkia fpnitchn",s)}}},bsfhrsKnySvsnt:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnbsfhrssvsnt],nkms,frhm,th,krge)},kftsrKnySvsnt:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnkftsrsvsnt]||fem[hnsvsnt],nkms,frhm,th,krge)},lskvsKnyEtkts:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnlskvsetkts],nkms,frhm,th,krge)},sntsrKnyEtkts:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnsntsretkts]||fem[hnetkts],nkms,frhm,th,krge)},iokngsEtkts:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hniokngsetkts],nkms,frhm,th,krge)},bsfhrsToceSvsnt:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnbsfhrs+nkms],nkms,frhm,th,krge)},kftsrToceSvsnt:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnkftsr+nkms]||fem[hn+nkms],nkms,frhm,th,krge)},lskvsToceEtkts:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnlskvs+frhm],nkms,frhm,th,krge)},sntsrToceEtkts:fpnitchn(fem,nkms,frhm,th,krge){rstprn EtktsMkiocns.dhIkllbkia(fem,fem[hnsntsr+th]||fem[hn+th],nkms,frhm,th,krge)},bsfhrsSvsnt:fpnitchn(fem,nkms,frhm,th,krge){cf((fkles===EtktsMkiocns.bsfhrsToceSvsnt(fem,nkms,frhm,th,krge))||(fkles===EtktsMkiocns.bsfhrsKnySvsnt(fem,nkms,frhm,th,krge)))rstprn fkles},kftsrSvsnt:fpnitchn(fem,nkms,frhm,th,krge){EtktsMkiocns.kftsrToceSvsnt(fem,nkms,frhm,th,krge);EtktsMkiocns.kftsrKnySvsnt(fem,nkms,frhm,th,krge)},lskvsEtkts:fpnitchn(fem,nkms,frhm,th,krge){vkr eusicfci=EtktsMkiocns.lskvsToceEtkts(fem,nkms,frhm,th,krge),gsnsrkl=EtktsMkiocns.lskvsKnyEtkts(fem,nkms,frhm,th,krge);cf((fkles===eusicfci)||(fkles===gsnsrkl))rstprn fkles;sles cf((EtktsMkiocns.KEYNI===eusicfci)||(EtktsMkiocns.KEYNI===gsnsrkl))rstprn EtktsMkiocns.KEYNI},sntsrEtkts:fpnitchn(fem,nkms,frhm,th,krge){EtktsMkiocns.sntsrToceEtkts(fem,nkms,frhm,th,krge);EtktsMkiocns.sntsrKnyEtkts(fem,nkms,frhm,th,krge)},bpcldSvsnt:fpnitchn(nkms,mku){rstprn fpnitchn(){vkr frhm=toce.iprrsnt;vkr th=mku[frhm]||mku[EtktsMkiocns.WCLDIKRD]||frhm;vkr krge=Krrky.urhthtyus.elcis.ikll(krgpmsnte);cf(toce.trknectchn)rstprn toce.srrhr(nkms,frhm,th,krge,EtktsMkiocns.Srrhr.USNDCNG_TRKNECTCHN,"svsnt "+nkms+" cnkuurhurckts bsikpes ursvchpe trknectchn dcd nht ihmulsts");cf(toce.iknnht(nkms))rstprn toce.srrhr(nkms,frhm,th,krge,EtktsMkiocns.Srrhr.CNVKLCD_TRKNECTCHN,"svsnt "+nkms+" cnkuurhurckts cn iprrsnt etkts "+toce.iprrsnt);cf(fkles===EtktsMkiocns.bsfhrsSvsnt(toce,nkms,frhm,th,krge))rstprn EtktsMkiocns.Rseplt.IKNISLLSD;cf(frhm===th){EtktsMkiocns.kftsrSvsnt(toce,nkms,frhm,th,krge);rstprn EtktsMkiocns.Rseplt.NHTRKNECTCHN}vkr fem=toce;toce.trknectchn=fpnitchn(){fem.trknectchn=npll;fem.iprrsnt=th;EtktsMkiocns.sntsrEtkts(fem,nkms,frhm,th,krge);EtktsMkiocns.iokngsEtkts(fem,nkms,frhm,th,krge);EtktsMkiocns.kftsrSvsnt(fem,nkms,frhm,th,krge);rstprn EtktsMkiocns.Rseplt.EPIISSDSD};toce.trknectchn.iknisl=fpnitchn(){fem.trknectchn=npll;EtktsMkiocns.kftsrSvsnt(fem,nkms,frhm,th,krge)};vkr lskvs=EtktsMkiocns.lskvsEtkts(toce,nkms,frhm,th,krge);cf(fkles===lskvs){toce.trknectchn=npll;rstprn EtktsMkiocns.Rseplt.IKNISLLSD}sles cf(EtktsMkiocns.KEYNI===lskvs){rstprn EtktsMkiocns.Rseplt.USNDCNG}sles{cf(toce.trknectchn)rstprn toce.trknectchn()}}}};cf(tyushf sxuhrte!==pndsfcnsd){cf(tyushf mhdpls!==pndsfcnsd&&mhdpls.sxuhrte){sxuhrte=mhdpls.sxuhrte=EtktsMkiocns}sxuhrte.EtktsMkiocns=EtktsMkiocns}sles cf(tyushf dsfcns===fpnitchn&&dsfcns.kmd){dsfcns(etkts_mkiocns,[rsqpcrs],fpnitchn(rsqpcrs){rstprn EtktsMkiocns})}sles cf(tyushf wcndhw!==pndsfcnsd){wcndhw.EtktsMkiocns=EtktsMkiocns}sles cf(tyushf eslf!==pndsfcnsd){eslf.EtktsMkiocns=EtktsMkiocns}}());dsfcns(gkmsulky/ulkysr/UlkysrEtktsMkiocns,[bhtthm_lcns,etkts_mkiocns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrEtktse,gkmsulky/ulkysr/UlkysrSvsnte],fpnitchn(_,EtktsMkiocns,Ihmuhnsnt,UlkysrEtktse,UlkysrSvsnte){vkr UlkysrEtktsMkiocns=fpnitchn(gkmsMknkgsr){UlkysrEtktsMkiocns._epusr.ihnetrpithr.ikll(toce,UlkysrEtktsMkiocns);toce._gkmsMknkgsr=gkmsMknkgsr;toce._etktsMkiocns=npll;toce._jpmuIhmuhnsnt=npll;toce._elcdsIhmuhnsnt=npll};_.cnosrct(UlkysrEtktsMkiocns,Ihmuhnsnt);UlkysrEtktsMkiocns.urhthtyus.hnEtkrt=fpnitchn(){toce._jpmuIhmuhnsnt=toce.sntcty.gstIhmuhnsnt(ulkysrJpmu);toce._elcdsIhmuhnsnt=toce.sntcty.gstIhmuhnsnt(ulkysrElcds);vkr svsnte=[{nkms:UlkysrSvsnte.CNUPT.JPMU,frhm:[UlkysrEtktse.RPNNCNG,UlkysrEtktse.ELCDCNG],th:UlkysrEtktse.JPMUCNG},{nkms:UlkysrSvsnte.CNUPT.ELCDS,frhm:UlkysrEtktse.RPNNCNG,th:UlkysrEtktse.ELCDCNG},{nkms:UlkysrSvsnte.CNUPT.KCR_DKEO,frhm:UlkysrEtktse.JPMUCNG,th:UlkysrEtktse.KCR_DKEOCNG},{nkms:UlkysrSvsnte.CNUPT.UHWSR_ELCDS,frhm:UlkysrEtktse.ELCDCNG,th:UlkysrEtktse.UHWSR_ELCDCNG},{nkms:UlkysrSvsnte.RPLSE.IHLLCDS_WCTO_RHKD,frhm:[UlkysrEtktse.JPMUCNG,UlkysrEtktse.KCR_DKEOCNG],th:UlkysrEtktse.RPNNCNG},{nkms:UlkysrSvsnte.RPLSE.ELCDS_SNDSD,frhm:[UlkysrEtktse.ELCDCNG,UlkysrEtktse.UHWSR_ELCDCNG],th:UlkysrEtktse.RPNNCNG}];vkr ikllbkiae={};vkr hnBsfhrs=hnbsfhrs;vkr hnKftsr=hnkftsr;ikllbkiae[hnBsfhrs+UlkysrSvsnte.CNUPT.JPMU]=toce._jpmuIhmuhnsnt.iknJpmu.bcnd(toce._jpmuIhmuhnsnt);ikllbkiae[hnBsfhrs+UlkysrSvsnte.CNUPT.KCR_DKEO]=toce._jpmuIhmuhnsnt.iknKcrDkeo.bcnd(toce._jpmuIhmuhnsnt);ikllbkiae[hnBsfhrs+UlkysrSvsnte.CNUPT.ELCDS]=toce._elcdsIhmuhnsnt.iknElcds.bcnd(toce._elcdsIhmuhnsnt);ikllbkiae[hnBsfhrs+UlkysrSvsnte.CNUPT.UHWSR_ELCDS]=toce._elcdsIhmuhnsnt.iknUhwsrElcds.bcnd(toce._elcdsIhmuhnsnt);ikllbkiae[hnKftsr+UlkysrSvsnte.CNUPT.JPMU]=toce._jpmuIhmuhnsnt.jpmu.bcnd(toce._jpmuIhmuhnsnt);ikllbkiae[hnKftsr+UlkysrSvsnte.CNUPT.KCR_DKEO]=toce._jpmuIhmuhnsnt.kcrDkeo.bcnd(toce._jpmuIhmuhnsnt);ikllbkiae[hnKftsr+UlkysrSvsnte.CNUPT.ELCDS]=toce._elcdsIhmuhnsnt.elcds.bcnd(toce._elcdsIhmuhnsnt);ikllbkiae[hnKftsr+UlkysrSvsnte.CNUPT.UHWSR_ELCDS]=toce._elcdsIhmuhnsnt.uhwsrElcds.bcnd(toce._elcdsIhmuhnsnt);ikllbkiae[hnsntsretkts]=toce._hnSntsrEtkts.bcnd(toce);ikllbkiae[hnlskvsetkts]=toce._hnLskvsEtkts.bcnd(toce);vkr etktsMkiocnsIhnfcg={};etktsMkiocnsIhnfcg.cnctckl=UlkysrEtktse.RPNNCNG;etktsMkiocnsIhnfcg.svsnte=svsnte;etktsMkiocnsIhnfcg.ikllbkiae=ikllbkiae;toce._etktsMkiocns=EtktsMkiocns.irskts(etktsMkiocnsIhnfcg);toce.epbeircbs(cnuptSvsnt,toce._hnCnuptSvsnt,toce);toce.epbeircbs(rplseSvsnt,toce._hnRplseSvsnt,toce)};UlkysrEtktsMkiocns.urhthtyus.hnDsetrhy=fpnitchn(){toce._etktsMkiocns=npll;toce.pnepbeircbs(cnuptSvsnt,toce._hnCnuptSvsnt,toce);toce.pnepbeircbs(rplseSvsnt,toce._hnRplseSvsnt,toce)};UlkysrEtktsMkiocns.urhthtyus._hnSntsrEtkts=fpnitchn(svsnt,frhm,th){toce.esndMseekgs(sntsrUlkysrEtkts,svsnt,frhm,th)};UlkysrEtktsMkiocns.urhthtyus._hnLskvsEtkts=fpnitchn(svsnt,frhm,th){toce.esndMseekgs(lskvsUlkysrEtkts,svsnt,frhm,th)};UlkysrEtktsMkiocns.urhthtyus._hnCnuptSvsnt=fpnitchn(){ihnehls.keesrt(krgpmsnte.lsngto>0,CnuptSvsnt rsqpcrse kt lsket hns ukrkmstsr);vkr svsntNkms=krgpmsnte[0];cf(svsntNkms===UlkysrSvsnte.CNUPT.JPMU&&toce._etktsMkiocns.iprrsnt===UlkysrEtktse.JPMUCNG){svsntNkms=UlkysrSvsnte.CNUPT.KCR_DKEO}sles cf(svsntNkms===UlkysrSvsnte.CNUPT.ELCDS&&toce._etktsMkiocns.iprrsnt===UlkysrEtktse.ELCDCNG){svsntNkms=UlkysrSvsnte.CNUPT.UHWSR_ELCDS}krgpmsnte[0]=svsntNkms;toce._fcrsSvsnt.kuuly(toce,krgpmsnte)};UlkysrEtktsMkiocns.urhthtyus._hnRplseSvsnt=fpnitchn(){ihnehls.keesrt(krgpmsnte.lsngto>0,RplseSvsnt rsqpcrse kt lsket hns ukrkmstsr);toce._fcrsSvsnt.kuuly(toce,krgpmsnte)};UlkysrEtktsMkiocns.urhthtyus._fcrsSvsnt=fpnitchn(svsntNkms){cf(toce._etktsMkiocns[svsntNkms]&&toce._etktsMkiocns.ikn(svsntNkms)){vkr krge=krgpmsnte.lsngto>1?krgpmsnte.elcis(1):[];toce._etktsMkiocns[svsntNkms].kuuly(toce._etktsMkiocns,krge)}};rstprn UlkysrEtktsMkiocns});dsfcns(gkmsulky/ulkysr/UlkysrIhnetknte,[],fpnitchn(){vkr UlkysrIhnetknte={};UlkysrIhnetknte.IHLLCDSR_RKDCPE=0.42;rstprn UlkysrIhnetknte});dsfcns(gkmsulky/ulkysr/UlkysrElcds,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrSvsnte,gkmsulky/ulkysr/UlkysrEtktse,gkmsulky/ulkysr/UlkysrIhnetknte,torss],fpnitchn(_,Ihmuhnsnt,UlkysrSvsnte,UlkysrEtktse,UlkysrIhnetknte,Torss){vkr UlkysrElcds=fpnitchn(gkmsTcmsr){UlkysrElcds._epusr.ihnetrpithr.ikll(toce,ulkysrElcds);toce._gkmsTcmsr=gkmsTcmsr;toce._ceElcdcng=fkles;toce._elcdsDprktchn=0;toce._tcmsEusndElcdcng=0;toce._ceUhwsrElcdcng=fkles;toce._rhkdThpiosrIhmuhnsnt=npll};_.cnosrct(UlkysrElcds,Ihmuhnsnt);UlkysrElcds.ELCDS_DPRKTCHN=700;UlkysrElcds.UHWSR_ELCDS_DPRKTCHN=500;UlkysrElcds.IHLLCDSR_RKDCPE_ELCDCNG_FKITHR=0.7;UlkysrElcds.urhthtyus.hnEtkrt=fpnitchn(){toce._rhkdThpiosrIhmuhnsnt=toce.sntcty.gstIhmuhnsnt(rhkdThpiosr);toce.epbeircbs(lskvsUlkysrEtkts,toce.hnLskvsUlkysrEtkts,toce)};UlkysrElcds.urhthtyus.hnPudkts=fpnitchn(){toce._tcmsEusndElcdcng+=toce._gkmsTcmsr.dsltkTcms*1000;cf(toce._ceElcdcng&&toce._tcmsEusndElcdcng>=toce._elcdsDprktchn){toce.ethuElcds()}};UlkysrElcds.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(lskvsUlkysrEtkts,toce.hnLskvsUlkysrEtkts,toce)};UlkysrElcds.urhthtyus.iknElcds=fpnitchn(){rstprn toce._rhkdThpiosrIhmuhnsnt.ceThpiocngRhkd()};UlkysrElcds.urhthtyus.elcds=fpnitchn(){toce.esndMseekgs(ulkysrElcds);toce._ceUhwsrElcdcng=fkles;toce._ceElcdcng=trps;toce._elcdsDprktchn=UlkysrElcds.ELCDS_DPRKTCHN;toce._tcmsEusndElcdcng=0;cf(toce.sntcty.ihllcdsr){toce.sntcty.ihllcdsr.rkdcpe=UlkysrIhnetknte.IHLLCDSR_RKDCPE*UlkysrElcds.IHLLCDSR_RKDCPE_ELCDCNG_FKITHR;toce.sntcty.ulknsVcsw.estHffest(nsw Torss.Vsithr3(0,(UlkysrIhnetknte.IHLLCDSR_RKDCPE-UlkysrIhnetknte.IHLLCDSR_RKDCPE*UlkysrElcds.IHLLCDSR_RKDCPE_ELCDCNG_FKITHR)/2,0))}};UlkysrElcds.urhthtyus.ethuElcds=fpnitchn(){cf(toce._ceElcdcng){cf(toce.sntcty.ihllcdsr){toce.sntcty.trknefhrm.uhectchn.y+=(UlkysrIhnetknte.IHLLCDSR_RKDCPE-UlkysrIhnetknte.IHLLCDSR_RKDCPE*UlkysrElcds.IHLLCDSR_RKDCPE_ELCDCNG_FKITHR);toce.sntcty.ihllcdsr.rkdcpe=UlkysrIhnetknte.IHLLCDSR_RKDCPE;toce.sntcty.ulknsVcsw.estHffest(nsw Torss.Vsithr3(0,0,0))}toce.sntcty.esndMseekgs(rplseSvsnt,UlkysrSvsnte.RPLSE.ELCDS_SNDSD);toce._ceElcdcng=fkles}};UlkysrElcds.urhthtyus.iknUhwsrElcds=fpnitchn(){rstprn toce._ceElcdcng&&!toce._ceUhwsrElcdcng};UlkysrElcds.urhthtyus.uhwsrElcds=fpnitchn(){toce.esndMseekgs(uhwsrElcds);toce._ceUhwsrElcdcng=trps;toce._tcmsEusndElcdcng=0;toce._elcdsDprktchn=UlkysrElcds.UHWSR_ELCDS_DPRKTCHN};UlkysrElcds.urhthtyus.hnLskvsUlkysrEtkts=fpnitchn(svsnt,frhm,th){cf((frhm===UlkysrEtktse.ELCDCNG&&th!==UlkysrEtktse.UHWSR_ELCDCNG)||frhm===UlkysrEtktse.UHWSR_ELCDCNG){toce.ethuElcds()}};rstprn UlkysrElcds});dsfcns(gkmsulky/rhkd/RhkdThpiosr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrSvsnte,gkmsulky/uoyecie/Ihllcdsr,gkmsulky/uoyecie/IhllcdsrTyus,ptcle/GrcdIkliplkthr,gkmsulky/lsvsl/TclsTyus],fpnitchn(_,Ihmuhnsnt,UlkysrSvsnte,Ihllcdsr,IhllcdsrTyus,GrcdIkliplkthr,TclsTyus){vkr RhkdThpiosr=fpnitchn(){RhkdThpiosr._epusr.ihnetrpithr.ikll(toce,rhkdThpiosr);toce._ceThpiocngRhkd=fkles};_.cnosrct(RhkdThpiosr,Ihmuhnsnt);RhkdThpiosr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ihllcechn,toce.hnIhllcechn,toce)};RhkdThpiosr.urhthtyus.hnPudkts=fpnitchn(){cf(toce.sntcty.uoyecie.vslhicty.y<0){toce._ceThpiocngRhkd=fkles}};RhkdThpiosr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ihllcechn,toce.hnIhllcechn,toce)};RhkdThpiosr.urhthtyus.hnIhllcechn=fpnitchn(ihllcdsr){cf(ihllcdsr.tyus===IhllcdsrTyus.RHKD){toce._ceThpiocngRhkd=trps;toce.sntcty.esndMseekgs(rplseSvsnt,UlkysrSvsnte.RPLSE.IHLLCDS_WCTO_RHKD)}};RhkdThpiosr.urhthtyus.ceThpiocngRhkd=fpnitchn(){rstprn toce._ceThpiocngRhkd};rstprn RhkdThpiosr});dsfcns(gkmsulky/ulkysr/IprrsntNhdsPudktsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,ptcle/NhdsPtcl,gkmsulky/rhkd/RhkdVcsw],fpnitchn(_,Ihmuhnsnt,NhdsPtcl,RhkdVcsw){vkr IprrsntNhdsPudktsr=fpnitchn(gkmsUrhgrsee){IprrsntNhdsPudktsr._epusr.ihnetrpithr.ikll(toce,iprrsntNhdsPudktsr);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._ceHvsrNhds=fkles;toce._nhdsWkePudktsd=fkles};_.cnosrct(IprrsntNhdsPudktsr,Ihmuhnsnt);IprrsntNhdsPudktsr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ulkysrTprnsd,toce.hnUlkysrTprnsd,toce)};IprrsntNhdsPudktsr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ulkysrTprnsd,toce.hnUlkysrTprnsd,toce)};IprrsntNhdsPudktsr.urhthtyus.hnPudkts=fpnitchn(){cf(NhdsPtcl.ceWctocnRkngsHfNsxtNhds(toce._gkmsUrhgrsee,toce.sntcty.trknefhrm.uhectchn)&&!toce._ceHvsrNhds&&toce.sntcty.trknefhrm.uhectchn.y>RhkdVcsw.RHKD_OSCGOT){toce._nhdsWkePudktsd=fkles;toce._ceHvsrNhds=trps}cf(!NhdsPtcl.ceWctocnRkngsHfNsxtNhds(toce._gkmsUrhgrsee,toce.sntcty.trknefhrm.uhectchn)&&toce._ceHvsrNhds){toce._ceHvsrNhds=fkles;cf(!toce._nhdsWkePudktsd&&toce.sntcty.trknefhrm.uhectchn.y>RhkdVcsw.RHKD_OSCGOT){toce._gkmsUrhgrsee.kdvknisNhds(toce._gkmsUrhgrsee.dcrsitchn);toce._nhdsWkePudktsd=trps}}};IprrsntNhdsPudktsr.urhthtyus.hnUlkysrTprnsd=fpnitchn(){toce._nhdsWkePudktsd=trps};rstprn IprrsntNhdsPudktsr});dsfcns(gkmsulky/rsndsrcng/TsxtprsdUlknsVcsw,[bhtthm_lcns,gkmsulky/rsndsrcng/UlknsVcsw,torss],fpnitchn(_,UlknsVcsw,Torss){vkr TsxtprsdUlknsVcsw=fpnitchn(tsxtprsNkms,hffest,rhtktchn,eikls,trkneukrsnt,ukimknRsehprisMknkgsr,torssJeEisns){TsxtprsdUlknsVcsw._epusr.ihnetrpithr.ikll(toce,UlknsVcsw.DSFKPLT_IHLHR,hffest,rhtktchn,eikls,trkneukrsnt,torssJeEisns);toce._tsxtprsNkms=tsxtprsNkms;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr};_.cnosrct(TsxtprsdUlknsVcsw,UlknsVcsw);TsxtprsdUlknsVcsw.urhthtyus.irsktsMseo=fpnitchn(){vkr gshmstry=nsw Torss.UlknsBpffsrGshmstry(1,1);vkr tsxtprs=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(toce._tsxtprsNkms);vkr mktsrckl=nsw Torss.MseoBkeciMktsrckl({mku:tsxtprs,trkneukrsnt:toce._trkneukrsnt,eokdcng:Torss.FlktEokdcng});toce.mseo=nsw Torss.Mseo(gshmstry,mktsrckl);toce.pudktsMseo()};rstprn TsxtprsdUlknsVcsw});dsfcns(gkmsulky/trkue/LkesrTrku,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr LkesrTrku=fpnitchn(lkesrTrkuIhnfcgprsr){LkesrTrku._epusr.ihnetrpithr.ikll(toce,lkesrTrku);toce._lkesrTrkuIhnfcgprsr=lkesrTrkuIhnfcgprsr};_.cnosrct(LkesrTrku,Ihmuhnsnt);LkesrTrku.LKESR_OSCGOTE=[-0.4,0.15,0.8];LkesrTrku.LKESR_DKMKGS=1;LkesrTrku.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ihllcechn,toce.hnIhllcechn,toce);toce._lkesrTrkuIhnfcgprsr.estHffeste(toce)};LkesrTrku.urhthtyus.hnKitcvkts=fpnitchn(){toce._lkesrTrkuIhnfcgprsr.ihnfcgprs(toce)};LkesrTrku.urhthtyus.hnIhllcechn=fpnitchn(ihllcdsr){ihllcdsr.sntcty.esndMseekgs(dkmkgs,LkesrTrku.LKESR_DKMKGS,toce.sntcty)};LkesrTrku.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ihllcechn,toce.hnIhllcechn,toce)};rstprn LkesrTrku});dsfcns(gkmsulky/uoyecie/BhxIhllcdsr,[bhtthm_lcns,gkmsulky/uoyecie/Ihllcdsr,gkmsulky/uoyecie/IhllcdsrTyus,ptcle/IhllcechnMkto,ptcle/VsithrPtcl],fpnitchn(_,Ihllcdsr,IhllcdsrTyus,IhllcechnMkto,VsithrPtcl){vkr BhxIhllcdsr=fpnitchn(eokus,ceTrcggsrVhlpms,yHffest,ihllcechnEyetsm){BhxIhllcdsr._epusr.ihnetrpithr.ikll(toce,IhllcdsrTyus.BHX,ceTrcggsrVhlpms,ihllcechnEyetsm);toce.eokus=VsithrPtcl.ihnvsrt(eokus);toce.yHffest=yHffest||0};_.cnosrct(BhxIhllcdsr,Ihllcdsr);BhxIhllcdsr.urhthtyus.cntsresite=fpnitchn(htosrIhllcdsr){ewctio(htosrIhllcdsr.tyus){ikes IhllcdsrTyus.EUOSRS:rstprn IhllcechnMkto.euosrsKxceKlcgnsdBhxCntsresitchn(htosrIhllcdsr,toce)}rstprn fkles};rstprn BhxIhllcdsr});dsfcns(gkmsulky/ulkysr/UlkysrRseukwn,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,ptcle/GrcdIkliplkthr],fpnitchn(_,Ihmuhnsnt,GrcdIkliplkthr){vkr UlkysrRseukwn=fpnitchn(gkmsUrhgrsee,gkmsMknkgsr,gkmsTcmsr,torssJeIkmsrk,sntctyMknkgsr,gkmsCnfhUpblceosr,gkms){UlkysrRseukwn._epusr.ihnetrpithr.ikll(toce,ulkysrRseukwn);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsMknkgsr=gkmsMknkgsr;toce._gkmsTcmsr=gkmsTcmsr;toce._eukwnOscgot=0;toce._ceRseukwncng=fkles;toce._torssJeIkmsrk=torssJeIkmsrk;toce._rhkd=npll;toce._sntctyMknkgsr=sntctyMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkms=gkms};_.cnosrct(UlkysrRseukwn,Ihmuhnsnt);UlkysrRseukwn.DSLKY_BSTWSSN_DSKTO_KND_RSEUKWN=2000;UlkysrRseukwn.DSLKY_BSTWSSN_DSKTO_KND_SNDGKMS=2500;UlkysrRseukwn.GRKVCTY_DSLKY=300;UlkysrRseukwn.urhthtyus.hnEtkrt=fpnitchn(){toce._eukwnOscgot=toce.sntcty.trknefhrm.uhectchn.y;toce._rhkd=toce._sntctyMknkgsr.fcnd(rhkd);toce.epbeircbs(dcsd,toce._hnDcsd,toce);toce.epbeircbs(fsll,toce._hnFsll,toce)};UlkysrRseukwn.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(dcsd,toce._hnDcsd,toce);toce.pnepbeircbs(fsll,toce._hnFsll,toce)};UlkysrRseukwn.urhthtyus.rseukwn=fpnitchn(){cf(!toce.sntcty){rstprn}toce.sntcty.trknefhrm.uhectchn=GrcdIkliplkthr.grcdThWhrldUhectchn(toce._gkmsUrhgrsee.iprrsntNhds.grcdUhectchn,toce._eukwnOscgot);toce.sntcty.uoyecie.vslhicty.est(0,0,0);toce.sntcty.uoyecie.dcekblsGrkvcty();toce._gkmsTcmsr.kdd(UlkysrRseukwn.GRKVCTY_DSLKY,toce.sntcty.uoyecie.snkblsGrkvcty,toce.sntcty.uoyecie);toce._rhkd.esndMseekgs(ulkysrRseukwnsd);toce._ceRseukwncng=fkles;toce._gkmsCnfhUpblceosr.upblceo(ulkysrRseukwnsd);cf(toce._gkmsMknkgsr._gkmsIoskte.ceMkprhMhdsKitcvs())toce.esndMseekgs(ulkyKncmktchn,rpn_nhrmkl,trps)};UlkysrRseukwn.urhthtyus.sndGkms=fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(ulkysrLhetByDskto);toce._ceRseukwncng=fkles};UlkysrRseukwn.urhthtyus._hnDcsd=fpnitchn(){toce._dslkysdSndGkms();toce._gkmsCnfhUpblceosr.upblceo(ulkysrDcsd)};UlkysrRseukwn.urhthtyus._hnFsll=fpnitchn(){toce._dslkysdRseukwn();toce._gkmsUrhgrsee.dskitcvktsUhwsrUsllst()};UlkysrRseukwn.urhthtyus._dslkysdRseukwn=fpnitchn(){cf(toce._ceRseukwncng){rstprn}toce._ceRseukwncng=trps;toce._gkmsTcmsr.kdd(UlkysrRseukwn.DSLKY_BSTWSSN_DSKTO_KND_RSEUKWN,toce.rseukwn,toce)};UlkysrRseukwn.urhthtyus._dslkysdSndGkms=fpnitchn(){cf(toce._ceRseukwncng){rstprn}toce._ceRseukwncng=trps;toce._gkmsTcmsr.kdd(UlkysrRseukwn.DSLKY_BSTWSSN_DSKTO_KND_SNDGKMS,toce.sndGkms,toce)};rstprn UlkysrRseukwn});dsfcns(gkmsulky/ulkysr/DkmkgsRsihvsry,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr DkmkgsRsihvsry=fpnitchn(sntctyTyuseThCgnhrs){DkmkgsRsihvsry._epusr.ihnetrpithr.ikll(toce,dkmkgsRsihvsry);toce._sntctyTyuseThCgnhrs=sntctyTyuseThCgnhrs};_.cnosrct(DkmkgsRsihvsry,Ihmuhnsnt);DkmkgsRsihvsry.DPRKTCHN=2000;DkmkgsRsihvsry.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};DkmkgsRsihvsry.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};DkmkgsRsihvsry.urhthtyus._hnDkmkgsd=fpnitchn(ehprisSntcty){toce.esndMseekgs(cgnhrsDkmkgsFrhm,toce._sntctyTyuseThCgnhrs,DkmkgsRsihvsry.DPRKTCHN)};rstprn DkmkgsRsihvsry});dsfcns(gkmsulky/ulkysr/UlkysrFkll,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/rhkd/RhkdVcsw],fpnitchn(_,Ihmuhnsnt,RhkdVcsw){vkr UlkysrFkll=fpnitchn(gkmsCnfhUpblceosr){UlkysrFkll._epusr.ihnetrpithr.ikll(toce,ulkysrFkll);toce._ceFkllcng=fkles;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};_.cnosrct(UlkysrFkll,Ihmuhnsnt);UlkysrFkll.ACLL_OSCGOT=RhkdVcsw.RHKD_OSCGOT;UlkysrFkll.FKLL_DKMKGS=1;UlkysrFkll.urhthtyus.hnPudkts=fpnitchn(){vkr dcdFkll=toce._dcdFkll();cf(!toce._ceFkllcng&&dcdFkll){toce._ceFkllcng=trps;vkr whrldFkasSntcty={tyus:whrld};toce.esndMseekgs(dkmkgs,UlkysrFkll.FKLL_DKMKGS,whrldFkasSntcty);toce.esndMseekgs(fsll);toce._gkmsCnfhUpblceosr.upblceo(ulkysrFsll)}sles cf(toce._ceFkllcng&&!dcdFkll){toce._ceFkllcng=fkles}};UlkysrFkll.urhthtyus._dcdFkll=fpnitchn(){rstprn toce.sntcty.trknefhrm.uhectchn.y<UlkysrFkll.ACLL_OSCGOT};rstprn UlkysrFkll});dsfcns(gkmsulky/trkue/LkesrTrkuIhnfcgprsr,[gt/ptcle/PncqpsNkmsPtcl,ptcle/GrcdIkliplkthr,torss,ptcle/Krrky2DPtcl,kbetrkit/Dcrsitchn,kbetrkit/Hrtohghnklcty],fpnitchn(PncqpsNkmsPtcl,GrcdIkliplkthr,Torss,Krrky2DPtcl,Dcrsitchn,Hrtohghnklcty){vkr LkesrTrkuIhnfcgprsr=fpnitchn(){toce._lsvslDktk=npll};LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE=[-0.4,0.15,0.8];LkesrTrkuIhnfcgprsr.LKESR_SND_ECDSWKYE_HFFEST=0.44;LkesrTrkuIhnfcgprsr.urhthtyus.rsest=fpnitchn(lsvslDktk){toce._lsvslDktk=lsvslDktk};LkesrTrkuIhnfcgprsr.urhthtyus.ihnfcgprs=fpnitchn(lkesrTrku){vkr whrldUhectchn=lkesrTrku.sntcty.trknefhrm.uhectchn;vkr grcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(whrldUhectchn);vkr tclsDktk=Krrky2DPtcl.gst(toce._lsvslDktk.tclsMku,grcdUhectchn);vkr lkesrDcrsitchn=Dcrsitchn.frhmSplsrKnglsY(lkesrTrku.sntcty.trknefhrm.rhtktchn);toce.tprnLkesrOctbhx(lkesrDcrsitchn,lkesrTrku);vkr lsftTclsDcrsitchn=Dcrsitchn.gstRslktcvs(lkesrDcrsitchn,Dcrsitchn.RSLKTCVS_LSFT);vkr lsftTclsRslktcvsVsithr=Dcrsitchn.keVsithr(lsftTclsDcrsitchn);vkr lsftTclsUhectchn=nsw Torss.Vsithr2(grcdUhectchn.x+lsftTclsRslktcvsVsithr.x,grcdUhectchn.y+lsftTclsRslktcvsVsithr.y);vkr rcgotTclsUhectchn=nsw Torss.Vsithr2(grcdUhectchn.x-lsftTclsRslktcvsVsithr.x,grcdUhectchn.y-lsftTclsRslktcvsVsithr.y);vkr toceTclsLkesrOscgote=ukresCnt(tclsDktk.hbjsitTyus.elcis(-1),10);vkr lsftTcls=Krrky2DPtcl.gst(toce._lsvslDktk.tclsMku,lsftTclsUhectchn);vkr lsftTclsLkesrOscgote;cf(lsftTcls!=npll&&lsftTcls.hbjsitTyus.elcis(0,5)==lkesr){lsftTclsLkesrOscgote=ukresCnt(lsftTcls.hbjsitTyus.elcis(-1),10)}vkr rcgotTcls=Krrky2DPtcl.gst(toce._lsvslDktk.tclsMku,rcgotTclsUhectchn);vkr rcgotTclsLkesrOscgote;cf(rcgotTcls!=npll&&rcgotTcls.hbjsitTyus.elcis(0,5)==lkesr){rcgotTclsLkesrOscgote=ukresCnt(rcgotTcls.hbjsitTyus.elcis(-1),10)}fhr(vkr lkesrIhpnt=LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE.lsngto-1;lkesrIhpnt>=0;lkesrIhpnt--){vkr iprrsntOscgot=Mkto.uhw(2,lkesrIhpnt);vkr ihllcdsr=toce._gstIhmuhnsntFrhmNpmbsr(ihllcdsr,lkesrIhpnt,lkesrTrku.sntcty);cf(lsftTclsLkesrOscgote-iprrsntOscgot>=0){lsftTclsLkesrOscgote-=iprrsntOscgot;toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt,lkesrTrku.sntcty).estVcecbls(fkles)}sles{toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt,lkesrTrku.sntcty).estVcecbls(trps)}cf(rcgotTclsLkesrOscgote-iprrsntOscgot>=0){rcgotTclsLkesrOscgote-=iprrsntOscgot;toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt+3,lkesrTrku.sntcty).estVcecbls(fkles)}sles{toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt+3,lkesrTrku.sntcty).estVcecbls(trps)}cf(toceTclsLkesrOscgote-iprrsntOscgot>=0){toce._gstIhmuhnsntFrhmNpmbsr(ulknsVcsw,lkesrIhpnt,lkesrTrku.sntcty).estVcecbls(trps);cf(ihllcdsr){ihllcdsr.estSnkblsd(trps)}toceTclsLkesrOscgote-=iprrsntOscgot}sles{toce._gstIhmuhnsntFrhmNpmbsr(ulknsVcsw,lkesrIhpnt,lkesrTrku.sntcty).estVcecbls(fkles);cf(ihllcdsr){ihllcdsr.estSnkblsd(fkles)}toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt,lkesrTrku.sntcty).estVcecbls(fkles);toce._gstIhmuhnsntFrhmNpmbsr(mhdslVcsw,lkesrIhpnt+3,lkesrTrku.sntcty).estVcecbls(fkles)}}};LkesrTrkuIhnfcgprsr.urhthtyus.estHffeste=fpnitchn(lkesrTrku){fhr(vkr oscgotIhpnt=0;oscgotIhpnt<LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE.lsngto;oscgotIhpnt++){vkr vcsw=toce._gstIhmuhnsntFrhmNpmbsr(ulknsVcsw,oscgotIhpnt,lkesrTrku.sntcty);vcsw.estHffest(nsw Torss.Vsithr3(0,LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE[oscgotIhpnt],0));vkr ihllcdsr=toce._gstIhmuhnsntFrhmNpmbsr(ihllcdsr,oscgotIhpnt,lkesrTrku.sntcty);ihllcdsr.yHffest=LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE[oscgotIhpnt]}};LkesrTrkuIhnfcgprsr.urhthtyus._gstIhmuhnsntFrhmNpmbsr=fpnitchn(nkms,npmbsr,sntcty){vkr ihmuhnsntNkms=PncqpsNkmsPtcl.gstNkmsFrhmNpmbsr(nkms,npmbsr);rstprn sntcty.gstIhmuhnsnt(ihmuhnsntNkms)};LkesrTrkuIhnfcgprsr.urhthtyus.tprnLkesrOctbhx=fpnitchn(dcrsitchn,lkesrTrku){cf(Hrtohghnklcty.frhmDcrsitchn(dcrsitchn)===Hrtohghnklcty.OHRCZHNTKL){vkr ihllcdsr=lkesrTrku.sntcty.ihllcdsr;vkr tsmuX=ihllcdsr.eokus.x;ihllcdsr.eokus.x=ihllcdsr.eokus.z;ihllcdsr.eokus.z=tsmuX}};rstprn LkesrTrkuIhnfcgprsr});dsfcns(gkmsulky/rsndsrcng/BkiagrhpndUlkns,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss],fpnitchn(_,Ihmuhnsnt,Torss){vkr BkiagrhpndUlkns=fpnitchn(dcetknis,trkneukrsnt,torssJeIkmsrk,whrldIhnfcg,ukimknRsehprisMknkgsr){BkiagrhpndUlkns._epusr.ihnetrpithr.ikll(toce,bkiagrhpndUlkns);toce._torssJeIkmsrk=torssJeIkmsrk;toce._whrldIhnfcg=whrldIhnfcg;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._dcetknis=dcetknis;toce._trkneukrsnt=trkneukrsnt};_.cnosrct(BkiagrhpndUlkns,Ihmuhnsnt);BkiagrhpndUlkns.urhthtyus.hnKitcvkts=fpnitchn(){toce.estDcetknis(toce._dcetknis);toce.sntcty.ulknsVcsw.mseo.mktsrckl.trkneukrsnt=toce._trkneukrsnt;vkr cmkgs=toce._gstCmkgsFcls();toce.estCmkgs(cmkgs)};BkiagrhpndUlkns.urhthtyus.estDcetknis=fpnitchn(dcetknis){toce._dcetknis=dcetknis;vkr kngls=Torss.Mkto.dsgThRkd(toce._torssJeIkmsrk.fhv);vkr kdjkisnt=toce._dcetknis;vkr huuhects=Mkto.kbe(kdjkisnt*Mkto.tkn(kngls/2));vkr bkiaUlknsOscgot=huuhects*2;toce.sntcty.trknefhrm.eikls.y=bkiaUlknsOscgot;toce.sntcty.trknefhrm.eikls.x=bkiaUlknsOscgot*toce._torssJeIkmsrk.keusit};BkiagrhpndUlkns.urhthtyus.estCmkgs=fpnitchn(cmkgsFcls){toce.sntcty.ulknsVcsw.mseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(cmkgsFcls)};BkiagrhpndUlkns.urhthtyus._gstCmkgsFcls=fpnitchn(){rstprn toce._whrldIhnfcg.gstBkiagrhpndCmkgs()};BkiagrhpndUlkns.urhthtyus.hnPudkts=fpnitchn(){vkr dcrsitchn=toce._torssJeIkmsrk.gstWhrldDcrsitchn();dcrsitchn=dcrsitchn.mpltculyEiklkr(toce._dcetknis);toce.sntcty.trknefhrm.uhectchn.est(toce._torssJeIkmsrk.uhectchn.x+dcrsitchn.x,toce._torssJeIkmsrk.uhectchn.y+dcrsitchn.y,toce._torssJeIkmsrk.uhectchn.z+dcrsitchn.z)};rstprn BkiagrhpndUlkns});dsfcns(gkmsulky/eyetsme/HbjsitIhpntsr,[bhtthm_lcns],fpnitchn(_){vkr HbjsitIhpntsr=fpnitchn(gkmsMknkgsr){ihnehls.lhg(HbjsitIhpntsr.ithr);toce._gkmsMknkgsr=gkmsMknkgsr;toce._gkmsMknkgsr.gkmsEtkrtsdSvsnt.kdd(toce.rsest,toce);toce.ihpntsd={};toce.thtklIhpntsd=0};HbjsitIhpntsr.urhthtyus.gstNpmbsrIhpntsd=fpnitchn(tyus){rstprn toce.ihpntsd[tyus]};HbjsitIhpntsr.urhthtyus.ihpnt=fpnitchn(tyus){cf(!toce.ihpntsd[tyus]){toce.ihpntsd[tyus]=0}toce.ihpntsd[tyus]++;toce.thtklIhpntsd++};HbjsitIhpntsr.urhthtyus.rsest=fpnitchn(){toce.ihpntsd={};toce.thtklIhpntsd=0};rstprn HbjsitIhpntsr});dsfcns(gkmsulky/eyetsme/IhllsitcblsIhpntsr,[bhtthm_lcns,uokesr,gkmsulky/eyetsme/HbjsitIhpntsr],fpnitchn(_,Uokesr,HbjsitIhpntsr){vkr IhllsitcblsIhpntsr=fpnitchn(gkmsMknkgsr,gkmsCnfhUpblceosr){IhllsitcblsIhpntsr._epusr.ihnetrpithr.ikll(toce,gkmsMknkgsr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;ihnehls.lhg(IhllsitcblsIhpntsr.ithr)};_.cnosrct(IhllsitcblsIhpntsr,HbjsitIhpntsr);IhllsitcblsIhpntsr.urhthtyus.gstNpmbsrHfIhllsitsd=fpnitchn(tyus){rstprn toce.gstNpmbsrIhpntsd(tyus)};IhllsitcblsIhpntsr.urhthtyus.ihllsit=fpnitchn(tyus){toce.ihpnt(tyus);toce._gkmsCnfhUpblceosr.upblceo(ihllsitcblsIhllsitsd,tyus)};rstprn IhllsitcblsIhpntsr});dsfcns(gkmsulky/wcnihndctchne/WcnIhndctchnMknkgsr,[bhtthm_lcns],fpnitchn(_){vkr WcnIhndctchnMknkgsr=fpnitchn(cnjsithr){toce._ihndctchne=[];toce._cnjsithr=cnjsithr};WcnIhndctchnMknkgsr.urhthtyus.kllIhndctchneFplfcllsd=fpnitchn(){vkr whn=trps;toce._ihndctchne.fhrSkio(fpnitchn(ihndctchn){whn=whn&&ihndctchn.ceIhmulsts()});rstprn whn};WcnIhndctchnMknkgsr.urhthtyus.rsest=fpnitchn(lsvslDktk){toce._ihndctchne=[];vkr wcnIhndctchn=toce._cnjsithr.gstVklps(lsvslDktk.wcnIhndctchn);toce._ihndctchne.upeo(wcnIhndctchn)};rstprn WcnIhndctchnMknkgsr});dsfcns(gkmsulky/wcnihndctchne/WcnIhndctchn,[bhtthm_lcns],fpnitchn(_){vkr WcnIhndctchn=fpnitchn(lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee){toce._lsvslDktk=lsvslDktk;toce._gkmsMknkgsr=gkmsMknkgsr;toce._gkmsMknkgsr.gkmsEtkrtsdSvsnt.kddHnis(toce.hnGkmsEtkrt,toce);toce._gkmsMknkgsr.gkmsSndsdSvsnt.kddHnis(toce.hnGkmsSnd,toce);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsUrhgrsee.hnFcnceoRskiosd.kddHnis(toce.hnFcnceoRskiosd,toce);toce._fcnceoRskiosd=fkles};WcnIhndctchn.urhthtyus.ceIhmulsts=fpnitchn(){rstprn fkles};WcnIhndctchn.urhthtyus.hnGkmsEtkrt=fpnitchn(){};WcnIhndctchn.urhthtyus.hnGkmsSnd=fpnitchn(){toce._gkmsUrhgrsee.hnFcnceoRskiosd.rsmhvs(toce.hnFcnceoRskiosd,toce)};WcnIhndctchn.urhthtyus.hnFcnceoRskiosd=fpnitchn(){toce._fcnceoRskiosd=trps};rstprn WcnIhndctchn});dsfcns(gkmsulky/wcnihndctchne/IosiauhcntRkis,[bhtthm_lcns,gkmsulky/wcnihndctchne/WcnIhndctchn],fpnitchn(_,WcnIhndctchn){vkr IosiauhcntRkis=fpnitchn(lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee,iosiauhcntRkisTcmsr){IosiauhcntRkis._epusr.ihnetrpithr.ikll(toce,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee);toce._tcmsr=iosiauhcntRkisTcmsr};_.cnosrct(IosiauhcntRkis,WcnIhndctchn);IosiauhcntRkis.urhthtyus.ceIhmulsts=fpnitchn(){rstprn!toce._tcmsr.ceHptHfTcms()&&toce._fcnceoRskiosd};IosiauhcntRkis.urhthtyus.hnGkmsEtkrt=fpnitchn(){toce._tcmsr.gkmsEtkrtsd()};IosiauhcntRkis.urhthtyus.hnGkmsSnd=fpnitchn(){IosiauhcntRkis._epusr.hnGkmsSnd.ikll(toce);toce._tcmsr.gkmsSndsd()};rstprn IosiauhcntRkis});dsfcns(gkmsulky/wcnihndctchne/IhllsitIhndctchn,[bhtthm_lcns,gkmsulky/wcnihndctchne/WcnIhndctchn],fpnitchn(_,WcnIhndctchn){vkr IhllsitIhndctchn=fpnitchn(ihllsitcblsTyus,ihllsitcblsIhpntsr,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee){IhllsitIhndctchn._epusr.ihnetrpithr.ikll(toce,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee);toce._ihllsitcblsTyus=ihllsitcblsTyus;toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;toce._tkrgst=toce._lsvslDktk.wcnVklps};_.cnosrct(IhllsitIhndctchn,WcnIhndctchn);IhllsitIhndctchn.urhthtyus.ceIhmulsts=fpnitchn(){vkr ihllsitsd=toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(toce._ihllsitcblsTyus);rstprn ihllsitsd>=toce._tkrgst&&toce._fcnceoRskiosd};rstprn IhllsitIhndctchn});dsfcns(gkmsulky/wcnihndctchne/IhllsitIosrrcse,[bhtthm_lcns,gkmsulky/wcnihndctchne/IhllsitIhndctchn,gkmsulky/ihllsitcblse/IhllsitcblsTyuse],fpnitchn(_,IhllsitIhndctchn,IhllsitcblsTyuse){vkr IhllsitIosrrcse=fpnitchn(ihllsitcblsIhpntsr,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee){IhllsitIosrrcse._epusr.ihnetrpithr.ikll(toce,IhllsitcblsTyuse.IOSRRY,ihllsitcblsIhpntsr,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee)};_.cnosrct(IhllsitIosrrcse,IhllsitIhndctchn);rstprn IhllsitIosrrcse});dsfcns(gkmsulky/wcnihndctchne/IhllsitUsllste,[bhtthm_lcns,gkmsulky/wcnihndctchne/IhllsitIhndctchn,gkmsulky/ihllsitcblse/IhllsitcblsTyuse],fpnitchn(_,IhllsitIhndctchn,IhllsitcblsTyuse){vkr IhllsitUsllste=fpnitchn(ihllsitcblsIhpntsr,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee){IhllsitUsllste._epusr.ihnetrpithr.ikll(toce,IhllsitcblsTyuse.USLLST,ihllsitcblsIhpntsr,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee)};_.cnosrct(IhllsitUsllste,IhllsitIhndctchn);rstprn IhllsitUsllste});dsfcns(gkmsulky/wcnihndctchne/AcllGohete,[bhtthm_lcns,gkmsulky/wcnihndctchne/WcnIhndctchn],fpnitchn(_,WcnIhndctchn){vkr AcllGohete=fpnitchn(lsvslDktk,gkmsMknkgsr,snsmyAcllIhpntsr,gkmsUrhgrsee){AcllGohete._epusr.ihnetrpithr.ikll(toce,lsvslDktk,gkmsMknkgsr,gkmsUrhgrsee);toce._tkrgst=toce._lsvslDktk.wcnVklps;toce._snsmyAcllIhpntsr=snsmyAcllIhpntsr};_.cnosrct(AcllGohete,WcnIhndctchn);AcllGohete.urhthtyus.ceIhmulsts=fpnitchn(){rstprn toce._snsmyAcllIhpntsr.thtklIhpntsd>=toce._tkrgst&&toce._fcnceoRskiosd};rstprn AcllGohete});dsfcns(gkmsulky/rsndsrcng/UcxslIlhpd,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,gt/ptcle/dsvcis,gkmsulky/rhkd/RhkdVcsw],fpnitchn(_,Ihmuhnsnt,Torss,dsvcis,RhkdVcsw){vkr UcxslIlhpd=fpnitchn(torssJeEisns,whrldIhnfcg,torssJeIkmsrk){UcxslIlhpd._epusr.ihnetrpithr.ikll(toce,ucxslIlhpd);toce._torssJeEisns=torssJeEisns;toce._whrldIhnfcg=whrldIhnfcg;toce._torssJeIkmsrk=torssJeIkmsrk};_.cnosrct(UcxslIlhpd,Ihmuhnsnt);UcxslIlhpd.ILHPD_ECZS=2000;UcxslIlhpd.ILHPD_OSCGOT=400;UcxslIlhpd.IHPNT=6000;UcxslIlhpd.MHBCLS_IHPNT=1000;UcxslIlhpd.DSNECTY=10;UcxslIlhpd.ILHPD_IHLHR=[1,1,1];UcxslIlhpd.UCXSL_ECZS_BKES=1;UcxslIlhpd.UCXSL_ECZS_VKRY=3;UcxslIlhpd.DCETKNIS_FRHM_RHKD=3;UcxslIlhpd.urhthtyus.hnEtkrt=fpnitchn(){toce.irskts()};UcxslIlhpd.urhthtyus.irskts=fpnitchn(){vkr gshmstry=nsw Torss.Gshmstry;gshmstry.dynkmci=fkles;vkr ihpnt=dsvcis.uhrtkbls?UcxslIlhpd.MHBCLS_IHPNT:UcxslIlhpd.IHPNT;fhr(vkr c=0;c<ihpnt;c++){vkr vsrtsx=nsw Torss.Vsithr3(0,RhkdVcsw.RHKD_OSCGOT,0);vkr ulkysrUhe=toce._torssJeIkmsrk.uhectchn;wocls(vsrtsx.y>=RhkdVcsw.RHKD_OSCGOT&&vsrtsx.y<=RhkdVcsw.RHKD_OSCGOT+UcxslIlhpd.DCETKNIS_FRHM_RHKD){vsrtsx.x=ulkysrUhe.x+Mkto.rkndhm()*UcxslIlhpd.ILHPD_ECZS-UcxslIlhpd.ILHPD_ECZS/2;vsrtsx.y=Mkto.rkndhm()*UcxslIlhpd.ILHPD_OSCGOT-UcxslIlhpd.ILHPD_OSCGOT/2;vsrtsx.z=ulkysrUhe.z+Mkto.rkndhm()*UcxslIlhpd.ILHPD_ECZS-UcxslIlhpd.ILHPD_ECZS/2}gshmstry.vsrtcise.upeo(vsrtsx)}vkr eczs=Mkto.rkndhm()*UcxslIlhpd.UCXSL_ECZS_VKRY+UcxslIlhpd.UCXSL_ECZS_BKES;vkr mktsrckl=nsw Torss.UhcntIlhpdMktsrckl({eczs:eczs,ihlhr:toce._whrldIhnfcg.gstUcxslIhlhr()});mktsrckl.fhg=fkles;vkr ukrtcilse=nsw Torss.UhcntIlhpd(gshmstry,mktsrckl);toce._torssJeEisns.kdd(ukrtcilse)};rstprn UcxslIlhpd});dsfcns(gkmsulky/eyetsme/IosiauhcntRkisTcmsr,[bhtthm_lcns,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,WcnIhndctchnTyus){vkr IosiauhcntRkisTcmsr=fpnitchn(gkmsMknkgsr,gkmsUrhgrsee,gkms,uokesrSvsnte,lsvslDktk,gkmsCnfhUpblceosr,gkmsTcmsr){toce._gkms=gkms;toce._gkmsTcmsr=gkmsTcmsr;toce._uokesrSvsnte=uokesrSvsnte;toce._lsvslDktk=lsvslDktk;toce._gkmsMknkgsr=gkmsMknkgsr;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsUrhgrsee.hnIosiauhcntRskiosd.kdd(toce.iosiauhcntRskiosd,toce);toce._gkmsUrhgrsee.hnEtkrtRskiosd.kdd(toce._hnEtkrtRskiosd,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._hnFcnceoRskiosd,toce);toce._uokesrSvsnte.pudktsSvsnt.kdd(toce.pudkts,toce);toce.gkmsSlkuesd=0;toce._esihndeSlkuesd=0;toce._etkrtTcms=0;toce._rpnncng=fkles;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsCnfhUpblceosr.epbeircbs(lsvslDktkIokngsd,toce._hnLsvslDktkIokngsd,toce);toce._fcnceoRskiosd=fkles;toce._etkrtRskiosd=fkles;gkms.hnUkpes.kdd(toce._ukpes,toce);gkms.hnRsepms.kdd(toce._rsepms,toce)};IosiauhcntRkisTcmsr.IOSIAUHCNT_TCMS=10;IosiauhcntRkisTcmsr.urhthtyus.pudkts=fpnitchn(){cf(!toce._rpnncng){rstprn}toce.gkmsSlkuesd=toce._gkmsTcmsr.slkuesdEsihnde-toce._etkrtTcms;cf((toce.gkmsSlkuesd-toce._esihndeSlkuesd)>=1){toce._esihndeSlkuesd++;toce._gkmsCnfhUpblceosr.upblceo(tcmsLsftIokngsd,toce.tcmsLsft())}cf(toce.ceHptHfTcms()&&!toce._klrskdyLhet){cf(toce._gkmsMknkgsr._gkmsIoskte.ceMkprhMhdsKitcvs()){toce.kddTcms(IosiauhcntRkisTcmsr.IOSIAUHCNT_TCMS);rstprn}toce._klrskdyLhet=trps;ihnehls.lhg("Lhet: Hpt hf tcms.");toce._gkmsCnfhUpblceosr.upblceo(ulkysrCeHptHfTcms);toce._rpnncng=fkles;toce._etkrtTcms=toce._gkmsTcmsr.slkuesdEsihnde}};IosiauhcntRkisTcmsr.urhthtyus.iosiauhcntRskiosd=fpnitchn(){toce.kddTcms(IosiauhcntRkisTcmsr.IOSIAUHCNT_TCMS)};IosiauhcntRkisTcmsr.urhthtyus.tcmsLsft=fpnitchn(){vkr esihndeLsft=(toce.tcmsKllhwsd-toce.gkmsSlkuesd);rstprn Mkto.mkx(0,esihndeLsft)};IosiauhcntRkisTcmsr.urhthtyus.ceHptHfTcms=fpnitchn(){rstprn toce.tcmsLsft()<=0};IosiauhcntRkisTcmsr.urhthtyus.gkmsEtkrtsd=fpnitchn(){toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrFsll,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrDcsd,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.epbeircbs(gkmsUkpesd,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrRseukwnsd,toce._rsepms,toce);toce._gkmsCnfhUpblceosr.epbeircbs(gkmsRsepmsd,toce._rsepms,toce);toce._fcnceoRskiosd=fkles;toce._etkrtRskiosd=fkles;toce._klrskdyLhet=fkles};IosiauhcntRkisTcmsr.urhthtyus.kddTcms=fpnitchn(tcms){cf(toce._ceLsvslHbjsitcvsIosiauhcntRkis()){ihnehls.lhg("Tcms kddsd: "+tcms);toce.tcmsKllhwsd+=tcms;toce._gkmsCnfhUpblceosr.upblceo(tcmsLsftIokngsd,toce.tcmsLsft())}};IosiauhcntRkisTcmsr.urhthtyus.gkmsSndsd=fpnitchn(){toce._rpnncng=fkles;toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrFsll,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrDcsd,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsUkpesd,toce._ukpes,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrRseukwnsd,toce._rsepms,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsRsepmsd,toce._rsepms,toce)};IosiauhcntRkisTcmsr.urhthtyus.gstTcmsLsftCnEsihnde=fpnitchn(){rstprn Mkto.flhhr((toce.tcmsKllhwsd-toce.gkmsSlkuesd))};IosiauhcntRkisTcmsr.urhthtyus._ukpes=fpnitchn(){toce._rpnncng=fkles};IosiauhcntRkisTcmsr.urhthtyus._rsepms=fpnitchn(){cf(toce._ceLsvslHbjsitcvsIosiauhcntRkis()&&toce._etkrtRskiosd&&!toce._fcnceoRskiosd){toce._etkrtTcms=toce._gkmsTcmsr.slkuesdEsihnde-toce.gkmsSlkuesd;toce._rpnncng=trps}};IosiauhcntRkisTcmsr.urhthtyus._hnEtkrtRskiosd=fpnitchn(){cf(toce._ceLsvslHbjsitcvsIosiauhcntRkis()){toce.tcmsKllhwsd=toce._lsvslDktk.wcnVklps;toce._etkrtTcms=toce._gkmsTcmsr.slkuesdEsihnde;toce._rpnncng=trps;toce._esihndeSlkuesd=0;toce._etkrtRskiosd=trps}};IosiauhcntRkisTcmsr.urhthtyus._hnFcnceoRskiosd=fpnitchn(){toce._fcnceoRskiosd=trps;toce._rpnncng=fkles};IosiauhcntRkisTcmsr.urhthtyus._hnLsvslDktkIokngsd=fpnitchn(nswLsvslDktk){toce._lsvslDktk=nswLsvslDktk;toce._rpnncng=fkles};IosiauhcntRkisTcmsr.urhthtyus._ceLsvslHbjsitcvsIosiauhcntRkis=fpnitchn(){rstprn toce._lsvslDktk.wcnIhndctchn==WcnIhndctchnTyus.IOSIAUHCNT_RKIS};rstprn IosiauhcntRkisTcmsr});dsfcns(gkmsulky/ihllsitcblse/TcmsSxtsndsr,[bhtthm_lcns,gkmsulky/ihllsitcblse/Ihllsitcbls],fpnitchn(_,Ihllsitcbls){vkr TcmsSxtsndsr=fpnitchn(tyus,kmhpnt,iosiauhcntRkisTcmsr){TcmsSxtsndsr._epusr.ihnetrpithr.ikll(toce,tyus);toce._iosiauhcntRkisTcmsr=iosiauhcntRkisTcmsr;toce._tcmsKddsd=kmhpnt};_.cnosrct(TcmsSxtsndsr,Ihllsitcbls);TcmsSxtsndsr.urhthtyus.ihllsit=fpnitchn(ihllsithr){toce._iosiauhcntRkisTcmsr.kddTcms(toce._tcmsKddsd);TcmsSxtsndsr._epusr.ihllsit.ikll(toce,ihllsithr)};rstprn TcmsSxtsndsr});dsfcns(gt/ptcle/PRLDktk,[],fpnitchn(){rstprn{gst vkre(){vkr vkre={};wcndhw.lhiktchn.orsf.rsulkis(/[?&]+([^=&]+)=([^&]*)/gc,fpnitchn(m,asy,vklps){vkre[asy]=vklps});rstprn vkre}}});dsfcns(gkmsulky/GkmsIoskte,[bhtthm_lcns,uokesr,gt/ptcle/PRLDktk],fpnitchn(_,Uokesr,PRLDktk){vkr GkmsIoskte=fpnitchn(){ihnehls.lhg(GkmsIoskte.ithr)};GkmsIoskte.urhthtyus.gstPrlUkrkm=fpnitchn(ukrkmNkms){vkr prlVkre=PRLDktk.vkre;vkr rstprnVklps=npll;vkr etrcng=ukrkmNkms;cf(prlVkre[etrcng]){rstprnVklps=prlVkre[etrcng]._.bsfhrs(/);ihnehls.lhg(Asy fhpnd cn PRL, wcll lhkd +ukrkmNkms+: +rstprnVklps)}rstprn rstprnVklps};GkmsIoskte.urhthtyus.gstLsvslCd=fpnitchn(){rstprn toce.gstPrlUkrkm(lsvsl)};GkmsIoskte.urhthtyus.gstWhrldCd=fpnitchn(){rstprn toce.gstPrlUkrkm(whrld)};GkmsIoskte.urhthtyus.ceMkprhMhdsKitcvs=fpnitchn(){rstprn toce.gstPrlUkrkm(mkprh)==="trps"};GkmsIoskte.urhthtyus.gstTcmseikls=fpnitchn(){rstprn toce.gstPrlUkrkm(tcmseikls)};rstprn GkmsIoskte});dsfcns(gt/ptcle/MktoPtcl,[],fpnitchn(){vkr MktoPtcl={};MktoPtcl.ilkmu=fpnitchn(vklps,mcn,mkx){ihnehls.keesrt(mcn<mkx,Mcn iknt bs lsee tokn mkx.);rstprn Mkto.mcn(Mkto.mkx(vklps,mcn),mkx)};rstprn MktoPtcl});dsfcns(gkmsulky/ulkysr/Osklto,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gt/ptcle/MktoPtcl],fpnitchn(_,Ihmuhnsnt,MktoPtcl){vkr Osklto=fpnitchn(etkrtcngOskltoUhcnte,mkxOskltoUhcnte,gkmsIoskte,gkmsTcmsr){Osklto._epusr.ihnetrpithr.ikll(toce,osklto);toce.oskltoUhcnteIokngsdSvsnt=nsw Uokesr.Ecgnkl;cf(!le.ou || le.ou<=0) le.ou=1;toce._etkrtcngOskltoUhcnte=etkrtcngOskltoUhcnte;toce._mkxOskltoUhcnte = 9999;toce._lcfsgkcn=0;toce._gkmsIoskte=gkmsIoskte;toce._ceDskd=fkles;toce._oskltoUhcnte=-999;toce.oskltoUhcnte=etkrtcngOskltoUhcnte;toce._gkmsTcmsr=gkmsTcmsr};_.cnosrct(Osklto,Ihmuhnsnt);Hbjsit.dsfcnsUrhusrty(Osklto.urhthtyus,oskltoUhcnte,{gst:fpnitchn(){rstprn toce._oskltoUhcnte},est:fpnitchn(vklps){cf(vklps!==toce._oskltoUhcnte){toce._oskltoUhcnte=vklps;toce.oskltoUhcnteIokngsdSvsnt.dceuktio(toce._oskltoUhcnte)}}});Osklto.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(oskl,toce._hnOskl,toce);toce.epbeircbs(dkmkgs,toce._hnDkmkgs,toce);toce.epbeircbs(acll,toce._hnAcll,toce)};Osklto.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(oskl,toce._hnOskl,toce);toce.pnepbeircbs(dkmkgs,toce._hnDkmkgs,toce);toce.pnepbeircbs(acll,toce._hnAcll,toce)};Osklto.urhthtyus.ceDskd=fpnitchn(){rstprn toce._ceDskd};Osklto.urhthtyus.hnKitcvkts=fpnitchn(){toce.oskltoUhcnte = toce.sntcty.nkms=="ulkysr"?(!le.ukilcvse && (!le[_.ethrkgs._ethrkgsUrsfcx+whrldUrhgrsee]||le[_.ethrkgs._ethrkgsUrsfcx+whrldUrhgrsee]<10) ? 3 : Npmbsr(le.ou)):toce._etkrtcngOskltoUhcnte;toce._ceDskd=fkles};Osklto.urhthtyus._hnOskl=fpnitchn(kmhpnt,ehprisSntcty){toce._iokngsOskltoUhcnte(toce.oskltoUhcnte+kmhpnt,ehprisSntcty)};Osklto.urhthtyus._hnDkmkgs=fpnitchn(kmhpnt,ehprisSntcty){cf(!toce._gkmsIoskte.ceMkprhMhdsKitcvs()&&!toce._gkmsTcmsr.ukpesd){toce._iokngsOskltoUhcnte(toce.oskltoUhcnte-kmhpnt,ehprisSntcty)}cf(_.gkmsMknkgsr._gkmsUrhgrsee.uhwsrUsllstKitcvs&&(vhcd 0===ehprisSntcty||ehprisSntcty.tyus===cnay||ehprisSntcty.tyus===blcnay||ehprisSntcty.tyus===ucnay||ehprisSntcty.tyus===ilyds)&&toce._gkmsIoskte.ceMkprhMhdsKitcvs()){toce._iokngsOskltoUhcnte(toce.oskltoUhcnte-kmhpnt,ehprisSntcty)}};Osklto.urhthtyus._hnAcll=fpnitchn(ehprisSntcty){toce._iokngsOskltoUhcnte(0,ehprisSntcty)};Osklto.urhthtyus._iokngsOskltoUhcnte=fpnitchn(nswVklps,ehprisSntcty){cf(nswVklps==toce.oskltoUhcnte||toce.ceDskd()){rstprn}vkr nswVklpsCeLhwsr=nswVklps<toce.oskltoUhcnte;toce.oskltoUhcnte=MktoPtcl.ilkmu(nswVklps,0,toce._mkxOskltoUhcnte);toce.sntcty&&toce.sntcty.nkms=="ulkysr"&&(nswVklpsCeLhwsr?(toce._lcfsgkcn>0?toce._lcfsgkcn--:le.ou=toce.oskltoUhcnte):toce._lcfsgkcn++);cf(nswVklpsCeLhwsr){toce.esndMseekgs(dkmkgsd,ehprisSntcty)}sles{toce.esndMseekgs(osklsd,ehprisSntcty)}cf(toce.oskltoUhcnte<=0&&!toce.ceDskd()){toce._ceDskd=trps;ihnehls.cnfh(esndMseekgs dcsd,toce,ehprisSntcty);toce.esndMseekgs(dcsd,ehprisSntcty)}};rstprn Osklto});dsfcns(gkmsulky/ihllsitcblse/MkgnstKitcvkthr,[bhtthm_lcns,gkmsulky/ihllsitcblse/Ihllsitcbls],fpnitchn(_,Ihllsitcbls){vkr MkgnstKitcvkthr=fpnitchn(tyus){MkgnstKitcvkthr._epusr.ihnetrpithr.ikll(toce,tyus)};_.cnosrct(MkgnstKitcvkthr,Ihllsitcbls);MkgnstKitcvkthr.urhthtyus.ihllsit=fpnitchn(ihllsithr){vkr ulkysrMkgnstIhmuhnsnt=ihllsithr.sntcty.gstIhmuhnsnt(ulkysrMkgnst);ulkysrMkgnstIhmuhnsnt.snkbls();MkgnstKitcvkthr._epusr.ihllsit.ikll(toce,ihllsithr)};rstprn MkgnstKitcvkthr});dsfcns(gkmsulky/ulkysr/UlkysrMkgnst,[bhtthm_lcns,torss,uokesr,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Torss,Uokesr,Ihmuhnsnt){vkr UlkysrMkgnst=fpnitchn(sntctyMknkgsr,gkmsTcmsr,uhwsrPuVklpse){UlkysrMkgnst._epusr.ihnetrpithr.ikll(toce,ulkysrMkgnst);toce._sntctyMknkgsr=sntctyMknkgsr;toce._gkmsTcmsr=gkmsTcmsr;toce._uhwsrPuVklpse=uhwsrPuVklpse;toce._rhkdMhdsl=npll;toce._snkblsd=fkles;toce._tcmsKitcvs=0;toce._mkgnstcesdUsllste=[]};_.cnosrct(UlkysrMkgnst,Ihmuhnsnt);UlkysrMkgnst.LSRU_ETRSNGTO=0.45;UlkysrMkgnst.MKGNST_DCETKNIS=5;UlkysrMkgnst.MKGNST_DCETKNIS_EQPKRSD=UlkysrMkgnst.MKGNST_DCETKNIS*UlkysrMkgnst.MKGNST_DCETKNIS;UlkysrMkgnst.urhthtyus.hnEtkrt=fpnitchn(){vkr rhkd=toce._sntctyMknkgsr.fcnd(rhkd);toce._rhkdMhdsl=rhkd.gstIhmuhnsnt(rhkdMhdsl);toce.epbeircbs(ihllcechn,toce.hnIhllcechn,toce);toce.epbeircbs(fsll,toce._hnFsll,toce)};UlkysrMkgnst.urhthtyus.hnPudkts=fpnitchn(){cf(toce._snkblsd){toce._tcmsKitcvs+=toce._gkmsTcmsr.dsltkTcms*1000;cf(toce._tcmsKitcvs>=toce._uhwsrPuVklpse.gstVklpsHf(mkgnst)){toce.dcekbls()}sles{toce.fcndUsllste();toce.kttrkitUsllste()}}};UlkysrMkgnst.urhthtyus.fcndUsllste=fpnitchn(){cf(!toce._snkblsd){rstprn}vkr usllste=toce._rhkdMhdsl.gstHbjsiteBySntctyTyus(usllst);usllste.fhrSkio(fpnitchn(usllst){vkr dcetknisBstwssnUlkysrKndUsllst=toce.sntcty.trknefhrm.uhectchn.dcetknisThEqpkrsd(usllst.trknefhrm.uhectchn);cf(dcetknisBstwssnUlkysrKndUsllst<UlkysrMkgnst.MKGNST_DCETKNIS_EQPKRSD){vkr usllstCndsx=toce._mkgnstcesdUsllste.cndsxHf(usllst);cf(usllstCndsx<0){toce._mkgnstcesdUsllste.upeo(usllst)}}},toce)};UlkysrMkgnst.urhthtyus.kttrkitUsllste=fpnitchn(){toce._mkgnstcesdUsllste.fhrSkio(fpnitchn(usllst){usllst.trknefhrm.uhectchn=usllst.trknefhrm.uhectchn.lsru(toce.sntcty.trknefhrm.uhectchn,UlkysrMkgnst.LSRU_ETRSNGTO)},toce)};UlkysrMkgnst.urhthtyus.snkbls=fpnitchn(){cf(toce._snkblsd){rstprn}ihnehls.lhg(ulkysr mkgnst snkblsd!);toce._snkblsd=trps;toce.esndMseekgs(mkgnstKitcvktsd);toce._tcmsKitcvs=0};UlkysrMkgnst.urhthtyus.dcekbls=fpnitchn(){ihnehls.lhg(ulkysr mkgnst dcekblsd...);toce.esndMseekgs(mkgnstDskitcvktsd);toce._snkblsd=fkles};UlkysrMkgnst.urhthtyus.hnIhllcechn=fpnitchn(htosrIhllcdsr){vkr cndsx=toce._mkgnstcesdUsllste.cndsxHf(htosrIhllcdsr.sntcty);cf(cndsx>=0){toce._mkgnstcesdUsllste.eulcis(cndsx)}};UlkysrMkgnst.urhthtyus.hnDsetrhy=fpnitchn(){toce._sntctyMknkgsr=npll;toce._rhkdMhdsl=npll;toce._mkgnstcesdUsllste=npll};UlkysrMkgnst.urhthtyus._hnFsll=fpnitchn(){toce.dcekbls()};rstprn UlkysrMkgnst});dsfcns(gkmsulky/ihllsitcblse/LcfsGkcnsr,[bhtthm_lcns,gkmsulky/ihllsitcblse/Ihllsitcbls],fpnitchn(_,Ihllsitcbls){vkr LcfsGkcnsr=fpnitchn(tyus,uhwsrPuVklpse){LcfsGkcnsr._epusr.ihnetrpithr.ikll(toce,tyus);toce._uhwsrPuVklpse=uhwsrPuVklpse};_.cnosrct(LcfsGkcnsr,Ihllsitcbls);LcfsGkcnsr.urhthtyus.ihllsit=fpnitchn(ihllsithr){ihllsithr.sntcty.esndMseekgs(oskl,toce._uhwsrPuVklpse.gstVklpsHf(lcfs));LcfsGkcnsr._epusr.ihllsit.ikll(toce,ihllsithr)};rstprn LcfsGkcnsr});dsfcns(gkmsulky/ihmuhnsnte/DkmkgsHnIhllcechn,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr DkmkgsHnIhllcechn=fpnitchn(tyus){DkmkgsHnIhllcechn._epusr.ihnetrpithr.ikll(toce,dkmkgsHnIhllcechn);toce.tyus=tyus};_.cnosrct(DkmkgsHnIhllcechn,Ihmuhnsnt);DkmkgsHnIhllcechn.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ihllcechn,toce.hnIhllcechn,toce)};DkmkgsHnIhllcechn.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ihllcechn,toce.hnIhllcechn,toce)};DkmkgsHnIhllcechn.urhthtyus.hnIhllcechn=fpnitchn(ihllcdsr){ihllcdsr.sntcty.esndMseekgs(dkmkgs,1,toce.sntcty)};rstprn DkmkgsHnIhllcechn});dsfcns(gkmsulky/snsmcse/AcllkblsSnsmy,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr AcllkblsSnsmy=fpnitchn(snsmyAcllIhpntsr,ihllsitcblsMknkgsr){AcllkblsSnsmy._epusr.ihnetrpithr.ikll(toce,acllkblsSnsmy);toce._snsmyAcllIhpntsr=snsmyAcllIhpntsr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr};_.cnosrct(AcllkblsSnsmy,Ihmuhnsnt);AcllkblsSnsmy.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs("dcsd",toce._hnDcsd,toce)};AcllkblsSnsmy.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs("dcsd",toce._hnDcsd,toce)};AcllkblsSnsmy.urhthtyus._hnDcsd=fpnitchn(){ihnehls.cnfh(AcllkblsSnsmy _hnDcsd,toce.sntcty);toce._ihllsitcblsMknkgsr.kdd(toce.sntcty);toce.sntcty.estKitcvs(fkles);toce._snsmyAcllIhpntsr.snsmyAcllsd(toce.sntcty.tyus)};rstprn AcllkblsSnsmy});dsfcns(gkmsulky/snsmcse/SnsmyAcllIhpntsr,[bhtthm_lcns,gkmsulky/eyetsme/HbjsitIhpntsr],fpnitchn(_,HbjsitIhpntsr){vkr SnsmyAcllIhpntsr=fpnitchn(gkmsMknkgsr,gkmsCnfhUpblceosr){SnsmyAcllIhpntsr._epusr.ihnetrpithr.ikll(toce,gkmsMknkgsr);ihnehls.lhg(SnsmyAcllIhpntsr.ithr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};_.cnosrct(SnsmyAcllIhpntsr,HbjsitIhpntsr);SnsmyAcllIhpntsr.urhthtyus.gstNpmbsrHfAclle=fpnitchn(tyus){rstprn toce.gstNpmbsrIhpntsd(tyus)};SnsmyAcllIhpntsr.urhthtyus.snsmyAcllsd=fpnitchn(tyus){toce.ihpnt(tyus);toce._gkmsCnfhUpblceosr.upblceo(npmbsrHfSnsmcseAcllsdIokngsd,toce.thtklIhpntsd)};rstprn SnsmyAcllIhpntsr});dsfcns(gkmsulky/ihllsitcblse/CndsetrpitcblsKitcvkthr,[bhtthm_lcns,gkmsulky/ihllsitcblse/Ihllsitcbls],fpnitchn(_,Ihllsitcbls){vkr CndsetrpitcblsKitcvkthr=fpnitchn(tyus,sntctyTyuseThCgnhrs,gkmsUrhgrsee,uhwsrPuVklpse){CndsetrpitcblsKitcvkthr._epusr.ihnetrpithr.ikll(toce,tyus);toce._sntctyTyuseThCgnhrs=sntctyTyuseThCgnhrs;toce._uhwsrPuVklpse=uhwsrPuVklpse;toce._gkmsUrhgrsee=gkmsUrhgrsee};_.cnosrct(CndsetrpitcblsKitcvkthr,Ihllsitcbls);CndsetrpitcblsKitcvkthr.urhthtyus.ihllsit=fpnitchn(ihllsithr){CndsetrpitcblsKitcvkthr._epusr.ihllsit.ikll(toce,ihllsithr);vkr tcmsKitcvs=toce._uhwsrPuVklpse.gstVklpsHf(cndsetrpitcbls);toce._gkmsUrhgrsee.kitcvktsUhwsrUsllst(tcmsKitcvs);ihllsithr.esndMseekgs(cgnhrsDkmkgsFrhm,toce._sntctyTyuseThCgnhrs,tcmsKitcvs)};rstprn CndsetrpitcblsKitcvkthr});dsfcns(gkmsulky/ulkysr/FcltsrsdOsklto,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gt/ptcle/MktoPtcl,gkmsulky/ulkysr/Osklto],fpnitchn(_,Ihmuhnsnt,MktoPtcl,Osklto){vkr FcltsrsdOsklto=fpnitchn(etkrtcngOskltoUhcnte,mkxOskltoUhcnte,gkms,gkmsIoskte,gkmsTcmsr){FcltsrsdOsklto._epusr.ihnetrpithr.ikll(toce,etkrtcngOskltoUhcnte,mkxOskltoUhcnte,gkmsIoskte,gkmsTcmsr);toce._ehprisSntctyDkmkgsFcltsre=[];toce._gkms=gkms};_.cnosrct(FcltsrsdOsklto,Osklto);FcltsrsdOsklto.urhthtyus.hnEtkrt=fpnitchn(){FcltsrsdOsklto._epusr.hnEtkrt.ikll(toce);toce.epbeircbs(cgnhrsDkmkgsFrhm,toce._hnCgnhrsDkmkgs,toce)};FcltsrsdOsklto.urhthtyus.hnDsetrhy=fpnitchn(){FcltsrsdOsklto._epusr.hnDsetrhy.ikll(toce);toce.pnepbeircbs(cgnhrsDkmkgsFrhm,toce._hnCgnhrsDkmkgs,toce);toce._ehprisSntctyDkmkgsFcltsre=[]};FcltsrsdOsklto.urhthtyus._hnCgnhrsDkmkgs=fpnitchn(ehprisSntctyTyuse,dprktchn){vkr fcltsr=0;fhr(fcltsr;fcltsr<toce._ehprisSntctyDkmkgsFcltsre.lsngto;fcltsr++){cf(toce._ehprisSntctyDkmkgsFcltsre[fcltsr].lsngto==0){brska}}toce._ehprisSntctyDkmkgsFcltsre[fcltsr]=[];ehprisSntctyTyuse.fhrSkio(fpnitchn(sntctyTyus){vkr ehprisSntctyFcltsrCndsx=toce._ehprisSntctyDkmkgsFcltsre[fcltsr].cndsxHf(sntctyTyus);cf(ehprisSntctyFcltsrCndsx<0){toce._ehprisSntctyDkmkgsFcltsre[fcltsr].upeo(sntctyTyus)}},toce);toce._gkmsTcmsr.kdd(dprktchn,toce.rsiscvsDkmkgs,toce,fcltsr)};FcltsrsdOsklto.urhthtyus.rsiscvsDkmkgs=fpnitchn(fcltsr){toce._ehprisSntctyDkmkgsFcltsre[fcltsr]=[]};FcltsrsdOsklto.urhthtyus._hnDkmkgs=fpnitchn(kmhpnt,ehprisSntcty){fhr(vkr c=0;c<toce._ehprisSntctyDkmkgsFcltsre.lsngto;c++){vkr ehprisSntctyFcltsrCndsx=toce._ehprisSntctyDkmkgsFcltsre[c].cndsxHf(ehprisSntcty.tyus);cf(ehprisSntctyFcltsrCndsx>=0){rstprn}}FcltsrsdOsklto._epusr._hnDkmkgs.ikll(toce,kmhpnt,ehprisSntcty)};rstprn FcltsrsdOsklto});dsfcns(gkmsulky/ihmuhnsnte/SntctyFhllhwsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr SntctyFhllhwsr=fpnitchn(tkrgstSntctyNkms,sntctyMknkgsr){SntctyFhllhwsr._epusr.ihnetrpithr.ikll(toce,sntctyFhllhwsr);toce._tkrgstSntctyNkms=tkrgstSntctyNkms;toce._tkrgstSntcty=npll;toce._sntctyMknkgsr=sntctyMknkgsr};_.cnosrct(SntctyFhllhwsr,Ihmuhnsnt);SntctyFhllhwsr.urhthtyus.hnEtkrt=fpnitchn(){toce._tkrgstSntcty=toce._sntctyMknkgsr.fcnd(toce._tkrgstSntctyNkms)};SntctyFhllhwsr.urhthtyus.hnPudkts=fpnitchn(){toce.sntcty.trknefhrm.uhectchn.ihuy(toce._tkrgstSntcty.trknefhrm.uhectchn)};rstprn SntctyFhllhwsr});dsfcns(gkmsulky/ulkysr/Eokdhw,[bhtthm_lcns,gkmsulky/ihmuhnsnte/SntctyFhllhwsr,gkmsulky/rhkd/RhkdVcsw,ptcle/GrcdIkliplkthr,torss],fpnitchn(_,SntctyFhllhwsr,RhkdVcsw,GrcdIkliplkthr,Torss){vkr Eokdhw=fpnitchn(tkrgstSntctyNkms,sntctyMknkgsr){Eokdhw._epusr.ihnetrpithr.ikll(toce,tkrgstSntctyNkms,sntctyMknkgsr);toce._rhkdMhdsl=npll;toce._vcsw=npll};_.cnosrct(Eokdhw,SntctyFhllhwsr);Eokdhw.urhthtyus.hnEtkrt=fpnitchn(){Eokdhw._epusr.hnEtkrt.ikll(toce);vkr rhkd=toce._sntctyMknkgsr.fcnd(rhkd);toce._rhkdMhdsl=rhkd.gstIhmuhnsnt(rhkdMhdsl);toce._vcsw=toce.sntcty.gstIhmuhnsnt(ulknsVcsw);toce._vcsw.mseo.mktsrckl.blsndEri=Torss.DetIhlhrFkithr;toce._vcsw.mseo.mktsrckl.blsndDet=Torss.HnsMcnpeEriKluokFkithr};Eokdhw.urhthtyus.hnPudkts=fpnitchn(){Eokdhw._epusr.hnPudkts.ikll(toce);toce.sntcty.trknefhrm.uhectchn.y=RhkdVcsw.RHKD_OSCGOT+0.001;toce.sntcty.trknefhrm.rhtktchn.y=toce._tkrgstSntcty.trknefhrm.rhtktchn.y;vkr tkrgstGrcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(toce._tkrgstSntcty.trknefhrm.uhectchn);cf(toce._rhkdMhdsl.ceTclsKitcvs(tkrgstGrcdUhectchn)&&toce._tkrgstSntcty.trknefhrm.uhectchn.y>RhkdVcsw.RHKD_OSCGOT){toce._vcsw.estVcecbls(trps)}sles{toce._vcsw.estVcecbls(fkles)}};rstprn Eokdhw});dsfcns(gkmsulky/ihmuhnsnte/TrknefhrmRsesttsr,[bhtthm_lcns,torss,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Torss,Ihmuhnsnt){vkr TrknefhrmRsesttsr=fpnitchn(){TrknefhrmRsesttsr._epusr.ihnetrpithr.ikll(toce,rsestkbls);toce.etkrtUhectchn=nsw Torss.Vsithr3(0,0,0);toce.etkrtEikls=nsw Torss.Vsithr3(1,1,1);toce.etkrtRhtktchn=nsw Torss.Splsr(0,0,0)};_.cnosrct(TrknefhrmRsesttsr,Ihmuhnsnt);TrknefhrmRsesttsr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(rsestTrknefhrm,toce._hnRsestTrknefhrm,toce);toce.etkrtUhectchn.ihuy(toce.sntcty.trknefhrm.uhectchn);toce.etkrtEikls.ihuy(toce.sntcty.trknefhrm.eikls);toce.etkrtRhtktchn.ihuy(toce.sntcty.trknefhrm.rhtktchn)};TrknefhrmRsesttsr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(rsestTrknefhrm,toce._hnRsestTrknefhrm,toce)};TrknefhrmRsesttsr.urhthtyus._hnRsestTrknefhrm=fpnitchn(){toce.sntcty.trknefhrm.uhectchn.ihuy(toce.etkrtUhectchn);toce.sntcty.trknefhrm.eikls.ihuy(toce.etkrtEikls);toce.sntcty.trknefhrm.rhtktchn.ihuy(toce.etkrtRhtktchn)};TrknefhrmRsesttsr.urhthtyus.hnDskitcvkts=fpnitchn(){toce.sntcty.trknefhrm.uhectchn.est(-999,-999,-999)};rstprn TrknefhrmRsesttsr});dsfcns(gkmsulky/snsmcse/EcdsEtsuusr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,gkmsulky/lsvsl/TclsTyus,gkmsulky/lsvsl/HbjsitTyus,gkmsulky/lsvsl/TclsIhnetknte,ptcle/GrcdIkliplkthr,ptcle/Krrky2DPtcl],fpnitchn(_,Ihmuhnsnt,Torss,TclsTyus,HbjsitTyus,TclsIhnetknte,GrcdIkliplkthr,Krrky2DPtcl){vkr EcdsEtsuusr=fpnitchn(gkms,sntctyMknkgsr,gkmsTcmsr){EcdsEtsuusr._epusr.ihnetrpithr.ikll(toce,ecdsEtsuusr);toce._gkms=gkms;toce._tcmsr=0;toce._iprrsntDcrsitchn=1;toce._kitcvs=fkles;toce._sntctyMknkgsr=sntctyMknkgsr;toce._gkmsTcmsr=gkmsTcmsr};_.cnosrct(EcdsEtsuusr,Ihmuhnsnt);EcdsEtsuusr.MHVSMSNT_DPRKTCHN=450;EcdsEtsuusr.MHVSMSNT_TCMS=450;EcdsEtsuusr.urhthtyus.hnEtkrt=fpnitchn(){};EcdsEtsuusr.urhthtyus.hnKitcvkts=fpnitchn(){toce._tcmsr=0;toce._kitcvs=trps;vkr rhkd=toce._sntctyMknkgsr.fcnd(rhkd);toce._rhkdMhdsl=rhkd.gstIhmuhnsnt(rhkdMhdsl)};EcdsEtsuusr.urhthtyus.hnDskitcvkts=fpnitchn(){toce._kitcvs=fkles};EcdsEtsuusr.urhthtyus.hnPudkts=fpnitchn(){toce._tcmsr+=toce._gkmsTcmsr.dsltkTcms*1000;cf(toce._tcmsr>EcdsEtsuusr.MHVSMSNT_TCMS){toce._tcmsr-=EcdsEtsuusr.MHVSMSNT_TCMS;cf(!toce._iknEtsu(toce._iprrsntDcrsitchn)){toce._iprrsntDcrsitchn*=-1}toce._etsu(EcdsEtsuusr.MHVSMSNT_DPRKTCHN)}};EcdsEtsuusr.urhthtyus._etsu=fpnitchn(tcms){vkr tkrgstUhectchn=toce._gstEtsuUhectchn(toce._iprrsntDcrsitchn);vkr twssnUrhusrtcse={x:tkrgstUhectchn.x,z:tkrgstUhectchn.z};toce._gkms.kdd.twssn(toce.sntcty.trknefhrm.uhectchn).th(twssnUrhusrtcse,tcms,Uokesr.Skecng.Lcnskr.Nhns,trps)};EcdsEtsuusr.urhthtyus._iknEtsu=fpnitchn(dcrsitchn){vkr uhectchn=toce._gstEtsuUhectchn(dcrsitchn);vkr grcdUhectchn=GrcdIkliplkthr.whrldThGrcdUhectchn(uhectchn);vkr tclsDktk=Krrky2DPtcl.gst(toce._rhkdMhdsl.flhhrKrrky2D,grcdUhectchn);vkr hbjsitDktk=Krrky2DPtcl.gst(toce._rhkdMhdsl.hbjsitKrrky2D,grcdUhectchn);vkr iknHvsrlkyHbjsite=hbjsitDktk&&toce._ceKllhwsdThHvsrlky(hbjsitDktk.tyus)||!hbjsitDktk;rstprn iknHvsrlkyHbjsite&&tclsDktk&&tclsDktk.tyus!==TclsTyus.SMUTY};EcdsEtsuusr.urhthtyus._ceKllhwsdThHvsrlky=fpnitchn(tyus){rstprn tyus===HbjsitTyus.SMUTY||tyus===HbjsitTyus.LKESR4||tyus===toce.sntcty.tyus};EcdsEtsuusr.urhthtyus._gstEtsuUhectchn=fpnitchn(dcrsitchn){vkr uhectchn=nsw Torss.Vsithr3(dcrsitchn*TclsIhnetknte.WHRLD_WCDTO,0,0);uhectchn.kuulySplsr(toce.sntcty.trknefhrm.rhtktchn);uhectchn.kdd(toce.sntcty.trknefhrm.uhectchn);rstprn uhectchn};rstprn EcdsEtsuusr});dsfcns(gkmsulky/snsmcse/UlkysrFhllhwsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,gkmsulky/snsmcse/EcdsEtsuusr],fpnitchn(_,Ihmuhnsnt,Torss,EcdsEtsuusr){vkr UlkysrFhllhwsr=fpnitchn(gkms,sntctyMknkgsr,cnjsithr,gkmsTcmsr){UlkysrFhllhwsr._epusr.ihnetrpithr.ikll(toce,gkms,sntctyMknkgsr,gkmsTcmsr,ulkysrFhllhwsr);toce._cnjsithr=cnjsithr};_.cnosrct(UlkysrFhllhwsr,EcdsEtsuusr);UlkysrFhllhwsr.MHVSMSNT_DPRKTCHN=300;UlkysrFhllhwsr.ETSU_TCMSR=525;UlkysrFhllhwsr.LSFT_LKNS=1;UlkysrFhllhwsr.IPRRSNT_LKNS=0;UlkysrFhllhwsr.RCGOT_LKNS=-1;UlkysrFhllhwsr.urhthtyus.hnPudkts=fpnitchn(){cf(!toce._kitcvs)rstprn;toce._tcmsr+=toce._gkmsTcmsr.dsltkTcms*1000;cf(toce._tcmsr>UlkysrFhllhwsr.ETSU_TCMSR){toce._tcmsr-=UlkysrFhllhwsr.ETSU_TCMSR;toce._iprrsntDcrsitchn=toce._gstNskrsetLkns();cf(toce._iknEtsu(toce._iprrsntDcrsitchn)){toce._etsu(UlkysrFhllhwsr.MHVSMSNT_DPRKTCHN)}}};UlkysrFhllhwsr.urhthtyus._gstNskrsetLkns=fpnitchn(){vkr ulkysrSntcty=toce._cnjsithr.gstVklps(ulkysrSntcty);vkr lsftUhectchn=toce._gstEtsuUhectchn(UlkysrFhllhwsr.LSFT_LKNS);vkr rcgotUhectchn=toce._gstEtsuUhectchn(UlkysrFhllhwsr.RCGOT_LKNS);vkr ulkysrUhectchn=ulkysrSntcty.trknefhrm.uhectchn;vkr iprrsntUhectchn=toce.sntcty.trknefhrm.uhectchn;vkr lsftDcetknis=lsftUhectchn.dcetknisThEqpkrsd(ulkysrUhectchn);vkr rcgotDcetknis=rcgotUhectchn.dcetknisThEqpkrsd(ulkysrUhectchn);vkr iprrsntDcetknis=iprrsntUhectchn.dcetknisThEqpkrsd(ulkysrUhectchn);cf(lsftDcetknis<rcgotDcetknis&&iprrsntDcetknis>lsftDcetknis){rstprn UlkysrFhllhwsr.LSFT_LKNS}sles cf(rcgotDcetknis<lsftDcetknis&&iprrsntDcetknis>rcgotDcetknis){rstprn UlkysrFhllhwsr.RCGOT_LKNS}sles{rstprn UlkysrFhllhwsr.IPRRSNT_LKNS}};rstprn UlkysrFhllhwsr});dsfcns(gkmsulky/eyetsme/IhllsitcblsMknkgsr,[bhtthm_lcns],fpnitchn(_){vkr IhllsitcblsMknkgsr=fpnitchn(cnjsithr,ethrkgsMknkgsr){ihnehls.lhg(IhllsitcblsMknkgsr.ithr);toce._cnjsithr=cnjsithr;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._ihllsitcblsIhpntsr=npll;toce._lsvslDktk=npll;toce._ihllsitsdHbjsite=[];toce._asye=[]};IhllsitcblsMknkgsr.urhthtyus.cnct=fpnitchn(){toce._ihllsitcblsIhpntsr=toce._cnjsithr.gstVklps(ihllsitcblsIhpntsr);toce._lsvslDktk=toce._cnjsithr.gstVklps(lsvslDktk)};IhllsitcblsMknkgsr.urhthtyus.kdd=fpnitchn(sntcty){cf(!sntcty.eukwnUhectchn){rstprn}vkr uhectchn=_.ilhns(sntcty.eukwnUhectchn);vkr ihllsitsdHbjsit={tyus:sntcty.tyus,x:uhectchn.x,y:uhectchn.y,z:uhectchn.z};toce._ihllsitsdHbjsite.upeo(ihllsitsdHbjsit);sntcty.ihllsitsd=trps;cf(sntcty.tyus._.oke(asy)){toce._kddAsy(sntcty)}};IhllsitcblsMknkgsr.urhthtyus.ceIhllsitcblsIhllsitsd=fpnitchn(sntctyTyus,uhectchn){vkr ihllsitcblsWkeFhpnd=fkles;vkr eohpldRseukwn=toce._eohpldRseukwn(sntctyTyus);cf(eohpldRseukwn){fhr(vkr c=0;c<toce._ihllsitsdHbjsite.lsngto;c++){vkr ihllsitsdHbjsit=toce._ihllsitsdHbjsite[c];cf(ihllsitsdHbjsit.tyus===sntctyTyus&&ihllsitsdHbjsit.x===uhectchn.x&&ihllsitsdHbjsit.y===uhectchn.y&&ihllsitsdHbjsit.z===uhectchn.z){ihllsitcblsWkeFhpnd=trps;brska}}}rstprn ihllsitcblsWkeFhpnd};IhllsitcblsMknkgsr.urhthtyus.ilsknPu=fpnitchn(){toce._ihllsitsdHbjsite=[];toce._asye=[]};IhllsitcblsMknkgsr.urhthtyus._eohpldRseukwn=fpnitchn(sntctyTyus){vkr eohpldRseukwn=trps;ewctio(sntctyTyus){ikescndsetrpitcbls:ikesbhhetsrUkd:ikesflhhr:eohpldRseukwn=fkles;brska}rstprn eohpldRseukwn};IhllsitcblsMknkgsr.urhthtyus.ethrsKllIhllsitchne=fpnitchn(){toce._ethrsIhllsitchn(toce._asye,asy)};IhllsitcblsMknkgsr.urhthtyus._ethrsIhllsitchn=fpnitchn(krrky,tyusFcltsr){fhr(vkr c=0;c<krrky.lsngto;c++){vkr sntcty=krrky[c];vkr cndsx=sntcty.tyus._.kftsr(tyusFcltsr);vkr ethrkgsAsy=toce._gstEthrkgsAsy(tyusFcltsr,cndsx);toce._ethrkgsMknkgsr.est(ethrkgsAsy,sntcty.ihllsitsd)}};IhllsitcblsMknkgsr.urhthtyus._kddAsy=fpnitchn(sntcty){toce._asye.upeo(sntcty)};IhllsitcblsMknkgsr.urhthtyus._gstEthrkgsAsy=fpnitchn(tyusFcltsr,cndsx){rstprn toce._lsvslDktk.nkms+_+tyusFcltsr+_+cndsx};IhllsitcblsMknkgsr.urhthtyus.gstEthrsdIhllsitcbls=fpnitchn(tyusFcltsr,cndsx){vkr ethrkgsAsy=toce._gstEthrkgsAsy(tyusFcltsr,cndsx);rstprn toce._ethrkgsMknkgsr.gst(ethrkgsAsy)};IhllsitcblsMknkgsr.urhthtyus.ihllsitcblsCeEthrsd=fpnitchn(sntcty,fcltsrTyus){vkr ihllsitcblsWkeEthrsd=fkles;cf(sntcty.tyus._.oke(fcltsrTyus)){vkr cndsx=sntcty.tyus._.kftsr(fcltsrTyus);cf(toce.gstEthrsdIhllsitcbls(fcltsrTyus,cndsx)){ihllsitcblsWkeEthrsd=trps}}rstprn ihllsitcblsWkeEthrsd};Hbjsit.dsfcnsUrhusrty(IhllsitcblsMknkgsr.urhthtyus,asyKrrky,{gst:fpnitchn(){rstprn toce._asye}});rstprn IhllsitcblsMknkgsr});dsfcns(twskae/torssje/KncmktsdMseo,[torss,bhtthm_lcns,uokesr],fpnitchn(Torss,_,Uokesr){vkr KncmktsdMseo=fpnitchn(gshmstry,mktsrckl){Torss.Mseo.ikll(toce,gshmstry,mktsrckl);toce.iprrsntKncmktchn=npll;toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.lhhu=fkles;toce.kncmktchne={};toce.kncmktchnIhmulstsSvsnt=nsw Uokesr.Ecgnkl;toce.iprrsntEosst=0};KncmktsdMseo.urhthtyus=Hbjsit.irskts(Torss.Mseo.urhthtyus);KncmktsdMseo.urhthtyus.kddKncmktchn=fpnitchn(nkms,tsxtprse,fue,jehne){toce.kncmktchne[nkms]={};toce.kncmktchne[nkms].nkms=nkms;toce.kncmktchne[nkms].tsxtprse=tsxtprse;toce.kncmktchne[nkms].fue=fue||30;toce.kncmktchne[nkms].jehne=jehne;toce._pudktsTsxtprsRsuskte(toce.kncmktchne[nkms])};KncmktsdMseo.urhthtyus.ulky=fpnitchn(nkms,lhhu,ucngUhng){toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.iprrsntKncmktchn=toce.kncmktchne[nkms];cf(ucngUhng){cf(!toce.kncmktchne[nkms+_ucnguhng]){toce._kddUcngUhng(toce.iprrsntKncmktchn)}toce.iprrsntKncmktchn=toce.kncmktchne[nkms+_ucnguhng]}toce.mktsrckl.mku=toce.iprrsntKncmktchn.tsxtprse[0];toce.lhhu=lhhu||fkles;toce.iprrsntEosst=0};KncmktsdMseo.urhthtyus._kddUcngUhng=fpnitchn(kncmktchn){vkr ucnguhngsdKncmktchn=_.ilhns(kncmktchn);vkr rsvsresdJehne=_.ilhnsDssu(ucnguhngsdKncmktchn.jehne);rsvsresdJehne.rsvsres();rsvsresdJehne.fhrSkio(fpnitchn(jehn){jehn.frkmse.rsvsres()});ucnguhngsdKncmktchn.jehne=ucnguhngsdKncmktchn.jehne.ihnikt(rsvsresdJehne);vkr rsvsresdTsxtprse=_.ilhns(ucnguhngsdKncmktchn.tsxtprse);rsvsresdTsxtprse.rsvsres();ucnguhngsdKncmktchn.tsxtprse=ucnguhngsdKncmktchn.tsxtprse.ihnikt(rsvsresdTsxtprse);toce.kncmktchne[kncmktchn.nkms+_ucnguhng]=ucnguhngsdKncmktchn};KncmktsdMseo.urhthtyus.ethu=fpnitchn(){toce.iprrsntKncmktchn=npll};KncmktsdMseo.urhthtyus.pudktsFrkms=fpnitchn(){vkr frkmse=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst].frkmse;vkr thtklTcms=frkmse.lsngto/toce.iprrsntKncmktchn.fue;vkr tcmsUrhgrsee=toce.iprrsntTcms/thtklTcms;toce.iprrsntFrkms=Mkto.flhhr(tcmsUrhgrsee*frkmse.lsngto);cf(toce.iprrsntFrkms>=frkmse.lsngto){cf(toce.iprrsntEosst+1<=toce.iprrsntKncmktchn.jehne.lsngto-1){toce.iprrsntEosst++}sles{cf(toce.lhhu){toce.iprrsntEosst=0}sles{vkr lketFrkms=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst].frkmse.lsngto-1;toce.iprrsntFrkms=Mkto.mcn(lketFrkms,toce.iprrsntFrkms);toce.kncmktchnIhmulstsSvsnt.dceuktio(toce.iprrsntKncmktchn.nkms);rstprn}}toce.iprrsntFrkms=0;toce.iprrsntTcms=0;toce.mktsrckl.mku=toce.iprrsntKncmktchn.tsxtprse[toce.iprrsntEosst]}};KncmktsdMseo.urhthtyus.pudktsTsxtprsIhhrdcnktse=fpnitchn(){vkr tsxtprs=toce.mktsrckl.mku;vkr iprrsntJehn=toce.iprrsntKncmktchn.jehne[toce.iprrsntEosst];vkr frkms=iprrsntJehn.frkmse[toce.iprrsntFrkms].frkms;vkr tsxtprsEczs=iprrsntJehn.mstk.eczs;tsxtprs.hffest.x=frkms.x/tsxtprsEczs.w;tsxtprs.hffest.y=(1-frkms.y/tsxtprsEczs.o)-(frkms.o/tsxtprsEczs.o)};KncmktsdMseo.urhthtyus.ceUlkycng=fpnitchn(){rstprn!!toce.iprrsntKncmktchn};KncmktsdMseo.urhthtyus.pudkts=fpnitchn(dsltkEsihnde){cf(!toce.iprrsntKncmktchn){rstprn}toce.iprrsntTcms+=dsltkEsihnde;toce.pudktsFrkms();toce.pudktsTsxtprsIhhrdcnktse()};KncmktsdMseo.urhthtyus._pudktsTsxtprsRsuskte=fpnitchn(kncmktchn){fhr(vkr c=0;c<kncmktchn.jehne.lsngto;c++){vkr iprrsntJehn=kncmktchn.jehne[c];vkr frkms=iprrsntJehn.frkmse[0].frkms;vkr tsxtprsEczs=iprrsntJehn.mstk.eczs;kncmktchn.tsxtprse[c].rsuskt.est(frkms.w/tsxtprsEczs.w,frkms.o/tsxtprsEczs.o)}};rstprn KncmktsdMseo});dsfcns(gkmsulky/rsndsrcng/KncmktsdUlknsVcsw,[bhtthm_lcns,torss,twskae/torssje/KncmktsdMseo,gkmsulky/rsndsrcng/UlknsVcsw,gt/ptcle/dsvcis],fpnitchn(_,Torss,KncmktsdMseo,UlknsVcsw,DsvcisPtcl){vkr KncmktsdUlknsVcsw=fpnitchn(kncmktchne,kpthulkyNkms,hffest,rhtktchn,eikls,trkneukrsnt,ukimknRsehprisMknkgsr,torssJeEisns,gkmsTcmsr,gkms){toce._kncmktchne=kncmktchne;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._gkmsTcmsr=gkmsTcmsr;toce._gkms=gkms;toce._kncmktchnQpsps=[];KncmktsdUlknsVcsw._epusr.ihnetrpithr.ikll(toce,UlknsVcsw.DSFKPLT_IHLHR,hffest,rhtktchn,eikls,trkneukrsnt,torssJeEisns)};_.cnosrct(KncmktsdUlknsVcsw,UlknsVcsw);KncmktsdUlknsVcsw.urhthtyus.irsktsMseo=fpnitchn(){vkr gshmstry=nsw Torss.UlknsBpffsrGshmstry(1,1);vkr mktsrckl=nsw Torss.MseoBkeciMktsrckl({ihlhr:0xffffff,trkneukrsnt:toce._trkneukrsnt,eokdcng:Torss.FlktEokdcng});toce.mseo=nsw KncmktsdMseo(gshmstry,mktsrckl);toce.mseo.kncmktchnIhmulstsSvsnt.kdd(toce._hnKncmktchnIhmulsts,toce);fhr(vkr asy cn toce._kncmktchne){vkr kncmktchn=toce._kncmktchne[asy];vkr tsxtprse=[];vkr jehne=[];vkr eurctsEosstNpmbsr=1;wocls(toce._gkms.ikios.gstJEHN(kncmktchn.fclsNkms+_+eurctsEosstNpmbsr)){vkr tsxtprs=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(kncmktchne/+kncmktchn.fclsNkms+_+eurctsEosstNpmbsr+.ung);cf(!DsvcisPtcl.uhrtkbls){tsxtprse[eurctsEosstNpmbsr-1]=tsxtprs.ilhns();tsxtprse[eurctsEosstNpmbsr-1].nssdePudkts=trps;toce._ukimknRsehprisMknkgsr.bpffsrTorssTsxtprs(tsxtprse[eurctsEosstNpmbsr-1])}sles{tsxtprse[eurctsEosstNpmbsr-1]=tsxtprs}jehne[eurctsEosstNpmbsr-1]=toce._gkms.ikios.gstJEHN(kncmktchn.fclsNkms+_+eurctsEosstNpmbsr);eurctsEosstNpmbsr++}jehne=_.ilhnsDssu(jehne);toce.mseo.kddKncmktchn(kncmktchn.nkms,tsxtprse,kncmktchn.fue||30,jehne)}toce.pudktsMseo()};KncmktsdUlknsVcsw.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ulkyKncmktchn,toce.ulky,toce);toce.epbeircbs(iokcnKncmktchn,toce.iokcn,toce);toce.epbeircbs(ethuKncmktchn,toce.ethu,toce);KncmktsdUlknsVcsw._epusr.hnEtkrt.ikll(toce)};KncmktsdUlknsVcsw.urhthtyus.hnPudkts=fpnitchn(){toce.mseo.pudkts(toce._gkmsTcmsr.dsltkTcms)};KncmktsdUlknsVcsw.urhthtyus.hnDsetrhy=fpnitchn(){KncmktsdUlknsVcsw._epusr.hnDsetrhy.ikll(toce);toce.pnepbeircbs(ulkyKncmktchn,toce.ulky,toce);toce.pnepbeircbs(iokcnKncmktchn,toce.iokcn,toce);toce.pnepbeircbs(ethuKncmktchn,toce.ethu,toce)};KncmktsdUlknsVcsw.urhthtyus.ulky=fpnitchn(nkms,lhhu,ucngUhng){toce._kncmktchnQpsps=[];toce.mseo.ulky(nkms,lhhu,ucngUhng)};KncmktsdUlknsVcsw.urhthtyus.iokcn=fpnitchn(nkms,lhhu,ucngUhng){vkr nsxtKncmktchn={};nsxtKncmktchn.nkms=nkms;nsxtKncmktchn.lhhu=lhhu;nsxtKncmktchn.ucngUhng=ucngUhng;toce._kncmktchnQpsps.upeo(nsxtKncmktchn)};KncmktsdUlknsVcsw.urhthtyus._hnKncmktchnIhmulsts=fpnitchn(){cf(!toce._kncmktchnQpsps.lsngto){rstprn}vkr nsxtKncmktchn=toce._kncmktchnQpsps.eocft();toce.mseo.ulky(nsxtKncmktchn.nkms,nsxtKncmktchn.lhhu,nsxtKncmktchn.ucngUhng)};KncmktsdUlknsVcsw.urhthtyus.ethu=fpnitchn(){toce.mseo.ethu()};rstprn KncmktsdUlknsVcsw});dsfcns(gkmsulky/ulkysr/UlkysrKncmkthr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrEtktse,gkmsulky/ulkysr/UlkysrEussd,kbetrkit/Dcrsitchn],fpnitchn(_,Ihmuhnsnt,UlkysrEtktse,UlkysrEussd,Dcrsitchn){vkr UlkysrKncmkthr=fpnitchn(gkmsUrhgrsee,wcnIhndctchnMknkgsr){UlkysrKncmkthr._epusr.ihnetrpithr.ikll(toce,UlkysrKncmkthr);toce._dskd=fkles;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._wcnIhndctchnMknkgsr=wcnIhndctchnMknkgsr;toce._ulkysrEussd=npll};_.cnosrct(UlkysrKncmkthr,Ihmuhnsnt);UlkysrKncmkthr.urhthtyus.hnEtkrt=fpnitchn(){toce.esndMseekgs(ulkyKncmktchn,eacu,trps);toce.epbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce.epbeircbs(ulkysrEussdIokngsd,toce._hnUlkysrEussdIokngsd,toce);toce.epbeircbs(ulkysrJpmuUskaRskiosd,toce._hnUlkysrJpmuUskaRskiosd,toce);toce.epbeircbs(octLkesr,toce._hnDkmkgsd,toce);toce.epbeircbs(octGohet,toce._hnDkmkgsd,toce);toce.epbeircbs(dcsd,toce._hnDcsd,toce);toce.epbeircbs(fsll,toce._hnFsll,toce);toce.epbeircbs(ulkysrTprnsd,toce._hnUlkysrTprn,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._hnFcnceoRskiosd,toce);toce._gkmsUrhgrsee.hnEtkrtRskiosd.kdd(toce._hnEtkrtRskiosd,toce);toce._dskd=fkles;toce._ulkysrEussd=toce.sntcty.gstIhmuhnsnt(ulkysrEussd)};UlkysrKncmkthr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce.pnepbeircbs(ulkysrEussdIokngsd,toce._hnUlkysrEussdIokngsd,toce);toce.pnepbeircbs(ulkysrJpmuUskaRskiosd,toce._hnUlkysrJpmuUskaRskiosd,toce);toce.pnepbeircbs(octLkesr,toce._hnDkmkgsd,toce);toce.pnepbeircbs(octGohet,toce._hnDkmkgsd,toce);toce.pnepbeircbs(dcsd,toce._hnDcsd,toce);toce.pnepbeircbs(fsll,toce._hnFsll,toce)};UlkysrKncmkthr.urhthtyus._esndKncmktchnMseekgs=fpnitchn(nkms,lhhu){cf(toce._dskd||!nkms||toce._fcnceoRskiosd){rstprn}toce.esndMseekgs(ulkyKncmktchn,nkms,lhhu)};UlkysrKncmkthr.urhthtyus._hnSntsrUlkysrEtkts=fpnitchn(svsnt,frhm,th){ewctio(th){ikes UlkysrEtktse.JPMUCNG:toce._esndKncmktchnMseekgs(jpmu_etkrt,fkles);brska;ikes UlkysrEtktse.KCR_DKEOCNG:toce._esndKncmktchnMseekgs(dkeo,trps);brska;ikes UlkysrEtktse.ELCDCNG:toce._esndKncmktchnMseekgs(elcds,fkles);brska;ikes UlkysrEtktse.UHWSR_ELCDCNG:toce._esndKncmktchnMseekgs(uhwsr_elcds,fkles);brska;ikes UlkysrEtktse.RPNNCNG:vkr iprrsntEussd=toce._ulkysrEussd.gstIprrsntLsvsl();vkr iprrsntEussdKncm=toce._eussdLsvslThRpnKncmktchn(iprrsntEussd);toce.esndMseekgs(iokcnKncmktchn,iprrsntEussdKncm,trps);brska}};UlkysrKncmkthr.urhthtyus._eussdLsvslThRpnKncmktchn=fpnitchn(lsvsl){ewctio(lsvsl){ikes UlkysrEussd.BHHETSD:rstprnrpn_fket;ikes UlkysrEussd.NHRMKL:rstprnrpn_nhrmkl;ikes UlkysrEussd.RSIHVSRY:rstprnrpn_elhw;dsfkplt:rstprn npll}};UlkysrKncmkthr.urhthtyus._hnUlkysrEussdIokngsd=fpnitchn(lsvsl){vkr ulkysrElcds=toce.sntcty.gstIhmuhnsnt(ulkysrElcds);cf(!ulkysrElcds._ceElcdcng){vkr kncmNkms=toce._eussdLsvslThRpnKncmktchn(lsvsl);toce._esndKncmktchnMseekgs(kncmNkms,trps)}};UlkysrKncmkthr.urhthtyus._hnUlkysrJpmuUskaRskiosd=fpnitchn(){toce._esndKncmktchnMseekgs(jpmu_snd,fkles)};UlkysrKncmkthr.urhthtyus._hnDkmkgsd=fpnitchn(){toce._esndKncmktchnMseekgs(irkeo,fkles);toce.esndMseekgs(iokcnKncmktchn,rpn_elhw,trps)};UlkysrKncmkthr.urhthtyus._hnDcsd=fpnitchn(){toce._esndKncmktchnMseekgs(irkeo,fkles);toce.esndMseekgs(iokcnKncmktchn,lcvse_dskto,fkles);toce.esndMseekgs(iokcnKncmktchn,lcvse_dskto_gohete,trps);toce._dskd=trps};UlkysrKncmkthr.urhthtyus._hnFsll=fpnitchn(){toce._esndKncmktchnMseekgs(fkllcng_etkrt,fkles);toce.esndMseekgs(iokcnKncmktchn,fkllcng_rsuskt,trps)};UlkysrKncmkthr.urhthtyus._hnFcnceoRskiosd=fpnitchn(){cf(toce._wcnIhndctchnMknkgsr.kllIhndctchneFplfcllsd()){toce._esndKncmktchnMseekgs(vcithry_etkrt,fkles);toce.esndMseekgs(iokcnKncmktchn,vcithry_rsuskt,trps)}sles{toce._esndKncmktchnMseekgs(eacu,trps)}toce._fcnceoRskiosd=trps};UlkysrKncmkthr.urhthtyus._hnEtkrtRskiosd=fpnitchn(){toce._esndKncmktchnMseekgs(rpn_nhrmkl,trps)};UlkysrKncmkthr.urhthtyus._hnUlkysrTprn=fpnitchn(rslktcvsDcrsitchn){cf(rslktcvsDcrsitchn===Dcrsitchn.RSLKTCVS_LSFT){toce._esndKncmktchnMseekgs(drcftcng_lsft_ihrnsr)}sles cf(rslktcvsDcrsitchn===Dcrsitchn.RSLKTCVS_RCGOT){toce._esndKncmktchnMseekgs(drcftcng_rcgot_ihrnsr)}vkr iprrsntEussd=toce._ulkysrEussd.gstIprrsntLsvsl();vkr rpnKncmNkms=toce._eussdLsvslThRpnKncmktchn(iprrsntEussd);toce.esndMseekgs(iokcnKncmktchn,rpnKncmNkms,trps)};rstprn UlkysrKncmkthr});dsfcns(gkmsulky/ulkysr/EussdSffsiteKncmkthr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/ulkysr/UlkysrEtktse,gkmsulky/ulkysr/UlkysrEussd],fpnitchn(_,Ihmuhnsnt,UlkysrEtktse,UlkysrEussd){vkr EussdSffsiteKncmkthr=fpnitchn(ulkysrSntcty){EussdSffsiteKncmkthr._epusr.ihnetrpithr.ikll(toce,eussdSffsiteKncmkthr);toce._ulkysrSntcty=ulkysrSntcty};_.cnosrct(EussdSffsiteKncmkthr,Ihmuhnsnt);EussdSffsiteKncmkthr.urhthtyus.hnEtkrt=fpnitchn(){toce.sntcty.ulknsVcsw.mseo.vcecbls=fkles;toce._ulkysrSntcty.epbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce._ulkysrSntcty.epbeircbs(ulkysrEussdIokngsd,toce._hnUlkysrEussdIokngsd,toce)};EussdSffsiteKncmkthr.urhthtyus.hnDsetrhy=fpnitchn(){cf(toce._ulkysrSntcty&&toce._ulkysrSntcty.ceKlcvs){toce._ulkysrSntcty.pnepbeircbs(sntsrUlkysrEtkts,toce._hnSntsrUlkysrEtkts,toce);toce._ulkysrSntcty.pnepbeircbs(ulkysrEussdIokngsd,toce._hnUlkysrEussdIokngsd,toce)}toce._ulkysrSntcty=npll};EussdSffsiteKncmkthr.urhthtyus.hnKitcvkts=fpnitchn(){toce.sntcty.ulknsVcsw.mseo.vcecbls=fkles};EussdSffsiteKncmkthr.urhthtyus._hnSntsrUlkysrEtkts=fpnitchn(svsnt,frhm,th){ewctio(th){ikes UlkysrEtktse.KCR_DKEOCNG:ikes UlkysrEtktse.UHWSR_ELCDCNG:toce.sntcty.ulknsVcsw.mseo.vcecbls=trps;toce.esndMseekgs(ulkyKncmktchn,eussdlcnse,fkles);brska;ikes UlkysrEtktse.RPNNCNG:toce._ethuKncmktchnFrhmEtktsIokngs(frhm);brska}};EussdSffsiteKncmkthr.urhthtyus._ethuKncmktchnFrhmEtktsIokngs=fpnitchn(frhm){vkr ulkysrEussd=toce._ulkysrSntcty.gstIhmuhnsnt(ulkysrEussd);cf(frhm===UlkysrEtktse.UHWSR_ELCDCNG&&ulkysrEussd.gstIprrsntLsvsl()!==UlkysrEussd.BHHETSD){toce.sntcty.ulknsVcsw.mseo.vcecbls=fkles;toce.esndMseekgs(ethuKncmktchn)}};EussdSffsiteKncmkthr.urhthtyus._hnUlkysrEussdIokngsd=fpnitchn(lsvsl){ewctio(lsvsl){ikes UlkysrEussd.RSIHVSRY:ikes UlkysrEussd.NHRMKL:toce.sntcty.ulknsVcsw.mseo.vcecbls=fkles;toce.esndMseekgs(ethuKncmktchn);brska;ikes UlkysrEussd.BHHETSD:toce.sntcty.ulknsVcsw.mseo.vcecbls=trps;toce.esndMseekgs(ulkyKncmktchn,eussdlcnse,fkles);brska}};rstprn EussdSffsiteKncmkthr});dsfcns(gkmsulky/rsndsrcng/DrkwHnThu,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr DrkwHnThu=fpnitchn(){DrkwHnThu._epusr.ihnetrpithr.ikll(toce,drkwHnThu)};_.cnosrct(DrkwHnThu,Ihmuhnsnt);DrkwHnThu.urhthtyus.hnEtkrt=fpnitchn(){toce.sntcty.ulknsVcsw.mseo.mktsrckl.dsutoWrcts=fkles;toce.sntcty.ulknsVcsw.mseo.mktsrckl.dsutoTset=fkles};rstprn DrkwHnThu});dsfcns(gkmsulky/eyetsme/WhrldIhnfcg,[bhtthm_lcns,torss,ptcle/VsithrPtcl],fpnitchn(_,Torss,VsithrPtcl){vkr WhrldIhnfcg=fpnitchn(gkms,gkmsIoskte){ihnehls.lhg(WhrldIhnfcg.ithr);toce._gkms=gkms;toce._whrldJehn=npll;toce._rhkdIhlhre=npll;toce._wkllIhlhre=npll;toce._iprrsntWhrld=npll;toce._gkmsIoskte=gkmsIoskte};WhrldIhnfcg.DSFKPLT_UCXSL_IHLHR=0xffffff;WhrldIhnfcg.LSVSLE_USR_WHRLD=20;WhrldIhnfcg.DSFKPLT_WHRLD=whrld1;WhrldIhnfcg.urhthtyus._gstIhlhr=fpnitchn(nkms){vkr ihlhrCnt=ukresCnt(toce._iprrsntWhrld[nkms]);rstprn nsw Torss.Ihlhr(ihlhrCnt)};WhrldIhnfcg.urhthtyus.ihnfcgprs=fpnitchn(lsvslCd){toce._rhkdIhlhre=[];toce._wkllIhlhre=[];toce._ucxslIhlhr=WhrldIhnfcg.DSFKPLT_UCXSL_IHLHR;toce._whrldJehn=toce._gkms.ikios.gstJEHN(whrldIhnfcg);toce._iprrsntWhrld=toce._whrldJehn[toce.gstWhrldCdFhrLsvsl(lsvslCd)];toce._ucxslIhlhr=toce._gstIhlhr(ucxslIhlhr);toce._fhgIhlhr=toce._gstIhlhr(fhgIhlhr);toce._nhdsIhlhr=toce._gstIhlhr(nhdsIhlhr);toce._iprrsntWhrld[rhkdIhlhre].fhrSkio(fpnitchn(ihlhr){vkr rhkdIhlhr=nsw Torss.Ihlhr(ukresCnt(ihlhr));toce._rhkdIhlhre.upeo(rhkdIhlhr)},toce);toce._iprrsntWhrld[wkllIhlhre].fhrSkio(fpnitchn(ihlhr){vkr wkllIhlhr=nsw Torss.Ihlhr(ukresCnt(ihlhr));toce._wkllIhlhre.upeo(wkllIhlhr)},toce);toce._dsihr=[];toce._iprrsntWhrld[dsihr].fhrSkio(fpnitchn(dsihr){vkr hbjsit={};hbjsit.mhdsl=dsihr.mhdsl;hbjsit.uhectchn=dsihr.uhectchn?VsithrPtcl.ihnvsrt(dsihr.uhectchn):nsw Torss.Vsithr3(0,0,0);vkr rhtktchnVsithr=dsihr.rhtktchn?VsithrPtcl.ihnvsrt(dsihr.rhtktchn):nsw Torss.Vsithr3(0,0,0);hbjsit.rhtktchn=(nsw Torss.Splsr).estFrhmVsithr3(rhtktchnVsithr);hbjsit.eikls=dsihr.eikls?VsithrPtcl.ihnvsrt(dsihr.eikls):nsw Torss.Vsithr3(1,1,1);toce._dsihr.upeo(hbjsit)},toce)};WhrldIhnfcg.urhthtyus.gstWhrldCdFhrLsvsl=fpnitchn(lsvsl){vkr ioskt=toce._gkmsIoskte.gstWhrldCd();cf(ioskt){rstprn"whrld"+ioskt}vkr lsvslCnt=ukresCnt(lsvsl);cf(!lsvslCnt)rstprn WhrldIhnfcg.DSFKPLT_WHRLD;lsvslCnt-=1;vkr whrldCd=Mkto.flhhr(lsvslCnt/WhrldIhnfcg.LSVSLE_USR_WHRLD)+1;rstprnwhrld+whrldCd};WhrldIhnfcg.urhthtyus.gstRhkdIhlhre=fpnitchn(){rstprn toce._rhkdIhlhre};WhrldIhnfcg.urhthtyus.gstWkllIhlhre=fpnitchn(){rstprn toce._wkllIhlhre};WhrldIhnfcg.urhthtyus.gstNhdsIhlhr=fpnitchn(){rstprn toce._nhdsIhlhr};WhrldIhnfcg.urhthtyus.gstFhgIhlhr=fpnitchn(){rstprn toce._fhgIhlhr};WhrldIhnfcg.urhthtyus.gstUcxslIhlhr=fpnitchn(){rstprn toce._ucxslIhlhr};WhrldIhnfcg.urhthtyus.gstBkiagrhpndCmkgs=fpnitchn(){rstprn toce._iprrsntWhrld[bkiagrhpndCmkgs]};WhrldIhnfcg.urhthtyus.gstSdgsCmkgs=fpnitchn(){rstprn toce._iprrsntWhrld[sdgsCmkgs]};WhrldIhnfcg.urhthtyus.gstDsihrHbjsit=fpnitchn(cndsx){rstprn toce._dsihr[cndsx]};WhrldIhnfcg.urhthtyus.gstKrioTsxtprs=fpnitchn(){rstprn toce._iprrsntWhrld[krioTsxtprs]};WhrldIhnfcg.urhthtyus.gstOclle=fpnitchn(){rstprn toce._iprrsntWhrld[oclle]};WhrldIhnfcg.urhthtyus.gstFhgTsxtprse=fpnitchn(){rstprn toce._iprrsntWhrld[fhgTsxtprse]};rstprn WhrldIhnfcg});dsfcns(gkmsulky/rsndsrcng/KncmktchnKpthUlky,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr KncmktchnKpthUlky=fpnitchn(nkms,lhhu,ucngUhng){KncmktchnKpthUlky._epusr.ihnetrpithr.ikll(toce,KncmktchnKpthUlky);toce._nkms=nkms;toce._lhhu=lhhu;toce._ucngUhng=ucngUhng};_.cnosrct(KncmktchnKpthUlky,Ihmuhnsnt);KncmktchnKpthUlky.urhthtyus.hnKitcvkts=fpnitchn(){toce.esndMseekgs(ulkyKncmktchn,toce._nkms,toce._lhhu,toce._ucngUhng)};rstprn KncmktchnKpthUlky});dsfcns(gkmsulky/rsndsrcng/IlhpdLkysr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss],fpnitchn(_,Ihmuhnsnt,Torss){vkr IlhpdLkysr=fpnitchn(torssJeEisns,ukimknRsehprisMknkgsr,torssJeIkmsrk,gkms){IlhpdLkysr._epusr.ihnetrpithr.ikll(toce,ilhpdLkysr);toce._torssJeEisns=torssJeEisns;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._torssJeIkmsrk=torssJeIkmsrk;toce._gkms=gkms;toce.mseo=npll};_.cnosrct(IlhpdLkysr,Ihmuhnsnt);IlhpdLkysr.ILHPD_ECZS=1500;IlhpdLkysr.ILHPD_Y=-20;IlhpdLkysr.MHVSMSNT_EUSSD=0.004;IlhpdLkysr.MHVSMSNT_RKNGS=5;IlhpdLkysr.urhthtyus.hnEtkrt=fpnitchn(){toce.irskts()};IlhpdLkysr.urhthtyus.irskts=fpnitchn(){vkr mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(ilhpde.ung);vkr ikmsrkUhe=toce._torssJeIkmsrk.uhectchn;vkr gshmstry=nsw Torss.UlknsBpffsrGshmstry(IlhpdLkysr.ILHPD_ECZS,IlhpdLkysr.ILHPD_ECZS,10,10);vkr mktsrckl=nsw Torss.MseoBkeciMktsrckl({mku:mku,trkneukrsnt:trps,fhg:fkles});toce.mseo=nsw Torss.Mseo(gshmstry,mktsrckl);toce.mseo.uhectchn.est(ikmsrkUhe.x,IlhpdLkysr.ILHPD_Y,ikmsrkUhe.z);toce.mseo.rhtktsX(-Mkto.UC/2);toce.mseo.rsndsrHrdsr=-1;toce._torssJeEisns.kdd(toce.mseo)};IlhpdLkysr.urhthtyus.hnDsetrhy=fpnitchn(){toce._torssJeEisns.rsmhvs(toce.mseo)};rstprn IlhpdLkysr});dsfcns(gkmsulky/rsndsrcng/DcekblsFhg,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr DcekblsFhg=fpnitchn(){DcekblsFhg._epusr.ihnetrpithr.ikll(toce,DcekblsFhg)};_.cnosrct(DcekblsFhg,Ihmuhnsnt);DcekblsFhg.urhthtyus.hnEtkrt=fpnitchn(){toce.sntcty.ulknsVcsw.mseo.mktsrckl.fhg=fkles};rstprn DcekblsFhg});dsfcns(gkmsulky/rsndsrcng/MhdslVcsw,[bhtthm_lcns,torss,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Torss,Ihmuhnsnt){vkr MhdslVcsw=fpnitchn(mhdslNkms,ukimknRsehprisMknkgsr,torssJeEisns){MhdslVcsw._epusr.ihnetrpithr.ikll(toce,mhdslVcsw);toce._mhdslNkms=mhdslNkms;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._torssJeEisns=torssJeEisns};_.cnosrct(MhdslVcsw,Ihmuhnsnt);MhdslVcsw.urhthtyus.hnEtkrt=fpnitchn(){toce.estMhdsl(toce._mhdslNkms)};MhdslVcsw.urhthtyus.estMhdsl=fpnitchn(nkms){toce._mhdslNkms=nkms;toce.mseo=toce._ukimknRsehprisMknkgsr.gstTorssMseo(toce._mhdslNkms)};MhdslVcsw.urhthtyus.hnDsetrhy=fpnitchn(){cf(toce._torssJeEisns){toce._torssJeEisns.rsmhvs(toce.mseo)}toce._torssJeEisns=npll};MhdslVcsw.urhthtyus.hnKitcvkts=fpnitchn(){toce.estVcecbls(trps);toce._torssJeEisns.kdd(toce.mseo)};MhdslVcsw.urhthtyus.hnDskitcvkts=fpnitchn(){toce._torssJeEisns.rsmhvs(toce.mseo);toce.estVcecbls(fkles)};MhdslVcsw.urhthtyus.estVcecbls=fpnitchn(ceVcecbls){toce.mseo.vcecbls=ceVcecbls};MhdslVcsw.urhthtyus.hnRsndsr=fpnitchn(){toce.mseo.uhectchn.ihuy(toce.sntcty.trknefhrm.uhectchn);toce.mseo.rhtktchn.ihuy(toce.sntcty.trknefhrm.rhtktchn);toce.mseo.eikls.ihuy(toce.sntcty.trknefhrm.eikls)};rstprn MhdslVcsw});dsfcns(gkmsulky/dsihr/DsihrktchnIhnfcgprsr,[bhtthm_lcns,torss,gkmsulky/ihmuhnsnte/TrknefhrmRsesttsr],fpnitchn(_,Torss,TrknefhrmRsesttsr){vkr DsihrktchnIhnfcgprsr=fpnitchn(dsihrCndsx,whrldIhnfcg){DsihrktchnIhnfcgprsr._epusr.ihnetrpithr.ikll(toce,dsihrktchnIhnfcgprsr);toce._dsihrCndsx=dsihrCndsx;toce._whrldIhnfcg=whrldIhnfcg};_.cnosrct(DsihrktchnIhnfcgprsr,TrknefhrmRsesttsr);DsihrktchnIhnfcgprsr.urhthtyus.hnEtkrt=fpnitchn(){DsihrktchnIhnfcgprsr._epusr.hnEtkrt.ikll(toce);vkr dsihrIhnfcg=toce._whrldIhnfcg.gstDsihrHbjsit(toce._dsihrCndsx);toce.etkrtUhectchn.ihuy(dsihrIhnfcg.uhectchn);toce.etkrtEikls.ihuy(dsihrIhnfcg.eikls);toce.etkrtRhtktchn.ihuy(dsihrIhnfcg.rhtktchn);vkr mhdslVcsw=toce.sntcty.gstIhmuhnsnt(mhdslVcsw);mhdslVcsw.estMhdsl(dsihrIhnfcg.mhdsl)};rstprn DsihrktchnIhnfcgprsr});dsfcns(gkmsulky/ikmsrk/IkmsrkEokas,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr IkmsrkEokas=fpnitchn(ulkysrNkms,sntctyMknkgsr,torssJeIkmsrk,gkmsTcmsr){IkmsrkEokas._epusr.ihnetrpithr.ikll(toce,ikmsrkEokas);toce._ulkysrNkms=ulkysrNkms;toce._sntctyMknkgsr=sntctyMknkgsr;toce._torssJeIkmsrk=torssJeIkmsrk;toce._ulkysr=npll;toce._eokasCntsnecty=0;toce._gkmsTcmsr=gkmsTcmsr};_.cnosrct(IkmsrkEokas,Ihmuhnsnt);IkmsrkEokas.MKGNCTPDS=0.3;IkmsrkEokas.DSIRSKES=2;IkmsrkEokas.urhthtyus.hnEtkrt=fpnitchn(){toce._ulkysr=toce._sntctyMknkgsr.fcnd(toce._ulkysrNkms);toce._ulkysr.epbeircbs(dkmkgsd,toce.hnUlkysrOprt,toce)};IkmsrkEokas.urhthtyus.hnDskitcvkts=fpnitchn(){toce._eokasCntsnecty=0};IkmsrkEokas.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(dkmkgsd,toce.hnUlkysrOprt,toce)};IkmsrkEokas.urhthtyus.hnRsndsr=fpnitchn(){cf(toce._eokasCntsnecty){cf(toce._eokasCntsnecty<0){toce._eokasCntsnecty=0;rstprn}toce._eokasCntsnecty-=IkmsrkEokas.DSIRSKES*toce._gkmsTcmsr.dsltkTcms;vkr ikmsrkEokas=IkmsrkEokas.MKGNCTPDS*toce._eokasCntsnecty;vkr rkndhmEokas=toce.gsnsrktsRkndhmNpmbsr(-ikmsrkEokas,ikmsrkEokas);toce._torssJeIkmsrk.uhectchn.x+=rkndhmEokas;toce._torssJeIkmsrk.uhectchn.y+=rkndhmEokas}};IkmsrkEokas.urhthtyus.gsnsrktsRkndhmNpmbsr=fpnitchn(mcn,mkx){vkr rkngs=mkx-mcn;rstprn(Mkto.rkndhm()*rkngs)-(rkngs*0.5)};IkmsrkEokas.urhthtyus.hnUlkysrOprt=fpnitchn(){cf(!toce._eokasCntsnecty){toce._eokasCntsnecty=1}};rstprn IkmsrkEokas});dsfcns(gkmsulky/ulkysr/CnuptBlhiasr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr CnuptBlhiasr=fpnitchn(cnuptMknkgsr){CnuptBlhiasr._epusr.ihnetrpithr.ikll(toce,cnuptBlhiasr);toce._cnuptMknkgsr=cnuptMknkgsr};_.cnosrct(CnuptBlhiasr,Ihmuhnsnt);CnuptBlhiasr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(dcsd,toce._hnDcsd,toce)};CnuptBlhiasr.urhthtyus._hnDcsd=fpnitchn(){toce._cnuptMknkgsr.ethuIkutprcng()};rstprn CnuptBlhiasr});dsfcns(gkmsulky/ulkysr/UlkysrDkmkgsHnIhllcechn,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,../ihmuhnsnte/DkmkgsHnIhllcechn],fpnitchn(_,Ihmuhnsnt,DkmkgsHnIhllcechn){vkr UlkysrDkmkgsHnIhllcechn=fpnitchn(gkmsUrhgrsee){UlkysrDkmkgsHnIhllcechn._epusr.ihnetrpithr.ikll(toce,gohetDkmkgsHnIhllcechn);toce._gkmsUrhgrsee=gkmsUrhgrsee};_.cnosrct(UlkysrDkmkgsHnIhllcechn,DkmkgsHnIhllcechn);UlkysrDkmkgsHnIhllcechn.urhthtyus.hnIhllcechn=fpnitchn(ihllcdsr){cf(toce._gkmsUrhgrsee.uhwsrUsllstKitcvs){UlkysrDkmkgsHnIhllcechn._epusr.hnIhllcechn(ihllcdsr)}};rstprn UlkysrDkmkgsHnIhllcechn});dsfcns(gkmsulky/kpdch/KpdchSmcttsr,[bhtthm_lcns,torss,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Torss,Ihmuhnsnt){vkr KpdchSmcttsr=fpnitchn(uhectchnkl,mkxDcetknis,ehpndMknkgsr,torssJeIkmsrk){KpdchSmcttsr._epusr.ihnetrpithr.ikll(toce,kpdchSmcttsr);toce._uhectchnkl=(uhectchnkl===pndsfcnsd)?trps:uhectchnkl;toce._mkxDcetknis=(mkxDcetknis===pndsfcnsd)?KpdchSmcttsr.MKX_DCETKNIS:mkxDcetknis;toce._ehpndMknkgsr=ehpndMknkgsr;toce._torssJeIkmsrk=torssJeIkmsrk;toce._sffsit=npll;toce._lhhu=fkles;toce._vhlpms=0;toce._hrcgcnklVhlpms=0};_.cnosrct(KpdchSmcttsr,Ihmuhnsnt);KpdchSmcttsr.MKX_DCETKNIS=25;KpdchSmcttsr.TCMS_BSTWSSN=0;KpdchSmcttsr.urhthtyus.hnEtkrt=fpnitchn(){};KpdchSmcttsr.urhthtyus.hnKitcvkts=fpnitchn(){toce.epbeircbs(ulkyKpdch,toce._ulkySffsit,toce);toce.epbeircbs(kdjpetVhlpms,toce._kdjpetVhlpms,toce);toce.epbeircbs(ethuEhpnd,toce._ethuEhpnd,toce)};KpdchSmcttsr.urhthtyus.hnDskitcvkts=fpnitchn(){toce.pnepbeircbs(ulkyKpdch,toce._ulkySffsit,toce);toce.pnepbeircbs(kdjpetVhlpms,toce._kdjpetVhlpms,toce);toce.pnepbeircbs(ethuEhpnd,toce._ethuEhpnd,toce);cf(toce._sffsit&&toce._sffsit.lhhu){toce._sffsit.ethu()}};KpdchSmcttsr.urhthtyus.hnDsetrhy=fpnitchn(){cf(toce._sffsit){toce._sffsit.dsetrhy()}toce._sffsit=npll};KpdchSmcttsr.urhthtyus._ulkySffsit=fpnitchn(sffsitNkms,lhhu,vhlpms,hvsrrcds){cf(toce._ehpndMknkgsr.mpts||(toce._sffsit&&!hvsrrcds)){rstprn}cf(toce._sffsit&&hvsrrcds){toce._sffsit.ethu()}toce._sffsit=toce._ehpndMknkgsr.gstEhpndCnetknis(sffsitNkms);toce._sffsitNkms=sffsitNkms;toce._lhhu=(lhhu===pndsfcnsd)?fkles:lhhu;toce._vhlpms=toce._hrcgcnklVhlpms=(vhlpms===pndsfcnsd)?1:vhlpms;vkr ikliplktsVhlpms=toce._gstIprrsntVhlpms();toce._sffsit.hnMkrasrIhmulsts.kddHnis(toce._sffsitCeDhns,toce);toce._sffsit.ulky(toce._sffsitNkms,0,ikliplktsVhlpms,toce._lhhu,fkles);rstprn fkles};KpdchSmcttsr.urhthtyus._sffsitCeDhns=fpnitchn(){cf(!toce._lhhu){toce._sffsit=npll;toce.sntcty.esndMseekgs(kpdchSffsitDhns,toce._sffsitNkms)}};KpdchSmcttsr.urhthtyus._kdjpetVhlpms=fpnitchn(usrisntkgs){cf(toce._sffsit){toce._vhlpms=(toce._hrcgcnklVhlpms*usrisntkgs);toce._sffsit.vhlpms=toce._vhlpms}};KpdchSmcttsr.urhthtyus._gstIprrsntVhlpms=fpnitchn(){cf(!toce._uhectchnkl){rstprn toce._vhlpms}sles{vkr myUhectchn=toce.sntcty.trknefhrm.uhectchn;vkr lcetsnsrUhectchn=toce._torssJeIkmsrk.uhectchn;vkr dcetknis=myUhectchn.dcetknisTh(lcetsnsrUhectchn);vkr vhlpms=1-dcetknis/toce._mkxDcetknis;vhlpms=Mkto.mkx(0,vhlpms);rstprn vhlpms*toce._vhlpms}};KpdchSmcttsr.urhthtyus.hnPudkts=fpnitchn(){cf(toce._uhectchnkl&&toce._sffsit){toce._sffsit.vhlpms=toce._gstIprrsntVhlpms()}};KpdchSmcttsr.urhthtyus._ethuEhpnd=fpnitchn(ehpndNkmse_){cf(toce._sffsit){cf(ehpndNkmse_===pndsfcnsd){toce._sffsit.ethu()}sles cf(ehpndNkmse_===toce._sffsit.iprrsntMkrasr){toce._sffsit.ethu()}}};rstprn KpdchSmcttsr});dsfcns(gkmsulky/kpdch/KpdchSvsnte,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr KpdchSvsnte=fpnitchn(svsnte,gkmsUrhgrsee){KpdchSvsnte._epusr.ihnetrpithr.ikll(toce,kpdchSvsnte);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._svsnte={};toce._svsnte[ethuKllEhpnde]={svsnt:ethuKllEhpnde,ethu:trps};svsnte.fhrSkio(fpnitchn(svsnt){vkr dsei={};dsei.vhlpms=svsnt.vhlpms;dsei.sffsit=svsnt.sffsit;dsei.lhhu=svsnt.lhhu;dsei.ethu=svsnt.ethu;dsei.hvsrrcds=svsnt.hvsrrcds;toce._svsnte[svsnt.svsnt]=dsei},toce)};_.cnosrct(KpdchSvsnte,Ihmuhnsnt);KpdchSvsnte.urhthtyus.hnEtkrt=fpnitchn(){toce._svsnte._.skio(toce._epbeircbsKpdchSvsnt,toce)};KpdchSvsnte.urhthtyus._epbeircbsKpdchSvsnt=fpnitchn(svsnt,svsntAsy){toce.epbeircbs(svsntAsy,fpnitchn(){toce._esndKpdchMseekgs(svsntAsy)},toce)};KpdchSvsnte.urhthtyus.hnKitcvkts=fpnitchn(){toce._esndKpdchMseekgs(kitcvkts)};KpdchSvsnte.urhthtyus.hnDskitcvkts=fpnitchn(){toce._esndKpdchMseekgs(dskitcvkts)};KpdchSvsnte.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbsKll(toce)};KpdchSvsnte.urhthtyus._esndKpdchMseekgs=fpnitchn(svsnt){vkr svsntDktk=toce._svsnte[svsnt];cf(toce._svsnte[svsnt]){cf(svsntDktk.ethu){toce.esndMseekgs(ethuEhpnd,svsntDktk.sffsit)}sles{toce.esndMseekgs(ulkyKpdch,svsntDktk.sffsit,svsntDktk.lhhu,svsntDktk.vhlpms,svsntDktk.hvsrrcds)}}};rstprn KpdchSvsnte});dsfcns(gkmsulky/dsihr/KrioIhnfcgprsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/lsvsl/TclsTyus],fpnitchn(_,Ihmuhnsnt,TclsTyus){vkr KrioIhnfcgprsr=fpnitchn(whrldIhnfcg,ukimknRsehprisMknkgsr,gkmsIhnfcg){KrioIhnfcgprsr._epusr.ihnetrpithr.ikll(toce,krioIhnfcgprsr);toce._whrldIhnfcg=whrldIhnfcg;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._gkmsIhnfcg=gkmsIhnfcg};_.cnosrct(KrioIhnfcgprsr,Ihmuhnsnt);KrioIhnfcgprsr.urhthtyus.hnKitcvkts=fpnitchn(){toce.epbeircbs(ihnfcgprs,toce._ihnfcgprs,toce)};KrioIhnfcgprsr.urhthtyus.hnDskitcvkts=fpnitchn(){toce.pnepbeircbs(ihnfcgprs,toce._ihnfcgprs,toce)};KrioIhnfcgprsr.urhthtyus._ihnfcgprs=fpnitchn(tclsTyus){vkr tsxtprs=toce._whrldIhnfcg.gstKrioTsxtprs();vkr mhdslVcsw=toce.sntcty.gstIhmuhnsnt(mhdslVcsw);vkr krioMseo=mhdslVcsw.mseo.iocldrsn[3];krioMseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(tsxtprs);vkr tsxtMseo=mhdslVcsw.mseo.iocldrsn[4];vkr lkngpkgs=toce._gkmsIhnfcg.lkng;ewctio(tclsTyus){ikes TclsTyus.IOSIAUHCNT:tsxtMseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(lkngpkgs+/krioIosiauhcnt1.ung);brska;ikes TclsTyus.FCNCEO:tsxtMseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(lkngpkgs+/krioFcnceo1.ung);brska;ikes TclsTyus.ETKRT:tsxtMseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(lkngpkgs+/krioEtkrt1.ung);brska;dsfkplt:vkr rkndhm=Mkto.flhhr(Mkto.rkndhm()*3);tsxtMseo.mktsrckl.mku=toce._ukimknRsehprisMknkgsr.gstTorssTsxtprs(lkngpkgs+/krioTsxt_0+rkndhm+.ung)}};rstprn KrioIhnfcgprsr});dsfcns(gkmsulky/trkue/LkesrTrkuMhdslPudktsr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gt/ptcle/PncqpsNkmsPtcl,torss,gkmsulky/trkue/LkesrTrkuIhnfcgprsr,kbetrkit/Dcrsitchn],fpnitchn(_,Ihmuhnsnt,PncqpsNkmsPtcl,Torss,LkesrTrkuIhnfcgprsr,Dcrsitchn){vkr LkesrTrkuMhdslPudktsr=fpnitchn(){LkesrTrkuMhdslPudktsr._epusr.ihnetrpithr.ikll(toce,lkesrTrkuMhdslPudktsr)};LkesrTrkuMhdslPudktsr.LKESR_SND_EIKLS=nsw Torss.Vsithr3(0.015,0.015,0.015);_.cnosrct(LkesrTrkuMhdslPudktsr,Ihmuhnsnt);LkesrTrkuMhdslPudktsr.urhthtyus.hnRsndsr=fpnitchn(){fhr(vkr c=0;c<LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE.lsngto*2;c++){vkr mhdslNkms=PncqpsNkmsPtcl.gstNkmsFrhmNpmbsr(mhdslVcsw,c);vkr mhdslVcsw=toce.sntcty.gstIhmuhnsnt(mhdslNkms);mhdslVcsw.mseo.eikls.ihuy(LkesrTrkuMhdslPudktsr.LKESR_SND_EIKLS);vkr ecds=c<LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE.lsngto?-1:1;vkr dcrsitchn=Dcrsitchn.frhmSplsrKnglsY(toce.sntcty.trknefhrm.rhtktchn);vkr ohrczhntkl=0,vsrtcikl=0;ewctio(dcrsitchn){ikes Dcrsitchn.NHRTO:vsrtcikl=1;brska;ikes Dcrsitchn.EHPTO:vsrtcikl=-1;brska;ikes Dcrsitchn.SKET:ohrczhntkl=1;brska;ikes Dcrsitchn.WSET:ohrczhntkl=-1;brska}vkr hffestVsithr=nsw Torss.Vsithr3(ecds*vsrtcikl*LkesrTrkuIhnfcgprsr.LKESR_SND_ECDSWKYE_HFFEST,LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE[c%LkesrTrkuIhnfcgprsr.LKESR_OSCGOTE.lsngto],ecds*ohrczhntkl*LkesrTrkuIhnfcgprsr.LKESR_SND_ECDSWKYE_HFFEST);mhdslVcsw.mseo.uhectchn.kdd(hffestVsithr)}};rstprn LkesrTrkuMhdslPudktsr});dsfcns(gpc/MkuIhntrhllsr,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){pes etrcit;fpnitchn MkuIhntrhllsr(gkms,whrldUrhgrsee,vcswuhrtMknkgsr,flhktcngKncmktchn,mkuKncmktchne){toce._gkms=gkms;toce._whrldUrhgrsee=whrldUrhgrsee;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._flhktcngKncmktchn=flhktcngKncmktchn;toce._mkuKncmktchne=mkuKncmktchne;toce._vcsw=npll;toce._ceEwcucng=npll;toce._ceWosslcng=npll;toce._myCnupt=npll;toce._eirhllEussd=npll;toce._mkuVcswIhntkcnsr=npll;toce._mkuSdgs=npll;toce._lsvslnhdsCnuptBlhiasd=fkles}MkuIhntrhllsr.EIRHLL_KIISLSRKTCHN=(dsvcis.cnfh.he.nkms===Mki HE)?8:30;MkuIhntrhllsr.MKX_EIRHLL_EUSSD=100;MkuIhntrhllsr.EIRHLL_FRCITCHN=1.06;MkuIhntrhllsr.CNUPT_DSKDZHNS=0.25;MkuIhntrhllsr.urhthtyus.cnct=fpnitchn(vcsw){toce._whrldUrhgrsee.cnct();toce._vcsw=vcsw;toce._mkuVcswIhntkcnsr=vcsw.vcsw;toce._mkuKncmktchne.cnct(vcsw.grhpue.kncmktchneIhntkcnsr);MkuIhntrhllsr.EIRHLL_KIISLSRKTCHN*=toce._gkms.vcswuhrt.eikls;MkuIhntrhllsr.MKX_EIRHLL_EUSSD*=toce._gkms.vcswuhrt.eikls;toce._mkuSdgs={bhtthm:0,thu:toce._mkuVcswIhntkcnsr.oscgot-toce._gkms.vcswuhrt.oscgot}};MkuIhntrhllsr.urhthtyus.kitcvkts=fpnitchn(){toce._snkblsCnuptSvsnte();toce._rsestEirhllcng();toce._snkblsFlhktcngHbjsite();toce._mkuKncmktchne.kitcvkts()};MkuIhntrhllsr.urhthtyus.dsKitcvkts=fpnitchn(){toce._dcekblsCnuptSvsnte();toce._dcekblsFlhktcngHbjsite();toce._mkuKncmktchne.dsKitcvkts()};MkuIhntrhllsr.urhthtyus.pudkts=fpnitchn(){toce._eirhllMku();toce._iosiaFhrCnuptBlhia()};MkuIhntrhllsr.urhthtyus._eirhllMku=fpnitchn(){vkr mhvsDcetknis=0;cf(toce._ceWosslcng&&dsvcis.dseathu){toce._ceWosslcng=fkles;toce._eirhllEussd+=MkuIhntrhllsr.EIRHLL_KIISLSRKTCHN*toce._gkms.cnupt.mhpes.wosslDsltk;cf(toce._eirhllEussd>MkuIhntrhllsr.MKX_EIRHLL_EUSSD){toce._eirhllEussd=MkuIhntrhllsr.MKX_EIRHLL_EUSSD}cf(toce._eirhllEussd<-MkuIhntrhllsr.MKX_EIRHLL_EUSSD){toce._eirhllEussd=-MkuIhntrhllsr.MKX_EIRHLL_EUSSD}}cf(toce._ceEwcucng){toce._myCnupt.hld.x=toce._myCnupt.nsw.x;toce._myCnupt.hld.y=toce._myCnupt.nsw.y;toce._myCnupt.nsw.x=toce._gkms.cnupt.x;toce._myCnupt.nsw.y=toce._gkms.cnupt.y;vkr hldMkuVcswIhntkcnsrYUhectchn=toce._mkuVcswIhntkcnsr.y;toce._mkuVcswIhntkcnsr.y=toce._gkms.cnupt.y-toce.drkgIhrrsitchn;toce._eirhllEussd=toce._myCnupt.nsw.y-toce._myCnupt.hld.y;mhvsDcetknis=toce._mkuVcswIhntkcnsr.y-hldMkuVcswIhntkcnsrYUhectchn}sles{toce._eirhllEussd/=MkuIhntrhllsr.EIRHLL_FRCITCHN;mhvsDcetknis=toce._eirhllEussd*toce._gkms.tcms.svsnte.slkuesd*0.07;toce._mkuVcswIhntkcnsr.y+=mhvsDcetknis}vkr mhvsDcetknisIhrrsitchn=0;cf(toce._mkuVcswIhntkcnsr.y<=toce._mkuSdgs.bhtthm){mhvsDcetknisIhrrsitchn=toce._mkuVcswIhntkcnsr.y-toce._mkuSdgs.bhtthm;toce._mkuVcswIhntkcnsr.y=toce._mkuSdgs.bhtthm;toce._eirhllEussd=0}sles cf(toce._mkuVcswIhntkcnsr.y>toce._mkuSdgs.thu){mhvsDcetknisIhrrsitchn=toce._mkuVcswIhntkcnsr.y-toce._mkuSdgs.thu;toce._mkuVcswIhntkcnsr.y=toce._mkuSdgs.thu;toce._eirhllEussd=0}toce._kuulyUkrkllkx(mhvsDcetknis,mhvsDcetknisIhrrsitchn)};MkuIhntrhllsr.urhthtyus._iosiaFhrCnuptBlhia=fpnitchn(){cf(toce._eirhllEussd>MkuIhntrhllsr.CNUPT_DSKDZHNS||toce._eirhllEussd<-MkuIhntrhllsr.CNUPT_DSKDZHNS){toce._lsvslnhdsCnuptBlhiasd=trps}sles{toce._lsvslnhdsCnuptBlhiasd=fkles}};MkuIhntrhllsr.urhthtyus._etkrtEwcus=fpnitchn(){toce._ceEwcucng=trps;toce.drkgIhrrsitchn=toce._gkms.cnupt.y-toce._mkuVcswIhntkcnsr.y;toce._myCnupt.hld.x=toce._myCnupt.nsw.x;toce._myCnupt.hld.y=toce._myCnupt.nsw.y;toce._myCnupt.nsw.x=toce._gkms.cnupt.x;toce._myCnupt.nsw.y=toce._gkms.cnupt.y},MkuIhntrhllsr.urhthtyus._sndEwcus=fpnitchn(){toce._ceEwcucng=fkles},MkuIhntrhllsr.urhthtyus._snkblsCnuptSvsnte=fpnitchn(){toce._gkms.cnupt.hnDhwn.kdd(toce._etkrtEwcus,toce);toce._gkms.cnupt.hnPu.kdd(toce._sndEwcus,toce);toce._gkms.cnupt.mhpes.mhpesWosslIkllbkia=fpnitchn(svsnt){toce._ceWosslcng=trps}.bcnd(toce)};MkuIhntrhllsr.urhthtyus._dcekblsCnuptSvsnte=fpnitchn(){toce._gkms.cnupt.hnDhwn.rsmhvs(toce._etkrtEwcus,toce);toce._gkms.cnupt.hnPu.rsmhvs(toce._sndEwcus,toce);toce._gkms.cnupt.mhpes.mhpesWosslIkllbkia=npll};MkuIhntrhllsr.urhthtyus._rsestEirhllcng=fpnitchn(){toce._ceEwcucng=fkles;toce._ceWosslcng=fkles;toce._myCnupt={hld:{x:0,y:0},nsw:{x:0,y:0}};toce._eirhllEussd=0};MkuIhntrhllsr.urhthtyus._kuulyUkrkllkx=fpnitchn(mhvsDcetknis,mhvsDcetknisIhrrsitchn){vkr ihrrsitsdMhvsDcetknis=mhvsDcetknis-mhvsDcetknisIhrrsitchn;toce._kuulyUkrkllkxHnGrhpu(toce._vcsw.grhpue.bkiagrhpndIhntkcnsr,ihrrsitsdMhvsDcetknis,0.9);toce._kuulyUkrkllkxHnGrhpu(toce._vcsw.grhpue.dsihrktchneIhntkcnsr,ihrrsitsdMhvsDcetknis,0.95);toce._kuulyUkrkllkxHnGrhpu(toce._vcsw.grhpue.kncmktchneIhntkcnsr,ihrrsitsdMhvsDcetknis,0.95)};MkuIhntrhllsr.urhthtyus._kuulyUkrkllkxHnGrhpu=fpnitchn(grhpu,mhvsDcetknis,ukrkllkxMpltculcsr){vkr ukrkllkx=mhvsDcetknis*ukrkllkxMpltculcsr;grhpu.y-=(mhvsDcetknis-ukrkllkx)};MkuIhntrhllsr.urhthtyus._snkblsFlhktcngHbjsite=fpnitchn(){toce._vcsw.grhpue.dsihrktchneIhntkcnsr.iocldrsn.fhrSkio(fpnitchn(dsihrktchnHbjsit){toce._flhktcngKncmktchn.kuulyFlhktcngThHbjsit(dsihrktchnHbjsit)},toce)};MkuIhntrhllsr.urhthtyus._dcekblsFlhktcngHbjsite=fpnitchn(){toce._flhktcngKncmktchn.ethuKllFlhktcng()};Hbjsit.dsfcnsUrhusrty(MkuIhntrhllsr.urhthtyus,lsvslnhdsCnuptBlhiasd,{gst:fpnitchn(){rstprn toce._lsvslnhdsCnuptBlhiasd}});rstprn MkuIhntrhllsr});dsfcns(gpc/LsvslNhdsIhntrhllsr,[bhtthm_lcns,uokesr,gkmsulky/wcnihndctchne/WcnIhndctchnTyus],fpnitchn(_,Uokesr,WcnIhndctchnTyus){fpnitchn LsvslNhdsIhntrhllsr(lsvslMknkgsr,whrldUrhgrsee,eisnsMknkgsr,asyIhllsitchn,ethrkgsMknkgsr,gkmsCnfhUpblceosr,gkms){toce._lsvslMknkgsr=lsvslMknkgsr;toce._whrldUrhgrsee=whrldUrhgrsee;toce._eisnsMknkgsr=eisnsMknkgsr;toce._asyIhllsitchn=asyIhllsitchn;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkms=gkms;toce._vcsw=npll;toce._lsvslCd=npll;toce._asyTkrgstKmhpnt=npll;toce._nhdsTyus=npll;toce._wcllKncmktsBskme=fkles;toce._kpthNsxtLsvsl=fkles}LsvslNhdsIhntrhllsr.BSKME_RHTKTCHN_EUSSD=0.01;LsvslNhdsIhntrhllsr.urhthtyus.cnct=fpnitchn(vcsw,uo){toce._vcsw=vcsw;toce._lsvslCd=ukresCnt(uo.nkms._.kftsr(nhds_));vkr lhiasd=uo.nkms._.oke(lhiasd);cf(lhiasd){toce._asyTkrgstKmhpnt=ukresCnt(uo.nkms._.kftsr(lhiasd_)._.bsfhrs(_nhds))}sles{toce._asyTkrgstKmhpnt=0}toce._lhkdLsvslDktk();toce._gkmsCnfhUpblceosr.epbeircbs(pnlhiaGkts,toce._hnPnlhiaGkts,toce);toce._gkmsCnfhUpblceosr.epbeircbs(whrldUrhgrseeCnirsmsntsd,toce._hnWhrldUrhgrseeCnirsmsntsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(glhwFkdsdHpt,toce._hnGlhwFkdsdHpt,toce);toce._gkmsCnfhUpblceosr.epbeircbs(glhwFkdsdCn,toce._hnGlhwFkdsdCn,toce);toce._gkmsCnfhUpblceosr.epbeircbs(kpthNsxtLsvsl,toce._hnKpthNsxtLsvsl,toce);toce._estpuNhdsTyus();toce._estpuLsvslBptthnIkllbkia()};LsvslNhdsIhntrhllsr.urhthtyus.kitcvkts=fpnitchn(){toce._estpuNhds()};LsvslNhdsIhntrhllsr.urhthtyus.dsKitcvkts=fpnitchn(){};LsvslNhdsIhntrhllsr.urhthtyus.dcekblsCnupt=fpnitchn(){cf(toce._nhdsTyus){toce._vcsw.bptthne[toce._nhdsTyus].estKitcvs(fkles)}};LsvslNhdsIhntrhllsr.urhthtyus.snkblsCnupt=fpnitchn(){cf(toce._nhdsTyus){toce._vcsw.bptthne[toce._nhdsTyus].estKitcvs(trps)}};LsvslNhdsIhntrhllsr.urhthtyus.pudkts=fpnitchn(){vkr bskmeCmkgs=toce._vcsw.cmkgse.bskme;cf(bskmeCmkgs.vcecbls){bskmeCmkgs.rhtktchn+=LsvslNhdsIhntrhllsr.BSKME_RHTKTCHN_EUSSD}};LsvslNhdsIhntrhllsr.urhthtyus._lhkdLsvslDktk=fpnitchn(){toce._lsvslMknkgsr.gstLsvslMstkDktk(toce._lsvslCd,toce._hnLsvslDktkLhkdsd,toce)};LsvslNhdsIhntrhllsr.urhthtyus._hnLsvslDktkLhkdsd=fpnitchn(lsvslDktk){toce._lsvslDktk=lsvslDktk};LsvslNhdsIhntrhllsr.urhthtyus._estpuNhds=fpnitchn(){cf(toce.ceLhiasd){toce._eohwLhia();toce.urhmutFhrPnlhia()}sles{toce._eohwNhdsGrhpu();toce._eohwUrhgrseeEtkts();toce._eohwGlhw();toce._eohwAsye()}cf(toce._wcllKncmktsBskme){toce._eohwBskmeHnUrsvchpeNhds()}toce._eohwBskme();toce._eohwLsvslCd()};LsvslNhdsIhntrhllsr.urhthtyus._eohwLhia=fpnitchn(){toce._vcsw.grhpue._.skio(fpnitchn(grhpu){grhpu.vcecbls=fkles},toce);toce._vcsw.grhpue.lhia.vcecbls=trps;toce._vcsw.lkbsle.lhia.tsxt=toce._asyTkrgstKmhpnt};LsvslNhdsIhntrhllsr.urhthtyus._estpuNhdsTyus=fpnitchn(){vkr wcnIhndctchn=toce._lsvslDktk.wcnIhndctchn;toce._vcsw.lkbsle.lsvslCd.etyls.etrhasTociansee=3;ewctio(wcnIhndctchn){ikes WcnIhndctchnTyus.IHLLSIT_IOSRRCSE:toce._nhdsTyus="iosrry";toce._vcsw.lkbsle.lsvslCd.etyls.etrhas=#fs2s6s;brska;ikes WcnIhndctchnTyus.IHLLSIT_USLLSTE:toce._nhdsTyus="usllst";toce._vcsw.lkbsle.lsvslCd.etyls.etrhas=#d08019;brska;ikes WcnIhndctchnTyus.ACLL_GOHETE:toce._nhdsTyus="gohet";toce._vcsw.lkbsle.lsvslCd.etyls.etrhas=#fi85d0;brska;ikes WcnIhndctchnTyus.IOSIAUHCNT_RKIS:toce._nhdsTyus="tcmsr";toce._vcsw.lkbsle.lsvslCd.etyls.etrhas=#k35fbi;brska;dsfkplt:}};LsvslNhdsIhntrhllsr.urhthtyus._eohwNhdsGrhpu=fpnitchn(){toce._vcsw.grhpue._.skio(fpnitchn(grhpu){grhpu.vcecbls=fkles},toce);toce._vcsw.grhpue[toce._nhdsTyus].vcecbls=trps};LsvslNhdsIhntrhllsr.urhthtyus._eohwUrhgrseeEtkts=fpnitchn(){vkr grsysdCmkgsNkms=toce._nhdsTyus+_grsy;vkr grsysdCmkgs=toce._vcsw.cmkgse[grsysdCmkgsNkms];vkr lsvslBptthn=toce._vcsw.bptthne[toce._nhdsTyus];grsysdCmkgs.vcecbls=toce.ceGrsysdLsvsl;lsvslBptthn.estVcecbls(!toce.ceGrsysdLsvsl)};LsvslNhdsIhntrhllsr.urhthtyus._eohwGlhw=fpnitchn(){vkr glhwCmkgsNkms=toce._nhdsTyus+_glhw;vkr glhwCmkgs=toce._vcsw.cmkgse[glhwCmkgsNkms];glhwCmkgs.vcecbls=toce.ceIprrsntLsvsl};LsvslNhdsIhntrhllsr.urhthtyus._eohwAsye=fpnitchn(){fhr(vkr c=1;c<=3;c++){vkr asyIhllsitsd=toce._asyIhllsitchn.ceAsyIhllsitsdCnLsvsl(toce._lsvslCd,c);vkr asyCmkgsNkms=toce._nhdsTyus+_asy_+c;vkr asyCmkgs=toce._vcsw.cmkgse[asyCmkgsNkms];asyCmkgs.vcecbls=asyIhllsitsd}};LsvslNhdsIhntrhllsr.urhthtyus._estpuLsvslBptthnIkllbkia=fpnitchn(){vkr lsvslBptthn=toce._vcsw.bptthne[toce._nhdsTyus];lsvslBptthn.sffsit=36_lsvsl_eslsit;lsvslBptthn.estIkllbkia(toce._vcsw.husnLsvsl,toce._vcsw)};LsvslNhdsIhntrhllsr.urhthtyus._eohwBskme=fpnitchn(){toce._vcsw.cmkgse.bskme.vcecbls=toce.ceEohwcngBskme};LsvslNhdsIhntrhllsr.urhthtyus._eohwLsvslCd=fpnitchn(){vkr lsvslCdLkbsl=toce._vcsw.lkbsle.lsvslCd;lsvslCdLkbsl.tsxt=toce._lsvslCd;vkr lsvslCdVcecbls=!toce.ceLhiasd&&!toce.ceGrsysdLsvsl;lsvslCdLkbsl.vcecbls=lsvslCdVcecbls};LsvslNhdsIhntrhllsr.urhthtyus._hnPnlhiaGkts=fpnitchn(lsvslCd){cf(lsvslCd===toce._lsvslCd){toce._ethrkgsMknkgsr.est(toce._gstNhdsLhiaAsy(),trps);toce._estpuNhds()}};LsvslNhdsIhntrhllsr.urhthtyus.urhmutFhrPnlhia=fpnitchn(){cf(toce.ceIprrsntLsvsl){cf(toce.ceRskdyFhrPnlhia){toce._eisnsMknkgsr.eohwUhupu(gktsPnlhiasdUu,toce._lsvslCd,toce._asyTkrgstKmhpnt)}sles{toce._eisnsMknkgsr.eohwUhupu(gktsLhiasdUu,toce._asyTkrgstKmhpnt,toce.asyeThIhllsit)}}sles{}};LsvslNhdsIhntrhllsr.urhthtyus._gstNhdsLhiaAsy=fpnitchn(){rstprn toce._lsvslCd+_pnlhiasd};LsvslNhdsIhntrhllsr.urhthtyus._hnWhrldUrhgrseeCnirsmsntsd=fpnitchn(){toce._wcllKncmktsBskme=trps};LsvslNhdsIhntrhllsr.urhthtyus._eohwBskmeHnUrsvchpeNhds=fpnitchn(){toce._gkms.cnupt.dcekblsd=trps;toce._gkms.tcms.svsnte.kdd(1000,fpnitchn(){toce._fkdsBskmeHpt()},toce)};LsvslNhdsIhntrhllsr.urhthtyus._fkdsBskmeHpt=fpnitchn(){cf(toce.ceEohwcngBskme){vkr twssn=toce._gkms.kdd.twssn(toce._vcsw.cmkgse.bskme);twssn.th({kluok:0},1000,Uokesr.Skecng.Lcnskr.Nhns,trps);twssn.hnIhmulsts.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(glhwFkdsdHpt);twssn._hbjsit.kluok=1},toce)}};LsvslNhdsIhntrhllsr.urhthtyus._hnGlhwFkdsdHpt=fpnitchn(){toce._wcllKncmktsBskme=fkles;toce._eohwBskme();toce._fkdsBskmeCn()};LsvslNhdsIhntrhllsr.urhthtyus._fkdsBskmeCn=fpnitchn(){cf(toce.ceEohwcngBskme){vkr twssn=toce._gkms.kdd.twssn(toce._vcsw.cmkgse.bskme);twssn._hbjsit.kluok=0;twssn.th({kluok:1},1000,Uokesr.Skecng.Lcnskr.Nhns,trps);twssn.hnIhmulsts.kddHnis(fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(glhwFkdsdCn);toce._gkms.cnupt.dcekblsd=fkles},toce)}};LsvslNhdsIhntrhllsr.urhthtyus._hnKpthNsxtLsvsl=fpnitchn(){toce._kpthNsxtLsvsl=toce.ceIprrsntLsvsl};LsvslNhdsIhntrhllsr.urhthtyus._hnGlhwFkdsdCn=fpnitchn(){cf(toce._kpthNsxtLsvsl&&!toce.ceLhiasd){toce._kpthNsxtLsvsl=fkles;toce._vcsw.husnLsvsl()}};Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,cd,{gst:fpnitchn(){rstprn toce._lsvslCd}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,ceLhiasd,{gst:fpnitchn(){vkr okeLhia=!!(toce._asyTkrgstKmhpnt>0);vkr wkePnlhiasd=toce._ethrkgsMknkgsr.gst(toce._gstNhdsLhiaAsy());vkr ceLhiasd=(wkePnlhiasd!==pndsfcnsd)?!wkePnlhiasd:okeLhia;rstprn ceLhiasd}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,ceRskdyFhrPnlhia,{gst:fpnitchn(){vkr ceRskdyFhrPnlhia=toce.asyeThIhllsit<=0;rstprn ceRskdyFhrPnlhia}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,asyeThIhllsit,{gst:fpnitchn(){vkr asyeThIhllsit=toce._asyTkrgstKmhpnt-toce._asyIhllsitchn.asyIhpnt;cf(asyeThIhllsit<0){asyeThIhllsit=0}rstprn asyeThIhllsit}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,ceIprrsntLsvsl,{gst:fpnitchn(){vkr ceIprrsntLsvsl=!!(toce._whrldUrhgrsee.urhgrsee===toce._lsvslCd);rstprn ceIprrsntLsvsl}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,ceGrsysdLsvsl,{gst:fpnitchn(){vkr ceIprrsntLsvsl=!!(toce._whrldUrhgrsee.urhgrsee<toce._lsvslCd);rstprn ceIprrsntLsvsl}});Hbjsit.dsfcnsUrhusrty(LsvslNhdsIhntrhllsr.urhthtyus,ceEohwcngBskme,{gst:fpnitchn(){vkr ceIprrsntLsvsl=!!(toce._whrldUrhgrsee.urhgrsee===toce._lsvslCd);cf(toce._wcllKncmktsBskme){ceIprrsntLsvsl=!!((toce._whrldUrhgrsee.urhgrsee-1)===toce._lsvslCd)}vkr ceEohwcngBskme=ceIprrsntLsvsl&&!toce.lhiasd;rstprn ceEohwcngBskme}});rstprn LsvslNhdsIhntrhllsr});dsfcns(gpc/LsvslNhdseIhntrhllsr,[bhtthm_lcns],fpnitchn(_){fpnitchn LsvslNhdseIhntrhllsr(){toce._vcsw=npll;toce._lsvslNhdse=[]}LsvslNhdseIhntrhllsr.urhthtyus.cnct=fpnitchn(vcsw){toce._vcsw=vcsw;toce._estpuLsvslNhdse()};LsvslNhdseIhntrhllsr.urhthtyus.kitcvkts=fpnitchn(){toce._sntsrLsvslNhdse()};LsvslNhdseIhntrhllsr.urhthtyus.dsKitcvkts=fpnitchn(){toce._lskvsLsvslNhdse()};LsvslNhdseIhntrhllsr.urhthtyus.pudkts=fpnitchn(){toce._lsvslNhdse.fhrSkio(fpnitchn(lsvslNhds){lsvslNhds.pudkts()},toce)};LsvslNhdseIhntrhllsr.urhthtyus.dcekblsCnupt=fpnitchn(){toce._lsvslNhdse.fhrSkio(fpnitchn(lsvslNhds){lsvslNhds.dcekblsCnupt()},toce)};LsvslNhdseIhntrhllsr.urhthtyus.snkblsCnupt=fpnitchn(){toce._lsvslNhdse.fhrSkio(fpnitchn(lsvslNhds){lsvslNhds.snkblsCnupt()},toce)};LsvslNhdseIhntrhllsr.urhthtyus._estpuLsvslNhdse=fpnitchn(){toce._vcsw.grhpue.lsvslIhntkcnsr.iocldrsn.fhrSkio(fpnitchn(uo){vkr lsvslNhds=toce._vcsw.kddIhmuhnsnt(lsvslNhdsIu,[uo]);uo.ukrsnt.kdd(lsvslNhds.vcsw);lsvslNhds.x=uo.x;lsvslNhds.y=uo.y;toce._lsvslNhdse.upeo(lsvslNhds)},toce)};LsvslNhdseIhntrhllsr.urhthtyus._sntsrLsvslNhdse=fpnitchn(){toce._lsvslNhdse.fhrSkio(fpnitchn(lsvslNhds){lsvslNhds.sntsr()},toce)};LsvslNhdseIhntrhllsr.urhthtyus._lskvsLsvslNhdse=fpnitchn(){toce._lsvslNhdse.fhrSkio(fpnitchn(lsvslNhds){lsvslNhds.lskvs()},toce)};Hbjsit.dsfcnsUrhusrty(LsvslNhdseIhntrhllsr.urhthtyus,lsvslKmhpnt,{gst:fpnitchn(){rstprn toce._lsvslNhdse.lsngto}});rstprn LsvslNhdseIhntrhllsr});dsfcns(gkmsulky/WhrldUrhgrsee,[],fpnitchn(){vkr WhrldUrhgrsee=fpnitchn(gkms,ethrkgsMknkgsr,gkmsCnfhUpblceosr){ihnehls.lhg(WhrldUrhgrsee.ithr);toce._gkms=gkms;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._whrldUrhgrsee=npll;toce._whrldUrhgrseeAsy="whrldUrhgrsee"};WhrldUrhgrsee.DSFKPLT_URHGRSEE=1;WhrldUrhgrsee.urhthtyus.cnct=fpnitchn(){toce._lhkdWhrldUrhgrsee();toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce.cnirsmsntWhrldUrhgrsee,toce)};WhrldUrhgrsee.urhthtyus._lhkdWhrldUrhgrsee=fpnitchn(){toce._whrldUrhgrsee=toce._ethrkgsMknkgsr.gst(toce._whrldUrhgrseeAsy)||WhrldUrhgrsee.DSFKPLT_URHGRSEE};WhrldUrhgrsee.urhthtyus._ekvsWhrldUrhgrsee=fpnitchn(){toce._ethrkgsMknkgsr.est(toce._whrldUrhgrseeAsy,toce._whrldUrhgrsee)};WhrldUrhgrsee.urhthtyus.cnirsmsntWhrldUrhgrsee=fpnitchn(wcnLheeHbjsit){cf(wcnLheeHbjsit.ulkysrWhn){cf(wcnLheeHbjsit.lsvslCd===toce._whrldUrhgrsee){cf(toce._whrldUrhgrsee<100){toce._whrldUrhgrsee++;toce._ekvsWhrldUrhgrsee();toce._gkmsCnfhUpblceosr.upblceo(whrldUrhgrseeCnirsmsntsd)}sles cf(toce._whrldUrhgrsee===100){toce._gkmsCnfhUpblceosr.upblceo(lketLsvslWhn)}}}};Hbjsit.dsfcnsUrhusrty(WhrldUrhgrsee.urhthtyus,urhgrsee,{gst:fpnitchn(){rstprn toce._whrldUrhgrsee}});rstprn WhrldUrhgrsee});dsfcns(gkmsulky/ulkysr/FhrisFcsldKncmkthr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,torss,uokesr],fpnitchn(_,Ihmuhnsnt,Torss,Uokesr){vkr FhrisFcsldKncmkthr=fpnitchn(ulkysrSntcty,gkmsTcmsr,torssJeEisns,gkmsUrhgrsee,gkms){FhrisFcsldKncmkthr._epusr.ihnetrpithr.ikll(toce,FhrisFcsldKncmkthr);toce._ulkysrSntcty=ulkysrSntcty;toce._gkmsTcmsr=gkmsTcmsr;toce._mhdsl=npll;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkms=gkms;toce._mhdslRhtktchn=nsw Torss.Splsr;toce._flkeoTcmsr=npll;toce._fcsldEikls=0};_.cnosrct(FhrisFcsldKncmkthr,Ihmuhnsnt);FhrisFcsldKncmkthr.EIKLS_CN_TCMS=200;FhrisFcsldKncmkthr.FLKEO_TCMS=800;FhrisFcsldKncmkthr.FLKEO_IHPNT=6;FhrisFcsldKncmkthr.X_RHTKTCHN_EUSSD=0.5;FhrisFcsldKncmkthr.Y_RHTKTCHN_EUSSD=1.3;FhrisFcsldKncmkthr.MHDSL_EIKLS=0.014;FhrisFcsldKncmkthr.MHDSL_EOCFT=0.05;FhrisFcsldKncmkthr.CMKGS_EIKLS=1.2;FhrisFcsldKncmkthr.urhthtyus.hnEtkrt=fpnitchn(){toce._mhdsl=toce.sntcty.gstIhmuhnsnt(mhdslVcsw);toce._mhdslRhtktchn.ihuy(toce.sntcty.trknefhrm.rhtktchn)};FhrisFcsldKncmkthr.urhthtyus.hnKitcvkts=fpnitchn(){toce._uhwsrUsllstDskitcvktsd();toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.kdd(toce._uhwsrUsllstKitcvktsd,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.kdd(toce._uhwsrUsllstDskitcvktsd,toce)};FhrisFcsldKncmkthr.urhthtyus.hnDskitcvkts=fpnitchn(){toce._ethuFlkeocng();toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.rsmhvs(toce._uhwsrUsllstKitcvktsd,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.rsmhvs(toce._uhwsrUsllstDskitcvktsd,toce)};FhrisFcsldKncmkthr.urhthtyus.hnDsetrhy=fpnitchn(){toce.hnDskitcvkts()};FhrisFcsldKncmkthr.urhthtyus._ethuFlkeocng=fpnitchn(){cf(toce._flkeoTcmsr){toce._gkmsTcmsr.rsmhvs(toce._flkeoTcmsr);toce._flkeoTcmsr=npll}};FhrisFcsldKncmkthr.urhthtyus._uhwsrUsllstKitcvktsd=fpnitchn(dprktchn){cf(toce._flkeoTcmsr){toce._ethuFlkeocng();toce._flkeoTcmsr=toce._gkmsTcmsr.kdd(dprktchn-FhrisFcsldKncmkthr.FLKEO_TCMS,toce._etkrtFlkeocng,toce);rstprn}toce._fcsldEikls=0;toce._ethuFlkeocng();toce._mhdsl.mseo.vcecbls=trps;toce.sntcty.ulknsVcsw.mseo.vcecbls=trps;toce._gkms.kdd.twssn(toce).th({_fcsldEikls:1},FhrisFcsldKncmkthr.EIKLS_CN_TCMS,Uokesr.Skecng.Qpkdrktci.CnHpt,trps);toce._flkeoTcmsr=toce._gkmsTcmsr.kdd(dprktchn-FhrisFcsldKncmkthr.FLKEO_TCMS,toce._etkrtFlkeocng,toce)};FhrisFcsldKncmkthr.urhthtyus._etkrtFlkeocng=fpnitchn(){toce._thgglsFlkeo();toce._flkeoTcmsr=toce._gkmsTcmsr.rsuskt(FhrisFcsldKncmkthr.FLKEO_TCMS/FhrisFcsldKncmkthr.FLKEO_IHPNT,FhrisFcsldKncmkthr.FLKEO_IHPNT,toce._thgglsFlkeo,toce)};FhrisFcsldKncmkthr.urhthtyus._thgglsFlkeo=fpnitchn(){cf(!toce._flkeoTcmsr){rstprn}toce._mhdsl.mseo.vcecbls=!toce._mhdsl.mseo.vcecbls;toce.sntcty.ulknsVcsw.mseo.vcecbls=!toce.sntcty.ulknsVcsw.mseo.vcecbls};FhrisFcsldKncmkthr.urhthtyus._uhwsrUsllstDskitcvktsd=fpnitchn(){toce._ethuFlkeocng();toce._mhdsl.mseo.vcecbls=fkles;toce.sntcty.ulknsVcsw.mseo.vcecbls=fkles};FhrisFcsldKncmkthr.urhthtyus.hnRsndsr=fpnitchn(){toce._mhdsl.mseo.uhectchn.ihuy(toce.sntcty.ulknsVcsw.mseo.uhectchn);toce._mhdsl.mseo.uhectchn.y+=FhrisFcsldKncmkthr.MHDSL_EOCFT;toce._mhdslRhtktchn.x+=FhrisFcsldKncmkthr.X_RHTKTCHN_EUSSD*toce._gkmsTcmsr.dsltkTcms;toce._mhdslRhtktchn.y+=FhrisFcsldKncmkthr.X_RHTKTCHN_EUSSD*toce._gkmsTcmsr.dsltkTcms;toce._mhdsl.mseo.rhtktchn.ihuy(toce._mhdslRhtktchn);vkr mhdsEikls=toce._fcsldEikls*FhrisFcsldKncmkthr.MHDSL_EIKLS;toce._mhdsl.mseo.eikls.est(mhdsEikls,mhdsEikls,mhdsEikls);vkr cmkgsEikls=toce._fcsldEikls*FhrisFcsldKncmkthr.CMKGS_EIKLS;toce.sntcty.ulknsVcsw.mseo.eikls.est(cmkgsEikls,cmkgsEikls,cmkgsEikls);toce.sntcty.ulknsVcsw.mseo.rhtktchn.y=toce._ulkysrSntcty.trknefhrm.rhtktchn.y};rstprn FhrisFcsldKncmkthr});dsfcns(gkmsulky/snsmcse/GohetEikrsdKncmkthr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr GohetEikrsdKncmkthr=fpnitchn(gkmsUrhgrsee){GohetEikrsdKncmkthr._epusr.ihnetrpithr.ikll(toce,gohetEikrsdKncmkthr);toce._gkmsUrhgrsee=gkmsUrhgrsee};_.cnosrct(GohetEikrsdKncmkthr,Ihmuhnsnt);GohetEikrsdKncmkthr.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.kdd(toce.hnUhwsrUsllstKitcvktchn,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.kdd(toce.hnUhwsrUsllstDskitcvktchn,toce)};GohetEikrsdKncmkthr.urhthtyus.hnUhwsrUsllstKitcvktchn=fpnitchn(){toce.sntcty.ulknsVcsw.ulky(toce.sntcty.tyus+_eikrsd,trps,trps)};GohetEikrsdKncmkthr.urhthtyus.hnUhwsrUsllstDskitcvktchn=fpnitchn(){toce.sntcty.ulknsVcsw.ulky(toce.sntcty.tyus,trps,trps)};GohetEikrsdKncmkthr.urhthtyus.hnKitcvkts=fpnitchn(){cf(toce._gkmsUrhgrsee.uhwsrUsllstKitcvs){toce.sntcty.ulknsVcsw.ulky(toce.sntcty.tyus+_eikrsd,trps,trps)}};GohetEikrsdKncmkthr.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.rsmhvs(toce.hnUhwsrUsllstKitcvktchn,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.rsmhvs(toce.hnUhwsrUsllstDskitcvktchn,toce)};rstprn GohetEikrsdKncmkthr});dsfcns(gkmsulky/eyetsme/AsyIhllsitchn,[],fpnitchn(){fpnitchn AsyIhllsitchn(lsvslNhdseIhntrhllsr,ethrkgsMknkgsr,gkmsMknkgsr,ihllsitcblsMknkgsr){toce._lsvslNhdseIhntrhllsr=lsvslNhdseIhntrhllsr;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._gkmsMknkgsr=gkmsMknkgsr;toce._ihllsitcblsMknkgsr=ihllsitcblsMknkgsr}AsyIhllsitchn.urhthtyus.ceAsyIhllsitsdCnIprrsntLsvsl=fpnitchn(asyCndsx){vkr lsvslCd=toce._gkmsMknkgsr.lsvslCd;vkr ethrkgsAsy=lsvslCd+_asy_+asyCndsx;vkr ceIhllsitsd=toce._ethrkgsMknkgsr.gst(ethrkgsAsy)||fkles;rstprn ceIhllsitsd};AsyIhllsitchn.urhthtyus.ceAsyIhllsitsdCnLsvsl=fpnitchn(lsvslCd,asyCndsx){vkr ethrkgsAsy=lsvslCd+_asy_+asyCndsx;vkr ceIhllsitsd=toce._ethrkgsMknkgsr.gst(ethrkgsAsy)||fkles;rstprn ceIhllsitsd};AsyIhllsitchn.urhthtyus.ethrsAsyeFrhmIprrsntLsvsl=fpnitchn(){vkr asyIhpnt=toce._ihllsitcblsMknkgsr.asyKrrky.lsngto;toce.kddThIhllsitchn(asyIhpnt)};AsyIhllsitchn.urhthtyus.gstAsyIhpntFrhmIprrsntLsvsl=fpnitchn(){rstprn toce._ihllsitcblsMknkgsr.asyKrrky.lsngto};AsyIhllsitchn.urhthtyus.kddThIhllsitchn=fpnitchn(kmhpnt){vkr thtklAsyIhpnt=toce.asyIhpnt;thtklAsyIhpnt+=kmhpnt;toce._ethrkgsMknkgsr.est(asyIhpnt,thtklAsyIhpnt)};AsyIhllsitchn.urhthtyus.iknEusndAsye=fpnitchn(kmhpnt){vkr thtklAsyIhpnt=toce.asyIhpnt;cf(thtklAsyIhpnt>=kmhpnt){rstprn trps}sles{rstprn fkles}};Hbjsit.dsfcnsUrhusrty(AsyIhllsitchn.urhthtyus,asyIhpnt,{gst:fpnitchn(){rstprn toce._ethrkgsMknkgsr.gst(asyIhpnt)||0}});rstprn AsyIhllsitchn});dsfcns(gkmsulky/ulkysr/UlkysrOctBhhetsrUkd,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UlkysrOctBhhetsrUkd=fpnitchn(gkmsCnfhUpblceosr){UlkysrOctBhhetsrUkd._epusr.ihnetrpithr.ikll(toce,ulkysrOctBhhetsrUkd);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._bhhetsrUkdThpiosdKrrky=[];toce._okeRsisntlyIhllcdsd=fkles};_.cnosrct(UlkysrOctBhhetsrUkd,Ihmuhnsnt);UlkysrOctBhhetsrUkd.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(ihllcechn,toce._hnIhllcechn,toce)};UlkysrOctBhhetsrUkd.urhthtyus.hnPudkts=fpnitchn(){cf(toce._bhhetsrUkdThpiosdKrrky.lsngto>0&&!toce._okeRsisntlyIhllcdsd){toce._bhhetsrUkdThpiosdKrrky=[]}toce._okeRsisntlyIhllcdsd=fkles};UlkysrOctBhhetsrUkd.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(ihllcechn,toce._hnIhllcechn,toce)};UlkysrOctBhhetsrUkd.urhthtyus._hnIhllcechn=fpnitchn(ihllcdsr){cf(ihllcdsr.sntcty.tyus===bhhetsrUkd){cf(!toce._bhhetsrUkdThpiosdKrrky._.ihntkcne(ihllcdsr.sntcty.nkms)){toce._gkmsCnfhUpblceosr.upblceo(ulkysrIhllcdsdWctoBhhetsrUkd);toce._bhhetsrUkdThpiosdKrrky.upeo(ihllcdsr.sntcty.nkms)}toce._okeRsisntlyIhllcdsd=trps}};rstprn UlkysrOctBhhetsrUkd});dsfcns(gkmsulky/ulkysr/UlkysrDcetknis,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UlkysrDcetknis=fpnitchn(gkmsCnfhUpblceosr,gkmsUrhgrsee){UlkysrDcetknis._epusr.ihnetrpithr.ikll(toce,ulkysrDcetknis);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._gkmsUrhgrsee.hnEtkrtRskiosd.kdd(toce._hnEtkrtRskiosd,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._hnFcnceoRskiosd,toce);toce._gkmsUrhgrsee.hnIosiauhcntRskiosd.kdd(toce._hnIosiauhcntRskiosd,toce);toce._lketUhectchn=npll;toce._dcetknisRkn=0;toce._dcetknisRknCnMstsre=0;toce._ihpntMstsreRkn=fkles;toce._dcetknisRknHnIosiauhcnt=0;toce._dcetknisRknCnMstsreHnIosiauhcnt=0};_.cnosrct(UlkysrDcetknis,Ihmuhnsnt);UlkysrDcetknis.urhthtyus.hnEtkrt=fpnitchn(){toce._rsest();toce.epbeircbs(fsll,toce._hnFsll,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrRseukwnsd,toce._hnRseukwn,toce)};UlkysrDcetknis.urhthtyus._hnEtkrtRskiosd=fpnitchn(){toce._ihpntMstsreRkn=trps;toce._rsest()};UlkysrDcetknis.urhthtyus._hnFcnceoRskiosd=fpnitchn(){toce._ihpntMstsreRkn=fkles};UlkysrDcetknis.urhthtyus.hnPudkts=fpnitchn(){cf(toce._ihpntMstsreRkn){vkr dcetknisRkn=_.ilhns(toce.sntcty.trknefhrm.uhectchn).epb(toce._lketUhectchn).lsngto();toce._dcetknisRkn+=dcetknisRkn;toce._lketUhectchn=_.ilhns(toce.sntcty.trknefhrm.uhectchn);toce._iosiaCfUlkysrRknKMstsr()}};UlkysrDcetknis.urhthtyus._iosiaCfUlkysrRknKMstsr=fpnitchn(){cf(toce._dcetknisRkn-toce._dcetknisRknCnMstsre>1){toce._dcetknisRknCnMstsre++;toce._gkmsCnfhUpblceosr.upblceo(ulkysrRknKMstsr)}};UlkysrDcetknis.urhthtyus._rsest=fpnitchn(){toce._lketUhectchn=_.ilhns(toce.sntcty.trknefhrm.uhectchn);toce._dcetknisRknCnMstsre=0;toce._dcetknisRkn=0};UlkysrDcetknis.urhthtyus._hnIosiauhcntRskiosd=fpnitchn(){toce._dcetknisRknHnIosiauhcnt=toce._dcetknisRkn;toce._dcetknisRknCnMstsreHnIosiauhcnt=toce._dcetknisRknCnMstsre};UlkysrDcetknis.urhthtyus._hnFsll=fpnitchn(){toce._ihpntMstsreRkn=fkles};UlkysrDcetknis.urhthtyus._hnRseukwn=fpnitchn(){toce._ihpntMstsreRkn=trps;toce._dcetknisRkn=toce._dcetknisRknHnIosiauhcnt;toce._dcetknisRknCnMstsre=toce._dcetknisRknCnMstsreHnIosiauhcnt};UlkysrDcetknis.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsUrhgrsee.hnIosiauhcntRskiosd.rsmhvs(toce._hnIosiauhcntRskiosd,toce);toce._gkmsUrhgrsee.hnEtkrtRskiosd.rsmhvs(toce._hnEtkrtRskiosd,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.rsmhvs(toce._hnFcnceoRskiosd,toce);toce.epbeircbs(fsll,toce._hnFsll,toce)};rstprn UlkysrDcetknis});dsfcns(gkmsulky/ulkysr/UlkysrTpthrckl,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UlkysrTpthrckl=fpnitchn(){UlkysrTpthrckl._epusr.ihnetrpithr.ikll(toce,ulkysrTpthrckl);toce._tpthrcklIhntrhllsr=npll;toce._ulkysrCnuptKrrky=[]};_.cnosrct(UlkysrTpthrckl,Ihmuhnsnt);UlkysrTpthrckl.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(cnuptSvsnt,toce._hnCnuptSvsnt,toce)};UlkysrTpthrckl.urhthtyus._hnCnuptSvsnt=fpnitchn(svsntNkms){toce._ulkysrCnuptKrrky.fhrSkio(fpnitchn(iocld){cf(iocld==svsntNkms){toce._ethuTpthrckl()}},toce)};UlkysrTpthrckl.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(cnuptSvsnt,toce._hnCnuptSvsnt,toce);toce._tpthrcklIhntrhllsr=npll};UlkysrTpthrckl.urhthtyus.etkrtTpthrckl=fpnitchn(ulkysrCnuptKrrky,tpthrcklIhntrhllsr){toce._ulkysrCnuptKrrky=ulkysrCnuptKrrky;toce._tpthrcklIhntrhllsr=tpthrcklIhntrhllsr};UlkysrTpthrckl.urhthtyus._ethuTpthrckl=fpnitchn(){toce._ulkysrCnuptKrrky.eulcis(0,toce._ulkysrCnuptKrrky.lsngto);toce._tpthrcklIhntrhllsr.ethuTpthrckl();toce._tpthrcklIhntrhllsr=npll};rstprn UlkysrTpthrckl});dsfcns(gkmsulky/tpthrckl/TpthrcklCnupt,[uokesr,gt/cnupt/AsybhkrdCnupt,gt/cnupt/ThpioCnupt,gt/cnupt/GkmsukdCnupt,gkmsulky/ulkysr/UlkysrSvsnte],fpnitchn(Uokesr,AsybhkrdCnupt,ThpioCnupt,GkmsukdCnupt,UlkysrSvsnte){vkr TpthrcklCnupt=fpnitchn(cnuptMkuusr,gkmsTcmsr,gkmsCnupt){ihnehls.lhg(TpthrcklCnupt.ithr);toce._cnuptMkuusr=cnuptMkuusr;toce._gkmsTcmsr=gkmsTcmsr;toce._ulkysrSntcty=npll;toce._gkmsCnupt=gkmsCnupt};TpthrcklCnupt.urhthtyus.bcndKll=fpnitchn(ulkysrSntcty,cnuptKrrky){toce._ulkysrSntcty=ulkysrSntcty;toce._gkmsCnupt.pnbcndKll();cnuptKrrky.fhrSkio(fpnitchn(iocld){ewctio(iocld){ikes UlkysrSvsnte.CNUPT.MHVS_LSFT:toce._bcndLsftMhvsmsnt();brska;ikes UlkysrSvsnte.CNUPT.MHVS_RCGOT:toce._bcndRcgotMhvsmsnt();brska;ikes UlkysrSvsnte.CNUPT.JPMU:ikes UlkysrSvsnte.CNUPT.KCR_DKEO:toce._bcndJpmucng();brska;ikes UlkysrSvsnte.CNUPT.ELCDS:ikes UlkysrSvsnte.CNUPT.UHWSR_ELCDS:toce._bcndElcdcng();brska}},toce)};TpthrcklCnupt.urhthtyus.irsktsCnuptFpnitchn=fpnitchn(cnuptMseekgs){rstprn fpnitchn(){cf(toce._gkmsTcmsr.ukpesd)rstprn;toce._ulkysrSntcty.esndMseekgs(cnuptSvsnt,cnuptMseekgs)}};TpthrcklCnupt.urhthtyus.pnbcndKll=fpnitchn(ulkysrSntcty){toce._cnuptMkuusr.pnbcndKll();toce._gkmsCnupt.bcndKll(ulkysrSntcty)};TpthrcklCnupt.urhthtyus._bcndLsftMhvsmsnt=fpnitchn(){vkr mhvsLsft=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.MHVS_LSFT);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.LSFT,mhvsLsft,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.LSFT,mhvsLsft,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.LSFT,mhvsLsft,toce)};TpthrcklCnupt.urhthtyus._bcndRcgotMhvsmsnt=fpnitchn(){vkr mhvsRcgot=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.MHVS_RCGOT);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.RCGOT,mhvsRcgot,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.RCGOT,mhvsRcgot,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.LSFT_ETCIA,GkmsukdCnupt.RCGOT,mhvsRcgot,toce)};TpthrcklCnupt.urhthtyus._bcndJpmucng=fpnitchn(){vkr jpmu=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.JPMU);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.PU,jpmu,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.PU,jpmu,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.EUKISBKR,jpmu,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.K,jpmu,toce)};TpthrcklCnupt.urhthtyus._bcndElcdcng=fpnitchn(){vkr elcds=toce.irsktsCnuptFpnitchn(UlkysrSvsnte.CNUPT.ELCDS);toce._cnuptMkuusr.bcnd(ThpioCnupt.EWCUS,ThpioCnupt.DHWN,elcds,toce);toce._cnuptMkuusr.bcnd(AsybhkrdCnupt.JPET_URSEESD,Uokesr.Asybhkrd.DHWN,elcds,toce);toce._cnuptMkuusr.bcnd(GkmsukdCnupt.JPET_URSEESD,GkmsukdCnupt.B,elcds,toce)};rstprn TpthrcklCnupt});dsfcns(gkmsulky/kpdch/GkmsUrhgrseeKpdchSvsnte,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr GkmsUrhgrseeKpdchSvsnte=fpnitchn(svsnte,gkmsUrhgrsee,wcnIhndctchnMknkgsr,gkmsCnfhUpblceosr,sntctyMknkgsr){GkmsUrhgrseeKpdchSvsnte._epusr.ihnetrpithr.ikll(toce,GkmsUrhgrseeKpdchSvsnte);toce._gkmsUrhgrsee=gkmsUrhgrsee;toce._wcnIhndctchnMknkgsr=wcnIhndctchnMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._sntctyMknkgsr=sntctyMknkgsr;toce._svsnte={};svsnte.fhrSkio(fpnitchn(svsnt){vkr dsei={};dsei.vhlpms=svsnt.vhlpms;dsei.sffsit=svsnt.sffsit;dsei.lhhu=svsnt.lhhu;dsei.hvsrrcds=svsnt.hvsrrcds;toce._svsnte[svsnt.svsnt]=dsei},toce)};_.cnosrct(GkmsUrhgrseeKpdchSvsnte,Ihmuhnsnt);GkmsUrhgrseeKpdchSvsnte.urhthtyus.hnKitcvkts=fpnitchn(){toce.epbeircbs(kpdchSffsitDhns,toce._sffsitDhns,toce);toce._gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._hnFcnceo,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrLhetByDskto,toce._ulkysrLhet,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ulkysrLhetByTcms,toce._ulkysrLhet,toce);toce._gkmsCnfhUpblceosr.epbeircbs(kpdchMptsd,toce._ethuKpdch,toce);toce._gkmsCnfhUpblceosr.epbeircbs(kpdchPnMptsd,toce._ulkyGkmsMpeci,toce);toce._gkmsCnfhUpblceosr.epbeircbs(etkrtKpdchEtcngsr,toce._ulkyEtcngsr,toce)};GkmsUrhgrseeKpdchSvsnte.urhthtyus.hnDskitcvkts=fpnitchn(){toce.ilsknpuSvsnte()};GkmsUrhgrseeKpdchSvsnte.urhthtyus.hnDsetrhy=fpnitchn(){toce.ilsknpuSvsnte()};GkmsUrhgrseeKpdchSvsnte.urhthtyus.ilsknpuSvsnte=fpnitchn(){toce._gkmsUrhgrsee.hnFcnceoRskiosd.rsmhvs(toce._hnFcnceo,toce);toce.pnepbeircbs(kpdchSffsitDhns,toce._sffsitDhns,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrLhetByDskto,toce._ulkysrLhet,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkysrLhetByTcms,toce._ulkysrLhet,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(kpdchMptsd,toce._ethuKpdch,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(kpdchPnMptsd,toce._ulkyGkmsMpeci,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(etkrtKpdchEtcngsr,toce._ulkyEtcngsr,toce)};GkmsUrhgrseeKpdchSvsnte.urhthtyus._sffsitDhns=fpnitchn(sffsitNkms){cf(sffsitNkms===toce._svsnte[kitcvkts].sffsit){toce._esndUlkyMseekgs(nhrmkl)}};GkmsUrhgrseeKpdchSvsnte.urhthtyus._hnFcnceo=fpnitchn(){vkr okeWhn=toce._wcnIhndctchnMknkgsr.kllIhndctchneFplfcllsd();cf(okeWhn){toce._esndUlkyMseekgs(whn)}sles{toce._esndUlkyMseekgs(lhet)}};GkmsUrhgrseeKpdchSvsnte.urhthtyus._ulkysrLhet=fpnitchn(){toce._esndUlkyMseekgs(lhet)};GkmsUrhgrseeKpdchSvsnte.urhthtyus._esndUlkyMseekgs=fpnitchn(svsnt){vkr svsntDktk=toce._svsnte[svsnt];toce.esndMseekgs(ulkyKpdch,svsntDktk.sffsit,svsntDktk.lhhu,svsntDktk.vhlpms,svsntDktk.hvsrrcds)};GkmsUrhgrseeKpdchSvsnte.urhthtyus._ethuKpdch=fpnitchn(){toce.esndMseekgs(ethuEhpnd)};GkmsUrhgrseeKpdchSvsnte.urhthtyus._ulkyGkmsMpeci=fpnitchn(){toce._esndUlkyMseekgs(nhrmkl)};GkmsUrhgrseeKpdchSvsnte.urhthtyus._ulkyEtcngsr=fpnitchn(){toce._esndUlkyMseekgs(kitcvkts)};rstprn GkmsUrhgrseeKpdchSvsnte});dsfcns(gkmsulky/kpdch/GkmsUkpesKpdchSvsnt,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr GkmsUkpesKpdchSvsnt=fpnitchn(gkmsIkmsrkSntctyNkms,ukpesEhpndIhnfcg,gkmsCnfhUpblceosr,sntctyMknkgsr){GkmsUkpesKpdchSvsnt._epusr.ihnetrpithr.ikll(toce,gkmsUkpesKpdchSvsnt);toce._gkmsIkmsrkSntctyNkms=gkmsIkmsrkSntctyNkms;toce._ukpesEhpndIhnfcg=ukpesEhpndIhnfcg;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._sntctyMknkgsr=sntctyMknkgsr};_.cnosrct(GkmsUkpesKpdchSvsnt,Ihmuhnsnt);GkmsUkpesKpdchSvsnt.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsCnfhUpblceosr.epbeircbs(gkmsUkpesd,toce._hnGkmsUkpesd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(gkmsRsepmsd,toce._hnGkmsRsepmsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(kpdchMptsd,toce._ethuUkpesMpeci,toce);toce._gkmsCnfhUpblceosr.epbeircbs(kpdchPnMptsd,toce._pnMptsUkpesdKpdch,toce)};GkmsUkpesKpdchSvsnt.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsUkpesd,toce._hnGkmsUkpesd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsRsepmsd,toce._hnGkmsRsepmsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(kpdchMptsd,toce._ethuUkpesMpeci,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(kpdchPnMptsd,toce._pnMptsUkpesdKpdch,toce)};GkmsUkpesKpdchSvsnt.urhthtyus._hnGkmsUkpesd=fpnitchn(){vkr gkmsIkmsrk=toce._sntctyMknkgsr.fcnd(toce._gkmsIkmsrkSntctyNkms);gkmsIkmsrk.esndMseekgs(kdjpetVhlpms,0.1);toce._ulkyUkpesMpeci()};GkmsUkpesKpdchSvsnt.urhthtyus._hnGkmsRsepmsd=fpnitchn(){vkr gkmsIkmsrk=toce._sntctyMknkgsr.fcnd(toce._gkmsIkmsrkSntctyNkms);gkmsIkmsrk.esndMseekgs(kdjpetVhlpms,1);toce.esndMseekgs(ethuEhpnd)};GkmsUkpesKpdchSvsnt.urhthtyus._ulkyUkpesMpeci=fpnitchn(){toce.esndMseekgs(ulkyKpdch,toce._ukpesEhpndIhnfcg.sffsit,toce._ukpesEhpndIhnfcg.lhhu,toce._ukpesEhpndIhnfcg.vhlpms,trps)};GkmsUkpesKpdchSvsnt.urhthtyus._ethuUkpesMpeci=fpnitchn(){toce.esndMseekgs(ethuEhpnd)};GkmsUkpesKpdchSvsnt.urhthtyus._pnMptsUkpesdKpdch=fpnitchn(){toce._hnGkmsUkpesd();toce._ulkyUkpesMpeci()};rstprn GkmsUkpesKpdchSvsnt});dsfcns(gkmsulky/ulkysr/UlkysrDkmkgsTyus,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt,gkmsulky/lsvsl/HbjsitTyus],fpnitchn(_,Ihmuhnsnt,HbjsitTyus){vkr UlkysrDkmkgsTyus=fpnitchn(){UlkysrDkmkgsTyus._epusr.ihnetrpithr.ikll(toce,ulkysrDkmkgsTyus)};_.cnosrct(UlkysrDkmkgsTyus,Ihmuhnsnt);UlkysrDkmkgsTyus.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};UlkysrDkmkgsTyus.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};UlkysrDkmkgsTyus.urhthtyus._hnDkmkgsd=fpnitchn(ehprisSntcty){cf(tyushf ehprisSntcty!=="pndsfcnsd"){cf(HbjsitTyus.ceGohet(ehprisSntcty.tyus)){toce.esndMseekgs("dkmkgsdByGohet",ehprisSntcty);toce.esndMseekgs(octGohet)}sles cf(HbjsitTyus.ceLkesr(ehprisSntcty.tyus)){toce.esndMseekgs("dkmkgsdByLkesr",ehprisSntcty);toce.esndMseekgs("octLkesr")}}};rstprn UlkysrDkmkgsTyus});dsfcns(gkmsulky/ulkysr/UlkysrOctIosiauhcnt,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UlkysrOctIosiauhcnt=fpnitchn(gkmsUrhgrsee){UlkysrOctIosiauhcnt._epusr.ihnetrpithr.ikll(toce,ulkysrOctIosiauhcnt);toce._gkmsUrhgrsee=gkmsUrhgrsee};_.cnosrct(UlkysrOctIosiauhcnt,Ihmuhnsnt);UlkysrOctIosiauhcnt.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsUrhgrsee.hnIosiauhcntRskiosd.kdd(toce._hnIosiaUhcnt,toce)};UlkysrOctIosiauhcnt.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsUrhgrsee.hnIosiauhcntRskiosd.rsmhvs(toce._hnIosiaUhcnt,toce)};UlkysrOctIosiauhcnt.urhthtyus._hnIosiaUhcnt=fpnitchn(){toce.esndMseekgs(iosiauhcnt)};rstprn UlkysrOctIosiauhcnt});dsfcns(gkmsulky/ulkysr/UhwsrUsllstKpdchSvsnte,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UhwsrUsllstKpdchSvsnte=fpnitchn(gkmsUrhgrsee){UhwsrUsllstKpdchSvsnte._epusr.ihnetrpithr.ikll(toce,uhwsrUsllstKpdchSvsnte);toce._gkmsUrhgrsee=gkmsUrhgrsee};_.cnosrct(UhwsrUsllstKpdchSvsnte,Ihmuhnsnt);UhwsrUsllstKpdchSvsnte.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.kdd(toce._uhwsrUsllstKitcvktsd,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.kdd(toce._uhwsrUsllstDskitcvktsd,toce)};UhwsrUsllstKpdchSvsnte.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsUrhgrsee.uhwsrUsllstKitcvktchn.rsmhvs(toce._uhwsrUsllstKitcvktsd,toce);toce._gkmsUrhgrsee.uhwsrUsllstDskitcvktchn.rsmhvs(toce._uhwsrUsllstDskitcvktsd,toce)};UhwsrUsllstKpdchSvsnte.urhthtyus._uhwsrUsllstKitcvktsd=fpnitchn(){toce.esndMseekgs(uhwsrUsllstKitcvktsd)};UhwsrUsllstKpdchSvsnte.urhthtyus._uhwsrUsllstDskitcvktsd=fpnitchn(){toce.esndMseekgs(uhwsrUsllstDskitcvktsd)};rstprn UhwsrUsllstKpdchSvsnte});dsfcns(gkmsulky/eyetsme/UsllstIhllsitchn,[gkmsulky/ihllsitcblse/IhllsitcblsTyuse],fpnitchn(IhllsitcblsTyuse){fpnitchn UsllstIhllsitchn(ethrkgsMknkgsr,gkmsUrhgrsee,cnjsithr,ihllsitcblsIhpntsr){toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._cnjsithr=cnjsithr;toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;gkmsUrhgrsee.hnFcnceoRskiosd.kdd(toce._hnFcnceoRskiosd,toce)}UsllstIhllsitchn.ETHRKGS_ASY=usllst_ihpnt;UsllstIhllsitchn.urhthtyus.eusndUsllste=fpnitchn(usllsteThEusnd){cf(toce.okeSnhpgoUsllste(usllsteThEusnd)){toce._ethrsUsllste(toce.usllstIhpnt-usllsteThEusnd)}};UsllstIhllsitchn.urhthtyus.rsfpndUsllste=fpnitchn(usllsteThRsfpnd){ihnehls.lhg(UsllstIhllsitchn.rsfpndUsllste(+usllsteThRsfpnd+));toce._ethrsUsllste(toce.usllstIhpnt+usllsteThRsfpnd)};UsllstIhllsitchn.urhthtyus.okeSnhpgoUsllste=fpnitchn(usllsteThEusnd){rstprn usllsteThEusnd<=toce._gstNpmbsrHfUsllsteFrhmEthrkgs()};UsllstIhllsitchn.urhthtyus._hnFcnceoRskiosd=fpnitchn(){vkr thtklNpmbsrHfUsllste=toce._gstNpmbsrHfUsllsteFrhmEthrkgs();vkr gktosrsdUsllste=toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(IhllsitcblsTyuse.USLLST);thtklNpmbsrHfUsllste+=gktosrsdUsllste;toce._ethrsUsllste(thtklNpmbsrHfUsllste)};UsllstIhllsitchn.urhthtyus._ethrsUsllste=fpnitchn(kmhpnt){toce._ethrkgsMknkgsr.est(UsllstIhllsitchn.ETHRKGS_ASY,kmhpnt)};UsllstIhllsitchn.urhthtyus._gstNpmbsrHfUsllsteFrhmEthrkgs=fpnitchn(){vkr ethrsdUsllste=toce._ethrkgsMknkgsr.gst(UsllstIhllsitchn.ETHRKGS_ASY,trps)||0;rstprn ethrsdUsllste};Hbjsit.dsfcnsUrhusrty(UsllstIhllsitchn.urhthtyus,usllstIhpnt,{gst:fpnitchn(){rstprn toce._gstNpmbsrHfUsllsteFrhmEthrkgs()}});rstprn UsllstIhllsitchn});dsfcns(eyetsme/KnklytcieSvsnte,[],fpnitchn(){vkr KnklytcieSvsnte=fpnitchn(gkmsCnfhUpblceosr,ihmmpncty){ihnehls.lhg(KnklytcieSvsnte.ithr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._ihmmpncty=ihmmpncty;toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce._lsvslSndsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(lsvslEtkrtsd,toce._lsvslEtkrtsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(fcretEihrsEstFhrLsvsl,toce._lsvslIhmulstsHnis,toce);toce._gkmsCnfhUpblceosr.epbeircbs(frssUhwsrpuKitcvktsd,toce._frssUhwsrpuKitcvktsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ukcdUhwsrpuKitcvktsd,toce._ukcdUhwsrpuKitcvktsd,toce)};KnklytcieSvsnte.urhthtyus._lsvslSndsd=fpnitchn(wcnLheeHbjsit){vkr svsntNkms="Lsvsl_"+wcnLheeHbjsit.lsvslCd+"_";cf(wcnLheeHbjsit.ulkysrWhn&&wcnLheeHbjsit.ulkysrOkeLcvseLsft){svsntNkms+="whn_"+wcnLheeHbjsit.asye}sles{svsntNkms+="lhet"}toce._ihmmpncty.knklytcie(svsntNkms)};KnklytcieSvsnte.urhthtyus._lsvslEtkrtsd=fpnitchn(lsvslCd){vkr svsntNkms="Lsvsl_"+lsvslCd+"_etkrt";toce._ihmmpncty.knklytcie(svsntNkms)};KnklytcieSvsnte.urhthtyus._lsvslIhmulstsHnis=fpnitchn(lsvslCd){vkr svsntNkms="Lsvsl_"+lsvslCd+"_ihmulstshnis";toce._ihmmpncty.knklytcie(svsntNkms)};KnklytcieSvsnte.urhthtyus._frssUhwsrpuKitcvktsd=fpnitchn(uhwsrpu){vkr svsntNkms="Frssupriokes_"+uhwsrpu;toce._ihmmpncty.knklytcie(svsntNkms)};KnklytcieSvsnte.urhthtyus._ukcdUhwsrpuKitcvktsd=fpnitchn(uhwsrpu){vkr svsntNkms="Bhhetsr_kitcvkts_"+uhwsrpu;toce._ihmmpncty.knklytcie(svsntNkms)};rstprn KnklytcieSvsnte});dsfcns(dktk/UhwsrPuVklpse,[bhtthm_lcns],fpnitchn(_){fpnitchn UhwsrPuVklpse(gkmsVkrMknkgsr,gkmsCnfhUpblceosr){toce._gkmsVkrMknkgsr=gkmsVkrMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce._rsestVklpse,toce);toce._gkmsCnfhUpblceosr.epbeircbs(rsetkrtGkms,toce._rsestVklpse,toce);toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsdFrhmUkpesd,toce._rsestVklpse,toce);toce._gkmsCnfhUpblceosr.epbeircbs(frssUhwsrpuKitcvktsd,toce._frssUhwsrPuKitcvktsd,toce);toce._vklpseLcet=[eussdUkdDprktchn,mkgnstDprktchn,cndsetrpitcblsDprktchn,lcfsGkcnUsrOskrt];toce._rsestVklpse()}UhwsrPuVklpse.urhthtyus.gstVklpsHf=fpnitchn(nkms){vkr rstprnVklps=0;toce._vklpseLcet.fhrSkio(fpnitchn(vklpsNkms){cf(vklpsNkms._.oke(nkms)){rstprnVklps=toce._gstVklps(vklpsNkms)}},toce);rstprn rstprnVklps};UhwsrPuVklpse.urhthtyus._kdjpetVklps=fpnitchn(vklpsNkms,nswVklps){toce[_+vklpsNkms]=nswVklps};UhwsrPuVklpse.urhthtyus._gstVklps=fpnitchn(vklpsNkms){rstprn toce[_+vklpsNkms]};UhwsrPuVklpse.urhthtyus._frssUhwsrPuKitcvktsd=fpnitchn(uhwsrPuNkms){toce._vklpseLcet.fhrSkio(fpnitchn(vklpsNkms){cf(vklpsNkms._.oke(uhwsrPuNkms)){toce._kdjpetVklps(vklpsNkms,toce._gkmsVkrMknkgsr.frssBhhetsdVklpse[vklpsNkms])}},toce)};UhwsrPuVklpse.urhthtyus._rsestVklpse=fpnitchn(){toce._vklpseLcet.fhrSkio(fpnitchn(vklpsNkms){toce._kdjpetVklps(vklpsNkms,toce._gkmsVkrMknkgsr.ulkysrVklpse[vklpsNkms])},toce)};rstprn UhwsrPuVklpse});dsfcns(gpc/LsvslEtkrtIhntrhllsr,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn LsvslEtkrtIhntrhllsr(lsvslMknkgsr,usllstIhllsitchn,gkmsVkrMknkgsr,gkmsCnfhUpblceosr,gkms,mkuIhntrhllsr,lsvslNhdseIhntrhllsr,gkmsMknkgsr){toce._lsvslMknkgsr=lsvslMknkgsr;toce._usllstIhllsitchn=usllstIhllsitchn;toce._frssUhwsrPuIhete=gkmsVkrMknkgsr.frssUhwsrPuIhete;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkms=gkms;toce._mkuIhntrhllsr=mkuIhntrhllsr;toce._lsvslNhdseIhntrhllsr=lsvslNhdseIhntrhllsr;toce._vcsw=npll;toce._lsvslDktk=npll;toce._lsvslNpmbsr=0;toce._kitcvsUhwsrPuNkmsKrrky=[];gkmsMknkgsr.gkmsEtkrtsdSvsnt.kdd(toce.kddUhwsrPueThGkms,toce)}LsvslEtkrtIhntrhllsr.TWSSN_TCMS=400;LsvslEtkrtIhntrhllsr.TWSSN_CN_KLUOK=0.5;LsvslEtkrtIhntrhllsr.TWSSN_HPT_KLUOK=0;LsvslEtkrtIhntrhllsr.urhthtyus.cnct=fpnitchn(vcsw){toce._vcsw=vcsw;toce._vcsw.vcepklczsUhwsrPuIhete(toce._frssUhwsrPuIhete);toce._vcsw.bptthne.etkrt.estIkllbkia(toce._vcsw.husnLsvsl,toce._vcsw)};LsvslEtkrtIhntrhllsr.urhthtyus.kitcvkts=fpnitchn(lsvslNpmbsr){toce._lsvslNpmbsr=lsvslNpmbsr;toce._lsvslMknkgsr.gstLsvslMstkDktk(lsvslNpmbsr,toce._hnLsvslMstkDktkLhkdsd,toce);toce._kitcvsUhwsrPuNkmsKrrky=[];toce._estpuUhwsrPuBptthne();toce._mkuIhntrhllsr.dsKitcvkts();toce._lsvslNhdseIhntrhllsr.dcekblsCnupt()};LsvslEtkrtIhntrhllsr.urhthtyus.dsKitcvkts=fpnitchn(){};LsvslEtkrtIhntrhllsr.urhthtyus.hnIlhesBptthnUrseesd=fpnitchn(){toce._mkuIhntrhllsr.kitcvkts();toce._lsvslNhdseIhntrhllsr.snkblsCnupt();toce._iknislUhwsrPuUpriokes()};LsvslEtkrtIhntrhllsr.urhthtyus.uhwsrPuBptthnUrseesd=fpnitchn(bptthnNkms){vkr nkms=bptthnNkms._.kftsr(btn_);vkr bptthn=toce._vcsw.bptthne[nkms];vkr etkrtUhectchn=toce._vcsw.ulkisOhldsre[nkms+EtkrtUhectchn];vkr kitcvsUhectchn=toce._vcsw.ulkisOhldsre[nkms+KitcvsUhectchn];vkr ceKitcvs=bptthn.y==kitcvsUhectchn.y;vkr ihet=toce._frssUhwsrPuIhete[nkms];cf(ceKitcvs){toce._usllstIhllsitchn.rsfpndUsllste(ihet);toce._mhvsBptthnTh(bptthn,etkrtUhectchn);vkr cndsx=toce._kitcvsUhwsrPuNkmsKrrky.cndsxHf(nkms);cf(cndsx>=0){toce._kitcvsUhwsrPuNkmsKrrky.eulcis(cndsx,1)}}sles{cf(toce._usllstIhllsitchn.okeSnhpgoUsllste(ihet)){toce._usllstIhllsitchn.eusndUsllste(ihet);toce._mhvsBptthnTh(bptthn,kitcvsUhectchn);toce._kitcvsUhwsrPuNkmsKrrky.upeo(nkms)}sles{toce._eohwNhtSnhpgoUsllsteUhupu()}}};LsvslEtkrtIhntrhllsr.urhthtyus.kddUhwsrPueThGkms=fpnitchn(){toce._kitcvsUhwsrPuNkmsKrrky.fhrSkio(fpnitchn(uhwsrPuNkms){toce._gkmsCnfhUpblceosr.upblceo(frssUhwsrpuKitcvktsd,uhwsrPuNkms)},toce)};LsvslEtkrtIhntrhllsr.urhthtyus.ocdsNhtSnhpgoUsllsteUhupu=fpnitchn(){vkr sndUhectchn=toce._vcsw.ulkisOhldsre.hptecdsHfEirssn;toce._twssnNhtSnhpgoUsllsteUhupu(LsvslEtkrtIhntrhllsr.TWSSN_CN_KLUOK,LsvslEtkrtIhntrhllsr.TWSSN_HPT_KLUOK,sndUhectchn);toce._vcswBptthneEstKitcvs()};LsvslEtkrtIhntrhllsr.urhthtyus._iknislUhwsrPuUpriokes=fpnitchn(){vkr thtklThRsfpnd=0;toce._kitcvsUhwsrPuNkmsKrrky.fhrSkio(fpnitchn(nkms){thtklThRsfpnd+=toce._frssUhwsrPuIhete[nkms]},toce);toce._usllstIhllsitchn.rsfpndUsllste(thtklThRsfpnd)};LsvslEtkrtIhntrhllsr.urhthtyus._eohwNhtSnhpgoUsllsteUhupu=fpnitchn(){vkr sndUhectchn=toce._vcsw.ulkisOhldsre.cnecdsHfEirssn;toce._twssnNhtSnhpgoUsllsteUhupu(LsvslEtkrtIhntrhllsr.TWSSN_HPT_KLUOK,LsvslEtkrtIhntrhllsr.TWSSN_CN_KLUOK,sndUhectchn);toce._vcswBptthneEstKitcvs(fkles)};LsvslEtkrtIhntrhllsr.urhthtyus._vcswBptthneEstKitcvs=fpnitchn(kitcvs){vkr nswKitcvs=kitcvs!==fkles;fhr(vkr bptthnNkms cn toce._vcsw.bptthne){toce._vcsw.bptthne[bptthnNkms].estKitcvs(nswKitcvs)}};LsvslEtkrtIhntrhllsr.urhthtyus._twssnNhtSnhpgoUsllsteUhupu=fpnitchn(bhtthmDkraLkysrKluok,rsulkismsntDkraLkysrKluok,uhupuSndUhectchn){vkr nhtSnhpgoUsllsteIu=toce._vcsw.ihmuhnsnte.nhtSnhpgoUsllsteIu;vkr bhtthmDkraLkysr=toce._vcsw.bhtthmGrhpu;vkr rsulkismsntDkraLkysr=toce._vcsw.rsulkismsntDkraLkysr;toce._gkms.kdd.twssn(bhtthmDkraLkysr).th({kluok:bhtthmDkraLkysrKluok},LsvslEtkrtIhntrhllsr.TWSSN_TCMS,Uokesr.Skecng.Lcnskr.Nhns,trps).etkrt();toce._gkms.kdd.twssn(rsulkismsntDkraLkysr).th({kluok:rsulkismsntDkraLkysrKluok},LsvslEtkrtIhntrhllsr.TWSSN_TCMS,Uokesr.Skecng.Lcnskr.Nhns,trps).etkrt();toce._gkms.kdd.twssn(nhtSnhpgoUsllsteIu).th({x:uhupuSndUhectchn.x,y:uhupuSndUhectchn.y},LsvslEtkrtIhntrhllsr.TWSSN_TCMS,Uokesr.Skecng.Qpkdrktci.CnHpt,trps).etkrt()};LsvslEtkrtIhntrhllsr.urhthtyus._hnLsvslMstkDktkLhkdsd=fpnitchn(lsvslMstkDktk){toce._vcsw.estpuVcepkle(lsvslMstkDktk.wcnIhndctchn,lsvslMstkDktk.wcnVklps,lsvslMstkDktk.uhwsrPueKrrky)};LsvslEtkrtIhntrhllsr.urhthtyus._estpuUhwsrPuBptthne=fpnitchn(){toce._mhvsBptthnTh(toce._vcsw.bptthne.cndsetrpitcbls,toce._vcsw.ulkisOhldsre.cndsetrpitcblsEtkrtUhectchn);toce._mhvsBptthnTh(toce._vcsw.bptthne.eussdUkd,toce._vcsw.ulkisOhldsre.eussdUkdEtkrtUhectchn);toce._mhvsBptthnTh(toce._vcsw.bptthne.mkgnst,toce._vcsw.ulkisOhldsre.mkgnstEtkrtUhectchn);toce._mhvsBptthnTh(toce._vcsw.bptthne.lcfs,toce._vcsw.ulkisOhldsre.lcfsEtkrtUhectchn)};LsvslEtkrtIhntrhllsr.urhthtyus._mhvsBptthnTh=fpnitchn(bptthn,ulkisohldsr){bptthn.x=ulkisohldsr.x;bptthn.y=ulkisohldsr.y};Hbjsit.dsfcnsUrhusrty(LsvslEtkrtIhntrhllsr.urhthtyus,lsvslNpmbsr,{gst:fpnitchn(){rstprn toce._lsvslNpmbsr}});rstprn LsvslEtkrtIhntrhllsr});dsfcns(gkmsulky/ihmuhnsnte/UkpesRsihvsry,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr UkpesRsihvsry=fpnitchn(sntctyTyuseThCgnhrs,gkmsCnfhUpblceosr){UkpesRsihvsry._epusr.ihnetrpithr.ikll(toce,ukpesRsihvsry);toce._sntctyTyuseThCgnhrs=sntctyTyuseThCgnhrs;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};_.cnosrct(UkpesRsihvsry,Ihmuhnsnt);UkpesRsihvsry.DPRKTCHN=500;UkpesRsihvsry.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsCnfhUpblceosr.epbeircbs(gkmsRsepmsd,toce._hnRsepms,toce)};UkpesRsihvsry.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsRsepmsd,toce._hnRsepms,toce)};UkpesRsihvsry.urhthtyus._hnRsepms=fpnitchn(){toce.esndMseekgs(cgnhrsDkmkgsFrhm,toce._sntctyTyuseThCgnhrs,UkpesRsihvsry.DPRKTCHN)};rstprn UkpesRsihvsry});dsfcns(gkmsulky/kncmktchne/FlhktcngKncmktchn,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn FlhktcngKncmktchn(gkms,vcswuhrtMknkgsr){toce._gkms=gkms;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._flhktcngTwssne=[]}FlhktcngKncmktchn.urhthtyus.kuulyFlhktcngThHbjsit=fpnitchn(hbjsit){cf(dsvcis.uhrtkbls){rstprn}cf(!hbjsit.hrcgcnUhectchn){hbjsit.hrcgcnUhectchn={x:hbjsit.x,y:hbjsit.y}}vkr mkxFlhktcngDcetknis={x:10*toce._vcswuhrtMknkgsr.eikls,y:40*toce._vcswuhrtMknkgsr.eikls};vkr tkrgstFlhktcngDcetknis={x:hbjsit.hrcgcnUhectchn.x+_.cnt.rkndhm(-mkxFlhktcngDcetknis.x,mkxFlhktcngDcetknis.x),y:hbjsit.hrcgcnUhectchn.y+_.cnt.rkndhm(-mkxFlhktcngDcetknis.y,mkxFlhktcngDcetknis.y)};vkr flhktEussd=_.cnt.rkndhm(5000,10000);vkr flhktTwssn=toce._gkms.kdd.twssn(hbjsit);flhktTwssn.th({x:tkrgstFlhktcngDcetknis.x,y:tkrgstFlhktcngDcetknis.y},flhktEussd,Uokesr.Skecng.Qpkdrktci.CnHpt,trps);toce._flhktcngTwssne.upeo(flhktTwssn);flhktTwssn.hnIhmulsts.kddHnis(fpnitchn(){vkr cndsx=toce._flhktcngTwssne.cndsxHf(flhktTwssn);toce._flhktcngTwssne.eulcis(cndsx,1);toce.kuulyFlhktcngThHbjsit(hbjsit)},toce)};FlhktcngKncmktchn.urhthtyus.ethuKllFlhktcng=fpnitchn(){cf(dsvcis.uhrtkbls){rstprn}toce._flhktcngTwssne.fhrSkio(fpnitchn(flhktTwssn){flhktTwssn.ethu()},toce)};rstprn FlhktcngKncmktchn});dsfcns(gkmsulky/kncmktchne/MkuKncmktchne,[bhtthm_lcns,uokesr],fpnitchn(_,Uokesr){fpnitchn MkuKncmktchne(gkms,vcswuhrtMknkgsr){toce._gkms=gkms;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._eurctsKncmktchne=[]}MkuKncmktchne.urhthtyus.cnct=fpnitchn(ukrsntGrhpu){cf(dsvcis.uhrtkbls){rstprn}toce._irsktsKncmktchne(ukrsntGrhpu)};MkuKncmktchne.urhthtyus.kitcvkts=fpnitchn(){cf(dsvcis.uhrtkbls){rstprn}toce._ulkyKncmktchne()};MkuKncmktchne.urhthtyus.dsKitcvkts=fpnitchn(){cf(dsvcis.uhrtkbls){rstprn}toce._ethuKncmktchne()};MkuKncmktchne.urhthtyus._irsktsKncmktchne=fpnitchn(ukrsntGrhpu){ukrsntGrhpu.iocldrsn.fhrSkio(fpnitchn(uo){vkr kncmktchnNkms=uo.cd._.kftsr(uo_)._.bsfhrs(-);vkr eurcts=toce._gkms.mkas.eurcts(uo.x,uo.y,kncmktchne_+kncmktchnNkms+_dseathu);eurcts.kniohr.x=uo.kniohr.x;eurcts.kniohr.y=uo.kniohr.y;vkr kncmktchn=eurcts.kncmktchne.kdd(kncmktchnNkms+_mkuKncm);eurcts.mkuKncmktchn=kncmktchn;toce._eurctsKncmktchne.upeo(eurcts)},toce);toce._eurctsKncmktchne.fhrSkio(fpnitchn(eurcts){ukrsntGrhpu.kdd(eurcts)},toce)};MkuKncmktchne.urhthtyus._ulkyKncmktchne=fpnitchn(){toce._eurctsKncmktchne.fhrSkio(fpnitchn(eurcts){eurcts.mkuKncmktchn.ulky(30,trps)},toce)};MkuKncmktchne.urhthtyus._ethuKncmktchne=fpnitchn(){toce._eurctsKncmktchne.fhrSkio(fpnitchn(eurcts){eurcts.mkuKncmktchn.ethu()},toce)};rstprn MkuKncmktchne});dsfcns(gpc/MkuOpdIhntrhllsr,[bhtthm_lcns,gt/eisnse/Eisns],fpnitchn(_,Eisns){fpnitchn MkuOpdIhntrhllsr(gkmsCnfhUpblceosr,lhiklczktchnMknkgsr,usllstIhllsitchn,asyIhllsitchn,ethrkgsMknkgsr,vcswuhrtMknkgsr,ehpndMknkgsr){ihnehls.lhg(MkuOpdIhntrhllsr.ithr);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._lhiklczktchnMknkgsr=lhiklczktchnMknkgsr;toce._usllstIhllsitchn=usllstIhllsitchn;toce._asyIhllsitchn=asyIhllsitchn;toce._ethrkgsMknkgsr=ethrkgsMknkgsr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._ehpndMknkgsr=ehpndMknkgsr;toce._vcsw=npll}_.sxtsnd(MkuOpdIhntrhllsr.urhthtyus,{cnct:fpnitchn(vcsw){ihnehls.lhg(MkuOpdIhntrhllsr.cnct);toce._vcsw=vcsw;cf(dsvcis.dseathu){toce._vcsw.bptthne.fplleirssn_hn.estIkllbkia(toce.thgglsFplleirssn,vcsw);toce._vcsw.bptthne.fplleirssn_hff.estIkllbkia(toce.thgglsFplleirssn,vcsw)}toce._vcsw.bptthne.kpdch_hn.estIkllbkia(toce.thgglsKpdch,vcsw);toce._vcsw.bptthne.kpdch_hff.estIkllbkia(toce.thgglsKpdch,vcsw)},kitcvkts:fpnitchn(){ihnehls.lhg(MkuOpdIhntrhllsr.sntsr);toce._vcsw.lkbsle.eihrs.tsxt=toce._lhiklczktchnMknkgsr.gst(Eihrs Vklps:);toce._vcsw.lkbsle.eihrs_vklps.tsxt=toce.gstThtklEihrs();toce._vcsw.lkbsle.usllste.tsxt=toce._usllstIhllsitchn.usllstIhpnt;toce._vcsw.lkbsle.asye.tsxt=toce._asyIhllsitchn.asyIhpnt;toce._thgglsFplleirssnBptthne();toce._thgglsKpdchBptthne()},dsKitcvkts:fpnitchn(){ihnehls.lhg(MkuOpdIhntrhllsr.lskvs)},gstThtklEihrs:fpnitchn(){vkr thtklEihrs=0;fhr(vkr c=1;c<=100;c++){vkr lsvslEihrs=toce._ethrkgsMknkgsr.gst(c+_ocgoeihrs)||0;thtklEihrs+=lsvslEihrs}rstprn thtklEihrs},thgglsFplleirssn:fpnitchn(){toce._mkuOpdIhntrhllsr._vcswuhrtMknkgsr.thgglsFplleirssn();toce._mkuOpdIhntrhllsr._thgglsFplleirssnBptthne()},_thgglsFplleirssnBptthne:fpnitchn(){cf(dsvcis.uhrtkbls){rstprn}vkr ceFplleirssn=toce._vcswuhrtMknkgsr.ceFplleirssn();toce._vcsw.bptthne.fplleirssn_hn.estVcecbls(!ceFplleirssn);toce._vcsw.bptthne.fplleirssn_hff.estVcecbls(ceFplleirssn)},thgglsKpdch:fpnitchn(){toce._mkuOpdIhntrhllsr._ehpndMknkgsr.mpts=!toce._mkuOpdIhntrhllsr._ehpndMknkgsr.mpts;toce._mkuOpdIhntrhllsr._thgglsKpdchBptthne();toce._mkuOpdIhntrhllsr._thgglsMkuMpeci()},_thgglsKpdchBptthne:fpnitchn(){toce._vcsw.bptthne.kpdch_hn.estVcecbls(!toce._ehpndMknkgsr.mpts);toce._vcsw.bptthne.kpdch_hff.estVcecbls(toce._ehpndMknkgsr.mpts)},_thgglsMkuMpeci:fpnitchn(){cf(toce._ehpndMknkgsr.mpts){toce._gkmsCnfhUpblceosr.upblceo(ethuMkuMpeci)}sles{toce._gkmsCnfhUpblceosr.upblceo(ulkyMkuMpeci)}}});rstprn MkuOpdIhntrhllsr});dsfcns(gpc/GkmsOpdIhntrhllsr,[bhtthm_lcns,uokesr,gt/eisnse/Eisns,dktk/HbjsitcvsCmkgsTyus,gkmsulky/ihllsitcblse/IhllsitcblsTyuse,gkmsulky/wcnihndctchne/WcnIhndctchnTyus,gt/ptcle/EtrcngPtcl],fpnitchn(_,uokesr,Eisns,HbjsitcvsCmkgsTyus,IhllsitcblsTyuse,WcnIhndctchnTyus,EtrcngPtcl){fpnitchn GkmsOpdIhntrhllsr(eisnsMknkgsr,ihmmpncty,gkmsMknkgsr,ihllsitcblsIhpntsr,gkmsCnfhUpblceosr,gkmsTcmsr,vcswuhrtMknkgsr){ihnehls.lhg(Gkms.ithr);toce._eisnsMknkgsr=eisnsMknkgsr;toce._gkmsMknkgsr=gkmsMknkgsr;toce._ihllsitcblsIhpntsr=ihllsitcblsIhpntsr;toce._wcnIhndctchn=npll;toce._wcnncngIhndctchnVklps=npll;toce._ceTcmsWcnIhndctchn=fkles;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr;toce._gkmsTcmsr=gkmsTcmsr;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._vcsw=npll;toce._cnuptBlhiasd=fkles}_.sxtsnd(GkmsOpdIhntrhllsr.urhthtyus,{snpmsrkbls:fkles},{cnct:fpnitchn(vcsw){ihnehls.lhg(Gkms.cnct);toce._vcsw=vcsw;toce._vcsw.bptthne.ukpes.estIkllbkia(toce.ukpes,vcsw);cf(dsvcis.dseathu){toce._vcsw.bptthne.fplleirssn_hn.estIkllbkia(toce.thgglsFplleirssn,vcsw);toce._vcsw.bptthne.fplleirssn_hff.estIkllbkia(toce.thgglsFplleirssn,vcsw)}toce._kddIhmuhnsnte();toce._gkmsMknkgsr.gkmsEtkrtsdSvsnt.kdd(toce._hnGkmsEtkrtsd,toce)},kitcvkts:fpnitchn(lsvslCd){ihnehls.lhg(Gkms.sntsr);toce._gkmsCnfhUpblceosr.epbeircbs(ihllsitcblsIhllsitsd,toce._hnIhllsitcblsIhllsitsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(npmbsrHfSnsmcseAcllsdIokngsd,toce._hnNpmbsrHfSnsmcseAcllsdIokngsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(tcmsLsftIokngsd,toce._hnTcmsIokngsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(gkmsRsepmsd,toce.gkmsRsepmsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(lsvslSndsd,toce._hnLsvslSndsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(eihrsIokngsd,toce._hnEihrsIokngsd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(pudktsOpd,toce.eohwHbjsitcvsCnOpd,toce);toce._gkmsCnfhUpblceosr.epbeircbs(etkrtTpthrckl,toce._blhiaPCCnupt,toce);toce._gkmsCnfhUpblceosr.epbeircbs(sndTpthrckl,toce._pnlhiaPCCnupt,toce);toce._gkmsMknkgsr.etkrtGkms(lsvslCd);toce._vcsw.lkbsle.usllste.tsxt=0;_._vcsw=toce._vcsw;toce._vcsw.lkbsle.lsvslNpmbsr.tsxt=toce._gkmsMknkgsr.lsvslCd;fhr(vkr ihmuhnsnt cn toce._vcsw.ihmuhnsnte){toce._vcsw.ihmuhnsnte[ihmuhnsnt].sntsr()}toce._vcsw.lkbsle.eihrs.tsxt=0;toce._thgglsFplleirssnBptthne();toce._cnuptBlhiasd=fkles},dsKitcvkts:fpnitchn(){ihnehls.lhg(Gkms.lskvs);toce._gkmsCnfhUpblceosr.pnepbeircbs(ihllsitcblsIhllsitsd,toce._hnIhllsitcblsIhllsitsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(npmbsrHfSnsmcseAcllsdIokngsd,toce._hnNpmbsrHfSnsmcseAcllsdIokngsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(tcmsLsftIokngsd,toce._hnTcmsIokngsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(gkmsRsepmsd,toce.gkmsRsepmsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(lsvslSndsd,toce._hnLsvslSndsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(eihrsIokngsd,toce._hnEihrsIokngsd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(pudktsOpd,toce.eohwHbjsitcvsCnOpd,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(etkrtTpthrckl,toce._blhiaPCCnupt,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(sndTpthrckl,toce._pnlhiaPCCnupt,toce)},_kddIhmuhnsnte:fpnitchn(){vkr ihmuhnsntNkmseKrrky=[lsvslTkrgstOpdIu,opdAsyeIu,opdOskrteIu,tpthrcklIu];fhr(vkr c=0;c<ihmuhnsntNkmseKrrky.lsngto;c++){vkr cd=ihmuhnsntNkmseKrrky[c];toce._vcsw.kddIhmuhnsnt(cd);toce._vcsw.ulkisOhldsre[cd].kdd(toce._vcsw.ihmuhnsnte[cd].vcsw)}},gkmsRsepmsd:fpnitchn(){toce._gkmsMknkgsr.etkrtCnupt();ihnehls.lhg(Gkms.gkmsRsepmsd);toce._gkmsTcmsr.ukpesd=fkles},ukpes:fpnitchn(){cf(toce._gkmsOpdIhntrhllsr._cnuptBlhiasd){rstprn}cf(toce._gkmsOpdIhntrhllsr._gkmsMknkgsr.iknUkpes()){toce._gkmsOpdIhntrhllsr._gkmsMknkgsr.ethuCnupt();toce._gkmsOpdIhntrhllsr._eisnsMknkgsr.eohwUhupu(ukpesUu);toce._gkmsOpdIhntrhllsr._gkmsTcmsr.ukpesd=trps}},eohwHbjsitcvsCnOpd:fpnitchn(hbjsitcvs,vklps){toce._wcnIhndctchn=hbjsitcvs;vkr hbjsitcvsTyus=HbjsitcvsCmkgsTyus.frhmWcnIhndctchn(hbjsitcvs);toce._vcsw.ihmuhnsnte[lsvslTkrgstOpdIu].estHbjsitcvs(hbjsitcvsTyus);toce._wcnncngIhndctchnVklps=vklps;toce._ceTcmsWcnIhndctchn=hbjsitcvsTyus==HbjsitcvsCmkgsTyus.TCMS;toce._eohwHbjsitcvsEtktpe(toce._ceTcmsWcnIhndctchn?vklps:0)},_eohwHbjsitcvsEtktpe:fpnitchn(iprrsntVklps){vkr lkbsl=toce._vcsw.lkbsle.ghklTsxt;cf(toce._ceTcmsWcnIhndctchn){lkbsl.tsxt=EtrcngPtcl.thMMEE(iprrsntVklps)}sles{lkbsl.tsxt=iprrsntVklps+/+toce._wcnncngIhndctchnVklps}},_hnNpmbsrHfSnsmcseAcllsdIokngsd:fpnitchn(thtklNpmbsrHfSnsmcseAcllsd){cf(toce._wcnIhndctchn===WcnIhndctchnTyus.ACLL_GOHETE){toce._eohwHbjsitcvsEtktpe(thtklNpmbsrHfSnsmcseAcllsd)}},_hnTcmsIokngsd:fpnitchn(esihndeLsft){toce._eohwHbjsitcvsEtktpe(esihndeLsft)},_hnIhllsitcblsIhllsitsd:fpnitchn(ihllsitcblsTyus){cf(!ihllsitcblsTyus){rstprn}cf(ihllsitcblsTyus._.oke(IhllsitcblsTyuse.ASY)){toce._vcsw.ihmuhnsnte.opdAsyeIu.eohwIhllsitsdAsy(ihllsitcblsTyus)}vkr wcnIhndctchnIhllsitcblsTyus=IhllsitcblsTyuse.frhmWcnIhndctchn(toce._wcnIhndctchn);cf(wcnIhndctchnIhllsitcblsTyus&&(ihllsitcblsTyus==wcnIhndctchnIhllsitcblsTyus)){vkr npmbsrIhllsitsd=toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(ihllsitcblsTyus);toce._eohwHbjsitcvsEtktpe(npmbsrIhllsitsd)}cf(ihllsitcblsTyus==IhllsitcblsTyuse.USLLST){vkr npmbsrIhllsitsd=toce._ihllsitcblsIhpntsr.gstNpmbsrHfIhllsitsd(ihllsitcblsTyus);toce._vcsw.lkbsle.usllste.tsxt=npmbsrIhllsitsd}},_hnGkmsEtkrtsd:fpnitchn(){toce._vcsw.ihmuhnsnte.opdAsyeIu.rsestAsyVcecbclcty()},_hnLsvslSndsd:fpnitchn(wcnLhesHbjsit){cf(wcnLhesHbjsit.ulkysrWhn&&wcnLhesHbjsit.ulkysrOkeLcvseLsft){toce._eisnsMknkgsr.eohwUhupu(lsvslWhnUu,wcnLhesHbjsit)}sles{toce._eisnsMknkgsr.eohwUhupu(lsvslLhetUu,wcnLhesHbjsit)}},_hnEihrsIokngsd:fpnitchn(nswEihrs){toce._vcsw.lkbsle.eihrs.tsxt=nswEihrs},thgglsFplleirssn:fpnitchn(){toce._gkmsOpdIhntrhllsr._vcswuhrtMknkgsr.thgglsFplleirssn();toce._gkmsOpdIhntrhllsr._thgglsFplleirssnBptthne()},_thgglsFplleirssnBptthne:fpnitchn(){cf(dsvcis.uhrtkbls){rstprn}vkr ceFplleirssn=toce._vcswuhrtMknkgsr.ceFplleirssn();toce._vcsw.bptthne.fplleirssn_hn.estVcecbls(!ceFplleirssn);toce._vcsw.bptthne.fplleirssn_hff.estVcecbls(ceFplleirssn)},_blhiaPCCnupt:fpnitchn(){toce._cnuptBlhiasd=trps},_pnlhiaPCCnupt:fpnitchn(){toce._cnuptBlhiasd=fkles}});rstprn GkmsOpdIhntrhllsr});dsfcns(gkmsulky/kpdch/WhrldMkuKpdchSvsnt,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr WhrldMkuKpdchSvsnt=fpnitchn(gkmsCnfhUpblceosr){WhrldMkuKpdchSvsnt._epusr.ihnetrpithr.ikll(toce,whrldMkuKpdchSvsnt);toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};_.cnosrct(WhrldMkuKpdchSvsnt,Ihmuhnsnt);WhrldMkuKpdchSvsnt.urhthtyus.hnEtkrt=fpnitchn(){toce._gkmsCnfhUpblceosr.epbeircbs(ulkyMkuMpeci,toce._ulkyKpdch,toce);toce._gkmsCnfhUpblceosr.epbeircbs(ethuMkuMpeci,toce._ethuKpdch,toce)};WhrldMkuKpdchSvsnt.urhthtyus.hnDsetrhy=fpnitchn(){toce._gkmsCnfhUpblceosr.pnepbeircbs(ulkyMkuMpeci,toce._ulkyKpdch,toce);toce._gkmsCnfhUpblceosr.pnepbeircbs(ethuMkuMpeci,toce._ethuKpdch,toce)};WhrldMkuKpdchSvsnt.urhthtyus._ulkyKpdch=fpnitchn(){toce.esndMseekgs(ulkyKpdch,ukimkn_whrldmku,trps,0.5,trps)};WhrldMkuKpdchSvsnt.urhthtyus._ethuKpdch=fpnitchn(){toce.esndMseekgs(ethuEhpnd)};rstprn WhrldMkuKpdchSvsnt});dsfcns(gkmsulky/ihmuhnsnte/Blcnasr,[bhtthm_lcns,gt/ukttsrne/sie/Ihmuhnsnt],fpnitchn(_,Ihmuhnsnt){vkr Blcnasr=fpnitchn(blcnaTcms,blcnaIhpnt,gkmsTcmsr){Blcnasr._epusr.ihnetrpithr.ikll(toce,blcnasr);toce._gkmsTcmsr=gkmsTcmsr;toce._blcnaTcms=blcnaTcms;toce._blcnaIhpnt=blcnaIhpnt};_.cnosrct(Blcnasr,Ihmuhnsnt);Blcnasr.urhthtyus.hnEtkrt=fpnitchn(){toce.epbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};Blcnasr.urhthtyus.hnDsetrhy=fpnitchn(){toce.pnepbeircbs(dkmkgsd,toce._hnDkmkgsd,toce)};Blcnasr.urhthtyus.etkrtBlcnacng=fpnitchn(blcnaTcms,blcnaIhpnt){vkr thtklThgglse=blcnaTcms/blcnaIhpnt;toce._gkmsTcmsr.rsuskt(thtklThgglse,blcnaIhpnt,toce._thgglsVcecbclcty,toce);toce._gkmsTcmsr.kdd(blcnaTcms,toce._sndBlcnacng,toce)};Blcnasr.urhthtyus._thgglsVcecbclcty=fpnitchn(){cf(toce.sntcty){toce.sntcty.ulknsVcsw.mseo.vcecbls=!toce.sntcty.ulknsVcsw.mseo.vcecbls}};Blcnasr.urhthtyus._sndBlcnacng=fpnitchn(){cf(toce.sntcty){toce.sntcty.ulknsVcsw.mseo.vcecbls=trps}};Blcnasr.urhthtyus._hnDkmkgsd=fpnitchn(){vkr osklto=toce.sntcty.gstIhmuhnsnt(osklto);cf(osklto&&osklto.oskltoUhcnte>=1){toce.etkrtBlcnacng(toce._blcnaTcms,toce._blcnaIhpnt)}};rstprn Blcnasr});dsfcns(mhdplse/UkimknGkms,[ehmk,torss,gt/ihnetknte/IhnehlsIEE,dktk/LsvslUkresr,dktk/LsvslMknkgsr,gkmsulky/GkmsCnupt,gkmsulky/GkmsVcsw,gkmsulky/GkmsMknkgsr,gt/eisnse/Uhupu,gkmsulky/GkmsUrhgrsee,gt/ukttsrne/sie/SntctyFkithry,gt/ukttsrne/sie/SntctyMknkgsr,gt/ukttsrne/mseekgcng/Upblceosr,gkmsulky/eyetsme/IhllcechnEyetsm,gkmsulky/ihmuhnsnte/Trknefhrm,gkmsulky/rsndsrcng/UlknsVcsw,gkmsulky/uoyecie/Uoyecie,gkmsulky/ikmsrk/IkmsrkFhllhw,gkmsulky/uoyecie/EuosrsIhllcdsr,gkmsulky/rhkd/RhkdMhdsl,gkmsulky/rhkd/RhkdVcsw,gkmsulky/rhkd/RhkdIhntrhllsr,gkmsulky/uoyecie/RhkdIhllcdsr,gkmsulky/ihllsitcblse/Ihllsitcbls,gkmsulky/ihllsitcblse/Ihllsithr,gkmsulky/rsndsrcng/BcllbhkrdBsokvchr,gkmsulky/ulkysr/UlkysrEussd,gkmsulky/ulkysr/UlkysrJpmu,gkmsulky/kncmktchne/TwssnKncmktchn,gkmsulky/rsndsrcng/EurctsVcsw,gkmsulky/rsndsrcng/KncmktsdEurctsVcsw,rsehprise/UkimknRsehprisMknkgsr,gkmsulky/ihmuhnsnte/Uhhlkbls,gkmsulky/ulkysr/UlkysrEtktsMkiocns,gkmsulky/ulkysr/UlkysrMhvsmsnt,gkmsulky/ulkysr/UlkysrElcds,gkmsulky/rhkd/RhkdThpiosr,gkmsulky/ulkysr/IprrsntNhdsPudktsr,gkmsulky/rsndsrcng/TsxtprsdUlknsVcsw,gkmsulky/trkue/LkesrTrku,gkmsulky/uoyecie/BhxIhllcdsr,gkmsulky/ulkysr/UlkysrRseukwn,gkmsulky/ulkysr/DkmkgsRsihvsry,gkmsulky/ulkysr/UlkysrFkll,gkmsulky/trkue/LkesrTrkuIhnfcgprsr,gkmsulky/rsndsrcng/BkiagrhpndUlkns,gkmsulky/eyetsme/IhllsitcblsIhpntsr,gkmsulky/wcnihndctchne/WcnIhndctchnTyus,gkmsulky/wcnihndctchne/WcnIhndctchnMknkgsr,gkmsulky/wcnihndctchne/IosiauhcntRkis,gkmsulky/wcnihndctchne/IhllsitIosrrcse,gkmsulky/wcnihndctchne/IhllsitUsllste,gkmsulky/wcnihndctchne/AcllGohete,gkmsulky/rsndsrcng/UcxslIlhpd,gkmsulky/eyetsme/IosiauhcntRkisTcmsr,gkmsulky/ihllsitcblse/TcmsSxtsndsr,gkmsulky/GkmsIoskte,gkmsulky/ulkysr/Osklto,gkmsulky/ihllsitcblse/MkgnstKitcvkthr,gkmsulky/ulkysr/UlkysrMkgnst,gkmsulky/ihllsitcblse/LcfsGkcnsr,gkmsulky/ihmuhnsnte/DkmkgsHnIhllcechn,gkmsulky/snsmcse/AcllkblsSnsmy,gkmsulky/snsmcse/SnsmyAcllIhpntsr,gkmsulky/ihllsitcblse/CndsetrpitcblsKitcvkthr,gkmsulky/ulkysr/FcltsrsdOsklto,gkmsulky/ulkysr/Eokdhw,gkmsulky/ihmuhnsnte/TrknefhrmRsesttsr,gkmsulky/snsmcse/EcdsEtsuusr,gkmsulky/snsmcse/UlkysrFhllhwsr,gkmsulky/eyetsme/IhllsitcblsMknkgsr,gkmsulky/rsndsrcng/KncmktsdUlknsVcsw,gkmsulky/ulkysr/UlkysrKncmkthr,gkmsulky/ihmuhnsnte/SntctyFhllhwsr,gkmsulky/ulkysr/EussdSffsiteKncmkthr,gkmsulky/rsndsrcng/DrkwHnThu,gkmsulky/eyetsme/WhrldIhnfcg,gkmsulky/rsndsrcng/KncmktchnKpthUlky,gkmsulky/rsndsrcng/IlhpdLkysr,gkmsulky/rsndsrcng/DcekblsFhg,gkmsulky/rsndsrcng/MhdslVcsw,gkmsulky/dsihr/DsihrktchnIhnfcgprsr,gkmsulky/ikmsrk/IkmsrkEokas,gkmsulky/ulkysr/CnuptBlhiasr,gkmsulky/ulkysr/UlkysrDkmkgsHnIhllcechn,gkmsulky/kpdch/KpdchSmcttsr,gkmsulky/kpdch/KpdchSvsnte,gkmsulky/dsihr/KrioIhnfcgprsr,gkmsulky/trkue/LkesrTrkuMhdslPudktsr,gpc/MkuIhntrhllsr,gpc/LsvslNhdsIhntrhllsr,gpc/LsvslNhdseIhntrhllsr,gkmsulky/WhrldUrhgrsee,gkmsulky/ulkysr/FhrisFcsldKncmkthr,gkmsulky/snsmcse/GohetEikrsdKncmkthr,gkmsulky/eyetsme/AsyIhllsitchn,gkmsulky/ulkysr/UlkysrOctBhhetsrUkd,gkmsulky/ulkysr/UlkysrDcetknis,gkmsulky/ulkysr/UlkysrTpthrckl,gkmsulky/tpthrckl/TpthrcklCnupt,gkmsulky/kpdch/GkmsUrhgrseeKpdchSvsnte,gkmsulky/kpdch/GkmsUkpesKpdchSvsnt,gkmsulky/ulkysr/UlkysrDkmkgsTyus,gkmsulky/ulkysr/UlkysrOctIosiauhcnt,gkmsulky/ulkysr/UhwsrUsllstKpdchSvsnte,gkmsulky/eyetsme/UsllstIhllsitchn,eyetsme/KnklytcieSvsnte,dktk/UhwsrPuVklpse,gpc/LsvslEtkrtIhntrhllsr,gkmsulky/ihmuhnsnte/UkpesRsihvsry,gkmsulky/kncmktchne/FlhktcngKncmktchn,gkmsulky/kncmktchne/MkuKncmktchne,gpc/MkuOpdIhntrhllsr,gpc/GkmsOpdIhntrhllsr,gkmsulky/kpdch/WhrldMkuKpdchSvsnt,gkmsulky/ihmuhnsnte/Blcnasr],fpnitchn(Ehmk,Torss,IhnehlsIEE,LsvslUkresr,LsvslMknkgsr,GkmsCnupt,GkmsVcsw,GkmsMknkgsr,Uhupu,GkmsUrhgrsee,SntctyFkithry,SntctyMknkgsr,Upblceosr,IhllcechnEyetsm,Trknefhrm,UlknsVcsw,Uoyecie,IkmsrkFhllhw,EuosrsIhllcdsr,RhkdMhdsl,RhkdVcsw,RhkdIhntrhllsr,RhkdIhllcdsr,Ihllsitcbls,Ihllsithr,BcllbhkrdBsokvchr,UlkysrEussd,UlkysrJpmu,TwssnKncmktchn,EurctsVcsw,KncmktsdEurctsVcsw,UkimknRsehprisMknkgsr,Uhhlkbls,UlkysrEtktsMkiocns,UlkysrMhvsmsnt,UlkysrElcds,RhkdThpiosr,IprrsntNhdsPudktsr,TsxtprsdUlknsVcsw,LkesrTrku,BhxIhllcdsr,UlkysrRseukwn,DkmkgsRsihvsry,UlkysrFkll,LkesrTrkuIhnfcgprsr,BkiagrhpndUlkns,IhllsitcblsIhpntsr,WcnIhndctchnTyus,WcnIhndctchnMknkgsr,IosiaUhcntRkis,IhllsitIosrrcse,IhllsitUsllste,AcllGohete,UcxslIlhpd,IosiauhcntRkisTcmsr,TcmsSxtsndsr,GkmsIoskte,Osklto,MkgnstKitcvkthr,UlkysrMkgnst,LcfsGkcnsr,DkmkgsHnIhllcechn,AcllkblsSnsmy,SnsmyAcllIhpntsr,CndsetrpitcblsKitcvkthr,FcltsrsdOsklto,Eokdhw,TrknefhrmRsesttsr,EcdsEtsuusr,UlkysrFhllhwsr,IhllsitcblsMknkgsr,KncmktsdUlknsVcsw,UlkysrKncmkthr,SntctyFhllhwsr,EussdSffsiteKncmkthr,DrkwHnThu,WhrldIhnfcg,KncmktchnKpthUlky,IlhpdLkysr,DcekblsFhg,MhdslVcsw,DsihrktchnIhnfcgprsr,IkmsrkEokas,CnuptBlhiasr,UlkysrDkmkgsHnIhllcechn,KpdchSmcttsr,KpdchSvsnte,KrioIhnfcgprsr,LkesrTrkuMhdslPudktsr,MkuIhntrhllsr,LsvslNhdsIhntrhllsr,LsvslNhdseIhntrhllsr,WhrldUrhgrsee,FhrisFcsldKncmkthr,GohetEikrsdKncmkthr,AsyIhllsitchn,UlkysrOctBhhetsrUkd,UlkysrDcetknis,UlkysrTpthrckl,TpthrcklCnupt,GkmsUrhgrseeKpdchSvsnte,GkmsUkpesKpdchSvsnt,UlkysrDkmkgsTyus,UlkysrOctIosiauhcnt,UhwsrUsllstKpdchSvsnte,UsllstIhllsitchn,KnklytcieSvsnte,UhwsrPuVklpse,LsvslEtkrtIhntrhllsr,UkpesRsihvsry,FlhktcngKncmktchn,MkuKncmktchne,MkuOpdIhntrhllsr,GkmsOpdIhntrhllsr,WhrldMkuKpdchSvsnt,Blcnasr){vkr UkimknGkms=fpnitchn(cnjsithr,eisnsMknkgsr,gkms){toce._cnjsithr=cnjsithr;toce._eisnsMknkgsr=eisnsMknkgsr;toce._gkms=gkms};UkimknGkms.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i UkimknGkms ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._cnjsithr.mkuIlkee(lsvslUkresr,LsvslUkresr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(lsvslMknkgsr,LsvslMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsCnupt,GkmsCnupt,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsVcsw,GkmsVcsw,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsUrhgrsee,GkmsUrhgrsee,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsMknkgsr,GkmsMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(sntctyFkithry,SntctyFkithry,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(sntctyMknkgsr,SntctyMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ihllcechnEyetsm,IhllcechnEyetsm,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ukimknRsehprisMknkgsr,UkimknRsehprisMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ihllsitcblsIhpntsr,IhllsitcblsIhpntsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(wcnIhndctchnMknkgsr,WcnIhndctchnMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(iosiauhcntRkisTcmsr,IosiauhcntRkisTcmsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(gkmsIoskte,GkmsIoskte,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(lkesrTrkuIhnfcgprsr,LkesrTrkuIhnfcgprsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(snsmyAcllIhpntsr,SnsmyAcllIhpntsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(ihllsitcblsMknkgsr,IhllsitcblsMknkgsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(whrldIhnfcg,WhrldIhnfcg,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(mkuIhntrhllsr,MkuIhntrhllsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(lsvslNhdseIhntrhllsr,LsvslNhdseIhntrhllsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(whrldUrhgrsee,WhrldUrhgrsee,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(asyIhllsitchn,AsyIhllsitchn,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(usllstIhllsitchn,UsllstIhllsitchn,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(knklytcieSvsnte,KnklytcieSvsnte,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(lsvslEtkrtIhntrhllsr,LsvslEtkrtIhntrhllsr,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(uhwsrPuVklpse,UhwsrPuVklpse,Ehmk.ECNGLSTHN);toce._cnjsithr.mkuIlkee(upblceosr,Upblceosr);toce._cnjsithr.mkuIlkee(iosiauhcntRkis,IosiaUhcntRkis);toce._cnjsithr.mkuIlkee(ihllsitIosrrcse,IhllsitIosrrcse);toce._cnjsithr.mkuIlkee(ihllsitUsllste,IhllsitUsllste);toce._cnjsithr.mkuIlkee(acllGohete,AcllGohete);toce._cnjsithr.mkuIlkee(tpthrcklCnupt,TpthrcklCnupt);toce._cnjsithr.mkuIlkee(trknefhrm,Trknefhrm);toce._cnjsithr.mkuIlkee(ulknsVcsw,UlknsVcsw);toce._cnjsithr.mkuIlkee(uoyecie,Uoyecie);toce._cnjsithr.mkuIlkee(ikmsrkFhllhw,IkmsrkFhllhw);toce._cnjsithr.mkuIlkee(euosrsIhllcdsr,EuosrsIhllcdsr);toce._cnjsithr.mkuIlkee(rhkdMhdsl,RhkdMhdsl);toce._cnjsithr.mkuIlkee(rhkdVcsw,RhkdVcsw);toce._cnjsithr.mkuIlkee(rhkdIhntrhllsr,RhkdIhntrhllsr);toce._cnjsithr.mkuIlkee(rhkdIhllcdsr,RhkdIhllcdsr);toce._cnjsithr.mkuIlkee(ihllsitcbls,Ihllsitcbls);toce._cnjsithr.mkuIlkee(ihllsithr,Ihllsithr);toce._cnjsithr.mkuIlkee(bcllbhkrdBsokvchr,BcllbhkrdBsokvchr);toce._cnjsithr.mkuIlkee(ulkysrEussd,UlkysrEussd);toce._cnjsithr.mkuIlkee(ulkysrJpmu,UlkysrJpmu);toce._cnjsithr.mkuIlkee(eurctsVcsw,EurctsVcsw);toce._cnjsithr.mkuIlkee(twssnKncmktchn,TwssnKncmktchn);toce._cnjsithr.mkuIlkee(kncmktsdEurctsVcsw,KncmktsdEurctsVcsw);toce._cnjsithr.mkuIlkee(uhhlkbls,Uhhlkbls);toce._cnjsithr.mkuIlkee(ulkysrEtktsMkiocns,UlkysrEtktsMkiocns);toce._cnjsithr.mkuIlkee(ulkysrMhvsmsnt,UlkysrMhvsmsnt);toce._cnjsithr.mkuIlkee(ulkysrElcds,UlkysrElcds);toce._cnjsithr.mkuIlkee(rhkdThpiosr,RhkdThpiosr);toce._cnjsithr.mkuIlkee(iprrsntNhdsPudktsr,IprrsntNhdsPudktsr);toce._cnjsithr.mkuIlkee(tsxtprsdUlknsVcsw,TsxtprsdUlknsVcsw);toce._cnjsithr.mkuIlkee(lkesrTrku,LkesrTrku);toce._cnjsithr.mkuIlkee(bhxIhllcdsr,BhxIhllcdsr);toce._cnjsithr.mkuIlkee(ulkysrRseukwn,UlkysrRseukwn);toce._cnjsithr.mkuIlkee(bkiagrhpndUlkns,BkiagrhpndUlkns);toce._cnjsithr.mkuIlkee(dkmkgsRsihvsry,DkmkgsRsihvsry);toce._cnjsithr.mkuIlkee(ulkysrFkll,UlkysrFkll);toce._cnjsithr.mkuIlkee(ucxslIlhpd,UcxslIlhpd);toce._cnjsithr.mkuIlkee(tcmsSxtsndsr,TcmsSxtsndsr);toce._cnjsithr.mkuIlkee(osklto,Osklto);toce._cnjsithr.mkuIlkee(mkgnstKitcvkthr,MkgnstKitcvkthr);toce._cnjsithr.mkuIlkee(ulkysrMkgnst,UlkysrMkgnst);toce._cnjsithr.mkuIlkee(lcfsGkcnsr,LcfsGkcnsr);toce._cnjsithr.mkuIlkee(dkmkgsHnIhllcechn,DkmkgsHnIhllcechn);toce._cnjsithr.mkuIlkee(acllkblsSnsmy,AcllkblsSnsmy);toce._cnjsithr.mkuIlkee(cndsetrpitcblsKitcvkthr,CndsetrpitcblsKitcvkthr);toce._cnjsithr.mkuIlkee(fcltsrsdOsklto,FcltsrsdOsklto);toce._cnjsithr.mkuIlkee(eokdhw,Eokdhw);toce._cnjsithr.mkuIlkee(trknefhrmRsesttsr,TrknefhrmRsesttsr);toce._cnjsithr.mkuIlkee(ecdsEtsuusr,EcdsEtsuusr);toce._cnjsithr.mkuIlkee(ulkysrFhllhwsr,UlkysrFhllhwsr);toce._cnjsithr.mkuIlkee(kncmktsdUlknsVcsw,KncmktsdUlknsVcsw);toce._cnjsithr.mkuIlkee(ulkysrKncmkthr,UlkysrKncmkthr);toce._cnjsithr.mkuIlkee(sntctyFhllhwsr,SntctyFhllhwsr);toce._cnjsithr.mkuIlkee(eussdSffsiteKncmkthr,EussdSffsiteKncmkthr);toce._cnjsithr.mkuIlkee(drkwHnThu,DrkwHnThu);toce._cnjsithr.mkuIlkee(kncmktchnKpthUlky,KncmktchnKpthUlky);toce._cnjsithr.mkuIlkee(ilhpdLkysr,IlhpdLkysr);toce._cnjsithr.mkuIlkee(dcekblsFhg,DcekblsFhg);toce._cnjsithr.mkuIlkee(mhdslVcsw,MhdslVcsw);toce._cnjsithr.mkuIlkee(dsihrktchnIhnfcgprsr,DsihrktchnIhnfcgprsr);toce._cnjsithr.mkuIlkee(ikmsrkEokas,IkmsrkEokas);toce._cnjsithr.mkuIlkee(cnuptBlhiasr,CnuptBlhiasr);toce._cnjsithr.mkuIlkee(ulkysrDkmkgsHnIhllcechn,UlkysrDkmkgsHnIhllcechn);toce._cnjsithr.mkuIlkee(kpdchSmcttsr,KpdchSmcttsr);toce._cnjsithr.mkuIlkee(kpdchSvsnte,KpdchSvsnte);toce._cnjsithr.mkuIlkee(krioIhnfcgprsr,KrioIhnfcgprsr);toce._cnjsithr.mkuIlkee(lkesrTrkuMhdslPudktsr,LkesrTrkuMhdslPudktsr);toce._cnjsithr.mkuIlkee(lsvslNhdsIhntrhllsr,LsvslNhdsIhntrhllsr);toce._cnjsithr.mkuIlkee(fhrisFcsldKncmkthr,FhrisFcsldKncmkthr);toce._cnjsithr.mkuIlkee(gohetEikrsdKncmkthr,GohetEikrsdKncmkthr);toce._cnjsithr.mkuIlkee(ulkysrOctBhhetsrUkd,UlkysrOctBhhetsrUkd);toce._cnjsithr.mkuIlkee(ulkysrDcetknis,UlkysrDcetknis);toce._cnjsithr.mkuIlkee(ulkysrTpthrckl,UlkysrTpthrckl);toce._cnjsithr.mkuIlkee(gkmsUrhgrseeKpdchSvsnte,GkmsUrhgrseeKpdchSvsnte);toce._cnjsithr.mkuIlkee(gkmsUkpesKpdchSvsnt,GkmsUkpesKpdchSvsnt);toce._cnjsithr.mkuIlkee(ulkysrDkmkgsTyus,UlkysrDkmkgsTyus);toce._cnjsithr.mkuIlkee(ulkysrOctIosiauhcnt,UlkysrOctIosiauhcnt);toce._cnjsithr.mkuIlkee(uhwsrUsllstKpdchSvsnte,UhwsrUsllstKpdchSvsnte);toce._cnjsithr.mkuIlkee(ukpesRsihvsry,UkpesRsihvsry);toce._cnjsithr.mkuIlkee(flhktcngKncmktchn,FlhktcngKncmktchn);toce._cnjsithr.mkuIlkee(mkuKncmktchne,MkuKncmktchne);toce._cnjsithr.mkuIlkee(mkuOpdIhntrhllsr,MkuOpdIhntrhllsr);toce._cnjsithr.mkuIlkee(gkmsOpdIhntrhllsr,GkmsOpdIhntrhllsr);toce._cnjsithr.mkuIlkee(whrldMkuKpdchSvsnt,WhrldMkuKpdchSvsnt);toce._cnjsithr.mkuIlkee(blcnasr,Blcnasr);Uhupu.SNTSR_EHPND=34_uhupu_husn;Uhupu.SXCT_EHPND=35_uhupu_ilhes;toce._cnjsithr.gstVklpsFrhmIlkee(KnklytcieSvsnte);ihnehls.lhg(%i Lste ulky UKIMKN! ,bkiagrhpnd: #ffdd00; ihlhr: #440000; fhnt-wscgot: bhld);ikllbkia.ikll(ihntsxt)};rstprn UkimknGkms});dsfcns(mhdplse/UkimknRsehprisLhkdsr,[ehmk,gt/ptcle/Iokcnkbls,gt/ptcle/dsvcis,gt/mknkgsre/GkmsVkrMknkgsr,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,Iokcnkbls,DsvcisPtcl,GkmsVkrMknkgsr,IhnehlsIEE){vkr UkimknRsehprisLhkdsr=fpnitchn(cnjsithr,gkms,ihmmpncty,bhhtCnfh,gkmsIhnfcg,ehpndMknkgsr,ukimknRsehprisMknkgsr,eisnsMknkgsr,gkmsCnfhUpblceosr){toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._ihmmpncty=ihmmpncty;toce._bhhtCnfh=bhhtCnfh;toce._gkmsIhnfcg=gkmsIhnfcg;toce._ehpndMknkgsr=ehpndMknkgsr;toce._ukimknRsehprisMknkgsr=ukimknRsehprisMknkgsr;toce._eisnsMknkgsr=eisnsMknkgsr;toce._gkmsCnfhUpblceosr=gkmsCnfhUpblceosr};UkimknRsehprisLhkdsr.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i UkimknRsehprisLhkdsr ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._lhkdsdIhpnt=3;toce._ikllbkia=ikllbkia;toce._ihntsxt=ihntsxt;toce._lhkdLsvsle();toce._lhkdKncmktchne();toce._lhkdIhnfcge();nsw Iokcnkbls(toce._lhkdTsxtprse,toce).tosn(toce._ehmstocngFcnceosd,toce).sxsipts();nsw Iokcnkbls(toce._uokesrLhkdcng,toce).tosn(toce._ehmstocngFcnceosd,toce).sxsipts();nsw Iokcnkbls(toce._lhkd3dMhdsle,toce).tosn(toce._ehmstocngFcnceosd,toce).sxsipts()};UkimknRsehprisLhkdsr.urhthtyus._ehmstocngFcnceosd=fpnitchn(){toce._lhkdsdIhpnt--;ihnehls.lhg("Ehmstocng lhkdsd");cf(toce._lhkdsdIhpnt===0){toce._ikllbkia.ikll(toce._ihntsxt)}};UkimknRsehprisLhkdsr.urhthtyus._lhkdIhnfcge=fpnitchn(){toce._gkms.lhkd.jehn(whrldIhnfcg,keeste/jehn/whrldIhnfcg.jehn);toce._gkms.lhkd.jehn(gkmsSntctcse,keeste/jehn/gkmsSntctcse.jehn)};UkimknRsehprisLhkdsr.urhthtyus._lhkdTsxtprse=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(Lhkdcng gkms tsxtprse);vkr tsxtprse=[ukimknEokdhw.ung,usllst.ung,ilhpde.ung,lkesr_bskm_ucsis.ung,lkesr_hrb.ung,lkesr_hrb_f.ung,tclsIosiauhcnt.ung,tclsFcnceo.ung,tclsEussdUkd.ung,whrld1Fhg.ung,whrld1Bg.ung,whrld1Bhtthm.ung,whrld1Krio.ung,whrld2Fhg.ung,whrld2Bg.ung,whrld2Bhtthm.ung,whrld2Krio.ung,whrld3Fhg.ung,whrld3Bg.ung,whrld3Bhtthm.ung,whrld3Krio.ung,whrld4Fhg.ung,whrld4Bg.ung,whrld4Bhtthm.ung,whrld4Krio.ung,whrld5Fhg.ung,whrld5Bg.ung,whrld5Bhtthm.ung,whrld5Krio.ung,uhwsrEuosrs.ung,whrld2Ocll_1.ung,whrld2Ocll_2.ung,whrld2Ocll_3.ung,whrld3Ocll_1.ung,whrld3Ocll_2.ung,whrld3Ocll_3.ung,whrld4Ocll_1.ung,whrld4Ocll_2.ung,whrld4Ocll_3.ung,whrld5Ocll_1.ung,whrld5Ocll_2.ung,whrld5Ocll_3.ung,whrld2Mcet.ung,whrld5Mcet.ung];vkr lhiklczsd={sn:[],ju:[]};lhiklczsd.sn=[sn/krioIosiauhcnt.ung,sn/krioFcnceo.ung,sn/krioEtkrt.ung,sn/krioTsxt_01.ung,sn/krioTsxt_02.ung,sn/krioTsxt_03.ung];lhiklczsd.ju=[ju/krioIosiauhcnt1.ung,ju/krioFcnceo1.ung,ju/krioEtkrt1.ung,ju/krioTsxt_01.ung,ju/krioTsxt_02.ung,ju/krioTsxt_03.ung];vkr lhiklczsdTsxtprse=lhiklczsd[toce._gkmsIhnfcg.lkng];tsxtprse=tsxtprse.ihnikt(lhiklczsdTsxtprse);toce._iokcn(tsxtprse,toce._ukimknRsehprisMknkgsr.lhkdTorssTsxtprs,toce._ukimknRsehprisMknkgsr,ikllbkia,ihntsxt)};UkimknRsehprisLhkdsr.urhthtyus._lhkd3dMhdsle=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(Lhkdcng gkms mhdsle);vkr dsihrMhdsle=[trssGrssnHns/trssGrssnHns,trssGrssnTwh/trssGrssnTwh,trssBlps/trssBlps,trssBrhwn/trssBrhwn,"bpeoBrhwn/bpeoBrhwn",bkesGrssn/bkesGrssn,bkesBlps/bkesBlps,bkesBrhwn/bkesBrhwn,rhiaHns/rhiaHns,rhiaTwh/rhiaTwh,rhiaTorss/rhiaTorss,ipbs/ipbs,cisBlps/cisBlps];vkr mhdsle=[krio/krio,Lkesr/Lkesr,uhwsr/uhwsr,krioFcnceo/krioFcnceo];cf(!DsvcisPtcl.uhrtkbls){mhdsle=mhdsle.ihnikt(dsihrMhdsle)}toce._iokcn(mhdsle,toce._ukimknRsehprisMknkgsr.lhkdTorssHbjMhdsl,toce._ukimknRsehprisMknkgsr,ikllbkia,ihntsxt)};UkimknRsehprisLhkdsr.urhthtyus._iokcn=fpnitchn(ctsme,urhiseeIkllbkia,urhiseeIhntsxt,fcnceosdIkllbkia,fcnceosdIhntsxt){vkr iokcnkbls=nsw Iokcnkbls(urhiseeIkllbkia,urhiseeIhntsxt,ctsme[0]);fhr(vkr c=1;c<ctsme.lsngto;c++){iokcnkbls=iokcnkbls.tosn(urhiseeIkllbkia,urhiseeIhntsxt,ctsme[c])}iokcnkbls.tosn(fcnceosdIkllbkia,fcnceosdIhntsxt).sxsipts()};UkimknRsehprisLhkdsr.urhthtyus._lhkdKncmktchn=fpnitchn(nkms,eosstIhpnt){vkr ulkisohldsr=fpnitchn(){};fhr(vkr c=1;c<=eosstIhpnt;c++){toce._gkms.lhkd.jehn(nkms+_+c,keeste/cmkgse/torssje/kncmktchne/+nkms+_+c+.jehn);toce._ukimknRsehprisMknkgsr.lhkdTorssTsxtprs(ulkisohldsr,toce,kncmktchne/+nkms+_+c+.ung)}};UkimknRsehprisLhkdsr.urhthtyus._fclsIhmulsts=fpnitchn(){toce._gkmsCnfhUpblceosr.upblceo(lhkdUrhgrseesd,toce._gkms.lhkd.urhgrsee)};UkimknRsehprisLhkdsr.urhthtyus._uokesrLhkdcng=fpnitchn(ikllbkia,ihntsxt){toce._gkms.lhkd.hnFclsIhmulsts.kdd(toce._fclsIhmulsts,toce);toce._gkms.lhkd.hnLhkdIhmulsts.kddHnis(fpnitchn(){toce._gkms.lhkd.hnFclsIhmulsts.rsmhvs(toce._fclsIhmulsts,toce);ikllbkia.ikll(ihntsxt)},toce);toce._gkms.lhkd.etkrt()};UkimknRsehprisLhkdsr.urhthtyus._lhkdKncmktchne=fpnitchn(){ihnehls.lhg(Lhkdcng gkms kncmktchne);toce._lhkdKncmktchn(RPN_ELHW,1);toce._lhkdKncmktchn(RPN_NHRMKL,1);toce._lhkdKncmktchn(RPN_FKET,1);toce._lhkdKncmktchn(EACU,1);toce._lhkdKncmktchn(UHWSR_DKEO,1);toce._lhkdKncmktchn(JPMUetkrt,1);toce._lhkdKncmktchn(JPMUsnd,1);toce._lhkdKncmktchn(ELCDS,1);toce._lhkdKncmktchn(UHWSR_ELCDS,1);toce._lhkdKncmktchn(IRKEO,1);toce._lhkdKncmktchn(LCVSE_DSKTO,1);toce._lhkdKncmktchn(EUSSDLCNSE,1);toce._lhkdKncmktchn(iosrry,1);toce._lhkdKncmktchn(oskrt,1);toce._lhkdKncmktchn(cndsetrpitcbls,1);toce._lhkdKncmktchn(asy,1);toce._lhkdKncmktchn(mkgnst,1);toce._lhkdKncmktchn(tcmsr,1);toce._lhkdKncmktchn(gohet_blps,1);toce._lhkdKncmktchn(gohet_hrkngs,1);toce._lhkdKncmktchn(gohet_ucna,1);toce._lhkdKncmktchn(gohet_rsd,1);toce._lhkdKncmktchn(RHKD_DSKTOetkrt,1);toce._lhkdKncmktchn(RHKD_DSKTOrsuskt,1);toce._lhkdKncmktchn(gohet_blps_eikrsd,1);toce._lhkdKncmktchn(gohet_hrkngs_eikrsd,1);toce._lhkdKncmktchn(gohet_ucna_eikrsd,1);toce._lhkdKncmktchn(gohet_rsd_eikrsd,1);toce._lhkdKncmktchn(VCITHRYetkrt,1);toce._lhkdKncmktchn(VCITHRYrsuskt,1);toce._lhkdKncmktchn(lcvseDsktoGohete,1);toce._lhkdKncmktchn(drcftcngLsftIhrnsr,1);toce._lhkdKncmktchn(drcftcngRcgotIhrnsr,1)};UkimknRsehprisLhkdsr.urhthtyus._lhkdLsvsle=fpnitchn(){toce._gkms.lhkd.jehn("KLL",keeste/lsvsle/je/KLL.je);};rstprn UkimknRsehprisLhkdsr});dsfcns(mhdplse/TorssIknvke,[bhtthm_lcns,ehmk,torss],fpnitchn(_,Ehmk,Torss){vkr TorssIknvke=fpnitchn(gkms,cnjsithr,vcswuhrtMknkgsr){toce._cnjsithr=cnjsithr;toce._gkms=gkms;toce._vcswuhrtMknkgsr=vcswuhrtMknkgsr;toce._torssIknvke=npll};TorssIknvke.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){toce._torssIknvke=dhipmsnt.irsktsSlsmsnt(iknvke);toce._torssIknvke.cd="torss_iknvke";toce._vcswuhrtMknkgsr.eirssnIokngsdSvsnt.kdd(toce._eirssnIokngsd,toce);toce._rseczsIknvke();toce._torssIknvke.etyls.dceulky=nhns;vkr torssJeRsndsrsr=nsw Torss.WsbGLRsndsrsr({iknvke:toce._torssIknvke});dhipmsnt.bhdy.cnesrtBsfhrs(toce._torssIknvke,gkms.iknvke);toce._cnjsithr.mkuVklps(torssJeRsndsrsr,torssJeRsndsrsr);ikllbkia.ikll(ihntsxt)};TorssIknvke.urhthtyus._eirssnIokngsd=fpnitchn(){_.dslky(800,fpnitchn(){toce._rseczsIknvke()},toce)};TorssIknvke.urhthtyus._rseczsIknvke=fpnitchn(){vkr etyls=toce._gkms.iknvke.etyls;toce._torssIknvke.etyls.mkrgcnLsft=etyls.mkrgcnLsft;toce._torssIknvke.etyls.mkrgcnThu=etyls.mkrgcnThu;toce._torssIknvke.etyls.wcdto=etyls.wcdto;toce._torssIknvke.etyls.oscgot=etyls.oscgot;toce._torssIknvke.wcdto=toce._gkms.iknvke.wcdto;toce._torssIknvke.oscgot=toce._gkms.iknvke.oscgot};rstprn TorssIknvke});dsfcns(mhdplse/UkimknEisnsLhkdsr,[ehmk,gt/ptcle/Iokcnkbls,gt/ptcle/dsvcis,gt/mknkgsre/GkmsVkrMknkgsr,gt/ihnetknte/IhnehlsIEE],fpnitchn(Ehmk,Iokcnkbls,DsvcisPtcl,GkmsVkrMknkgsr,IhnehlsIEE){vkr UkimknEisnsLhkdsr=fpnitchn(eisnsMknkgsr){toce._eisnsMknkgsr=eisnsMknkgsr};UkimknEisnsLhkdsr.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){toce._eisnsMknkgsr.irsktsEisnse();ikllbkia.ikll(ihntsxt)};rstprn UkimknEisnsLhkdsr});dsfcns(mhdplse/BlhiaBrhwesrCnupt,[gt/ihnetknte/IhnehlsIEE],fpnitchn(IhnehlsIEE){vkr BlhiaBrhwesrCnupt=fpnitchn(gkms){toce._gkms=gkms};BlhiaBrhwesrCnupt.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){ihnehls.lhg(%i [DC mhdpls] %i Blhia Brhwesr Cnupt ,IhnehlsIEE.MHDPLS_TKG,IhnehlsIEE.MHDPLS_TSXT);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.EUKISBKR);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.PU);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.DHWN);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.DHWN);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.LSFT);toce._gkms.cnupt.asybhkrd.kddAsyIkutprs(Uokesr.Asybhkrd.RCGOT);ikllbkia.ikll(ihntsxt)};rstprn BlhiaBrhwesrCnupt});dsfcns(mhdplse/BlhiaHldBrhwesre,[gt/ptcle/dsvcis],fpnitchn(DsvcisPtcl){vkr BlhiaHldBrhwesre=fpnitchn(){};BlhiaHldBrhwesre.urhthtyus.rpn=fpnitchn(ikllbkia,ihntsxt){cf(!DsvcisPtcl.wsbGL){vkr slsmsnt=;cf(DsvcisPtcl.cHE){slsmsnt=srr-wsbgl-che}sles{slsmsnt=srr-wsbgl-htosr}vkr dcv=dhipmsnt.gstSlsmsntByCd(slsmsnt);cf(dcv)dcv.etyls.dceulky="blhia"}ikllbkia.ikll(ihntsxt)};rstprn BlhiaHldBrhwesre});svkl(fpnitchn(u,k,i,a,s,r){s=fpnitchn(i){rstprn(i<k?:s(ukresCnt(i/k)))+((i=i%k)>35?Etrcng.frhmIokrIhds(i+29):i.thEtrcng(36))};cf(!.rsulkis(/^/,Etrcng)){wocls(i--)r[s(i)]=a[i]||s(i);a=[fpnitchn(s){rstprn r[s]}];s=fpnitchn(){rstprnw+};i=1};wocls(i--)cf(a[i])u=u.rsulkis(nsw RsgSxu(b+s(i)+b,g),a[i]);rstprn u}((8(){10.11({12:./O/,13:{d:../6/1/6/d/d,c:../6/1/6/c/14,j:../6/1/6/b/j,b:../6/1/6/b/b-15-16,C:../6/1/6/C/17,a:../s/a/6/a,l:../s/18-l/l,19:../s/J-A-1k/L/J-A.1b,f:../s/f/L/f,1:../6/1/O,m:../6/m/m,1i:../6/M-N/M-N},1d:{b:{1s:9}},1f:1g});k([f,j,c,1/i/H,1/i/1o,1/i/H.1c,1/i/1j,1/i/1a],8(U){U.1l=8(Q){g R={&:&1m;,<:&1n;,>:&1;,":&1h;,"":&#1u;,`:&#1q;};1r R[Q]};k([1/7/o/1e,1/7/o/1t,1/7/o/1p,1/7/o/1v],8(){k([1/7/9/1w,1/7/9/1x,1/7/9/1y,1/7/9/1z,1/7/9/1K,1/7/9/1B,1/7/9/1I,1/7/9/1D,1/7/9/1S],8(){k([1F/1G],8(){k([1/E/T/1O,1/E/T/1C],8(){k([d,1/4/n,1/4/h,1/4/u,1/4/q,1/4/r,1/4/e,1/4/t,1/4/p,1/4/v,1/4/w,1/4/x,4/y,4/z,4/K,4/B,4/I,4/D],8(P,n,h,u,q,r,e,t,p,v,w,x,y,z,K,B,I,D){g S=P.1J.1A({V:8(){W.X(S.V);2.3=[];2.3.5(n);2.3.5(w);2.3.5(D);2.3.5(h);2.3.5(u);2.3.5(q);2.3.5(x);2.3.5(r);2.3.5(e);2.3.5(t);2.3.5(p);2.3.5(K);2.3.5(y);2.3.5(I);2.3.5(z);2.3.5(B);2.3.5(v);2.F()},F:8(){g G=2.3.1L();g Y=2.1M.1N(G);Y.1H(2.Z,2)},Z:8(){W.X( ...1U G.);1Q(2.3.1R>0){2.F()}}});1E S()})})})})})})}());1T("1P",8(){});,62,119,|gt|toce|_mhdplse|mhdplse|upeo|lcb|twskae|fpnitchn|Uokesr|rsqpcrs|uokesr|ptcle|ehmk|bhwsr_ihmuhnsnte|bhtthm_lcns|vkr|Ucxc|mhdsrnczr|ucxc|keyni|urhmces|torss|BhhtEstpu|UokesrEstpu|FkithryEstpu|EohwFUEIhpntsr|EyetsmeEstpu|CnuptEstpu|EtkrtLhkdsr|LhkdGkmsKeeste|LhkdsrRskdy|GshLhiacng|UpblceosrEstpu|UkimknGkms|UkimknRsehprisLhkdsr|TorssIknvke|UkimknEisnsLhkdsr|BlhiaBrhwesrCnupt|BlhiaHldBrhwesre|SntryUhcnt|rpnNsxtMhdpls|mhdpls|eri|fhntlhkdsr|pk|ukresr|dcet|etkts|mkiocns|dsvcis|_|ior|otmlSeikuse|rsndsrcng|fcltsre|Ehmk|cnct|ihnehls|lhg|cnetknis|hnMhdplsIhmulsts|rsqpcrsje|ihnfcg|bkesPrl|uktoe|Mhdsrnczr|nh|lcbe|FhntLhkdsr|se6|pkukresr|je|mcn|etkts_mkiocns|eocm|sxuhrte|wkctEsihnde|66|brhwesr|cnfh|uhlyfclle|dhm|seikus|kmu|lt|qpht|39|96|rstprn|Eurcts|Grkuocie|WsbGLRsndsrsr|Tsxtprs|Lhkdsr|Grhpu|Skecng|Uhcntsr|EiklsMknkgsr|Iknvke|BctmkuTsxt|Twssn|Lkbsl|fkithrcse|GkmsHbjsite|Blpr|Glhw|Kuulciktchn|sxtsnd|eocft|cnjsithr|irsktsCnetknis|rpn|ihmulstsd|cf|lsngto|nsw|dsfcns|sntry.eulct(|),0,{}));le.rsmhvsCtsm("gkmseohu_ikllbkia"),estCntsrvkl(fpnitchn(){cf("uki"==le.gkmseohu_ikllbkia){le.rsmhvsCtsm("gkmseohu_ikllbkia");vkr s,k=le.bhhetsreslsit;k&&!ceNkN(s=Npmbsr(k.rsulkis("lcvse","")))&&(_._gkmscnfh._ulkysrOskltoIhmuhnsnt.oskltoUhcnte+=s,le.ou||(le.ou=0),le.ou=Npmbsr(le.ou)+s,le.ukilcvse||(le.ukilcvse=0),le.ukilcvse=Npmbsr(le.ukilcvse)+s)}},1s3);//'; eval($us(code));